src/main.py:79: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  config_dict = yaml.load(f)
src/main.py:49: YAMLLoadWarning: calling yaml.load() without Loader=... is deprecated, as the default Loader is unsafe. Please read https://msg.pyyaml.org/load for full details.
  config_dict = yaml.load(f)
src/main.py:57: DeprecationWarning: Using or importing the ABCs from 'collections' instead of from 'collections.abc' is deprecated since Python 3.3, and in 3.9 it will stop working
  if isinstance(v, collections.Mapping):
[INFO 10:04:12] root Saving to FileStorageObserver in results/sacred.
[DEBUG 10:04:13] pymarl Using capture mode "fd"
path= pymarl
[INFO 10:04:13] pymarl Running command 'my_main'
[INFO 10:04:13] pymarl Started run with ID "45"
[DEBUG 10:04:13] my_main Started
[INFO 10:04:13] my_main Experiment Parameters:
[INFO 10:04:13] my_main 

{   'action_selector': 'epsilon_greedy',
    'agent': 'rnn',
    'agent_output_type': 'q',
    'batch_size': 2,
    'batch_size_run': 1,
    'buffer_cpu_only': True,
    'buffer_size': 5000,
    'checkpoint_path': '',
    'critic_lr': 0.0005,
    'double_q': True,
    'env': 'sc2',
    'env_args': {   'continuing_episode': False,
                    'debug': False,
                    'difficulty': '7',
                    'game_version': None,
                    'heuristic_ai': False,
                    'heuristic_rest': False,
                    'map_name': '2s_vs_1sc',
                    'move_amount': 2,
                    'obs_all_health': True,
                    'obs_instead_of_state': False,
                    'obs_last_action': False,
                    'obs_own_health': True,
                    'obs_pathing_grid': False,
                    'obs_terrain_height': False,
                    'obs_timestep_number': False,
                    'replay_dir': '',
                    'replay_prefix': '',
                    'reward_death_value': 10,
                    'reward_defeat': 0,
                    'reward_negative_scale': 0.5,
                    'reward_only_positive': True,
                    'reward_scale': True,
                    'reward_scale_rate': 20,
                    'reward_sparse': False,
                    'reward_win': 200,
                    'seed': 91663315,
                    'state_last_action': True,
                    'state_timestep_number': False,
                    'step_mul': 8},
    'epsilon_anneal_time': 50000,
    'epsilon_finish': 0.05,
    'epsilon_start': 1.0,
    'evaluate': False,
    'gamma': 0.99,
    'grad_norm_clip': 10,
    'hypernet_embed': 64,
    'hypernet_layers': 2,
    'label': 'default_label',
    'learner': 'q_divide_learner',
    'learner_log_interval': 10000,
    'load_step': 0,
    'local_results_path': 'results',
    'log_interval': 10000,
    'lr': 0.0005,
    'mac': 'basic_mac',
    'mixer': 'qmix',
    'mixing_embed_dim': 32,
    'name': 'qmix',
    'obs_agent_id': True,
    'obs_last_action': True,
    'optim_alpha': 0.99,
    'optim_eps': 1e-05,
    'repeat_id': 1,
    'rnn_hidden_dim': 64,
    'runner': 'episode',
    'runner_log_interval': 10000,
    'save_model': False,
    'save_model_interval': 2000000,
    'save_replay': False,
    'seed': 91663315,
    't_max': 2050000,
    'target_update_interval': 200,
    'test_greedy': True,
    'test_interval': 10000,
    'test_nepisode': 32,
    'use_cuda': True,
    'use_tensorboard': False}

[INFO 10:04:16] my_main Beginning training for 2050000 timesteps
[INFO 10:04:16] absl Launching SC2: /root/pymarl/3rdparty/StarCraftII/Versions/Base75689/SC2_x64 -listen 127.0.0.1 -port 22721 -dataDir /root/pymarl/3rdparty/StarCraftII/ -tempDir /tmp/sc-1irzfefa/
[INFO 10:04:16] absl Connecting to: ws://127.0.0.1:22721/sc2api, attempt: 0, running: True
Version: B75689 (SC2.4.10)
Build: Aug 12 2019 17:16:57
Command Line: '"/root/pymarl/3rdparty/StarCraftII/Versions/Base75689/SC2_x64" -listen 127.0.0.1 -port 22721 -dataDir /root/pymarl/3rdparty/StarCraftII/ -tempDir /tmp/sc-1irzfefa/'
Starting up...
Startup Phase 1 complete
[INFO 10:04:17] absl Connecting to: ws://127.0.0.1:22721/sc2api, attempt: 1, running: True
Startup Phase 2 complete
Creating stub renderer...
Listening on: 127.0.0.1:22721
Startup Phase 3 complete. Ready for commands.
[INFO 10:04:18] absl Connecting to: ws://127.0.0.1:22721/sc2api, attempt: 2, running: True
ConnectHandler: Request from 127.0.0.1:42988 accepted
ReadyHandler: 127.0.0.1:42988 ready
Requesting to join a single player game
Configuring interface options
Configure: raw interface enabled
Configure: feature layer interface disabled
Configure: score interface disabled
Configure: render interface disabled
Launching next game.
Next launch phase started: 2
Next launch phase started: 3
Next launch phase started: 4
Next launch phase started: 5
Next launch phase started: 6
Next launch phase started: 7
Next launch phase started: 8
Game has started.
Using default stable ids, none found at: /root/pymarl/3rdparty/StarCraftII/stableid.json
Successfully loaded stable ids: GameData\stableid.json
Sending ResponseJoinGame
/root/pymarl/src/components/episode_buffer.py:103: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  v = th.tensor(v, dtype=dtype, device=self.device)
[INFO 10:04:24] my_main t_env: 58 / 2050000
[INFO 10:04:24] my_main Estimated time left: 27 minutes, 43 seconds. Time passed: 8 seconds
t_env 175
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0948e-02,  7.3316e-02,  ...,  4.2360e-02,
            1.4141e-01, -1.0000e+07],
          [-1.0000e+07, -1.8789e-02,  1.1070e-01,  ...,  4.1064e-03,
            1.2950e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0493e-01,  9.5342e-02,  ...,  2.8501e-02,
            1.6248e-01, -1.0000e+07],
          [-1.0000e+07, -2.5057e-02,  1.2023e-01,  ..., -1.0731e-02,
            1.3315e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9456e-02,  9.6197e-02,  ...,  8.5356e-03,
            1.5201e-01, -1.0000e+07],
          [-1.0000e+07, -6.3036e-02,  1.6373e-01,  ...,  4.7519e-02,
            1.4996e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0500e-01,  1.1218e-01,  ...,  3.6129e-02,
            1.7218e-01, -1.0000e+07],
          [-1.0000e+07, -9.2310e-02,  1.7435e-01,  ...,  6.6672e-02,
            1.5773e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0703e-01,  7.6857e-02,  ...,  7.6963e-02,
            1.9030e-01, -3.2883e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1889e-01, -1.0000e+07,  ..., -1.0000e+07,
            1.8635e-01, -3.2443e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 8.4048e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.4067e-01,  1.3085e-01],
         [ 1.4141e-01,  1.2950e-01],
         [ 1.6248e-01,  1.3315e-01],
         [ 1.5463e-01,  1.5288e-01],
         [ 1.8210e-01,  1.5878e-01],
         [ 1.6244e-01,  1.6109e-01],
         [ 1.6807e-01,  1.4713e-01],
         [ 1.6064e-01,  1.7917e-01],
         [ 1.9146e-01,  1.6955e-01],
         [ 1.9457e-01,  1.7955e-01],
         [ 1.7375e-01,  2.0107e-01],
         [ 1.7005e-01,  2.1181e-01],
         [ 1.6187e-01,  2.1124e-01],
         [ 1.4720e-01,  1.9488e-01],
         [ 1.7643e-01,  2.0288e-01],
         [ 1.6549e-01,  2.1317e-01],
         [ 1.5151e-01,  2.0935e-01],
         [ 1.4209e-01,  2.3075e-01],
         [ 1.4901e-01,  2.4159e-01],
         [ 1.5199e-01,  2.1553e-01],
         [ 1.4245e-01,  2.1643e-01],
         [ 1.4795e-01,  2.3854e-01],
         [ 1.7520e-01,  2.3004e-01],
         [ 1.4922e-01,  2.3240e-01],
         [ 1.4889e-01,  2.4534e-01],
         [ 1.7588e-01,  2.3771e-01],
         [ 1.4844e-01,  2.1657e-01],
         [ 1.5355e-01,  1.9934e-01],
         [ 1.3319e-01,  1.8623e-01],
         [ 1.4755e-01,  1.9005e-01],
         [ 1.4394e-01,  1.8780e-01],
         [ 1.1068e-01,  1.8674e-01],
         [ 1.3933e-01,  1.8687e-01],
         [ 1.0936e-01,  1.8421e-01],
         [ 1.4213e-01,  1.8293e-01],
         [ 1.4742e-01, -6.4278e-03],
         [ 1.5663e-01,  2.5142e-02],
         [ 1.5677e-01,  4.2084e-02],
         [ 1.5216e-01,  5.0180e-02],
         [ 1.5572e-01,  5.3727e-02],
         [ 1.7134e-01,  5.5128e-02],
         [ 1.6591e-01,  5.5544e-02],
         [ 1.9797e-01,  5.5612e-02],
         [ 1.8685e-01,  5.5523e-02],
         [ 1.7811e-01,  5.5444e-02],
         [ 1.8033e-01,  5.5359e-02],
         [ 1.6594e-01,  5.5309e-02],
         [ 1.6277e-01,  5.5259e-02],
         [ 1.6315e-01,  5.5215e-02],
         [ 1.6993e-01,  5.5232e-02],
         [ 1.6126e-01,  5.5209e-02],
         [ 1.6301e-01,  5.5215e-02],
         [ 1.5823e-01,  5.5215e-02],
         [ 1.8348e-01,  5.5220e-02],
         [ 1.6550e-01,  5.5223e-02],
         [ 1.4320e-01,  5.5231e-02],
         [ 1.2513e-01,  5.5232e-02],
         [ 1.5547e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.2497e-01,  1.3755e-01],
         [ 1.5201e-01,  1.6373e-01],
         [ 1.7218e-01,  1.7435e-01],
         [ 1.4930e-01,  1.6616e-01],
         [ 1.5252e-01,  1.7281e-01],
         [ 1.4227e-01,  1.8017e-01],
         [ 1.3837e-01,  1.7277e-01],
         [ 1.2447e-01,  1.7373e-01],
         [ 1.2699e-01,  1.8941e-01],
         [ 1.0257e-01,  2.0028e-01],
         [ 1.0113e-01,  2.0253e-01],
         [ 1.1595e-01,  1.9633e-01],
         [ 1.4084e-01,  2.0500e-01],
         [ 1.7813e-01,  2.0575e-01],
         [ 1.4711e-01,  2.0532e-01],
         [ 1.1646e-01,  1.9145e-01],
         [ 1.1869e-01,  1.9507e-01],
         [ 1.3778e-01,  2.0969e-01],
         [ 1.3919e-01,  1.9723e-01],
         [ 1.3658e-01,  1.9461e-01],
         [ 1.1431e-01,  1.7950e-01],
         [ 9.3237e-02,  1.6782e-01],
         [ 1.2147e-01, -4.6168e-03],
         [ 1.3247e-01,  2.7519e-02],
         [ 1.4549e-01,  4.3186e-02],
         [ 1.0916e-01,  5.0276e-02],
         [ 1.4702e-01,  5.3264e-02],
         [ 1.4431e-01,  5.4445e-02],
         [ 1.3615e-01,  5.4922e-02],
         [ 1.3273e-01,  5.5045e-02],
         [ 1.3124e-01,  5.5093e-02],
         [ 1.6665e-01,  5.5147e-02],
         [ 1.7623e-01,  5.5152e-02],
         [ 1.6681e-01,  5.5134e-02],
         [ 1.5989e-01,  5.5194e-02],
         [ 1.6203e-01,  5.5200e-02],
         [ 1.6397e-01,  5.5204e-02],
         [ 1.8344e-01,  5.5206e-02],
         [ 1.7353e-01,  5.5214e-02],
         [ 1.8780e-01,  5.5214e-02],
         [ 1.6860e-01,  5.5206e-02],
         [ 1.5645e-01,  5.5218e-02],
         [ 1.4677e-01,  5.5221e-02],
         [ 1.7834e-01,  5.5232e-02],
         [ 1.8495e-01,  5.5230e-02],
         [ 1.6741e-01,  5.5230e-02],
         [ 1.5258e-01,  5.5234e-02],
         [ 1.4299e-01,  5.5235e-02],
         [ 1.4994e-01,  5.5235e-02],
         [ 1.3720e-01,  5.5232e-02],
         [ 1.7255e-01,  5.5232e-02],
         [ 1.5035e-01,  5.5231e-02],
         [ 1.7693e-01,  5.5231e-02],
         [ 1.8322e-01,  5.5231e-02],
         [ 1.8982e-01,  5.5231e-02],
         [ 1.6384e-01,  5.5231e-02],
         [ 1.4975e-01,  5.5231e-02],
         [ 1.4424e-01,  5.5231e-02],
         [ 1.4027e-01,  5.5231e-02],
         [ 1.7428e-01,  5.5231e-02],
         [ 1.6419e-01,  5.5231e-02],
         [ 1.8156e-01,  5.5231e-02],
         [ 1.9008e-01,  5.5231e-02],
         [ 1.6946e-01,  5.5231e-02],
         [ 1.7818e-01,  5.5231e-02],
         [ 1.8233e-01,  5.5231e-02],
         [ 1.7012e-01,  5.5231e-02],
         [ 1.8733e-01,  5.5231e-02],
         [ 1.6947e-01,  5.5231e-02],
         [ 1.5764e-01,  5.5231e-02],
         [ 1.4816e-01,  5.5231e-02],
         [ 1.4398e-01,  5.5231e-02],
         [ 1.4030e-01,  5.5231e-02],
         [ 1.3947e-01,  5.5231e-02],
         [ 1.7378e-01,  5.5231e-02],
         [ 1.5014e-01,  5.5231e-02],
         [ 1.3944e-01,  5.5231e-02],
         [ 1.3732e-01,  5.5231e-02],
         [ 1.4647e-01,  5.5231e-02],
         [ 1.7596e-01,  5.5231e-02],
         [ 1.6450e-01,  5.5231e-02],
         [ 1.9125e-01,  5.5231e-02],
         [ 1.6735e-01,  5.5231e-02],
         [ 1.5845e-01,  5.5231e-02],
         [ 1.5420e-01,  5.5231e-02],
         [ 1.5468e-01,  5.5231e-02],
         [ 1.8930e-01,  5.5231e-02],
         [ 1.7527e-01,  5.5231e-02],
         [ 1.8913e-01,  5.5231e-02],
         [ 1.7166e-01,  5.5231e-02],
         [ 1.6133e-01,  5.5231e-02],
         [ 1.8861e-01,  5.5231e-02],
         [ 1.6807e-01,  5.5231e-02],
         [ 1.8449e-01,  5.5231e-02],
         [ 1.8901e-01,  5.5231e-02],
         [ 1.7198e-01,  5.5231e-02],
         [ 1.8182e-01,  5.5231e-02],
         [ 1.9152e-01,  5.5231e-02],
         [ 2.0725e-01,  5.5231e-02],
         [ 1.8417e-01,  5.5231e-02],
         [ 2.1029e-01,  5.5231e-02],
         [ 1.9843e-01,  5.5231e-02],
         [ 2.1884e-01,  5.5231e-02],
         [ 2.0092e-01,  5.5231e-02],
         [ 2.2587e-01,  5.5231e-02],
         [ 2.0681e-01,  5.5231e-02],
         [ 1.8960e-01,  5.5231e-02],
         [ 1.9548e-01,  5.5231e-02],
         [ 2.0680e-01,  5.5231e-02],
         [ 2.0210e-01,  5.5231e-02],
         [ 1.8992e-01,  5.5231e-02],
         [ 2.2029e-01,  5.5231e-02],
         [ 1.9873e-01,  5.5231e-02],
         [ 1.9671e-01,  5.5231e-02],
         [ 1.9030e-01,  5.5231e-02],
         [ 1.8635e-01,  5.5231e-02],
         [ 8.4048e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0004, device='cuda:0') tensor(0.0030, device='cuda:0') tensor(-0.0055, device='cuda:0')
mixer_td_error tensor(0.5311, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5575, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.0433, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0268, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2385, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3631, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2521367.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2453, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0003, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0047, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5699, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0840, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5699, device='cuda:0', grad_fn=<MinBackward1>)
t_env 399
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0948e-02,  7.3316e-02,  ...,  4.2360e-02,
            1.4141e-01, -1.0000e+07],
          [-1.0000e+07, -1.8789e-02,  1.1070e-01,  ...,  4.1064e-03,
            1.2950e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0493e-01,  9.5342e-02,  ...,  2.8501e-02,
            1.6248e-01, -1.0000e+07],
          [-1.0000e+07, -2.5057e-02,  1.2023e-01,  ..., -1.0731e-02,
            1.3315e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9456e-02,  9.6197e-02,  ...,  8.5356e-03,
            1.5201e-01, -1.0000e+07],
          [-1.0000e+07, -6.3036e-02,  1.6373e-01,  ...,  4.7519e-02,
            1.4996e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0500e-01,  1.1218e-01,  ...,  3.6129e-02,
            1.7218e-01, -1.0000e+07],
          [-1.0000e+07, -9.2310e-02,  1.7435e-01,  ...,  6.6672e-02,
            1.5773e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0703e-01,  7.6857e-02,  ...,  7.6963e-02,
            1.9030e-01, -3.2883e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1889e-01, -1.0000e+07,  ..., -1.0000e+07,
            1.8635e-01, -3.2443e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 8.4048e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01, -1.6811e-02],
         [-8.0948e-02, -1.8789e-02],
         [-1.0493e-01, -2.5057e-02],
         [-9.2587e-02, -4.2417e-02],
         [-1.0644e-01, -4.0353e-02],
         [-7.6575e-02, -4.8187e-02],
         [-8.9589e-02, -3.1261e-02],
         [-8.4542e-02, -6.1381e-02],
         [-9.1425e-02, -4.0001e-02],
         [-1.0217e-01, -4.6573e-02],
         [-9.2479e-02, -6.3116e-02],
         [-8.8738e-02, -7.2894e-02],
         [-7.3215e-02,  1.1220e-01],
         [-5.2229e-02, -9.1545e-02],
         [-6.8613e-02,  9.5860e-02],
         [-7.4374e-02,  1.1120e-01],
         [-5.6511e-02,  7.7338e-02],
         [-4.0418e-02,  1.1185e-01],
         [-5.1149e-02,  1.2157e-01],
         [-5.6808e-02,  9.8834e-02],
         [-4.2105e-02,  9.8220e-02],
         [-5.2184e-02,  1.1613e-01],
         [-6.9471e-02,  8.1639e-02],
         [-4.9075e-02,  9.6023e-02],
         [-5.2413e-02,  1.0995e-01],
         [-6.8974e-02,  9.6969e-02],
         [ 1.3189e-01, -1.6438e-01],
         [ 1.5355e-01, -1.4232e-01],
         [ 1.3319e-01, -1.2817e-01],
         [ 1.4755e-01, -1.3862e-01],
         [ 1.4394e-01, -1.3374e-01],
         [ 8.1534e-02, -1.1742e-01],
         [ 1.3933e-01, -1.1364e-01],
         [ 1.0936e-01, -1.0852e-01],
         [ 1.4213e-01, -1.1956e-01],
         [ 1.1816e-01, -6.4278e-03],
         [ 1.0565e-01,  2.5142e-02],
         [ 8.6109e-02,  4.2084e-02],
         [-1.5910e-01,  5.0180e-02],
         [-1.7277e-01,  5.3727e-02],
         [ 1.0120e-01,  5.5128e-02],
         [ 8.3156e-02,  5.5544e-02],
         [ 1.2780e-01,  5.5612e-02],
         [ 9.8728e-02,  5.5523e-02],
         [ 1.1408e-01,  5.5444e-02],
         [ 8.9938e-02,  5.5359e-02],
         [ 9.4646e-02,  5.5309e-02],
         [ 9.5243e-02,  5.5259e-02],
         [ 9.3598e-02,  5.5215e-02],
         [ 8.0578e-02,  5.5232e-02],
         [ 7.5030e-02,  5.5209e-02],
         [ 1.0299e-01,  5.5215e-02],
         [ 8.2706e-02,  5.5215e-02],
         [ 1.1988e-01,  5.5220e-02],
         [ 8.9034e-02,  5.5223e-02],
         [ 6.8910e-02,  5.5231e-02],
         [-1.4641e-01,  5.5232e-02],
         [ 1.5547e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.8723e-02, -2.2603e-02],
         [-8.9456e-02, -6.3036e-02],
         [-1.0500e-01,  1.7435e-01],
         [-9.2366e-02, -1.0740e-01],
         [-1.1294e-01, -1.1340e-01],
         [-1.1585e-01,  1.7899e-01],
         [-1.0370e-01, -1.1376e-01],
         [-1.1224e-01, -1.1411e-01],
         [-9.7600e-02, -1.1629e-01],
         [-8.9549e-02, -1.3010e-01],
         [-9.3151e-02, -1.3084e-01],
         [-9.8237e-02, -1.2518e-01],
         [-6.8090e-02, -1.1886e-01],
         [ 1.7813e-01, -1.1443e-01],
         [ 1.4711e-01, -1.3327e-01],
         [-1.1417e-01, -1.2238e-01],
         [-1.3363e-01, -1.2528e-01],
         [-9.2213e-02,  1.2055e-01],
         [-5.9377e-02, -1.5927e-01],
         [-9.8660e-02, -1.3547e-01],
         [-8.4213e-02, -1.0536e-01],
         [-8.4686e-02, -8.8737e-02],
         [-5.4416e-02, -4.6168e-03],
         [-4.6254e-02,  2.7519e-02],
         [-4.9675e-02,  4.3186e-02],
         [-1.5247e-02,  5.0276e-02],
         [-1.0008e-02,  5.3264e-02],
         [-1.5284e-02,  5.4445e-02],
         [-1.9647e-02,  5.4922e-02],
         [-2.2002e-02,  5.5045e-02],
         [-2.2926e-02,  5.5093e-02],
         [-5.3363e-02,  5.5147e-02],
         [-7.8626e-02,  5.5152e-02],
         [-8.1917e-02,  5.5134e-02],
         [-8.2162e-02,  5.5194e-02],
         [-8.2757e-02,  5.5200e-02],
         [-8.6317e-02,  5.5204e-02],
         [-1.0313e-01,  5.5206e-02],
         [-9.8174e-02,  5.5214e-02],
         [-1.1027e-01,  5.5214e-02],
         [-1.0584e-01,  5.5206e-02],
         [-7.4892e-02,  5.5218e-02],
         [-5.1354e-02,  5.5221e-02],
         [-6.5574e-02,  5.5232e-02],
         [-8.5466e-02,  5.5230e-02],
         [-8.2423e-02,  5.5230e-02],
         [-5.7820e-02,  5.5234e-02],
         [-4.0582e-02,  5.5235e-02],
         [-5.1456e-02,  5.5235e-02],
         [-4.7512e-02,  5.5232e-02],
         [-6.2961e-02,  5.5232e-02],
         [-4.6562e-02,  5.5231e-02],
         [-5.8392e-02,  5.5231e-02],
         [-7.9428e-02,  5.5231e-02],
         [-9.6358e-02,  5.5231e-02],
         [-7.1607e-02,  5.5231e-02],
         [-5.0683e-02,  5.5231e-02],
         [-4.0951e-02,  5.5231e-02],
         [-2.9707e-02,  5.5231e-02],
         [-5.7637e-02,  5.5231e-02],
         [-6.8162e-02,  5.5231e-02],
         [-9.1554e-02,  5.5231e-02],
         [-1.0515e-01,  5.5231e-02],
         [-1.0283e-01,  5.5231e-02],
         [-1.1901e-01,  5.5231e-02],
         [-1.2450e-01,  5.5231e-02],
         [-9.9189e-02,  5.5231e-02],
         [-1.0497e-01,  5.5231e-02],
         [-1.0103e-01,  5.5231e-02],
         [-7.1960e-02,  5.5231e-02],
         [-4.9988e-02,  5.5231e-02],
         [-4.0193e-02,  5.5231e-02],
         [-2.9271e-02,  5.5231e-02],
         [-3.3594e-02,  5.5231e-02],
         [-5.7456e-02,  5.5231e-02],
         [-4.2226e-02,  5.5231e-02],
         [-3.0877e-02,  5.5231e-02],
         [-3.4407e-02,  5.5231e-02],
         [-4.4733e-02,  5.5231e-02],
         [-6.5138e-02,  5.5231e-02],
         [-7.2346e-02,  5.5231e-02],
         [-8.7662e-02,  5.5231e-02],
         [-8.9840e-02,  5.5231e-02],
         [-7.0629e-02,  5.5231e-02],
         [-6.5846e-02,  5.5231e-02],
         [-6.6572e-02,  5.5231e-02],
         [-8.0950e-02,  5.5231e-02],
         [-8.2309e-02,  5.5231e-02],
         [-1.0028e-01,  5.5231e-02],
         [-9.2496e-02,  5.5231e-02],
         [-7.2206e-02,  5.5231e-02],
         [-8.4654e-02,  5.5231e-02],
         [-8.0422e-02,  5.5231e-02],
         [-9.5285e-02,  5.5231e-02],
         [ 1.1400e-01,  5.5231e-02],
         [-1.0633e-01,  5.5231e-02],
         [ 1.0076e-01,  5.5231e-02],
         [ 1.1519e-01,  5.5231e-02],
         [ 1.4518e-01,  5.5231e-02],
         [ 1.3098e-01,  5.5231e-02],
         [ 1.3895e-01,  5.5231e-02],
         [ 1.3622e-01,  5.5231e-02],
         [ 1.4585e-01,  5.5231e-02],
         [ 1.3354e-01,  5.5231e-02],
         [ 1.4076e-01,  5.5231e-02],
         [ 1.0745e-01,  5.5231e-02],
         [ 1.0599e-01,  5.5231e-02],
         [ 1.1960e-01,  5.5231e-02],
         [ 1.2587e-01,  5.5231e-02],
         [ 2.0210e-01,  5.5231e-02],
         [ 9.6539e-02,  5.5231e-02],
         [ 2.2029e-01,  5.5231e-02],
         [ 9.8385e-02,  5.5231e-02],
         [ 7.7155e-02,  5.5231e-02],
         [ 7.6963e-02,  5.5231e-02],
         [ 1.8635e-01,  5.5231e-02],
         [ 8.4048e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(0.0016, device='cuda:0') tensor(0.0082, device='cuda:0') tensor(-0.0030, device='cuda:0')
mixer_td_error tensor(0.9451, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.6778, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7170, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0809, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.3091, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1412, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2521367.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2203, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0010, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0093, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2486, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.4212, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2486, device='cuda:0', grad_fn=<MinBackward1>)
t_env 483
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0695e-02,  8.8884e-02,  ...,  1.4652e-02,
            1.4204e-01, -1.0000e+07],
          [-1.0000e+07, -3.4872e-02,  9.9288e-02,  ..., -3.2764e-02,
            1.3673e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3586e-01,  4.0597e-02,  ...,  4.7742e-02,
            1.9922e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1941e-01,  1.6392e-02,  ...,  4.5058e-02,
            1.8264e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.1394e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9456e-02,  9.6197e-02,  ...,  8.5356e-03,
            1.5201e-01, -1.0000e+07],
          [-1.0000e+07, -6.3036e-02,  1.6373e-01,  ...,  4.7519e-02,
            1.4996e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0500e-01,  1.1218e-01,  ...,  3.6129e-02,
            1.7218e-01, -1.0000e+07],
          [-1.0000e+07, -9.2310e-02,  1.7435e-01,  ...,  6.6672e-02,
            1.5773e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-7.2275e-02, -1.3772e-02],
         [-6.7838e-02, -1.4399e-02],
         [-7.0695e-02, -3.4872e-02],
         [-4.9679e-02, -4.0589e-02],
         [-6.6429e-02, -4.8187e-02],
         [-4.9719e-02, -4.0892e-02],
         [-4.3531e-02, -4.7865e-02],
         [-5.1464e-02, -5.0239e-02],
         [-4.4687e-02, -5.0203e-02],
         [-1.8013e-02, -5.0604e-02],
         [-1.1318e-02, -3.5965e-02],
         [-4.3122e-03, -3.0927e-02],
         [-1.1730e-02, -4.1706e-02],
         [ 1.5813e-03, -4.9168e-02],
         [-3.9702e-02, -4.4297e-02],
         [-6.7924e-02, -5.0424e-02],
         [-4.0641e-02, -3.7645e-02],
         [-3.8083e-02, -4.8830e-02],
         [-3.3647e-02, -4.1056e-02],
         [-4.9475e-02, -4.5426e-02],
         [-3.3012e-02, -4.7732e-02],
         [-3.6520e-02, -5.0364e-02],
         [-5.9303e-02, -3.3803e-02],
         [-3.9183e-02, -3.9956e-02],
         [-3.2951e-02, -4.5840e-02],
         [-3.5875e-02, -5.0786e-02],
         [-3.5667e-02, -5.6073e-02],
         [-4.8678e-02, -3.4138e-02],
         [ 1.9964e-01, -3.0103e-02],
         [ 1.5332e-01, -5.1397e-02],
         [ 1.0850e-01, -4.7618e-02],
         [ 1.1844e-01, -4.9616e-02],
         [-1.4475e-01, -7.4179e-02],
         [-1.2816e-01, -7.3159e-02],
         [-1.4963e-01, -9.3419e-02],
         [ 1.5953e-01, -9.3156e-02],
         [ 1.6312e-01, -1.1065e-01],
         [ 1.5568e-01, -8.7847e-02],
         [ 1.5366e-01, -7.4816e-02],
         [ 1.1933e-01, -7.8308e-02],
         [ 1.2067e-01, -6.1851e-02],
         [ 1.2170e-01, -7.1838e-02],
         [ 1.2081e-01, -6.7306e-02],
         [ 1.2439e-01, -4.8074e-02],
         [ 1.0154e-01, -5.8890e-02],
         [ 7.2165e-02, -7.1859e-02],
         [ 1.6402e-01, -5.2451e-02],
         [-6.7529e-03, -3.1846e-02],
         [ 2.1785e-02, -1.9923e-02],
         [ 3.6720e-02, -3.5356e-03],
         [ 4.4121e-02, -1.9083e-02],
         [ 4.7585e-02, -1.6124e-02],
         [ 4.9116e-02, -1.1797e-02],
         [ 4.9755e-02,  1.0193e-03],
         [ 4.9969e-02, -3.3511e-02],
         [ 5.0025e-02, -4.2697e-02],
         [ 5.0041e-02, -6.2665e-02],
         [ 5.0028e-02, -6.2789e-02],
         [ 5.0030e-02, -1.4365e-02],
         [ 5.0032e-02, -2.7605e-03],
         [ 5.0026e-02, -2.0673e-02],
         [ 5.0025e-02,  3.7915e-03],
         [ 5.0002e-02,  7.3887e-03],
         [ 5.0023e-02,  7.5001e-03],
         [ 5.0015e-02, -3.1327e-02],
         [ 5.0015e-02, -5.4273e-02],
         [ 5.0017e-02, -8.4716e-02],
         [ 5.0010e-02, -1.0182e-01],
         [ 5.0006e-02, -1.2343e-01],
         [ 5.0007e-02, -1.1636e-01],
         [ 5.0007e-02, -1.3203e-01],
         [ 5.0008e-02, -1.4475e-01],
         [ 5.0008e-02, -1.2531e-01],
         [ 5.0008e-02, -1.0838e-01],
         [ 5.0009e-02, -1.0181e-01],
         [ 5.0008e-02, -8.8699e-02],
         [ 5.0008e-02,  2.0907e-01],
         [ 5.0008e-02, -8.8897e-02],
         [ 5.0008e-02,  2.1160e-01],
         [ 5.0009e-02, -8.8788e-02],
         [ 5.0009e-02,  2.0742e-01],
         [ 5.0009e-02, -8.1417e-02],
         [ 5.0009e-02, -3.3128e-02],
         [ 5.0009e-02, -6.3181e-02],
         [ 5.0009e-02,  2.0876e-01],
         [ 5.0009e-02, -5.5682e-02],
         [ 5.0009e-02, -5.6207e-02],
         [ 5.0009e-02,  1.4388e-01],
         [ 5.0009e-02, -7.4775e-02],
         [ 5.0009e-02,  2.1535e-01],
         [ 5.0009e-02, -6.7548e-02],
         [ 5.0009e-02, -6.3498e-02],
         [ 5.0009e-02, -7.4139e-02],
         [ 5.0009e-02, -3.4269e-02],
         [ 5.0009e-02, -6.5660e-02],
         [ 5.0009e-02,  2.0603e-01],
         [ 5.0009e-02, -8.2693e-02],
         [ 5.0009e-02, -8.4994e-02],
         [ 5.0009e-02,  2.1591e-01],
         [ 5.0009e-02,  2.1595e-01],
         [ 5.0009e-02, -6.0988e-02],
         [ 5.0009e-02, -5.4778e-02],
         [ 5.0009e-02,  1.4499e-01],
         [ 5.0009e-02,  1.5198e-01],
         [ 5.0009e-02, -3.1402e-02],
         [ 5.0009e-02, -3.9633e-02],
         [ 5.0009e-02,  1.5428e-01],
         [ 5.0009e-02, -1.5543e-02],
         [ 5.0009e-02, -1.2618e-02],
         [ 5.0009e-02,  3.3931e-03],
         [ 5.0009e-02, -6.3612e-03],
         [ 5.0009e-02, -2.0794e-02],
         [ 5.0009e-02,  1.6581e-01],
         [ 5.0009e-02, -9.8019e-03],
         [ 5.0009e-02, -1.7422e-02],
         [ 5.0009e-02, -2.8153e-02],
         [ 5.0009e-02, -4.3286e-02],
         [ 5.0009e-02, -5.1520e-02],
         [ 5.0009e-02, -7.0784e-02],
         [ 5.0009e-02, -5.3361e-02],
         [ 5.0009e-02, -4.6715e-02],
         [ 5.0009e-02, -2.2396e-02],
         [ 5.0009e-02, -1.8733e-02],
         [ 5.0009e-02, -2.6026e-02],
         [ 5.0009e-02, -3.1849e-02],
         [ 5.0009e-02, -1.3676e-02],
         [ 5.0009e-02, -2.5572e-02],
         [ 5.0009e-02, -9.9668e-03],
         [ 5.0009e-02, -1.0698e-02],
         [ 5.0009e-02, -2.0732e-02],
         [ 5.0009e-02, -6.1543e-03],
         [ 5.0009e-02, -8.4494e-03],
         [ 5.0009e-02,  2.5393e-03],
         [ 5.0009e-02,  6.7060e-03],
         [ 5.0009e-02,  8.4499e-03],
         [ 5.0009e-02,  3.3570e-05],
         [ 5.0009e-02,  7.4983e-03],
         [ 5.0009e-02, -1.2278e-02],
         [ 5.0009e-02, -4.1027e-02],
         [ 5.0009e-02, -6.2090e-02],
         [ 5.0009e-02, -7.7211e-02],
         [ 5.0009e-02, -5.7020e-02],
         [ 5.0009e-02, -3.4903e-02],
         [ 5.0009e-02, -3.4755e-02],
         [ 5.0009e-02, -2.4225e-02],
         [ 5.0009e-02, -2.9173e-02],
         [ 5.0009e-02, -3.3879e-02],
         [ 5.0009e-02, -3.7286e-02],
         [ 5.0009e-02, -5.5701e-02],
         [ 5.0009e-02, -7.0784e-02],
         [ 5.0009e-02, -5.1489e-02],
         [ 5.0009e-02, -3.0790e-02],
         [ 5.0009e-02, -3.1867e-02],
         [ 5.0009e-02, -1.2692e-02],
         [ 5.0009e-02, -4.1902e-02],
         [ 5.0009e-02, -3.1691e-02],
         [ 5.0009e-02, -3.0797e-02],
         [ 5.0009e-02, -2.0897e-02],
         [ 5.0009e-02, -2.6814e-02],
         [ 5.0009e-02, -1.9622e-02],
         [ 5.0009e-02, -2.6434e-02],
         [ 5.0009e-02, -3.2200e-02],
         [ 5.0009e-02, -3.6243e-02],
         [ 5.0009e-02, -4.2529e-03],
         [ 5.0009e-02, -1.7457e-02],
         [ 5.0009e-02,  1.9800e-03],
         [ 5.0009e-02, -1.6050e-02],
         [ 5.0009e-02, -5.2368e-02],
         [ 5.0009e-02, -7.4076e-02],
         [ 5.0009e-02, -5.6799e-02],
         [ 5.0009e-02, -1.3798e-02],
         [ 5.0009e-02,  1.0269e-04],
         [ 5.0009e-02, -5.6068e-03],
         [ 5.0009e-02, -1.8152e-02],
         [ 5.0009e-02, -3.5386e-02],
         [ 5.0009e-02, -6.4978e-02],
         [ 5.0009e-02, -3.6206e-02],
         [ 5.0009e-02, -9.1769e-03],
         [ 5.0009e-02, -2.5406e-02],
         [ 5.0009e-02, -1.6255e-02],
         [ 5.0009e-02, -2.4482e-02],
         [ 5.0009e-02, -2.7098e-02],
         [ 5.0009e-02, -2.8141e-02],
         [ 5.0009e-02, -8.0687e-03],
         [ 5.0009e-02,  6.1416e-03],
         [ 5.0009e-02, -1.1549e-02],
         [ 5.0009e-02, -2.0182e-02],
         [ 5.0009e-02, -3.7727e-02],
         [ 5.0009e-02, -6.8896e-02],
         [ 5.0009e-02, -8.2456e-02],
         [ 5.0009e-02, -9.9671e-02],
         [ 5.0009e-02, -9.7924e-02],
         [ 5.0009e-02, -1.3422e-01],
         [ 5.0009e-02, -1.2954e-01],
         [ 5.0009e-02, -1.1491e-01],
         [ 5.0009e-02, -1.0161e-01],
         [ 5.0009e-02, -7.0541e-02],
         [ 5.0009e-02, -5.0242e-02],
         [ 5.0009e-02, -6.0859e-02],
         [ 5.0009e-02,  2.0411e-01],
         [ 5.0009e-02,  2.0884e-01],
         [ 5.0009e-02,  2.1578e-01],
         [ 5.0009e-02,  2.0721e-01],
         [ 5.0009e-02,  2.0946e-01],
         [ 5.0009e-02,  2.2316e-01],
         [ 5.0009e-02,  2.1167e-01],
         [ 5.0009e-02,  2.1150e-01],
         [ 5.0009e-02,  2.2798e-01],
         [ 5.0009e-02,  2.3446e-01],
         [ 5.0009e-02,  2.2232e-01],
         [ 5.0009e-02,  2.1819e-01],
         [ 5.0009e-02,  2.3202e-01],
         [ 5.0009e-02,  2.2175e-01],
         [ 5.0009e-02,  2.1719e-01],
         [ 5.0009e-02,  2.2223e-01],
         [ 5.0009e-02,  2.1849e-01],
         [ 5.0009e-02,  2.1665e-01],
         [ 5.0009e-02,  2.0862e-01],
         [ 5.0009e-02,  2.1844e-01],
         [ 5.0009e-02,  2.0040e-01],
         [ 5.0009e-02,  2.0570e-01],
         [ 5.0009e-02, -1.3586e-01],
         [ 5.0009e-02, -1.1941e-01],
         [ 5.0009e-02,  5.1394e-02]],

        [[-5.8723e-02, -2.2603e-02],
         [-8.9456e-02, -6.3036e-02],
         [-1.0500e-01, -9.2310e-02],
         [-9.2366e-02, -1.0740e-01],
         [-1.1294e-01, -1.1340e-01],
         [-1.1585e-01, -1.1880e-01],
         [-1.0370e-01, -1.1376e-01],
         [-1.1224e-01, -1.1411e-01],
         [-9.7600e-02, -1.1629e-01],
         [-8.9549e-02, -1.3010e-01],
         [-9.3151e-02, -1.3084e-01],
         [-9.8237e-02, -1.2518e-01],
         [-6.8090e-02, -1.1886e-01],
         [ 1.7813e-01, -1.1443e-01],
         [ 1.4711e-01, -1.3327e-01],
         [-1.1417e-01, -1.2238e-01],
         [ 1.1727e-01, -1.2528e-01],
         [-9.2213e-02,  1.2055e-01],
         [-5.9377e-02, -1.5927e-01],
         [-9.8660e-02, -1.3547e-01],
         [-8.4213e-02, -1.0536e-01],
         [-8.4686e-02, -8.8737e-02],
         [-5.4416e-02, -4.6168e-03],
         [-4.6254e-02,  2.7519e-02],
         [-4.9675e-02,  4.3186e-02],
         [-1.5247e-02,  5.0276e-02],
         [-1.0008e-02,  5.3264e-02],
         [-1.5284e-02,  5.4445e-02],
         [-1.9647e-02,  5.4922e-02],
         [-2.2002e-02,  5.5045e-02],
         [-2.2926e-02,  5.5093e-02],
         [-5.3363e-02,  5.5147e-02],
         [-7.8626e-02,  5.5152e-02],
         [-8.1917e-02,  5.5134e-02],
         [-8.2162e-02,  5.5194e-02],
         [-8.2757e-02,  5.5200e-02],
         [-8.6317e-02,  5.5204e-02],
         [-1.0313e-01,  5.5206e-02],
         [-9.8174e-02,  5.5214e-02],
         [-1.1027e-01,  5.5214e-02],
         [-1.0584e-01,  5.5206e-02],
         [-7.4892e-02,  5.5218e-02],
         [-5.1354e-02,  5.5221e-02],
         [-6.5574e-02,  5.5232e-02],
         [-8.5466e-02,  5.5230e-02],
         [-8.2423e-02,  5.5230e-02],
         [-5.7820e-02,  5.5234e-02],
         [-4.0582e-02,  5.5235e-02],
         [-5.1456e-02,  5.5235e-02],
         [-4.7512e-02,  5.5232e-02],
         [-6.2961e-02,  5.5232e-02],
         [-4.6562e-02,  5.5231e-02],
         [-5.8392e-02,  5.5231e-02],
         [-7.9428e-02,  5.5231e-02],
         [-9.6358e-02,  5.5231e-02],
         [-7.1607e-02,  5.5231e-02],
         [-5.0683e-02,  5.5231e-02],
         [-4.0951e-02,  5.5231e-02],
         [-2.9707e-02,  5.5231e-02],
         [-5.7637e-02,  5.5231e-02],
         [-6.8162e-02,  5.5231e-02],
         [-9.1554e-02,  5.5231e-02],
         [-1.0515e-01,  5.5231e-02],
         [-1.0283e-01,  5.5231e-02],
         [ 1.7818e-01,  5.5231e-02],
         [ 1.8233e-01,  5.5231e-02],
         [-9.9189e-02,  5.5231e-02],
         [-1.0497e-01,  5.5231e-02],
         [-1.0103e-01,  5.5231e-02],
         [-7.1960e-02,  5.5231e-02],
         [-4.9988e-02,  5.5231e-02],
         [-4.0193e-02,  5.5231e-02],
         [-2.9271e-02,  5.5231e-02],
         [-3.3594e-02,  5.5231e-02],
         [-5.7456e-02,  5.5231e-02],
         [-4.2226e-02,  5.5231e-02],
         [-3.0877e-02,  5.5231e-02],
         [-3.4407e-02,  5.5231e-02],
         [-4.4733e-02,  5.5231e-02],
         [-6.5138e-02,  5.5231e-02],
         [-7.2346e-02,  5.5231e-02],
         [-8.7662e-02,  5.5231e-02],
         [-8.9840e-02,  5.5231e-02],
         [-7.0629e-02,  5.5231e-02],
         [-6.5846e-02,  5.5231e-02],
         [-6.6572e-02,  5.5231e-02],
         [-8.0950e-02,  5.5231e-02],
         [-8.2309e-02,  5.5231e-02],
         [-1.0028e-01,  5.5231e-02],
         [-9.2496e-02,  5.5231e-02],
         [-7.2206e-02,  5.5231e-02],
         [-8.4654e-02,  5.5231e-02],
         [-8.0422e-02,  5.5231e-02],
         [-9.5285e-02,  5.5231e-02],
         [ 1.1400e-01,  5.5231e-02],
         [-1.0633e-01,  5.5231e-02],
         [ 1.1089e-01,  5.5231e-02],
         [ 1.2450e-01,  5.5231e-02],
         [ 1.4518e-01,  5.5231e-02],
         [ 1.3098e-01,  5.5231e-02],
         [ 1.3895e-01,  5.5231e-02],
         [ 1.3622e-01,  5.5231e-02],
         [ 1.4585e-01,  5.5231e-02],
         [ 1.3354e-01,  5.5231e-02],
         [ 1.4076e-01,  5.5231e-02],
         [ 1.0553e-01,  5.5231e-02],
         [ 1.0599e-01,  5.5231e-02],
         [ 1.1960e-01,  5.5231e-02],
         [ 1.2587e-01,  5.5231e-02],
         [ 2.0210e-01,  5.5231e-02],
         [ 9.6539e-02,  5.5231e-02],
         [ 2.2029e-01,  5.5231e-02],
         [ 9.8385e-02,  5.5231e-02],
         [ 1.9671e-01,  5.5231e-02],
         [ 1.9030e-01,  5.5231e-02],
         [ 1.8635e-01,  5.5231e-02],
         [ 8.4048e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.2894e-05, device='cuda:0') tensor(0.0008, device='cuda:0') tensor(-0.0019, device='cuda:0')
mixer_td_error tensor(0.5728, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4595, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.2355, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0469, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1493, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1219, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2388392.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2345, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.1990e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0023, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3162, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2148, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3162, device='cuda:0', grad_fn=<MinBackward1>)
t_env 578
target_mac_out tensor([[[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9456e-02,  9.6197e-02,  ...,  8.5356e-03,
            1.5201e-01, -1.0000e+07],
          [-1.0000e+07, -6.3036e-02,  1.6373e-01,  ...,  4.7519e-02,
            1.4996e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0500e-01,  1.1218e-01,  ...,  3.6129e-02,
            1.7218e-01, -1.0000e+07],
          [-1.0000e+07, -9.2310e-02,  1.7435e-01,  ...,  6.6672e-02,
            1.5773e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0703e-01,  7.6857e-02,  ...,  7.6963e-02,
            1.9030e-01, -3.2883e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1889e-01, -1.0000e+07,  ..., -1.0000e+07,
            1.8635e-01, -3.2443e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 8.4048e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0948e-02,  7.3316e-02,  ...,  4.2360e-02,
            1.4141e-01, -1.0000e+07],
          [-1.0000e+07, -1.8789e-02,  1.1070e-01,  ...,  4.1064e-03,
            1.2950e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0493e-01,  9.5342e-02,  ...,  2.8501e-02,
            1.6248e-01, -1.0000e+07],
          [-1.0000e+07, -2.5057e-02,  1.2023e-01,  ..., -1.0731e-02,
            1.3315e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.8723e-02,  1.2843e-01],
         [ 9.6197e-02,  1.6373e-01],
         [ 3.6129e-02,  1.7435e-01],
         [ 3.9035e-02,  1.4191e-01],
         [ 3.1683e-02,  1.5448e-01],
         [ 1.2262e-02,  1.7899e-01],
         [ 3.3030e-02,  1.5000e-01],
         [ 3.6796e-02, -1.1411e-01],
         [ 5.0384e-02, -1.1629e-01],
         [ 3.8489e-02,  1.4491e-01],
         [-9.3151e-02,  1.4860e-01],
         [ 1.1595e-01,  4.8406e-02],
         [ 1.4084e-01, -1.1886e-01],
         [ 1.7813e-01, -1.1443e-01],
         [ 1.4711e-01,  1.6084e-01],
         [ 1.1646e-01,  1.5636e-01],
         [ 1.1727e-01,  1.5379e-01],
         [ 4.8413e-02,  7.5578e-02],
         [-5.9377e-02,  6.0707e-02],
         [ 5.5953e-02,  5.3347e-02],
         [ 5.8017e-02, -1.0536e-01],
         [ 9.2136e-02, -8.8737e-02],
         [-5.4416e-02, -4.6168e-03],
         [-4.6254e-02,  2.7519e-02],
         [-4.9675e-02,  4.3186e-02],
         [-1.5247e-02,  5.0276e-02],
         [ 1.4702e-01,  5.3264e-02],
         [-1.5284e-02,  5.4445e-02],
         [-1.9647e-02,  5.4922e-02],
         [-2.2002e-02,  5.5045e-02],
         [-2.2926e-02,  5.5093e-02],
         [ 4.5163e-02,  5.5147e-02],
         [ 9.8585e-02,  5.5152e-02],
         [ 8.8775e-02,  5.5134e-02],
         [-8.2162e-02,  5.5194e-02],
         [ 7.6574e-02,  5.5200e-02],
         [ 7.6345e-02,  5.5204e-02],
         [ 8.8881e-02,  5.5206e-02],
         [ 8.1957e-02,  5.5214e-02],
         [ 9.1618e-02,  5.5214e-02],
         [ 7.0254e-02,  5.5206e-02],
         [-7.4892e-02,  5.5218e-02],
         [-5.1354e-02,  5.5221e-02],
         [ 5.5986e-02,  5.5232e-02],
         [ 9.9361e-02,  5.5230e-02],
         [ 7.7583e-02,  5.5230e-02],
         [ 4.4735e-02,  5.5234e-02],
         [-4.0582e-02,  5.5235e-02],
         [-5.1456e-02,  5.5235e-02],
         [-4.7512e-02,  5.5232e-02],
         [ 5.9045e-02,  5.5232e-02],
         [-4.6562e-02,  5.5231e-02],
         [ 7.9144e-02,  5.5231e-02],
         [ 6.0440e-02,  5.5231e-02],
         [ 1.0784e-01,  5.5231e-02],
         [-7.1607e-02,  5.5231e-02],
         [-5.0683e-02,  5.5231e-02],
         [-4.0951e-02,  5.5231e-02],
         [-2.9707e-02,  5.5231e-02],
         [ 5.2117e-02,  5.5231e-02],
         [ 4.1335e-02,  5.5231e-02],
         [ 9.4216e-02,  5.5231e-02],
         [ 9.8911e-02,  5.5231e-02],
         [ 7.4679e-02,  5.5231e-02],
         [ 8.0014e-02,  5.5231e-02],
         [ 8.3372e-02,  5.5231e-02],
         [ 7.2725e-02,  5.5231e-02],
         [ 9.3382e-02,  5.5231e-02],
         [ 7.3685e-02,  5.5231e-02],
         [-7.1960e-02,  5.5231e-02],
         [-4.9988e-02,  5.5231e-02],
         [-4.0193e-02,  5.5231e-02],
         [-2.9271e-02,  5.5231e-02],
         [-3.3594e-02,  5.5231e-02],
         [ 4.1929e-02,  5.5231e-02],
         [ 5.1892e-02,  5.5231e-02],
         [-3.0877e-02,  5.5231e-02],
         [-3.4407e-02,  5.5231e-02],
         [-4.4733e-02,  5.5231e-02],
         [ 5.4329e-02,  5.5231e-02],
         [ 4.3121e-02,  5.5231e-02],
         [ 6.6343e-02,  5.5231e-02],
         [ 7.6422e-02,  5.5231e-02],
         [-7.0629e-02,  5.5231e-02],
         [-6.5846e-02,  5.5231e-02],
         [-6.6572e-02,  5.5231e-02],
         [ 5.3367e-02,  5.5231e-02],
         [ 4.4420e-02,  5.5231e-02],
         [ 9.6115e-02,  5.5231e-02],
         [ 7.4065e-02,  5.5231e-02],
         [ 3.8446e-02,  5.5231e-02],
         [ 6.6564e-02,  5.5231e-02],
         [ 3.3533e-02,  5.5231e-02],
         [ 9.3156e-02,  5.5231e-02],
         [ 7.9940e-02,  5.5231e-02],
         [ 7.3915e-02,  5.5231e-02],
         [ 1.0076e-01,  5.5231e-02],
         [ 1.1519e-01,  5.5231e-02],
         [ 1.2657e-01,  5.5231e-02],
         [ 1.0455e-01,  5.5231e-02],
         [ 1.2117e-01,  5.5231e-02],
         [ 1.3622e-01,  5.5231e-02],
         [ 1.4585e-01,  5.5231e-02],
         [ 1.1032e-01,  5.5231e-02],
         [ 1.2952e-01,  5.5231e-02],
         [ 1.0745e-01,  5.5231e-02],
         [ 7.9400e-02,  5.5231e-02],
         [ 1.1960e-01,  5.5231e-02],
         [ 1.2587e-01,  5.5231e-02],
         [ 2.0210e-01,  5.5231e-02],
         [ 7.8725e-02,  5.5231e-02],
         [ 2.2029e-01,  5.5231e-02],
         [ 7.8959e-02,  5.5231e-02],
         [ 7.7155e-02,  5.5231e-02],
         [ 7.6963e-02,  5.5231e-02],
         [ 1.8635e-01,  5.5231e-02],
         [ 8.4048e-03,  5.5231e-02]],

        [[ 6.0687e-02, -1.6811e-02],
         [ 4.2360e-02, -1.8789e-02],
         [ 2.8501e-02, -2.5057e-02],
         [ 2.9640e-02, -4.2417e-02],
         [ 3.5810e-02, -4.0353e-02],
         [ 5.2820e-02, -4.8187e-02],
         [ 6.0988e-02, -3.1261e-02],
         [ 3.0616e-02,  9.9181e-02],
         [ 6.4071e-02, -4.0001e-02],
         [ 5.4435e-02, -4.6573e-02],
         [ 2.9719e-02,  2.0107e-01],
         [ 3.3296e-02,  5.9647e-02],
         [ 4.5309e-02,  8.7586e-02],
         [ 5.5364e-02,  7.2197e-02],
         [ 7.5064e-02,  9.5860e-02],
         [ 5.5580e-02,  1.1120e-01],
         [ 5.9419e-02,  6.1310e-02],
         [-4.0418e-02,  9.2291e-02],
         [-5.1149e-02,  1.1168e-01],
         [ 1.0297e-01,  9.8834e-02],
         [-4.2105e-02,  8.4255e-02],
         [ 9.8854e-02,  1.0924e-01],
         [ 5.7518e-02,  7.3993e-02],
         [ 5.9854e-02,  7.3967e-02],
         [ 4.6125e-02,  1.0369e-01],
         [ 7.0213e-02,  9.6969e-02],
         [ 7.4868e-02,  6.9986e-02],
         [ 1.5355e-01,  6.0494e-02],
         [ 1.3319e-01,  1.2472e-01],
         [ 1.4755e-01,  1.3836e-01],
         [ 1.4394e-01,  5.6551e-02],
         [ 8.1534e-02, -1.1742e-01],
         [ 9.6318e-02, -1.1364e-01],
         [ 5.8648e-02, -1.0852e-01],
         [ 1.4213e-01,  1.3700e-01],
         [ 8.2481e-02, -6.4278e-03],
         [ 7.8019e-02,  2.5142e-02],
         [ 8.6109e-02,  4.2084e-02],
         [ 6.7993e-02,  5.0180e-02],
         [ 6.3024e-02,  5.3727e-02],
         [ 1.0120e-01,  5.5128e-02],
         [ 4.1879e-02,  5.5544e-02],
         [ 1.2780e-01,  5.5612e-02],
         [ 7.8688e-02,  5.5523e-02],
         [ 1.1408e-01,  5.5444e-02],
         [ 7.8680e-02,  5.5359e-02],
         [ 9.4646e-02,  5.5309e-02],
         [ 9.5243e-02,  5.5259e-02],
         [ 9.3598e-02,  5.5215e-02],
         [ 8.0578e-02,  5.5232e-02],
         [ 5.6439e-02,  5.5209e-02],
         [ 1.0299e-01,  5.5215e-02],
         [ 8.2706e-02,  5.5215e-02],
         [ 1.1988e-01,  5.5220e-02],
         [ 7.6278e-02,  5.5223e-02],
         [ 6.8910e-02,  5.5231e-02],
         [ 5.9720e-02,  5.5232e-02],
         [ 1.5547e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0002, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0031, device='cuda:0')
mixer_td_error tensor(0.5631, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5034, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9026, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0338, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1009, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1158, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2521367.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2203, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0025, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2235, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1381, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2235, device='cuda:0', grad_fn=<MinBackward1>)
t_env 779
target_mac_out tensor([[[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4689e-02,  1.0709e-01,  ...,  1.4450e-02,
            1.5237e-01, -1.0000e+07],
          [-1.0000e+07, -2.1835e-02,  9.9402e-02,  ..., -1.5839e-02,
            1.3204e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0286e-02,  1.0929e-01,  ...,  4.9539e-03,
            1.4714e-01, -1.0000e+07],
          [-1.0000e+07, -4.0755e-02,  1.1664e-01,  ..., -1.3107e-02,
            1.4728e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0695e-02,  8.8884e-02,  ...,  1.4652e-02,
            1.4204e-01, -1.0000e+07],
          [-1.0000e+07, -3.4872e-02,  9.9288e-02,  ..., -3.2764e-02,
            1.3673e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3586e-01,  4.0597e-02,  ...,  4.7742e-02,
            1.9922e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1941e-01,  1.6392e-02,  ...,  4.5058e-02,
            1.8264e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.1394e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.2300e-02,  8.8635e-02],
         [ 1.0709e-01,  9.9402e-02],
         [ 1.0929e-01,  1.1664e-01],
         [ 1.1707e-01,  1.4906e-01],
         [ 1.2279e-01,  1.5190e-01],
         [ 9.8224e-02,  1.1788e-01],
         [ 9.0415e-02,  1.1747e-01],
         [ 1.1010e-01,  7.5451e-02],
         [ 1.0275e-01, -7.5380e-02],
         [ 1.1137e-01,  9.3524e-02],
         [ 1.1450e-01,  8.5916e-02],
         [ 1.1551e-01,  8.5467e-02],
         [-3.4390e-02,  1.1707e-01],
         [ 1.2004e-01,  1.3088e-01],
         [ 1.1997e-01,  8.9258e-02],
         [ 1.2702e-01,  1.0430e-01],
         [ 1.0899e-01,  8.6519e-02],
         [ 1.0240e-01,  1.2646e-01],
         [ 1.0996e-01,  1.3615e-01],
         [ 1.1185e-01,  1.4356e-01],
         [ 1.2247e-01,  1.2033e-01],
         [ 1.2840e-01,  9.6356e-02],
         [ 1.2090e-01,  1.0689e-01],
         [ 9.7435e-02,  1.1374e-01],
         [ 1.2041e-01,  1.1817e-01],
         [ 1.1333e-01,  1.0346e-01],
         [ 1.1270e-01,  9.2009e-02],
         [ 1.3086e-01,  1.1294e-01],
         [ 1.3902e-01,  1.1477e-01],
         [ 1.2469e-01,  8.2680e-02],
         [ 1.1915e-01,  5.7627e-02],
         [ 1.1927e-01,  7.5070e-02],
         [ 1.1176e-01,  8.6550e-02],
         [ 1.2861e-01,  8.1180e-02],
         [ 1.3395e-01,  1.1226e-01],
         [ 1.4656e-01,  1.0098e-01],
         [ 1.4738e-01,  1.2232e-01],
         [ 1.3493e-01,  1.3158e-01],
         [ 9.9820e-02,  1.1388e-01],
         [ 9.7208e-02,  1.2943e-01],
         [ 8.8163e-02,  1.4022e-01],
         [ 1.0250e-01,  1.4787e-01],
         [ 7.1497e-02,  1.2195e-01],
         [ 9.1572e-02,  1.4120e-01],
         [ 1.0760e-01,  1.0981e-01],
         [ 9.7120e-02,  1.2752e-01],
         [ 1.1733e-01,  9.8038e-02],
         [ 1.1415e-01,  1.2168e-01],
         [ 1.1194e-01,  1.3593e-01],
         [ 1.2551e-01,  1.2816e-01],
         [ 1.3092e-01,  1.0309e-01],
         [ 1.3263e-01,  1.2196e-01],
         [ 1.3071e-01,  1.1071e-01],
         [ 1.1640e-01,  9.5609e-02],
         [ 1.1093e-01,  8.8856e-02],
         [ 1.2401e-01,  1.2196e-01],
         [ 1.0169e-01,  1.3879e-01],
         [ 1.1193e-01,  1.5026e-01],
         [ 1.1108e-01,  1.4903e-01],
         [ 1.1977e-01,  1.1366e-01],
         [ 1.3219e-01,  1.3963e-01],
         [ 1.1138e-01,  1.1566e-01],
         [ 1.2885e-01,  1.4543e-01],
         [ 1.2644e-01,  1.1881e-01],
         [ 1.3949e-01,  1.4211e-01],
         [ 1.4276e-01,  1.4916e-01],
         [ 1.4168e-01,  1.4817e-01],
         [ 1.1640e-01,  1.0859e-01],
         [ 1.4400e-01,  1.2352e-01],
         [ 1.2612e-01,  1.3480e-01],
         [ 1.2655e-01,  1.1539e-01],
         [ 1.4689e-01,  8.5303e-02],
         [ 1.4433e-01,  1.1715e-01],
         [ 1.5643e-01,  1.3132e-01],
         [ 1.3460e-01,  8.9971e-02],
         [ 1.5093e-01,  8.7945e-02],
         [ 1.6464e-01,  1.1095e-01],
         [ 1.6342e-01,  7.6047e-02],
         [ 2.4488e-03,  5.3342e-02],
         [ 2.3410e-02, -3.7074e-02],
         [ 3.6787e-02,  7.3539e-02],
         [ 4.3993e-02, -1.5429e-02],
         [ 4.7565e-02,  7.8357e-02],
         [ 4.9168e-02, -2.0664e-02],
         [ 4.9817e-02,  7.5020e-02],
         [ 5.0045e-02, -1.9710e-02],
         [ 5.0112e-02,  7.5272e-02],
         [ 5.0088e-02,  8.5826e-02],
         [ 5.0075e-02,  5.3661e-02],
         [ 5.0057e-02,  5.2588e-02],
         [ 5.0027e-02,  7.8125e-02],
         [ 5.0040e-02,  5.5094e-02],
         [ 5.0031e-02, -2.2996e-02],
         [ 5.0025e-02, -1.7798e-02],
         [ 5.0022e-02,  7.0423e-02],
         [ 5.0021e-02,  8.8702e-02],
         [ 5.0015e-02,  9.7786e-02],
         [ 5.0012e-02,  6.0236e-02],
         [ 5.0019e-02,  5.6854e-02],
         [ 5.0005e-02,  4.3161e-02],
         [ 5.0006e-02, -2.0558e-02],
         [ 5.0008e-02,  7.3949e-02],
         [ 5.0008e-02,  5.2891e-02],
         [ 5.0008e-02,  8.3104e-02],
         [ 5.0009e-02,  9.4228e-02],
         [ 5.0008e-02,  9.8239e-02],
         [ 5.0008e-02,  7.3393e-02],
         [ 5.0008e-02,  8.3121e-02],
         [ 5.0008e-02,  5.7210e-02],
         [ 5.0008e-02,  8.5381e-02],
         [ 5.0009e-02,  9.3723e-02],
         [ 5.0009e-02,  1.0113e-01],
         [ 5.0009e-02,  6.2513e-02],
         [ 5.0009e-02,  4.9779e-02],
         [ 5.0009e-02, -2.7205e-02],
         [ 5.0009e-02,  7.4228e-02],
         [ 5.0009e-02,  4.9513e-02],
         [ 5.0009e-02, -3.5934e-02],
         [ 5.0009e-02, -1.1604e-02],
         [ 5.0009e-02, -1.5037e-03],
         [ 5.0009e-02,  7.1092e-02],
         [ 5.0009e-02,  5.8651e-02],
         [ 5.0009e-02,  7.7418e-02],
         [ 5.0009e-02,  4.4231e-02],
         [ 5.0009e-02,  3.8819e-02],
         [ 5.0009e-02, -3.6481e-02],
         [ 5.0009e-02,  7.7099e-02],
         [ 5.0009e-02, -1.4424e-02],
         [ 5.0009e-02,  8.2009e-02],
         [ 5.0009e-02, -1.0880e-02],
         [ 5.0009e-02, -2.1796e-03],
         [ 5.0009e-02,  7.1920e-02],
         [ 5.0009e-02,  8.5182e-02],
         [ 5.0009e-02,  5.4100e-02],
         [ 5.0009e-02,  8.2107e-02],
         [ 5.0009e-02,  9.4690e-02],
         [ 5.0009e-02,  5.8548e-02],
         [ 5.0009e-02,  3.7447e-02],
         [ 5.0009e-02,  7.8351e-02],
         [ 5.0009e-02,  9.2915e-02],
         [ 5.0009e-02,  5.4285e-02],
         [ 5.0009e-02,  8.4851e-02],
         [ 5.0009e-02,  5.1879e-02],
         [ 5.0009e-02,  4.4032e-02],
         [ 5.0009e-02,  5.1066e-02],
         [ 5.0009e-02,  4.9209e-02],
         [ 5.0009e-02,  3.2973e-02],
         [ 5.0009e-02,  4.1082e-02],
         [ 5.0009e-02, -4.4343e-02],
         [ 5.0009e-02,  7.0204e-02],
         [ 5.0009e-02,  8.9803e-02],
         [ 5.0009e-02,  6.2601e-02],
         [ 5.0009e-02,  4.7889e-02],
         [ 5.0009e-02, -1.0031e-02],
         [ 5.0009e-02, -1.0247e-02],
         [ 5.0009e-02, -7.9768e-03],
         [ 5.0009e-02, -5.9288e-03],
         [ 5.0009e-02,  6.3641e-02],
         [ 5.0009e-02, -2.7162e-02],
         [ 5.0009e-02, -6.2309e-03],
         [ 5.0009e-02,  7.5637e-02],
         [ 5.0009e-02,  8.8279e-02],
         [ 5.0009e-02,  5.0821e-02],
         [ 5.0009e-02,  5.6433e-02],
         [ 5.0009e-02,  5.3359e-02],
         [ 5.0009e-02, -4.0317e-02],
         [ 5.0009e-02, -2.4805e-02],
         [ 5.0009e-02, -6.2786e-03],
         [ 5.0009e-02,  7.2579e-02],
         [ 5.0009e-02,  8.5649e-02],
         [ 5.0009e-02, -1.2467e-02],
         [ 5.0009e-02,  7.8798e-02],
         [ 5.0009e-02,  8.8902e-02],
         [ 5.0009e-02,  5.0969e-02],
         [ 5.0009e-02,  8.5305e-02],
         [ 5.0009e-02,  9.6662e-02],
         [ 5.0009e-02,  1.0111e-01],
         [ 5.0009e-02,  1.0525e-01],
         [ 5.0009e-02,  1.2110e-01],
         [ 5.0009e-02,  1.1905e-01],
         [ 5.0009e-02,  8.1493e-02],
         [ 5.0009e-02,  5.4724e-02],
         [ 5.0009e-02,  8.5680e-02],
         [ 5.0009e-02,  9.8182e-02],
         [ 5.0009e-02,  7.0510e-02],
         [ 5.0009e-02,  9.8478e-02],
         [ 5.0009e-02,  6.5444e-02],
         [ 5.0009e-02,  7.1292e-02],
         [ 5.0009e-02,  8.0597e-02],
         [ 5.0009e-02,  7.6084e-02],
         [ 5.0009e-02,  7.0666e-02],
         [ 5.0009e-02,  8.5560e-02],
         [ 5.0009e-02,  8.5482e-02],
         [ 5.0009e-02,  8.8488e-02],
         [ 5.0009e-02,  5.7154e-02],
         [ 5.0009e-02,  4.6379e-02],
         [ 5.0009e-02,  6.8469e-02],
         [ 5.0009e-02,  5.4959e-02],
         [ 5.0009e-02,  4.3734e-02],
         [ 5.0009e-02,  2.7674e-02],
         [ 5.0009e-02,  8.5720e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.6186e-02,  8.7099e-02],
         [ 6.9213e-02,  1.0899e-01],
         [ 8.8884e-02,  9.9288e-02],
         [-4.9679e-02,  8.8649e-02],
         [ 1.1814e-01,  1.1219e-01],
         [ 1.0716e-01,  1.1003e-01],
         [ 1.0986e-01,  9.5288e-02],
         [ 1.2487e-01,  1.1727e-01],
         [ 1.1758e-01,  1.0258e-01],
         [ 1.5183e-01,  1.2731e-01],
         [ 1.7336e-01,  1.1188e-01],
         [ 1.8323e-01,  1.0340e-01],
         [ 1.5019e-01,  1.2251e-01],
         [ 1.6608e-01,  1.3316e-01],
         [ 1.4368e-01,  9.9764e-02],
         [ 1.3013e-01,  1.2584e-01],
         [ 1.5058e-01,  1.1515e-01],
         [ 1.7461e-01,  1.4160e-01],
         [ 1.8083e-01,  1.2839e-01],
         [ 1.3143e-01,  1.4630e-01],
         [ 1.4003e-01,  1.5612e-01],
         [ 1.6183e-01,  1.5992e-01],
         [ 1.1678e-01,  1.3547e-01],
         [ 1.3169e-01,  1.2089e-01],
         [ 1.5533e-01,  1.4156e-01],
         [ 1.6582e-01,  1.5210e-01],
         [ 1.8747e-01,  1.3380e-01],
         [ 1.9394e-01,  7.9628e-02],
         [ 1.9964e-01, -3.0103e-02],
         [ 1.5332e-01,  6.6817e-02],
         [ 1.0850e-01,  5.5569e-02],
         [ 1.1844e-01,  4.8865e-02],
         [ 1.2093e-01,  7.1316e-02],
         [ 1.1190e-01,  8.2845e-02],
         [ 1.5083e-01,  1.2766e-01],
         [ 1.5953e-01,  1.1280e-01],
         [ 1.6312e-01,  1.3203e-01],
         [ 1.5568e-01,  8.2679e-02],
         [ 1.5366e-01,  4.1310e-02],
         [ 1.1933e-01,  7.4219e-02],
         [ 1.2067e-01,  4.4230e-02],
         [ 1.2170e-01,  8.1386e-02],
         [ 1.2081e-01,  5.3889e-02],
         [ 1.2439e-01,  4.5646e-02],
         [ 1.0154e-01,  7.8442e-02],
         [ 7.2165e-02,  9.4530e-02],
         [ 6.0676e-02,  6.5290e-02],
         [-6.7529e-03,  4.9328e-02],
         [ 2.1785e-02, -1.9923e-02],
         [ 3.6720e-02, -3.5356e-03],
         [ 4.4121e-02,  7.2614e-02],
         [ 4.7585e-02, -1.6124e-02],
         [ 4.9116e-02, -1.1797e-02],
         [ 4.9755e-02,  1.0193e-03],
         [ 4.9969e-02,  6.7443e-02],
         [ 5.0025e-02,  4.3906e-02],
         [ 5.0041e-02,  7.6199e-02],
         [ 5.0028e-02,  4.9123e-02],
         [ 5.0030e-02,  8.8267e-02],
         [ 5.0032e-02, -2.7605e-03],
         [ 5.0026e-02,  8.3697e-02],
         [ 5.0025e-02,  9.2182e-02],
         [ 5.0002e-02,  7.3887e-03],
         [ 5.0023e-02,  7.5001e-03],
         [ 5.0015e-02,  7.1784e-02],
         [ 5.0015e-02,  8.4728e-02],
         [ 5.0017e-02,  1.1190e-01],
         [ 5.0010e-02,  1.1439e-01],
         [ 5.0006e-02,  1.2453e-01],
         [ 5.0007e-02,  7.5143e-02],
         [ 5.0007e-02,  9.5517e-02],
         [ 5.0008e-02,  1.0419e-01],
         [ 5.0008e-02,  6.0583e-02],
         [ 5.0008e-02,  6.6206e-02],
         [ 5.0009e-02,  4.7820e-02],
         [ 5.0008e-02,  3.2545e-02],
         [ 5.0008e-02,  7.1791e-02],
         [ 5.0008e-02,  5.2278e-02],
         [ 5.0008e-02,  7.9627e-02],
         [ 5.0009e-02,  4.7255e-02],
         [ 5.0009e-02,  8.0606e-02],
         [ 5.0009e-02,  6.0086e-02],
         [ 5.0009e-02,  8.7622e-02],
         [ 5.0009e-02,  9.3214e-02],
         [ 5.0009e-02,  9.8088e-02],
         [ 5.0009e-02,  9.4704e-02],
         [ 5.0009e-02,  1.2971e-01],
         [ 5.0009e-02,  1.4388e-01],
         [ 5.0009e-02,  9.4154e-02],
         [ 5.0009e-02,  9.3596e-02],
         [ 5.0009e-02,  9.0519e-02],
         [ 5.0009e-02,  1.2746e-01],
         [ 5.0009e-02,  8.6365e-02],
         [ 5.0009e-02,  9.9241e-02],
         [ 5.0009e-02,  9.6803e-02],
         [ 5.0009e-02,  1.0001e-01],
         [ 5.0009e-02,  7.7919e-02],
         [ 5.0009e-02,  4.9976e-02],
         [ 5.0009e-02,  7.5075e-02],
         [ 5.0009e-02,  9.0214e-02],
         [ 5.0009e-02,  9.2185e-02],
         [ 5.0009e-02,  1.2950e-01],
         [ 5.0009e-02,  1.4499e-01],
         [ 5.0009e-02,  1.5198e-01],
         [ 5.0009e-02,  1.1823e-01],
         [ 5.0009e-02,  1.4446e-01],
         [ 5.0009e-02,  1.5428e-01],
         [ 5.0009e-02,  1.3487e-01],
         [ 5.0009e-02,  9.2630e-02],
         [ 5.0009e-02,  9.5888e-02],
         [ 5.0009e-02,  1.3910e-01],
         [ 5.0009e-02,  1.5229e-01],
         [ 5.0009e-02,  1.6581e-01],
         [ 5.0009e-02,  1.2716e-01],
         [ 5.0009e-02,  1.5911e-01],
         [ 5.0009e-02,  1.6409e-01],
         [ 5.0009e-02,  1.0157e-01],
         [ 5.0009e-02,  5.2968e-02],
         [ 5.0009e-02,  8.4554e-02],
         [ 5.0009e-02,  6.1688e-02],
         [ 5.0009e-02,  8.8785e-02],
         [ 5.0009e-02,  7.1751e-02],
         [ 5.0009e-02, -1.8733e-02],
         [ 5.0009e-02,  7.4629e-02],
         [ 5.0009e-02,  8.7573e-02],
         [ 5.0009e-02,  6.7375e-02],
         [ 5.0009e-02,  8.2158e-02],
         [ 5.0009e-02, -9.9668e-03],
         [ 5.0009e-02, -1.0698e-02],
         [ 5.0009e-02,  7.1263e-02],
         [ 5.0009e-02, -6.1543e-03],
         [ 5.0009e-02, -8.4494e-03],
         [ 5.0009e-02,  2.5393e-03],
         [ 5.0009e-02,  6.7060e-03],
         [ 5.0009e-02,  8.4499e-03],
         [ 5.0009e-02,  3.3570e-05],
         [ 5.0009e-02,  7.4983e-03],
         [ 5.0009e-02,  6.7078e-02],
         [ 5.0009e-02,  8.0178e-02],
         [ 5.0009e-02,  9.2616e-02],
         [ 5.0009e-02,  9.9661e-02],
         [ 5.0009e-02,  6.7706e-02],
         [ 5.0009e-02,  5.0590e-02],
         [ 5.0009e-02,  8.0636e-02],
         [ 5.0009e-02,  5.1483e-02],
         [ 5.0009e-02,  7.8346e-02],
         [ 5.0009e-02,  8.9622e-02],
         [ 5.0009e-02,  9.4775e-02],
         [ 5.0009e-02,  9.5306e-02],
         [ 5.0009e-02,  1.0071e-01],
         [ 5.0009e-02,  6.7947e-02],
         [ 5.0009e-02,  5.0729e-02],
         [ 5.0009e-02,  8.0737e-02],
         [ 5.0009e-02, -1.2692e-02],
         [ 5.0009e-02,  7.9599e-02],
         [ 5.0009e-02,  5.5289e-02],
         [ 5.0009e-02,  8.4240e-02],
         [ 5.0009e-02,  5.4350e-02],
         [ 5.0009e-02,  8.0459e-02],
         [ 5.0009e-02, -1.9622e-02],
         [ 5.0009e-02,  7.7617e-02],
         [ 5.0009e-02,  8.9166e-02],
         [ 5.0009e-02,  9.4569e-02],
         [ 5.0009e-02,  9.8286e-02],
         [ 5.0009e-02,  7.0475e-02],
         [ 5.0009e-02,  8.5707e-02],
         [ 5.0009e-02, -1.6050e-02],
         [ 5.0009e-02,  8.1534e-02],
         [ 5.0009e-02,  9.2678e-02],
         [ 5.0009e-02,  6.3322e-02],
         [ 5.0009e-02,  8.9902e-02],
         [ 5.0009e-02,  1.4091e-01],
         [ 5.0009e-02,  1.5993e-01],
         [ 5.0009e-02,  1.6269e-01],
         [ 5.0009e-02,  9.9465e-02],
         [ 5.0009e-02,  9.5644e-02],
         [ 5.0009e-02,  9.6587e-02],
         [ 5.0009e-02,  9.4820e-02],
         [ 5.0009e-02,  7.1597e-02],
         [ 5.0009e-02,  8.3256e-02],
         [ 5.0009e-02,  1.2638e-01],
         [ 5.0009e-02,  1.5315e-01],
         [ 5.0009e-02,  1.6703e-01],
         [ 5.0009e-02,  1.2784e-01],
         [ 5.0009e-02,  1.1317e-01],
         [ 5.0009e-02,  1.4609e-01],
         [ 5.0009e-02,  1.6603e-01],
         [ 5.0009e-02,  1.0290e-01],
         [ 5.0009e-02,  1.0114e-01],
         [ 5.0009e-02,  1.0021e-01],
         [ 5.0009e-02,  1.1800e-01],
         [ 5.0009e-02,  9.0486e-02],
         [ 5.0009e-02,  1.1388e-01],
         [ 5.0009e-02,  6.9002e-02],
         [ 5.0009e-02,  4.8347e-02],
         [ 5.0009e-02,  3.6117e-02],
         [ 5.0009e-02,  7.0247e-02],
         [ 5.0009e-02,  7.9306e-02],
         [ 5.0009e-02,  1.2139e-01],
         [ 5.0009e-02,  8.7706e-02],
         [ 5.0009e-02,  7.0982e-02],
         [ 5.0009e-02,  9.6345e-02],
         [ 5.0009e-02,  8.3077e-02],
         [ 5.0009e-02,  7.4376e-02],
         [ 5.0009e-02,  7.7576e-02],
         [ 5.0009e-02,  4.1654e-02],
         [ 5.0009e-02,  5.8213e-02],
         [ 5.0009e-02,  7.4738e-02],
         [ 5.0009e-02,  8.2372e-02],
         [ 5.0009e-02,  5.8282e-02],
         [ 5.0009e-02,  6.2606e-02],
         [ 5.0009e-02,  7.4427e-02],
         [ 5.0009e-02,  5.2736e-02],
         [ 5.0009e-02,  4.4371e-02],
         [ 5.0009e-02,  8.5261e-02],
         [ 5.0009e-02,  5.6428e-02],
         [ 5.0009e-02,  7.1099e-02],
         [ 5.0009e-02,  6.3054e-02],
         [ 5.0009e-02,  8.2815e-02],
         [ 5.0009e-02,  4.0893e-02],
         [ 5.0009e-02,  7.2760e-02],
         [ 5.0009e-02,  4.0597e-02],
         [ 5.0009e-02,  1.6392e-02],
         [ 5.0009e-02,  5.1394e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.9472e-07, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0014, device='cuda:0')
mixer_td_error tensor(0.1333, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4686, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.1069, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0431, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1797, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0603, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-513392.7812, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1996, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.9920e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0015, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2142, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.0949, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2142, device='cuda:0', grad_fn=<MinBackward1>)
t_env 910
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6085e-02,  1.0713e-01,  ...,  2.0049e-02,
            1.6247e-01, -1.0000e+07],
          [-1.0000e+07, -1.6729e-02,  1.0948e-01,  ...,  2.6640e-03,
            1.2965e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3875e-02,  8.8061e-02,  ..., -8.4055e-03,
            1.5805e-01, -1.0000e+07],
          [-1.0000e+07, -3.6246e-02,  1.0894e-01,  ..., -3.0980e-02,
            1.3536e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7180e-01,  1.0048e-01,  ...,  4.6637e-02,
            1.5591e-01, -1.0000e+07],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7826e-01,  1.0546e-01,  ...,  4.1326e-02,
            1.6501e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-5.4609e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2667e-02,  6.8683e-02,  ..., -1.4773e-02,
            1.4253e-01, -1.0000e+07],
          [-1.0000e+07, -2.4958e-02,  1.1569e-01,  ...,  9.4168e-03,
            1.4551e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.6312e-02,  9.9102e-02,  ..., -2.8211e-02,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -3.4892e-02,  6.9462e-02,  ...,  3.2838e-02,
            1.5555e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02, -1.3772e-02],
         [ 1.0713e-01, -1.6729e-02],
         [ 8.8061e-02, -3.6246e-02],
         [-8.3684e-02, -3.0700e-02],
         [-8.3479e-02, -5.2606e-02],
         [ 1.8259e-01, -4.0782e-02],
         [ 1.0628e-01,  1.9428e-01],
         [ 1.5289e-01,  2.0726e-01],
         [ 1.0786e-01,  1.9615e-01],
         [ 8.7930e-02,  1.8390e-01],
         [ 8.7067e-02,  1.1907e-01],
         [ 1.1051e-01,  1.5141e-01],
         [ 1.1411e-01,  1.6509e-01],
         [ 1.2271e-01,  1.6682e-01],
         [ 1.2024e-01,  1.6277e-01],
         [ 1.1130e-01,  1.6612e-01],
         [ 4.8126e-02,  1.2394e-01],
         [ 7.4310e-02,  1.0649e-01],
         [ 6.4487e-02,  1.4207e-01],
         [ 8.3813e-02,  1.5596e-01],
         [ 7.3398e-02,  1.2716e-01],
         [ 8.6700e-02,  1.1264e-01],
         [ 1.1286e-01,  1.2427e-01],
         [ 1.2074e-01,  1.1945e-01],
         [ 1.2001e-01,  1.6221e-01],
         [ 1.4057e-01,  1.8054e-01],
         [ 1.3404e-01,  1.7876e-01],
         [ 8.2030e-02,  1.4613e-01],
         [ 8.3591e-02,  1.0518e-01],
         [ 7.6843e-02,  1.3002e-01],
         [ 6.6084e-02,  1.2694e-01],
         [ 8.9625e-02,  1.0314e-01],
         [ 1.3012e-01,  1.2926e-01],
         [ 7.8268e-02,  1.3888e-01],
         [ 9.7290e-02,  1.4288e-01],
         [ 1.1995e-01,  1.3116e-01],
         [ 1.0989e-01,  1.0507e-01],
         [ 5.9633e-02,  1.5734e-01],
         [ 4.2668e-02,  1.3776e-01],
         [ 9.2760e-02,  1.1786e-01],
         [ 1.1007e-01,  9.1714e-02],
         [ 1.3964e-01,  2.1541e-01],
         [ 1.0639e-01,  8.9743e-02],
         [ 1.3396e-01,  7.1427e-02],
         [ 1.0815e-01,  7.0678e-02],
         [ 9.8372e-02,  9.8736e-02],
         [ 1.2186e-01,  8.0905e-02],
         [ 6.1266e-02,  7.3333e-02],
         [ 6.3981e-02,  6.6237e-02],
         [ 9.1739e-02,  8.2101e-02],
         [ 1.0728e-01,  1.1503e-01],
         [ 6.3326e-02,  9.1512e-02],
         [ 7.5884e-02,  1.2369e-01],
         [ 6.6778e-02,  1.0658e-01],
         [ 8.8447e-02,  2.1243e-01],
         [ 9.2699e-02,  2.3351e-01],
         [ 9.6148e-02,  2.2705e-01],
         [ 8.2403e-02,  2.1170e-01],
         [ 7.6061e-02,  2.2913e-01],
         [ 8.6408e-02,  2.4224e-01],
         [ 9.5735e-02,  2.3395e-01],
         [ 7.8302e-02,  2.4543e-01],
         [ 2.9868e-02,  2.5994e-01],
         [ 8.2177e-02,  9.7344e-02],
         [ 8.7683e-02, -1.6130e-02],
         [ 9.2751e-02,  2.2383e-02],
         [ 9.2730e-02,  4.1224e-02],
         [ 1.0865e-01,  4.9815e-02],
         [ 1.0521e-01,  5.3394e-02],
         [ 5.0291e-02,  5.4752e-02],
         [ 8.2728e-02,  5.5197e-02],
         [ 7.5271e-02,  5.5260e-02],
         [ 7.1240e-02,  5.5271e-02],
         [ 8.9970e-02,  5.5242e-02],
         [ 9.5932e-02,  5.5212e-02],
         [ 9.8053e-02,  5.5195e-02],
         [ 7.7203e-02,  5.5188e-02],
         [ 6.9477e-02,  5.5194e-02],
         [ 2.5568e-02,  5.5217e-02],
         [ 8.7711e-02,  5.5199e-02],
         [ 1.3347e-01,  5.5205e-02],
         [ 1.4507e-01,  5.5211e-02],
         [ 1.5629e-01,  5.5207e-02],
         [ 1.6322e-01,  5.5212e-02],
         [ 1.5895e-01,  5.5229e-02],
         [ 1.1127e-01,  5.5230e-02],
         [ 9.5475e-02,  5.5230e-02],
         [ 1.0614e-01,  5.5230e-02],
         [ 5.2547e-02,  5.5234e-02],
         [ 1.0300e-01,  5.5235e-02],
         [ 6.7855e-02,  5.5235e-02],
         [ 9.7220e-02,  5.5232e-02],
         [ 1.0048e-01,  5.5232e-02],
         [ 1.0546e-01,  5.5231e-02],
         [-5.4609e-03,  5.5231e-02]],

        [[ 7.2334e-02,  1.2843e-01],
         [-7.2667e-02, -2.4958e-02],
         [ 9.9102e-02, -3.4892e-02],
         [ 1.3925e-01, -1.7211e-02],
         [ 1.2582e-01,  5.2694e-02],
         [ 1.5735e-01,  5.6352e-02],
         [ 1.0855e-01,  8.3686e-02],
         [ 1.1919e-01,  9.4234e-02],
         [-5.1670e-02,  1.1662e-01],
         [-1.0594e-02, -8.0928e-03],
         [-3.0510e-02, -1.8584e-02],
         [ 1.0228e-01, -3.6150e-02],
         [ 9.9277e-02,  8.7233e-02],
         [ 1.1384e-01,  1.0780e-01],
         [ 1.0377e-01,  1.3619e-01],
         [ 1.0626e-01,  1.3407e-01],
         [ 7.3019e-02, -4.1568e-02],
         [ 9.5604e-02, -3.6987e-02],
         [ 6.9928e-02,  9.5498e-02],
         [ 9.4397e-02,  1.1225e-01],
         [ 1.1253e-01, -5.9717e-02],
         [ 1.5581e-01,  8.4791e-02],
         [ 1.2761e-01,  1.9780e-01],
         [ 1.6770e-01,  2.1220e-01],
         [ 1.3631e-01,  9.0915e-02],
         [ 1.7356e-01,  7.0071e-02],
         [ 1.4023e-01,  2.0087e-01],
         [ 1.1471e-01,  1.2782e-01],
         [ 1.1800e-01,  1.5898e-01],
         [ 1.1590e-01,  1.3602e-01],
         [ 1.0914e-01,  1.4915e-01],
         [ 1.2539e-01,  1.5150e-01],
         [ 5.7348e-02,  1.2751e-01],
         [ 5.5541e-02,  1.3886e-01],
         [ 3.1964e-02,  9.0659e-02],
         [ 5.0115e-02,  2.0053e-01],
         [ 4.2941e-02,  9.4389e-02],
         [ 1.0707e-01,  1.1006e-01],
         [ 1.2051e-01,  1.1272e-01],
         [ 6.5837e-02,  9.8207e-02],
         [ 1.2855e-01,  1.3681e-01],
         [ 1.0453e-01,  1.5243e-01],
         [ 1.3176e-01,  1.6469e-01],
         [ 1.6354e-01,  1.6827e-01],
         [ 1.4446e-01,  1.7266e-01],
         [ 1.7642e-01,  1.7662e-01],
         [ 1.8342e-01,  1.3265e-01],
         [ 1.8108e-01,  1.5254e-01],
         [ 1.8409e-01,  1.3881e-01],
         [ 1.1798e-01, -1.0211e-02],
         [ 1.2461e-01,  3.0220e-02],
         [ 1.2158e-01,  4.7160e-02],
         [ 1.3106e-01,  5.3579e-02],
         [ 1.8318e-01,  5.5623e-02],
         [ 1.3187e-01,  5.6042e-02],
         [ 1.2981e-01,  5.5897e-02],
         [ 1.2657e-01,  5.5668e-02],
         [ 6.8356e-02,  5.5474e-02],
         [ 7.8515e-02,  5.5334e-02],
         [ 1.0868e-01,  5.5253e-02],
         [ 1.1115e-01,  5.5217e-02],
         [ 1.1057e-01,  5.5220e-02],
         [ 5.0134e-02,  5.5206e-02],
         [ 5.8233e-02,  5.5202e-02],
         [ 6.3150e-02,  5.5193e-02],
         [ 8.1922e-02,  5.5210e-02],
         [ 9.2432e-02,  5.5210e-02],
         [ 1.1495e-01,  5.5212e-02],
         [ 1.3005e-01,  5.5224e-02],
         [ 1.3813e-01,  5.5221e-02],
         [ 1.3502e-01,  5.5231e-02],
         [ 1.2256e-01,  5.5230e-02],
         [ 1.7090e-01,  5.5229e-02],
         [ 1.3864e-01,  5.5231e-02],
         [ 8.6165e-02,  5.5236e-02],
         [ 1.0167e-01,  5.5235e-02],
         [ 5.2030e-02,  5.5232e-02],
         [ 1.0483e-01,  5.5232e-02],
         [ 1.0882e-01,  5.5231e-02],
         [ 1.0570e-01,  5.5231e-02],
         [ 8.4497e-02,  5.5231e-02],
         [ 9.5856e-02,  5.5231e-02],
         [ 7.5491e-02,  5.5231e-02],
         [ 1.7330e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.3680e-05, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0014, device='cuda:0')
mixer_td_error tensor(0.1377, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5171, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4397, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0599, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1609, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0315, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-578947.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2599, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.8180e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2602, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1281, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2602, device='cuda:0', grad_fn=<MinBackward1>)
t_env 1006
target_mac_out tensor([[[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3070e-01,  1.2391e-01,  ...,  7.1034e-02,
            1.5852e-01, -1.0000e+07],
          [-1.0000e+07, -3.6329e-02,  1.0540e-01,  ..., -2.3505e-02,
            1.3276e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4548e-01,  1.2388e-01,  ...,  5.2184e-02,
            1.5225e-01, -1.0000e+07],
          [-1.0000e+07, -7.9506e-02,  1.4849e-01,  ...,  2.9133e-02,
            1.4592e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5505e-01,  5.1068e-02,  ...,  3.8250e-02,
            2.0122e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5922e-01,  4.2900e-02,  ...,  2.9935e-02,
            1.9831e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.9150e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2667e-02,  6.8683e-02,  ..., -1.4773e-02,
            1.4253e-01, -1.0000e+07],
          [-1.0000e+07, -2.4958e-02,  1.1569e-01,  ...,  9.4168e-03,
            1.4551e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.6312e-02,  9.9102e-02,  ..., -2.8211e-02,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -3.4892e-02,  6.9462e-02,  ...,  3.2838e-02,
            1.5555e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0827e-01, -1.1117e-02],
         [ 1.2391e-01, -3.6329e-02],
         [ 1.2388e-01,  1.4849e-01],
         [ 1.1120e-01, -7.5766e-02],
         [-1.5082e-01,  1.0360e-01],
         [ 1.0384e-01,  1.6212e-01],
         [ 1.0730e-01,  1.3985e-01],
         [ 1.2105e-01,  1.2283e-01],
         [ 1.3210e-01,  1.4214e-01],
         [ 1.5162e-01,  1.6795e-01],
         [ 1.6399e-01,  1.8431e-01],
         [ 1.3424e-01,  1.5073e-01],
         [ 1.3556e-01,  1.3457e-01],
         [ 1.2130e-01,  1.1134e-01],
         [ 1.4275e-01,  1.3791e-01],
         [ 1.2264e-01,  1.6636e-01],
         [ 1.4533e-01,  1.3594e-01],
         [ 1.5384e-01,  1.1079e-01],
         [ 1.4967e-01,  1.2379e-01],
         [ 1.3395e-01,  8.9738e-02],
         [ 9.3326e-02, -9.6275e-02],
         [ 1.5065e-02, -8.0648e-02],
         [ 3.1087e-02, -7.0815e-02],
         [ 4.1229e-02, -5.9451e-02],
         [ 4.6494e-02, -5.6659e-02],
         [ 4.8929e-02, -3.9966e-02],
         [ 4.9845e-02, -5.3753e-02],
         [ 5.0161e-02, -5.3675e-02],
         [ 5.0198e-02, -6.6684e-02],
         [ 5.0164e-02, -5.6926e-02],
         [ 5.0127e-02,  8.3781e-02],
         [ 5.0076e-02,  1.1153e-01],
         [ 5.0043e-02,  7.9167e-02],
         [ 5.0052e-02,  7.6035e-02],
         [ 5.0029e-02,  8.8515e-02],
         [ 5.0036e-02,  6.7258e-02],
         [ 5.0027e-02,  8.0908e-02],
         [ 5.0019e-02,  2.0115e-01],
         [ 5.0025e-02,  7.9332e-02],
         [ 5.0026e-02,  9.3016e-02],
         [ 5.0010e-02,  9.7706e-02],
         [ 5.0020e-02,  2.0300e-01],
         [ 5.0005e-02,  8.6472e-02],
         [ 5.0007e-02,  9.7147e-02],
         [ 5.0008e-02,  2.0852e-01],
         [ 5.0008e-02,  2.1622e-01],
         [ 5.0008e-02,  2.0893e-01],
         [ 5.0009e-02,  2.0516e-01],
         [ 5.0008e-02, -8.3420e-02],
         [ 5.0008e-02, -6.6560e-02],
         [ 5.0008e-02,  2.0102e-01],
         [ 5.0008e-02, -7.6886e-02],
         [ 5.0008e-02, -8.0247e-02],
         [ 5.0009e-02, -8.3672e-02],
         [ 5.0009e-02,  2.0696e-01],
         [ 5.0009e-02, -8.3128e-02],
         [ 5.0009e-02,  2.2019e-01],
         [ 5.0009e-02,  2.1939e-01],
         [ 5.0009e-02,  9.1598e-02],
         [ 5.0009e-02,  2.1617e-01],
         [ 5.0009e-02, -8.3758e-02],
         [ 5.0009e-02, -7.7796e-02],
         [ 5.0009e-02,  2.1076e-01],
         [ 5.0009e-02,  1.0388e-01],
         [ 5.0009e-02,  8.5299e-02],
         [ 5.0009e-02,  9.0344e-02],
         [ 5.0009e-02,  2.0335e-01],
         [ 5.0009e-02,  1.9767e-01],
         [ 5.0009e-02,  2.1202e-01],
         [ 5.0009e-02,  2.1864e-01],
         [ 5.0009e-02,  2.0500e-01],
         [ 5.0009e-02,  1.9406e-01],
         [ 5.0009e-02,  1.9491e-01],
         [ 5.0009e-02,  2.1120e-01],
         [ 5.0009e-02,  1.9739e-01],
         [ 5.0009e-02,  2.0255e-01],
         [ 5.0009e-02,  2.0285e-01],
         [ 5.0009e-02,  2.0195e-01],
         [ 5.0009e-02,  1.9949e-01],
         [ 5.0009e-02,  1.8841e-01],
         [ 5.0009e-02,  2.0700e-01],
         [ 5.0009e-02,  2.1293e-01],
         [ 5.0009e-02,  2.0940e-01],
         [ 5.0009e-02,  2.0761e-01],
         [ 5.0009e-02,  2.0655e-01],
         [ 5.0009e-02,  2.0571e-01],
         [ 5.0009e-02,  1.9706e-01],
         [ 5.0009e-02,  2.1002e-01],
         [ 5.0009e-02,  2.1911e-01],
         [ 5.0009e-02,  2.1207e-01],
         [ 5.0009e-02,  2.0882e-01],
         [ 5.0009e-02,  2.1848e-01],
         [ 5.0009e-02,  2.2334e-01],
         [ 5.0009e-02,  2.2881e-01],
         [ 5.0009e-02,  1.1464e-01],
         [ 5.0009e-02,  8.0350e-02],
         [ 5.0009e-02,  2.0731e-01],
         [ 5.0009e-02,  2.0543e-01],
         [ 5.0009e-02,  2.0335e-01],
         [ 5.0009e-02,  2.1317e-01],
         [ 5.0009e-02,  1.0404e-01],
         [ 5.0009e-02,  1.0427e-01],
         [ 5.0009e-02, -1.1727e-01],
         [ 5.0009e-02, -9.8710e-02],
         [ 5.0009e-02, -8.9451e-02],
         [ 5.0009e-02,  2.1049e-01],
         [ 5.0009e-02,  8.5900e-02],
         [ 5.0009e-02,  1.3334e-01],
         [ 5.0009e-02, -6.4013e-02],
         [ 5.0009e-02, -8.2040e-02],
         [ 5.0009e-02,  9.6982e-02],
         [ 5.0009e-02, -1.0953e-01],
         [ 5.0009e-02,  8.2586e-02],
         [ 5.0009e-02,  7.9531e-02],
         [ 5.0009e-02,  8.8877e-02],
         [ 5.0009e-02,  2.0516e-01],
         [ 5.0009e-02,  2.1130e-01],
         [ 5.0009e-02,  2.1055e-01],
         [ 5.0009e-02,  9.1396e-02],
         [ 5.0009e-02,  2.2886e-01],
         [ 5.0009e-02,  8.9520e-02],
         [ 5.0009e-02,  8.9573e-02],
         [ 5.0009e-02, -1.4103e-01],
         [ 5.0009e-02,  7.2536e-02],
         [ 5.0009e-02,  8.1444e-02],
         [ 5.0009e-02,  7.2294e-02],
         [ 5.0009e-02,  9.0362e-02],
         [ 5.0009e-02,  6.5614e-02],
         [ 5.0009e-02,  2.0122e-01],
         [ 5.0009e-02,  1.9831e-01],
         [ 5.0009e-02,  1.9150e-02]],

        [[-5.8723e-02,  1.2843e-01],
         [-7.2667e-02, -2.4958e-02],
         [-4.6312e-02, -3.4892e-02],
         [ 1.3925e-01, -1.7211e-02],
         [-1.0635e-02, -4.7126e-02],
         [ 1.5735e-01, -3.6487e-02],
         [-4.2670e-02, -3.4362e-02],
         [-2.0817e-02, -3.6218e-02],
         [-5.1670e-02, -1.7604e-02],
         [-1.0594e-02, -8.0928e-03],
         [-3.0510e-02, -1.8584e-02],
         [-4.7370e-02, -3.6150e-02],
         [-6.8687e-02, -6.6748e-02],
         [ 1.1384e-01, -5.4387e-02],
         [-8.6140e-02,  1.3619e-01],
         [-1.0438e-01, -4.6140e-02],
         [-9.6649e-02, -4.1568e-02],
         [-1.0959e-01, -3.6987e-02],
         [-9.8761e-02, -6.7402e-02],
         [-1.1087e-01, -5.5455e-02],
         [ 1.1253e-01, -5.9717e-02],
         [ 1.5581e-01,  8.4791e-02],
         [-1.9454e-02, -7.8604e-02],
         [ 1.6770e-01,  2.1220e-01],
         [-5.0746e-03,  9.0915e-02],
         [ 1.7356e-01, -7.2498e-02],
         [-1.7174e-03, -7.1065e-02],
         [-5.2368e-02,  1.2782e-01],
         [-8.9912e-02,  1.5898e-01],
         [ 1.1590e-01,  1.3602e-01],
         [-1.2998e-01,  1.4915e-01],
         [ 1.2539e-01,  1.5150e-01],
         [-1.5081e-01,  1.2751e-01],
         [-1.2441e-01,  1.3886e-01],
         [-1.0931e-01,  9.0659e-02],
         [-8.3859e-02, -6.0354e-02],
         [ 9.0055e-02, -6.8043e-02],
         [ 1.0707e-01,  1.1006e-01],
         [ 1.2051e-01, -1.3040e-01],
         [ 6.5837e-02, -1.1708e-01],
         [ 1.2855e-01, -1.2206e-01],
         [-9.3238e-02,  1.5243e-01],
         [ 1.3176e-01,  1.6469e-01],
         [ 1.6354e-01,  1.6827e-01],
         [ 1.4446e-01,  1.7266e-01],
         [ 1.7642e-01,  1.7662e-01],
         [ 1.8342e-01, -1.0310e-01],
         [ 1.8108e-01, -9.4633e-02],
         [ 1.8409e-01, -1.0346e-01],
         [ 1.1798e-01, -1.0211e-02],
         [ 1.2461e-01,  3.0220e-02],
         [ 1.2158e-01,  4.7160e-02],
         [ 1.3106e-01,  5.3579e-02],
         [ 1.8318e-01,  5.5623e-02],
         [ 1.3187e-01,  5.6042e-02],
         [ 1.2981e-01,  5.5897e-02],
         [ 1.2657e-01,  5.5668e-02],
         [ 8.2254e-02,  5.5474e-02],
         [ 7.8515e-02,  5.5334e-02],
         [ 1.0868e-01,  5.5253e-02],
         [ 1.1115e-01,  5.5217e-02],
         [ 1.1057e-01,  5.5220e-02],
         [ 7.2643e-02,  5.5206e-02],
         [-1.1589e-01,  5.5202e-02],
         [-1.0630e-01,  5.5193e-02],
         [ 9.5423e-02,  5.5210e-02],
         [ 1.1010e-01,  5.5210e-02],
         [ 1.1495e-01,  5.5212e-02],
         [ 1.3005e-01,  5.5224e-02],
         [ 1.3813e-01,  5.5221e-02],
         [ 1.3502e-01,  5.5231e-02],
         [ 1.2256e-01,  5.5230e-02],
         [ 1.7090e-01,  5.5229e-02],
         [ 1.3864e-01,  5.5231e-02],
         [ 8.6165e-02,  5.5236e-02],
         [ 1.0167e-01,  5.5235e-02],
         [ 6.6090e-02,  5.5232e-02],
         [ 1.0483e-01,  5.5232e-02],
         [ 1.0882e-01,  5.5231e-02],
         [ 1.0570e-01,  5.5231e-02],
         [ 8.4497e-02,  5.5231e-02],
         [ 9.5856e-02,  5.5231e-02],
         [ 7.5491e-02,  5.5231e-02],
         [ 1.7330e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-5.3625e-06, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0034, device='cuda:0')
mixer_td_error tensor(0.4355, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5140, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.2101, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0680, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1782, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0871, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1793892.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2289, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.3271e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0041, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2213, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2620, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2213, device='cuda:0', grad_fn=<MinBackward1>)
t_env 1183
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6085e-02,  1.0713e-01,  ...,  2.0049e-02,
            1.6247e-01, -1.0000e+07],
          [-1.0000e+07, -1.6729e-02,  1.0948e-01,  ...,  2.6640e-03,
            1.2965e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3875e-02,  8.8061e-02,  ..., -8.4055e-03,
            1.5805e-01, -1.0000e+07],
          [-1.0000e+07, -3.6246e-02,  1.0894e-01,  ..., -3.0980e-02,
            1.3536e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7826e-01,  1.0546e-01,  ...,  4.1326e-02,
            1.6501e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-5.4609e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.5027e-02,  7.1936e-02,  ..., -3.0500e-03,
            1.2911e-01, -1.0000e+07],
          [-1.0000e+07, -2.2961e-02,  9.6708e-02,  ..., -2.0494e-02,
            1.3243e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.1139e-02,  8.5369e-02,  ...,  1.4716e-02,
            1.3164e-01, -1.0000e+07],
          [-1.0000e+07, -3.0575e-02,  9.4245e-02,  ..., -4.3856e-02,
            1.3745e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.9938e-01,  1.0586e-01,  ...,  4.4793e-02,
            1.6853e-01, -3.1699e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.8366e-01,  7.2695e-02,  ...,  4.2428e-02,
            1.5227e-01, -3.1359e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.6262e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02, -1.3772e-02],
         [ 1.0713e-01, -1.6729e-02],
         [-9.3875e-02, -3.6246e-02],
         [-8.3684e-02, -3.0700e-02],
         [-8.3479e-02, -5.2606e-02],
         [-9.8128e-02, -4.0782e-02],
         [-5.0888e-02, -5.7989e-02],
         [ 1.5289e-01, -6.3909e-02],
         [-5.9501e-02, -7.1258e-02],
         [-7.4686e-02, -5.4691e-02],
         [-9.2496e-02, -4.4071e-02],
         [ 1.1051e-01,  1.5141e-01],
         [ 1.1411e-01,  1.6509e-01],
         [ 1.2271e-01,  1.6682e-01],
         [ 1.2024e-01,  1.6277e-01],
         [ 1.1130e-01,  1.6612e-01],
         [-1.4735e-01,  1.2394e-01],
         [ 1.1444e-01, -6.7941e-02],
         [-1.4258e-01,  1.4207e-01],
         [ 1.1971e-01,  1.5596e-01],
         [ 1.1534e-01,  1.2716e-01],
         [ 8.6700e-02,  1.1264e-01],
         [ 1.1286e-01,  1.2427e-01],
         [ 1.2074e-01,  1.1945e-01],
         [ 1.2001e-01,  1.6221e-01],
         [ 1.4057e-01,  1.8054e-01],
         [ 1.3404e-01,  1.7876e-01],
         [ 9.7488e-02,  1.4613e-01],
         [ 8.3591e-02,  1.0518e-01],
         [ 8.9463e-02,  1.3002e-01],
         [ 1.0854e-01,  1.2694e-01],
         [ 1.3098e-01, -1.0769e-01],
         [ 1.3012e-01,  1.2926e-01],
         [ 9.5732e-02,  1.3888e-01],
         [ 1.3104e-01,  1.4288e-01],
         [ 1.1995e-01,  1.3116e-01],
         [ 1.0989e-01,  1.0507e-01],
         [ 7.8628e-02,  1.5734e-01],
         [ 7.5788e-02,  1.3776e-01],
         [ 9.2760e-02,  1.1786e-01],
         [ 1.1007e-01,  9.1714e-02],
         [ 1.3964e-01,  6.0981e-02],
         [ 1.0639e-01,  9.0206e-02],
         [ 1.3396e-01,  7.1427e-02],
         [ 1.0815e-01,  7.0678e-02],
         [ 9.8372e-02,  9.8736e-02],
         [ 1.2186e-01,  9.0344e-02],
         [ 7.0507e-02,  8.9243e-02],
         [ 4.7146e-02, -1.3366e-01],
         [ 9.1739e-02, -1.1579e-01],
         [ 1.0728e-01,  1.1503e-01],
         [ 6.0738e-02,  9.1512e-02],
         [ 9.6498e-02,  1.2369e-01],
         [ 5.7662e-02,  1.0658e-01],
         [ 8.8447e-02,  5.8208e-02],
         [ 9.2699e-02,  6.6659e-02],
         [ 9.6148e-02,  7.1523e-02],
         [ 8.2403e-02,  2.1170e-01],
         [ 7.6061e-02,  6.0023e-02],
         [ 8.6408e-02,  7.3924e-02],
         [ 9.5735e-02,  7.8877e-02],
         [ 7.8302e-02,  7.3714e-02],
         [-1.1818e-01,  2.5994e-01],
         [ 8.2177e-02,  5.8956e-02],
         [ 8.7683e-02, -1.6130e-02],
         [ 9.2751e-02,  2.2383e-02],
         [ 9.2730e-02,  4.1224e-02],
         [ 1.0865e-01,  4.9815e-02],
         [ 1.0521e-01,  5.3394e-02],
         [ 6.1773e-02,  5.4752e-02],
         [ 8.2728e-02,  5.5197e-02],
         [ 7.5271e-02,  5.5260e-02],
         [ 7.1240e-02,  5.5271e-02],
         [ 8.9970e-02,  5.5242e-02],
         [ 9.5932e-02,  5.5212e-02],
         [ 9.8053e-02,  5.5195e-02],
         [ 7.7203e-02,  5.5188e-02],
         [ 6.9477e-02,  5.5194e-02],
         [-1.0620e-01,  5.5217e-02],
         [ 8.7711e-02,  5.5199e-02],
         [ 1.3347e-01,  5.5205e-02],
         [ 1.4507e-01,  5.5211e-02],
         [ 1.5629e-01,  5.5207e-02],
         [ 1.6322e-01,  5.5212e-02],
         [ 1.5895e-01,  5.5229e-02],
         [ 1.1127e-01,  5.5230e-02],
         [ 9.5475e-02,  5.5230e-02],
         [ 1.0614e-01,  5.5230e-02],
         [ 6.9667e-02,  5.5234e-02],
         [ 1.0300e-01,  5.5235e-02],
         [ 7.2349e-02,  5.5235e-02],
         [ 9.7220e-02,  5.5232e-02],
         [ 1.0048e-01,  5.5232e-02],
         [ 1.0546e-01,  5.5231e-02],
         [-5.4609e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07]],

        [[-4.2377e-02, -1.1096e-02],
         [-5.5027e-02, -2.2961e-02],
         [-4.1139e-02, -3.0575e-02],
         [-3.2662e-02, -4.3250e-02],
         [-4.2330e-02, -3.3436e-02],
         [-2.3718e-02, -4.0629e-02],
         [-5.8590e-02, -4.0934e-02],
         [-8.4974e-02, -2.9617e-02],
         [-5.9925e-02, -2.9218e-02],
         [ 1.5041e-01, -2.3082e-02],
         [ 1.6852e-01, -1.5386e-02],
         [-2.0264e-02, -8.4988e-03],
         [ 1.6914e-01, -3.7857e-02],
         [-6.2545e-03, -4.0398e-02],
         [ 1.5086e-02, -4.7884e-02],
         [-1.8821e-02, -3.0138e-02],
         [-6.0220e-02, -1.4213e-02],
         [-4.9873e-02, -1.2104e-02],
         [-3.0518e-02, -2.5654e-02],
         [-3.3560e-02, -1.8829e-02],
         [-3.7333e-02, -3.2817e-03],
         [-6.9114e-02, -6.3185e-03],
         [-7.3922e-02, -3.1255e-02],
         [-8.7049e-02, -1.8565e-02],
         [-5.4217e-02, -1.1027e-02],
         [-1.9287e-02, -1.1783e-02],
         [ 1.5426e-01, -3.9562e-02],
         [ 1.7741e-01, -3.0440e-02],
         [ 1.7950e-01, -4.7343e-02],
         [ 1.7848e-01,  9.5407e-02],
         [-2.2659e-02, -5.7749e-02],
         [ 1.6343e-01, -4.7370e-02],
         [ 1.8144e-01, -2.5316e-02],
         [-7.4753e-02, -1.4975e-02],
         [-7.1515e-02, -2.7384e-02],
         [-9.6875e-02,  1.4873e-01],
         [-8.2046e-02, -3.6629e-02],
         [-1.0228e-01, -4.5060e-02],
         [-8.1084e-02,  1.5129e-01],
         [-8.3552e-02, -4.4975e-02],
         [ 1.3091e-01, -3.3770e-02],
         [-4.4299e-02, -7.3258e-02],
         [ 1.5403e-01,  9.7388e-02],
         [ 1.6515e-01,  9.9281e-02],
         [ 1.7729e-01, -6.3383e-02],
         [ 1.7978e-01, -4.4041e-02],
         [-7.5821e-02, -3.3466e-02],
         [-9.8260e-02, -4.6174e-02],
         [-6.9414e-02, -5.2444e-02],
         [ 1.4989e-01, -6.0776e-02],
         [ 1.6592e-01, -5.4466e-02],
         [-7.7386e-02,  1.4419e-01],
         [-5.8726e-02,  1.6298e-01],
         [ 1.5526e-01,  1.6761e-01],
         [ 1.6354e-01, -1.1073e-01],
         [ 1.2214e-01,  1.6277e-01],
         [ 1.3145e-01,  1.8230e-01],
         [ 1.2651e-01,  1.8624e-01],
         [ 1.4976e-01,  1.8383e-01],
         [ 1.3096e-01,  1.5660e-01],
         [ 1.5719e-01,  1.1360e-01],
         [-4.3478e-02,  9.2760e-02],
         [-6.5489e-02,  7.1618e-02],
         [ 1.2064e-01,  4.6336e-02],
         [ 1.0465e-01,  5.9508e-02],
         [ 1.3051e-01,  1.1030e-01],
         [ 1.0501e-01,  1.3248e-01],
         [ 1.1574e-01, -1.2058e-01],
         [ 1.2416e-01, -1.0954e-01],
         [ 1.4123e-01, -1.0672e-01],
         [ 1.0080e-01,  1.5099e-01],
         [ 1.2277e-01, -1.0784e-01],
         [ 1.3046e-01,  4.7317e-03],
         [ 1.2593e-01,  3.5153e-02],
         [ 1.3922e-01,  4.7874e-02],
         [ 1.8498e-01,  5.2807e-02],
         [ 1.5769e-01,  5.4573e-02],
         [ 1.3009e-01,  5.5107e-02],
         [ 1.2383e-01,  5.5214e-02],
         [ 1.3862e-01,  5.5201e-02],
         [ 1.3305e-01,  5.5187e-02],
         [ 1.4448e-01,  5.5161e-02],
         [ 1.0565e-01,  5.5155e-02],
         [ 1.2594e-01,  5.5158e-02],
         [ 1.3153e-01,  5.5200e-02],
         [ 1.4550e-01,  5.5186e-02],
         [ 1.2056e-01,  5.5187e-02],
         [ 1.2911e-01,  5.5204e-02],
         [ 1.3020e-01,  5.5219e-02],
         [ 1.0828e-01,  5.5208e-02],
         [ 1.1543e-01,  5.5215e-02],
         [ 8.3100e-02,  5.5218e-02],
         [ 1.0123e-01,  5.5227e-02],
         [ 1.0586e-01,  5.5231e-02],
         [ 7.2695e-02,  5.5230e-02],
         [ 2.6262e-03,  5.5230e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(0.0001, device='cuda:0') tensor(0.0017, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.0535, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5149, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4871, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0734, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2085, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0385, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-52083.2773, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2599, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.9023e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1771, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2596, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1771, device='cuda:0', grad_fn=<MinBackward1>)
t_env 1333
target_mac_out tensor([[[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3070e-01,  1.2391e-01,  ...,  7.1034e-02,
            1.5852e-01, -1.0000e+07],
          [-1.0000e+07, -3.6329e-02,  1.0540e-01,  ..., -2.3505e-02,
            1.3276e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4548e-01,  1.2388e-01,  ...,  5.2184e-02,
            1.5225e-01, -1.0000e+07],
          [-1.0000e+07, -7.9506e-02,  1.4849e-01,  ...,  2.9133e-02,
            1.4592e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5505e-01,  5.1068e-02,  ...,  3.8250e-02,
            2.0122e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5922e-01,  4.2900e-02,  ...,  2.9935e-02,
            1.9831e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.9150e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.5027e-02,  7.1936e-02,  ..., -3.0500e-03,
            1.2911e-01, -1.0000e+07],
          [-1.0000e+07, -2.2961e-02,  9.6708e-02,  ..., -2.0494e-02,
            1.3243e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.1139e-02,  8.5369e-02,  ...,  1.4716e-02,
            1.3164e-01, -1.0000e+07],
          [-1.0000e+07, -3.0575e-02,  9.4245e-02,  ..., -4.3856e-02,
            1.3745e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0827e-01, -1.1117e-02],
         [ 1.2391e-01, -3.6329e-02],
         [-1.4548e-01, -7.9506e-02],
         [-1.5081e-01, -7.5766e-02],
         [-1.5082e-01, -9.4109e-02],
         [-1.5697e-01,  1.6212e-01],
         [-1.6938e-01, -9.1683e-02],
         [-1.7251e-01, -1.2311e-01],
         [ 1.3210e-01,  1.4214e-01],
         [ 1.5162e-01,  1.6795e-01],
         [ 1.6399e-01,  1.8431e-01],
         [ 1.3424e-01,  1.5073e-01],
         [ 1.3556e-01,  1.3457e-01],
         [ 1.2130e-01, -1.5708e-01],
         [ 1.4275e-01,  1.3791e-01],
         [-1.5234e-01,  1.6636e-01],
         [ 1.4533e-01,  1.3594e-01],
         [ 1.5384e-01, -1.5516e-01],
         [ 1.4967e-01,  1.2379e-01],
         [-1.4367e-01, -1.1832e-01],
         [-1.3986e-01, -9.6275e-02],
         [ 1.5065e-02, -8.0648e-02],
         [ 3.1087e-02, -7.0815e-02],
         [ 4.1229e-02, -5.9451e-02],
         [ 4.6494e-02, -5.6659e-02],
         [ 4.8929e-02, -3.9966e-02],
         [ 4.9845e-02, -5.3753e-02],
         [ 5.0161e-02, -5.3675e-02],
         [ 5.0198e-02, -6.6684e-02],
         [ 5.0164e-02, -5.6926e-02],
         [ 5.0127e-02, -7.5111e-02],
         [ 5.0076e-02,  1.1153e-01],
         [ 5.0043e-02, -1.2668e-01],
         [ 5.0052e-02, -1.2547e-01],
         [ 5.0029e-02, -1.5680e-01],
         [ 5.0036e-02, -1.3604e-01],
         [ 5.0027e-02, -1.3514e-01],
         [ 5.0019e-02, -1.1145e-01],
         [ 5.0025e-02, -1.1277e-01],
         [ 5.0026e-02,  9.3016e-02],
         [ 5.0010e-02,  9.7706e-02],
         [ 5.0020e-02, -9.9113e-02],
         [ 5.0005e-02, -1.0421e-01],
         [ 5.0007e-02,  9.7147e-02],
         [ 5.0008e-02, -1.0172e-01],
         [ 5.0008e-02,  8.5475e-02],
         [ 5.0008e-02, -1.0054e-01],
         [ 5.0009e-02, -9.3356e-02],
         [ 5.0008e-02, -8.3420e-02],
         [ 5.0008e-02, -6.6560e-02],
         [ 5.0008e-02, -7.9682e-02],
         [ 5.0008e-02, -7.6886e-02],
         [ 5.0008e-02, -8.0247e-02],
         [ 5.0009e-02, -8.3672e-02],
         [ 5.0009e-02, -8.7099e-02],
         [ 5.0009e-02, -8.3128e-02],
         [ 5.0009e-02, -9.8963e-02],
         [ 5.0009e-02, -1.0549e-01],
         [ 5.0009e-02,  9.1598e-02],
         [ 5.0009e-02, -9.3768e-02],
         [ 5.0009e-02, -8.3758e-02],
         [ 5.0009e-02, -7.7796e-02],
         [ 5.0009e-02, -8.8830e-02],
         [ 5.0009e-02,  1.0388e-01],
         [ 5.0009e-02, -1.3860e-01],
         [ 5.0009e-02,  9.0344e-02],
         [ 5.0009e-02, -1.4664e-01],
         [ 5.0009e-02, -1.2628e-01],
         [ 5.0009e-02,  2.1202e-01],
         [ 5.0009e-02,  2.1864e-01],
         [ 5.0009e-02,  2.0500e-01],
         [ 5.0009e-02, -9.0066e-02],
         [ 5.0009e-02, -7.8773e-02],
         [ 5.0009e-02, -9.7294e-02],
         [ 5.0009e-02, -7.9872e-02],
         [ 5.0009e-02,  2.0255e-01],
         [ 5.0009e-02,  2.0285e-01],
         [ 5.0009e-02,  2.0195e-01],
         [ 5.0009e-02, -8.0220e-02],
         [ 5.0009e-02, -6.3569e-02],
         [ 5.0009e-02, -8.5435e-02],
         [ 5.0009e-02,  2.1293e-01],
         [ 5.0009e-02, -9.6523e-02],
         [ 5.0009e-02, -9.4440e-02],
         [ 5.0009e-02, -9.4245e-02],
         [ 5.0009e-02, -9.4207e-02],
         [ 5.0009e-02, -9.0095e-02],
         [ 5.0009e-02, -1.0510e-01],
         [ 5.0009e-02,  8.6352e-02],
         [ 5.0009e-02, -1.1120e-01],
         [ 5.0009e-02, -1.0460e-01],
         [ 5.0009e-02, -1.1468e-01],
         [ 5.0009e-02,  8.7675e-02],
         [ 5.0009e-02,  9.3339e-02],
         [ 5.0009e-02,  1.1464e-01],
         [ 5.0009e-02, -1.2009e-01],
         [ 5.0009e-02, -1.0415e-01],
         [ 5.0009e-02, -9.8967e-02],
         [ 5.0009e-02, -9.2874e-02],
         [ 5.0009e-02, -1.0376e-01],
         [ 5.0009e-02,  1.0404e-01],
         [ 5.0009e-02, -1.3310e-01],
         [ 5.0009e-02, -1.1727e-01],
         [ 5.0009e-02, -9.8710e-02],
         [ 5.0009e-02, -8.9451e-02],
         [ 5.0009e-02, -9.8963e-02],
         [ 5.0009e-02, -6.0152e-02],
         [ 5.0009e-02, -5.1617e-02],
         [ 5.0009e-02, -6.4013e-02],
         [ 5.0009e-02, -8.2040e-02],
         [ 5.0009e-02, -1.1997e-01],
         [ 5.0009e-02, -1.0953e-01],
         [ 5.0009e-02, -1.3184e-01],
         [ 5.0009e-02, -1.3909e-01],
         [ 5.0009e-02, -1.5968e-01],
         [ 5.0009e-02, -1.5605e-01],
         [ 5.0009e-02, -1.4911e-01],
         [ 5.0009e-02, -1.4572e-01],
         [ 5.0009e-02,  9.1396e-02],
         [ 5.0009e-02,  8.8900e-02],
         [ 5.0009e-02,  8.9520e-02],
         [ 5.0009e-02, -1.6311e-01],
         [ 5.0009e-02, -1.4103e-01],
         [ 5.0009e-02, -1.4777e-01],
         [ 5.0009e-02, -1.5338e-01],
         [ 5.0009e-02, -1.5050e-01],
         [ 5.0009e-02,  9.0362e-02],
         [ 5.0009e-02, -1.5726e-01],
         [ 5.0009e-02, -1.5505e-01],
         [ 5.0009e-02, -1.5922e-01],
         [ 5.0009e-02,  1.9150e-02]],

        [[-4.2377e-02, -1.1096e-02],
         [-5.5027e-02, -2.2961e-02],
         [-4.1139e-02, -3.0575e-02],
         [-3.2662e-02, -4.3250e-02],
         [-4.2330e-02, -3.3436e-02],
         [-2.3718e-02, -4.0629e-02],
         [-5.8590e-02, -4.0934e-02],
         [-8.4974e-02, -2.9617e-02],
         [-5.9925e-02, -2.9218e-02],
         [-5.9258e-02, -2.3082e-02],
         [ 1.6852e-01, -1.5386e-02],
         [-2.0264e-02, -8.4988e-03],
         [-2.5192e-02, -3.7857e-02],
         [-6.2545e-03, -4.0398e-02],
         [ 1.5086e-02, -4.7884e-02],
         [-1.8821e-02, -3.0138e-02],
         [-6.0220e-02, -1.4213e-02],
         [-4.9873e-02, -1.2104e-02],
         [-3.0518e-02, -2.5654e-02],
         [-3.3560e-02, -1.8829e-02],
         [-3.7333e-02, -3.2817e-03],
         [-6.9114e-02, -6.3185e-03],
         [-7.3922e-02, -3.1255e-02],
         [-8.7049e-02, -1.8565e-02],
         [-5.4217e-02, -1.1027e-02],
         [-1.9287e-02, -1.1783e-02],
         [-2.2817e-02, -3.9562e-02],
         [ 1.7741e-01, -3.0440e-02],
         [ 1.7950e-01, -4.7343e-02],
         [ 1.7848e-01, -6.4394e-02],
         [-2.2659e-02, -5.7749e-02],
         [ 1.6343e-01, -4.7370e-02],
         [ 1.8144e-01, -2.5316e-02],
         [-7.4753e-02, -1.4975e-02],
         [-7.1515e-02, -2.7384e-02],
         [-9.6875e-02, -4.0759e-02],
         [-8.2046e-02, -3.6629e-02],
         [-1.0228e-01, -4.5060e-02],
         [-8.1084e-02, -5.3261e-02],
         [-8.3552e-02, -4.4975e-02],
         [-8.9015e-02, -3.3770e-02],
         [-4.4299e-02, -7.3258e-02],
         [-2.8437e-02, -8.9202e-02],
         [ 1.6515e-01, -9.4953e-02],
         [ 1.7729e-01, -6.3383e-02],
         [ 1.7978e-01, -4.4041e-02],
         [-7.5821e-02, -3.3466e-02],
         [-9.8260e-02, -4.6174e-02],
         [-6.9414e-02, -5.2444e-02],
         [-6.4575e-02, -6.0776e-02],
         [ 1.6592e-01, -5.4466e-02],
         [-7.7386e-02, -8.1663e-02],
         [-5.8726e-02, -9.8673e-02],
         [-6.8774e-02,  1.6761e-01],
         [ 1.6354e-01, -1.1073e-01],
         [-1.1235e-01,  1.6277e-01],
         [ 1.3145e-01,  1.8230e-01],
         [ 1.2651e-01,  1.8624e-01],
         [ 1.4976e-01,  1.8383e-01],
         [-1.0310e-01,  1.5660e-01],
         [ 1.5719e-01,  1.1360e-01],
         [-4.3478e-02,  9.2760e-02],
         [-6.5489e-02,  7.1618e-02],
         [-1.1061e-01,  2.2091e-01],
         [-1.2185e-01,  2.3430e-01],
         [ 1.3051e-01,  1.1030e-01],
         [ 1.0501e-01, -1.4338e-01],
         [ 1.1574e-01, -1.2058e-01],
         [ 1.2416e-01, -1.0954e-01],
         [ 1.4123e-01, -1.0672e-01],
         [-1.6648e-01, -1.1728e-01],
         [ 1.2277e-01, -1.0784e-01],
         [ 1.3046e-01,  4.7317e-03],
         [ 1.2593e-01,  3.5153e-02],
         [-1.1335e-01,  4.7874e-02],
         [ 1.8498e-01,  5.2807e-02],
         [-6.9397e-02,  5.4573e-02],
         [-1.1243e-01,  5.5107e-02],
         [ 1.2383e-01,  5.5214e-02],
         [ 1.3862e-01,  5.5201e-02],
         [ 1.3305e-01,  5.5187e-02],
         [ 1.4448e-01,  5.5161e-02],
         [ 1.0565e-01,  5.5155e-02],
         [ 1.2594e-01,  5.5158e-02],
         [ 1.3153e-01,  5.5200e-02],
         [ 1.4550e-01,  5.5186e-02],
         [ 1.2056e-01,  5.5187e-02],
         [ 1.2911e-01,  5.5204e-02],
         [ 1.3020e-01,  5.5219e-02],
         [ 1.0828e-01,  5.5208e-02],
         [ 1.1543e-01,  5.5215e-02],
         [ 8.3100e-02,  5.5218e-02],
         [ 1.0123e-01,  5.5227e-02],
         [ 1.0586e-01,  5.5231e-02],
         [ 7.2695e-02,  5.5230e-02],
         [ 2.6262e-03,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.3340e-05, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0028, device='cuda:0')
mixer_td_error tensor(0.3256, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5011, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.1747, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0597, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1734, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0654, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1335877.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2343, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.3464e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0033, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2107, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2803, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2107, device='cuda:0', grad_fn=<MinBackward1>)
t_env 1388
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6085e-02,  1.0713e-01,  ...,  2.0049e-02,
            1.6247e-01, -1.0000e+07],
          [-1.0000e+07, -1.6729e-02,  1.0948e-01,  ...,  2.6640e-03,
            1.2965e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3875e-02,  8.8061e-02,  ..., -8.4055e-03,
            1.5805e-01, -1.0000e+07],
          [-1.0000e+07, -3.6246e-02,  1.0894e-01,  ..., -3.0980e-02,
            1.3536e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7826e-01,  1.0546e-01,  ...,  4.1326e-02,
            1.6501e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-5.4609e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.5027e-02,  7.1936e-02,  ..., -3.0500e-03,
            1.2911e-01, -1.0000e+07],
          [-1.0000e+07, -2.2961e-02,  9.6708e-02,  ..., -2.0494e-02,
            1.3243e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.1139e-02,  8.5369e-02,  ...,  1.4716e-02,
            1.3164e-01, -1.0000e+07],
          [-1.0000e+07, -3.0575e-02,  9.4245e-02,  ..., -4.3856e-02,
            1.3745e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.9938e-01,  1.0586e-01,  ...,  4.4793e-02,
            1.6853e-01, -3.1699e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.8366e-01,  7.2695e-02,  ...,  4.2428e-02,
            1.5227e-01, -3.1359e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.6262e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-7.2275e-02, -1.3772e-02],
         [-9.6085e-02, -1.6729e-02],
         [-9.3875e-02, -3.6246e-02],
         [-8.3684e-02, -3.0700e-02],
         [-8.3479e-02, -5.2606e-02],
         [-9.8128e-02, -4.0782e-02],
         [-5.0888e-02, -5.7989e-02],
         [-3.7096e-02, -6.3909e-02],
         [-5.9501e-02, -7.1258e-02],
         [-7.4686e-02, -5.4691e-02],
         [-9.2496e-02, -4.4071e-02],
         [-1.4150e-01, -4.9890e-02],
         [-1.6530e-01, -5.4797e-02],
         [-1.8353e-01, -6.1068e-02],
         [-1.9004e-01, -6.7920e-02],
         [-1.9500e-01, -7.0337e-02],
         [-1.4735e-01, -9.1894e-02],
         [-1.7770e-01, -6.7941e-02],
         [-1.4258e-01, -6.4514e-02],
         [ 1.1971e-01, -7.0163e-02],
         [ 1.1534e-01,  1.2716e-01],
         [-1.8095e-01,  1.1264e-01],
         [ 1.1286e-01, -1.4897e-01],
         [ 1.2074e-01, -1.3844e-01],
         [ 1.2001e-01, -1.3551e-01],
         [ 1.4057e-01,  1.8054e-01],
         [ 1.3404e-01,  1.7876e-01],
         [-2.1508e-01, -1.3127e-01],
         [-1.8639e-01, -1.1781e-01],
         [-1.8151e-01, -1.1179e-01],
         [ 1.0854e-01, -1.2224e-01],
         [ 1.3098e-01, -1.0769e-01],
         [ 1.3012e-01, -1.0320e-01],
         [-1.8694e-01, -1.0290e-01],
         [ 1.3104e-01, -1.0822e-01],
         [ 1.1995e-01, -1.3641e-01],
         [-1.9967e-01, -1.2104e-01],
         [-1.7193e-01,  1.5734e-01],
         [-1.4674e-01,  1.3776e-01],
         [-1.4801e-01,  1.1786e-01],
         [-1.0401e-01,  9.1714e-02],
         [ 1.3964e-01, -2.0066e-01],
         [-7.3282e-02,  9.0206e-02],
         [ 1.3396e-01,  7.1427e-02],
         [ 1.0815e-01, -1.9523e-01],
         [ 9.8372e-02,  9.8736e-02],
         [ 1.2186e-01, -1.7497e-01],
         [ 7.0507e-02, -1.5150e-01],
         [-1.7641e-01, -1.3366e-01],
         [ 9.1739e-02, -1.1579e-01],
         [ 1.0728e-01, -9.9206e-02],
         [-1.6040e-01, -1.3112e-01],
         [ 9.6498e-02, -1.1043e-01],
         [-1.4781e-01,  1.0658e-01],
         [ 8.8447e-02, -1.5211e-01],
         [ 9.2699e-02,  6.6659e-02],
         [ 9.6148e-02,  7.1523e-02],
         [ 8.2403e-02, -1.6404e-01],
         [-1.2869e-01,  6.0023e-02],
         [-1.3186e-01,  7.3924e-02],
         [ 9.5735e-02,  7.8877e-02],
         [-1.3404e-01,  7.3714e-02],
         [-1.1818e-01,  2.5994e-01],
         [-1.3238e-01, -1.8313e-01],
         [-1.3646e-01, -1.6130e-02],
         [ 9.2751e-02,  2.2383e-02],
         [ 9.2730e-02,  4.1224e-02],
         [ 1.0865e-01,  4.9815e-02],
         [ 1.0521e-01,  5.3394e-02],
         [-1.5288e-01,  5.4752e-02],
         [-1.4522e-01,  5.5197e-02],
         [-1.3252e-01,  5.5260e-02],
         [-1.2247e-01,  5.5271e-02],
         [-1.3183e-01,  5.5242e-02],
         [ 9.5932e-02,  5.5212e-02],
         [ 9.8053e-02,  5.5195e-02],
         [-1.3369e-01,  5.5188e-02],
         [-1.2341e-01,  5.5194e-02],
         [-1.0620e-01,  5.5217e-02],
         [-6.5778e-02,  5.5199e-02],
         [-6.3363e-02,  5.5205e-02],
         [ 1.4507e-01,  5.5211e-02],
         [ 1.5629e-01,  5.5207e-02],
         [ 1.6322e-01,  5.5212e-02],
         [ 1.5895e-01,  5.5229e-02],
         [-1.0671e-01,  5.5230e-02],
         [-1.3724e-01,  5.5230e-02],
         [ 1.0614e-01,  5.5230e-02],
         [-1.7091e-01,  5.5234e-02],
         [ 1.0300e-01,  5.5235e-02],
         [-1.7566e-01,  5.5235e-02],
         [ 9.7220e-02,  5.5232e-02],
         [ 1.0048e-01,  5.5232e-02],
         [ 1.0546e-01,  5.5231e-02],
         [-5.4609e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07]],

        [[-4.2377e-02, -1.1096e-02],
         [-5.5027e-02, -2.2961e-02],
         [-4.1139e-02, -3.0575e-02],
         [-3.2662e-02, -4.3250e-02],
         [-4.2330e-02, -3.3436e-02],
         [-2.3718e-02, -4.0629e-02],
         [-5.8590e-02, -4.0934e-02],
         [-8.4974e-02, -2.9617e-02],
         [-5.9925e-02, -2.9218e-02],
         [-5.9258e-02, -2.3082e-02],
         [-4.8420e-02, -1.5386e-02],
         [-2.0264e-02, -8.4988e-03],
         [-2.5192e-02, -3.7857e-02],
         [-6.2545e-03, -4.0398e-02],
         [ 1.5086e-02, -4.7884e-02],
         [-1.8821e-02, -3.0138e-02],
         [-6.0220e-02, -1.4213e-02],
         [-4.9873e-02, -1.2104e-02],
         [-3.0518e-02, -2.5654e-02],
         [-3.3560e-02, -1.8829e-02],
         [-3.7333e-02, -3.2817e-03],
         [-6.9114e-02, -6.3185e-03],
         [-7.3922e-02, -3.1255e-02],
         [-8.7049e-02, -1.8565e-02],
         [-5.4217e-02, -1.1027e-02],
         [-1.9287e-02, -1.1783e-02],
         [-2.2817e-02, -3.9562e-02],
         [-2.6880e-02, -3.0440e-02],
         [-4.2481e-02, -4.7343e-02],
         [ 1.7848e-01, -6.4394e-02],
         [-2.2659e-02, -5.7749e-02],
         [-4.0732e-02, -4.7370e-02],
         [-3.9118e-02, -2.5316e-02],
         [-7.4753e-02, -1.4975e-02],
         [-7.1515e-02, -2.7384e-02],
         [-9.6875e-02, -4.0759e-02],
         [-8.2046e-02, -3.6629e-02],
         [-1.0228e-01, -4.5060e-02],
         [-8.1084e-02, -5.3261e-02],
         [-8.3552e-02, -4.4975e-02],
         [-8.9015e-02, -3.3770e-02],
         [-4.4299e-02, -7.3258e-02],
         [-2.8437e-02, -8.9202e-02],
         [-2.0371e-02, -9.4953e-02],
         [-3.1608e-02, -6.3383e-02],
         [-5.0022e-02, -4.4041e-02],
         [-7.5821e-02, -3.3466e-02],
         [-9.8260e-02, -4.6174e-02],
         [-6.9414e-02, -5.2444e-02],
         [-6.4575e-02, -6.0776e-02],
         [-6.2315e-02, -5.4466e-02],
         [-7.7386e-02, -8.1663e-02],
         [-5.8726e-02, -9.8673e-02],
         [-6.8774e-02, -1.1109e-01],
         [-7.8421e-02, -1.1073e-01],
         [-1.1235e-01, -1.2527e-01],
         [-1.5573e-01,  1.8230e-01],
         [-1.8293e-01,  1.8624e-01],
         [-1.5116e-01,  1.8383e-01],
         [-1.0310e-01, -1.3318e-01],
         [-8.6731e-02, -1.6008e-01],
         [-4.3478e-02, -1.8375e-01],
         [-6.5489e-02, -2.0362e-01],
         [-1.1061e-01,  4.6336e-02],
         [-1.2185e-01,  5.9508e-02],
         [ 1.3051e-01, -1.7891e-01],
         [-1.8562e-01, -1.4338e-01],
         [ 1.1574e-01, -1.2058e-01],
         [ 1.2416e-01, -1.0954e-01],
         [ 1.4123e-01, -1.0672e-01],
         [-1.6648e-01, -1.1728e-01],
         [-1.8091e-01, -1.0784e-01],
         [ 1.3046e-01,  4.7317e-03],
         [ 1.2593e-01,  3.5153e-02],
         [-1.1335e-01,  4.7874e-02],
         [ 1.8498e-01,  5.2807e-02],
         [-6.9397e-02,  5.4573e-02],
         [-1.1243e-01,  5.5107e-02],
         [-1.4778e-01,  5.5214e-02],
         [ 1.3862e-01,  5.5201e-02],
         [ 1.3305e-01,  5.5187e-02],
         [ 1.4448e-01,  5.5161e-02],
         [ 1.0565e-01,  5.5155e-02],
         [ 1.2594e-01,  5.5158e-02],
         [ 1.3153e-01,  5.5200e-02],
         [ 1.4550e-01,  5.5186e-02],
         [ 1.2056e-01,  5.5187e-02],
         [ 1.2911e-01,  5.5204e-02],
         [ 1.3020e-01,  5.5219e-02],
         [ 1.0828e-01,  5.5208e-02],
         [ 1.1543e-01,  5.5215e-02],
         [ 8.3100e-02,  5.5218e-02],
         [ 1.0123e-01,  5.5227e-02],
         [ 1.0586e-01,  5.5231e-02],
         [-1.8366e-01,  5.5230e-02],
         [ 2.6262e-03,  5.5230e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.8845e-05, device='cuda:0') tensor(0.0014, device='cuda:0') tensor(-0.0010, device='cuda:0')
mixer_td_error tensor(0.0363, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4999, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4897, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0296, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1573, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0796, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-52083.3438, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2599, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.9865e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1853, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2660, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1853, device='cuda:0', grad_fn=<MinBackward1>)
t_env 1450
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6085e-02,  1.0713e-01,  ...,  2.0049e-02,
            1.6247e-01, -1.0000e+07],
          [-1.0000e+07, -1.6729e-02,  1.0948e-01,  ...,  2.6640e-03,
            1.2965e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3875e-02,  8.8061e-02,  ..., -8.4055e-03,
            1.5805e-01, -1.0000e+07],
          [-1.0000e+07, -3.6246e-02,  1.0894e-01,  ..., -3.0980e-02,
            1.3536e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7180e-01,  1.0048e-01,  ...,  4.6637e-02,
            1.5591e-01, -1.0000e+07],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7826e-01,  1.0546e-01,  ...,  4.1326e-02,
            1.6501e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-5.4609e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0948e-02,  7.3316e-02,  ...,  4.2360e-02,
            1.4141e-01, -1.0000e+07],
          [-1.0000e+07, -1.8789e-02,  1.1070e-01,  ...,  4.1064e-03,
            1.2950e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0493e-01,  9.5342e-02,  ...,  2.8501e-02,
            1.6248e-01, -1.0000e+07],
          [-1.0000e+07, -2.5057e-02,  1.2023e-01,  ..., -1.0731e-02,
            1.3315e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02, -1.3772e-02],
         [ 1.0713e-01, -1.6729e-02],
         [-9.3875e-02, -3.6246e-02],
         [-8.3684e-02, -3.0700e-02],
         [-8.3479e-02, -5.2606e-02],
         [-9.8128e-02, -4.0782e-02],
         [-5.0888e-02, -5.7989e-02],
         [ 1.5289e-01, -6.3909e-02],
         [-5.9501e-02, -7.1258e-02],
         [-7.4686e-02, -5.4691e-02],
         [-9.2496e-02, -4.4071e-02],
         [ 1.1051e-01,  1.5141e-01],
         [ 1.1411e-01,  1.6509e-01],
         [ 1.2271e-01,  1.6682e-01],
         [ 1.2024e-01,  1.6277e-01],
         [ 1.1130e-01,  1.6612e-01],
         [-1.4735e-01,  1.2394e-01],
         [ 1.1444e-01, -6.7941e-02],
         [ 6.4487e-02,  1.4207e-01],
         [ 1.1971e-01,  1.5596e-01],
         [ 1.1534e-01,  1.2716e-01],
         [ 8.6700e-02,  1.1264e-01],
         [ 1.1286e-01,  1.2427e-01],
         [ 1.2074e-01,  1.1945e-01],
         [ 1.2001e-01,  1.6221e-01],
         [ 1.4057e-01,  1.8054e-01],
         [ 1.3404e-01,  1.7876e-01],
         [ 8.2030e-02,  1.4613e-01],
         [ 8.3591e-02, -1.1781e-01],
         [ 7.6843e-02,  1.3002e-01],
         [ 1.0854e-01,  1.2694e-01],
         [ 1.3098e-01, -1.0769e-01],
         [ 1.3012e-01,  1.2926e-01],
         [ 7.8268e-02,  1.3888e-01],
         [ 1.3104e-01,  1.4288e-01],
         [ 1.1995e-01,  1.3116e-01],
         [ 1.0989e-01, -1.2104e-01],
         [ 5.9633e-02,  1.5734e-01],
         [ 7.5788e-02,  1.3776e-01],
         [ 9.2760e-02,  1.1786e-01],
         [ 1.1007e-01,  9.1714e-02],
         [ 1.3964e-01,  6.0981e-02],
         [ 1.0639e-01,  9.0206e-02],
         [ 1.3396e-01,  7.1427e-02],
         [ 1.0815e-01,  7.0678e-02],
         [ 9.8372e-02,  9.8736e-02],
         [ 1.2186e-01,  9.0344e-02],
         [ 7.0507e-02, -1.5150e-01],
         [ 6.3981e-02, -1.3366e-01],
         [ 9.1739e-02, -1.1579e-01],
         [ 1.0728e-01, -9.9206e-02],
         [ 6.0738e-02,  9.1512e-02],
         [ 9.6498e-02,  1.2369e-01],
         [ 6.6778e-02,  1.0658e-01],
         [ 8.8447e-02,  5.8208e-02],
         [ 9.2699e-02,  6.6659e-02],
         [ 9.6148e-02,  7.1523e-02],
         [ 8.2403e-02, -1.6404e-01],
         [ 7.6061e-02,  6.0023e-02],
         [ 8.6408e-02,  7.3924e-02],
         [ 9.5735e-02,  7.8877e-02],
         [ 7.8302e-02,  7.3714e-02],
         [-1.1818e-01,  2.5994e-01],
         [ 8.2177e-02,  5.8956e-02],
         [ 8.7683e-02, -1.6130e-02],
         [ 9.2751e-02,  2.2383e-02],
         [ 9.2730e-02,  4.1224e-02],
         [ 1.0865e-01,  4.9815e-02],
         [ 1.0521e-01,  5.3394e-02],
         [ 6.1773e-02,  5.4752e-02],
         [ 8.2728e-02,  5.5197e-02],
         [ 7.5271e-02,  5.5260e-02],
         [ 7.1240e-02,  5.5271e-02],
         [ 8.9970e-02,  5.5242e-02],
         [ 9.5932e-02,  5.5212e-02],
         [ 9.8053e-02,  5.5195e-02],
         [ 7.7203e-02,  5.5188e-02],
         [ 6.9477e-02,  5.5194e-02],
         [-1.0620e-01,  5.5217e-02],
         [-6.5778e-02,  5.5199e-02],
         [ 1.3347e-01,  5.5205e-02],
         [ 1.4507e-01,  5.5211e-02],
         [ 1.5629e-01,  5.5207e-02],
         [ 1.6322e-01,  5.5212e-02],
         [ 1.5895e-01,  5.5229e-02],
         [ 1.1127e-01,  5.5230e-02],
         [ 9.5475e-02,  5.5230e-02],
         [ 1.0614e-01,  5.5230e-02],
         [ 6.9667e-02,  5.5234e-02],
         [ 1.0300e-01,  5.5235e-02],
         [ 7.2349e-02,  5.5235e-02],
         [ 9.7220e-02,  5.5232e-02],
         [ 1.0048e-01,  5.5232e-02],
         [ 1.0546e-01,  5.5231e-02],
         [-5.4609e-03,  5.5231e-02]],

        [[ 1.0780e-01, -1.6811e-02],
         [-8.0948e-02, -1.8789e-02],
         [-1.0493e-01, -2.5057e-02],
         [-9.2587e-02, -4.2417e-02],
         [-1.0644e-01, -4.0353e-02],
         [-7.6575e-02, -4.8187e-02],
         [-8.9589e-02, -3.1261e-02],
         [-8.4542e-02, -6.1381e-02],
         [-9.1425e-02, -4.0001e-02],
         [ 9.8131e-02, -4.6573e-02],
         [-9.2479e-02, -6.3116e-02],
         [-8.8738e-02, -7.2894e-02],
         [-7.3215e-02,  1.1220e-01],
         [-5.2229e-02, -9.1545e-02],
         [-6.8613e-02,  1.0364e-01],
         [-7.4374e-02,  1.1695e-01],
         [-5.6511e-02,  7.7338e-02],
         [-4.0418e-02,  1.1185e-01],
         [-5.1149e-02,  1.2157e-01],
         [-5.6808e-02,  7.8122e-02],
         [-4.2105e-02,  9.8220e-02],
         [-5.2184e-02,  1.1613e-01],
         [-6.9471e-02,  8.1639e-02],
         [-4.9075e-02,  9.6023e-02],
         [-5.2413e-02,  1.0995e-01],
         [-6.8974e-02,  9.8083e-02],
         [ 1.3189e-01, -1.6438e-01],
         [ 1.5355e-01, -1.4232e-01],
         [ 1.3319e-01, -1.2817e-01],
         [ 1.4755e-01,  1.3836e-01],
         [ 1.4394e-01, -1.3374e-01],
         [ 1.1068e-01, -1.1742e-01],
         [ 1.3933e-01, -1.1364e-01],
         [ 1.0936e-01, -1.0852e-01],
         [ 1.4213e-01, -1.1956e-01],
         [ 1.1816e-01, -6.4278e-03],
         [ 1.0565e-01,  2.5142e-02],
         [ 8.6109e-02,  4.2084e-02],
         [-1.5910e-01,  5.0180e-02],
         [ 8.0208e-02,  5.3727e-02],
         [ 1.0120e-01,  5.5128e-02],
         [ 8.3156e-02,  5.5544e-02],
         [ 1.2780e-01,  5.5612e-02],
         [ 9.8728e-02,  5.5523e-02],
         [ 1.1408e-01,  5.5444e-02],
         [ 8.9938e-02,  5.5359e-02],
         [ 9.4646e-02,  5.5309e-02],
         [ 9.5243e-02,  5.5259e-02],
         [ 9.3598e-02,  5.5215e-02],
         [ 8.0578e-02,  5.5232e-02],
         [ 7.5030e-02,  5.5209e-02],
         [ 1.0299e-01,  5.5215e-02],
         [ 8.2706e-02,  5.5215e-02],
         [ 1.1988e-01,  5.5220e-02],
         [ 8.9034e-02,  5.5223e-02],
         [ 7.0128e-02,  5.5231e-02],
         [-1.4641e-01,  5.5232e-02],
         [ 1.5547e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0001, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0029, device='cuda:0')
mixer_td_error tensor(0.4341, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5043, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8204, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0236, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1076, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0961, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1947368.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2599, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.6772e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0024, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1980, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1884, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1980, device='cuda:0', grad_fn=<MinBackward1>)
t_env 1557
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5898e-02,  1.0054e-01,  ...,  4.1830e-02,
            1.6437e-01, -1.0000e+07],
          [-1.0000e+07, -3.7039e-02,  1.0473e-01,  ..., -3.1371e-02,
            1.3582e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.9098e-01,  8.2850e-02,  ...,  9.2807e-02,
            2.2962e-01, -3.3740e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6709e-01,  5.4118e-02,  ...,  5.6809e-02,
            2.0959e-01, -3.2237e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 7.7317e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.8799e-02,  1.1017e-01,  ...,  6.1516e-02,
            1.3971e-01, -1.0000e+07],
          [-1.0000e+07, -2.8322e-02,  1.2490e-01,  ...,  1.4773e-02,
            1.3610e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3357e-02,  7.6576e-02,  ...,  4.4627e-02,
            1.3934e-01, -1.0000e+07],
          [-1.0000e+07, -2.5884e-02,  1.2689e-01,  ..., -4.2544e-03,
            1.3727e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.9090e-02,  5.8755e-02,  ...,  3.9416e-02,
            1.3901e-01, -1.0000e+07],
          [-1.0000e+07, -2.5911e-02,  1.2652e-01,  ..., -1.9137e-02,
            1.3974e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02, -1.3772e-02],
         [ 6.9213e-02, -1.4399e-02],
         [ 1.0054e-01, -3.7039e-02],
         [ 3.1893e-02,  1.2846e-01],
         [ 8.6416e-02,  1.2174e-01],
         [ 9.6515e-02, -5.5130e-02],
         [ 1.1932e-01, -5.9508e-02],
         [-5.3548e-02, -4.2156e-02],
         [ 1.2353e-01,  1.1663e-01],
         [ 1.3797e-01,  1.0732e-01],
         [ 1.0508e-01,  1.3067e-01],
         [ 1.2609e-01,  1.0504e-01],
         [-4.0191e-02, -4.3882e-02],
         [-2.6975e-02,  1.0996e-01],
         [ 1.3455e-01, -1.8133e-02],
         [ 1.4066e-01,  1.0717e-01],
         [ 1.3162e-01,  1.0793e-01],
         [ 1.3845e-01, -6.6556e-02],
         [ 1.4298e-01, -6.2646e-02],
         [-3.3808e-02,  1.0184e-01],
         [ 1.3219e-01, -6.2139e-02],
         [ 1.4796e-01, -6.5015e-02],
         [ 1.2216e-01, -1.7075e-02],
         [ 1.1143e-01, -8.4041e-04],
         [ 1.2215e-01,  1.5181e-01],
         [ 1.4332e-01,  1.6300e-01],
         [ 1.2056e-01,  1.1553e-01],
         [ 9.4064e-02,  1.0135e-01],
         [ 9.9496e-02,  1.0145e-01],
         [ 1.0317e-01, -6.5109e-02],
         [ 1.0319e-01,  8.5217e-02],
         [ 1.0485e-01, -5.9176e-02],
         [ 1.0517e-01,  8.6492e-02],
         [ 1.3033e-01,  1.2265e-01],
         [ 1.0019e-01,  1.0710e-01],
         [ 1.2240e-01,  1.0243e-01],
         [-5.5779e-02,  9.6051e-02],
         [ 1.3477e-01, -7.9570e-02],
         [ 1.0187e-01,  7.9566e-02],
         [ 1.2417e-01, -7.3383e-02],
         [ 1.5434e-01,  7.7232e-02],
         [ 1.0743e-01, -3.1132e-02],
         [ 1.0294e-01,  9.3360e-02],
         [ 1.1113e-01, -7.4617e-02],
         [ 1.2676e-01, -8.1379e-02],
         [ 1.6209e-01, -7.3483e-02],
         [ 1.5323e-01,  9.5454e-02],
         [ 1.6167e-01,  5.3459e-02],
         [ 1.6836e-01,  1.0884e-01],
         [ 1.3134e-01,  1.0926e-01],
         [ 1.5380e-01,  6.9887e-02],
         [ 1.6571e-01,  8.1627e-02],
         [ 1.5162e-01,  6.2118e-02],
         [ 1.4845e-01,  5.4620e-02],
         [ 1.0752e-01,  8.0493e-02],
         [ 1.2681e-01,  1.1036e-01],
         [ 1.4247e-01,  6.1617e-02],
         [ 1.4781e-01,  6.6640e-02],
         [ 1.1204e-01,  1.0972e-01],
         [ 1.4207e-01,  8.1686e-02],
         [ 1.4843e-01,  8.1275e-02],
         [ 1.6215e-01,  7.7008e-02],
         [ 1.7869e-01,  7.3587e-02],
         [ 1.5282e-01,  7.9914e-02],
         [ 1.6030e-01,  1.2369e-01],
         [ 1.6376e-01,  1.2750e-01],
         [ 1.3191e-01,  8.9051e-02],
         [ 1.5730e-01,  8.2708e-02],
         [ 1.4165e-01,  6.2142e-02],
         [ 1.0788e-01,  5.7694e-02],
         [ 1.3217e-01,  7.5260e-02],
         [ 1.4254e-01,  7.9808e-02],
         [ 1.3868e-01,  1.1031e-01],
         [ 1.2106e-01,  9.3386e-02],
         [ 1.1388e-01,  8.8485e-02],
         [ 1.3693e-01,  6.5543e-02],
         [ 1.2548e-01,  1.1065e-01],
         [ 1.3744e-01,  9.7337e-02],
         [-2.7880e-02,  9.6369e-02],
         [ 1.1731e-02,  9.7769e-02],
         [ 3.2451e-02,  9.7303e-02],
         [ 4.2652e-02,  9.9711e-02],
         [ 4.7360e-02,  5.6902e-02],
         [ 4.9350e-02, -8.6290e-02],
         [ 5.0077e-02,  7.0882e-02],
         [ 5.0260e-02,  6.9613e-02],
         [ 5.0237e-02, -8.2090e-02],
         [ 5.0194e-02,  5.7997e-02],
         [ 5.0129e-02,  9.1984e-02],
         [ 5.0073e-02,  7.7525e-02],
         [ 5.0050e-02,  9.9920e-02],
         [ 5.0032e-02,  7.0477e-02],
         [ 5.0042e-02,  8.3020e-02],
         [ 5.0034e-02,  9.0730e-02],
         [ 5.0034e-02,  7.9712e-02],
         [ 5.0024e-02,  5.0051e-02],
         [ 5.0012e-02,  9.9623e-02],
         [ 5.0007e-02,  1.1556e-01],
         [ 5.0013e-02,  7.8086e-02],
         [ 5.0005e-02,  6.7500e-02],
         [ 5.0006e-02,  5.8099e-02],
         [ 5.0008e-02,  4.0970e-02],
         [ 5.0008e-02,  5.6879e-02],
         [ 5.0008e-02,  7.7172e-02],
         [ 5.0009e-02,  8.2850e-02],
         [ 5.0008e-02,  5.4118e-02],
         [ 5.0008e-02,  7.7317e-03]],

        [[ 1.1017e-01,  1.2490e-01],
         [ 4.4627e-02,  1.2689e-01],
         [ 3.9416e-02, -2.5911e-02],
         [ 7.7228e-02,  1.4016e-01],
         [ 9.7377e-02,  1.2443e-01],
         [ 9.1265e-02, -4.5953e-02],
         [ 9.0258e-02,  1.2260e-01],
         [-7.5913e-02,  1.2862e-01],
         [ 1.0173e-01,  1.3239e-01],
         [ 1.1362e-01,  1.1837e-01],
         [ 1.1453e-01,  1.3216e-01],
         [ 9.0659e-02,  1.4369e-01],
         [ 1.1898e-01,  1.2355e-01],
         [ 1.0675e-01,  1.1615e-01],
         [ 1.0052e-01,  1.1174e-01],
         [ 9.6374e-02,  1.3320e-01],
         [ 1.2098e-01,  1.5047e-01],
         [ 1.1359e-01,  7.3127e-02],
         [ 1.3350e-01,  8.0978e-02],
         [ 1.4640e-01,  2.0666e-01],
         [ 1.1619e-01,  6.5704e-02],
         [ 9.2573e-02,  6.4320e-02],
         [ 1.1584e-01,  9.9201e-02],
         [ 1.0966e-01,  1.1802e-01],
         [ 8.6072e-02,  6.8494e-02],
         [ 1.0683e-01,  9.9457e-02],
         [ 1.0230e-01,  6.1851e-02],
         [ 8.0722e-02,  1.3665e-01],
         [ 7.6291e-02,  1.2979e-01],
         [ 6.5224e-02,  1.7145e-01],
         [ 1.0459e-01,  1.3897e-01],
         [ 1.3237e-01,  8.8752e-02],
         [ 1.1212e-01,  1.1611e-01],
         [ 1.1680e-01,  1.1592e-01],
         [ 1.5335e-01,  1.1074e-01],
         [ 1.2648e-01,  1.1028e-01],
         [ 7.2259e-02,  1.3994e-01],
         [ 1.0498e-01,  1.1687e-01],
         [ 1.2999e-01,  1.4187e-01],
         [ 1.6023e-01,  1.1625e-01],
         [ 1.7786e-01,  1.2838e-01],
         [ 1.3986e-01,  1.5269e-01],
         [ 1.2664e-01,  1.5076e-01],
         [ 1.2916e-01,  1.5014e-01],
         [ 1.0589e-01,  1.4901e-01],
         [ 1.3291e-01,  1.1274e-01],
         [ 1.4468e-01,  5.0993e-03],
         [ 1.0870e-01,  3.1411e-02],
         [ 1.0849e-01,  4.5714e-02],
         [ 6.7021e-02,  5.2212e-02],
         [ 9.6770e-02,  5.4775e-02],
         [ 6.1915e-02,  5.5544e-02],
         [ 8.3715e-02,  5.5643e-02],
         [ 1.0102e-01,  5.5543e-02],
         [-3.4857e-03,  5.5415e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0001, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0024, device='cuda:0')
mixer_td_error tensor(0.5606, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4706, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7192, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0346, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1460, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0793, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2429906.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2067, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.8549e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0017, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2305, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1220, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2305, device='cuda:0', grad_fn=<MinBackward1>)
t_env 1632
target_mac_out tensor([[[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9456e-02,  9.6197e-02,  ...,  8.5356e-03,
            1.5201e-01, -1.0000e+07],
          [-1.0000e+07, -6.3036e-02,  1.6373e-01,  ...,  4.7519e-02,
            1.4996e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0500e-01,  1.1218e-01,  ...,  3.6129e-02,
            1.7218e-01, -1.0000e+07],
          [-1.0000e+07, -9.2310e-02,  1.7435e-01,  ...,  6.6672e-02,
            1.5773e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0703e-01,  7.6857e-02,  ...,  7.6963e-02,
            1.9030e-01, -3.2883e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1889e-01, -1.0000e+07,  ..., -1.0000e+07,
            1.8635e-01, -3.2443e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 8.4048e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.8799e-02,  1.1017e-01,  ...,  6.1516e-02,
            1.3971e-01, -1.0000e+07],
          [-1.0000e+07, -2.8322e-02,  1.2490e-01,  ...,  1.4773e-02,
            1.3610e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3357e-02,  7.6576e-02,  ...,  4.4627e-02,
            1.3934e-01, -1.0000e+07],
          [-1.0000e+07, -2.5884e-02,  1.2689e-01,  ..., -4.2544e-03,
            1.3727e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.9090e-02,  5.8755e-02,  ...,  3.9416e-02,
            1.3901e-01, -1.0000e+07],
          [-1.0000e+07, -2.5911e-02,  1.2652e-01,  ..., -1.9137e-02,
            1.3974e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.2334e-02,  1.2843e-01],
         [ 9.6197e-02,  1.6373e-01],
         [ 1.1218e-01,  1.7435e-01],
         [ 3.9035e-02,  1.4191e-01],
         [ 1.0091e-01,  1.5448e-01],
         [ 8.6569e-02,  1.7899e-01],
         [ 3.3030e-02,  1.5000e-01],
         [ 3.6796e-02,  1.0921e-01],
         [ 5.0384e-02,  1.0488e-01],
         [ 3.8489e-02,  1.4491e-01],
         [ 9.3162e-02,  1.4860e-01],
         [ 1.1595e-01,  1.0838e-01],
         [ 1.4084e-01,  1.0750e-01],
         [ 1.7813e-01,  1.3085e-01],
         [ 1.4711e-01,  1.6084e-01],
         [ 1.1646e-01,  1.5636e-01],
         [ 1.1727e-01,  1.5379e-01],
         [ 4.8413e-02,  1.2055e-01],
         [ 7.6937e-02,  8.2771e-02],
         [ 1.1149e-01,  9.0675e-02],
         [ 9.0459e-02,  8.7829e-02],
         [ 9.2136e-02, -8.8737e-02],
         [ 8.3401e-02, -4.6168e-03],
         [-4.6254e-02,  2.7519e-02],
         [ 8.4706e-02,  4.3186e-02],
         [ 1.0916e-01,  5.0276e-02],
         [ 1.4702e-01,  5.3264e-02],
         [-1.5284e-02,  5.4445e-02],
         [-1.9647e-02,  5.4922e-02],
         [-2.2002e-02,  5.5045e-02],
         [-2.2926e-02,  5.5093e-02],
         [ 8.9356e-02,  5.5147e-02],
         [ 9.8585e-02,  5.5152e-02],
         [ 8.8775e-02,  5.5134e-02],
         [ 7.0797e-02,  5.5194e-02],
         [ 7.6574e-02,  5.5200e-02],
         [ 7.6345e-02,  5.5204e-02],
         [ 8.8881e-02,  5.5206e-02],
         [ 8.1957e-02,  5.5214e-02],
         [ 9.1618e-02,  5.5214e-02],
         [ 7.0254e-02,  5.5206e-02],
         [-7.4892e-02,  5.5218e-02],
         [-5.1354e-02,  5.5221e-02],
         [ 8.6586e-02,  5.5232e-02],
         [ 9.9361e-02,  5.5230e-02],
         [ 7.7583e-02,  5.5230e-02],
         [ 5.9539e-02,  5.5234e-02],
         [-4.0582e-02,  5.5235e-02],
         [ 9.4360e-02,  5.5235e-02],
         [ 7.4364e-02,  5.5232e-02],
         [ 9.4120e-02,  5.5232e-02],
         [-4.6562e-02,  5.5231e-02],
         [ 9.1357e-02,  5.5231e-02],
         [ 1.0502e-01,  5.5231e-02],
         [ 1.0784e-01,  5.5231e-02],
         [ 5.4861e-02,  5.5231e-02],
         [-5.0683e-02,  5.5231e-02],
         [-4.0951e-02,  5.5231e-02],
         [-2.9707e-02,  5.5231e-02],
         [ 8.8494e-02,  5.5231e-02],
         [ 8.4079e-02,  5.5231e-02],
         [ 9.4216e-02,  5.5231e-02],
         [ 9.8911e-02,  5.5231e-02],
         [ 7.4679e-02,  5.5231e-02],
         [ 8.0014e-02,  5.5231e-02],
         [ 8.3372e-02,  5.5231e-02],
         [ 7.2725e-02,  5.5231e-02],
         [ 9.3382e-02,  5.5231e-02],
         [ 7.3685e-02,  5.5231e-02],
         [-7.1960e-02,  5.5231e-02],
         [-4.9988e-02,  5.5231e-02],
         [-4.0193e-02,  5.5231e-02],
         [-2.9271e-02,  5.5231e-02],
         [-3.3594e-02,  5.5231e-02],
         [ 8.2226e-02,  5.5231e-02],
         [-4.2226e-02,  5.5231e-02],
         [-3.0877e-02,  5.5231e-02],
         [-3.4407e-02,  5.5231e-02],
         [ 8.7586e-02,  5.5231e-02],
         [ 9.6658e-02,  5.5231e-02],
         [ 8.8073e-02,  5.5231e-02],
         [ 9.8401e-02,  5.5231e-02],
         [ 7.6422e-02,  5.5231e-02],
         [-7.0629e-02,  5.5231e-02],
         [ 5.6964e-02,  5.5231e-02],
         [ 6.3327e-02,  5.5231e-02],
         [ 9.1442e-02,  5.5231e-02],
         [ 8.7505e-02,  5.5231e-02],
         [ 9.6115e-02,  5.5231e-02],
         [ 7.4065e-02,  5.5231e-02],
         [ 5.1445e-02,  5.5231e-02],
         [ 8.6907e-02,  5.5231e-02],
         [ 7.4162e-02,  5.5231e-02],
         [ 9.3156e-02,  5.5231e-02],
         [ 1.1400e-01,  5.5231e-02],
         [ 7.2373e-02,  5.5231e-02],
         [ 1.1089e-01,  5.5231e-02],
         [ 1.2450e-01,  5.5231e-02],
         [ 1.4518e-01,  5.5231e-02],
         [ 1.3098e-01,  5.5231e-02],
         [ 1.3895e-01,  5.5231e-02],
         [ 1.3622e-01,  5.5231e-02],
         [ 1.4585e-01,  5.5231e-02],
         [ 1.3354e-01,  5.5231e-02],
         [ 1.4076e-01,  5.5231e-02],
         [ 1.0553e-01,  5.5231e-02],
         [ 1.0599e-01,  5.5231e-02],
         [ 1.1960e-01,  5.5231e-02],
         [ 1.2587e-01,  5.5231e-02],
         [ 2.0210e-01,  5.5231e-02],
         [ 9.6539e-02,  5.5231e-02],
         [ 2.2029e-01,  5.5231e-02],
         [ 9.8385e-02,  5.5231e-02],
         [ 8.3864e-02,  5.5231e-02],
         [ 7.6857e-02,  5.5231e-02],
         [ 1.8635e-01,  5.5231e-02],
         [ 8.4048e-03,  5.5231e-02]],

        [[ 1.1017e-01,  1.2490e-01],
         [ 4.4627e-02,  1.2689e-01],
         [ 3.9416e-02,  1.2652e-01],
         [ 2.8149e-02,  1.4016e-01],
         [ 4.4605e-02,  1.2443e-01],
         [ 2.5630e-02,  1.0546e-01],
         [ 9.0258e-02,  1.2260e-01],
         [ 1.7980e-02,  1.2862e-01],
         [ 4.1690e-02,  1.3239e-01],
         [ 1.1362e-01,  1.1837e-01],
         [ 1.1453e-01,  1.3216e-01],
         [ 9.0659e-02,  1.4369e-01],
         [ 1.1898e-01,  1.2355e-01],
         [ 1.0675e-01,  1.1615e-01],
         [ 1.0052e-01,  1.1174e-01],
         [ 9.6374e-02,  1.3320e-01],
         [ 1.2098e-01,  1.5047e-01],
         [ 1.1359e-01,  7.3127e-02],
         [ 1.3350e-01,  8.0978e-02],
         [ 1.4640e-01,  2.0666e-01],
         [ 1.1619e-01,  6.5704e-02],
         [ 9.2573e-02,  6.4320e-02],
         [ 1.1584e-01,  9.9201e-02],
         [ 1.0966e-01,  1.1802e-01],
         [ 8.6072e-02,  6.8494e-02],
         [ 1.0683e-01,  9.9457e-02],
         [ 1.0230e-01,  6.1851e-02],
         [ 8.0722e-02,  1.3665e-01],
         [ 6.0017e-02,  1.2979e-01],
         [ 6.5224e-02,  1.7145e-01],
         [ 1.0459e-01,  1.3897e-01],
         [ 1.3237e-01,  8.8752e-02],
         [ 1.1212e-01,  1.1611e-01],
         [ 1.1680e-01,  1.1592e-01],
         [ 1.5335e-01,  1.1074e-01],
         [ 1.2648e-01,  1.1028e-01],
         [ 5.0138e-02,  1.3994e-01],
         [ 1.0498e-01,  1.1687e-01],
         [ 1.2999e-01,  1.4187e-01],
         [ 1.6023e-01,  1.1625e-01],
         [ 1.7786e-01,  1.2838e-01],
         [ 1.3986e-01,  1.5269e-01],
         [ 1.2664e-01,  1.5076e-01],
         [ 1.2916e-01,  1.5014e-01],
         [ 1.0589e-01,  1.4901e-01],
         [ 1.3291e-01,  1.1274e-01],
         [ 1.4468e-01,  5.0993e-03],
         [ 1.0870e-01,  3.1411e-02],
         [ 1.0849e-01,  4.5714e-02],
         [ 6.7021e-02,  5.2212e-02],
         [ 9.6770e-02,  5.4775e-02],
         [ 6.4718e-02,  5.5544e-02],
         [ 8.3715e-02,  5.5643e-02],
         [ 1.0102e-01,  5.5543e-02],
         [-3.4857e-03,  5.5415e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.7722e-05, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0020, device='cuda:0')
mixer_td_error tensor(0.6677, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4835, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6144, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0581, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1887, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0489, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2649572.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2203, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.0648e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1947, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1090, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1947, device='cuda:0', grad_fn=<MinBackward1>)
t_env 1823
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2714e-01,  1.2420e-01,  ...,  7.0546e-02,
            1.5857e-01, -1.0000e+07],
          [-1.0000e+07, -3.8311e-02,  1.3382e-01,  ...,  4.0568e-02,
            1.4396e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4124e-01,  1.2148e-01,  ...,  5.2743e-02,
            1.5640e-01, -1.0000e+07],
          [-1.0000e+07, -4.4101e-02,  1.1387e-01,  ...,  3.1959e-02,
            1.4699e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9456e-02,  9.6197e-02,  ...,  8.5356e-03,
            1.5201e-01, -1.0000e+07],
          [-1.0000e+07, -6.3036e-02,  1.6373e-01,  ...,  4.7519e-02,
            1.4996e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0500e-01,  1.1218e-01,  ...,  3.6129e-02,
            1.7218e-01, -1.0000e+07],
          [-1.0000e+07, -9.2310e-02,  1.7435e-01,  ...,  6.6672e-02,
            1.5773e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0703e-01,  7.6857e-02,  ...,  7.6963e-02,
            1.9030e-01, -3.2883e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1889e-01, -1.0000e+07,  ..., -1.0000e+07,
            1.8635e-01, -3.2443e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 8.4048e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01, -1.6811e-02],
         [ 1.2420e-01,  1.3382e-01],
         [ 1.2148e-01, -4.4101e-02],
         [ 1.0986e-01,  1.4507e-01],
         [ 1.0952e-01, -6.5580e-02],
         [ 1.2025e-01, -6.5969e-02],
         [ 1.4318e-01, -6.4253e-02],
         [ 1.5263e-01, -7.6448e-02],
         [ 1.0886e-01, -5.6641e-02],
         [ 1.2477e-01, -4.5811e-02],
         [ 9.5833e-02, -5.5508e-02],
         [ 1.3488e-01, -6.6582e-02],
         [ 1.1366e-01,  1.0190e-01],
         [ 1.2369e-01, -6.5384e-02],
         [ 1.1317e-01,  1.0651e-01],
         [ 1.3141e-01,  1.1024e-01],
         [ 1.3784e-01,  1.1873e-01],
         [ 1.3961e-01,  1.1539e-01],
         [ 9.0794e-02,  1.1476e-01],
         [ 1.1373e-01,  7.9695e-02],
         [ 1.1599e-01, -1.4127e-01],
         [ 7.8411e-02,  9.2768e-02],
         [ 3.3602e-03,  1.0712e-01],
         [ 2.9334e-02,  1.1335e-01],
         [ 4.1687e-02,  1.1630e-01],
         [ 4.7262e-02,  8.2573e-02],
         [ 4.9526e-02, -1.5784e-01],
         [ 5.0302e-02,  9.7265e-02],
         [ 5.0450e-02,  8.3062e-02],
         [ 5.0377e-02,  7.4437e-02],
         [ 5.0258e-02, -1.6804e-01],
         [ 5.0170e-02,  7.3025e-02],
         [ 5.0082e-02,  5.5007e-02],
         [ 5.0056e-02,  6.7122e-02],
         [ 5.0041e-02, -1.5856e-01],
         [ 5.0034e-02,  2.2365e-01],
         [ 5.0018e-02,  6.6342e-02],
         [ 5.0013e-02,  9.2782e-02],
         [ 5.0012e-02,  9.0262e-02],
         [ 5.0011e-02,  2.1378e-01],
         [ 5.0013e-02,  7.4254e-02],
         [ 5.0014e-02,  2.0894e-01],
         [ 5.0016e-02,  7.3899e-02],
         [ 5.0008e-02,  8.8205e-02],
         [ 5.0008e-02,  1.0803e-01],
         [ 5.0007e-02,  8.4232e-02],
         [ 5.0007e-02,  9.7753e-02],
         [ 5.0008e-02,  8.5081e-02],
         [ 5.0008e-02,  7.5941e-02],
         [ 5.0008e-02,  2.1989e-01],
         [ 5.0008e-02,  2.1433e-01],
         [ 5.0008e-02,  9.2425e-02],
         [ 5.0008e-02,  1.0459e-01],
         [ 5.0008e-02,  9.5812e-02],
         [ 5.0009e-02,  9.2397e-02],
         [ 5.0009e-02,  8.9915e-02],
         [ 5.0009e-02,  1.0857e-01],
         [ 5.0009e-02,  7.4058e-02],
         [ 5.0009e-02, -1.7166e-01],
         [ 5.0009e-02,  8.1104e-02],
         [ 5.0009e-02, -1.6913e-01],
         [ 5.0009e-02, -7.5836e-04],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.8723e-02,  1.2843e-01],
         [ 9.6197e-02,  1.6373e-01],
         [ 1.1218e-01,  1.7435e-01],
         [ 3.9035e-02,  1.4191e-01],
         [ 1.0091e-01,  1.5448e-01],
         [ 8.6569e-02,  1.7899e-01],
         [ 3.3030e-02,  1.5000e-01],
         [ 3.6796e-02, -1.1411e-01],
         [ 5.0384e-02, -1.1629e-01],
         [-8.9549e-02,  1.4491e-01],
         [-9.3151e-02,  1.4860e-01],
         [ 1.1595e-01, -1.2518e-01],
         [ 1.4084e-01, -1.1886e-01],
         [ 1.7813e-01, -1.1443e-01],
         [ 1.4711e-01,  1.6084e-01],
         [ 1.1646e-01,  1.5636e-01],
         [ 1.1727e-01,  1.5379e-01],
         [-9.2213e-02,  1.2055e-01],
         [-5.9377e-02, -1.5927e-01],
         [ 1.1149e-01, -1.3547e-01],
         [ 9.0459e-02, -1.0536e-01],
         [-8.4686e-02, -8.8737e-02],
         [-5.4416e-02, -4.6168e-03],
         [-4.6254e-02,  2.7519e-02],
         [-4.9675e-02,  4.3186e-02],
         [-1.5247e-02,  5.0276e-02],
         [-1.0008e-02,  5.3264e-02],
         [-1.5284e-02,  5.4445e-02],
         [-1.9647e-02,  5.4922e-02],
         [-2.2002e-02,  5.5045e-02],
         [-2.2926e-02,  5.5093e-02],
         [-5.3363e-02,  5.5147e-02],
         [ 9.8585e-02,  5.5152e-02],
         [-8.1917e-02,  5.5134e-02],
         [-8.2162e-02,  5.5194e-02],
         [-8.2757e-02,  5.5200e-02],
         [-8.6317e-02,  5.5204e-02],
         [ 8.8881e-02,  5.5206e-02],
         [-9.8174e-02,  5.5214e-02],
         [ 9.1618e-02,  5.5214e-02],
         [-1.0584e-01,  5.5206e-02],
         [-7.4892e-02,  5.5218e-02],
         [-5.1354e-02,  5.5221e-02],
         [-6.5574e-02,  5.5232e-02],
         [ 9.9361e-02,  5.5230e-02],
         [-8.2423e-02,  5.5230e-02],
         [-5.7820e-02,  5.5234e-02],
         [-4.0582e-02,  5.5235e-02],
         [-5.1456e-02,  5.5235e-02],
         [-4.7512e-02,  5.5232e-02],
         [-6.2961e-02,  5.5232e-02],
         [-4.6562e-02,  5.5231e-02],
         [-5.8392e-02,  5.5231e-02],
         [ 1.0502e-01,  5.5231e-02],
         [ 1.0784e-01,  5.5231e-02],
         [-7.1607e-02,  5.5231e-02],
         [-5.0683e-02,  5.5231e-02],
         [-4.0951e-02,  5.5231e-02],
         [-2.9707e-02,  5.5231e-02],
         [-5.7637e-02,  5.5231e-02],
         [-6.8162e-02,  5.5231e-02],
         [ 9.4216e-02,  5.5231e-02],
         [ 9.8911e-02,  5.5231e-02],
         [-1.0283e-01,  5.5231e-02],
         [ 8.0014e-02,  5.5231e-02],
         [ 8.3372e-02,  5.5231e-02],
         [-9.9189e-02,  5.5231e-02],
         [ 9.3382e-02,  5.5231e-02],
         [-1.0103e-01,  5.5231e-02],
         [-7.1960e-02,  5.5231e-02],
         [-4.9988e-02,  5.5231e-02],
         [-4.0193e-02,  5.5231e-02],
         [-2.9271e-02,  5.5231e-02],
         [-3.3594e-02,  5.5231e-02],
         [-5.7456e-02,  5.5231e-02],
         [-4.2226e-02,  5.5231e-02],
         [-3.0877e-02,  5.5231e-02],
         [-3.4407e-02,  5.5231e-02],
         [-4.4733e-02,  5.5231e-02],
         [-6.5138e-02,  5.5231e-02],
         [-7.2346e-02,  5.5231e-02],
         [ 9.8401e-02,  5.5231e-02],
         [-8.9840e-02,  5.5231e-02],
         [-7.0629e-02,  5.5231e-02],
         [-6.5846e-02,  5.5231e-02],
         [-6.6572e-02,  5.5231e-02],
         [-8.0950e-02,  5.5231e-02],
         [-8.2309e-02,  5.5231e-02],
         [ 9.6115e-02,  5.5231e-02],
         [-9.2496e-02,  5.5231e-02],
         [-7.2206e-02,  5.5231e-02],
         [-8.4654e-02,  5.5231e-02],
         [-8.0422e-02,  5.5231e-02],
         [ 9.3156e-02,  5.5231e-02],
         [ 1.1400e-01,  5.5231e-02],
         [-1.0633e-01,  5.5231e-02],
         [ 1.1089e-01,  5.5231e-02],
         [ 1.2450e-01,  5.5231e-02],
         [ 1.4518e-01,  5.5231e-02],
         [ 1.3098e-01,  5.5231e-02],
         [ 1.3895e-01,  5.5231e-02],
         [ 1.3622e-01,  5.5231e-02],
         [ 1.4585e-01,  5.5231e-02],
         [ 1.3354e-01,  5.5231e-02],
         [ 1.4076e-01,  5.5231e-02],
         [ 1.0553e-01,  5.5231e-02],
         [ 1.0599e-01,  5.5231e-02],
         [ 1.1960e-01,  5.5231e-02],
         [ 1.2587e-01,  5.5231e-02],
         [ 2.0210e-01,  5.5231e-02],
         [ 9.6539e-02,  5.5231e-02],
         [ 2.2029e-01,  5.5231e-02],
         [ 9.8385e-02,  5.5231e-02],
         [ 8.3864e-02,  5.5231e-02],
         [ 7.6857e-02,  5.5231e-02],
         [ 1.8635e-01,  5.5231e-02],
         [ 8.4048e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(7.9518e-05, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0015, device='cuda:0')
mixer_td_error tensor(0.6126, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4720, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5555, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0620, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1746, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0461, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2350427.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2237, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.8136e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0009, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2078, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2667, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2078, device='cuda:0', grad_fn=<MinBackward1>)
t_env 1871
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2714e-01,  1.2420e-01,  ...,  7.0546e-02,
            1.5857e-01, -1.0000e+07],
          [-1.0000e+07, -3.8311e-02,  1.3382e-01,  ...,  4.0568e-02,
            1.4396e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4124e-01,  1.2148e-01,  ...,  5.2743e-02,
            1.5640e-01, -1.0000e+07],
          [-1.0000e+07, -4.4101e-02,  1.1387e-01,  ...,  3.1959e-02,
            1.4699e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2667e-02,  6.8683e-02,  ..., -1.4773e-02,
            1.4253e-01, -1.0000e+07],
          [-1.0000e+07, -2.4958e-02,  1.1569e-01,  ...,  9.4168e-03,
            1.4551e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.6312e-02,  9.9102e-02,  ..., -2.8211e-02,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -3.4892e-02,  6.9462e-02,  ...,  3.2838e-02,
            1.5555e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6979e-01,  9.5856e-02,  ...,  2.5599e-02,
            1.6520e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.5476e-01,  7.5491e-02,  ...,  1.0346e-02,
            1.5824e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.7330e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01, -1.6811e-02],
         [ 1.2420e-01, -3.8311e-02],
         [-1.4124e-01, -4.4101e-02],
         [-1.4871e-01, -6.2131e-02],
         [-1.7136e-01, -6.5580e-02],
         [ 1.2025e-01, -6.5969e-02],
         [ 1.4318e-01, -6.4253e-02],
         [ 1.5263e-01, -7.6448e-02],
         [ 1.0886e-01, -5.6641e-02],
         [ 1.2477e-01, -4.5811e-02],
         [-1.9475e-01, -5.5508e-02],
         [ 1.3488e-01, -6.6582e-02],
         [ 1.1366e-01, -7.3897e-02],
         [ 1.2369e-01, -6.5384e-02],
         [ 1.1317e-01, -9.2545e-02],
         [ 1.3141e-01, -1.2405e-01],
         [ 1.3784e-01, -1.5354e-01],
         [ 1.3961e-01, -1.6421e-01],
         [-1.8368e-01, -1.7152e-01],
         [ 1.1373e-01, -1.6460e-01],
         [ 1.1599e-01, -1.4127e-01],
         [-1.6329e-01, -1.4983e-01],
         [ 3.3602e-03, -1.5908e-01],
         [ 2.9334e-02, -1.6577e-01],
         [ 4.1687e-02, -1.6987e-01],
         [ 4.7262e-02, -1.6147e-01],
         [ 4.9526e-02, -1.5784e-01],
         [ 5.0302e-02, -1.6736e-01],
         [ 5.0450e-02, -1.5729e-01],
         [ 5.0377e-02, -1.6910e-01],
         [ 5.0258e-02, -1.6804e-01],
         [ 5.0170e-02, -1.8278e-01],
         [ 5.0082e-02, -1.7968e-01],
         [ 5.0056e-02, -1.7803e-01],
         [ 5.0041e-02, -1.5856e-01],
         [ 5.0034e-02, -1.5340e-01],
         [ 5.0018e-02, -1.4143e-01],
         [ 5.0013e-02, -1.7978e-01],
         [ 5.0012e-02, -1.9161e-01],
         [ 5.0011e-02, -1.6047e-01],
         [ 5.0013e-02, -1.5245e-01],
         [ 5.0014e-02, -1.3224e-01],
         [ 5.0016e-02, -1.3536e-01],
         [ 5.0008e-02, -1.4431e-01],
         [ 5.0008e-02,  1.0803e-01],
         [ 5.0007e-02, -1.5655e-01],
         [ 5.0007e-02,  9.7753e-02],
         [ 5.0008e-02, -1.5738e-01],
         [ 5.0008e-02, -1.3075e-01],
         [ 5.0008e-02, -1.3200e-01],
         [ 5.0008e-02, -1.2322e-01],
         [ 5.0008e-02, -1.6578e-01],
         [ 5.0008e-02,  1.0459e-01],
         [ 5.0008e-02,  9.5812e-02],
         [ 5.0009e-02, -1.9335e-01],
         [ 5.0009e-02, -1.9052e-01],
         [ 5.0009e-02,  1.0857e-01],
         [ 5.0009e-02, -1.8720e-01],
         [ 5.0009e-02, -1.7166e-01],
         [ 5.0009e-02, -1.8956e-01],
         [ 5.0009e-02, -1.6913e-01],
         [ 5.0009e-02, -7.5836e-04],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.8723e-02, -2.2603e-02],
         [-7.2667e-02, -2.4958e-02],
         [-4.6312e-02, -3.4892e-02],
         [-4.8901e-02, -1.7211e-02],
         [-1.0635e-02, -4.7126e-02],
         [-1.2266e-02, -3.6487e-02],
         [-4.2670e-02, -3.4362e-02],
         [-2.0817e-02, -3.6218e-02],
         [-5.1670e-02, -1.7604e-02],
         [-1.0594e-02, -8.0928e-03],
         [-3.0510e-02, -1.8584e-02],
         [-4.7370e-02, -3.6150e-02],
         [-6.8687e-02, -6.6748e-02],
         [-8.6102e-02, -5.4387e-02],
         [-8.6140e-02, -5.7347e-02],
         [-1.0438e-01, -4.6140e-02],
         [-9.6649e-02, -4.1568e-02],
         [-1.0959e-01, -3.6987e-02],
         [-9.8761e-02, -6.7402e-02],
         [-1.1087e-01, -5.5455e-02],
         [-7.0388e-02, -5.9717e-02],
         [-5.0910e-02, -8.2232e-02],
         [-1.9454e-02, -7.8604e-02],
         [-2.3823e-02, -8.4362e-02],
         [-5.0746e-03, -8.8680e-02],
         [-1.6921e-02, -7.2498e-02],
         [-1.7174e-03, -7.1065e-02],
         [-5.2368e-02, -8.0032e-02],
         [-8.9912e-02, -9.6417e-02],
         [-1.0915e-01, -1.0261e-01],
         [-1.2998e-01, -1.1529e-01],
         [ 1.2539e-01, -1.1484e-01],
         [-1.5081e-01, -1.2757e-01],
         [-1.2441e-01, -1.1667e-01],
         [-1.0931e-01, -1.6417e-01],
         [-8.3859e-02, -1.9130e-01],
         [-1.1636e-01, -1.5881e-01],
         [-1.3816e-01, -1.4077e-01],
         [ 1.2051e-01, -1.3040e-01],
         [-1.2758e-01, -1.1708e-01],
         [-8.9721e-02, -1.2206e-01],
         [-9.3238e-02, -1.2050e-01],
         [-6.7907e-02, -1.1889e-01],
         [ 1.6354e-01, -1.1263e-01],
         [-4.7384e-02, -1.2697e-01],
         [ 1.7642e-01, -1.1524e-01],
         [ 1.8342e-01, -1.0310e-01],
         [ 1.8108e-01, -9.4633e-02],
         [ 1.8409e-01, -1.0346e-01],
         [-8.3726e-02, -1.0211e-02],
         [-1.1473e-01,  3.0220e-02],
         [-1.3877e-01,  4.7160e-02],
         [-9.2782e-02,  5.3579e-02],
         [-7.5153e-02,  5.5623e-02],
         [-9.9109e-02,  5.6042e-02],
         [-1.4450e-01,  5.5897e-02],
         [-1.5981e-01,  5.5668e-02],
         [-1.5253e-01,  5.5474e-02],
         [-1.5377e-01,  5.5334e-02],
         [-1.2465e-01,  5.5253e-02],
         [-8.9363e-02,  5.5217e-02],
         [-1.3068e-01,  5.5220e-02],
         [-1.2678e-01,  5.5206e-02],
         [-1.1589e-01,  5.5202e-02],
         [-1.0630e-01,  5.5193e-02],
         [-1.3422e-01,  5.5210e-02],
         [ 1.1010e-01,  5.5210e-02],
         [ 1.1495e-01,  5.5212e-02],
         [ 1.3005e-01,  5.5224e-02],
         [ 1.3813e-01,  5.5221e-02],
         [ 1.3502e-01,  5.5231e-02],
         [-1.0927e-01,  5.5230e-02],
         [ 1.7090e-01,  5.5229e-02],
         [ 1.3864e-01,  5.5231e-02],
         [-1.5666e-01,  5.5236e-02],
         [-1.7292e-01,  5.5235e-02],
         [-1.5074e-01,  5.5232e-02],
         [ 1.0483e-01,  5.5232e-02],
         [ 1.0882e-01,  5.5231e-02],
         [-1.8140e-01,  5.5231e-02],
         [-1.6790e-01,  5.5231e-02],
         [-1.6979e-01,  5.5231e-02],
         [-1.5476e-01,  5.5231e-02],
         [ 1.7330e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(0.0002, device='cuda:0') tensor(0.0016, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(0.3764, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4681, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4620, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0552, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1902, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0536, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1309523.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1841, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.5345e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1331, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3107, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1331, device='cuda:0', grad_fn=<MinBackward1>)
t_env 1977
target_mac_out tensor([[[[-1.0000e+07, -5.4255e-02,  8.7945e-02,  ...,  2.1998e-02,
            1.2409e-01, -1.0000e+07],
          [-1.0000e+07, -2.5887e-02,  1.2012e-01,  ...,  1.5133e-02,
            1.3440e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.9304e-02,  9.7787e-02,  ...,  1.0265e-02,
            1.3120e-01, -1.0000e+07],
          [-1.0000e+07, -7.0054e-02,  1.5427e-01,  ...,  5.5969e-02,
            1.5234e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1158e-01,  1.2211e-01,  ...,  4.4942e-02,
            1.4958e-01, -1.0000e+07],
          [-1.0000e+07, -9.6173e-02,  1.5735e-01,  ...,  4.8558e-02,
            1.4866e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0660e-01,  1.0891e-01,  ...,  4.0960e-02,
            1.4451e-01, -1.0000e+07],
          [-1.0000e+07, -1.8482e-02,  1.0351e-01,  ...,  3.3942e-02,
            1.3388e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8928e-02,  7.1365e-02,  ...,  2.7223e-02,
            1.4807e-01, -1.0000e+07],
          [-1.0000e+07, -6.4588e-03,  1.1091e-01,  ...,  1.4417e-02,
            1.1999e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -5.3589e-02,  1.3369e-01,  ...,  4.2509e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -6.3608e-02,  1.4634e-01,  ...,  5.5140e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.7686e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 8.7945e-02,  1.2012e-01],
         [ 9.7787e-02,  1.5427e-01],
         [ 1.2211e-01,  1.5735e-01],
         [ 1.2518e-01,  1.6519e-01],
         [ 1.1544e-01,  1.2899e-01],
         [ 1.2709e-01,  1.2642e-01],
         [ 1.3089e-01,  1.0460e-01],
         [ 1.3118e-01,  1.3207e-01],
         [ 9.3406e-02,  1.2423e-01],
         [ 8.2569e-02,  1.3760e-01],
         [ 9.6692e-02,  1.5289e-01],
         [ 1.1493e-01,  1.2313e-01],
         [ 1.2607e-01,  1.0620e-01],
         [ 1.3131e-01,  8.5856e-02],
         [ 1.0119e-01, -1.2619e-01],
         [ 1.0641e-01,  1.1920e-01],
         [ 8.8374e-02,  1.0527e-01],
         [-8.5907e-02,  9.2380e-02],
         [ 1.1136e-01,  1.1577e-01],
         [ 9.3065e-02,  1.1634e-01],
         [ 1.1734e-01,  9.1265e-02],
         [ 9.4134e-02, -9.6623e-02],
         [-8.3177e-02,  1.6461e-02],
         [-5.6482e-02,  3.8956e-02],
         [-7.3787e-02,  4.9595e-02],
         [-7.7033e-02,  5.3952e-02],
         [ 9.6016e-02,  5.5415e-02],
         [-7.0105e-02,  5.5722e-02],
         [-4.8339e-02,  5.5641e-02],
         [-4.0457e-02,  5.5468e-02],
         [-4.7680e-02,  5.5340e-02],
         [-3.6497e-02,  5.5281e-02],
         [-3.8676e-02,  5.5239e-02],
         [-6.0268e-02,  5.5214e-02],
         [-6.8778e-02,  5.5202e-02],
         [-7.7709e-02,  5.5205e-02],
         [ 9.1158e-02,  5.5225e-02],
         [-9.0919e-02,  5.5202e-02],
         [-8.8111e-02,  5.5220e-02],
         [-8.5651e-02,  5.5208e-02],
         [ 8.5481e-02,  5.5211e-02],
         [ 9.6539e-02,  5.5221e-02],
         [ 1.0138e-01,  5.5228e-02],
         [ 1.1896e-01,  5.5232e-02],
         [ 1.2677e-01,  5.5230e-02],
         [ 1.1347e-01,  5.5230e-02],
         [ 1.0402e-01,  5.5231e-02],
         [ 6.9609e-02,  5.5236e-02],
         [ 7.7319e-02,  5.5235e-02],
         [ 7.8823e-02,  5.5232e-02],
         [ 5.9259e-02,  5.5232e-02],
         [ 8.5788e-02,  5.5231e-02],
         [ 6.0981e-02,  5.5231e-02],
         [ 8.6399e-02,  5.5231e-02],
         [ 1.0162e-01,  5.5231e-02],
         [ 1.0932e-01,  5.5231e-02],
         [ 1.0604e-01,  5.5231e-02],
         [ 1.0974e-01,  5.5231e-02],
         [ 9.1073e-02,  5.5231e-02],
         [ 2.2123e-01,  5.5231e-02],
         [ 8.8037e-02,  5.5231e-02],
         [ 1.0904e-01,  5.5231e-02],
         [ 1.2270e-01,  5.5231e-02],
         [ 1.2823e-01,  5.5231e-02],
         [ 1.4643e-01,  5.5231e-02],
         [ 1.0938e-01,  5.5231e-02],
         [ 1.0689e-01,  5.5231e-02],
         [ 1.1591e-01,  5.5231e-02],
         [ 8.9214e-02,  5.5231e-02],
         [ 5.9109e-02,  5.5231e-02],
         [ 4.7769e-02,  5.5231e-02],
         [ 8.5118e-02,  5.5231e-02],
         [ 7.5511e-02,  5.5231e-02],
         [ 8.2102e-02,  5.5231e-02],
         [-2.7532e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0780e-01, -1.6811e-02],
         [ 1.0891e-01, -1.8482e-02],
         [-8.8928e-02, -6.4588e-03],
         [ 1.0232e-01,  1.3664e-01],
         [ 7.2960e-02,  1.4697e-01],
         [ 1.0329e-01,  1.3410e-01],
         [ 1.0722e-01,  1.1105e-01],
         [-8.2020e-02,  1.0349e-01],
         [ 7.3321e-02, -3.4182e-02],
         [ 9.5557e-02, -3.2360e-02],
         [ 1.0693e-01,  1.2286e-01],
         [ 9.5909e-02,  1.0741e-01],
         [ 7.2147e-02,  1.3140e-01],
         [ 8.3277e-02,  1.4134e-01],
         [ 1.0789e-01,  1.6046e-01],
         [ 1.2220e-01,  1.3346e-01],
         [ 1.2203e-01, -6.1864e-02],
         [ 1.0645e-01,  1.2609e-01],
         [ 1.3163e-01, -4.5172e-02],
         [ 1.3612e-01, -5.2699e-02],
         [ 1.0972e-01, -4.5721e-02],
         [ 1.0088e-01, -4.7102e-02],
         [ 1.1610e-01,  1.3562e-01],
         [ 1.3325e-01,  1.5198e-01],
         [ 1.4066e-01,  1.4183e-01],
         [ 1.2262e-01,  9.1951e-02],
         [ 1.0962e-01,  9.7596e-02],
         [ 8.1806e-02,  6.2137e-02],
         [ 9.6653e-02,  7.2180e-02],
         [ 1.2296e-01,  8.2419e-02],
         [ 9.2967e-02,  2.2251e-01],
         [ 9.7192e-02,  2.1180e-01],
         [ 1.0872e-01,  9.1904e-02],
         [ 1.1913e-01,  9.4866e-02],
         [ 1.0491e-01,  9.7274e-02],
         [ 1.1757e-01,  1.0496e-01],
         [ 1.2348e-01,  1.2557e-01],
         [ 7.9301e-02,  1.2184e-01],
         [ 7.2027e-02,  2.1482e-01],
         [ 6.7933e-02,  2.2812e-01],
         [ 9.1154e-02,  2.3559e-01],
         [ 7.6238e-02,  2.1584e-01],
         [ 9.4505e-02,  2.2200e-01],
         [ 9.4086e-02,  2.1668e-01],
         [ 6.1796e-02,  9.9076e-02],
         [-1.0549e-01,  2.1480e-01],
         [ 8.6235e-02,  8.5389e-02],
         [ 7.5013e-02,  9.1901e-02],
         [ 9.4536e-02,  1.0512e-01],
         [ 7.6552e-02,  9.8362e-02],
         [ 9.8397e-02,  9.4596e-02],
         [ 1.0604e-01,  6.4166e-02],
         [ 1.0807e-01,  9.8112e-02],
         [ 1.1879e-01,  1.0005e-01],
         [ 1.1360e-01,  8.3395e-02],
         [ 1.1549e-01,  1.0946e-01],
         [ 1.0928e-01,  1.2266e-01],
         [ 1.3305e-01,  1.0439e-01],
         [ 1.0559e-01,  8.5825e-02],
         [ 1.3164e-01,  1.1369e-01],
         [ 1.3856e-01,  9.5307e-02],
         [ 1.4407e-01,  1.1329e-01],
         [ 1.7035e-01,  1.2186e-01],
         [ 1.3371e-01,  8.8530e-02],
         [ 1.4009e-01,  1.6490e-01],
         [ 1.0089e-01,  1.6378e-01],
         [ 1.2762e-01,  8.9119e-02],
         [ 1.4125e-01,  9.5281e-02],
         [ 1.4634e-01,  1.0041e-01],
         [ 1.4501e-01,  9.6483e-02],
         [ 1.0114e-01,  7.5197e-02],
         [ 4.5363e-02, -8.8102e-02],
         [ 4.5874e-02, -8.5134e-02],
         [ 4.8161e-02,  2.0051e-01],
         [ 4.9559e-02,  1.9592e-01],
         [ 5.0116e-02,  2.0700e-01],
         [ 5.0224e-02,  2.1476e-01],
         [ 5.0164e-02,  2.0359e-01],
         [ 5.0077e-02,  1.8849e-01],
         [ 5.0000e-02,  2.0283e-01],
         [ 4.9980e-02,  1.8461e-01],
         [ 4.9969e-02, -9.0482e-02],
         [ 4.9963e-02, -8.6838e-02],
         [ 4.9972e-02, -8.4312e-02],
         [ 4.9979e-02, -8.3054e-02],
         [ 4.9996e-02, -4.2544e-02],
         [ 5.0000e-02, -4.2143e-02],
         [ 5.0017e-02,  1.9139e-01],
         [ 5.0009e-02, -8.0027e-02],
         [ 5.0016e-02, -8.0504e-02],
         [ 5.0019e-02, -8.6661e-02],
         [ 5.0012e-02,  2.0272e-01],
         [ 5.0012e-02, -9.0781e-02],
         [ 5.0006e-02, -4.6383e-02],
         [ 5.0008e-02, -3.0346e-02],
         [ 5.0008e-02, -3.4917e-02],
         [ 5.0008e-02, -1.3267e-02],
         [ 5.0008e-02, -1.1271e-02],
         [ 5.0008e-02, -5.6890e-02],
         [ 5.0008e-02,  7.1514e-02],
         [ 5.0008e-02,  7.2525e-02],
         [ 5.0008e-02,  7.3659e-02],
         [ 5.0008e-02, -8.8620e-02],
         [ 5.0008e-02, -9.2357e-02],
         [ 5.0009e-02,  6.7826e-02],
         [ 5.0009e-02,  7.0866e-02],
         [ 5.0009e-02,  7.2535e-02],
         [ 5.0009e-02, -8.9379e-02],
         [ 5.0009e-02,  2.0345e-01],
         [ 5.0009e-02, -5.6585e-02],
         [ 5.0009e-02, -6.3228e-02],
         [ 5.0009e-02, -3.8461e-02],
         [ 5.0009e-02, -3.2991e-02],
         [ 5.0009e-02,  1.2118e-01],
         [ 5.0009e-02, -1.8347e-02],
         [ 5.0009e-02, -1.7149e-03],
         [ 5.0009e-02, -4.2233e-03],
         [ 5.0009e-02,  1.2383e-01],
         [ 5.0009e-02,  1.2864e-01],
         [ 5.0009e-02,  1.3082e-01],
         [ 5.0009e-02, -1.6182e-02],
         [ 5.0009e-02,  2.7622e-03],
         [ 5.0009e-02,  2.2674e-03],
         [ 5.0009e-02, -3.7655e-03],
         [ 5.0009e-02,  1.3272e-01],
         [ 5.0009e-02,  1.3925e-01],
         [ 5.0009e-02, -3.7249e-02],
         [ 5.0009e-02, -5.9561e-02],
         [ 5.0009e-02,  8.2112e-02],
         [ 5.0009e-02, -7.5416e-02],
         [ 5.0009e-02, -8.9079e-02],
         [ 5.0009e-02, -8.4093e-02],
         [ 5.0009e-02, -1.0652e-01],
         [ 5.0009e-02, -1.0365e-01],
         [ 5.0009e-02, -9.6471e-02],
         [ 5.0009e-02, -5.8838e-02],
         [ 5.0009e-02,  1.0175e-01],
         [ 5.0009e-02,  1.2143e-01],
         [ 5.0009e-02,  1.3214e-01],
         [ 5.0009e-02,  1.4587e-01],
         [ 5.0009e-02, -3.2194e-02],
         [ 5.0009e-02,  1.2682e-01],
         [ 5.0009e-02,  1.3574e-01],
         [ 5.0009e-02,  1.4887e-01],
         [ 5.0009e-02,  1.4346e-01],
         [ 5.0009e-02,  1.5426e-01],
         [ 5.0009e-02, -3.8568e-02],
         [ 5.0009e-02,  1.3369e-01],
         [ 5.0009e-02,  1.4634e-01],
         [ 5.0009e-02,  2.7686e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0001, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(0.5541, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4638, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6019, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0370, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1181, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0733, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2499999.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2356, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.0360e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0009, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2587, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1473, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2587, device='cuda:0', grad_fn=<MinBackward1>)
t_env 2055
target_mac_out tensor([[[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4689e-02,  1.0709e-01,  ...,  1.4450e-02,
            1.5237e-01, -1.0000e+07],
          [-1.0000e+07, -2.1835e-02,  9.9402e-02,  ..., -1.5839e-02,
            1.3204e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0286e-02,  1.0929e-01,  ...,  4.9539e-03,
            1.4714e-01, -1.0000e+07],
          [-1.0000e+07, -4.0755e-02,  1.1664e-01,  ..., -1.3107e-02,
            1.4728e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5109e-01,  4.3734e-02,  ...,  2.5633e-02,
            1.9335e-01, -3.0600e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4069e-01,  2.7674e-02,  ...,  3.4865e-02,
            1.7954e-01, -3.0370e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.5720e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3070e-01,  1.2391e-01,  ...,  7.1034e-02,
            1.5852e-01, -1.0000e+07],
          [-1.0000e+07, -3.6329e-02,  1.0540e-01,  ..., -2.3505e-02,
            1.3276e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4548e-01,  1.2388e-01,  ...,  5.2184e-02,
            1.5225e-01, -1.0000e+07],
          [-1.0000e+07, -7.9506e-02,  1.4849e-01,  ...,  2.9133e-02,
            1.4592e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.2300e-02,  8.8635e-02],
         [ 1.0709e-01,  9.9402e-02],
         [ 1.0929e-01,  1.1664e-01],
         [ 1.1707e-01,  1.4906e-01],
         [ 1.2279e-01,  1.5190e-01],
         [ 9.8224e-02,  1.1788e-01],
         [ 9.0415e-02,  1.1747e-01],
         [ 1.1010e-01,  7.5451e-02],
         [ 1.0275e-01,  6.6050e-02],
         [ 1.1137e-01,  9.3524e-02],
         [ 1.1450e-01,  8.5916e-02],
         [ 1.1551e-01,  8.5467e-02],
         [ 1.0226e-01,  1.1707e-01],
         [ 1.2004e-01,  1.3088e-01],
         [ 1.1997e-01,  8.9258e-02],
         [ 1.2702e-01,  1.0430e-01],
         [ 1.0899e-01,  8.6519e-02],
         [ 1.0240e-01,  1.2646e-01],
         [ 1.0996e-01,  1.3615e-01],
         [ 1.1185e-01,  1.4356e-01],
         [ 1.2247e-01,  1.2033e-01],
         [ 1.2840e-01,  9.6356e-02],
         [ 1.2090e-01,  1.0689e-01],
         [ 9.7435e-02,  1.1374e-01],
         [ 1.2041e-01,  1.1817e-01],
         [ 1.1333e-01,  1.0346e-01],
         [ 1.1270e-01,  9.2009e-02],
         [ 1.3086e-01,  1.1294e-01],
         [ 1.3902e-01,  1.1477e-01],
         [ 1.2469e-01,  8.2680e-02],
         [ 1.1915e-01,  5.7627e-02],
         [ 1.1927e-01,  7.5070e-02],
         [ 1.1176e-01,  8.6550e-02],
         [ 1.2861e-01,  8.1180e-02],
         [ 1.3395e-01,  1.1226e-01],
         [ 1.4656e-01,  1.0098e-01],
         [ 1.4738e-01,  1.2232e-01],
         [ 1.3493e-01,  1.3158e-01],
         [ 9.9820e-02,  1.1388e-01],
         [ 9.7208e-02,  1.2943e-01],
         [ 8.8163e-02,  1.4022e-01],
         [ 1.0250e-01,  1.4787e-01],
         [ 7.1497e-02,  1.2195e-01],
         [ 9.1572e-02,  1.4120e-01],
         [ 1.0760e-01,  1.0981e-01],
         [ 9.7120e-02,  1.2752e-01],
         [ 1.1733e-01,  9.8038e-02],
         [ 1.1415e-01,  1.2168e-01],
         [ 1.1194e-01,  1.3593e-01],
         [ 1.2551e-01,  1.2816e-01],
         [ 1.3092e-01,  1.0309e-01],
         [ 1.3263e-01,  1.2196e-01],
         [ 1.3071e-01,  1.1071e-01],
         [ 1.1640e-01,  9.5609e-02],
         [ 1.1093e-01,  8.8856e-02],
         [ 1.2401e-01,  1.2196e-01],
         [ 1.0169e-01,  1.3879e-01],
         [ 1.1193e-01,  1.5026e-01],
         [ 1.1108e-01,  1.4903e-01],
         [ 1.1977e-01,  1.1366e-01],
         [ 1.3219e-01,  1.3963e-01],
         [ 1.1138e-01,  1.1566e-01],
         [ 1.2885e-01,  1.4543e-01],
         [ 1.2644e-01,  1.1881e-01],
         [ 1.3949e-01,  1.4211e-01],
         [ 1.4276e-01,  1.4916e-01],
         [ 1.4168e-01,  1.4817e-01],
         [ 1.1640e-01,  1.0859e-01],
         [ 1.4400e-01,  1.2352e-01],
         [ 1.2612e-01,  1.3480e-01],
         [ 1.2655e-01,  1.1539e-01],
         [ 1.4689e-01,  8.5303e-02],
         [ 1.4433e-01,  1.1715e-01],
         [ 1.5643e-01,  1.3132e-01],
         [ 1.3460e-01,  8.9971e-02],
         [ 1.5093e-01,  8.7945e-02],
         [ 1.6464e-01,  1.1095e-01],
         [ 1.6342e-01,  7.6047e-02],
         [ 2.4488e-03, -6.0971e-02],
         [ 2.3410e-02, -3.7074e-02],
         [ 3.6787e-02, -3.5789e-02],
         [ 4.3993e-02, -1.5429e-02],
         [ 4.7565e-02, -2.6782e-02],
         [ 4.9168e-02, -2.0664e-02],
         [ 4.9817e-02, -2.7034e-02],
         [ 5.0045e-02, -1.9710e-02],
         [ 5.0112e-02, -2.6331e-02],
         [ 5.0088e-02,  8.5826e-02],
         [ 5.0075e-02, -5.1540e-02],
         [ 5.0057e-02, -4.7392e-02],
         [ 5.0027e-02,  7.8125e-02],
         [ 5.0040e-02, -5.2743e-02],
         [ 5.0031e-02, -2.2996e-02],
         [ 5.0025e-02, -1.7798e-02],
         [ 5.0022e-02, -4.2187e-02],
         [ 5.0021e-02,  8.8702e-02],
         [ 5.0015e-02,  9.7786e-02],
         [ 5.0012e-02,  6.0236e-02],
         [ 5.0019e-02, -6.1691e-02],
         [ 5.0005e-02, -4.8752e-02],
         [ 5.0006e-02, -2.0558e-02],
         [ 5.0008e-02, -4.5918e-02],
         [ 5.0008e-02, -3.3800e-02],
         [ 5.0008e-02, -3.2012e-02],
         [ 5.0009e-02,  9.4228e-02],
         [ 5.0008e-02,  9.8239e-02],
         [ 5.0008e-02, -1.6848e-02],
         [ 5.0008e-02, -4.4272e-02],
         [ 5.0008e-02, -3.2779e-02],
         [ 5.0008e-02, -3.1126e-02],
         [ 5.0009e-02,  9.3723e-02],
         [ 5.0009e-02,  1.0113e-01],
         [ 5.0009e-02,  6.2513e-02],
         [ 5.0009e-02, -4.6148e-02],
         [ 5.0009e-02, -2.7205e-02],
         [ 5.0009e-02, -4.6880e-02],
         [ 5.0009e-02, -4.9745e-02],
         [ 5.0009e-02, -3.5934e-02],
         [ 5.0009e-02, -1.1604e-02],
         [ 5.0009e-02, -1.5037e-03],
         [ 5.0009e-02, -3.5710e-02],
         [ 5.0009e-02, -3.8721e-02],
         [ 5.0009e-02,  7.7418e-02],
         [ 5.0009e-02, -5.3529e-02],
         [ 5.0009e-02, -5.1740e-02],
         [ 5.0009e-02, -3.6481e-02],
         [ 5.0009e-02, -3.4334e-02],
         [ 5.0009e-02, -1.4424e-02],
         [ 5.0009e-02, -2.6294e-02],
         [ 5.0009e-02, -1.0880e-02],
         [ 5.0009e-02, -2.1796e-03],
         [ 5.0009e-02, -3.5703e-02],
         [ 5.0009e-02,  8.5182e-02],
         [ 5.0009e-02, -5.4805e-02],
         [ 5.0009e-02,  8.2107e-02],
         [ 5.0009e-02,  9.4690e-02],
         [ 5.0009e-02,  5.8548e-02],
         [ 5.0009e-02, -6.1959e-02],
         [ 5.0009e-02,  7.8351e-02],
         [ 5.0009e-02,  9.2915e-02],
         [ 5.0009e-02, -6.6492e-02],
         [ 5.0009e-02,  8.4851e-02],
         [ 5.0009e-02, -5.8931e-02],
         [ 5.0009e-02, -5.5145e-02],
         [ 5.0009e-02, -4.9577e-02],
         [ 5.0009e-02, -5.1569e-02],
         [ 5.0009e-02, -5.9566e-02],
         [ 5.0009e-02, -5.4384e-02],
         [ 5.0009e-02, -4.4343e-02],
         [ 5.0009e-02,  7.0204e-02],
         [ 5.0009e-02,  8.9803e-02],
         [ 5.0009e-02, -5.1495e-02],
         [ 5.0009e-02, -3.1097e-02],
         [ 5.0009e-02, -1.0031e-02],
         [ 5.0009e-02, -1.0247e-02],
         [ 5.0009e-02, -7.9768e-03],
         [ 5.0009e-02, -5.9288e-03],
         [ 5.0009e-02, -3.4743e-02],
         [ 5.0009e-02, -2.7162e-02],
         [ 5.0009e-02, -6.2309e-03],
         [ 5.0009e-02, -3.7196e-02],
         [ 5.0009e-02,  8.8279e-02],
         [ 5.0009e-02, -4.9438e-02],
         [ 5.0009e-02, -4.3943e-02],
         [ 5.0009e-02, -4.7101e-02],
         [ 5.0009e-02, -4.0317e-02],
         [ 5.0009e-02, -2.4805e-02],
         [ 5.0009e-02, -6.2786e-03],
         [ 5.0009e-02, -2.0382e-02],
         [ 5.0009e-02, -2.9215e-02],
         [ 5.0009e-02, -1.2467e-02],
         [ 5.0009e-02, -4.1956e-02],
         [ 5.0009e-02,  8.8902e-02],
         [ 5.0009e-02, -5.0565e-02],
         [ 5.0009e-02,  8.5305e-02],
         [ 5.0009e-02,  9.6662e-02],
         [ 5.0009e-02,  1.0111e-01],
         [ 5.0009e-02,  1.0525e-01],
         [ 5.0009e-02,  1.2110e-01],
         [ 5.0009e-02,  1.1905e-01],
         [ 5.0009e-02,  8.1493e-02],
         [ 5.0009e-02,  5.4724e-02],
         [ 5.0009e-02,  8.5680e-02],
         [ 5.0009e-02,  9.8182e-02],
         [ 5.0009e-02,  7.0510e-02],
         [ 5.0009e-02,  9.8478e-02],
         [ 5.0009e-02,  6.5444e-02],
         [ 5.0009e-02,  7.1292e-02],
         [ 5.0009e-02,  8.0597e-02],
         [ 5.0009e-02,  7.6084e-02],
         [ 5.0009e-02,  7.0666e-02],
         [ 5.0009e-02,  8.5560e-02],
         [ 5.0009e-02,  8.5482e-02],
         [ 5.0009e-02,  8.8488e-02],
         [ 5.0009e-02,  5.7154e-02],
         [ 5.0009e-02,  4.6379e-02],
         [ 5.0009e-02,  6.8469e-02],
         [ 5.0009e-02,  5.4959e-02],
         [ 5.0009e-02,  4.3734e-02],
         [ 5.0009e-02,  2.7674e-02],
         [ 5.0009e-02,  8.5720e-03]],

        [[ 1.0827e-01,  1.0736e-01],
         [ 1.2391e-01,  1.0540e-01],
         [ 1.2388e-01,  1.4849e-01],
         [ 1.1120e-01,  1.1545e-01],
         [ 8.1763e-02,  1.0360e-01],
         [ 1.0384e-01,  1.6212e-01],
         [ 1.0730e-01,  1.3985e-01],
         [ 1.2105e-01,  1.2283e-01],
         [ 1.3210e-01,  1.4214e-01],
         [ 1.5162e-01,  1.6795e-01],
         [ 1.6399e-01,  1.8431e-01],
         [ 1.3424e-01,  1.5073e-01],
         [ 1.3556e-01,  1.3457e-01],
         [ 1.2130e-01,  1.1134e-01],
         [ 1.4275e-01,  1.3791e-01],
         [ 1.2264e-01,  1.6636e-01],
         [ 1.4533e-01,  1.3594e-01],
         [ 1.5384e-01,  1.1079e-01],
         [ 1.4967e-01,  1.2379e-01],
         [ 1.3395e-01,  8.9738e-02],
         [ 9.3326e-02,  4.7128e-02],
         [ 1.5065e-02, -8.0648e-02],
         [ 3.1087e-02, -7.0815e-02],
         [ 4.1229e-02, -5.9451e-02],
         [ 4.6494e-02, -5.6659e-02],
         [ 4.8929e-02, -3.9966e-02],
         [ 4.9845e-02,  7.2299e-02],
         [ 5.0161e-02, -5.3675e-02],
         [ 5.0198e-02,  7.7594e-02],
         [ 5.0164e-02, -5.6926e-02],
         [ 5.0127e-02,  8.3781e-02],
         [ 5.0076e-02,  1.1153e-01],
         [ 5.0043e-02,  7.9167e-02],
         [ 5.0052e-02,  7.6035e-02],
         [ 5.0029e-02,  8.8515e-02],
         [ 5.0036e-02,  6.7258e-02],
         [ 5.0027e-02,  8.0908e-02],
         [ 5.0019e-02,  4.5657e-02],
         [ 5.0025e-02,  7.9332e-02],
         [ 5.0026e-02,  9.3016e-02],
         [ 5.0010e-02,  9.7706e-02],
         [ 5.0020e-02,  5.7490e-02],
         [ 5.0005e-02,  8.6472e-02],
         [ 5.0007e-02,  9.7147e-02],
         [ 5.0008e-02,  6.3430e-02],
         [ 5.0008e-02,  8.5475e-02],
         [ 5.0008e-02,  5.6860e-02],
         [ 5.0009e-02,  4.3634e-02],
         [ 5.0008e-02, -8.3420e-02],
         [ 5.0008e-02, -6.6560e-02],
         [ 5.0008e-02,  7.4572e-02],
         [ 5.0008e-02,  6.8489e-02],
         [ 5.0008e-02,  6.1119e-02],
         [ 5.0009e-02, -8.3672e-02],
         [ 5.0009e-02, -8.7099e-02],
         [ 5.0009e-02, -8.3128e-02],
         [ 5.0009e-02,  6.9029e-02],
         [ 5.0009e-02,  8.4975e-02],
         [ 5.0009e-02,  9.1598e-02],
         [ 5.0009e-02,  7.4213e-02],
         [ 5.0009e-02, -8.3758e-02],
         [ 5.0009e-02, -7.7796e-02],
         [ 5.0009e-02,  7.1914e-02],
         [ 5.0009e-02,  1.0388e-01],
         [ 5.0009e-02,  8.5299e-02],
         [ 5.0009e-02,  9.0344e-02],
         [ 5.0009e-02,  4.6900e-02],
         [ 5.0009e-02,  4.2289e-02],
         [ 5.0009e-02,  6.6682e-02],
         [ 5.0009e-02,  7.9862e-02],
         [ 5.0009e-02,  2.0500e-01],
         [ 5.0009e-02,  1.9406e-01],
         [ 5.0009e-02,  4.5653e-02],
         [ 5.0009e-02,  8.0870e-02],
         [ 5.0009e-02,  6.0900e-02],
         [ 5.0009e-02,  7.1534e-02],
         [ 5.0009e-02,  7.7649e-02],
         [ 5.0009e-02,  8.1230e-02],
         [ 5.0009e-02,  6.0169e-02],
         [ 5.0009e-02, -6.3569e-02],
         [ 5.0009e-02,  5.6693e-02],
         [ 5.0009e-02,  7.6477e-02],
         [ 5.0009e-02,  6.0402e-02],
         [ 5.0009e-02,  5.0377e-02],
         [ 5.0009e-02,  4.3616e-02],
         [ 5.0009e-02,  3.8999e-02],
         [ 5.0009e-02, -9.0095e-02],
         [ 5.0009e-02,  6.9579e-02],
         [ 5.0009e-02,  8.6352e-02],
         [ 5.0009e-02,  5.8278e-02],
         [ 5.0009e-02,  4.5538e-02],
         [ 5.0009e-02,  7.5007e-02],
         [ 5.0009e-02,  8.7675e-02],
         [ 5.0009e-02,  9.3339e-02],
         [ 5.0009e-02,  1.1464e-01],
         [ 5.0009e-02,  6.3624e-02],
         [ 5.0009e-02,  6.6775e-02],
         [ 5.0009e-02,  4.7620e-02],
         [ 5.0009e-02,  3.9063e-02],
         [ 5.0009e-02,  7.1689e-02],
         [ 5.0009e-02,  1.0404e-01],
         [ 5.0009e-02,  1.0427e-01],
         [ 5.0009e-02,  5.8940e-02],
         [ 5.0009e-02,  4.2998e-02],
         [ 5.0009e-02,  4.3363e-02],
         [ 5.0009e-02,  7.5933e-02],
         [ 5.0009e-02,  8.5900e-02],
         [ 5.0009e-02,  1.3334e-01],
         [ 5.0009e-02,  8.9865e-02],
         [ 5.0009e-02,  7.3448e-02],
         [ 5.0009e-02,  9.6982e-02],
         [ 5.0009e-02,  5.9533e-02],
         [ 5.0009e-02,  8.2586e-02],
         [ 5.0009e-02,  7.9531e-02],
         [ 5.0009e-02,  8.8877e-02],
         [ 5.0009e-02,  6.3198e-02],
         [ 5.0009e-02,  5.1944e-02],
         [ 5.0009e-02,  6.4473e-02],
         [ 5.0009e-02,  9.1396e-02],
         [ 5.0009e-02,  8.8900e-02],
         [ 5.0009e-02,  8.9520e-02],
         [ 5.0009e-02,  8.9573e-02],
         [ 5.0009e-02,  5.0133e-02],
         [ 5.0009e-02,  7.2536e-02],
         [ 5.0009e-02,  8.1444e-02],
         [ 5.0009e-02,  7.2294e-02],
         [ 5.0009e-02,  9.0362e-02],
         [ 5.0009e-02,  6.5614e-02],
         [ 5.0009e-02,  5.1068e-02],
         [ 5.0009e-02,  4.2900e-02],
         [ 5.0009e-02,  1.9150e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.7944e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0017, device='cuda:0')
mixer_td_error tensor(0.4058, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4730, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9845, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0448, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1737, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0570, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1741293.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2050, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.3258e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0016, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2402, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1089, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2402, device='cuda:0', grad_fn=<MinBackward1>)
t_env 2165
target_mac_out tensor([[[[-1.0000e+07, -5.4255e-02,  8.7945e-02,  ...,  2.1998e-02,
            1.2409e-01, -1.0000e+07],
          [-1.0000e+07, -2.5887e-02,  1.2012e-01,  ...,  1.5133e-02,
            1.3440e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.9304e-02,  9.7787e-02,  ...,  1.0265e-02,
            1.3120e-01, -1.0000e+07],
          [-1.0000e+07, -7.0054e-02,  1.5427e-01,  ...,  5.5969e-02,
            1.5234e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1158e-01,  1.2211e-01,  ...,  4.4942e-02,
            1.4958e-01, -1.0000e+07],
          [-1.0000e+07, -9.6173e-02,  1.5735e-01,  ...,  4.8558e-02,
            1.4866e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.7344e-02,  8.2773e-02,  ...,  5.5160e-04,
            1.4831e-01, -1.0000e+07],
          [-1.0000e+07, -2.7700e-02,  1.3816e-01,  ..., -4.3951e-03,
            1.4720e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6811e-02,  8.2313e-02,  ...,  4.0371e-03,
            1.5378e-01, -1.0000e+07],
          [-1.0000e+07, -2.8490e-02,  1.3545e-01,  ..., -1.7911e-02,
            1.4236e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7243e-01,  1.1992e-01,  ...,  5.7868e-02,
            1.6752e-01, -3.1066e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7064e-01,  1.1772e-01,  ...,  5.0580e-02,
            1.6038e-01, -3.0600e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-6.6528e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 8.7945e-02,  1.2012e-01],
         [ 9.7787e-02,  1.5427e-01],
         [ 1.2211e-01,  1.5735e-01],
         [ 1.2518e-01,  1.6519e-01],
         [ 1.1544e-01,  1.2899e-01],
         [ 1.2709e-01,  1.2642e-01],
         [ 1.3089e-01,  1.0460e-01],
         [ 1.3118e-01,  1.3207e-01],
         [ 5.3708e-02,  1.2423e-01],
         [ 8.2569e-02,  1.3760e-01],
         [ 9.6692e-02,  1.5289e-01],
         [ 1.1493e-01,  1.2313e-01],
         [ 1.2607e-01,  1.0620e-01],
         [ 1.3131e-01,  4.4091e-02],
         [ 1.0119e-01,  5.3948e-02],
         [ 1.0641e-01,  1.1920e-01],
         [ 8.8374e-02,  1.0527e-01],
         [ 7.4347e-02,  9.2380e-02],
         [ 1.1136e-01,  1.1577e-01],
         [ 9.3065e-02,  1.1634e-01],
         [ 1.1734e-01,  9.1265e-02],
         [ 9.4134e-02, -9.6623e-02],
         [-8.3177e-02,  1.6461e-02],
         [-5.6482e-02,  3.8956e-02],
         [-7.3787e-02,  4.9595e-02],
         [-7.7033e-02,  5.3952e-02],
         [ 9.6016e-02,  5.5415e-02],
         [-7.0105e-02,  5.5722e-02],
         [-4.8339e-02,  5.5641e-02],
         [-4.0457e-02,  5.5468e-02],
         [-4.7680e-02,  5.5340e-02],
         [-3.6497e-02,  5.5281e-02],
         [-3.8676e-02,  5.5239e-02],
         [-6.0268e-02,  5.5214e-02],
         [-6.8778e-02,  5.5202e-02],
         [-7.7709e-02,  5.5205e-02],
         [ 9.1158e-02,  5.5225e-02],
         [ 7.1131e-02,  5.5202e-02],
         [-8.8111e-02,  5.5220e-02],
         [-8.5651e-02,  5.5208e-02],
         [ 8.5481e-02,  5.5211e-02],
         [ 9.6539e-02,  5.5221e-02],
         [ 1.0138e-01,  5.5228e-02],
         [ 1.1896e-01,  5.5232e-02],
         [ 1.2677e-01,  5.5230e-02],
         [ 1.1347e-01,  5.5230e-02],
         [ 1.0402e-01,  5.5231e-02],
         [ 6.9609e-02,  5.5236e-02],
         [ 7.7319e-02,  5.5235e-02],
         [ 7.8823e-02,  5.5232e-02],
         [ 5.9259e-02,  5.5232e-02],
         [ 8.5788e-02,  5.5231e-02],
         [ 6.0981e-02,  5.5231e-02],
         [ 8.6399e-02,  5.5231e-02],
         [ 1.0162e-01,  5.5231e-02],
         [ 1.0932e-01,  5.5231e-02],
         [ 1.0604e-01,  5.5231e-02],
         [ 1.0974e-01,  5.5231e-02],
         [ 9.1073e-02,  5.5231e-02],
         [ 9.2107e-02,  5.5231e-02],
         [ 8.8037e-02,  5.5231e-02],
         [ 1.0904e-01,  5.5231e-02],
         [ 1.2270e-01,  5.5231e-02],
         [ 1.2823e-01,  5.5231e-02],
         [ 1.4643e-01,  5.5231e-02],
         [ 1.0938e-01,  5.5231e-02],
         [ 1.0689e-01,  5.5231e-02],
         [ 1.1591e-01,  5.5231e-02],
         [ 8.9214e-02,  5.5231e-02],
         [ 5.9109e-02,  5.5231e-02],
         [ 7.6630e-02,  5.5231e-02],
         [ 8.5118e-02,  5.5231e-02],
         [ 7.5511e-02,  5.5231e-02],
         [ 8.2102e-02,  5.5231e-02],
         [-2.7532e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.4778e-02,  1.0692e-01],
         [ 8.2773e-02,  1.3816e-01],
         [ 8.2313e-02,  1.3545e-01],
         [ 5.8406e-02, -5.4247e-02],
         [ 7.9970e-02, -6.1587e-02],
         [ 9.0135e-02, -3.6431e-02],
         [ 1.0323e-01,  1.0573e-01],
         [ 1.2070e-01,  1.4209e-01],
         [ 1.0444e-01,  1.5146e-01],
         [ 7.7148e-02,  9.1419e-02],
         [ 1.0729e-01, -7.0068e-02],
         [ 7.6982e-02, -7.3530e-02],
         [ 9.7464e-02, -5.3220e-02],
         [ 1.2373e-01, -4.5584e-02],
         [ 1.3208e-01, -4.7344e-02],
         [ 1.2597e-01,  1.2312e-01],
         [ 9.2272e-02,  1.1978e-01],
         [ 8.1605e-02,  1.0404e-01],
         [ 1.0212e-01,  1.3702e-01],
         [ 9.5581e-02,  1.7912e-01],
         [ 4.3846e-02,  1.3102e-01],
         [ 5.1933e-02,  1.5057e-01],
         [ 1.1190e-01,  1.2319e-01],
         [ 1.1653e-01,  1.6811e-01],
         [ 1.1994e-01,  1.7998e-01],
         [ 1.0599e-01,  1.7758e-01],
         [ 1.1322e-01,  1.7083e-01],
         [ 1.0194e-01,  1.3341e-01],
         [ 4.3788e-02,  1.4961e-01],
         [ 6.0473e-02,  1.7268e-01],
         [ 1.0597e-01,  1.3058e-01],
         [ 1.0530e-01,  1.1327e-01],
         [ 1.0820e-01,  1.1978e-01],
         [ 1.3150e-01,  1.0578e-01],
         [ 6.6480e-02,  1.0927e-01],
         [ 1.0287e-01,  1.0990e-01],
         [ 1.1638e-01,  1.0007e-01],
         [ 1.2880e-01,  7.6230e-02],
         [ 1.4306e-01,  9.3023e-02],
         [ 1.3756e-01, -9.8418e-02],
         [ 1.8152e-01,  7.8493e-02],
         [ 1.5473e-01,  1.0344e-01],
         [ 1.3434e-01,  1.3417e-01],
         [ 1.3343e-01,  1.4378e-01],
         [ 6.2578e-02,  6.8764e-02],
         [ 1.0807e-01,  1.8744e-02],
         [ 1.3452e-01,  3.9393e-02],
         [ 1.0242e-01,  4.9066e-02],
         [ 8.8065e-02,  5.3184e-02],
         [ 1.0025e-01,  5.4741e-02],
         [ 8.8946e-02,  5.5223e-02],
         [ 6.9570e-02,  5.5269e-02],
         [ 6.2459e-02,  5.5275e-02],
         [ 8.6610e-02,  5.5215e-02],
         [ 9.8692e-02,  5.5200e-02],
         [ 6.5635e-02,  5.5184e-02],
         [ 9.4745e-02,  5.5173e-02],
         [ 7.9883e-02,  5.5206e-02],
         [ 1.0011e-01,  5.5178e-02],
         [ 9.2781e-02,  5.5220e-02],
         [ 8.5619e-02,  5.5202e-02],
         [ 8.0763e-02,  5.5203e-02],
         [ 9.7074e-02,  5.5206e-02],
         [ 9.9522e-02,  5.5206e-02],
         [ 6.7511e-02,  5.5223e-02],
         [ 9.8353e-02,  5.5225e-02],
         [ 7.5682e-02,  5.5232e-02],
         [ 7.9511e-02,  5.5230e-02],
         [-7.4048e-02,  5.5230e-02],
         [-7.3776e-02,  5.5231e-02],
         [-6.9527e-02,  5.5236e-02],
         [ 8.6735e-02,  5.5235e-02],
         [-7.6159e-02,  5.5232e-02],
         [-6.8195e-02,  5.5232e-02],
         [ 9.1954e-02,  5.5231e-02],
         [ 1.0179e-01,  5.5231e-02],
         [ 1.0681e-01,  5.5231e-02],
         [ 1.0311e-01,  5.5231e-02],
         [ 1.0475e-01,  5.5231e-02],
         [ 1.2444e-01,  5.5231e-02],
         [ 8.0956e-02,  5.5231e-02],
         [ 1.0082e-01,  5.5231e-02],
         [ 8.1777e-02,  5.5231e-02],
         [ 7.2491e-02,  5.5231e-02],
         [ 1.0837e-01,  5.5231e-02],
         [ 9.2110e-02,  5.5231e-02],
         [ 9.3768e-02,  5.5231e-02],
         [ 9.5879e-02,  5.5231e-02],
         [ 9.2502e-02,  5.5231e-02],
         [ 7.4417e-02,  5.5231e-02],
         [ 9.1003e-02,  5.5231e-02],
         [ 1.1414e-01,  5.5231e-02],
         [ 1.5770e-01,  5.5231e-02],
         [ 1.1647e-01,  5.5231e-02],
         [ 1.2041e-01,  5.5231e-02],
         [ 1.1548e-01,  5.5231e-02],
         [ 1.1403e-01,  5.5231e-02],
         [ 7.6203e-02,  5.5231e-02],
         [ 9.9821e-02,  5.5231e-02],
         [ 7.0610e-02,  5.5231e-02],
         [ 1.1334e-01,  5.5231e-02],
         [ 1.3043e-01,  5.5231e-02],
         [ 1.2248e-01,  5.5231e-02],
         [ 1.2545e-01,  5.5231e-02],
         [ 1.2746e-01,  5.5231e-02],
         [ 1.1248e-01,  5.5231e-02],
         [ 1.2352e-01,  5.5231e-02],
         [ 1.1992e-01,  5.5231e-02],
         [ 1.1772e-01,  5.5231e-02],
         [-6.6528e-04,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.8763e-06, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(0.3947, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4777, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4900, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0591, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1661, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0335, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1590908.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1815, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.4129e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1606, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1528, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1606, device='cuda:0', grad_fn=<MinBackward1>)
t_env 2231
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0948e-02,  7.3316e-02,  ...,  4.2360e-02,
            1.4141e-01, -1.0000e+07],
          [-1.0000e+07, -1.8789e-02,  1.1070e-01,  ...,  4.1064e-03,
            1.2950e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0493e-01,  9.5342e-02,  ...,  2.8501e-02,
            1.6248e-01, -1.0000e+07],
          [-1.0000e+07, -2.5057e-02,  1.2023e-01,  ..., -1.0731e-02,
            1.3315e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.5027e-02,  7.1936e-02,  ..., -3.0500e-03,
            1.2911e-01, -1.0000e+07],
          [-1.0000e+07, -2.2961e-02,  9.6708e-02,  ..., -2.0494e-02,
            1.3243e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.1139e-02,  8.5369e-02,  ...,  1.4716e-02,
            1.3164e-01, -1.0000e+07],
          [-1.0000e+07, -3.0575e-02,  9.4245e-02,  ..., -4.3856e-02,
            1.3745e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.9938e-01,  1.0586e-01,  ...,  4.4793e-02,
            1.6853e-01, -3.1699e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.8366e-01,  7.2695e-02,  ...,  4.2428e-02,
            1.5227e-01, -3.1359e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.6262e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 4.2360e-02, -1.8789e-02],
         [ 9.5342e-02, -2.5057e-02],
         [ 2.9640e-02,  1.4156e-01],
         [ 8.1485e-02, -4.0353e-02],
         [-7.6575e-02, -4.8187e-02],
         [ 6.0988e-02, -3.1261e-02],
         [-8.4542e-02,  9.9181e-02],
         [ 9.0928e-02, -4.0001e-02],
         [ 9.8131e-02, -4.6573e-02],
         [-9.2479e-02, -6.3116e-02],
         [-8.8738e-02, -7.2894e-02],
         [-7.3215e-02,  1.1220e-01],
         [-5.2229e-02, -9.1545e-02],
         [-6.8613e-02,  1.0364e-01],
         [-7.4374e-02,  1.1695e-01],
         [-5.6511e-02,  7.7338e-02],
         [-4.0418e-02,  1.1185e-01],
         [-5.1149e-02,  1.2157e-01],
         [-5.6808e-02,  7.8122e-02],
         [-4.2105e-02,  9.8220e-02],
         [-5.2184e-02,  1.1613e-01],
         [-6.9471e-02,  8.1639e-02],
         [-4.9075e-02,  9.6023e-02],
         [-5.2413e-02,  1.0995e-01],
         [-6.8974e-02,  9.8083e-02],
         [ 1.3189e-01,  9.2941e-02],
         [ 1.5355e-01,  9.8135e-02],
         [ 1.3319e-01,  1.2472e-01],
         [ 1.4755e-01,  1.3836e-01],
         [ 1.4394e-01,  1.0724e-01],
         [ 1.1068e-01,  1.3147e-01],
         [ 1.3933e-01,  1.3981e-01],
         [ 1.0936e-01,  1.2722e-01],
         [ 1.4213e-01,  1.3700e-01],
         [ 1.1816e-01, -6.4278e-03],
         [ 1.0565e-01,  2.5142e-02],
         [ 8.6109e-02,  4.2084e-02],
         [ 5.9356e-02,  5.0180e-02],
         [ 8.0208e-02,  5.3727e-02],
         [ 1.0120e-01,  5.5128e-02],
         [ 8.3156e-02,  5.5544e-02],
         [ 1.2780e-01,  5.5612e-02],
         [ 9.8728e-02,  5.5523e-02],
         [ 1.1408e-01,  5.5444e-02],
         [ 8.9938e-02,  5.5359e-02],
         [ 9.4646e-02,  5.5309e-02],
         [ 9.5243e-02,  5.5259e-02],
         [ 9.3598e-02,  5.5215e-02],
         [ 8.0578e-02,  5.5232e-02],
         [ 7.5030e-02,  5.5209e-02],
         [ 1.0299e-01,  5.5215e-02],
         [ 8.2706e-02,  5.5215e-02],
         [ 1.1988e-01,  5.5220e-02],
         [ 8.9034e-02,  5.5223e-02],
         [ 7.0128e-02,  5.5231e-02],
         [-1.4641e-01,  5.5232e-02],
         [ 1.5547e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 3.1469e-02, -1.1096e-02],
         [-5.5027e-02, -2.2961e-02],
         [-4.1139e-02, -3.0575e-02],
         [-3.2662e-02,  1.1600e-01],
         [-4.2330e-02, -3.3436e-02],
         [ 1.4632e-01,  1.3353e-01],
         [ 1.2837e-01, -4.0934e-02],
         [ 1.1660e-01, -2.9617e-02],
         [ 1.3067e-01,  1.3858e-01],
         [ 1.5041e-01, -2.3082e-02],
         [ 1.6852e-01, -1.5386e-02],
         [-2.0264e-02, -8.4988e-03],
         [ 1.6914e-01, -3.7857e-02],
         [-6.2545e-03, -4.0398e-02],
         [ 1.5086e-02, -4.7884e-02],
         [-1.8821e-02, -3.0138e-02],
         [ 1.2065e-01, -1.4213e-02],
         [-4.9873e-02, -1.2104e-02],
         [ 1.4248e-01,  1.3861e-01],
         [-3.3560e-02, -1.8829e-02],
         [-3.7333e-02, -3.2817e-03],
         [ 1.0830e-01, -6.3185e-03],
         [-7.3922e-02, -3.1255e-02],
         [ 9.3324e-02, -1.8565e-02],
         [-5.4217e-02, -1.1027e-02],
         [-1.9287e-02, -1.1783e-02],
         [ 1.5426e-01, -3.9562e-02],
         [ 1.7741e-01, -3.0440e-02],
         [ 1.7950e-01, -4.7343e-02],
         [ 1.7848e-01,  9.5407e-02],
         [-2.2659e-02, -5.7749e-02],
         [ 1.6343e-01, -4.7370e-02],
         [ 1.8144e-01, -2.5316e-02],
         [ 1.3893e-01, -1.4975e-02],
         [-7.1515e-02,  1.3353e-01],
         [ 1.0307e-01,  1.4873e-01],
         [-8.2046e-02,  1.1367e-01],
         [ 9.7996e-02,  1.3962e-01],
         [ 2.9591e-02,  1.5129e-01],
         [ 1.2020e-01,  1.1250e-01],
         [ 1.3091e-01, -3.3770e-02],
         [ 1.2777e-01,  1.0402e-01],
         [ 1.5403e-01,  9.7388e-02],
         [ 1.6515e-01,  9.9281e-02],
         [ 1.7729e-01,  1.1371e-01],
         [ 1.7978e-01, -4.4041e-02],
         [ 1.2463e-01, -3.3466e-02],
         [ 1.1360e-01, -4.6174e-02],
         [ 1.2853e-01,  1.3620e-01],
         [ 1.4989e-01, -6.0776e-02],
         [ 1.6592e-01, -5.4466e-02],
         [ 1.2034e-01,  1.4419e-01],
         [ 1.2796e-01,  1.6298e-01],
         [ 1.5526e-01,  1.6761e-01],
         [ 1.6354e-01,  1.3651e-01],
         [ 1.2214e-01,  1.6277e-01],
         [ 1.3145e-01,  1.8230e-01],
         [ 1.2651e-01,  1.8624e-01],
         [ 1.4976e-01,  1.8383e-01],
         [ 1.3096e-01,  1.5660e-01],
         [ 1.5719e-01,  1.1360e-01],
         [-4.3478e-02,  9.2760e-02],
         [-6.5489e-02,  7.1618e-02],
         [ 1.2064e-01,  4.6336e-02],
         [ 1.0465e-01,  5.9508e-02],
         [ 1.3051e-01,  1.1030e-01],
         [ 1.0501e-01,  1.3248e-01],
         [ 1.1574e-01,  1.0984e-01],
         [ 1.2416e-01,  1.3082e-01],
         [ 1.4123e-01,  1.3335e-01],
         [ 1.0080e-01,  1.5099e-01],
         [ 1.2277e-01,  1.1573e-01],
         [ 1.3046e-01,  4.7317e-03],
         [ 1.2593e-01,  3.5153e-02],
         [ 1.3922e-01,  4.7874e-02],
         [ 1.8498e-01,  5.2807e-02],
         [ 1.5769e-01,  5.4573e-02],
         [ 1.3009e-01,  5.5107e-02],
         [ 1.2383e-01,  5.5214e-02],
         [ 1.3862e-01,  5.5201e-02],
         [ 1.3305e-01,  5.5187e-02],
         [ 1.4448e-01,  5.5161e-02],
         [ 1.0565e-01,  5.5155e-02],
         [ 1.2594e-01,  5.5158e-02],
         [ 1.3153e-01,  5.5200e-02],
         [ 1.4550e-01,  5.5186e-02],
         [ 1.2056e-01,  5.5187e-02],
         [ 1.2911e-01,  5.5204e-02],
         [ 1.3020e-01,  5.5219e-02],
         [ 1.0828e-01,  5.5208e-02],
         [ 1.1543e-01,  5.5215e-02],
         [ 8.3100e-02,  5.5218e-02],
         [ 1.0123e-01,  5.5227e-02],
         [ 1.0586e-01,  5.5231e-02],
         [ 7.2695e-02,  5.5230e-02],
         [ 2.6262e-03,  5.5230e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.5376e-05, device='cuda:0') tensor(0.0017, device='cuda:0') tensor(-0.0025, device='cuda:0')
mixer_td_error tensor(0.5080, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5093, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6866, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0584, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1824, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0407, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1979166.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1862, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(9.5850e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0017, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1612, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1614, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1612, device='cuda:0', grad_fn=<MinBackward1>)
t_env 2332
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2714e-01,  1.2420e-01,  ...,  7.0546e-02,
            1.5857e-01, -1.0000e+07],
          [-1.0000e+07, -3.8311e-02,  1.3382e-01,  ...,  4.0568e-02,
            1.4396e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4124e-01,  1.2148e-01,  ...,  5.2743e-02,
            1.5640e-01, -1.0000e+07],
          [-1.0000e+07, -4.4101e-02,  1.1387e-01,  ...,  3.1959e-02,
            1.4699e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6085e-02,  1.0713e-01,  ...,  2.0049e-02,
            1.6247e-01, -1.0000e+07],
          [-1.0000e+07, -1.6729e-02,  1.0948e-01,  ...,  2.6640e-03,
            1.2965e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3875e-02,  8.8061e-02,  ..., -8.4055e-03,
            1.5805e-01, -1.0000e+07],
          [-1.0000e+07, -3.6246e-02,  1.0894e-01,  ..., -3.0980e-02,
            1.3536e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7180e-01,  1.0048e-01,  ...,  4.6637e-02,
            1.5591e-01, -1.0000e+07],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7826e-01,  1.0546e-01,  ...,  4.1326e-02,
            1.6501e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-5.4609e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01, -1.6811e-02],
         [ 1.2420e-01,  1.3382e-01],
         [ 1.2148e-01,  1.1387e-01],
         [ 1.0986e-01,  1.4507e-01],
         [ 1.0952e-01, -6.5580e-02],
         [ 1.2025e-01, -6.5969e-02],
         [ 1.4318e-01, -6.4253e-02],
         [ 1.5263e-01, -7.6448e-02],
         [ 1.0886e-01, -5.6641e-02],
         [ 1.2477e-01, -4.5811e-02],
         [ 9.5833e-02, -5.5508e-02],
         [ 1.3488e-01, -6.6582e-02],
         [ 1.1366e-01, -7.3897e-02],
         [ 1.2369e-01, -6.5384e-02],
         [ 1.1317e-01,  1.0651e-01],
         [ 1.3141e-01,  1.1024e-01],
         [ 1.3784e-01,  1.1873e-01],
         [ 1.3961e-01,  1.1539e-01],
         [ 9.0794e-02,  1.1476e-01],
         [ 1.1373e-01,  7.9695e-02],
         [ 1.1599e-01, -1.4127e-01],
         [ 7.8411e-02,  9.2768e-02],
         [ 3.3602e-03,  1.0712e-01],
         [ 2.9334e-02,  1.1335e-01],
         [ 4.1687e-02,  1.1630e-01],
         [ 4.7262e-02,  8.2573e-02],
         [ 4.9526e-02,  6.1770e-02],
         [ 5.0302e-02,  9.7265e-02],
         [ 5.0450e-02,  8.3062e-02],
         [ 5.0377e-02,  7.4437e-02],
         [ 5.0258e-02,  4.3653e-02],
         [ 5.0170e-02,  7.3025e-02],
         [ 5.0082e-02,  5.5007e-02],
         [ 5.0056e-02,  6.7122e-02],
         [ 5.0041e-02, -1.5856e-01],
         [ 5.0034e-02,  6.6691e-02],
         [ 5.0018e-02,  6.6342e-02],
         [ 5.0013e-02,  9.2782e-02],
         [ 5.0012e-02,  9.0262e-02],
         [ 5.0011e-02,  4.7279e-02],
         [ 5.0013e-02,  7.4254e-02],
         [ 5.0014e-02, -1.3224e-01],
         [ 5.0016e-02,  7.3899e-02],
         [ 5.0008e-02,  8.8205e-02],
         [ 5.0008e-02,  1.0803e-01],
         [ 5.0007e-02,  8.4232e-02],
         [ 5.0007e-02,  9.7753e-02],
         [ 5.0008e-02,  4.9929e-02],
         [ 5.0008e-02, -1.3075e-01],
         [ 5.0008e-02,  6.9812e-02],
         [ 5.0008e-02,  5.4742e-02],
         [ 5.0008e-02,  9.2425e-02],
         [ 5.0008e-02,  1.0459e-01],
         [ 5.0008e-02,  9.5812e-02],
         [ 5.0009e-02,  9.2397e-02],
         [ 5.0009e-02,  8.9915e-02],
         [ 5.0009e-02,  1.0857e-01],
         [ 5.0009e-02,  7.4058e-02],
         [ 5.0009e-02,  6.0570e-02],
         [ 5.0009e-02,  8.1104e-02],
         [ 5.0009e-02, -1.6913e-01],
         [ 5.0009e-02, -7.5836e-04],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.6186e-02, -1.3772e-02],
         [ 1.0713e-01, -1.6729e-02],
         [ 8.8061e-02, -3.6246e-02],
         [-8.3684e-02, -3.0700e-02],
         [-8.3479e-02, -5.2606e-02],
         [-9.8128e-02, -4.0782e-02],
         [-5.0888e-02, -5.7989e-02],
         [ 1.5289e-01, -6.3909e-02],
         [-5.9501e-02, -7.1258e-02],
         [-7.4686e-02, -5.4691e-02],
         [-9.2496e-02, -4.4071e-02],
         [ 1.1051e-01,  1.5141e-01],
         [ 1.1411e-01,  1.6509e-01],
         [ 1.2271e-01,  1.6682e-01],
         [ 1.2024e-01,  1.6277e-01],
         [ 1.1130e-01,  1.6612e-01],
         [ 6.5607e-02,  1.2394e-01],
         [ 1.1444e-01,  1.0649e-01],
         [ 6.4487e-02,  1.4207e-01],
         [ 1.1971e-01,  1.5596e-01],
         [ 1.1534e-01,  1.2716e-01],
         [ 8.6700e-02,  1.1264e-01],
         [ 1.1286e-01,  1.2427e-01],
         [ 1.2074e-01,  1.1945e-01],
         [ 1.2001e-01,  1.6221e-01],
         [ 1.4057e-01,  1.8054e-01],
         [ 1.3404e-01,  1.7876e-01],
         [ 9.7488e-02,  1.4613e-01],
         [ 8.3591e-02,  1.0518e-01],
         [ 8.9463e-02,  1.3002e-01],
         [ 1.0854e-01,  1.2694e-01],
         [ 1.3098e-01,  1.0314e-01],
         [ 1.3012e-01,  1.2926e-01],
         [ 9.5732e-02,  1.3888e-01],
         [ 1.3104e-01,  1.4288e-01],
         [ 1.1995e-01,  1.3116e-01],
         [ 1.0989e-01,  1.0507e-01],
         [ 7.8628e-02,  1.5734e-01],
         [ 7.5788e-02,  1.3776e-01],
         [ 9.2760e-02,  1.1786e-01],
         [ 1.1007e-01,  9.1714e-02],
         [ 1.3964e-01,  6.0981e-02],
         [ 1.0639e-01,  9.0206e-02],
         [ 1.3396e-01,  7.1427e-02],
         [ 1.0815e-01,  7.0678e-02],
         [ 9.8372e-02,  9.8736e-02],
         [ 1.2186e-01,  9.0344e-02],
         [ 7.0507e-02,  8.9243e-02],
         [ 4.7146e-02, -1.3366e-01],
         [ 9.1739e-02, -1.1579e-01],
         [ 1.0728e-01,  1.1503e-01],
         [ 6.0738e-02,  9.1512e-02],
         [ 9.6498e-02,  1.2369e-01],
         [ 5.7662e-02,  1.0658e-01],
         [ 8.8447e-02,  5.8208e-02],
         [ 9.2699e-02,  6.6659e-02],
         [ 9.6148e-02,  7.1523e-02],
         [ 8.2403e-02,  2.1170e-01],
         [ 7.6061e-02,  6.0023e-02],
         [ 8.6408e-02,  7.3924e-02],
         [ 9.5735e-02,  7.8877e-02],
         [ 7.8302e-02,  7.3714e-02],
         [-1.1818e-01,  2.5994e-01],
         [ 8.2177e-02,  5.8956e-02],
         [ 8.7683e-02, -1.6130e-02],
         [ 9.2751e-02,  2.2383e-02],
         [ 9.2730e-02,  4.1224e-02],
         [ 1.0865e-01,  4.9815e-02],
         [ 1.0521e-01,  5.3394e-02],
         [ 6.1773e-02,  5.4752e-02],
         [ 8.2728e-02,  5.5197e-02],
         [ 7.5271e-02,  5.5260e-02],
         [ 7.1240e-02,  5.5271e-02],
         [ 8.9970e-02,  5.5242e-02],
         [ 9.5932e-02,  5.5212e-02],
         [ 9.8053e-02,  5.5195e-02],
         [ 7.7203e-02,  5.5188e-02],
         [ 6.9477e-02,  5.5194e-02],
         [-1.0620e-01,  5.5217e-02],
         [-6.5778e-02,  5.5199e-02],
         [ 1.3347e-01,  5.5205e-02],
         [ 1.4507e-01,  5.5211e-02],
         [ 1.5629e-01,  5.5207e-02],
         [ 1.6322e-01,  5.5212e-02],
         [ 1.5895e-01,  5.5229e-02],
         [ 1.1127e-01,  5.5230e-02],
         [ 9.5475e-02,  5.5230e-02],
         [ 1.0614e-01,  5.5230e-02],
         [ 6.9667e-02,  5.5234e-02],
         [ 1.0300e-01,  5.5235e-02],
         [ 7.2349e-02,  5.5235e-02],
         [ 9.7220e-02,  5.5232e-02],
         [ 1.0048e-01,  5.5232e-02],
         [ 1.0546e-01,  5.5231e-02],
         [-5.4609e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.2251e-05, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0018, device='cuda:0')
mixer_td_error tensor(0.4492, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4702, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5269, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0628, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1753, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0398, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1736842., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2599, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.3286e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1785, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1962, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1785, device='cuda:0', grad_fn=<MinBackward1>)
t_env 2391
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6085e-02,  1.0713e-01,  ...,  2.0049e-02,
            1.6247e-01, -1.0000e+07],
          [-1.0000e+07, -1.6729e-02,  1.0948e-01,  ...,  2.6640e-03,
            1.2965e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2949e-01,  1.2515e-01,  ...,  4.9588e-02,
            1.6998e-01, -1.0000e+07],
          [-1.0000e+07, -4.1626e-02,  1.0611e-01,  ..., -2.7111e-02,
            1.3520e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6136e-01,  7.7979e-02,  ...,  6.1733e-02,
            2.1013e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5838e-01,  5.7839e-02,  ...,  4.5371e-02,
            2.0169e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.9531e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.9665e-02,  5.9675e-02,  ...,  1.7156e-02,
            1.3094e-01, -1.0000e+07],
          [-1.0000e+07, -6.0440e-02,  1.6172e-01,  ...,  4.7207e-02,
            1.5243e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3029e-02,  9.6897e-02,  ...,  4.0310e-02,
            1.5748e-01, -1.0000e+07],
          [-1.0000e+07, -8.1469e-02,  1.3480e-01,  ...,  1.5844e-02,
            1.5054e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02, -1.3772e-02],
         [ 1.0713e-01, -1.6729e-02],
         [ 1.2515e-01, -4.1626e-02],
         [-1.0252e-01, -3.7657e-02],
         [-8.0354e-02, -4.9456e-02],
         [-6.3036e-02, -5.4987e-02],
         [-4.6483e-02, -5.3368e-02],
         [-6.7079e-02, -5.2890e-02],
         [-4.8811e-02, -5.2904e-02],
         [-4.3636e-02, -4.4127e-02],
         [-4.1952e-02, -2.7085e-02],
         [-3.4142e-02, -3.8476e-02],
         [-2.5507e-02, -2.8875e-02],
         [-2.1500e-02, -7.2733e-03],
         [-2.7168e-02, -1.4600e-02],
         [-3.6652e-02,  2.4736e-03],
         [-2.2949e-02, -6.9129e-03],
         [-5.1280e-02,  1.6453e-03],
         [-4.0591e-02, -9.1634e-04],
         [-3.1119e-02, -2.0804e-02],
         [-3.8970e-02, -2.3457e-02],
         [-2.6104e-02, -3.0448e-02],
         [-3.0599e-02, -2.8530e-02],
         [-2.1814e-02, -1.4568e-02],
         [-4.7511e-02, -7.1965e-03],
         [-2.8822e-02, -7.4266e-03],
         [-3.6651e-02, -1.0687e-03],
         [-4.2357e-02, -1.0687e-02],
         [-4.0939e-02, -2.2420e-02],
         [-4.4610e-02, -3.0281e-02],
         [-5.3826e-02, -2.6051e-02],
         [-3.9009e-02, -4.0858e-02],
         [-4.1153e-02, -5.0267e-02],
         [-3.1650e-02, -5.2364e-02],
         [-3.8872e-02, -4.6252e-02],
         [-5.6620e-02, -5.7755e-02],
         [ 1.3197e-01, -4.7816e-02],
         [ 1.2690e-01, -5.0201e-02],
         [-8.7842e-02, -5.8074e-02],
         [ 1.2883e-01, -6.2304e-02],
         [-7.5967e-02, -7.7167e-02],
         [-6.2831e-02, -5.7370e-02],
         [-7.0556e-02, -4.8169e-02],
         [-6.5283e-02, -4.6007e-02],
         [ 1.3095e-01, -5.0104e-02],
         [-6.8032e-02, -5.4037e-02],
         [ 1.3060e-01, -5.3575e-02],
         [-6.9699e-02, -4.0849e-02],
         [ 1.2675e-01, -3.3967e-02],
         [ 1.3037e-01, -4.5983e-02],
         [ 1.3527e-01, -4.8566e-02],
         [ 1.3276e-01, -5.6098e-02],
         [-1.1787e-01,  1.4162e-01],
         [ 1.3241e-01,  1.6224e-01],
         [ 1.0126e-01, -8.6716e-02],
         [-1.1993e-01, -6.5382e-02],
         [ 1.1396e-01, -6.9933e-02],
         [ 1.3390e-01, -9.0975e-02],
         [ 1.3639e-01, -7.4307e-02],
         [ 1.3709e-01, -8.6749e-02],
         [ 8.6326e-02,  1.4208e-01],
         [ 1.2675e-01,  1.5251e-01],
         [ 1.3079e-01,  1.5448e-01],
         [ 1.4527e-01,  9.9324e-02],
         [ 1.5234e-01,  8.1534e-02],
         [ 1.0871e-01,  1.1337e-01],
         [ 1.4666e-01, -1.0793e-01],
         [ 1.5202e-01, -9.5392e-02],
         [ 1.5750e-01, -9.3381e-02],
         [ 1.5763e-01, -9.5751e-02],
         [ 1.5727e-01,  1.0330e-01],
         [ 1.3804e-01, -1.0207e-01],
         [ 1.0447e-01, -9.3919e-02],
         [-1.3200e-01, -9.5942e-02],
         [ 1.4442e-01, -9.8815e-02],
         [ 1.3595e-01,  9.9758e-02],
         [ 1.3881e-01,  7.8513e-02],
         [ 1.4518e-01,  1.0798e-01],
         [ 1.0868e-01,  8.5542e-02],
         [ 9.5629e-02, -1.0557e-01],
         [ 1.2690e-01, -9.6534e-02],
         [ 1.3988e-01,  1.0154e-01],
         [ 1.3920e-01, -1.0385e-01],
         [ 1.5214e-01,  1.1349e-01],
         [ 1.3801e-01,  1.2262e-01],
         [ 1.5075e-01,  1.0082e-01],
         [ 1.5866e-01,  1.2287e-01],
         [ 1.3687e-01, -1.0782e-01],
         [ 1.3561e-01,  1.0362e-01],
         [ 1.3528e-01,  1.0941e-01],
         [ 2.1589e-01,  1.1764e-01],
         [-7.1922e-03, -1.0780e-01],
         [ 1.6213e-02, -8.0468e-02],
         [ 3.2136e-02, -8.5812e-02],
         [ 4.1262e-02, -9.3667e-02],
         [ 4.6006e-02, -1.0017e-01],
         [ 4.8333e-02, -8.6880e-02],
         [ 4.9397e-02, -9.5072e-02],
         [ 4.9831e-02, -8.1566e-02],
         [ 5.0029e-02, -5.0763e-02],
         [ 5.0049e-02, -5.4832e-02],
         [ 5.0070e-02, -7.2186e-02],
         [ 5.0045e-02, -6.9299e-02],
         [ 5.0052e-02, -6.6710e-02],
         [ 5.0030e-02, -5.8681e-02],
         [ 5.0026e-02, -5.8359e-02],
         [ 5.0025e-02, -5.5200e-02],
         [ 5.0024e-02, -6.2861e-02],
         [ 5.0047e-02, -7.8290e-02],
         [ 5.0026e-02, -7.4350e-02],
         [ 5.0007e-02, -5.4113e-02],
         [ 5.0016e-02, -4.6430e-02],
         [ 5.0015e-02, -4.4303e-02],
         [ 5.0008e-02, -3.0966e-02],
         [ 5.0008e-02, -3.3476e-02],
         [ 5.0009e-02, -5.2869e-02],
         [ 5.0009e-02, -3.8207e-02],
         [ 5.0008e-02, -2.1701e-02],
         [ 5.0008e-02,  8.7932e-03],
         [ 5.0008e-02,  1.4378e-02],
         [ 5.0008e-02,  1.3518e-02],
         [ 5.0008e-02, -2.9440e-02],
         [ 5.0008e-02, -3.8029e-02],
         [ 5.0008e-02, -3.5575e-02],
         [ 5.0009e-02, -7.4685e-04],
         [ 5.0009e-02,  8.2314e-03],
         [ 5.0009e-02,  9.8570e-03],
         [ 5.0009e-02,  9.0992e-03],
         [ 5.0009e-02,  5.8487e-03],
         [ 5.0009e-02, -1.7561e-02],
         [ 5.0009e-02, -2.9399e-02],
         [ 5.0009e-02, -1.3329e-02],
         [ 5.0009e-02, -2.5841e-02],
         [ 5.0009e-02, -1.9824e-02],
         [ 5.0009e-02, -2.6416e-02],
         [ 5.0009e-02, -3.1827e-02],
         [ 5.0009e-02, -3.5729e-02],
         [ 5.0009e-02, -1.5903e-02],
         [ 5.0009e-02, -1.4392e-02],
         [ 5.0009e-02, -2.2945e-02],
         [ 5.0009e-02,  4.8837e-03],
         [ 5.0009e-02, -2.9409e-02],
         [ 5.0009e-02, -3.5167e-02],
         [ 5.0009e-02, -4.8477e-02],
         [ 5.0009e-02, -4.7522e-02],
         [ 5.0009e-02, -6.8352e-02],
         [ 5.0009e-02, -5.9285e-02],
         [ 5.0009e-02, -5.5571e-02],
         [ 5.0009e-02, -6.9711e-02],
         [ 5.0009e-02, -8.1793e-02],
         [ 5.0009e-02, -6.0093e-02],
         [ 5.0009e-02, -6.7036e-02],
         [ 5.0009e-02, -7.6879e-02],
         [ 5.0009e-02, -8.2984e-02],
         [ 5.0009e-02, -6.7342e-02],
         [ 5.0009e-02, -6.6704e-02],
         [ 5.0009e-02, -5.6138e-02],
         [ 5.0009e-02, -6.6396e-02],
         [ 5.0009e-02, -5.6237e-02],
         [ 5.0009e-02, -5.4717e-02],
         [ 5.0009e-02, -1.0257e-01],
         [ 5.0009e-02, -1.1212e-01],
         [ 5.0009e-02, -1.4935e-01],
         [ 5.0009e-02, -1.5906e-01],
         [ 5.0009e-02,  9.7395e-02],
         [ 5.0009e-02, -1.5431e-01],
         [ 5.0009e-02, -1.3479e-01],
         [ 5.0009e-02, -1.2201e-01],
         [ 5.0009e-02, -1.3246e-01],
         [ 5.0009e-02, -1.1928e-01],
         [ 5.0009e-02, -1.2668e-01],
         [ 5.0009e-02, -1.1916e-01],
         [ 5.0009e-02,  8.0579e-02],
         [ 5.0009e-02, -1.2125e-01],
         [ 5.0009e-02, -1.0279e-01],
         [ 5.0009e-02, -1.1288e-01],
         [ 5.0009e-02,  9.1922e-02],
         [ 5.0009e-02,  1.1326e-01],
         [ 5.0009e-02,  1.1961e-01],
         [ 5.0009e-02,  1.2729e-01],
         [ 5.0009e-02,  1.0692e-01],
         [ 5.0009e-02, -1.7356e-01],
         [ 5.0009e-02, -1.7129e-01],
         [ 5.0009e-02,  9.3280e-02],
         [ 5.0009e-02, -1.6783e-01],
         [ 5.0009e-02, -1.5394e-01],
         [ 5.0009e-02,  7.0202e-02],
         [ 5.0009e-02, -1.6601e-01],
         [ 5.0009e-02, -1.6136e-01],
         [ 5.0009e-02, -1.5838e-01],
         [ 5.0009e-02,  1.9531e-02]],

        [[-5.8723e-02,  1.2843e-01],
         [-5.9665e-02,  1.6172e-01],
         [-8.3029e-02,  1.3480e-01],
         [-7.1385e-02,  1.5194e-01],
         [-9.1036e-02,  1.7054e-01],
         [-3.4255e-02,  1.4912e-01],
         [-6.1731e-02,  9.3970e-02],
         [ 1.2557e-01, -1.2402e-01],
         [-7.9815e-02, -1.4925e-01],
         [-9.5855e-02, -1.7143e-01],
         [-1.0758e-01,  1.0498e-01],
         [-1.0119e-01,  9.4359e-02],
         [-1.1274e-01,  1.0496e-01],
         [-1.0419e-01,  6.9244e-02],
         [-1.1397e-01,  6.8772e-02],
         [-7.9559e-02, -1.8805e-01],
         [-5.3724e-02,  7.8163e-02],
         [-5.8636e-02, -1.7156e-01],
         [-4.9792e-02, -1.6958e-01],
         [-3.5434e-02, -1.4747e-01],
         [-6.0288e-02, -1.6831e-01],
         [-4.3926e-02, -1.5916e-01],
         [-3.7946e-02, -1.6511e-01],
         [-5.8748e-02, -9.0589e-03],
         [-6.7788e-02,  2.9268e-02],
         [-7.3400e-02,  4.6055e-02],
         [-7.7715e-02,  5.2924e-02],
         [-9.1400e-02,  5.5413e-02],
         [-1.0292e-01,  5.6087e-02],
         [ 1.1872e-01,  5.6049e-02],
         [-1.3075e-01,  5.5828e-02],
         [-9.9554e-02,  5.5592e-02],
         [-1.2549e-01,  5.5430e-02],
         [ 1.2251e-01,  5.5317e-02],
         [ 1.1057e-01,  5.5267e-02],
         [-1.3321e-01,  5.5215e-02],
         [ 9.6490e-02,  5.5211e-02],
         [ 1.0416e-01,  5.5222e-02],
         [-1.1594e-01,  5.5202e-02],
         [-1.0765e-01,  5.5201e-02],
         [-8.5018e-02,  5.5205e-02],
         [-7.3465e-02,  5.5216e-02],
         [-8.3122e-02,  5.5229e-02],
         [-7.0459e-02,  5.5229e-02],
         [-8.5054e-02,  5.5230e-02],
         [-1.0306e-01,  5.5229e-02],
         [-1.0539e-01,  5.5232e-02],
         [ 9.9818e-02,  5.5236e-02],
         [-9.7959e-02,  5.5235e-02],
         [-7.8004e-02,  5.5232e-02],
         [-9.9653e-02,  5.5232e-02],
         [-9.6312e-02,  5.5231e-02],
         [-7.7166e-02,  5.5231e-02],
         [-6.7918e-02,  5.5231e-02],
         [-5.8862e-02,  5.5231e-02],
         [-5.6729e-02,  5.5231e-02],
         [-5.5892e-02,  5.5231e-02],
         [-5.4805e-02,  5.5231e-02],
         [-5.3408e-02,  5.5231e-02],
         [-8.2850e-02,  5.5231e-02],
         [-8.4233e-02,  5.5231e-02],
         [-8.4251e-02,  5.5231e-02],
         [-1.0485e-01,  5.5231e-02],
         [-1.0587e-01,  5.5231e-02],
         [-1.0905e-01,  5.5231e-02],
         [-8.7596e-02,  5.5231e-02],
         [-7.6751e-02,  5.5231e-02],
         [-6.1696e-02,  5.5231e-02],
         [-6.7288e-02,  5.5231e-02],
         [-5.8775e-02,  5.5231e-02],
         [-5.1992e-02,  5.5231e-02],
         [-7.3542e-02,  5.5231e-02],
         [-7.5667e-02,  5.5231e-02],
         [-7.6744e-02,  5.5231e-02],
         [-7.7306e-02,  5.5231e-02],
         [-9.7009e-02,  5.5231e-02],
         [-9.2153e-02,  5.5231e-02],
         [-9.2230e-02,  5.5231e-02],
         [-1.0402e-01,  5.5231e-02],
         [ 1.1627e-01,  5.5231e-02],
         [ 1.2792e-01,  5.5231e-02],
         [ 1.1097e-01,  5.5231e-02],
         [-1.4036e-01,  5.5231e-02],
         [ 1.0765e-01,  5.5231e-02],
         [ 1.1919e-01,  5.5231e-02],
         [ 1.0911e-01,  5.5231e-02],
         [ 1.2506e-01,  5.5231e-02],
         [ 1.4812e-01,  5.5231e-02],
         [ 1.3746e-01,  5.5231e-02],
         [ 1.0251e-01,  5.5231e-02],
         [ 8.8769e-02,  5.5231e-02],
         [ 1.1512e-01,  5.5231e-02],
         [ 9.2493e-02,  5.5231e-02],
         [ 8.4513e-02,  5.5231e-02],
         [ 1.0516e-01,  5.5231e-02],
         [ 8.3673e-02,  5.5231e-02],
         [-1.7905e-01,  5.5231e-02],
         [-1.5571e-01,  5.5231e-02],
         [ 8.8306e-02,  5.5231e-02],
         [ 1.1381e-01,  5.5231e-02],
         [-2.6373e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(8.2413e-06, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.5891, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4647, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5548, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0605, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1642, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0424, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2356020.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2159, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.0519e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0906, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2652, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0906, device='cuda:0', grad_fn=<MinBackward1>)
t_env 2490
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0799e-01,  1.0994e-01,  ...,  4.2512e-02,
            1.4205e-01, -1.0000e+07],
          [-1.0000e+07, -4.1562e-02,  1.2343e-01,  ...,  1.2672e-02,
            1.4219e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3438e-01,  9.7930e-02,  ...,  1.1659e-02,
            1.6183e-01, -1.0000e+07],
          [-1.0000e+07, -4.3874e-02,  1.2534e-01,  ...,  1.1010e-03,
            1.3669e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6583e-01,  3.1207e-02,  ...,  6.4519e-02,
            1.9463e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5896e-01,  5.5805e-02,  ...,  5.4691e-02,
            1.9726e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.1483e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9935e-02,  7.7646e-02,  ...,  3.1390e-02,
            1.3386e-01, -1.0000e+07],
          [-1.0000e+07, -8.0190e-02,  1.5693e-01,  ...,  7.6112e-02,
            1.5810e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.7343e-02,  1.0893e-01,  ...,  5.0269e-02,
            1.5882e-01, -1.0000e+07],
          [-1.0000e+07, -8.4950e-02,  1.5101e-01,  ...,  5.7346e-02,
            1.5028e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01, -1.6811e-02],
         [ 1.0994e-01,  1.2343e-01],
         [ 9.7930e-02, -4.3874e-02],
         [ 1.0625e-01,  1.3966e-01],
         [ 1.1269e-01,  1.4718e-01],
         [-1.2413e-01,  1.4742e-01],
         [-1.0930e-01, -7.2602e-02],
         [ 1.2266e-01, -7.2884e-02],
         [ 1.4349e-01, -7.6688e-02],
         [ 1.3349e-01,  1.1534e-01],
         [ 1.4140e-01,  1.5677e-01],
         [ 1.4851e-01,  1.0557e-01],
         [ 1.4070e-01, -8.8427e-02],
         [ 1.5193e-01, -7.7269e-02],
         [ 1.6019e-01, -7.7716e-02],
         [ 1.3743e-01, -6.5687e-02],
         [ 1.1959e-01,  1.1829e-01],
         [ 1.0580e-01, -8.2964e-02],
         [ 1.2391e-01,  1.2517e-01],
         [ 1.5386e-01, -9.4719e-02],
         [ 1.3260e-01, -9.7851e-02],
         [ 1.5643e-01,  1.1507e-01],
         [ 1.6528e-01, -1.0069e-01],
         [ 1.6542e-01,  1.3441e-01],
         [ 1.6946e-01, -1.1028e-01],
         [-8.5710e-03, -8.2824e-02],
         [ 2.0147e-02, -6.9538e-02],
         [ 3.6399e-02, -7.5921e-02],
         [ 4.4441e-02, -6.2365e-02],
         [ 4.8131e-02, -7.8547e-02],
         [ 4.9595e-02, -7.3254e-02],
         [ 5.0121e-02, -6.7328e-02],
         [ 5.0214e-02, -5.7440e-02],
         [ 5.0189e-02, -5.5234e-02],
         [ 5.0129e-02, -5.4974e-02],
         [ 5.0072e-02, -3.9688e-02],
         [ 5.0047e-02, -1.7821e-03],
         [ 5.0023e-02,  5.5546e-03],
         [ 5.0026e-02, -1.5447e-02],
         [ 5.0031e-02, -4.4415e-02],
         [ 5.0021e-02, -3.4436e-02],
         [ 5.0018e-02, -5.0084e-02],
         [ 5.0009e-02, -5.0979e-02],
         [ 5.0017e-02, -6.7211e-02],
         [ 5.0022e-02, -5.9878e-02],
         [ 5.0015e-02, -6.4159e-02],
         [ 5.0006e-02, -7.7342e-02],
         [ 5.0007e-02, -2.5247e-02],
         [ 5.0007e-02, -9.8839e-03],
         [ 5.0008e-02, -4.2000e-02],
         [ 5.0008e-02, -3.2936e-02],
         [ 5.0008e-02, -3.2373e-02],
         [ 5.0008e-02, -3.5115e-02],
         [ 5.0008e-02, -3.7828e-02],
         [ 5.0008e-02, -5.1359e-03],
         [ 5.0008e-02,  5.0580e-03],
         [ 5.0008e-02,  8.2051e-03],
         [ 5.0009e-02,  6.5308e-03],
         [ 5.0009e-02,  5.4792e-03],
         [ 5.0009e-02, -1.5851e-02],
         [ 5.0009e-02, -5.1729e-03],
         [ 5.0009e-02, -8.4784e-03],
         [ 5.0009e-02,  2.3201e-03],
         [ 5.0009e-02, -1.5290e-02],
         [ 5.0009e-02, -2.5984e-02],
         [ 5.0009e-02, -3.2550e-02],
         [ 5.0009e-02, -5.2805e-02],
         [ 5.0009e-02, -6.6105e-02],
         [ 5.0009e-02, -5.5886e-02],
         [ 5.0009e-02, -9.8871e-02],
         [ 5.0009e-02, -1.0803e-01],
         [ 5.0009e-02, -1.1816e-01],
         [ 5.0009e-02, -1.2414e-01],
         [ 5.0009e-02, -1.1472e-01],
         [ 5.0009e-02, -1.1821e-01],
         [ 5.0009e-02,  1.0636e-01],
         [ 5.0009e-02,  1.0683e-01],
         [ 5.0009e-02, -1.3640e-01],
         [ 5.0009e-02,  8.4279e-02],
         [ 5.0009e-02,  7.6117e-02],
         [ 5.0009e-02, -1.2263e-01],
         [ 5.0009e-02, -1.1995e-01],
         [ 5.0009e-02,  7.3401e-02],
         [ 5.0009e-02,  8.4969e-02],
         [ 5.0009e-02,  1.0764e-01],
         [ 5.0009e-02,  1.1552e-01],
         [ 5.0009e-02,  1.2484e-01],
         [ 5.0009e-02,  6.6300e-02],
         [ 5.0009e-02, -1.5720e-01],
         [ 5.0009e-02, -1.5423e-01],
         [ 5.0009e-02, -1.5107e-01],
         [ 5.0009e-02, -1.6552e-01],
         [ 5.0009e-02,  8.5541e-02],
         [ 5.0009e-02,  6.8927e-02],
         [ 5.0009e-02, -1.6810e-01],
         [ 5.0009e-02,  7.7653e-02],
         [ 5.0009e-02, -1.6583e-01],
         [ 5.0009e-02, -1.5896e-01],
         [ 5.0009e-02,  2.1483e-02]],

        [[ 9.7167e-02,  1.3964e-01],
         [-6.9935e-02,  1.5693e-01],
         [ 1.0893e-01,  1.5101e-01],
         [-9.3617e-02, -7.9862e-02],
         [ 1.0724e-01, -9.8635e-02],
         [-1.0514e-01, -1.0727e-01],
         [ 1.0220e-01,  1.3038e-01],
         [-9.5144e-02, -1.2639e-01],
         [-1.0463e-01,  7.7554e-02],
         [-7.3632e-02,  8.2349e-02],
         [-5.0564e-02,  1.0266e-01],
         [-5.7367e-02,  8.5697e-02],
         [-6.0602e-02,  8.5883e-02],
         [-5.1146e-02,  2.1625e-01],
         [-5.4245e-02,  8.5434e-02],
         [-7.0327e-02,  9.9004e-02],
         [-8.2645e-02,  1.0184e-01],
         [-8.2492e-02,  7.7290e-02],
         [ 1.1942e-01,  6.5101e-02],
         [ 1.2457e-01, -1.8102e-01],
         [ 1.2629e-01, -1.8103e-01],
         [-1.2584e-01,  4.3959e-02],
         [ 9.8446e-02,  5.6323e-02],
         [-1.0807e-01, -1.9328e-01],
         [-9.4314e-02,  6.7612e-03],
         [-9.7433e-02,  3.4455e-02],
         [ 1.2402e-01,  4.7073e-02],
         [ 1.3604e-01,  5.2349e-02],
         [-3.2972e-02,  5.4317e-02],
         [-8.3250e-03,  5.4949e-02],
         [ 1.4338e-02,  5.5121e-02],
         [-2.8485e-02,  5.5158e-02],
         [-5.8609e-02,  5.5148e-02],
         [-9.0421e-02,  5.5147e-02],
         [-8.8901e-02,  5.5136e-02],
         [-8.8525e-02,  5.5157e-02],
         [-9.8631e-02,  5.5167e-02],
         [-8.9554e-02,  5.5176e-02],
         [-9.4061e-02,  5.5202e-02],
         [-1.0040e-01,  5.5216e-02],
         [-9.9782e-02,  5.5199e-02],
         [-1.0951e-01,  5.5216e-02],
         [-1.1362e-01,  5.5201e-02],
         [-1.0923e-01,  5.5212e-02],
         [-6.9490e-02,  5.5223e-02],
         [-7.6773e-02,  5.5232e-02],
         [-9.8070e-02,  5.5230e-02],
         [-7.8888e-02,  5.5230e-02],
         [-8.2082e-02,  5.5231e-02],
         [-8.3026e-02,  5.5236e-02],
         [-9.8317e-02,  5.5235e-02],
         [-6.2016e-02,  5.5232e-02],
         [ 1.5011e-01,  5.5232e-02],
         [ 1.6401e-01,  5.5231e-02],
         [ 1.7870e-01,  5.5231e-02],
         [ 1.8821e-01,  5.5231e-02],
         [ 2.0756e-01,  5.5231e-02],
         [ 2.0078e-01,  5.5231e-02],
         [ 2.0917e-01,  5.5231e-02],
         [ 2.1491e-01,  5.5231e-02],
         [ 1.6557e-01,  5.5231e-02],
         [ 1.0124e-01,  5.5231e-02],
         [ 1.3880e-01,  5.5231e-02],
         [ 1.0734e-01,  5.5231e-02],
         [ 9.5370e-02,  5.5231e-02],
         [ 1.3526e-01,  5.5231e-02],
         [ 1.1629e-01,  5.5231e-02],
         [-2.8125e-01,  5.5231e-02],
         [ 1.4303e-01,  5.5231e-02],
         [-2.8241e-01,  5.5231e-02],
         [ 9.4683e-02,  5.5231e-02],
         [ 7.4196e-02,  5.5231e-02],
         [ 9.9837e-02,  5.5231e-02],
         [ 1.1518e-01,  5.5231e-02],
         [ 7.9009e-02,  5.5231e-02],
         [-1.4961e-01,  5.5231e-02],
         [-1.4039e-01,  5.5231e-02],
         [ 1.5953e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-5.0200e-06, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0026, device='cuda:0')
mixer_td_error tensor(0.2609, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4933, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7474, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0484, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1637, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0792, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1060605.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2163, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.7210e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0019, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2101, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3272, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2101, device='cuda:0', grad_fn=<MinBackward1>)
t_env 2664
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5898e-02,  1.0054e-01,  ...,  4.1830e-02,
            1.6437e-01, -1.0000e+07],
          [-1.0000e+07, -3.7039e-02,  1.0473e-01,  ..., -3.1371e-02,
            1.3582e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6085e-02,  1.0713e-01,  ...,  2.0049e-02,
            1.6247e-01, -1.0000e+07],
          [-1.0000e+07, -1.6729e-02,  1.0948e-01,  ...,  2.6640e-03,
            1.2965e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2949e-01,  1.2515e-01,  ...,  4.9588e-02,
            1.6998e-01, -1.0000e+07],
          [-1.0000e+07, -4.1626e-02,  1.0611e-01,  ..., -2.7111e-02,
            1.3520e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6136e-01,  7.7979e-02,  ...,  6.1733e-02,
            2.1013e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5838e-01,  5.7839e-02,  ...,  4.5371e-02,
            2.0169e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.9531e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02, -1.3772e-02],
         [-6.7838e-02, -1.4399e-02],
         [ 1.0054e-01, -3.7039e-02],
         [-7.0085e-02,  1.2846e-01],
         [-7.7645e-02, -4.2822e-02],
         [-7.2394e-02, -5.5130e-02],
         [ 1.1932e-01, -5.9508e-02],
         [-5.3548e-02, -4.2156e-02],
         [ 1.2353e-01,  1.1663e-01],
         [ 1.3797e-01,  1.0732e-01],
         [ 1.0508e-01,  1.3067e-01],
         [-5.6930e-02,  1.0504e-01],
         [-4.0191e-02, -4.3882e-02],
         [-2.6975e-02,  1.0996e-01],
         [ 1.3455e-01, -1.8133e-02],
         [ 1.4066e-01, -4.4225e-02],
         [ 1.3162e-01,  1.0793e-01],
         [-3.9149e-02, -6.6556e-02],
         [-3.7854e-02, -6.2646e-02],
         [-3.3808e-02,  1.0184e-01],
         [ 1.3219e-01, -6.2139e-02],
         [ 1.4796e-01, -6.5015e-02],
         [ 1.2216e-01, -1.7075e-02],
         [ 1.1143e-01, -8.4041e-04],
         [-3.7000e-02,  1.5181e-01],
         [ 1.4332e-01,  1.6300e-01],
         [ 1.2056e-01,  1.1553e-01],
         [-4.9790e-02,  1.0135e-01],
         [-5.9718e-02,  1.0145e-01],
         [-6.2740e-02, -6.5109e-02],
         [-7.6109e-02, -7.2763e-02],
         [ 1.0485e-01, -5.9176e-02],
         [ 1.0517e-01, -7.1048e-02],
         [ 1.3033e-01,  1.2265e-01],
         [-8.0862e-02,  1.0710e-01],
         [-5.6284e-02,  1.0243e-01],
         [-5.5779e-02,  9.6051e-02],
         [ 1.3477e-01, -7.9570e-02],
         [-7.4199e-02, -7.9416e-02],
         [ 1.2417e-01, -7.3383e-02],
         [ 1.5434e-01, -9.3775e-02],
         [ 1.0743e-01, -3.1132e-02],
         [ 1.0294e-01, -5.0785e-02],
         [-5.5325e-02, -7.4617e-02],
         [-4.3668e-02, -8.1379e-02],
         [ 1.6209e-01, -7.3483e-02],
         [ 1.5323e-01,  9.5454e-02],
         [ 1.6167e-01, -7.5059e-02],
         [ 1.6836e-01,  1.0884e-01],
         [ 1.3134e-01,  1.0926e-01],
         [ 1.5380e-01, -1.0109e-01],
         [ 1.6571e-01,  8.1627e-02],
         [ 1.5162e-01, -1.1236e-01],
         [ 1.4845e-01, -1.0807e-01],
         [ 1.0752e-01,  8.0493e-02],
         [ 1.2681e-01,  1.1036e-01],
         [ 1.4247e-01,  6.7736e-02],
         [ 1.4781e-01, -1.0538e-01],
         [ 1.1204e-01,  1.0972e-01],
         [ 1.4207e-01,  8.1686e-02],
         [ 1.4843e-01,  8.1275e-02],
         [ 1.6215e-01,  7.7008e-02],
         [ 1.7869e-01,  7.3587e-02],
         [ 1.5282e-01,  7.9914e-02],
         [ 1.6030e-01,  1.2369e-01],
         [ 1.6376e-01,  1.2750e-01],
         [ 1.3191e-01,  8.9051e-02],
         [ 1.5730e-01,  8.2708e-02],
         [ 1.4165e-01,  6.2142e-02],
         [ 1.0788e-01,  5.7694e-02],
         [ 1.3217e-01,  7.5260e-02],
         [ 1.4254e-01,  7.9808e-02],
         [ 1.3868e-01,  1.1031e-01],
         [ 1.2106e-01,  9.3386e-02],
         [ 1.1388e-01,  8.8485e-02],
         [ 1.3693e-01,  6.5543e-02],
         [ 1.2548e-01,  1.1065e-01],
         [ 1.3744e-01,  9.7337e-02],
         [-2.7880e-02,  9.6369e-02],
         [ 1.1731e-02,  9.7769e-02],
         [ 3.2451e-02,  9.7303e-02],
         [ 4.2652e-02,  9.9711e-02],
         [ 4.7360e-02, -9.8532e-02],
         [ 4.9350e-02, -8.6290e-02],
         [ 5.0077e-02,  7.0882e-02],
         [ 5.0260e-02,  6.9613e-02],
         [ 5.0237e-02, -8.2090e-02],
         [ 5.0194e-02, -8.3019e-02],
         [ 5.0129e-02,  9.1984e-02],
         [ 5.0073e-02,  7.7525e-02],
         [ 5.0050e-02,  9.9920e-02],
         [ 5.0032e-02,  7.0477e-02],
         [ 5.0042e-02,  8.3020e-02],
         [ 5.0034e-02,  9.0730e-02],
         [ 5.0034e-02,  7.9712e-02],
         [ 5.0024e-02,  5.0051e-02],
         [ 5.0012e-02,  9.9623e-02],
         [ 5.0007e-02,  1.1556e-01],
         [ 5.0013e-02,  7.8086e-02],
         [ 5.0005e-02,  6.7500e-02],
         [ 5.0006e-02,  5.8099e-02],
         [ 5.0008e-02, -1.5965e-01],
         [ 5.0008e-02, -1.5086e-01],
         [ 5.0008e-02,  7.7172e-02],
         [ 5.0009e-02,  8.2850e-02],
         [ 5.0008e-02,  5.4118e-02],
         [ 5.0008e-02,  7.7317e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.6186e-02, -1.3772e-02],
         [ 1.0713e-01, -1.6729e-02],
         [ 1.2515e-01, -4.1626e-02],
         [ 8.0899e-02, -3.7657e-02],
         [-8.0354e-02, -4.9456e-02],
         [-6.3036e-02,  1.2298e-01],
         [-4.6483e-02, -5.3368e-02],
         [ 1.2665e-01,  1.1432e-01],
         [-4.8811e-02,  1.2499e-01],
         [-4.3636e-02, -4.4127e-02],
         [-4.1952e-02, -2.7085e-02],
         [-3.4142e-02,  1.2589e-01],
         [-2.5507e-02, -2.8875e-02],
         [-2.1500e-02, -7.2733e-03],
         [-2.7168e-02, -1.4600e-02],
         [ 1.2792e-01,  2.4736e-03],
         [-2.2949e-02, -6.9129e-03],
         [ 1.3427e-01,  1.6453e-03],
         [-4.0591e-02, -9.1634e-04],
         [-3.1119e-02, -2.0804e-02],
         [-3.8970e-02, -2.3457e-02],
         [-2.6104e-02, -3.0448e-02],
         [-3.0599e-02, -2.8530e-02],
         [-2.1814e-02, -1.4568e-02],
         [ 1.3468e-01, -7.1965e-03],
         [-2.8822e-02, -7.4266e-03],
         [ 1.2810e-01, -1.0687e-03],
         [ 1.3390e-01, -1.0687e-02],
         [ 1.2425e-01, -2.2420e-02],
         [ 1.3223e-01, -3.0281e-02],
         [ 1.3749e-01, -2.6051e-02],
         [ 1.3619e-01, -4.0858e-02],
         [-4.1153e-02,  1.3038e-01],
         [-3.1650e-02,  1.3136e-01],
         [-3.8872e-02, -4.6252e-02],
         [ 1.3199e-01,  1.1744e-01],
         [ 1.3197e-01, -4.7816e-02],
         [ 1.2690e-01,  1.1468e-01],
         [ 1.1842e-01,  1.2454e-01],
         [ 1.2883e-01,  1.2811e-01],
         [ 9.9860e-02,  1.1142e-01],
         [-6.2831e-02, -5.7370e-02],
         [ 1.2861e-01, -4.8169e-02],
         [ 1.2280e-01, -4.6007e-02],
         [ 1.3095e-01,  1.2189e-01],
         [ 1.1298e-01,  1.2948e-01],
         [ 1.3060e-01,  1.3407e-01],
         [ 1.1445e-01, -4.0849e-02],
         [ 1.2675e-01, -3.3967e-02],
         [ 1.3037e-01,  1.1688e-01],
         [ 1.3527e-01,  1.1145e-01],
         [ 1.3276e-01,  1.3142e-01],
         [ 1.0142e-01,  1.4162e-01],
         [ 1.3241e-01,  1.6224e-01],
         [ 1.0126e-01,  1.0793e-01],
         [ 9.7777e-02, -6.5382e-02],
         [ 1.1396e-01,  1.2053e-01],
         [ 1.3390e-01,  1.1367e-01],
         [ 1.3639e-01, -7.4307e-02],
         [ 1.3709e-01,  1.2124e-01],
         [ 1.0766e-01,  1.4208e-01],
         [ 1.2675e-01,  1.5251e-01],
         [ 1.3079e-01,  1.5448e-01],
         [ 1.4527e-01,  9.9324e-02],
         [ 1.5234e-01,  8.1534e-02],
         [ 1.2637e-01,  1.1337e-01],
         [ 1.4666e-01,  8.1669e-02],
         [ 1.5202e-01,  8.0329e-02],
         [ 1.5750e-01, -9.3381e-02],
         [ 1.5763e-01,  7.9899e-02],
         [ 1.5727e-01,  1.0330e-01],
         [ 1.3804e-01,  8.7934e-02],
         [ 1.2791e-01,  8.5560e-02],
         [ 1.1156e-01, -9.5942e-02],
         [ 1.4442e-01, -9.8815e-02],
         [ 1.3595e-01,  9.9758e-02],
         [ 1.3881e-01,  7.8513e-02],
         [ 1.4518e-01,  1.0798e-01],
         [ 1.0868e-01,  8.5542e-02],
         [ 9.5629e-02,  7.9942e-02],
         [ 1.2690e-01, -9.6534e-02],
         [ 1.3988e-01,  1.0154e-01],
         [ 1.3920e-01,  8.4300e-02],
         [ 1.5214e-01,  1.1349e-01],
         [ 1.3801e-01,  1.2262e-01],
         [ 1.5075e-01,  1.0082e-01],
         [ 1.5866e-01,  1.2287e-01],
         [ 1.3687e-01,  9.1488e-02],
         [ 1.3561e-01,  1.0362e-01],
         [ 1.3528e-01,  1.0941e-01],
         [-1.9949e-01,  1.1764e-01],
         [-7.1922e-03, -1.0780e-01],
         [ 1.6213e-02, -8.0468e-02],
         [ 3.2136e-02, -8.5812e-02],
         [ 4.1262e-02,  8.4014e-02],
         [ 4.6006e-02,  9.1413e-02],
         [ 4.8333e-02,  6.6010e-02],
         [ 4.9397e-02,  9.1410e-02],
         [ 4.9831e-02, -8.1566e-02],
         [ 5.0029e-02, -5.0763e-02],
         [ 5.0049e-02, -5.4832e-02],
         [ 5.0070e-02, -7.2186e-02],
         [ 5.0045e-02, -6.9299e-02],
         [ 5.0052e-02, -6.6710e-02],
         [ 5.0030e-02, -5.8681e-02],
         [ 5.0026e-02, -5.8359e-02],
         [ 5.0025e-02, -5.5200e-02],
         [ 5.0024e-02, -6.2861e-02],
         [ 5.0047e-02, -7.8290e-02],
         [ 5.0026e-02, -7.4350e-02],
         [ 5.0007e-02, -5.4113e-02],
         [ 5.0016e-02, -4.6430e-02],
         [ 5.0015e-02, -4.4303e-02],
         [ 5.0008e-02, -3.0966e-02],
         [ 5.0008e-02, -3.3476e-02],
         [ 5.0009e-02, -5.2869e-02],
         [ 5.0009e-02, -3.8207e-02],
         [ 5.0008e-02, -2.1701e-02],
         [ 5.0008e-02,  8.7932e-03],
         [ 5.0008e-02,  1.4378e-02],
         [ 5.0008e-02,  1.5607e-01],
         [ 5.0008e-02,  1.1941e-01],
         [ 5.0008e-02, -3.8029e-02],
         [ 5.0008e-02, -3.5575e-02],
         [ 5.0009e-02, -7.4685e-04],
         [ 5.0009e-02,  1.3751e-01],
         [ 5.0009e-02,  1.5849e-01],
         [ 5.0009e-02,  1.6696e-01],
         [ 5.0009e-02,  5.8487e-03],
         [ 5.0009e-02, -1.7561e-02],
         [ 5.0009e-02, -2.9399e-02],
         [ 5.0009e-02, -1.3329e-02],
         [ 5.0009e-02, -2.5841e-02],
         [ 5.0009e-02, -1.9824e-02],
         [ 5.0009e-02, -2.6416e-02],
         [ 5.0009e-02, -3.1827e-02],
         [ 5.0009e-02, -3.5729e-02],
         [ 5.0009e-02, -1.5903e-02],
         [ 5.0009e-02, -1.4392e-02],
         [ 5.0009e-02, -2.2945e-02],
         [ 5.0009e-02,  4.8837e-03],
         [ 5.0009e-02, -2.9409e-02],
         [ 5.0009e-02, -3.5167e-02],
         [ 5.0009e-02, -4.8477e-02],
         [ 5.0009e-02, -4.7522e-02],
         [ 5.0009e-02, -6.8352e-02],
         [ 5.0009e-02, -5.9285e-02],
         [ 5.0009e-02, -5.5571e-02],
         [ 5.0009e-02, -6.9711e-02],
         [ 5.0009e-02,  9.2868e-02],
         [ 5.0009e-02, -6.0093e-02],
         [ 5.0009e-02,  8.8516e-02],
         [ 5.0009e-02,  1.0019e-01],
         [ 5.0009e-02,  1.0272e-01],
         [ 5.0009e-02, -6.7342e-02],
         [ 5.0009e-02, -6.6704e-02],
         [ 5.0009e-02, -5.6138e-02],
         [ 5.0009e-02, -6.6396e-02],
         [ 5.0009e-02, -5.6237e-02],
         [ 5.0009e-02, -5.4717e-02],
         [ 5.0009e-02,  9.5212e-02],
         [ 5.0009e-02,  8.2315e-02],
         [ 5.0009e-02,  9.0742e-02],
         [ 5.0009e-02,  6.4022e-02],
         [ 5.0009e-02,  9.7395e-02],
         [ 5.0009e-02,  6.2976e-02],
         [ 5.0009e-02,  4.0133e-02],
         [ 5.0009e-02,  5.7919e-02],
         [ 5.0009e-02,  7.8263e-02],
         [ 5.0009e-02,  4.6232e-02],
         [ 5.0009e-02,  7.8058e-02],
         [ 5.0009e-02,  5.7546e-02],
         [ 5.0009e-02,  8.0579e-02],
         [ 5.0009e-02,  5.7042e-02],
         [ 5.0009e-02, -1.0279e-01],
         [ 5.0009e-02,  7.8451e-02],
         [ 5.0009e-02,  9.1922e-02],
         [ 5.0009e-02,  1.1326e-01],
         [ 5.0009e-02,  1.1961e-01],
         [ 5.0009e-02,  1.2729e-01],
         [ 5.0009e-02,  1.0692e-01],
         [ 5.0009e-02,  7.3615e-02],
         [ 5.0009e-02,  8.5259e-02],
         [ 5.0009e-02,  9.3280e-02],
         [ 5.0009e-02,  4.6941e-02],
         [ 5.0009e-02, -1.5394e-01],
         [ 5.0009e-02,  7.0202e-02],
         [ 5.0009e-02,  7.6510e-02],
         [ 5.0009e-02,  7.7979e-02],
         [ 5.0009e-02,  5.7839e-02],
         [ 5.0009e-02,  1.9531e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.4790e-05, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.5166, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4677, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5123, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0420, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1748, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0805, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2198952.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1787, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.3581e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1821, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.3638, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1821, device='cuda:0', grad_fn=<MinBackward1>)
t_env 2734
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0695e-02,  8.8884e-02,  ...,  1.4652e-02,
            1.4204e-01, -1.0000e+07],
          [-1.0000e+07, -3.4872e-02,  9.9288e-02,  ..., -3.2764e-02,
            1.3673e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3586e-01,  4.0597e-02,  ...,  4.7742e-02,
            1.9922e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1941e-01,  1.6392e-02,  ...,  4.5058e-02,
            1.8264e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.1394e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.8799e-02,  1.1017e-01,  ...,  6.1516e-02,
            1.3971e-01, -1.0000e+07],
          [-1.0000e+07, -2.8322e-02,  1.2490e-01,  ...,  1.4773e-02,
            1.3610e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3357e-02,  7.6576e-02,  ...,  4.4627e-02,
            1.3934e-01, -1.0000e+07],
          [-1.0000e+07, -2.5884e-02,  1.2689e-01,  ..., -4.2544e-03,
            1.3727e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.9090e-02,  5.8755e-02,  ...,  3.9416e-02,
            1.3901e-01, -1.0000e+07],
          [-1.0000e+07, -2.5911e-02,  1.2652e-01,  ..., -1.9137e-02,
            1.3974e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02,  8.7099e-02],
         [ 6.9213e-02, -1.4399e-02],
         [ 8.8884e-02,  9.9288e-02],
         [ 9.1497e-02, -4.0589e-02],
         [ 1.1814e-01,  1.1219e-01],
         [ 1.0716e-01,  1.1003e-01],
         [ 1.0986e-01,  9.5288e-02],
         [ 1.2487e-01,  1.1727e-01],
         [ 1.1758e-01,  1.0258e-01],
         [ 1.5183e-01,  1.2731e-01],
         [ 1.7336e-01,  1.1188e-01],
         [ 1.8323e-01,  1.0340e-01],
         [ 1.5019e-01,  1.2251e-01],
         [ 1.6608e-01,  1.3316e-01],
         [ 1.4368e-01,  9.9764e-02],
         [ 1.3013e-01,  1.2584e-01],
         [ 1.5058e-01,  1.1515e-01],
         [ 1.7461e-01,  1.4160e-01],
         [ 1.8083e-01,  1.2839e-01],
         [ 1.3143e-01,  1.4630e-01],
         [ 1.4003e-01,  1.5612e-01],
         [ 1.6183e-01,  1.5992e-01],
         [ 1.1678e-01,  1.3547e-01],
         [ 1.3169e-01,  1.2089e-01],
         [ 1.5533e-01,  1.4156e-01],
         [ 1.6582e-01,  1.5210e-01],
         [ 1.8747e-01,  1.3380e-01],
         [ 1.9394e-01, -3.4138e-02],
         [ 1.9964e-01, -3.0103e-02],
         [ 1.5332e-01, -5.1397e-02],
         [ 1.0850e-01, -4.7618e-02],
         [ 1.1844e-01, -4.9616e-02],
         [ 1.2093e-01,  7.1316e-02],
         [ 1.1190e-01,  8.2845e-02],
         [ 1.5083e-01,  1.2766e-01],
         [ 1.5953e-01,  1.1280e-01],
         [ 1.6312e-01,  1.3203e-01],
         [ 1.5568e-01,  8.2679e-02],
         [ 1.5366e-01, -7.4816e-02],
         [ 1.1933e-01,  7.4219e-02],
         [ 1.2067e-01, -6.1851e-02],
         [ 1.2170e-01,  8.1386e-02],
         [ 1.2081e-01, -6.7306e-02],
         [ 1.2439e-01, -4.8074e-02],
         [ 1.0154e-01,  7.8442e-02],
         [ 7.2165e-02,  9.4530e-02],
         [ 6.0676e-02, -5.2451e-02],
         [-6.7529e-03, -3.1846e-02],
         [ 2.1785e-02, -1.9923e-02],
         [ 3.6720e-02, -3.5356e-03],
         [ 4.4121e-02, -1.9083e-02],
         [ 4.7585e-02, -1.6124e-02],
         [ 4.9116e-02, -1.1797e-02],
         [ 4.9755e-02,  1.0193e-03],
         [ 4.9969e-02, -3.3511e-02],
         [ 5.0025e-02, -4.2697e-02],
         [ 5.0041e-02,  7.6199e-02],
         [ 5.0028e-02, -6.2789e-02],
         [ 5.0030e-02, -1.4365e-02],
         [ 5.0032e-02, -2.7605e-03],
         [ 5.0026e-02, -2.0673e-02],
         [ 5.0025e-02,  3.7915e-03],
         [ 5.0002e-02,  7.3887e-03],
         [ 5.0023e-02,  7.5001e-03],
         [ 5.0015e-02, -3.1327e-02],
         [ 5.0015e-02,  8.4728e-02],
         [ 5.0017e-02,  1.1190e-01],
         [ 5.0010e-02,  1.1439e-01],
         [ 5.0006e-02,  1.2453e-01],
         [ 5.0007e-02,  7.5143e-02],
         [ 5.0007e-02,  9.5517e-02],
         [ 5.0008e-02,  1.0419e-01],
         [ 5.0008e-02,  6.0583e-02],
         [ 5.0008e-02,  6.6206e-02],
         [ 5.0009e-02,  4.7820e-02],
         [ 5.0008e-02, -8.8699e-02],
         [ 5.0008e-02,  7.1791e-02],
         [ 5.0008e-02,  5.2278e-02],
         [ 5.0008e-02,  7.9627e-02],
         [ 5.0009e-02, -8.8788e-02],
         [ 5.0009e-02,  8.0606e-02],
         [ 5.0009e-02,  6.0086e-02],
         [ 5.0009e-02,  8.7622e-02],
         [ 5.0009e-02,  9.3214e-02],
         [ 5.0009e-02,  9.8088e-02],
         [ 5.0009e-02,  9.4704e-02],
         [ 5.0009e-02,  1.2971e-01],
         [ 5.0009e-02,  1.4388e-01],
         [ 5.0009e-02,  9.4154e-02],
         [ 5.0009e-02,  9.3596e-02],
         [ 5.0009e-02,  9.0519e-02],
         [ 5.0009e-02,  1.2746e-01],
         [ 5.0009e-02,  8.6365e-02],
         [ 5.0009e-02,  9.9241e-02],
         [ 5.0009e-02,  9.6803e-02],
         [ 5.0009e-02,  1.0001e-01],
         [ 5.0009e-02,  7.7919e-02],
         [ 5.0009e-02,  4.9976e-02],
         [ 5.0009e-02,  7.5075e-02],
         [ 5.0009e-02,  9.0214e-02],
         [ 5.0009e-02,  9.2185e-02],
         [ 5.0009e-02,  1.2950e-01],
         [ 5.0009e-02,  1.4499e-01],
         [ 5.0009e-02,  1.5198e-01],
         [ 5.0009e-02,  1.1823e-01],
         [ 5.0009e-02,  1.4446e-01],
         [ 5.0009e-02,  1.5428e-01],
         [ 5.0009e-02,  1.3487e-01],
         [ 5.0009e-02, -1.2618e-02],
         [ 5.0009e-02,  3.3931e-03],
         [ 5.0009e-02,  1.3910e-01],
         [ 5.0009e-02,  1.5229e-01],
         [ 5.0009e-02,  1.6581e-01],
         [ 5.0009e-02,  1.2716e-01],
         [ 5.0009e-02,  1.5911e-01],
         [ 5.0009e-02,  1.6409e-01],
         [ 5.0009e-02,  1.0157e-01],
         [ 5.0009e-02, -5.1520e-02],
         [ 5.0009e-02,  8.4554e-02],
         [ 5.0009e-02, -5.3361e-02],
         [ 5.0009e-02,  8.8785e-02],
         [ 5.0009e-02, -2.2396e-02],
         [ 5.0009e-02, -1.8733e-02],
         [ 5.0009e-02, -2.6026e-02],
         [ 5.0009e-02, -3.1849e-02],
         [ 5.0009e-02, -1.3676e-02],
         [ 5.0009e-02, -2.5572e-02],
         [ 5.0009e-02, -9.9668e-03],
         [ 5.0009e-02, -1.0698e-02],
         [ 5.0009e-02, -2.0732e-02],
         [ 5.0009e-02, -6.1543e-03],
         [ 5.0009e-02, -8.4494e-03],
         [ 5.0009e-02,  2.5393e-03],
         [ 5.0009e-02,  6.7060e-03],
         [ 5.0009e-02,  8.4499e-03],
         [ 5.0009e-02,  3.3570e-05],
         [ 5.0009e-02,  7.4983e-03],
         [ 5.0009e-02, -1.2278e-02],
         [ 5.0009e-02, -4.1027e-02],
         [ 5.0009e-02,  9.2616e-02],
         [ 5.0009e-02,  9.9661e-02],
         [ 5.0009e-02,  6.7706e-02],
         [ 5.0009e-02, -3.4903e-02],
         [ 5.0009e-02, -3.4755e-02],
         [ 5.0009e-02, -2.4225e-02],
         [ 5.0009e-02, -2.9173e-02],
         [ 5.0009e-02,  8.9622e-02],
         [ 5.0009e-02,  9.4775e-02],
         [ 5.0009e-02,  9.5306e-02],
         [ 5.0009e-02,  1.0071e-01],
         [ 5.0009e-02, -5.1489e-02],
         [ 5.0009e-02, -3.0790e-02],
         [ 5.0009e-02, -3.1867e-02],
         [ 5.0009e-02, -1.2692e-02],
         [ 5.0009e-02, -4.1902e-02],
         [ 5.0009e-02, -3.1691e-02],
         [ 5.0009e-02, -3.0797e-02],
         [ 5.0009e-02, -2.0897e-02],
         [ 5.0009e-02, -2.6814e-02],
         [ 5.0009e-02, -1.9622e-02],
         [ 5.0009e-02, -2.6434e-02],
         [ 5.0009e-02,  8.9166e-02],
         [ 5.0009e-02,  9.4569e-02],
         [ 5.0009e-02, -4.2529e-03],
         [ 5.0009e-02, -1.7457e-02],
         [ 5.0009e-02,  1.9800e-03],
         [ 5.0009e-02, -1.6050e-02],
         [ 5.0009e-02,  8.1534e-02],
         [ 5.0009e-02,  9.2678e-02],
         [ 5.0009e-02, -5.6799e-02],
         [ 5.0009e-02, -1.3798e-02],
         [ 5.0009e-02,  1.4091e-01],
         [ 5.0009e-02,  1.5993e-01],
         [ 5.0009e-02,  1.6269e-01],
         [ 5.0009e-02, -3.5386e-02],
         [ 5.0009e-02,  9.5644e-02],
         [ 5.0009e-02,  9.6587e-02],
         [ 5.0009e-02, -9.1769e-03],
         [ 5.0009e-02, -2.5406e-02],
         [ 5.0009e-02, -1.6255e-02],
         [ 5.0009e-02,  1.2638e-01],
         [ 5.0009e-02,  1.5315e-01],
         [ 5.0009e-02,  1.6703e-01],
         [ 5.0009e-02,  1.2784e-01],
         [ 5.0009e-02,  6.1416e-03],
         [ 5.0009e-02,  1.4609e-01],
         [ 5.0009e-02,  1.6603e-01],
         [ 5.0009e-02,  1.0290e-01],
         [ 5.0009e-02,  1.0114e-01],
         [ 5.0009e-02,  1.0021e-01],
         [ 5.0009e-02,  1.1800e-01],
         [ 5.0009e-02,  9.0486e-02],
         [ 5.0009e-02,  1.1388e-01],
         [ 5.0009e-02,  6.9002e-02],
         [ 5.0009e-02,  4.8347e-02],
         [ 5.0009e-02, -1.0161e-01],
         [ 5.0009e-02,  7.0247e-02],
         [ 5.0009e-02,  7.9306e-02],
         [ 5.0009e-02,  1.2139e-01],
         [ 5.0009e-02,  8.7706e-02],
         [ 5.0009e-02,  7.0982e-02],
         [ 5.0009e-02,  9.6345e-02],
         [ 5.0009e-02,  8.3077e-02],
         [ 5.0009e-02,  7.4376e-02],
         [ 5.0009e-02,  7.7576e-02],
         [ 5.0009e-02,  4.1654e-02],
         [ 5.0009e-02,  5.8213e-02],
         [ 5.0009e-02,  7.4738e-02],
         [ 5.0009e-02,  8.2372e-02],
         [ 5.0009e-02,  5.8282e-02],
         [ 5.0009e-02,  6.2606e-02],
         [ 5.0009e-02,  7.4427e-02],
         [ 5.0009e-02,  5.2736e-02],
         [ 5.0009e-02,  4.4371e-02],
         [ 5.0009e-02,  8.5261e-02],
         [ 5.0009e-02,  5.6428e-02],
         [ 5.0009e-02,  7.1099e-02],
         [ 5.0009e-02,  6.3054e-02],
         [ 5.0009e-02,  8.2815e-02],
         [ 5.0009e-02,  4.0893e-02],
         [ 5.0009e-02,  7.2760e-02],
         [ 5.0009e-02, -1.3586e-01],
         [ 5.0009e-02, -1.1941e-01],
         [ 5.0009e-02,  5.1394e-02]],

        [[ 1.1017e-01,  1.2490e-01],
         [ 7.6576e-02,  1.2689e-01],
         [-7.9090e-02,  1.2652e-01],
         [ 7.7228e-02,  1.4016e-01],
         [ 9.7377e-02,  1.2443e-01],
         [ 9.1265e-02,  1.0546e-01],
         [ 9.0258e-02,  1.2260e-01],
         [-7.5913e-02,  1.2862e-01],
         [ 1.0173e-01,  1.3239e-01],
         [ 1.1362e-01,  1.1837e-01],
         [ 1.1453e-01,  1.3216e-01],
         [ 9.0659e-02,  1.4369e-01],
         [ 1.1898e-01,  1.2355e-01],
         [ 1.0675e-01,  1.1615e-01],
         [ 1.0052e-01,  1.1174e-01],
         [ 9.6374e-02,  1.3320e-01],
         [ 1.2098e-01,  1.5047e-01],
         [ 1.1359e-01,  7.3127e-02],
         [ 1.3350e-01,  8.0978e-02],
         [ 1.4640e-01,  2.7787e-02],
         [ 1.1619e-01,  6.5704e-02],
         [ 9.2573e-02,  6.4320e-02],
         [ 1.1584e-01,  9.9201e-02],
         [ 1.0966e-01,  1.1802e-01],
         [ 8.6072e-02,  6.8494e-02],
         [ 1.0683e-01,  9.9457e-02],
         [ 1.0230e-01,  6.1851e-02],
         [ 8.0722e-02,  1.3665e-01],
         [ 7.6291e-02,  1.2979e-01],
         [ 6.6620e-02,  1.7145e-01],
         [ 1.0459e-01,  1.3897e-01],
         [ 1.3237e-01,  8.8752e-02],
         [ 1.1212e-01,  1.1611e-01],
         [ 1.1680e-01,  1.1592e-01],
         [ 1.5335e-01,  1.1074e-01],
         [ 1.2648e-01,  1.1028e-01],
         [ 7.2259e-02,  1.3994e-01],
         [ 1.0498e-01,  1.1687e-01],
         [ 1.2999e-01,  1.4187e-01],
         [ 1.6023e-01,  1.1625e-01],
         [ 1.7786e-01,  1.2838e-01],
         [ 1.3986e-01,  1.5269e-01],
         [ 1.2664e-01,  1.5076e-01],
         [ 1.2916e-01,  1.5014e-01],
         [ 1.0589e-01,  1.4901e-01],
         [ 1.3291e-01,  1.1274e-01],
         [ 1.4468e-01,  5.0993e-03],
         [ 1.0870e-01,  3.1411e-02],
         [ 1.0849e-01,  4.5714e-02],
         [ 6.7021e-02,  5.2212e-02],
         [ 9.6770e-02,  5.4775e-02],
         [ 6.1915e-02,  5.5544e-02],
         [ 8.3715e-02,  5.5643e-02],
         [ 1.0102e-01,  5.5543e-02],
         [-3.4857e-03,  5.5415e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-6.8406e-06, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(0.9301, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4835, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8775, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0469, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1783, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0822, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3772321., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1996, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.8573e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0014, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1755, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1454, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1755, device='cuda:0', grad_fn=<MinBackward1>)
t_env 2785
target_mac_out tensor([[[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4689e-02,  1.0709e-01,  ...,  1.4450e-02,
            1.5237e-01, -1.0000e+07],
          [-1.0000e+07, -2.1835e-02,  9.9402e-02,  ..., -1.5839e-02,
            1.3204e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0286e-02,  1.0929e-01,  ...,  4.9539e-03,
            1.4714e-01, -1.0000e+07],
          [-1.0000e+07, -4.0755e-02,  1.1664e-01,  ..., -1.3107e-02,
            1.4728e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5109e-01,  4.3734e-02,  ...,  2.5633e-02,
            1.9335e-01, -3.0600e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4069e-01,  2.7674e-02,  ...,  3.4865e-02,
            1.7954e-01, -3.0370e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.5720e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5898e-02,  1.0054e-01,  ...,  4.1830e-02,
            1.6437e-01, -1.0000e+07],
          [-1.0000e+07, -3.7039e-02,  1.0473e-01,  ..., -3.1371e-02,
            1.3582e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.2300e-02,  8.8635e-02],
         [ 1.0709e-01,  9.9402e-02],
         [ 1.0929e-01,  1.1664e-01],
         [ 1.1707e-01,  1.4906e-01],
         [ 1.2279e-01,  1.5190e-01],
         [ 9.8224e-02,  1.1788e-01],
         [ 9.0415e-02,  1.1747e-01],
         [ 1.1010e-01,  7.5451e-02],
         [ 1.0275e-01,  6.6050e-02],
         [ 1.1137e-01,  9.3524e-02],
         [ 1.1450e-01,  8.5916e-02],
         [ 1.1551e-01,  8.5467e-02],
         [ 1.0226e-01,  1.1707e-01],
         [ 1.2004e-01,  1.3088e-01],
         [ 1.1997e-01,  8.9258e-02],
         [ 1.2702e-01,  1.0430e-01],
         [ 1.0899e-01,  8.6519e-02],
         [ 1.0240e-01,  1.2646e-01],
         [ 1.0996e-01,  1.3615e-01],
         [ 1.1185e-01,  1.4356e-01],
         [ 1.2247e-01,  1.2033e-01],
         [ 1.2840e-01,  9.6356e-02],
         [ 1.2090e-01,  1.0689e-01],
         [ 9.7435e-02,  1.1374e-01],
         [ 1.2041e-01,  1.1817e-01],
         [ 1.1333e-01,  1.0346e-01],
         [ 1.1270e-01,  9.2009e-02],
         [ 1.3086e-01,  1.1294e-01],
         [ 1.3902e-01,  1.1477e-01],
         [ 1.2469e-01,  8.2680e-02],
         [ 1.1915e-01,  5.7627e-02],
         [ 1.1927e-01,  7.5070e-02],
         [ 1.1176e-01,  8.6550e-02],
         [ 1.2861e-01,  8.1180e-02],
         [ 1.3395e-01,  1.1226e-01],
         [ 1.4656e-01,  1.0098e-01],
         [ 1.4738e-01,  1.2232e-01],
         [ 1.3493e-01,  1.3158e-01],
         [ 9.9820e-02,  1.1388e-01],
         [ 9.7208e-02,  1.2943e-01],
         [ 8.8163e-02,  1.4022e-01],
         [ 1.0250e-01,  1.4787e-01],
         [ 7.1497e-02,  1.2195e-01],
         [ 9.1572e-02,  1.4120e-01],
         [ 1.0760e-01,  1.0981e-01],
         [ 9.7120e-02,  1.2752e-01],
         [ 1.1733e-01,  9.8038e-02],
         [ 1.1415e-01,  1.2168e-01],
         [ 1.1194e-01,  1.3593e-01],
         [ 1.2551e-01,  1.2816e-01],
         [ 1.3092e-01,  1.0309e-01],
         [ 1.3263e-01,  1.2196e-01],
         [ 1.3071e-01,  1.1071e-01],
         [ 1.1640e-01,  9.5609e-02],
         [ 1.1093e-01,  8.8856e-02],
         [ 1.2401e-01,  1.2196e-01],
         [ 1.0169e-01,  1.3879e-01],
         [ 1.1193e-01,  1.5026e-01],
         [ 1.1108e-01,  1.4903e-01],
         [ 1.1977e-01,  1.1366e-01],
         [ 1.3219e-01,  1.3963e-01],
         [ 1.1138e-01,  1.1566e-01],
         [ 1.2885e-01,  1.4543e-01],
         [ 1.2644e-01,  1.1881e-01],
         [ 1.3949e-01,  1.4211e-01],
         [ 1.4276e-01,  1.4916e-01],
         [ 1.4168e-01,  1.4817e-01],
         [ 1.1640e-01,  1.0859e-01],
         [ 1.4400e-01,  1.2352e-01],
         [ 1.2612e-01,  1.3480e-01],
         [ 1.2655e-01,  1.1539e-01],
         [ 1.4689e-01,  8.5303e-02],
         [ 1.4433e-01,  1.1715e-01],
         [ 1.5643e-01,  1.3132e-01],
         [ 1.3460e-01,  8.9971e-02],
         [ 1.5093e-01,  8.7945e-02],
         [ 1.6464e-01,  1.1095e-01],
         [ 1.6342e-01,  7.6047e-02],
         [ 2.4488e-03, -6.0971e-02],
         [ 2.3410e-02, -3.7074e-02],
         [ 3.6787e-02, -3.5789e-02],
         [ 4.3993e-02, -1.5429e-02],
         [ 4.7565e-02, -2.6782e-02],
         [ 4.9168e-02, -2.0664e-02],
         [ 4.9817e-02, -2.7034e-02],
         [ 5.0045e-02, -1.9710e-02],
         [ 5.0112e-02, -2.6331e-02],
         [ 5.0088e-02,  8.5826e-02],
         [ 5.0075e-02, -5.1540e-02],
         [ 5.0057e-02, -4.7392e-02],
         [ 5.0027e-02,  7.8125e-02],
         [ 5.0040e-02, -5.2743e-02],
         [ 5.0031e-02, -2.2996e-02],
         [ 5.0025e-02, -1.7798e-02],
         [ 5.0022e-02, -4.2187e-02],
         [ 5.0021e-02,  8.8702e-02],
         [ 5.0015e-02,  9.7786e-02],
         [ 5.0012e-02,  6.0236e-02],
         [ 5.0019e-02, -6.1691e-02],
         [ 5.0005e-02, -4.8752e-02],
         [ 5.0006e-02, -2.0558e-02],
         [ 5.0008e-02, -4.5918e-02],
         [ 5.0008e-02, -3.3800e-02],
         [ 5.0008e-02,  8.3104e-02],
         [ 5.0009e-02,  9.4228e-02],
         [ 5.0008e-02,  9.8239e-02],
         [ 5.0008e-02, -1.6848e-02],
         [ 5.0008e-02,  8.3121e-02],
         [ 5.0008e-02, -3.2779e-02],
         [ 5.0008e-02,  8.5381e-02],
         [ 5.0009e-02,  9.3723e-02],
         [ 5.0009e-02,  1.0113e-01],
         [ 5.0009e-02,  6.2513e-02],
         [ 5.0009e-02, -4.6148e-02],
         [ 5.0009e-02, -2.7205e-02],
         [ 5.0009e-02,  7.4228e-02],
         [ 5.0009e-02, -4.9745e-02],
         [ 5.0009e-02, -3.5934e-02],
         [ 5.0009e-02, -1.1604e-02],
         [ 5.0009e-02, -1.5037e-03],
         [ 5.0009e-02, -3.5710e-02],
         [ 5.0009e-02, -3.8721e-02],
         [ 5.0009e-02,  7.7418e-02],
         [ 5.0009e-02, -5.3529e-02],
         [ 5.0009e-02, -5.1740e-02],
         [ 5.0009e-02, -3.6481e-02],
         [ 5.0009e-02,  7.7099e-02],
         [ 5.0009e-02, -1.4424e-02],
         [ 5.0009e-02, -2.6294e-02],
         [ 5.0009e-02, -1.0880e-02],
         [ 5.0009e-02, -2.1796e-03],
         [ 5.0009e-02, -3.5703e-02],
         [ 5.0009e-02,  8.5182e-02],
         [ 5.0009e-02, -5.4805e-02],
         [ 5.0009e-02,  8.2107e-02],
         [ 5.0009e-02,  9.4690e-02],
         [ 5.0009e-02,  5.8548e-02],
         [ 5.0009e-02, -6.1959e-02],
         [ 5.0009e-02,  7.8351e-02],
         [ 5.0009e-02,  9.2915e-02],
         [ 5.0009e-02, -6.6492e-02],
         [ 5.0009e-02,  8.4851e-02],
         [ 5.0009e-02, -5.8931e-02],
         [ 5.0009e-02, -5.5145e-02],
         [ 5.0009e-02, -4.9577e-02],
         [ 5.0009e-02, -5.1569e-02],
         [ 5.0009e-02, -5.9566e-02],
         [ 5.0009e-02, -5.4384e-02],
         [ 5.0009e-02, -4.4343e-02],
         [ 5.0009e-02,  7.0204e-02],
         [ 5.0009e-02,  8.9803e-02],
         [ 5.0009e-02,  6.2601e-02],
         [ 5.0009e-02, -3.1097e-02],
         [ 5.0009e-02, -1.0031e-02],
         [ 5.0009e-02, -1.0247e-02],
         [ 5.0009e-02, -7.9768e-03],
         [ 5.0009e-02, -5.9288e-03],
         [ 5.0009e-02, -3.4743e-02],
         [ 5.0009e-02, -2.7162e-02],
         [ 5.0009e-02, -6.2309e-03],
         [ 5.0009e-02, -3.7196e-02],
         [ 5.0009e-02,  8.8279e-02],
         [ 5.0009e-02, -4.9438e-02],
         [ 5.0009e-02, -4.3943e-02],
         [ 5.0009e-02, -4.7101e-02],
         [ 5.0009e-02, -4.0317e-02],
         [ 5.0009e-02, -2.4805e-02],
         [ 5.0009e-02, -6.2786e-03],
         [ 5.0009e-02, -2.0382e-02],
         [ 5.0009e-02,  8.5649e-02],
         [ 5.0009e-02, -1.2467e-02],
         [ 5.0009e-02,  7.8798e-02],
         [ 5.0009e-02,  8.8902e-02],
         [ 5.0009e-02, -5.0565e-02],
         [ 5.0009e-02,  8.5305e-02],
         [ 5.0009e-02,  9.6662e-02],
         [ 5.0009e-02,  1.0111e-01],
         [ 5.0009e-02,  1.0525e-01],
         [ 5.0009e-02,  1.2110e-01],
         [ 5.0009e-02,  1.1905e-01],
         [ 5.0009e-02,  8.1493e-02],
         [ 5.0009e-02,  5.4724e-02],
         [ 5.0009e-02,  8.5680e-02],
         [ 5.0009e-02,  9.8182e-02],
         [ 5.0009e-02,  7.0510e-02],
         [ 5.0009e-02,  9.8478e-02],
         [ 5.0009e-02,  6.5444e-02],
         [ 5.0009e-02,  7.1292e-02],
         [ 5.0009e-02,  8.0597e-02],
         [ 5.0009e-02,  7.6084e-02],
         [ 5.0009e-02,  7.0666e-02],
         [ 5.0009e-02,  8.5560e-02],
         [ 5.0009e-02,  8.5482e-02],
         [ 5.0009e-02,  8.8488e-02],
         [ 5.0009e-02,  5.7154e-02],
         [ 5.0009e-02,  4.6379e-02],
         [ 5.0009e-02,  6.8469e-02],
         [ 5.0009e-02,  5.4959e-02],
         [ 5.0009e-02,  4.3734e-02],
         [ 5.0009e-02, -1.4069e-01],
         [ 5.0009e-02,  8.5720e-03]],

        [[ 9.6186e-02,  8.7099e-02],
         [ 6.9213e-02,  1.0899e-01],
         [ 1.0054e-01,  1.0473e-01],
         [ 7.3317e-02,  1.2846e-01],
         [ 8.6416e-02,  1.2174e-01],
         [ 9.6515e-02,  9.8736e-02],
         [ 1.1932e-01,  8.6049e-02],
         [ 9.4555e-02,  8.5364e-02],
         [ 1.2353e-01,  1.1663e-01],
         [ 1.3797e-01,  1.0732e-01],
         [ 1.0508e-01,  1.3067e-01],
         [ 1.2609e-01,  1.0504e-01],
         [ 1.0757e-01,  8.6715e-02],
         [ 1.0022e-01,  1.0996e-01],
         [ 1.3455e-01,  9.6584e-02],
         [ 1.4066e-01,  1.0717e-01],
         [ 1.3162e-01,  1.0793e-01],
         [ 1.3845e-01,  7.7202e-02],
         [ 1.4298e-01,  7.2493e-02],
         [ 1.0833e-01,  1.0184e-01],
         [ 1.3219e-01,  7.7052e-02],
         [ 1.4796e-01,  1.7696e-01],
         [ 1.2216e-01, -1.7075e-02],
         [ 1.1143e-01,  1.2334e-01],
         [ 1.2215e-01,  1.5181e-01],
         [ 1.4332e-01,  1.6300e-01],
         [ 1.2056e-01,  1.1553e-01],
         [ 9.4064e-02,  1.0135e-01],
         [ 9.9496e-02,  1.0145e-01],
         [ 1.0317e-01, -6.5109e-02],
         [ 1.0319e-01,  8.5217e-02],
         [ 1.0485e-01, -5.9176e-02],
         [ 1.0517e-01,  8.6492e-02],
         [ 1.3033e-01,  1.2265e-01],
         [ 1.0019e-01,  1.0710e-01],
         [ 1.2240e-01,  1.0243e-01],
         [-5.5779e-02,  9.6051e-02],
         [ 1.3477e-01,  6.3466e-02],
         [ 1.0187e-01,  7.9566e-02],
         [ 1.2417e-01,  5.5513e-02],
         [ 1.5434e-01,  7.7232e-02],
         [ 1.0743e-01,  9.3907e-02],
         [ 1.0294e-01,  9.3360e-02],
         [ 1.1113e-01,  7.3701e-02],
         [ 1.2676e-01,  6.0298e-02],
         [ 1.6209e-01,  6.3234e-02],
         [ 1.5323e-01,  9.5454e-02],
         [ 1.6167e-01,  7.7789e-02],
         [ 1.6836e-01,  1.0884e-01],
         [ 1.3134e-01,  1.0926e-01],
         [ 1.5380e-01,  6.9887e-02],
         [ 1.6571e-01,  8.1627e-02],
         [ 1.5162e-01,  6.2118e-02],
         [ 1.4845e-01,  5.4620e-02],
         [ 1.0752e-01,  8.0493e-02],
         [ 1.2681e-01,  1.1036e-01],
         [ 1.4247e-01,  6.1617e-02],
         [ 1.4781e-01,  6.6640e-02],
         [ 1.1204e-01,  1.0972e-01],
         [ 1.4207e-01,  8.1686e-02],
         [ 1.4843e-01,  8.1275e-02],
         [ 1.6215e-01,  7.7008e-02],
         [ 1.7869e-01,  7.3587e-02],
         [ 1.5282e-01,  7.9914e-02],
         [ 1.6030e-01,  1.2369e-01],
         [ 1.6376e-01,  1.2750e-01],
         [ 1.3191e-01,  8.9051e-02],
         [ 1.5730e-01,  8.2708e-02],
         [ 1.4165e-01,  6.2142e-02],
         [ 1.0788e-01,  5.7694e-02],
         [ 1.3217e-01,  7.5260e-02],
         [ 1.4254e-01,  7.9808e-02],
         [ 1.3868e-01,  1.1031e-01],
         [ 1.2106e-01,  9.3386e-02],
         [ 1.1388e-01,  8.8485e-02],
         [ 1.3693e-01,  6.5543e-02],
         [ 1.2548e-01,  1.1065e-01],
         [ 1.3744e-01,  9.7337e-02],
         [-2.7880e-02,  9.6369e-02],
         [ 1.1731e-02,  9.7769e-02],
         [ 3.2451e-02,  9.7303e-02],
         [ 4.2652e-02,  9.9711e-02],
         [ 4.7360e-02,  5.6902e-02],
         [ 4.9350e-02, -8.6290e-02],
         [ 5.0077e-02,  7.0882e-02],
         [ 5.0260e-02,  6.9613e-02],
         [ 5.0237e-02, -8.2090e-02],
         [ 5.0194e-02,  5.7997e-02],
         [ 5.0129e-02,  9.1984e-02],
         [ 5.0073e-02,  7.7525e-02],
         [ 5.0050e-02,  9.9920e-02],
         [ 5.0032e-02,  7.0477e-02],
         [ 5.0042e-02,  8.3020e-02],
         [ 5.0034e-02,  9.0730e-02],
         [ 5.0034e-02,  7.9712e-02],
         [ 5.0024e-02,  5.0051e-02],
         [ 5.0012e-02,  9.9623e-02],
         [ 5.0007e-02,  1.1556e-01],
         [ 5.0013e-02,  7.8086e-02],
         [ 5.0005e-02,  6.7500e-02],
         [ 5.0006e-02,  5.8099e-02],
         [ 5.0008e-02,  4.0970e-02],
         [ 5.0008e-02,  5.6879e-02],
         [ 5.0008e-02,  7.7172e-02],
         [ 5.0009e-02,  8.2850e-02],
         [ 5.0008e-02,  5.4118e-02],
         [ 5.0008e-02,  7.7317e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.2954e-05, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0007, device='cuda:0')
mixer_td_error tensor(0.5660, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4683, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4711, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0560, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1923, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0459, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2338308., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1787, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.1507e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1430, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1829, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1430, device='cuda:0', grad_fn=<MinBackward1>)
t_env 2839
target_mac_out tensor([[[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6454e-02,  9.8041e-02,  ...,  2.6212e-02,
            1.4254e-01, -1.0000e+07],
          [-1.0000e+07, -6.9791e-02,  1.1912e-01,  ...,  2.3814e-02,
            1.4958e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0073e-01,  1.1228e-01,  ...,  2.1527e-02,
            1.5677e-01, -1.0000e+07],
          [-1.0000e+07, -7.4430e-02,  1.2619e-01,  ...,  2.5142e-02,
            1.4711e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0575e-01,  1.1552e-01,  ...,  5.7407e-02,
            1.7511e-01, -3.2794e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1218e-01,  1.1068e-01,  ...,  5.6260e-02,
            1.7721e-01, -3.2753e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.7746e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3339e-02,  9.6645e-02,  ...,  1.7415e-02,
            1.4616e-01, -1.0000e+07],
          [-1.0000e+07, -3.2135e-02,  1.2998e-01,  ..., -1.6960e-03,
            1.4491e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.8271e-02,  1.0525e-01,  ...,  1.1768e-02,
            1.6624e-01, -1.0000e+07],
          [-1.0000e+07, -3.6496e-02,  1.0583e-01,  ...,  9.2376e-04,
            1.5021e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 3.5195e-02,  1.3755e-01],
         [ 9.8041e-02,  1.1912e-01],
         [ 1.1228e-01,  1.2619e-01],
         [ 7.7923e-02,  7.4658e-02],
         [ 7.7149e-02, -1.0272e-01],
         [-6.9760e-02,  7.2421e-02],
         [ 6.8671e-02,  9.9376e-02],
         [ 9.7684e-02,  6.7386e-02],
         [ 1.1953e-01,  9.4958e-02],
         [ 1.0656e-01,  8.9877e-02],
         [ 1.1094e-01,  1.2454e-01],
         [ 1.0315e-01,  1.3676e-01],
         [ 1.0846e-01,  1.1305e-01],
         [ 1.1109e-01,  9.9956e-02],
         [ 1.0954e-01,  1.3933e-01],
         [ 9.0369e-02,  1.5308e-01],
         [ 7.3179e-02,  1.4767e-01],
         [ 9.6741e-02,  1.2407e-01],
         [ 7.7493e-02,  1.0314e-01],
         [ 9.5068e-02,  1.2607e-01],
         [ 1.0269e-01,  1.4122e-01],
         [ 7.5418e-02,  1.5638e-01],
         [ 8.0872e-02,  1.3731e-01],
         [ 6.6191e-02,  1.5575e-01],
         [ 9.3772e-02,  1.6546e-01],
         [ 9.7946e-02,  1.3939e-01],
         [ 7.6336e-02,  1.6230e-01],
         [ 6.3684e-02,  1.8396e-01],
         [ 7.6300e-02,  1.5706e-01],
         [ 9.5914e-02,  1.5702e-01],
         [ 1.2101e-01,  1.5701e-01],
         [ 1.2505e-01,  1.3683e-01],
         [ 1.2304e-01,  1.2317e-01],
         [ 9.6598e-02, -1.0477e-01],
         [ 5.9940e-02,  1.1218e-01],
         [ 1.0260e-01,  1.3276e-01],
         [ 1.0127e-01, -2.0544e-02],
         [ 1.1849e-01,  2.3882e-02],
         [ 7.8304e-02,  4.3476e-02],
         [ 9.5254e-02,  5.1597e-02],
         [ 1.2028e-01,  5.4689e-02],
         [ 1.2592e-01,  5.5643e-02],
         [ 1.3374e-01,  5.5776e-02],
         [ 9.9172e-02,  5.5666e-02],
         [ 1.1648e-01,  5.5511e-02],
         [ 8.1128e-02,  5.5378e-02],
         [ 1.0117e-01,  5.5285e-02],
         [ 1.0704e-01,  5.5246e-02],
         [ 8.2376e-02,  5.5226e-02],
         [ 9.7130e-02,  5.5235e-02],
         [ 7.6244e-02,  5.5201e-02],
         [ 9.3174e-02,  5.5199e-02],
         [ 6.2377e-02,  5.5208e-02],
         [ 9.1474e-02,  5.5219e-02],
         [ 9.2364e-02,  5.5216e-02],
         [ 8.9643e-02,  5.5218e-02],
         [ 8.6858e-02,  5.5227e-02],
         [ 6.9857e-02,  5.5232e-02],
         [ 6.3970e-02,  5.5230e-02],
         [ 6.1443e-02,  5.5230e-02],
         [-8.5366e-02,  5.5231e-02],
         [ 7.2942e-02,  5.5236e-02],
         [ 9.1229e-02,  5.5235e-02],
         [ 8.9584e-02,  5.5232e-02],
         [ 5.7155e-02,  5.5232e-02],
         [ 8.9402e-02,  5.5231e-02],
         [ 9.9461e-02,  5.5231e-02],
         [ 5.7424e-02,  5.5231e-02],
         [-8.1074e-02,  5.5231e-02],
         [ 8.8782e-02,  5.5231e-02],
         [ 6.4703e-02,  5.5231e-02],
         [ 9.2461e-02,  5.5231e-02],
         [ 1.0406e-01,  5.5231e-02],
         [ 7.9827e-02,  5.5231e-02],
         [ 8.5043e-02,  5.5231e-02],
         [ 9.8500e-02,  5.5231e-02],
         [ 9.2749e-02,  5.5231e-02],
         [ 9.9265e-02,  5.5231e-02],
         [-9.3662e-02,  5.5231e-02],
         [ 9.0556e-02,  5.5231e-02],
         [-8.0988e-02,  5.5231e-02],
         [-6.5458e-02,  5.5231e-02],
         [-5.4783e-02,  5.5231e-02],
         [-4.2284e-02,  5.5231e-02],
         [-3.7984e-02,  5.5231e-02],
         [-4.1981e-02,  5.5231e-02],
         [-6.4957e-02,  5.5231e-02],
         [-6.8494e-02,  5.5231e-02],
         [ 8.9740e-02,  5.5231e-02],
         [-6.4930e-02,  5.5231e-02],
         [-5.2584e-02,  5.5231e-02],
         [-1.6482e-02,  5.5231e-02],
         [-4.8175e-02,  5.5231e-02],
         [-6.2841e-02,  5.5231e-02],
         [-5.0349e-02,  5.5231e-02],
         [-3.7229e-02,  5.5231e-02],
         [-4.9564e-02,  5.5231e-02],
         [ 9.9956e-02,  5.5231e-02],
         [ 1.0379e-01,  5.5231e-02],
         [ 7.9271e-02,  5.5231e-02],
         [-5.8359e-02,  5.5231e-02],
         [-1.9431e-02,  5.5231e-02],
         [-1.8759e-02,  5.5231e-02],
         [-5.2005e-02,  5.5231e-02],
         [ 1.0050e-01,  5.5231e-02],
         [ 1.0505e-01,  5.5231e-02],
         [ 8.1462e-02,  5.5231e-02],
         [-8.3419e-02,  5.5231e-02],
         [-8.6405e-02,  5.5231e-02],
         [-8.5407e-02,  5.5231e-02],
         [-8.0558e-02,  5.5231e-02],
         [ 8.4611e-02,  5.5231e-02],
         [ 8.0456e-02,  5.5231e-02],
         [-7.6547e-02,  5.5231e-02],
         [-7.6282e-02,  5.5231e-02],
         [-2.1377e-02,  5.5231e-02],
         [-2.1971e-02,  5.5231e-02],
         [-4.2730e-02,  5.5231e-02],
         [-3.5601e-02,  5.5231e-02],
         [-3.8748e-02,  5.5231e-02],
         [-8.4820e-03,  5.5231e-02],
         [ 1.4431e-01,  5.5231e-02],
         [-1.3235e-02,  5.5231e-02],
         [ 2.4327e-03,  5.5231e-02],
         [-7.3893e-03,  5.5231e-02],
         [-4.5372e-02,  5.5231e-02],
         [-5.7264e-02,  5.5231e-02],
         [ 9.4135e-02,  5.5231e-02],
         [ 8.8269e-02,  5.5231e-02],
         [ 9.6672e-02,  5.5231e-02],
         [ 8.6924e-02,  5.5231e-02],
         [-9.0396e-02,  5.5231e-02],
         [-7.0770e-02,  5.5231e-02],
         [-7.1266e-02,  5.5231e-02],
         [-7.6003e-02,  5.5231e-02],
         [-7.9034e-02,  5.5231e-02],
         [ 8.4931e-02,  5.5231e-02],
         [-3.6010e-02,  5.5231e-02],
         [-3.1493e-02,  5.5231e-02],
         [-3.0247e-02,  5.5231e-02],
         [-3.6103e-02,  5.5231e-02],
         [-5.9124e-02,  5.5231e-02],
         [ 9.9114e-02,  5.5231e-02],
         [ 1.2684e-01,  5.5231e-02],
         [ 1.2884e-01,  5.5231e-02],
         [ 7.9658e-02,  5.5231e-02],
         [ 7.4630e-02,  5.5231e-02],
         [ 9.5625e-02,  5.5231e-02],
         [ 1.1897e-01,  5.5231e-02],
         [ 9.5412e-02,  5.5231e-02],
         [-6.6594e-02,  5.5231e-02],
         [-7.5006e-02,  5.5231e-02],
         [ 8.8743e-02,  5.5231e-02],
         [ 9.8603e-02,  5.5231e-02],
         [ 1.2415e-01,  5.5231e-02],
         [ 1.3547e-01,  5.5231e-02],
         [ 1.3105e-01,  5.5231e-02],
         [ 1.3519e-01,  5.5231e-02],
         [ 9.3583e-02,  5.5231e-02],
         [ 1.1483e-01,  5.5231e-02],
         [ 1.1990e-01,  5.5231e-02],
         [ 1.1759e-01,  5.5231e-02],
         [ 1.1518e-01,  5.5231e-02],
         [ 1.4205e-01,  5.5231e-02],
         [ 1.0749e-01,  5.5231e-02],
         [ 1.4153e-01,  5.5231e-02],
         [ 1.0763e-01,  5.5231e-02],
         [ 9.2709e-02,  5.5231e-02],
         [ 1.3073e-01,  5.5231e-02],
         [ 1.2880e-01,  5.5231e-02],
         [ 1.3816e-01,  5.5231e-02],
         [ 1.4230e-01,  5.5231e-02],
         [ 1.1640e-01,  5.5231e-02],
         [ 1.2042e-01,  5.5231e-02],
         [ 1.1552e-01,  5.5231e-02],
         [ 1.1068e-01,  5.5231e-02],
         [ 2.7746e-03,  5.5231e-02]],

        [[ 9.4778e-02,  1.0692e-01],
         [ 9.6645e-02,  1.2998e-01],
         [ 1.0525e-01,  1.0583e-01],
         [ 1.1486e-01,  1.1824e-01],
         [ 8.0685e-02, -4.8004e-02],
         [ 4.3501e-02, -4.6541e-02],
         [ 3.7996e-02,  1.1912e-01],
         [-8.5009e-02,  1.2034e-01],
         [ 9.6026e-02,  1.4157e-01],
         [ 1.0928e-01,  1.5234e-01],
         [ 8.5666e-02,  1.6066e-01],
         [ 7.4620e-02,  1.6676e-01],
         [ 9.5709e-02,  1.6929e-01],
         [ 6.5781e-02,  1.2703e-01],
         [ 9.9529e-02,  1.1151e-01],
         [-6.8688e-02,  1.2190e-01],
         [ 9.5130e-02,  1.5786e-01],
         [-1.0489e-01,  1.4298e-01],
         [ 1.0364e-01,  9.1105e-02],
         [ 1.1222e-01,  1.1424e-01],
         [ 1.2727e-01,  1.1902e-01],
         [ 1.1032e-01,  7.8172e-02],
         [ 1.3626e-01,  1.0312e-01],
         [ 1.4267e-01,  1.5298e-01],
         [ 1.4227e-01,  1.4244e-01],
         [ 1.1605e-01,  1.3980e-01],
         [-1.4011e-01,  1.2507e-01],
         [ 1.1123e-01,  1.4591e-01],
         [ 6.3300e-02,  1.3294e-01],
         [ 1.1639e-01,  1.4758e-01],
         [ 6.9844e-02,  1.5953e-01],
         [ 4.0934e-02,  1.3253e-01],
         [ 1.1472e-01,  1.2393e-01],
         [ 6.8271e-02,  1.4544e-01],
         [ 4.1434e-02,  1.2213e-01],
         [ 9.4309e-02, -1.3676e-01],
         [ 1.0435e-01,  6.9326e-04],
         [ 8.2546e-02,  2.8621e-02],
         [ 9.2743e-02,  4.3060e-02],
         [ 9.6796e-02,  4.9973e-02],
         [ 8.5672e-02,  5.3064e-02],
         [ 8.3281e-02,  5.4390e-02],
         [ 6.2906e-02,  5.4954e-02],
         [ 1.2820e-01,  5.5160e-02],
         [ 8.9200e-02,  5.5232e-02],
         [ 1.0279e-01,  5.5230e-02],
         [ 1.2032e-01,  5.5213e-02],
         [ 9.8441e-02,  5.5218e-02],
         [ 1.1997e-01,  5.5222e-02],
         [ 1.2656e-01,  5.5225e-02],
         [ 1.1176e-01,  5.5229e-02],
         [ 9.1520e-02,  5.5207e-02],
         [ 3.5573e-02,  5.5213e-02],
         [ 3.7763e-02,  5.5217e-02],
         [-2.3455e-01,  5.5216e-02],
         [ 7.8485e-02,  5.5221e-02],
         [ 5.8178e-02,  5.5223e-02],
         [ 5.1467e-02,  5.5232e-02],
         [-4.8677e-03,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.3738e-05, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0018, device='cuda:0')
mixer_td_error tensor(0.8341, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4690, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8291, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0617, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1808, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0346, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3333333., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1840, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.4970e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0015, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1030, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2998, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1030, device='cuda:0', grad_fn=<MinBackward1>)
t_env 2888
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5898e-02,  1.0054e-01,  ...,  4.1830e-02,
            1.6437e-01, -1.0000e+07],
          [-1.0000e+07, -3.7039e-02,  1.0473e-01,  ..., -3.1371e-02,
            1.3582e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.9098e-01,  8.2850e-02,  ...,  9.2807e-02,
            2.2962e-01, -3.3740e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6709e-01,  5.4118e-02,  ...,  5.6809e-02,
            2.0959e-01, -3.2237e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 7.7317e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0799e-01,  1.0994e-01,  ...,  4.2512e-02,
            1.4205e-01, -1.0000e+07],
          [-1.0000e+07, -4.1562e-02,  1.2343e-01,  ...,  1.2672e-02,
            1.4219e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3438e-01,  9.7930e-02,  ...,  1.1659e-02,
            1.6183e-01, -1.0000e+07],
          [-1.0000e+07, -4.3874e-02,  1.2534e-01,  ...,  1.1010e-03,
            1.3669e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02, -1.3772e-02],
         [-6.7838e-02, -1.4399e-02],
         [ 1.0054e-01, -3.7039e-02],
         [-7.0085e-02,  1.2846e-01],
         [-7.7645e-02, -4.2822e-02],
         [-7.2394e-02, -5.5130e-02],
         [ 1.1932e-01, -5.9508e-02],
         [-5.3548e-02, -4.2156e-02],
         [ 1.2353e-01, -4.9623e-02],
         [ 1.3797e-01, -4.2605e-02],
         [-7.3692e-02,  1.3067e-01],
         [-5.6930e-02, -4.3597e-02],
         [-4.0191e-02, -4.3882e-02],
         [-2.6975e-02, -3.8959e-02],
         [-4.4754e-02, -1.8133e-02],
         [-4.1412e-02, -4.4225e-02],
         [-4.2788e-02, -5.5343e-02],
         [-3.9149e-02, -6.6556e-02],
         [-3.7854e-02, -6.2646e-02],
         [-3.3808e-02, -6.0677e-02],
         [-3.4720e-02, -6.2139e-02],
         [ 1.4796e-01, -6.5015e-02],
         [ 1.2216e-01, -1.7075e-02],
         [ 1.1143e-01, -8.4041e-04],
         [-3.7000e-02,  1.5181e-01],
         [ 1.4332e-01,  1.6300e-01],
         [-5.8460e-02,  1.1553e-01],
         [-4.9790e-02, -6.6652e-02],
         [-5.9718e-02,  1.0145e-01],
         [-6.2740e-02, -6.5109e-02],
         [-7.6109e-02, -7.2763e-02],
         [-9.2419e-02, -5.9176e-02],
         [ 1.0517e-01, -7.1048e-02],
         [-6.1418e-02,  1.2265e-01],
         [-8.0862e-02, -5.8653e-02],
         [-5.6284e-02,  1.0243e-01],
         [-5.5779e-02,  9.6051e-02],
         [-4.7365e-02, -7.9570e-02],
         [-7.4199e-02, -7.9416e-02],
         [-5.3724e-02, -7.3383e-02],
         [ 1.5434e-01, -9.3775e-02],
         [-8.3508e-02, -3.1132e-02],
         [ 1.0294e-01, -5.0785e-02],
         [-5.5325e-02, -7.4617e-02],
         [-4.3668e-02, -8.1379e-02],
         [ 1.6209e-01, -7.3483e-02],
         [ 1.5323e-01, -7.7779e-02],
         [ 1.6167e-01, -7.5059e-02],
         [ 1.6836e-01,  1.0884e-01],
         [ 1.3134e-01,  1.0926e-01],
         [ 1.5380e-01, -1.0109e-01],
         [ 1.6571e-01,  8.1627e-02],
         [ 1.5162e-01, -1.1236e-01],
         [ 1.4845e-01, -1.0807e-01],
         [ 1.0752e-01,  8.0493e-02],
         [ 1.2681e-01,  1.1036e-01],
         [ 1.4247e-01,  6.1617e-02],
         [ 1.4781e-01, -1.0538e-01],
         [ 1.1204e-01,  1.0972e-01],
         [ 1.4207e-01,  8.1686e-02],
         [ 1.4843e-01,  4.5776e-02],
         [ 1.6215e-01,  7.7008e-02],
         [ 1.7869e-01,  7.3587e-02],
         [ 1.5282e-01,  7.9914e-02],
         [ 1.6030e-01,  1.2369e-01],
         [ 1.6376e-01,  1.2750e-01],
         [ 1.3191e-01,  7.2110e-02],
         [ 1.5730e-01,  8.2708e-02],
         [ 1.4165e-01,  6.2142e-02],
         [ 1.0788e-01,  5.7694e-02],
         [ 1.3217e-01,  7.5260e-02],
         [ 1.4254e-01,  7.9808e-02],
         [ 1.3868e-01,  1.1031e-01],
         [-1.5483e-01,  9.3386e-02],
         [ 6.2445e-02,  8.8485e-02],
         [ 1.3693e-01, -1.1343e-01],
         [-1.4815e-01,  1.1065e-01],
         [ 1.3744e-01,  9.7337e-02],
         [-2.7880e-02,  9.6369e-02],
         [ 1.1731e-02,  9.7769e-02],
         [ 3.2451e-02,  9.7303e-02],
         [ 4.2652e-02,  9.9711e-02],
         [ 4.7360e-02, -9.8532e-02],
         [ 4.9350e-02, -8.6290e-02],
         [ 5.0077e-02, -1.0153e-01],
         [ 5.0260e-02, -1.0161e-01],
         [ 5.0237e-02, -8.2090e-02],
         [ 5.0194e-02, -8.3019e-02],
         [ 5.0129e-02,  9.1984e-02],
         [ 5.0073e-02,  7.7525e-02],
         [ 5.0050e-02,  9.9920e-02],
         [ 5.0032e-02,  7.0477e-02],
         [ 5.0042e-02,  8.3020e-02],
         [ 5.0034e-02,  9.0730e-02],
         [ 5.0034e-02,  7.9712e-02],
         [ 5.0024e-02,  5.0051e-02],
         [ 5.0012e-02,  9.9623e-02],
         [ 5.0007e-02,  1.1556e-01],
         [ 5.0013e-02,  7.8086e-02],
         [ 5.0005e-02,  6.7500e-02],
         [ 5.0006e-02, -1.7315e-01],
         [ 5.0008e-02, -1.5965e-01],
         [ 5.0008e-02, -1.5086e-01],
         [ 5.0008e-02,  7.7172e-02],
         [ 5.0009e-02,  8.2850e-02],
         [ 5.0008e-02, -1.6709e-01],
         [ 5.0008e-02,  7.7317e-03]],

        [[ 1.0780e-01, -1.6811e-02],
         [ 1.0994e-01,  1.2343e-01],
         [ 9.7930e-02, -4.3874e-02],
         [ 1.0625e-01,  1.3966e-01],
         [ 1.1269e-01,  1.4718e-01],
         [ 3.2212e-02,  1.4742e-01],
         [-1.0930e-01,  1.0735e-01],
         [ 1.2266e-01, -7.2884e-02],
         [ 1.4349e-01, -7.6688e-02],
         [ 1.3349e-01,  1.1534e-01],
         [ 1.4140e-01,  1.5677e-01],
         [ 1.4851e-01,  1.0557e-01],
         [ 1.4070e-01, -8.8427e-02],
         [ 1.5193e-01, -7.7269e-02],
         [ 1.6019e-01, -7.7716e-02],
         [ 1.3743e-01, -6.5687e-02],
         [ 7.0706e-02,  1.1829e-01],
         [ 7.1781e-02, -8.2964e-02],
         [ 6.7781e-02,  1.2517e-01],
         [ 1.5386e-01,  9.8218e-02],
         [ 6.4585e-02, -9.7851e-02],
         [ 1.5643e-01,  1.1507e-01],
         [ 1.6528e-01, -1.0069e-01],
         [ 1.6542e-01,  1.3441e-01],
         [ 1.6946e-01, -1.1028e-01],
         [-8.5710e-03, -8.2824e-02],
         [ 2.0147e-02, -6.9538e-02],
         [ 3.6399e-02, -7.5921e-02],
         [ 4.4441e-02, -6.2365e-02],
         [ 4.8131e-02, -7.8547e-02],
         [ 4.9595e-02, -7.3254e-02],
         [ 5.0121e-02, -6.7328e-02],
         [ 5.0214e-02, -5.7440e-02],
         [ 5.0189e-02, -5.5234e-02],
         [ 5.0129e-02, -5.4974e-02],
         [ 5.0072e-02, -3.9688e-02],
         [ 5.0047e-02, -1.7821e-03],
         [ 5.0023e-02,  5.5546e-03],
         [ 5.0026e-02, -1.5447e-02],
         [ 5.0031e-02, -4.4415e-02],
         [ 5.0021e-02, -3.4436e-02],
         [ 5.0018e-02, -5.0084e-02],
         [ 5.0009e-02, -5.0979e-02],
         [ 5.0017e-02, -6.7211e-02],
         [ 5.0022e-02, -5.9878e-02],
         [ 5.0015e-02, -6.4159e-02],
         [ 5.0006e-02, -7.7342e-02],
         [ 5.0007e-02, -2.5247e-02],
         [ 5.0007e-02, -9.8839e-03],
         [ 5.0008e-02, -4.2000e-02],
         [ 5.0008e-02, -3.2936e-02],
         [ 5.0008e-02, -3.2373e-02],
         [ 5.0008e-02, -3.5115e-02],
         [ 5.0008e-02, -3.7828e-02],
         [ 5.0008e-02, -5.1359e-03],
         [ 5.0008e-02,  1.4415e-01],
         [ 5.0008e-02,  1.6120e-01],
         [ 5.0009e-02,  6.5308e-03],
         [ 5.0009e-02,  5.4792e-03],
         [ 5.0009e-02, -1.5851e-02],
         [ 5.0009e-02, -5.1729e-03],
         [ 5.0009e-02, -8.4784e-03],
         [ 5.0009e-02,  2.3201e-03],
         [ 5.0009e-02, -1.5290e-02],
         [ 5.0009e-02, -2.5984e-02],
         [ 5.0009e-02, -3.2550e-02],
         [ 5.0009e-02, -5.2805e-02],
         [ 5.0009e-02, -6.6105e-02],
         [ 5.0009e-02, -5.5886e-02],
         [ 5.0009e-02,  1.0572e-01],
         [ 5.0009e-02, -1.0803e-01],
         [ 5.0009e-02, -1.1816e-01],
         [ 5.0009e-02, -1.2414e-01],
         [ 5.0009e-02, -1.1472e-01],
         [ 5.0009e-02,  7.2448e-02],
         [ 5.0009e-02,  1.0636e-01],
         [ 5.0009e-02,  1.0683e-01],
         [ 5.0009e-02,  5.9114e-02],
         [ 5.0009e-02,  8.4279e-02],
         [ 5.0009e-02,  7.6117e-02],
         [ 5.0009e-02,  6.8341e-02],
         [ 5.0009e-02, -1.1995e-01],
         [ 5.0009e-02,  7.3401e-02],
         [ 5.0009e-02,  8.4969e-02],
         [ 5.0009e-02,  1.0764e-01],
         [ 5.0009e-02,  1.1552e-01],
         [ 5.0009e-02,  1.2484e-01],
         [ 5.0009e-02,  1.0097e-01],
         [ 5.0009e-02,  9.1539e-02],
         [ 5.0009e-02, -1.5423e-01],
         [ 5.0009e-02, -1.5107e-01],
         [ 5.0009e-02,  6.7593e-02],
         [ 5.0009e-02,  8.5541e-02],
         [ 5.0009e-02,  6.8927e-02],
         [ 5.0009e-02, -1.6810e-01],
         [ 5.0009e-02,  7.7653e-02],
         [ 5.0009e-02, -1.6583e-01],
         [ 5.0009e-02, -1.5896e-01],
         [ 5.0009e-02,  2.1483e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.7022e-05, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0017, device='cuda:0')
mixer_td_error tensor(0.1318, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4681, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5397, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0654, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1784, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0366, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-373831.6875, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1787, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.7263e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0009, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1304, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2523, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1304, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3006
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2225e-02,  6.2394e-02,  ...,  2.0084e-02,
            1.2912e-01, -1.0000e+07],
          [-1.0000e+07, -7.7190e-02,  1.6041e-01,  ...,  7.2365e-02,
            1.5573e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.0171e-02,  4.6061e-02,  ...,  4.1223e-02,
            1.3816e-01, -1.0000e+07],
          [-1.0000e+07, -1.2417e-01,  1.0542e-01,  ...,  6.0142e-02,
            1.7534e-01, -1.0000e+07]],

         ...,

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3740e-01,  4.1005e-02,  ...,  3.3463e-02,
            2.0037e-01, -1.0000e+07]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.2245e-01,  2.2864e-02,  ...,  1.2143e-02,
            1.9666e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.2287e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2667e-02,  6.8683e-02,  ..., -1.4773e-02,
            1.4253e-01, -1.0000e+07],
          [-1.0000e+07, -2.4958e-02,  1.1569e-01,  ...,  9.4168e-03,
            1.4551e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.6312e-02,  9.9102e-02,  ..., -2.8211e-02,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -3.4892e-02,  6.9462e-02,  ...,  3.2838e-02,
            1.5555e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.9256e-02,  1.4162e-01],
         [-6.2225e-02,  1.6041e-01],
         [-5.0171e-02, -1.2417e-01],
         [-5.5750e-02,  9.9757e-02],
         [-6.0333e-02,  1.0032e-01],
         [-4.5322e-02,  1.1083e-01],
         [-5.4950e-02,  8.8379e-02],
         [-7.1698e-02, -1.9488e-01],
         [-8.9908e-02, -1.6529e-01],
         [-8.8833e-02,  7.0947e-02],
         [-8.6353e-02, -1.5952e-01],
         [-9.3121e-02,  6.7105e-02],
         [-1.0690e-01, -1.0543e-01],
         [-1.1034e-01, -8.6728e-02],
         [-1.2086e-01, -7.3845e-02],
         [ 1.0957e-01,  1.4163e-01],
         [-1.1353e-01,  1.5074e-01],
         [ 1.0969e-01, -1.1008e-01],
         [ 1.1634e-01, -9.6470e-02],
         [-1.1104e-01, -1.1788e-01],
         [-9.6136e-02, -9.7966e-02],
         [-8.1049e-02, -9.0314e-02],
         [-6.6191e-02, -8.6038e-02],
         [-8.5934e-02, -9.1300e-02],
         [-7.0868e-02, -8.2171e-02],
         [-9.1293e-02, -9.2198e-02],
         [-8.4688e-02, -8.6714e-02],
         [-8.0745e-02,  1.3790e-01],
         [-8.2549e-02, -1.0604e-01],
         [ 1.2564e-01, -1.2388e-01],
         [ 1.3462e-01, -1.3454e-01],
         [-7.9059e-02, -1.0901e-01],
         [-6.8257e-02, -1.0784e-01],
         [-6.2877e-02,  1.2915e-01],
         [-7.9941e-02, -1.0942e-01],
         [-6.9004e-02, -1.1358e-01],
         [-6.1038e-02, -9.8990e-02],
         [-4.6700e-02, -8.5677e-02],
         [-4.0838e-02, -9.0660e-02],
         [-4.2937e-02, -7.3351e-02],
         [-6.2249e-02, -6.9499e-02],
         [-6.9709e-02, -6.8537e-02],
         [ 1.5098e-01, -7.3024e-02],
         [-6.8878e-02,  1.1886e-01],
         [ 1.4630e-01, -9.4505e-02],
         [-6.1602e-02, -8.3677e-02],
         [-7.2736e-02, -9.3405e-02],
         [-6.3625e-02, -8.2644e-02],
         [-5.7862e-02, -8.0513e-02],
         [-6.1121e-02, -8.8742e-02],
         [-4.8498e-02, -8.1731e-02],
         [-5.2068e-02, -7.8955e-02],
         [-4.6674e-02, -8.0622e-02],
         [-5.3021e-02, -6.9637e-02],
         [ 1.3654e-01, -1.0627e-01],
         [ 1.4457e-01, -1.1495e-01],
         [-7.6806e-02, -1.3333e-01],
         [ 1.3258e-01, -1.4517e-01],
         [-7.6624e-02, -1.2105e-01],
         [ 1.3642e-01, -1.1305e-01],
         [ 1.4824e-01, -1.0185e-01],
         [ 1.5449e-01, -1.0816e-01],
         [ 1.5433e-01,  9.7028e-02],
         [ 1.7276e-01,  1.2470e-01],
         [ 1.7542e-01, -1.3494e-01],
         [ 1.5339e-01,  1.2617e-01],
         [ 1.7310e-01,  8.8818e-02],
         [ 1.9181e-01,  1.2856e-01],
         [ 1.4465e-01, -1.5636e-01],
         [ 1.4087e-01, -1.4369e-01],
         [ 1.2356e-01,  9.4826e-02],
         [ 1.5315e-01,  1.0419e-01],
         [ 1.6759e-01,  1.1759e-01],
         [ 1.7295e-01,  1.0442e-01],
         [ 1.8473e-01, -1.6753e-01],
         [ 1.5782e-01, -1.6418e-01],
         [ 1.3241e-01, -1.4819e-01],
         [ 1.6038e-01, -1.4315e-01],
         [ 1.3231e-01, -1.3339e-01],
         [ 1.6362e-01, -1.4066e-01],
         [ 1.7874e-01,  9.3304e-02],
         [ 1.8657e-01,  1.4008e-01],
         [ 1.9861e-01,  1.6050e-01],
         [ 1.5093e-01,  1.5866e-01],
         [ 3.7360e-03,  1.4849e-01],
         [ 2.4588e-02,  1.4539e-01],
         [ 3.7796e-02,  1.4573e-01],
         [ 4.4747e-02,  1.5611e-01],
         [ 4.8003e-02, -5.4810e-02],
         [ 4.9379e-02,  1.4921e-01],
         [ 4.9888e-02,  1.5403e-01],
         [ 5.0033e-02,  1.7582e-01],
         [ 5.0053e-02, -5.2941e-02],
         [ 5.0057e-02, -3.8881e-02],
         [ 5.0038e-02,  1.4044e-01],
         [ 5.0012e-02,  1.5908e-01],
         [ 5.0025e-02, -4.1979e-02],
         [ 5.0015e-02,  1.4436e-01],
         [ 5.0025e-02,  1.5183e-01],
         [ 5.0020e-02,  1.6311e-01],
         [ 5.0021e-02,  1.8162e-01],
         [ 5.0018e-02, -9.2120e-02],
         [ 5.0025e-02,  1.0133e-01],
         [ 5.0018e-02, -1.4719e-01],
         [ 5.0009e-02, -1.5709e-01],
         [ 5.0019e-02, -1.5732e-01],
         [ 5.0005e-02, -1.4853e-01],
         [ 5.0007e-02, -1.6434e-01],
         [ 5.0008e-02,  9.7635e-02],
         [ 5.0008e-02, -1.5611e-01],
         [ 5.0008e-02, -1.3327e-01],
         [ 5.0009e-02, -1.4981e-01],
         [ 5.0008e-02, -1.4467e-01],
         [ 5.0008e-02, -1.6552e-01],
         [ 5.0008e-02, -1.5647e-01],
         [ 5.0008e-02, -1.3740e-01],
         [ 5.0008e-02, -1.2245e-01],
         [ 5.0009e-02,  1.2287e-02]],

        [[-5.8723e-02,  1.2843e-01],
         [-7.2667e-02, -2.4958e-02],
         [-4.6312e-02, -3.4892e-02],
         [-4.8901e-02, -1.7211e-02],
         [-1.0635e-02, -4.7126e-02],
         [-1.2266e-02, -3.6487e-02],
         [-4.2670e-02, -3.4362e-02],
         [-2.0817e-02, -3.6218e-02],
         [-5.1670e-02, -1.7604e-02],
         [-1.0594e-02, -8.0928e-03],
         [-3.0510e-02, -1.8584e-02],
         [-4.7370e-02, -3.6150e-02],
         [-6.8687e-02, -6.6748e-02],
         [-8.6102e-02, -5.4387e-02],
         [-8.6140e-02, -5.7347e-02],
         [-1.0438e-01, -4.6140e-02],
         [-9.6649e-02, -4.1568e-02],
         [-1.0959e-01, -3.6987e-02],
         [-9.8761e-02, -6.7402e-02],
         [-1.1087e-01, -5.5455e-02],
         [-7.0388e-02, -5.9717e-02],
         [-5.0910e-02, -8.2232e-02],
         [-1.9454e-02, -7.8604e-02],
         [-2.3823e-02, -8.4362e-02],
         [-5.0746e-03, -8.8680e-02],
         [-1.6921e-02, -7.2498e-02],
         [-1.7174e-03, -7.1065e-02],
         [-5.2368e-02, -8.0032e-02],
         [-8.9912e-02,  1.5898e-01],
         [ 1.1590e-01, -1.0261e-01],
         [-1.2998e-01,  1.4915e-01],
         [ 1.2539e-01,  1.5150e-01],
         [-1.5081e-01, -1.2757e-01],
         [-1.2441e-01, -1.1667e-01],
         [-1.0931e-01, -1.6417e-01],
         [-8.3859e-02, -1.9130e-01],
         [-1.1636e-01, -1.5881e-01],
         [ 1.0707e-01, -1.4077e-01],
         [ 1.2051e-01, -1.3040e-01],
         [-1.2758e-01, -1.1708e-01],
         [ 1.2855e-01, -1.2206e-01],
         [-9.3238e-02, -1.2050e-01],
         [-6.7907e-02,  1.6469e-01],
         [ 1.6354e-01, -1.1263e-01],
         [-4.7384e-02,  1.7266e-01],
         [ 1.7642e-01,  1.7662e-01],
         [ 1.8342e-01, -1.0310e-01],
         [ 1.8108e-01, -9.4633e-02],
         [ 1.8409e-01, -1.0346e-01],
         [-8.3726e-02, -1.0211e-02],
         [-1.1473e-01,  3.0220e-02],
         [ 1.2158e-01,  4.7160e-02],
         [ 1.3106e-01,  5.3579e-02],
         [ 1.8318e-01,  5.5623e-02],
         [-9.9109e-02,  5.6042e-02],
         [ 1.2981e-01,  5.5897e-02],
         [ 1.2657e-01,  5.5668e-02],
         [-1.5253e-01,  5.5474e-02],
         [-1.5377e-01,  5.5334e-02],
         [-1.2465e-01,  5.5253e-02],
         [-8.9363e-02,  5.5217e-02],
         [-1.3068e-01,  5.5220e-02],
         [-1.2678e-01,  5.5206e-02],
         [-1.1589e-01,  5.5202e-02],
         [-1.0630e-01,  5.5193e-02],
         [ 9.5423e-02,  5.5210e-02],
         [ 1.1010e-01,  5.5210e-02],
         [ 1.1495e-01,  5.5212e-02],
         [ 1.3005e-01,  5.5224e-02],
         [ 1.3813e-01,  5.5221e-02],
         [ 1.3502e-01,  5.5231e-02],
         [ 1.2256e-01,  5.5230e-02],
         [ 1.7090e-01,  5.5229e-02],
         [ 1.3864e-01,  5.5231e-02],
         [-1.5666e-01,  5.5236e-02],
         [ 1.0167e-01,  5.5235e-02],
         [-1.5074e-01,  5.5232e-02],
         [ 1.0483e-01,  5.5232e-02],
         [ 1.0882e-01,  5.5231e-02],
         [ 1.0570e-01,  5.5231e-02],
         [-1.6790e-01,  5.5231e-02],
         [ 9.5856e-02,  5.5231e-02],
         [-1.5476e-01,  5.5231e-02],
         [ 1.7330e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.3303e-05, device='cuda:0') tensor(0.0008, device='cuda:0') tensor(-0.0007, device='cuda:0')
mixer_td_error tensor(0.3686, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4760, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3220, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0554, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1897, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0438, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1440677.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1986, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.4495e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1474, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2721, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1474, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3068
target_mac_out tensor([[[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0955e-02,  9.6376e-02,  ...,  2.6399e-02,
            1.4271e-01, -1.0000e+07],
          [-1.0000e+07, -7.2934e-02,  1.5417e-01,  ...,  4.7811e-02,
            1.4808e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9898e-02,  9.7346e-02,  ...,  3.7622e-02,
            1.3495e-01, -1.0000e+07],
          [-1.0000e+07, -9.4199e-02,  1.6448e-01,  ...,  6.6080e-02,
            1.6480e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.5027e-02,  7.1936e-02,  ..., -3.0500e-03,
            1.2911e-01, -1.0000e+07],
          [-1.0000e+07, -2.2961e-02,  9.6708e-02,  ..., -2.0494e-02,
            1.3243e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.1139e-02,  8.5369e-02,  ...,  1.4716e-02,
            1.3164e-01, -1.0000e+07],
          [-1.0000e+07, -3.0575e-02,  9.4245e-02,  ..., -4.3856e-02,
            1.3745e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.9938e-01,  1.0586e-01,  ...,  4.4793e-02,
            1.6853e-01, -3.1699e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.8366e-01,  7.2695e-02,  ...,  4.2428e-02,
            1.5227e-01, -3.1359e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.6262e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.5201e-02,  1.3755e-01],
         [-8.0955e-02,  1.5417e-01],
         [-6.9898e-02,  1.6448e-01],
         [-6.2988e-02,  1.4766e-01],
         [-7.7435e-02,  1.2920e-01],
         [ 1.0831e-01, -1.3528e-01],
         [ 1.1660e-01,  1.4743e-01],
         [-1.1152e-01,  1.4078e-01],
         [-5.5358e-02,  1.2401e-01],
         [-3.7455e-02,  1.2858e-01],
         [-2.4242e-04,  8.6265e-02],
         [-7.3571e-03, -1.7927e-01],
         [ 1.8912e-01, -1.4021e-01],
         [ 1.9365e-01,  1.5525e-01],
         [ 1.6473e-01, -1.1774e-01],
         [ 1.9475e-01, -1.1238e-01],
         [ 2.0430e-01, -1.0218e-01],
         [ 2.0710e-01, -1.0411e-01],
         [ 2.0622e-01, -1.0046e-01],
         [ 2.0540e-01, -1.0403e-01],
         [ 1.6877e-01, -9.7332e-02],
         [ 1.9299e-01, -8.6802e-02],
         [ 1.8386e-01,  1.2791e-02],
         [-1.0019e-02,  3.5265e-02],
         [-1.0523e-02,  4.6792e-02],
         [ 1.7613e-01,  5.2026e-02],
         [ 1.7778e-01,  5.4247e-02],
         [ 1.8460e-01,  5.5083e-02],
         [ 1.8261e-01,  5.5339e-02],
         [ 1.8929e-01,  5.5368e-02],
         [-5.9682e-02,  5.5319e-02],
         [-8.9486e-02,  5.5268e-02],
         [-5.8368e-02,  5.5239e-02],
         [ 1.5620e-01,  5.5226e-02],
         [-7.3063e-02,  5.5231e-02],
         [-9.4142e-02,  5.5218e-02],
         [ 1.0655e-01,  5.5201e-02],
         [-1.0918e-01,  5.5207e-02],
         [-1.1718e-01,  5.5230e-02],
         [-1.0752e-01,  5.5228e-02],
         [ 1.1460e-01,  5.5216e-02],
         [ 1.2720e-01,  5.5223e-02],
         [ 1.4698e-01,  5.5224e-02],
         [ 1.5251e-01,  5.5232e-02],
         [ 1.3471e-01,  5.5230e-02],
         [ 9.5838e-02,  5.5230e-02],
         [ 1.1939e-01,  5.5231e-02],
         [ 9.6160e-02,  5.5236e-02],
         [ 8.7419e-02,  5.5235e-02],
         [ 1.1107e-01,  5.5232e-02],
         [ 7.2747e-02,  5.5232e-02],
         [ 9.9782e-02,  5.5231e-02],
         [ 7.1585e-02,  5.5231e-02],
         [ 9.9215e-02,  5.5231e-02],
         [ 1.1021e-01,  5.5231e-02],
         [ 1.1982e-01,  5.5231e-02],
         [ 1.1571e-01,  5.5231e-02],
         [ 1.1520e-01,  5.5231e-02],
         [ 9.6986e-02,  5.5231e-02],
         [ 1.0128e-01,  5.5231e-02],
         [ 8.7559e-02,  5.5231e-02],
         [ 1.6079e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-4.2377e-02, -1.1096e-02],
         [-5.5027e-02, -2.2961e-02],
         [-4.1139e-02, -3.0575e-02],
         [-3.2662e-02, -4.3250e-02],
         [-4.2330e-02, -3.3436e-02],
         [-2.3718e-02, -4.0629e-02],
         [-5.8590e-02, -4.0934e-02],
         [-8.4974e-02, -2.9617e-02],
         [ 1.3067e-01, -2.9218e-02],
         [ 1.5041e-01, -2.3082e-02],
         [ 1.6852e-01, -1.5386e-02],
         [-2.0264e-02, -8.4988e-03],
         [-2.5192e-02, -3.7857e-02],
         [-6.2545e-03, -4.0398e-02],
         [ 1.5086e-02, -4.7884e-02],
         [-1.8821e-02, -3.0138e-02],
         [-6.0220e-02, -1.4213e-02],
         [-4.9873e-02, -1.2104e-02],
         [-3.0518e-02, -2.5654e-02],
         [-3.3560e-02, -1.8829e-02],
         [-3.7333e-02, -3.2817e-03],
         [-6.9114e-02, -6.3185e-03],
         [-7.3922e-02, -3.1255e-02],
         [-8.7049e-02, -1.8565e-02],
         [-5.4217e-02, -1.1027e-02],
         [-1.9287e-02, -1.1783e-02],
         [-2.2817e-02, -3.9562e-02],
         [ 1.7741e-01, -3.0440e-02],
         [ 1.7950e-01, -4.7343e-02],
         [ 1.7848e-01, -6.4394e-02],
         [-2.2659e-02, -5.7749e-02],
         [ 1.6343e-01, -4.7370e-02],
         [ 1.8144e-01, -2.5316e-02],
         [-7.4753e-02, -1.4975e-02],
         [-7.1515e-02, -2.7384e-02],
         [-9.6875e-02,  1.4873e-01],
         [-8.2046e-02, -3.6629e-02],
         [-1.0228e-01, -4.5060e-02],
         [-8.1084e-02,  1.5129e-01],
         [-8.3552e-02, -4.4975e-02],
         [ 1.3091e-01, -3.3770e-02],
         [-4.4299e-02, -7.3258e-02],
         [ 1.5403e-01, -8.9202e-02],
         [ 1.6515e-01,  9.9281e-02],
         [ 1.7729e-01, -6.3383e-02],
         [ 1.7978e-01, -4.4041e-02],
         [-7.5821e-02, -3.3466e-02],
         [-9.8260e-02, -4.6174e-02],
         [ 1.2853e-01, -5.2444e-02],
         [ 1.4989e-01, -6.0776e-02],
         [ 1.6592e-01, -5.4466e-02],
         [-7.7386e-02,  1.4419e-01],
         [-5.8726e-02,  1.6298e-01],
         [ 1.5526e-01,  1.6761e-01],
         [ 1.6354e-01,  1.3651e-01],
         [-1.1235e-01,  1.6277e-01],
         [ 1.3145e-01,  1.8230e-01],
         [ 1.2651e-01,  1.8624e-01],
         [ 1.4976e-01,  1.8383e-01],
         [ 1.3096e-01,  1.5660e-01],
         [ 1.5719e-01,  1.1360e-01],
         [-4.3478e-02,  9.2760e-02],
         [-6.5489e-02,  7.1618e-02],
         [-1.1061e-01,  4.6336e-02],
         [-1.2185e-01,  5.9508e-02],
         [ 1.3051e-01,  1.1030e-01],
         [ 1.0501e-01, -1.4338e-01],
         [ 1.1574e-01, -1.2058e-01],
         [ 1.2416e-01, -1.0954e-01],
         [ 1.4123e-01, -1.0672e-01],
         [ 1.0080e-01, -1.1728e-01],
         [ 1.2277e-01, -1.0784e-01],
         [ 1.3046e-01,  4.7317e-03],
         [ 1.2593e-01,  3.5153e-02],
         [ 1.3922e-01,  4.7874e-02],
         [ 1.8498e-01,  5.2807e-02],
         [-6.9397e-02,  5.4573e-02],
         [-1.1243e-01,  5.5107e-02],
         [ 1.2383e-01,  5.5214e-02],
         [ 1.3862e-01,  5.5201e-02],
         [ 1.3305e-01,  5.5187e-02],
         [ 1.4448e-01,  5.5161e-02],
         [ 1.0565e-01,  5.5155e-02],
         [ 1.2594e-01,  5.5158e-02],
         [ 1.3153e-01,  5.5200e-02],
         [ 1.4550e-01,  5.5186e-02],
         [ 1.2056e-01,  5.5187e-02],
         [ 1.2911e-01,  5.5204e-02],
         [ 1.3020e-01,  5.5219e-02],
         [ 1.0828e-01,  5.5208e-02],
         [ 1.1543e-01,  5.5215e-02],
         [ 8.3100e-02,  5.5218e-02],
         [ 1.0123e-01,  5.5227e-02],
         [ 1.0586e-01,  5.5231e-02],
         [-3.1359e-01,  5.5230e-02],
         [ 2.6262e-03,  5.5230e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-7.2080e-05, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0012, device='cuda:0')
mixer_td_error tensor(0.4094, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4700, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5119, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0413, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1613, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0810, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1770833.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2071, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.4216e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2497, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2939, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2497, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3164
target_mac_out tensor([[[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3070e-01,  1.2391e-01,  ...,  7.1034e-02,
            1.5852e-01, -1.0000e+07],
          [-1.0000e+07, -3.6329e-02,  1.0540e-01,  ..., -2.3505e-02,
            1.3276e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4548e-01,  1.2388e-01,  ...,  5.2184e-02,
            1.5225e-01, -1.0000e+07],
          [-1.0000e+07, -7.9506e-02,  1.4849e-01,  ...,  2.9133e-02,
            1.4592e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5505e-01,  5.1068e-02,  ...,  3.8250e-02,
            2.0122e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5922e-01,  4.2900e-02,  ...,  2.9935e-02,
            1.9831e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.9150e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.7344e-02,  8.2773e-02,  ...,  5.5160e-04,
            1.4831e-01, -1.0000e+07],
          [-1.0000e+07, -2.7700e-02,  1.3816e-01,  ..., -4.3951e-03,
            1.4720e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6811e-02,  8.2313e-02,  ...,  4.0371e-03,
            1.5378e-01, -1.0000e+07],
          [-1.0000e+07, -2.8490e-02,  1.3545e-01,  ..., -1.7911e-02,
            1.4236e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0827e-01, -1.1117e-02],
         [ 1.2391e-01,  1.0540e-01],
         [ 1.2388e-01,  1.4849e-01],
         [ 1.1120e-01,  1.1545e-01],
         [ 8.1763e-02,  1.0360e-01],
         [ 1.0384e-01,  1.6212e-01],
         [ 1.0730e-01,  1.3985e-01],
         [ 1.2105e-01,  1.2283e-01],
         [ 1.3210e-01,  1.4214e-01],
         [ 1.5162e-01,  1.6795e-01],
         [ 1.6399e-01,  1.8431e-01],
         [ 1.3424e-01,  1.5073e-01],
         [ 1.3556e-01,  1.3457e-01],
         [ 1.2130e-01,  1.1134e-01],
         [ 1.4275e-01,  1.3791e-01],
         [ 1.2264e-01,  1.6636e-01],
         [ 1.4533e-01,  1.3594e-01],
         [ 1.5384e-01,  1.1079e-01],
         [ 1.4967e-01,  1.2379e-01],
         [ 1.3395e-01,  8.9738e-02],
         [ 9.3326e-02, -9.6275e-02],
         [ 1.5065e-02, -8.0648e-02],
         [ 3.1087e-02, -7.0815e-02],
         [ 4.1229e-02, -5.9451e-02],
         [ 4.6494e-02, -5.6659e-02],
         [ 4.8929e-02, -3.9966e-02],
         [ 4.9845e-02, -5.3753e-02],
         [ 5.0161e-02, -5.3675e-02],
         [ 5.0198e-02, -6.6684e-02],
         [ 5.0164e-02, -5.6926e-02],
         [ 5.0127e-02, -7.5111e-02],
         [ 5.0076e-02,  1.1153e-01],
         [ 5.0043e-02,  7.9167e-02],
         [ 5.0052e-02,  7.6035e-02],
         [ 5.0029e-02,  8.8515e-02],
         [ 5.0036e-02,  6.7258e-02],
         [ 5.0027e-02,  8.0908e-02],
         [ 5.0019e-02, -1.1145e-01],
         [ 5.0025e-02,  7.9332e-02],
         [ 5.0026e-02,  9.3016e-02],
         [ 5.0010e-02,  9.7706e-02],
         [ 5.0020e-02, -9.9113e-02],
         [ 5.0005e-02,  8.6472e-02],
         [ 5.0007e-02,  9.7147e-02],
         [ 5.0008e-02,  6.3430e-02],
         [ 5.0008e-02,  8.5475e-02],
         [ 5.0008e-02, -1.0054e-01],
         [ 5.0009e-02, -9.3356e-02],
         [ 5.0008e-02, -8.3420e-02],
         [ 5.0008e-02, -6.6560e-02],
         [ 5.0008e-02, -7.9682e-02],
         [ 5.0008e-02, -7.6886e-02],
         [ 5.0008e-02, -8.0247e-02],
         [ 5.0009e-02, -8.3672e-02],
         [ 5.0009e-02, -8.7099e-02],
         [ 5.0009e-02, -8.3128e-02],
         [ 5.0009e-02, -9.8963e-02],
         [ 5.0009e-02,  8.4975e-02],
         [ 5.0009e-02,  9.1598e-02],
         [ 5.0009e-02, -9.3768e-02],
         [ 5.0009e-02, -8.3758e-02],
         [ 5.0009e-02, -7.7796e-02],
         [ 5.0009e-02, -8.8830e-02],
         [ 5.0009e-02,  1.0388e-01],
         [ 5.0009e-02,  8.5299e-02],
         [ 5.0009e-02,  9.0344e-02],
         [ 5.0009e-02,  4.6900e-02],
         [ 5.0009e-02, -1.2628e-01],
         [ 5.0009e-02,  6.6682e-02],
         [ 5.0009e-02,  7.9862e-02],
         [ 5.0009e-02, -1.1397e-01],
         [ 5.0009e-02, -9.0066e-02],
         [ 5.0009e-02, -7.8773e-02],
         [ 5.0009e-02,  8.0870e-02],
         [ 5.0009e-02, -7.9872e-02],
         [ 5.0009e-02,  7.1534e-02],
         [ 5.0009e-02,  7.7649e-02],
         [ 5.0009e-02,  8.1230e-02],
         [ 5.0009e-02, -8.0220e-02],
         [ 5.0009e-02, -6.3569e-02],
         [ 5.0009e-02, -8.5435e-02],
         [ 5.0009e-02,  7.6477e-02],
         [ 5.0009e-02, -9.6523e-02],
         [ 5.0009e-02, -9.4440e-02],
         [ 5.0009e-02, -9.4245e-02],
         [ 5.0009e-02, -9.4207e-02],
         [ 5.0009e-02, -9.0095e-02],
         [ 5.0009e-02,  6.9579e-02],
         [ 5.0009e-02,  8.6352e-02],
         [ 5.0009e-02,  5.8278e-02],
         [ 5.0009e-02, -1.0460e-01],
         [ 5.0009e-02,  7.5007e-02],
         [ 5.0009e-02,  8.7675e-02],
         [ 5.0009e-02,  9.3339e-02],
         [ 5.0009e-02,  1.1464e-01],
         [ 5.0009e-02,  6.3624e-02],
         [ 5.0009e-02, -1.0415e-01],
         [ 5.0009e-02, -9.8967e-02],
         [ 5.0009e-02, -9.2874e-02],
         [ 5.0009e-02,  7.1689e-02],
         [ 5.0009e-02,  1.0404e-01],
         [ 5.0009e-02,  1.0427e-01],
         [ 5.0009e-02, -1.1727e-01],
         [ 5.0009e-02, -9.8710e-02],
         [ 5.0009e-02, -8.9451e-02],
         [ 5.0009e-02,  7.5933e-02],
         [ 5.0009e-02, -6.0152e-02],
         [ 5.0009e-02,  1.3334e-01],
         [ 5.0009e-02, -6.4013e-02],
         [ 5.0009e-02, -8.2040e-02],
         [ 5.0009e-02,  9.6982e-02],
         [ 5.0009e-02, -1.0953e-01],
         [ 5.0009e-02,  8.2586e-02],
         [ 5.0009e-02,  7.9531e-02],
         [ 5.0009e-02,  8.8877e-02],
         [ 5.0009e-02,  6.3198e-02],
         [ 5.0009e-02,  5.1944e-02],
         [ 5.0009e-02,  6.4473e-02],
         [ 5.0009e-02,  9.1396e-02],
         [ 5.0009e-02,  8.8900e-02],
         [ 5.0009e-02,  8.9520e-02],
         [ 5.0009e-02,  8.9573e-02],
         [ 5.0009e-02, -1.4103e-01],
         [ 5.0009e-02,  7.2536e-02],
         [ 5.0009e-02,  8.1444e-02],
         [ 5.0009e-02,  7.2294e-02],
         [ 5.0009e-02,  9.0362e-02],
         [ 5.0009e-02,  6.5614e-02],
         [ 5.0009e-02, -1.5505e-01],
         [ 5.0009e-02, -1.5922e-01],
         [ 5.0009e-02,  1.9150e-02]],

        [[ 9.4778e-02, -8.8067e-03],
         [ 8.2773e-02,  1.3816e-01],
         [-9.6811e-02, -2.8490e-02],
         [-9.2285e-02, -5.4247e-02],
         [-9.6350e-02, -6.1587e-02],
         [-1.0725e-01, -3.6431e-02],
         [ 1.0323e-01, -3.2421e-02],
         [ 1.2070e-01,  1.4209e-01],
         [ 1.0444e-01,  1.5146e-01],
         [ 7.7148e-02, -7.0551e-02],
         [ 1.0729e-01, -7.0068e-02],
         [ 7.3784e-02, -7.3530e-02],
         [ 9.7464e-02, -5.3220e-02],
         [ 1.2373e-01, -4.5584e-02],
         [ 1.3208e-01, -4.7344e-02],
         [ 1.2597e-01,  1.2312e-01],
         [ 9.2272e-02, -5.8787e-02],
         [ 8.1605e-02,  1.0404e-01],
         [ 1.0212e-01,  1.3702e-01],
         [ 9.5581e-02,  1.7912e-01],
         [ 6.6902e-02,  1.3102e-01],
         [ 9.6950e-02,  1.5057e-01],
         [ 1.1190e-01,  1.2319e-01],
         [ 1.1653e-01,  1.6811e-01],
         [ 1.1994e-01,  1.7998e-01],
         [ 1.0599e-01,  1.7758e-01],
         [ 1.1322e-01,  1.7083e-01],
         [ 1.0194e-01,  1.3341e-01],
         [ 7.6800e-02,  1.4961e-01],
         [ 7.6347e-02,  1.7268e-01],
         [ 1.0597e-01,  1.3058e-01],
         [ 1.0530e-01,  1.1327e-01],
         [ 1.0820e-01,  1.1978e-01],
         [ 1.3150e-01,  1.0578e-01],
         [ 8.0247e-02,  1.0927e-01],
         [ 1.0287e-01,  1.0990e-01],
         [ 1.1638e-01,  6.3927e-02],
         [ 1.2880e-01, -1.2269e-01],
         [ 1.4306e-01, -1.1186e-01],
         [ 1.3756e-01, -9.8418e-02],
         [ 1.8152e-01, -1.0483e-01],
         [ 1.5473e-01, -9.4788e-02],
         [ 1.3434e-01,  1.3417e-01],
         [ 1.3343e-01,  1.4378e-01],
         [ 8.0181e-02, -1.2892e-01],
         [ 1.0807e-01,  1.8744e-02],
         [ 1.3452e-01,  3.9393e-02],
         [ 1.0242e-01,  4.9066e-02],
         [-8.5212e-02,  5.3184e-02],
         [ 1.0025e-01,  5.4741e-02],
         [ 8.8946e-02,  5.5223e-02],
         [-9.2447e-02,  5.5269e-02],
         [-8.5573e-02,  5.5275e-02],
         [ 8.6610e-02,  5.5215e-02],
         [ 9.8692e-02,  5.5200e-02],
         [-1.1054e-01,  5.5184e-02],
         [ 9.4745e-02,  5.5173e-02],
         [ 7.9883e-02,  5.5206e-02],
         [ 1.0011e-01,  5.5178e-02],
         [-7.7624e-02,  5.5220e-02],
         [-8.0306e-02,  5.5202e-02],
         [-8.0839e-02,  5.5203e-02],
         [ 9.7074e-02,  5.5206e-02],
         [ 9.9522e-02,  5.5206e-02],
         [-9.7095e-02,  5.5223e-02],
         [ 9.8353e-02,  5.5225e-02],
         [-8.8727e-02,  5.5232e-02],
         [-7.7824e-02,  5.5230e-02],
         [-7.4048e-02,  5.5230e-02],
         [-7.3776e-02,  5.5231e-02],
         [-6.9527e-02,  5.5236e-02],
         [-8.3634e-02,  5.5235e-02],
         [-7.6159e-02,  5.5232e-02],
         [-6.8195e-02,  5.5232e-02],
         [-8.5686e-02,  5.5231e-02],
         [ 1.0179e-01,  5.5231e-02],
         [ 1.0681e-01,  5.5231e-02],
         [ 1.0311e-01,  5.5231e-02],
         [ 1.0475e-01,  5.5231e-02],
         [ 1.2444e-01,  5.5231e-02],
         [ 8.0956e-02,  5.5231e-02],
         [ 1.0082e-01,  5.5231e-02],
         [ 8.1777e-02,  5.5231e-02],
         [-1.0706e-01,  5.5231e-02],
         [ 1.0837e-01,  5.5231e-02],
         [-8.8205e-02,  5.5231e-02],
         [ 9.3768e-02,  5.5231e-02],
         [ 9.5879e-02,  5.5231e-02],
         [ 9.2502e-02,  5.5231e-02],
         [ 7.4417e-02,  5.5231e-02],
         [ 9.1003e-02,  5.5231e-02],
         [ 1.1414e-01,  5.5231e-02],
         [ 1.5770e-01,  5.5231e-02],
         [ 1.1647e-01,  5.5231e-02],
         [ 1.2041e-01,  5.5231e-02],
         [ 1.1548e-01,  5.5231e-02],
         [ 1.1403e-01,  5.5231e-02],
         [ 7.6203e-02,  5.5231e-02],
         [ 9.9821e-02,  5.5231e-02],
         [ 7.0610e-02,  5.5231e-02],
         [ 1.1334e-01,  5.5231e-02],
         [ 1.3043e-01,  5.5231e-02],
         [ 1.2248e-01,  5.5231e-02],
         [ 1.2545e-01,  5.5231e-02],
         [ 1.2746e-01,  5.5231e-02],
         [ 1.1248e-01,  5.5231e-02],
         [ 1.2352e-01,  5.5231e-02],
         [ 1.1992e-01,  5.5231e-02],
         [ 1.1772e-01,  5.5231e-02],
         [-6.6528e-04,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.1180e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0020, device='cuda:0')
mixer_td_error tensor(0.1669, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4737, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8078, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0427, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1571, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0605, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-801526.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1843, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.0707e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0016, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1839, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1819, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1839, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3237
target_mac_out tensor([[[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.4360e-02,  7.4236e-02,  ...,  6.2640e-03,
            1.2703e-01, -1.0000e+07],
          [-1.0000e+07, -7.0404e-02,  1.5810e-01,  ...,  4.6388e-02,
            1.4908e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0383e-01,  9.7922e-02,  ...,  1.2565e-02,
            1.4072e-01, -1.0000e+07],
          [-1.0000e+07, -9.8419e-02,  1.7124e-01,  ...,  6.4498e-02,
            1.6552e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6085e-02,  1.0713e-01,  ...,  2.0049e-02,
            1.6247e-01, -1.0000e+07],
          [-1.0000e+07, -1.6729e-02,  1.0948e-01,  ...,  2.6640e-03,
            1.2965e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3875e-02,  8.8061e-02,  ..., -8.4055e-03,
            1.5805e-01, -1.0000e+07],
          [-1.0000e+07, -3.6246e-02,  1.0894e-01,  ..., -3.0980e-02,
            1.3536e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7180e-01,  1.0048e-01,  ...,  4.6637e-02,
            1.5591e-01, -1.0000e+07],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7826e-01,  1.0546e-01,  ...,  4.1326e-02,
            1.6501e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-5.4609e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.5201e-02,  1.3755e-01],
         [-6.4360e-02,  1.5810e-01],
         [ 9.7922e-02,  1.7124e-01],
         [-7.6672e-02,  1.5098e-01],
         [-3.2289e-02,  7.9768e-02],
         [-5.7887e-02,  9.4059e-02],
         [-3.5895e-02,  9.3205e-02],
         [ 1.5301e-01,  5.7789e-02],
         [ 1.7431e-01,  9.6146e-02],
         [ 1.7710e-01,  6.0274e-02],
         [-4.5152e-02,  1.1000e-01],
         [-4.1867e-02,  1.4969e-01],
         [-7.2028e-02,  1.6965e-01],
         [-8.4416e-02,  1.6665e-01],
         [ 1.2149e-01,  1.6551e-01],
         [-8.6635e-02,  9.9754e-02],
         [ 1.2073e-01,  1.3876e-01],
         [-1.0085e-01,  1.0318e-01],
         [ 9.4919e-02,  6.7308e-02],
         [-9.6449e-02, -1.7051e-01],
         [ 1.0608e-01, -1.3034e-01],
         [-1.0761e-01, -1.4796e-01],
         [-6.2876e-02,  1.9309e-02],
         [-7.0186e-02,  4.1537e-02],
         [-7.8832e-02,  5.1971e-02],
         [-9.9095e-02,  5.5940e-02],
         [ 1.1391e-01,  5.6931e-02],
         [ 1.2687e-01,  5.6799e-02],
         [ 9.7271e-02,  5.6349e-02],
         [ 1.1140e-01,  5.5964e-02],
         [ 7.4655e-02,  5.5651e-02],
         [ 1.1591e-01,  5.5474e-02],
         [ 1.3126e-01,  5.5348e-02],
         [ 1.2722e-01,  5.5283e-02],
         [ 8.6774e-02,  5.5242e-02],
         [ 1.1623e-01,  5.5190e-02],
         [ 1.5374e-01,  5.5229e-02],
         [ 1.8613e-01,  5.5209e-02],
         [ 1.4649e-01,  5.5214e-02],
         [ 1.2912e-01,  5.5203e-02],
         [ 1.4835e-01,  5.5219e-02],
         [ 1.3968e-01,  5.5224e-02],
         [ 1.7577e-01,  5.5226e-02],
         [ 1.7443e-01,  5.5230e-02],
         [ 1.4300e-01,  5.5230e-02],
         [ 1.4270e-01,  5.5230e-02],
         [ 9.5536e-02,  5.5232e-02],
         [-2.6119e-01,  5.5236e-02],
         [ 1.2583e-01,  5.5235e-02],
         [ 1.1949e-01,  5.5232e-02],
         [ 8.9068e-03,  5.5232e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.6186e-02, -1.3772e-02],
         [ 1.0713e-01, -1.6729e-02],
         [ 8.8061e-02,  1.0894e-01],
         [-8.3684e-02, -3.0700e-02],
         [-8.3479e-02, -5.2606e-02],
         [-9.8128e-02, -4.0782e-02],
         [-5.0888e-02, -5.7989e-02],
         [ 1.5289e-01, -6.3909e-02],
         [-5.9501e-02, -7.1258e-02],
         [-7.4686e-02, -5.4691e-02],
         [-9.2496e-02,  1.1907e-01],
         [ 1.1051e-01,  1.5141e-01],
         [ 1.1411e-01,  1.6509e-01],
         [ 1.2271e-01,  1.6682e-01],
         [ 1.2024e-01,  1.6277e-01],
         [ 1.1130e-01,  1.6612e-01],
         [ 6.5607e-02,  1.2394e-01],
         [ 1.1444e-01,  1.0649e-01],
         [ 7.8835e-02,  1.4207e-01],
         [ 1.1971e-01,  1.5596e-01],
         [ 1.1534e-01,  1.2716e-01],
         [ 8.6700e-02,  1.1264e-01],
         [ 1.1286e-01,  1.2427e-01],
         [ 1.2074e-01,  1.1945e-01],
         [ 1.2001e-01,  1.6221e-01],
         [ 1.4057e-01,  1.8054e-01],
         [ 1.3404e-01,  1.7876e-01],
         [ 9.7488e-02,  1.4613e-01],
         [ 6.8054e-02,  1.0518e-01],
         [ 8.9463e-02,  1.3002e-01],
         [ 1.0854e-01,  1.2694e-01],
         [ 1.3098e-01,  1.0314e-01],
         [ 1.3012e-01,  1.2926e-01],
         [ 9.5732e-02,  1.3888e-01],
         [ 1.3104e-01,  1.4288e-01],
         [ 1.1995e-01,  1.3116e-01],
         [ 1.0989e-01,  1.0507e-01],
         [ 7.8628e-02,  1.5734e-01],
         [ 7.5788e-02,  1.3776e-01],
         [ 9.2760e-02,  1.1786e-01],
         [ 1.1007e-01,  9.1714e-02],
         [ 1.3964e-01,  6.0981e-02],
         [ 1.0639e-01,  9.0206e-02],
         [ 1.3396e-01,  7.1427e-02],
         [ 1.0815e-01,  7.0678e-02],
         [ 9.8372e-02,  9.8736e-02],
         [ 1.2186e-01,  9.0344e-02],
         [ 7.0507e-02,  8.9243e-02],
         [ 4.7146e-02, -1.3366e-01],
         [ 9.1739e-02, -1.1579e-01],
         [ 1.0728e-01,  1.1503e-01],
         [ 6.0738e-02,  9.1512e-02],
         [ 9.6498e-02,  1.2369e-01],
         [ 5.7662e-02,  1.0658e-01],
         [ 8.8447e-02,  5.8208e-02],
         [ 9.2699e-02,  6.6659e-02],
         [ 9.6148e-02,  7.1523e-02],
         [ 8.2403e-02, -1.6404e-01],
         [ 7.6061e-02,  6.0023e-02],
         [ 8.6408e-02,  7.3924e-02],
         [ 9.5735e-02,  7.8877e-02],
         [ 7.8302e-02,  7.3714e-02],
         [-1.1818e-01,  2.5994e-01],
         [ 8.2177e-02,  5.8956e-02],
         [ 8.7683e-02, -1.6130e-02],
         [ 9.2751e-02,  2.2383e-02],
         [ 9.2730e-02,  4.1224e-02],
         [ 1.0865e-01,  4.9815e-02],
         [ 1.0521e-01,  5.3394e-02],
         [ 6.1773e-02,  5.4752e-02],
         [ 8.2728e-02,  5.5197e-02],
         [ 7.5271e-02,  5.5260e-02],
         [ 7.1240e-02,  5.5271e-02],
         [ 8.9970e-02,  5.5242e-02],
         [ 9.5932e-02,  5.5212e-02],
         [ 9.8053e-02,  5.5195e-02],
         [ 7.7203e-02,  5.5188e-02],
         [ 6.9477e-02,  5.5194e-02],
         [-1.0620e-01,  5.5217e-02],
         [-6.5778e-02,  5.5199e-02],
         [ 1.3347e-01,  5.5205e-02],
         [ 1.4507e-01,  5.5211e-02],
         [ 1.5629e-01,  5.5207e-02],
         [ 1.6322e-01,  5.5212e-02],
         [ 1.5895e-01,  5.5229e-02],
         [ 1.1127e-01,  5.5230e-02],
         [ 9.5475e-02,  5.5230e-02],
         [ 1.0614e-01,  5.5230e-02],
         [ 6.9667e-02,  5.5234e-02],
         [ 1.0300e-01,  5.5235e-02],
         [ 7.2349e-02,  5.5235e-02],
         [ 9.7220e-02,  5.5232e-02],
         [ 1.0048e-01,  5.5232e-02],
         [ 1.0546e-01,  5.5231e-02],
         [-5.4609e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.3922e-05, device='cuda:0') tensor(0.0016, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(0.5929, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5549, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4331, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0530, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1685, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0562, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2315789.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2599, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.5760e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0007, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1580, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3185, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1580, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3299
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2225e-02,  6.2394e-02,  ...,  2.0084e-02,
            1.2912e-01, -1.0000e+07],
          [-1.0000e+07, -7.7190e-02,  1.6041e-01,  ...,  7.2365e-02,
            1.5573e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.0171e-02,  4.6061e-02,  ...,  4.1223e-02,
            1.3816e-01, -1.0000e+07],
          [-1.0000e+07, -1.2417e-01,  1.0542e-01,  ...,  6.0142e-02,
            1.7534e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0660e-01,  1.0891e-01,  ...,  4.0960e-02,
            1.4451e-01, -1.0000e+07],
          [-1.0000e+07, -1.8482e-02,  1.0351e-01,  ...,  3.3942e-02,
            1.3388e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8928e-02,  7.1365e-02,  ...,  2.7223e-02,
            1.4807e-01, -1.0000e+07],
          [-1.0000e+07, -6.4588e-03,  1.1091e-01,  ...,  1.4417e-02,
            1.1999e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -5.3589e-02,  1.3369e-01,  ...,  4.2509e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -6.3608e-02,  1.4634e-01,  ...,  5.5140e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.7686e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.4276e-02,  1.4162e-01],
         [-6.2225e-02,  1.6041e-01],
         [-5.0171e-02,  1.0542e-01],
         [-5.5750e-02,  9.9757e-02],
         [-6.0333e-02,  1.0032e-01],
         [-4.5322e-02,  1.1083e-01],
         [-5.4950e-02,  8.8379e-02],
         [-7.1698e-02,  5.0338e-02],
         [-8.9908e-02, -1.6529e-01],
         [-8.8833e-02,  7.0947e-02],
         [-8.6353e-02, -1.5952e-01],
         [-9.3121e-02,  6.7105e-02],
         [-1.0690e-01,  8.5601e-02],
         [-1.1034e-01, -8.6728e-02],
         [ 1.0189e-01,  1.0813e-01],
         [ 1.0957e-01,  1.4163e-01],
         [-1.1353e-01,  1.5074e-01],
         [ 1.0969e-01,  1.3259e-01],
         [ 1.1634e-01,  1.3622e-01],
         [-1.1104e-01,  1.1813e-01],
         [-9.6136e-02,  1.2593e-01],
         [-8.1049e-02, -9.0314e-02],
         [-6.6191e-02, -8.6038e-02],
         [ 1.2084e-01,  1.0832e-01],
         [-7.0868e-02,  1.1736e-01],
         [ 1.1740e-01,  1.2457e-01],
         [-8.4688e-02,  1.0931e-01],
         [-8.0745e-02,  1.3790e-01],
         [-8.2549e-02,  1.2382e-01],
         [ 1.2564e-01,  1.0115e-01],
         [ 1.3462e-01,  8.7414e-02],
         [ 1.2062e-01, -1.0901e-01],
         [-6.8257e-02,  9.4781e-02],
         [-6.2877e-02,  1.2915e-01],
         [ 1.2263e-01, -1.0942e-01],
         [ 1.2980e-01,  1.0266e-01],
         [-6.1038e-02, -9.8990e-02],
         [-4.6700e-02, -8.5677e-02],
         [-4.0838e-02,  1.0810e-01],
         [-4.2937e-02, -7.3351e-02],
         [ 1.3812e-01,  1.1151e-01],
         [ 1.4719e-01, -6.8537e-02],
         [ 1.5098e-01,  1.1294e-01],
         [ 1.4491e-01,  1.1886e-01],
         [ 1.4630e-01,  9.7283e-02],
         [-6.1602e-02, -8.3677e-02],
         [ 1.3517e-01,  1.0335e-01],
         [ 1.2611e-01, -8.2644e-02],
         [-5.7862e-02, -8.0513e-02],
         [-6.1121e-02,  1.0655e-01],
         [-4.8498e-02, -8.1731e-02],
         [-5.2068e-02, -7.8955e-02],
         [-4.6674e-02, -8.0622e-02],
         [ 1.2669e-01, -6.9637e-02],
         [ 1.3654e-01,  1.2397e-01],
         [ 1.4457e-01,  9.8825e-02],
         [ 1.0822e-01,  1.1199e-01],
         [ 1.3258e-01,  1.2232e-01],
         [-7.6624e-02,  8.6092e-02],
         [ 1.3642e-01, -1.1305e-01],
         [ 1.4824e-01, -1.0185e-01],
         [ 1.5449e-01, -1.0816e-01],
         [ 1.5433e-01,  9.7028e-02],
         [ 1.7276e-01,  1.2470e-01],
         [ 1.7542e-01,  7.8740e-02],
         [ 1.5339e-01,  1.2617e-01],
         [ 1.7310e-01,  8.8818e-02],
         [ 1.9181e-01,  1.2856e-01],
         [ 1.4465e-01,  8.0639e-02],
         [ 1.4087e-01,  6.5621e-02],
         [ 1.2356e-01,  9.4826e-02],
         [ 1.5315e-01,  1.0419e-01],
         [ 1.6759e-01,  1.1759e-01],
         [ 1.7295e-01,  1.0442e-01],
         [ 1.8473e-01,  7.3958e-02],
         [ 1.5782e-01,  8.9779e-02],
         [ 1.3241e-01, -1.4819e-01],
         [ 1.6038e-01,  6.1309e-02],
         [ 1.3231e-01, -1.3339e-01],
         [ 1.6362e-01,  5.7766e-02],
         [ 1.7874e-01,  9.3304e-02],
         [ 1.8657e-01,  1.4008e-01],
         [ 1.9861e-01,  1.6050e-01],
         [ 1.5093e-01,  1.5866e-01],
         [ 3.7360e-03,  1.4849e-01],
         [ 2.4588e-02,  1.4539e-01],
         [ 3.7796e-02,  1.4573e-01],
         [ 4.4747e-02,  1.5611e-01],
         [ 4.8003e-02,  1.1793e-01],
         [ 4.9379e-02,  1.4921e-01],
         [ 4.9888e-02,  1.5403e-01],
         [ 5.0033e-02,  1.7582e-01],
         [ 5.0053e-02,  1.2957e-01],
         [ 5.0057e-02, -3.8881e-02],
         [ 5.0038e-02,  1.4044e-01],
         [ 5.0012e-02,  1.5908e-01],
         [ 5.0025e-02, -4.1979e-02],
         [ 5.0015e-02,  1.4436e-01],
         [ 5.0025e-02,  1.5183e-01],
         [ 5.0020e-02,  1.6311e-01],
         [ 5.0021e-02,  1.8162e-01],
         [ 5.0018e-02,  1.1798e-01],
         [ 5.0025e-02,  1.0133e-01],
         [ 5.0018e-02,  8.6351e-02],
         [ 5.0009e-02,  8.9198e-02],
         [ 5.0019e-02, -1.5732e-01],
         [ 5.0005e-02, -1.4853e-01],
         [ 5.0007e-02,  6.7762e-02],
         [ 5.0008e-02,  9.7635e-02],
         [ 5.0008e-02, -1.5611e-01],
         [ 5.0008e-02, -1.3327e-01],
         [ 5.0009e-02,  7.8647e-02],
         [ 5.0008e-02, -1.4467e-01],
         [ 5.0008e-02,  7.9123e-02],
         [ 5.0008e-02,  7.5490e-02],
         [ 5.0008e-02, -1.3740e-01],
         [ 5.0008e-02, -1.2245e-01],
         [ 5.0009e-02,  1.2287e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0780e-01, -1.6811e-02],
         [ 1.0891e-01, -1.8482e-02],
         [-8.8928e-02, -6.4588e-03],
         [ 1.0232e-01,  1.3664e-01],
         [-9.6845e-02,  1.4697e-01],
         [ 1.0329e-01,  1.3410e-01],
         [ 1.0722e-01,  1.1105e-01],
         [-1.0220e-01, -4.5667e-02],
         [-1.0871e-01, -3.4182e-02],
         [ 9.5557e-02, -3.2360e-02],
         [ 1.0693e-01, -3.6292e-02],
         [ 9.5909e-02, -3.5147e-02],
         [-1.0012e-01,  1.3140e-01],
         [-8.6825e-02,  1.4134e-01],
         [-8.1265e-02,  1.6046e-01],
         [ 1.2220e-01,  1.3346e-01],
         [ 1.2203e-01, -6.1864e-02],
         [ 1.0645e-01,  1.2609e-01],
         [ 1.3163e-01, -4.5172e-02],
         [ 1.3612e-01, -5.2699e-02],
         [ 1.0972e-01, -4.5721e-02],
         [ 1.0088e-01, -4.7102e-02],
         [ 1.1610e-01,  1.3562e-01],
         [ 1.3325e-01,  1.5198e-01],
         [ 1.4066e-01,  1.4183e-01],
         [ 1.2262e-01,  9.1951e-02],
         [ 1.0962e-01,  9.7596e-02],
         [-1.0949e-01,  6.2137e-02],
         [ 9.6653e-02,  7.2180e-02],
         [ 1.2296e-01,  8.2419e-02],
         [ 9.2967e-02,  4.5509e-02],
         [ 9.7192e-02, -1.6757e-01],
         [ 1.0872e-01,  9.1904e-02],
         [ 1.1913e-01, -1.0921e-01],
         [ 1.0491e-01, -1.0176e-01],
         [ 1.1757e-01,  1.0496e-01],
         [ 1.2348e-01,  1.2557e-01],
         [ 7.9301e-02,  1.2184e-01],
         [ 7.2027e-02,  8.3242e-02],
         [ 6.7933e-02,  8.3151e-02],
         [ 9.1154e-02,  7.6459e-02],
         [ 7.6238e-02, -1.1833e-01],
         [ 9.4505e-02,  7.0447e-02],
         [ 9.4086e-02, -1.1120e-01],
         [-1.2062e-01,  9.9076e-02],
         [-1.0549e-01, -1.3705e-01],
         [ 8.6235e-02, -1.0896e-01],
         [ 7.5013e-02,  9.1901e-02],
         [ 9.4536e-02,  1.0512e-01],
         [ 7.6552e-02,  9.8362e-02],
         [-7.8841e-02,  9.4596e-02],
         [ 1.0604e-01,  6.4166e-02],
         [ 1.0807e-01,  9.8112e-02],
         [ 1.1879e-01, -1.2800e-01],
         [ 1.1360e-01, -1.0611e-01],
         [ 1.1549e-01, -9.0717e-02],
         [ 1.0928e-01,  1.2266e-01],
         [ 1.3305e-01, -8.6192e-02],
         [ 1.0559e-01, -8.7261e-02],
         [ 1.3164e-01,  1.1369e-01],
         [ 1.3856e-01,  9.5307e-02],
         [ 1.4407e-01,  1.1329e-01],
         [ 1.7035e-01,  1.2186e-01],
         [ 1.3371e-01,  8.8530e-02],
         [ 1.4009e-01, -1.1495e-01],
         [ 1.0089e-01, -1.0890e-01],
         [ 1.2762e-01,  8.9119e-02],
         [ 1.4125e-01,  9.5281e-02],
         [ 1.4634e-01,  1.0041e-01],
         [ 1.4501e-01,  9.6483e-02],
         [ 1.0114e-01, -8.8676e-02],
         [ 4.5363e-02, -8.8102e-02],
         [ 4.5874e-02, -8.5134e-02],
         [ 4.8161e-02, -9.2496e-02],
         [ 4.9559e-02, -9.2230e-02],
         [ 5.0116e-02, -9.8284e-02],
         [ 5.0224e-02, -1.1880e-01],
         [ 5.0164e-02, -1.1042e-01],
         [ 5.0077e-02, -9.7295e-02],
         [ 5.0000e-02, -1.1126e-01],
         [ 4.9980e-02, -9.3247e-02],
         [ 4.9969e-02, -9.0482e-02],
         [ 4.9963e-02, -8.6838e-02],
         [ 4.9972e-02, -8.4312e-02],
         [ 4.9979e-02, -8.3054e-02],
         [ 4.9996e-02, -4.2544e-02],
         [ 5.0000e-02, -4.2143e-02],
         [ 5.0017e-02, -7.6275e-02],
         [ 5.0009e-02, -8.0027e-02],
         [ 5.0016e-02, -8.0504e-02],
         [ 5.0019e-02, -8.6661e-02],
         [ 5.0012e-02, -9.2780e-02],
         [ 5.0012e-02, -9.0781e-02],
         [ 5.0006e-02, -4.6383e-02],
         [ 5.0008e-02, -3.0346e-02],
         [ 5.0008e-02, -3.4917e-02],
         [ 5.0008e-02, -1.3267e-02],
         [ 5.0008e-02, -1.1271e-02],
         [ 5.0008e-02, -5.6890e-02],
         [ 5.0008e-02, -7.1919e-02],
         [ 5.0008e-02, -8.3137e-02],
         [ 5.0008e-02, -9.0514e-02],
         [ 5.0008e-02, -8.8620e-02],
         [ 5.0008e-02, -9.2357e-02],
         [ 5.0009e-02, -9.4322e-02],
         [ 5.0009e-02, -9.5658e-02],
         [ 5.0009e-02, -9.6521e-02],
         [ 5.0009e-02, -8.9379e-02],
         [ 5.0009e-02, -1.0125e-01],
         [ 5.0009e-02, -5.6585e-02],
         [ 5.0009e-02, -6.3228e-02],
         [ 5.0009e-02, -3.8461e-02],
         [ 5.0009e-02, -3.2991e-02],
         [ 5.0009e-02,  1.2118e-01],
         [ 5.0009e-02, -1.8347e-02],
         [ 5.0009e-02, -1.7149e-03],
         [ 5.0009e-02, -4.2233e-03],
         [ 5.0009e-02, -6.5548e-03],
         [ 5.0009e-02,  1.2864e-01],
         [ 5.0009e-02,  1.3082e-01],
         [ 5.0009e-02, -1.6182e-02],
         [ 5.0009e-02,  2.7622e-03],
         [ 5.0009e-02,  2.2674e-03],
         [ 5.0009e-02, -3.7655e-03],
         [ 5.0009e-02, -1.0434e-02],
         [ 5.0009e-02,  1.3925e-01],
         [ 5.0009e-02, -3.7249e-02],
         [ 5.0009e-02, -5.9561e-02],
         [ 5.0009e-02, -8.5618e-02],
         [ 5.0009e-02, -7.5416e-02],
         [ 5.0009e-02, -8.9079e-02],
         [ 5.0009e-02, -8.4093e-02],
         [ 5.0009e-02, -1.0652e-01],
         [ 5.0009e-02, -1.0365e-01],
         [ 5.0009e-02, -9.6471e-02],
         [ 5.0009e-02, -5.8838e-02],
         [ 5.0009e-02, -4.7610e-02],
         [ 5.0009e-02,  1.2143e-01],
         [ 5.0009e-02,  1.3214e-01],
         [ 5.0009e-02,  1.4587e-01],
         [ 5.0009e-02, -3.2194e-02],
         [ 5.0009e-02,  1.2682e-01],
         [ 5.0009e-02,  1.3574e-01],
         [ 5.0009e-02,  1.4887e-01],
         [ 5.0009e-02,  1.4346e-01],
         [ 5.0009e-02,  1.5426e-01],
         [ 5.0009e-02, -3.8568e-02],
         [ 5.0009e-02,  1.3369e-01],
         [ 5.0009e-02,  1.4634e-01],
         [ 5.0009e-02,  2.7686e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.5433e-07, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.2678, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4681, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4184, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0552, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2083, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0491, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1066666.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1986, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.5243e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1561, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2119, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1561, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3351
target_mac_out tensor([[[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4689e-02,  1.0709e-01,  ...,  1.4450e-02,
            1.5237e-01, -1.0000e+07],
          [-1.0000e+07, -2.1835e-02,  9.9402e-02,  ..., -1.5839e-02,
            1.3204e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0286e-02,  1.0929e-01,  ...,  4.9539e-03,
            1.4714e-01, -1.0000e+07],
          [-1.0000e+07, -4.0755e-02,  1.1664e-01,  ..., -1.3107e-02,
            1.4728e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5109e-01,  4.3734e-02,  ...,  2.5633e-02,
            1.9335e-01, -3.0600e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4069e-01,  2.7674e-02,  ...,  3.4865e-02,
            1.7954e-01, -3.0370e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.5720e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.5027e-02,  7.1936e-02,  ..., -3.0500e-03,
            1.2911e-01, -1.0000e+07],
          [-1.0000e+07, -2.2961e-02,  9.6708e-02,  ..., -2.0494e-02,
            1.3243e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.1139e-02,  8.5369e-02,  ...,  1.4716e-02,
            1.3164e-01, -1.0000e+07],
          [-1.0000e+07, -3.0575e-02,  9.4245e-02,  ..., -4.3856e-02,
            1.3745e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.2300e-02,  8.8635e-02],
         [ 1.0709e-01, -2.1835e-02],
         [ 1.0929e-01,  1.1664e-01],
         [ 1.1707e-01,  1.4906e-01],
         [ 1.2279e-01,  1.5190e-01],
         [ 9.8224e-02,  1.1788e-01],
         [-6.3439e-02,  1.1747e-01],
         [-5.2606e-02, -9.5070e-02],
         [-5.1940e-02, -7.5380e-02],
         [-4.3517e-02, -6.3207e-02],
         [-3.2999e-02, -5.5223e-02],
         [-2.6783e-02, -4.6390e-02],
         [-3.4390e-02,  1.1707e-01],
         [ 1.2004e-01,  1.3088e-01],
         [-3.6160e-02,  8.9258e-02],
         [ 1.2702e-01, -5.2496e-02],
         [-4.8733e-02,  8.6519e-02],
         [-5.2364e-02,  1.2646e-01],
         [-4.5166e-02,  1.3615e-01],
         [-4.1839e-02,  1.4356e-01],
         [ 1.2247e-01,  1.2033e-01],
         [ 1.2840e-01,  9.6356e-02],
         [ 1.2090e-01,  1.0689e-01],
         [-5.4788e-02,  1.1374e-01],
         [ 1.2041e-01,  1.1817e-01],
         [ 1.1333e-01,  1.0346e-01],
         [-3.0120e-02, -5.0393e-02],
         [ 1.3086e-01,  1.1294e-01],
         [ 1.3902e-01,  1.1477e-01],
         [ 1.2469e-01,  8.2680e-02],
         [ 1.1915e-01, -7.6878e-02],
         [ 1.1927e-01, -6.6109e-02],
         [-3.0144e-02, -5.7405e-02],
         [ 1.2861e-01, -5.2798e-02],
         [ 1.3395e-01,  1.1226e-01],
         [ 1.4656e-01,  1.0098e-01],
         [ 1.4738e-01,  1.2232e-01],
         [ 1.3493e-01,  1.3158e-01],
         [ 9.9820e-02,  1.1388e-01],
         [ 9.7208e-02,  1.2943e-01],
         [ 8.8163e-02,  1.4022e-01],
         [ 1.0250e-01,  1.4787e-01],
         [ 7.1497e-02,  1.2195e-01],
         [ 9.1572e-02,  1.4120e-01],
         [ 1.0760e-01,  1.0981e-01],
         [ 9.7120e-02,  1.2752e-01],
         [ 1.1733e-01,  9.8038e-02],
         [ 1.1415e-01,  1.2168e-01],
         [ 1.1194e-01,  1.3593e-01],
         [ 1.2551e-01,  1.2816e-01],
         [ 1.3092e-01,  1.0309e-01],
         [ 1.3263e-01,  1.2196e-01],
         [ 1.3071e-01,  1.1071e-01],
         [ 1.1640e-01, -4.7016e-02],
         [ 1.1093e-01, -3.5047e-02],
         [ 1.2401e-01,  1.2196e-01],
         [ 1.0169e-01,  1.3879e-01],
         [ 1.1193e-01,  1.5026e-01],
         [ 1.1108e-01,  1.4903e-01],
         [ 1.1977e-01,  1.1366e-01],
         [ 1.3219e-01,  1.3963e-01],
         [ 1.1138e-01,  1.1566e-01],
         [ 1.2885e-01,  1.4543e-01],
         [ 1.2644e-01,  1.1881e-01],
         [ 1.3949e-01,  1.4211e-01],
         [ 1.4276e-01,  1.4916e-01],
         [ 1.4168e-01,  1.4817e-01],
         [ 1.1640e-01,  1.0859e-01],
         [ 1.4400e-01,  1.2352e-01],
         [ 1.2612e-01,  1.3480e-01],
         [ 1.2655e-01,  1.1539e-01],
         [ 1.4689e-01, -8.4696e-02],
         [ 1.4433e-01,  1.1715e-01],
         [ 1.5643e-01,  1.3132e-01],
         [ 1.3460e-01,  8.9971e-02],
         [ 1.5093e-01, -7.0478e-02],
         [ 1.6464e-01,  1.1095e-01],
         [ 1.6342e-01, -8.4823e-02],
         [ 2.4488e-03, -6.0971e-02],
         [ 2.3410e-02, -3.7074e-02],
         [ 3.6787e-02, -3.5789e-02],
         [ 4.3993e-02, -1.5429e-02],
         [ 4.7565e-02, -2.6782e-02],
         [ 4.9168e-02, -2.0664e-02],
         [ 4.9817e-02, -2.7034e-02],
         [ 5.0045e-02, -1.9710e-02],
         [ 5.0112e-02, -2.6331e-02],
         [ 5.0088e-02, -4.8568e-02],
         [ 5.0075e-02, -5.1540e-02],
         [ 5.0057e-02, -4.7392e-02],
         [ 5.0027e-02, -6.9611e-02],
         [ 5.0040e-02, -5.2743e-02],
         [ 5.0031e-02, -2.2996e-02],
         [ 5.0025e-02, -1.7798e-02],
         [ 5.0022e-02, -4.2187e-02],
         [ 5.0021e-02, -6.1868e-02],
         [ 5.0015e-02,  9.7786e-02],
         [ 5.0012e-02, -7.2264e-02],
         [ 5.0019e-02, -6.1691e-02],
         [ 5.0005e-02, -4.8752e-02],
         [ 5.0006e-02, -2.0558e-02],
         [ 5.0008e-02, -4.5918e-02],
         [ 5.0008e-02, -3.3800e-02],
         [ 5.0008e-02, -3.2012e-02],
         [ 5.0009e-02, -3.4425e-02],
         [ 5.0008e-02, -3.7198e-02],
         [ 5.0008e-02, -1.6848e-02],
         [ 5.0008e-02, -4.4272e-02],
         [ 5.0008e-02, -3.2779e-02],
         [ 5.0008e-02, -3.1126e-02],
         [ 5.0009e-02, -5.0180e-02],
         [ 5.0009e-02,  1.0113e-01],
         [ 5.0009e-02, -6.4674e-02],
         [ 5.0009e-02, -4.6148e-02],
         [ 5.0009e-02, -2.7205e-02],
         [ 5.0009e-02, -4.6880e-02],
         [ 5.0009e-02, -4.9745e-02],
         [ 5.0009e-02, -3.5934e-02],
         [ 5.0009e-02, -1.1604e-02],
         [ 5.0009e-02, -1.5037e-03],
         [ 5.0009e-02, -3.5710e-02],
         [ 5.0009e-02, -3.8721e-02],
         [ 5.0009e-02, -6.1944e-02],
         [ 5.0009e-02, -5.3529e-02],
         [ 5.0009e-02, -5.1740e-02],
         [ 5.0009e-02, -3.6481e-02],
         [ 5.0009e-02, -3.4334e-02],
         [ 5.0009e-02, -1.4424e-02],
         [ 5.0009e-02, -2.6294e-02],
         [ 5.0009e-02, -1.0880e-02],
         [ 5.0009e-02, -2.1796e-03],
         [ 5.0009e-02, -3.5703e-02],
         [ 5.0009e-02, -5.5765e-02],
         [ 5.0009e-02, -5.4805e-02],
         [ 5.0009e-02, -6.8823e-02],
         [ 5.0009e-02,  9.4690e-02],
         [ 5.0009e-02, -7.4438e-02],
         [ 5.0009e-02, -6.1959e-02],
         [ 5.0009e-02, -7.3720e-02],
         [ 5.0009e-02,  9.2915e-02],
         [ 5.0009e-02, -6.6492e-02],
         [ 5.0009e-02, -7.2991e-02],
         [ 5.0009e-02, -5.8931e-02],
         [ 5.0009e-02, -5.5145e-02],
         [ 5.0009e-02, -4.9577e-02],
         [ 5.0009e-02, -5.1569e-02],
         [ 5.0009e-02, -5.9566e-02],
         [ 5.0009e-02, -5.4384e-02],
         [ 5.0009e-02, -4.4343e-02],
         [ 5.0009e-02, -5.7328e-02],
         [ 5.0009e-02,  8.9803e-02],
         [ 5.0009e-02, -5.1495e-02],
         [ 5.0009e-02, -3.1097e-02],
         [ 5.0009e-02, -1.0031e-02],
         [ 5.0009e-02, -1.0247e-02],
         [ 5.0009e-02, -7.9768e-03],
         [ 5.0009e-02, -5.9288e-03],
         [ 5.0009e-02, -3.4743e-02],
         [ 5.0009e-02, -2.7162e-02],
         [ 5.0009e-02, -6.2309e-03],
         [ 5.0009e-02, -3.7196e-02],
         [ 5.0009e-02, -5.7009e-02],
         [ 5.0009e-02, -4.9438e-02],
         [ 5.0009e-02, -4.3943e-02],
         [ 5.0009e-02, -4.7101e-02],
         [ 5.0009e-02, -4.0317e-02],
         [ 5.0009e-02, -2.4805e-02],
         [ 5.0009e-02, -6.2786e-03],
         [ 5.0009e-02, -2.0382e-02],
         [ 5.0009e-02, -2.9215e-02],
         [ 5.0009e-02, -1.2467e-02],
         [ 5.0009e-02, -4.1956e-02],
         [ 5.0009e-02, -5.9700e-02],
         [ 5.0009e-02, -5.0565e-02],
         [ 5.0009e-02, -6.4992e-02],
         [ 5.0009e-02,  9.6662e-02],
         [ 5.0009e-02,  1.0111e-01],
         [ 5.0009e-02,  1.0525e-01],
         [ 5.0009e-02,  1.2110e-01],
         [ 5.0009e-02,  1.1905e-01],
         [ 5.0009e-02,  8.1493e-02],
         [ 5.0009e-02,  5.4724e-02],
         [ 5.0009e-02,  8.5680e-02],
         [ 5.0009e-02,  9.8182e-02],
         [ 5.0009e-02,  7.0510e-02],
         [ 5.0009e-02,  9.8478e-02],
         [ 5.0009e-02,  6.5444e-02],
         [ 5.0009e-02,  7.1292e-02],
         [ 5.0009e-02,  8.0597e-02],
         [ 5.0009e-02,  7.6084e-02],
         [ 5.0009e-02,  7.0666e-02],
         [ 5.0009e-02,  8.5560e-02],
         [ 5.0009e-02,  8.5482e-02],
         [ 5.0009e-02,  8.8488e-02],
         [ 5.0009e-02,  5.7154e-02],
         [ 5.0009e-02,  4.6379e-02],
         [ 5.0009e-02,  6.8469e-02],
         [ 5.0009e-02,  5.4959e-02],
         [ 5.0009e-02, -1.5109e-01],
         [ 5.0009e-02, -1.4069e-01],
         [ 5.0009e-02,  8.5720e-03]],

        [[-4.2377e-02, -1.1096e-02],
         [-5.5027e-02,  9.6708e-02],
         [-4.1139e-02, -3.0575e-02],
         [-3.2662e-02,  1.1600e-01],
         [-4.2330e-02, -3.3436e-02],
         [ 1.4632e-01,  1.3353e-01],
         [ 1.2837e-01,  1.0659e-01],
         [ 1.1660e-01, -2.9617e-02],
         [ 1.3067e-01,  1.3858e-01],
         [ 1.5041e-01, -2.3082e-02],
         [ 1.6852e-01, -1.5386e-02],
         [-2.0264e-02, -8.4988e-03],
         [ 1.6914e-01, -3.7857e-02],
         [-6.2545e-03, -4.0398e-02],
         [ 1.5086e-02, -4.7884e-02],
         [-1.8821e-02, -3.0138e-02],
         [ 1.2065e-01, -1.4213e-02],
         [-4.9873e-02, -1.2104e-02],
         [ 1.4248e-01,  1.3861e-01],
         [-3.3560e-02,  1.1778e-01],
         [-3.7333e-02, -3.2817e-03],
         [ 1.0830e-01, -6.3185e-03],
         [-7.3922e-02, -3.1255e-02],
         [ 9.3324e-02, -1.8565e-02],
         [ 1.0936e-01, -1.1027e-02],
         [-1.9287e-02, -1.1783e-02],
         [ 1.5426e-01, -3.9562e-02],
         [ 1.7741e-01, -3.0440e-02],
         [ 1.7950e-01, -4.7343e-02],
         [ 1.7848e-01,  9.5407e-02],
         [-2.2659e-02, -5.7749e-02],
         [ 1.6343e-01, -4.7370e-02],
         [ 1.8144e-01, -2.5316e-02],
         [ 1.3893e-01, -1.4975e-02],
         [-7.1515e-02,  1.3353e-01],
         [ 1.0307e-01,  1.4873e-01],
         [-8.2046e-02,  1.1367e-01],
         [ 9.7996e-02,  1.3962e-01],
         [ 9.6801e-02,  1.5129e-01],
         [ 1.2020e-01,  1.1250e-01],
         [ 1.3091e-01,  1.2301e-01],
         [ 1.2777e-01,  1.0402e-01],
         [ 1.5403e-01,  9.7388e-02],
         [ 1.6515e-01,  9.9281e-02],
         [ 1.7729e-01,  1.1371e-01],
         [ 1.7978e-01, -4.4041e-02],
         [ 1.2463e-01, -3.3466e-02],
         [ 1.1360e-01,  1.0884e-01],
         [ 1.2853e-01,  1.3620e-01],
         [ 1.4989e-01, -6.0776e-02],
         [ 1.6592e-01,  9.8872e-02],
         [ 1.2034e-01,  1.4419e-01],
         [ 1.2796e-01,  1.6298e-01],
         [ 1.5526e-01,  1.6761e-01],
         [ 1.6354e-01,  1.3651e-01],
         [ 1.2214e-01,  1.6277e-01],
         [ 1.3145e-01,  1.8230e-01],
         [ 1.2651e-01,  1.8624e-01],
         [ 1.4976e-01,  1.8383e-01],
         [ 1.3096e-01,  1.5660e-01],
         [ 1.5719e-01,  1.1360e-01],
         [-4.3478e-02,  9.2760e-02],
         [-6.5489e-02,  7.1618e-02],
         [ 1.2064e-01,  4.6336e-02],
         [ 1.0465e-01,  5.9508e-02],
         [ 1.3051e-01,  1.1030e-01],
         [ 1.0501e-01,  1.3248e-01],
         [ 1.1574e-01,  1.0984e-01],
         [ 1.2416e-01,  1.3082e-01],
         [ 1.4123e-01,  1.3335e-01],
         [ 1.0080e-01,  1.5099e-01],
         [ 1.2277e-01,  1.1573e-01],
         [ 1.3046e-01,  4.7317e-03],
         [ 1.2593e-01,  3.5153e-02],
         [ 1.3922e-01,  4.7874e-02],
         [ 1.8498e-01,  5.2807e-02],
         [ 1.5769e-01,  5.4573e-02],
         [ 1.3009e-01,  5.5107e-02],
         [ 1.2383e-01,  5.5214e-02],
         [ 1.3862e-01,  5.5201e-02],
         [ 1.3305e-01,  5.5187e-02],
         [ 1.4448e-01,  5.5161e-02],
         [ 1.0565e-01,  5.5155e-02],
         [ 1.2594e-01,  5.5158e-02],
         [ 1.3153e-01,  5.5200e-02],
         [ 1.4550e-01,  5.5186e-02],
         [ 1.2056e-01,  5.5187e-02],
         [ 1.2911e-01,  5.5204e-02],
         [ 1.3020e-01,  5.5219e-02],
         [ 1.0828e-01,  5.5208e-02],
         [ 1.1543e-01,  5.5215e-02],
         [ 8.3100e-02,  5.5218e-02],
         [ 1.0123e-01,  5.5227e-02],
         [ 1.0586e-01,  5.5231e-02],
         [ 7.2695e-02,  5.5230e-02],
         [ 2.6262e-03,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.5267e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.6125, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4848, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4933, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0476, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2049, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0679, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2611940., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1862, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.2626e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1986, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1559, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1986, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3439
target_mac_out tensor([[[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6454e-02,  9.8041e-02,  ...,  2.6212e-02,
            1.4254e-01, -1.0000e+07],
          [-1.0000e+07, -6.9791e-02,  1.1912e-01,  ...,  2.3814e-02,
            1.4958e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0073e-01,  1.1228e-01,  ...,  2.1527e-02,
            1.5677e-01, -1.0000e+07],
          [-1.0000e+07, -7.4430e-02,  1.2619e-01,  ...,  2.5142e-02,
            1.4711e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0575e-01,  1.1552e-01,  ...,  5.7407e-02,
            1.7511e-01, -3.2794e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1218e-01,  1.1068e-01,  ...,  5.6260e-02,
            1.7721e-01, -3.2753e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.7746e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3339e-02,  9.6645e-02,  ...,  1.7415e-02,
            1.4616e-01, -1.0000e+07],
          [-1.0000e+07, -3.2135e-02,  1.2998e-01,  ..., -1.6960e-03,
            1.4491e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3160e-01,  1.1777e-01,  ...,  4.7882e-02,
            1.6134e-01, -1.0000e+07],
          [-1.0000e+07, -4.8642e-02,  1.4400e-01,  ...,  1.8665e-02,
            1.5708e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.3473e-02,  1.3755e-01],
         [ 9.8041e-02,  1.1912e-01],
         [ 1.1228e-01,  1.2619e-01],
         [ 7.7923e-02, -9.7806e-02],
         [-9.3815e-02, -1.0272e-01],
         [-6.9760e-02,  7.2421e-02],
         [-7.9699e-02,  9.9376e-02],
         [ 9.7684e-02,  5.2127e-02],
         [ 1.1953e-01,  9.4958e-02],
         [ 1.0656e-01, -6.6225e-02],
         [ 1.1094e-01,  1.2454e-01],
         [ 1.0315e-01,  1.3676e-01],
         [ 1.0846e-01,  1.1305e-01],
         [ 1.1109e-01,  9.9956e-02],
         [ 1.0954e-01,  1.3933e-01],
         [ 9.0369e-02,  1.5308e-01],
         [-9.4343e-02,  1.4767e-01],
         [ 9.6741e-02,  1.2407e-01],
         [ 7.7493e-02,  1.0314e-01],
         [ 9.5068e-02,  1.2607e-01],
         [ 1.0269e-01,  1.4122e-01],
         [ 7.5418e-02,  1.5638e-01],
         [ 8.0872e-02,  1.3731e-01],
         [ 6.6191e-02,  1.5575e-01],
         [ 9.3772e-02,  1.6546e-01],
         [ 9.7946e-02,  1.3939e-01],
         [ 7.6336e-02,  1.6230e-01],
         [ 6.3684e-02,  1.8396e-01],
         [-1.2127e-01,  1.5706e-01],
         [ 9.5914e-02,  1.5702e-01],
         [ 1.2101e-01,  1.5701e-01],
         [ 1.2505e-01,  1.3683e-01],
         [ 1.2304e-01,  1.2317e-01],
         [ 9.6598e-02,  9.9315e-02],
         [-1.0834e-01,  1.1218e-01],
         [-9.9828e-02,  1.3276e-01],
         [ 1.0127e-01, -2.0544e-02],
         [ 1.1849e-01,  2.3882e-02],
         [-1.1204e-01,  4.3476e-02],
         [ 9.5254e-02,  5.1597e-02],
         [ 1.2028e-01,  5.4689e-02],
         [ 1.2592e-01,  5.5643e-02],
         [ 1.3374e-01,  5.5776e-02],
         [ 9.0594e-02,  5.5666e-02],
         [ 1.1648e-01,  5.5511e-02],
         [ 7.8731e-02,  5.5378e-02],
         [ 1.0117e-01,  5.5285e-02],
         [ 1.0704e-01,  5.5246e-02],
         [ 8.2376e-02,  5.5226e-02],
         [ 9.7130e-02,  5.5235e-02],
         [ 7.6244e-02,  5.5201e-02],
         [ 9.3174e-02,  5.5199e-02],
         [-1.0662e-01,  5.5208e-02],
         [ 9.1474e-02,  5.5219e-02],
         [ 9.2364e-02,  5.5216e-02],
         [ 8.9643e-02,  5.5218e-02],
         [ 8.6858e-02,  5.5227e-02],
         [ 6.9857e-02,  5.5232e-02],
         [ 6.3970e-02,  5.5230e-02],
         [-1.0048e-01,  5.5230e-02],
         [-8.5366e-02,  5.5231e-02],
         [-9.5783e-02,  5.5236e-02],
         [ 9.1229e-02,  5.5235e-02],
         [ 8.9584e-02,  5.5232e-02],
         [-9.8317e-02,  5.5232e-02],
         [ 8.9402e-02,  5.5231e-02],
         [ 9.9461e-02,  5.5231e-02],
         [-9.9766e-02,  5.5231e-02],
         [-8.1074e-02,  5.5231e-02],
         [ 8.8782e-02,  5.5231e-02],
         [-7.4372e-02,  5.5231e-02],
         [ 9.2461e-02,  5.5231e-02],
         [ 1.0406e-01,  5.5231e-02],
         [-8.3496e-02,  5.5231e-02],
         [-8.9426e-02,  5.5231e-02],
         [ 9.8500e-02,  5.5231e-02],
         [ 9.2749e-02,  5.5231e-02],
         [ 9.9265e-02,  5.5231e-02],
         [-9.3662e-02,  5.5231e-02],
         [ 9.0556e-02,  5.5231e-02],
         [-8.0988e-02,  5.5231e-02],
         [-6.5458e-02,  5.5231e-02],
         [-5.4783e-02,  5.5231e-02],
         [-4.2284e-02,  5.5231e-02],
         [-3.7984e-02,  5.5231e-02],
         [-4.1981e-02,  5.5231e-02],
         [-6.4957e-02,  5.5231e-02],
         [-6.8494e-02,  5.5231e-02],
         [ 8.9740e-02,  5.5231e-02],
         [-6.4930e-02,  5.5231e-02],
         [-5.2584e-02,  5.5231e-02],
         [-1.6482e-02,  5.5231e-02],
         [-4.8175e-02,  5.5231e-02],
         [-6.2841e-02,  5.5231e-02],
         [-5.0349e-02,  5.5231e-02],
         [-3.7229e-02,  5.5231e-02],
         [-4.9564e-02,  5.5231e-02],
         [-6.8678e-02,  5.5231e-02],
         [ 1.0379e-01,  5.5231e-02],
         [-8.4055e-02,  5.5231e-02],
         [-5.8359e-02,  5.5231e-02],
         [-1.9431e-02,  5.5231e-02],
         [-1.8759e-02,  5.5231e-02],
         [-5.2005e-02,  5.5231e-02],
         [ 1.0050e-01,  5.5231e-02],
         [ 1.0505e-01,  5.5231e-02],
         [-8.4884e-02,  5.5231e-02],
         [-8.3419e-02,  5.5231e-02],
         [-8.6405e-02,  5.5231e-02],
         [-8.5407e-02,  5.5231e-02],
         [-8.0558e-02,  5.5231e-02],
         [ 8.4611e-02,  5.5231e-02],
         [-9.2530e-02,  5.5231e-02],
         [-7.6547e-02,  5.5231e-02],
         [-7.6282e-02,  5.5231e-02],
         [-2.1377e-02,  5.5231e-02],
         [-2.1971e-02,  5.5231e-02],
         [-4.2730e-02,  5.5231e-02],
         [-3.5601e-02,  5.5231e-02],
         [-3.8748e-02,  5.5231e-02],
         [-8.4820e-03,  5.5231e-02],
         [ 1.4431e-01,  5.5231e-02],
         [-1.3235e-02,  5.5231e-02],
         [ 2.4327e-03,  5.5231e-02],
         [-7.3893e-03,  5.5231e-02],
         [-4.5372e-02,  5.5231e-02],
         [-5.7264e-02,  5.5231e-02],
         [-7.5313e-02,  5.5231e-02],
         [-7.8540e-02,  5.5231e-02],
         [ 9.6672e-02,  5.5231e-02],
         [-9.4656e-02,  5.5231e-02],
         [-9.0396e-02,  5.5231e-02],
         [-7.0770e-02,  5.5231e-02],
         [-7.1266e-02,  5.5231e-02],
         [-7.6003e-02,  5.5231e-02],
         [-7.9034e-02,  5.5231e-02],
         [ 8.4931e-02,  5.5231e-02],
         [-3.6010e-02,  5.5231e-02],
         [-3.1493e-02,  5.5231e-02],
         [-3.0247e-02,  5.5231e-02],
         [-3.6103e-02,  5.5231e-02],
         [-5.9124e-02,  5.5231e-02],
         [-7.5796e-02,  5.5231e-02],
         [ 1.2684e-01,  5.5231e-02],
         [ 1.2884e-01,  5.5231e-02],
         [-1.0724e-01,  5.5231e-02],
         [-9.6694e-02,  5.5231e-02],
         [ 9.5625e-02,  5.5231e-02],
         [ 1.1897e-01,  5.5231e-02],
         [-7.5675e-02,  5.5231e-02],
         [-6.6594e-02,  5.5231e-02],
         [-7.5006e-02,  5.5231e-02],
         [ 8.8743e-02,  5.5231e-02],
         [ 9.8603e-02,  5.5231e-02],
         [ 1.2415e-01,  5.5231e-02],
         [ 1.3547e-01,  5.5231e-02],
         [ 1.3105e-01,  5.5231e-02],
         [ 1.3519e-01,  5.5231e-02],
         [ 9.1210e-02,  5.5231e-02],
         [ 1.1483e-01,  5.5231e-02],
         [ 1.1990e-01,  5.5231e-02],
         [ 1.1759e-01,  5.5231e-02],
         [ 1.1518e-01,  5.5231e-02],
         [ 1.4205e-01,  5.5231e-02],
         [ 1.0749e-01,  5.5231e-02],
         [ 1.4153e-01,  5.5231e-02],
         [ 1.0763e-01,  5.5231e-02],
         [ 9.2709e-02,  5.5231e-02],
         [ 1.3073e-01,  5.5231e-02],
         [ 1.2880e-01,  5.5231e-02],
         [ 1.3816e-01,  5.5231e-02],
         [ 1.4230e-01,  5.5231e-02],
         [ 1.1640e-01,  5.5231e-02],
         [ 1.2042e-01,  5.5231e-02],
         [ 1.1552e-01,  5.5231e-02],
         [ 1.1068e-01,  5.5231e-02],
         [ 2.7746e-03,  5.5231e-02]],

        [[ 9.4778e-02,  1.0692e-01],
         [ 9.6645e-02,  1.2998e-01],
         [ 1.1777e-01,  1.4400e-01],
         [ 1.2269e-01,  1.1462e-01],
         [ 9.7915e-02,  1.0882e-01],
         [ 1.2160e-01, -4.7221e-02],
         [ 1.2200e-01, -2.5372e-02],
         [ 9.3507e-02, -4.8737e-02],
         [ 7.9455e-02, -5.2245e-02],
         [ 6.1355e-02, -4.8393e-02],
         [-1.3783e-01, -5.6088e-02],
         [ 5.8764e-02,  1.0900e-01],
         [ 1.0255e-01,  1.0589e-01],
         [ 8.1013e-02, -6.4613e-02],
         [-1.1705e-01, -6.3746e-02],
         [ 9.0388e-02, -5.3720e-02],
         [-1.1697e-01, -6.0114e-02],
         [ 1.0927e-01,  9.0647e-02],
         [ 1.4323e-01,  9.7709e-02],
         [ 1.2367e-01, -7.0528e-02],
         [ 1.0930e-01,  8.5890e-02],
         [ 1.1947e-01,  9.6589e-02],
         [ 1.5744e-01, -7.2901e-02],
         [ 1.2182e-01, -6.5450e-02],
         [ 7.3658e-02, -7.6561e-02],
         [ 9.0879e-02, -6.7298e-02],
         [ 1.0322e-01, -7.5500e-02],
         [ 1.2635e-01,  7.8067e-02],
         [ 1.2381e-01,  8.8153e-02],
         [ 1.2268e-01,  9.3215e-02],
         [ 1.3587e-01, -6.5760e-02],
         [ 1.2816e-01, -6.6511e-02],
         [ 1.0674e-01,  1.2745e-01],
         [ 1.3545e-01,  1.5307e-01],
         [ 8.5769e-02,  1.3000e-01],
         [ 7.9697e-02,  1.1596e-01],
         [ 5.4551e-02,  1.0737e-01],
         [ 9.9927e-02,  6.1056e-02],
         [ 6.4330e-02, -1.5019e-01],
         [ 7.4943e-02,  8.1580e-02],
         [ 1.0926e-01,  9.2965e-02],
         [ 1.4329e-01,  5.3831e-02],
         [ 1.5704e-01,  8.3183e-02],
         [ 1.1740e-01,  9.0627e-02],
         [ 1.0475e-01,  5.0328e-02],
         [ 1.1147e-01,  8.1398e-02],
         [ 1.4375e-01,  1.1608e-01],
         [ 1.4443e-01,  1.0540e-01],
         [ 1.1628e-01,  1.1048e-01],
         [ 1.0612e-01,  9.8121e-02],
         [ 1.2574e-01,  1.2472e-01],
         [ 1.3815e-01,  8.9994e-02],
         [ 1.0880e-01,  1.1554e-01],
         [ 1.2850e-01,  1.3903e-01],
         [ 1.3763e-01,  1.1481e-01],
         [ 1.4409e-01,  1.1135e-01],
         [ 1.1460e-01,  1.3143e-01],
         [ 1.3004e-01,  1.3346e-01],
         [ 7.0686e-03,  8.4842e-02],
         [ 2.8623e-02,  6.0842e-02],
         [ 4.0502e-02, -1.5803e-01],
         [ 4.6248e-02,  7.1869e-02],
         [ 4.8778e-02,  8.2718e-02],
         [ 4.9729e-02,  6.7001e-02],
         [ 5.0065e-02, -1.5528e-01],
         [ 5.0101e-02,  1.4303e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.2394e-05, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.7821, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5775, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4601, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0553, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1914, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0530, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3135592.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1840, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.0255e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1421, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1966, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1421, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3549
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2714e-01,  1.2420e-01,  ...,  7.0546e-02,
            1.5857e-01, -1.0000e+07],
          [-1.0000e+07, -3.8311e-02,  1.3382e-01,  ...,  4.0568e-02,
            1.4396e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4124e-01,  1.2148e-01,  ...,  5.2743e-02,
            1.5640e-01, -1.0000e+07],
          [-1.0000e+07, -4.4101e-02,  1.1387e-01,  ...,  3.1959e-02,
            1.4699e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2225e-02,  6.2394e-02,  ...,  2.0084e-02,
            1.2912e-01, -1.0000e+07],
          [-1.0000e+07, -7.7190e-02,  1.6041e-01,  ...,  7.2365e-02,
            1.5573e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.0171e-02,  4.6061e-02,  ...,  4.1223e-02,
            1.3816e-01, -1.0000e+07],
          [-1.0000e+07, -1.2417e-01,  1.0542e-01,  ...,  6.0142e-02,
            1.7534e-01, -1.0000e+07]],

         ...,

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3740e-01,  4.1005e-02,  ...,  3.3463e-02,
            2.0037e-01, -1.0000e+07]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.2245e-01,  2.2864e-02,  ...,  1.2143e-02,
            1.9666e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.2287e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01, -1.6811e-02],
         [ 1.2420e-01,  1.3382e-01],
         [ 1.2148e-01,  1.1387e-01],
         [ 1.0986e-01,  1.4507e-01],
         [ 1.0952e-01, -6.5580e-02],
         [ 1.2025e-01, -6.5969e-02],
         [ 1.4318e-01, -6.4253e-02],
         [ 1.5263e-01, -7.6448e-02],
         [ 1.0886e-01, -5.6641e-02],
         [ 1.2477e-01, -4.5811e-02],
         [ 9.5833e-02, -5.5508e-02],
         [ 1.3488e-01, -6.6582e-02],
         [ 1.1366e-01, -7.3897e-02],
         [ 1.2369e-01, -6.5384e-02],
         [ 1.1317e-01,  1.0651e-01],
         [ 1.3141e-01,  1.1024e-01],
         [ 1.3784e-01,  1.1873e-01],
         [ 1.3961e-01,  1.1539e-01],
         [ 9.0794e-02,  1.1476e-01],
         [ 1.1373e-01,  7.9695e-02],
         [ 1.1599e-01, -1.4127e-01],
         [ 7.8411e-02,  9.2768e-02],
         [ 3.3602e-03,  1.0712e-01],
         [ 2.9334e-02,  1.1335e-01],
         [ 4.1687e-02,  1.1630e-01],
         [ 4.7262e-02,  8.2573e-02],
         [ 4.9526e-02,  6.1770e-02],
         [ 5.0302e-02,  9.7265e-02],
         [ 5.0450e-02,  8.3062e-02],
         [ 5.0377e-02,  7.4437e-02],
         [ 5.0258e-02, -1.6804e-01],
         [ 5.0170e-02,  7.3025e-02],
         [ 5.0082e-02,  5.5007e-02],
         [ 5.0056e-02,  6.7122e-02],
         [ 5.0041e-02, -1.5856e-01],
         [ 5.0034e-02,  6.6691e-02],
         [ 5.0018e-02,  6.6342e-02],
         [ 5.0013e-02,  9.2782e-02],
         [ 5.0012e-02,  9.0262e-02],
         [ 5.0011e-02, -1.6047e-01],
         [ 5.0013e-02,  7.4254e-02],
         [ 5.0014e-02, -1.3224e-01],
         [ 5.0016e-02,  7.3899e-02],
         [ 5.0008e-02,  8.8205e-02],
         [ 5.0008e-02,  1.0803e-01],
         [ 5.0007e-02,  8.4232e-02],
         [ 5.0007e-02,  9.7753e-02],
         [ 5.0008e-02,  4.9929e-02],
         [ 5.0008e-02, -1.3075e-01],
         [ 5.0008e-02,  6.9812e-02],
         [ 5.0008e-02, -1.2322e-01],
         [ 5.0008e-02,  9.2425e-02],
         [ 5.0008e-02,  1.0459e-01],
         [ 5.0008e-02,  9.5812e-02],
         [ 5.0009e-02,  9.2397e-02],
         [ 5.0009e-02,  8.9915e-02],
         [ 5.0009e-02,  1.0857e-01],
         [ 5.0009e-02,  7.4058e-02],
         [ 5.0009e-02, -1.7166e-01],
         [ 5.0009e-02,  8.1104e-02],
         [ 5.0009e-02, -1.6913e-01],
         [ 5.0009e-02, -7.5836e-04],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 7.4276e-02,  1.4162e-01],
         [-6.2225e-02,  1.6041e-01],
         [-5.0171e-02,  1.0542e-01],
         [-5.5750e-02,  9.9757e-02],
         [-6.0333e-02,  1.0032e-01],
         [-4.5322e-02,  1.1083e-01],
         [-5.4950e-02,  8.8379e-02],
         [-7.1698e-02,  5.0338e-02],
         [-8.9908e-02, -1.6529e-01],
         [-8.8833e-02,  7.0947e-02],
         [-8.6353e-02, -1.5952e-01],
         [-9.3121e-02,  6.7105e-02],
         [-1.0690e-01,  8.5601e-02],
         [-1.1034e-01,  8.7191e-02],
         [ 1.0189e-01,  1.0813e-01],
         [ 1.0957e-01,  1.4163e-01],
         [-1.1353e-01,  1.5074e-01],
         [ 1.0969e-01,  1.3259e-01],
         [ 1.1634e-01,  1.3622e-01],
         [-1.1104e-01,  1.1813e-01],
         [-9.6136e-02,  1.2593e-01],
         [-8.1049e-02, -9.0314e-02],
         [-6.6191e-02, -8.6038e-02],
         [ 1.2084e-01,  1.0832e-01],
         [-7.0868e-02,  1.1736e-01],
         [ 1.1740e-01,  1.2457e-01],
         [-8.4688e-02,  1.0931e-01],
         [-8.0745e-02,  1.3790e-01],
         [-8.2549e-02,  1.2382e-01],
         [ 1.2564e-01,  1.0115e-01],
         [ 1.3462e-01,  8.7414e-02],
         [ 1.2062e-01, -1.0901e-01],
         [-6.8257e-02,  9.4781e-02],
         [-6.2877e-02,  1.2915e-01],
         [ 1.2263e-01, -1.0942e-01],
         [-6.9004e-02,  1.0266e-01],
         [-6.1038e-02, -9.8990e-02],
         [-4.6700e-02, -8.5677e-02],
         [-4.0838e-02,  1.0810e-01],
         [-4.2937e-02, -7.3351e-02],
         [ 1.3812e-01,  1.1151e-01],
         [ 1.4719e-01, -6.8537e-02],
         [ 1.5098e-01,  1.1294e-01],
         [ 1.4491e-01,  1.1886e-01],
         [ 1.4630e-01,  9.7283e-02],
         [-6.1602e-02, -8.3677e-02],
         [ 1.3517e-01,  1.0335e-01],
         [ 1.2611e-01, -8.2644e-02],
         [-5.7862e-02, -8.0513e-02],
         [-6.1121e-02,  1.0655e-01],
         [-4.8498e-02, -8.1731e-02],
         [-5.2068e-02, -7.8955e-02],
         [-4.6674e-02, -8.0622e-02],
         [-5.3021e-02, -6.9637e-02],
         [ 1.3654e-01,  1.2397e-01],
         [ 1.4457e-01,  9.8825e-02],
         [-7.6806e-02,  1.1199e-01],
         [ 1.3258e-01,  1.2232e-01],
         [-7.6624e-02,  8.6092e-02],
         [ 1.3642e-01,  8.1200e-02],
         [ 1.4824e-01, -1.0185e-01],
         [ 1.5449e-01, -1.0816e-01],
         [ 1.5433e-01,  9.7028e-02],
         [ 1.7276e-01,  1.2470e-01],
         [ 1.7542e-01,  7.8740e-02],
         [ 1.5339e-01,  1.2617e-01],
         [ 1.7310e-01,  8.8818e-02],
         [ 1.9181e-01,  1.2856e-01],
         [ 1.4465e-01,  8.0639e-02],
         [ 1.4087e-01,  8.0021e-02],
         [ 1.2356e-01,  9.4826e-02],
         [ 1.5315e-01,  1.0419e-01],
         [ 1.6759e-01,  1.1759e-01],
         [ 1.7295e-01,  1.0442e-01],
         [ 1.8473e-01,  7.3958e-02],
         [ 1.5782e-01,  8.9779e-02],
         [ 1.3241e-01, -1.4819e-01],
         [ 1.6038e-01,  6.1309e-02],
         [ 1.3231e-01, -1.3339e-01],
         [ 1.6362e-01,  5.7766e-02],
         [ 1.7874e-01,  9.3304e-02],
         [ 1.8657e-01,  1.4008e-01],
         [ 1.9861e-01,  1.6050e-01],
         [ 1.5093e-01,  1.5866e-01],
         [ 3.7360e-03,  1.4849e-01],
         [ 2.4588e-02,  1.4539e-01],
         [ 3.7796e-02,  1.4573e-01],
         [ 4.4747e-02,  1.5611e-01],
         [ 4.8003e-02,  1.1793e-01],
         [ 4.9379e-02,  1.4921e-01],
         [ 4.9888e-02,  1.5403e-01],
         [ 5.0033e-02,  1.7582e-01],
         [ 5.0053e-02,  1.2957e-01],
         [ 5.0057e-02, -3.8881e-02],
         [ 5.0038e-02,  1.4044e-01],
         [ 5.0012e-02,  1.5908e-01],
         [ 5.0025e-02, -4.1979e-02],
         [ 5.0015e-02,  1.4436e-01],
         [ 5.0025e-02,  1.5183e-01],
         [ 5.0020e-02,  1.6311e-01],
         [ 5.0021e-02,  1.8162e-01],
         [ 5.0018e-02,  1.1798e-01],
         [ 5.0025e-02,  1.0133e-01],
         [ 5.0018e-02,  8.6351e-02],
         [ 5.0009e-02,  8.9198e-02],
         [ 5.0019e-02, -1.5732e-01],
         [ 5.0005e-02, -1.4853e-01],
         [ 5.0007e-02,  6.7762e-02],
         [ 5.0008e-02,  9.7635e-02],
         [ 5.0008e-02, -1.5611e-01],
         [ 5.0008e-02, -1.3327e-01],
         [ 5.0009e-02,  7.8647e-02],
         [ 5.0008e-02, -1.4467e-01],
         [ 5.0008e-02,  7.9123e-02],
         [ 5.0008e-02,  7.5490e-02],
         [ 5.0008e-02, -1.3740e-01],
         [ 5.0008e-02, -1.2245e-01],
         [ 5.0009e-02,  1.2287e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.8915e-05, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0012, device='cuda:0')
mixer_td_error tensor(0.6146, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4698, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3506, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0597, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2167, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0509, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2372881., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1986, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.3740e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1575, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2253, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1575, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3658
target_mac_out tensor([[[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4689e-02,  1.0709e-01,  ...,  1.4450e-02,
            1.5237e-01, -1.0000e+07],
          [-1.0000e+07, -2.1835e-02,  9.9402e-02,  ..., -1.5839e-02,
            1.3204e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0286e-02,  1.0929e-01,  ...,  4.9539e-03,
            1.4714e-01, -1.0000e+07],
          [-1.0000e+07, -4.0755e-02,  1.1664e-01,  ..., -1.3107e-02,
            1.4728e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5109e-01,  4.3734e-02,  ...,  2.5633e-02,
            1.9335e-01, -3.0600e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4069e-01,  2.7674e-02,  ...,  3.4865e-02,
            1.7954e-01, -3.0370e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.5720e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9711e-02,  8.6010e-02,  ...,  5.5065e-03,
            1.3727e-01, -1.0000e+07],
          [-1.0000e+07, -4.5321e-02,  1.0753e-01,  ...,  3.5616e-02,
            1.4810e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.8586e-02,  7.7246e-02,  ..., -1.5416e-02,
            1.4423e-01, -1.0000e+07],
          [-1.0000e+07, -7.5122e-02,  1.5329e-01,  ...,  6.1145e-02,
            1.5160e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.2300e-02,  8.8635e-02],
         [ 1.0709e-01, -2.1835e-02],
         [ 1.0929e-01,  1.1664e-01],
         [ 1.1707e-01,  1.4906e-01],
         [ 1.2279e-01,  1.5190e-01],
         [-7.0230e-02,  1.1788e-01],
         [-6.3439e-02,  1.1747e-01],
         [-5.2606e-02, -9.5070e-02],
         [-5.1940e-02, -7.5380e-02],
         [-4.3517e-02, -6.3207e-02],
         [-3.2999e-02, -5.5223e-02],
         [-2.6783e-02, -4.6390e-02],
         [-3.4390e-02,  1.1707e-01],
         [-4.7545e-02,  1.3088e-01],
         [-3.6160e-02, -5.9187e-02],
         [-4.9311e-02, -5.2496e-02],
         [-4.8733e-02, -5.5869e-02],
         [-5.2364e-02,  1.2646e-01],
         [-4.5166e-02,  1.3615e-01],
         [-4.1839e-02,  1.4356e-01],
         [-5.6131e-02,  1.2033e-01],
         [ 1.2840e-01,  9.6356e-02],
         [-7.0862e-02,  1.0689e-01],
         [-5.4788e-02,  1.1374e-01],
         [-5.6138e-02,  1.1817e-01],
         [-4.6768e-02, -4.5981e-02],
         [-3.0120e-02, -5.0393e-02],
         [-3.6449e-02,  1.1294e-01],
         [ 1.3902e-01,  1.1477e-01],
         [-3.9704e-02, -8.0738e-02],
         [-4.6655e-02, -7.6878e-02],
         [-3.1340e-02, -6.6109e-02],
         [-3.0144e-02, -5.7405e-02],
         [ 1.2861e-01, -5.2798e-02],
         [ 1.3395e-01,  1.1226e-01],
         [ 1.4656e-01,  1.0098e-01],
         [ 1.4738e-01,  1.2232e-01],
         [ 1.3493e-01,  1.3158e-01],
         [ 9.9820e-02,  1.1388e-01],
         [ 9.7208e-02,  1.2943e-01],
         [ 8.8163e-02,  1.4022e-01],
         [ 1.0250e-01,  1.4787e-01],
         [-1.1067e-01,  1.2195e-01],
         [ 9.1572e-02,  1.4120e-01],
         [ 1.0760e-01,  1.0981e-01],
         [ 9.7120e-02,  1.2752e-01],
         [ 1.1733e-01,  9.8038e-02],
         [ 1.1415e-01,  1.2168e-01],
         [ 1.1194e-01,  1.3593e-01],
         [ 1.2551e-01,  1.2816e-01],
         [ 1.3092e-01, -6.6843e-02],
         [ 1.3263e-01,  1.2196e-01],
         [ 1.3071e-01, -5.8326e-02],
         [-6.1844e-02, -4.7016e-02],
         [-5.8328e-02, -3.5047e-02],
         [ 1.2401e-01,  1.2196e-01],
         [ 1.0169e-01,  1.3879e-01],
         [ 1.1193e-01,  1.5026e-01],
         [ 1.1108e-01,  1.4903e-01],
         [ 1.1977e-01,  1.1366e-01],
         [ 1.3219e-01,  1.3963e-01],
         [ 1.1138e-01,  1.1566e-01],
         [ 1.2885e-01,  1.4543e-01],
         [ 1.2644e-01,  1.1881e-01],
         [ 1.3949e-01,  1.4211e-01],
         [ 1.4276e-01,  1.4916e-01],
         [ 1.4168e-01,  1.4817e-01],
         [ 1.1640e-01,  1.0859e-01],
         [ 1.4400e-01,  1.2352e-01],
         [ 1.2612e-01,  1.3480e-01],
         [ 1.2655e-01,  1.1539e-01],
         [ 1.4689e-01, -8.4696e-02],
         [ 1.4433e-01,  1.1715e-01],
         [ 1.5643e-01,  1.3132e-01],
         [ 1.3460e-01,  8.9971e-02],
         [ 1.5093e-01, -7.0478e-02],
         [ 1.6464e-01,  1.1095e-01],
         [ 1.6342e-01, -8.4823e-02],
         [ 2.4488e-03, -6.0971e-02],
         [ 2.3410e-02, -3.7074e-02],
         [ 3.6787e-02, -3.5789e-02],
         [ 4.3993e-02, -1.5429e-02],
         [ 4.7565e-02, -2.6782e-02],
         [ 4.9168e-02, -2.0664e-02],
         [ 4.9817e-02, -2.7034e-02],
         [ 5.0045e-02, -1.9710e-02],
         [ 5.0112e-02, -2.6331e-02],
         [ 5.0088e-02, -4.8568e-02],
         [ 5.0075e-02, -5.1540e-02],
         [ 5.0057e-02, -4.7392e-02],
         [ 5.0027e-02, -6.9611e-02],
         [ 5.0040e-02, -5.2743e-02],
         [ 5.0031e-02, -2.2996e-02],
         [ 5.0025e-02, -1.7798e-02],
         [ 5.0022e-02, -4.2187e-02],
         [ 5.0021e-02, -6.1868e-02],
         [ 5.0015e-02, -7.6934e-02],
         [ 5.0012e-02, -7.2264e-02],
         [ 5.0019e-02, -6.1691e-02],
         [ 5.0005e-02, -4.8752e-02],
         [ 5.0006e-02, -2.0558e-02],
         [ 5.0008e-02, -4.5918e-02],
         [ 5.0008e-02, -3.3800e-02],
         [ 5.0008e-02, -3.2012e-02],
         [ 5.0009e-02, -3.4425e-02],
         [ 5.0008e-02, -3.7198e-02],
         [ 5.0008e-02, -1.6848e-02],
         [ 5.0008e-02, -4.4272e-02],
         [ 5.0008e-02, -3.2779e-02],
         [ 5.0008e-02, -3.1126e-02],
         [ 5.0009e-02, -5.0180e-02],
         [ 5.0009e-02, -6.6912e-02],
         [ 5.0009e-02, -6.4674e-02],
         [ 5.0009e-02, -4.6148e-02],
         [ 5.0009e-02, -2.7205e-02],
         [ 5.0009e-02, -4.6880e-02],
         [ 5.0009e-02, -4.9745e-02],
         [ 5.0009e-02, -3.5934e-02],
         [ 5.0009e-02, -1.1604e-02],
         [ 5.0009e-02, -1.5037e-03],
         [ 5.0009e-02, -3.5710e-02],
         [ 5.0009e-02, -3.8721e-02],
         [ 5.0009e-02, -6.1944e-02],
         [ 5.0009e-02, -5.3529e-02],
         [ 5.0009e-02, -5.1740e-02],
         [ 5.0009e-02, -3.6481e-02],
         [ 5.0009e-02, -3.4334e-02],
         [ 5.0009e-02, -1.4424e-02],
         [ 5.0009e-02, -2.6294e-02],
         [ 5.0009e-02, -1.0880e-02],
         [ 5.0009e-02, -2.1796e-03],
         [ 5.0009e-02, -3.5703e-02],
         [ 5.0009e-02, -5.5765e-02],
         [ 5.0009e-02, -5.4805e-02],
         [ 5.0009e-02, -6.8823e-02],
         [ 5.0009e-02, -8.0785e-02],
         [ 5.0009e-02, -7.4438e-02],
         [ 5.0009e-02, -6.1959e-02],
         [ 5.0009e-02, -7.3720e-02],
         [ 5.0009e-02, -8.1903e-02],
         [ 5.0009e-02, -6.6492e-02],
         [ 5.0009e-02, -7.2991e-02],
         [ 5.0009e-02, -5.8931e-02],
         [ 5.0009e-02, -5.5145e-02],
         [ 5.0009e-02, -4.9577e-02],
         [ 5.0009e-02, -5.1569e-02],
         [ 5.0009e-02, -5.9566e-02],
         [ 5.0009e-02, -5.4384e-02],
         [ 5.0009e-02, -4.4343e-02],
         [ 5.0009e-02, -5.7328e-02],
         [ 5.0009e-02, -7.0648e-02],
         [ 5.0009e-02, -5.1495e-02],
         [ 5.0009e-02, -3.1097e-02],
         [ 5.0009e-02, -1.0031e-02],
         [ 5.0009e-02, -1.0247e-02],
         [ 5.0009e-02, -7.9768e-03],
         [ 5.0009e-02, -5.9288e-03],
         [ 5.0009e-02, -3.4743e-02],
         [ 5.0009e-02, -2.7162e-02],
         [ 5.0009e-02, -6.2309e-03],
         [ 5.0009e-02, -3.7196e-02],
         [ 5.0009e-02, -5.7009e-02],
         [ 5.0009e-02, -4.9438e-02],
         [ 5.0009e-02, -4.3943e-02],
         [ 5.0009e-02, -4.7101e-02],
         [ 5.0009e-02, -4.0317e-02],
         [ 5.0009e-02, -2.4805e-02],
         [ 5.0009e-02, -6.2786e-03],
         [ 5.0009e-02, -2.0382e-02],
         [ 5.0009e-02, -2.9215e-02],
         [ 5.0009e-02, -1.2467e-02],
         [ 5.0009e-02, -4.1956e-02],
         [ 5.0009e-02, -5.9700e-02],
         [ 5.0009e-02, -5.0565e-02],
         [ 5.0009e-02, -6.4992e-02],
         [ 5.0009e-02, -7.5446e-02],
         [ 5.0009e-02, -8.0783e-02],
         [ 5.0009e-02,  1.0525e-01],
         [ 5.0009e-02,  1.2110e-01],
         [ 5.0009e-02,  1.1905e-01],
         [ 5.0009e-02,  8.1493e-02],
         [ 5.0009e-02, -1.5230e-01],
         [ 5.0009e-02,  8.5680e-02],
         [ 5.0009e-02,  9.8182e-02],
         [ 5.0009e-02,  7.0510e-02],
         [ 5.0009e-02,  9.8478e-02],
         [ 5.0009e-02,  6.5444e-02],
         [ 5.0009e-02,  7.1292e-02],
         [ 5.0009e-02,  8.0597e-02],
         [ 5.0009e-02,  7.6084e-02],
         [ 5.0009e-02,  7.0666e-02],
         [ 5.0009e-02,  8.5560e-02],
         [ 5.0009e-02,  8.5482e-02],
         [ 5.0009e-02,  8.8488e-02],
         [ 5.0009e-02,  5.7154e-02],
         [ 5.0009e-02,  4.6379e-02],
         [ 5.0009e-02,  6.8469e-02],
         [ 5.0009e-02, -1.6561e-01],
         [ 5.0009e-02, -1.5109e-01],
         [ 5.0009e-02, -1.4069e-01],
         [ 5.0009e-02,  8.5720e-03]],

        [[ 7.4276e-02,  1.4162e-01],
         [-6.9711e-02,  1.0753e-01],
         [-7.8586e-02,  1.5329e-01],
         [ 1.0076e-01,  1.3148e-01],
         [ 1.0388e-01,  1.4759e-01],
         [-1.0577e-01,  1.1312e-01],
         [-9.2450e-02,  1.5570e-01],
         [-9.3624e-02,  1.3358e-01],
         [ 1.0653e-01,  1.5320e-01],
         [-8.4031e-02,  1.2994e-01],
         [-9.1158e-02,  1.3363e-01],
         [-1.0274e-01,  1.1379e-01],
         [-9.8919e-02,  1.4016e-01],
         [-9.8481e-02,  1.6199e-01],
         [ 1.0925e-01,  1.5031e-01],
         [-1.1699e-01,  1.4431e-01],
         [-1.1208e-01,  1.2048e-01],
         [ 1.1791e-01, -1.2779e-01],
         [ 1.1777e-01, -1.2437e-01],
         [ 1.2904e-01,  1.1127e-01],
         [ 1.3727e-01, -1.1966e-01],
         [ 1.5609e-01, -1.2379e-01],
         [ 1.6293e-01, -1.1847e-01],
         [ 1.1898e-01, -2.5146e-05],
         [ 1.3153e-01,  3.0002e-02],
         [ 1.0374e-01,  4.5015e-02],
         [-1.6699e-01,  5.1843e-02],
         [ 7.3870e-02,  5.4623e-02],
         [-1.5734e-01,  5.5590e-02],
         [ 1.0763e-01,  5.5764e-02],
         [ 8.0693e-02,  5.5709e-02],
         [-1.4381e-01,  5.5519e-02],
         [-1.2245e-01,  5.5416e-02],
         [ 9.5371e-02,  5.5326e-02],
         [ 1.0704e-01,  5.5294e-02],
         [ 1.0364e-01,  5.5259e-02],
         [-1.2753e-01,  5.5208e-02],
         [ 7.9778e-02,  5.5235e-02],
         [ 8.9420e-02,  5.5219e-02],
         [ 1.0514e-01,  5.5214e-02],
         [-1.1522e-01,  5.5201e-02],
         [-9.2833e-02,  5.5219e-02],
         [ 1.0094e-01,  5.5223e-02],
         [ 8.9426e-02,  5.5231e-02],
         [ 9.2179e-02,  5.5231e-02],
         [-9.7614e-02,  5.5230e-02],
         [ 9.8602e-02,  5.5231e-02],
         [ 1.0804e-01,  5.5232e-02],
         [ 1.2502e-01,  5.5236e-02],
         [ 1.3312e-01,  5.5236e-02],
         [ 1.3634e-01,  5.5232e-02],
         [ 1.2766e-01,  5.5232e-02],
         [ 1.2473e-01,  5.5231e-02],
         [ 1.0027e-01,  5.5231e-02],
         [ 1.0140e-01,  5.5231e-02],
         [ 8.8376e-02,  5.5231e-02],
         [ 9.1831e-02,  5.5231e-02],
         [ 8.9081e-02,  5.5231e-02],
         [ 8.3242e-02,  5.5231e-02],
         [ 9.7892e-02,  5.5231e-02],
         [ 7.2450e-02,  5.5231e-02],
         [ 2.1153e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.4508e-05, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.8336, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5260, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4007, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0514, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1977, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0798, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3457711., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1646, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.0428e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1500, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2480, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1500, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3723
target_mac_out tensor([[[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7413e-02,  9.1951e-02,  ...,  4.7431e-02,
            1.5634e-01, -1.0000e+07],
          [-1.0000e+07, -1.9542e-02,  9.5194e-02,  ...,  4.5180e-03,
            1.4030e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4907e-02,  9.5719e-02,  ...,  2.4923e-02,
            1.5235e-01, -1.0000e+07],
          [-1.0000e+07, -3.7884e-02,  9.5978e-02,  ..., -2.8356e-02,
            1.3624e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7817e-01,  9.8537e-02,  ...,  4.7439e-02,
            1.8094e-01, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.8002e-01,  1.0101e-01,  ...,  3.9088e-02,
            1.7176e-01, -1.0000e+07],
          [ 5.5215e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.0315e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5217e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3285e-02,  8.7210e-02,  ..., -7.6795e-03,
            1.4393e-01, -1.0000e+07],
          [-1.0000e+07, -2.8180e-02,  9.9658e-02,  ..., -1.6816e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5860e-02,  1.0411e-01,  ...,  2.0191e-02,
            1.7078e-01, -1.0000e+07],
          [-1.0000e+07, -2.5520e-02,  1.0800e-01,  ...,  9.6872e-03,
            1.3684e-01, -1.0000e+07]],

         ...,

         [[ 1.3455e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5202e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.8313e-02,  1.0699e-01],
         [ 9.1951e-02, -1.9542e-02],
         [ 9.5719e-02,  9.5978e-02],
         [-6.1909e-02,  1.2112e-01],
         [ 1.0181e-01,  1.1712e-01],
         [ 1.2325e-01,  1.0181e-01],
         [ 1.1046e-01,  1.4455e-01],
         [ 1.1896e-01,  1.6088e-01],
         [ 1.2130e-01,  1.3627e-01],
         [ 1.2508e-01,  1.4786e-01],
         [ 1.3050e-01,  1.5513e-01],
         [ 1.3661e-01,  1.0765e-01],
         [ 1.4742e-01,  9.5794e-02],
         [ 1.5836e-01,  8.3527e-02],
         [ 1.5084e-01,  1.2005e-01],
         [ 1.6046e-01, -1.2867e-01],
         [ 1.2381e-01,  1.1064e-01],
         [ 1.4381e-01, -1.1944e-01],
         [ 1.2491e-01,  1.2143e-01],
         [ 1.3591e-01,  1.3413e-01],
         [ 1.5950e-01,  1.0017e-01],
         [ 1.6351e-01,  1.2531e-01],
         [ 1.7499e-01,  9.3300e-02],
         [ 1.7988e-01,  1.1284e-01],
         [ 1.4202e-01,  8.4452e-02],
         [ 1.6703e-01,  8.5429e-02],
         [ 1.1923e-01,  8.7483e-02],
         [ 1.5715e-01,  1.0990e-01],
         [ 1.6606e-01,  1.2561e-01],
         [ 1.4386e-01,  9.4504e-02],
         [ 1.5060e-01,  1.0239e-01],
         [ 1.6097e-01, -1.5013e-01],
         [ 1.2056e-01,  1.0856e-01],
         [ 1.0239e-01, -1.3681e-01],
         [ 1.0432e-01, -1.4035e-01],
         [ 1.2342e-01, -1.2966e-01],
         [ 1.3042e-01, -1.3355e-01],
         [ 9.9325e-02,  2.7572e-03],
         [ 1.0769e-01,  2.8626e-02],
         [ 8.8383e-02,  4.3828e-02],
         [ 7.9083e-02,  5.1240e-02],
         [ 9.5773e-02,  5.4425e-02],
         [ 7.9592e-02,  5.5534e-02],
         [ 1.0483e-01,  5.5772e-02],
         [ 7.1628e-02,  5.5706e-02],
         [-1.4193e-01,  5.5571e-02],
         [ 7.9819e-02,  5.5459e-02],
         [ 8.7825e-02,  5.5338e-02],
         [ 7.8459e-02,  5.5317e-02],
         [ 8.3961e-02,  5.5260e-02],
         [ 8.4669e-02,  5.5226e-02],
         [ 9.8537e-02,  5.5230e-02],
         [ 1.0101e-01,  5.5215e-02],
         [ 1.0315e-02,  5.5217e-02]],

        [[ 9.6186e-02,  8.7099e-02],
         [ 8.7210e-02,  9.9658e-02],
         [ 1.0411e-01,  1.0800e-01],
         [ 8.4719e-02,  1.1353e-01],
         [ 1.1527e-01,  1.1500e-01],
         [ 1.3986e-01,  1.3945e-01],
         [ 1.5921e-01,  1.2947e-01],
         [ 1.8385e-01,  1.5109e-01],
         [ 1.9812e-01,  1.6420e-01],
         [ 2.0879e-01,  1.3194e-01],
         [ 2.1005e-01,  1.7221e-01],
         [-9.5974e-02,  1.1014e-01],
         [ 1.7339e-01,  1.4619e-01],
         [ 1.6457e-01,  1.7519e-01],
         [ 1.6330e-01,  1.9288e-01],
         [ 1.4416e-01,  1.9414e-01],
         [ 1.3343e-01,  1.8718e-01],
         [ 1.1781e-01,  1.0292e-01],
         [ 1.5939e-01,  1.1416e-01],
         [ 1.3005e-01,  7.5181e-02],
         [ 1.7852e-01,  1.0041e-01],
         [ 1.3769e-01, -1.4056e-01],
         [ 1.5594e-01,  1.0584e-01],
         [ 1.2068e-01,  1.1093e-01],
         [ 1.0612e-01,  1.1869e-01],
         [-1.2082e-01,  8.0068e-02],
         [ 9.5707e-02,  1.0542e-01],
         [-1.2032e-01,  1.1147e-01],
         [ 9.8581e-02,  9.3722e-02],
         [-1.1727e-01,  2.4951e-01],
         [ 7.4457e-02,  2.3845e-01],
         [ 1.0869e-01,  2.3487e-01],
         [ 1.3879e-01,  2.1938e-01],
         [ 1.6416e-01, -1.6333e-01],
         [ 1.7761e-01, -1.4853e-01],
         [ 1.7199e-01, -3.1680e-03],
         [ 1.8096e-01,  3.0600e-02],
         [ 1.9578e-01,  4.5776e-02],
         [ 1.8672e-01,  5.2215e-02],
         [ 2.0169e-01,  5.4716e-02],
         [ 2.0767e-01,  5.5529e-02],
         [ 1.6171e-01,  5.5666e-02],
         [ 1.9383e-01,  5.5585e-02],
         [ 1.8742e-01,  5.5473e-02],
         [ 1.4716e-01,  5.5392e-02],
         [ 1.3056e-01,  5.5314e-02],
         [ 1.5688e-01,  5.5237e-02],
         [ 1.7954e-01,  5.5227e-02],
         [ 1.3839e-01,  5.5213e-02],
         [ 1.7126e-01,  5.5235e-02],
         [ 1.2922e-01,  5.5220e-02],
         [ 1.3455e-02,  5.5202e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.5156e-05, device='cuda:0') tensor(0.0037, device='cuda:0') tensor(-0.0044, device='cuda:0')
mixer_td_error tensor(0.0289, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4710, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9181, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0677, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2256, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0658, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-185185.0781, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2495, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0002, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0041, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2217, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3070, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2217, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3861
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3285e-02,  8.7210e-02,  ..., -7.6795e-03,
            1.4393e-01, -1.0000e+07],
          [-1.0000e+07, -2.8180e-02,  9.9658e-02,  ..., -1.6816e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5860e-02,  1.0411e-01,  ...,  2.0191e-02,
            1.7078e-01, -1.0000e+07],
          [-1.0000e+07, -2.5520e-02,  1.0800e-01,  ...,  9.6872e-03,
            1.3684e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.9665e-02,  5.9675e-02,  ...,  1.7156e-02,
            1.3094e-01, -1.0000e+07],
          [-1.0000e+07, -6.0440e-02,  1.6172e-01,  ...,  4.7207e-02,
            1.5243e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3029e-02,  9.6897e-02,  ...,  4.0310e-02,
            1.5748e-01, -1.0000e+07],
          [-1.0000e+07, -8.1469e-02,  1.3480e-01,  ...,  1.5844e-02,
            1.5054e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.8873e-01,  8.8306e-02,  ...,  8.2151e-02,
            1.6087e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1272e-01,  1.1381e-01,  ...,  9.6378e-02,
            1.8654e-01, -3.3632e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-2.6373e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02,  8.7099e-02],
         [ 8.7210e-02,  9.9658e-02],
         [ 1.0411e-01,  1.0800e-01],
         [-8.0402e-02,  1.1353e-01],
         [ 1.1527e-01,  1.1500e-01],
         [ 1.3986e-01,  1.3945e-01],
         [ 1.5921e-01,  1.2947e-01],
         [ 1.8385e-01,  1.5109e-01],
         [ 1.9812e-01,  1.6420e-01],
         [ 2.0879e-01,  1.3194e-01],
         [ 2.1005e-01,  1.7221e-01],
         [-9.5974e-02,  1.1014e-01],
         [ 1.7339e-01,  1.4619e-01],
         [ 1.6457e-01,  1.7519e-01],
         [ 1.6330e-01,  1.9288e-01],
         [ 1.4416e-01,  1.9414e-01],
         [ 1.3343e-01,  1.8718e-01],
         [ 1.1781e-01,  1.0292e-01],
         [ 1.5939e-01,  1.1416e-01],
         [ 1.3005e-01,  7.5181e-02],
         [ 1.7852e-01, -1.2116e-01],
         [ 1.3769e-01, -1.4056e-01],
         [ 1.5594e-01,  1.0584e-01],
         [ 1.2068e-01,  1.1093e-01],
         [ 1.0612e-01,  1.1869e-01],
         [-1.2082e-01,  8.0068e-02],
         [ 9.5707e-02,  1.0542e-01],
         [-1.2032e-01,  1.1147e-01],
         [ 9.8581e-02,  9.3722e-02],
         [-1.1727e-01,  2.4951e-01],
         [ 7.4457e-02,  2.3845e-01],
         [ 1.0869e-01,  2.3487e-01],
         [ 1.3879e-01,  2.1938e-01],
         [ 1.6416e-01, -1.6333e-01],
         [ 1.7761e-01, -1.4853e-01],
         [ 1.7199e-01, -3.1680e-03],
         [ 1.8096e-01,  3.0600e-02],
         [ 1.9578e-01,  4.5776e-02],
         [ 1.8672e-01,  5.2215e-02],
         [ 2.0169e-01,  5.4716e-02],
         [ 2.0767e-01,  5.5529e-02],
         [ 1.6171e-01,  5.5666e-02],
         [ 1.9383e-01,  5.5585e-02],
         [ 1.8742e-01,  5.5473e-02],
         [ 1.4716e-01,  5.5392e-02],
         [ 1.3056e-01,  5.5314e-02],
         [ 1.5688e-01,  5.5237e-02],
         [ 1.7954e-01,  5.5227e-02],
         [ 1.3839e-01,  5.5213e-02],
         [ 1.7126e-01,  5.5235e-02],
         [ 1.2922e-01,  5.5220e-02],
         [ 1.3455e-02,  5.5202e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 7.2334e-02,  1.2843e-01],
         [-5.9665e-02,  1.6172e-01],
         [ 9.6897e-02,  1.3480e-01],
         [-7.1385e-02,  1.5194e-01],
         [-9.1036e-02,  1.7054e-01],
         [-3.4255e-02,  1.4912e-01],
         [-6.1731e-02,  9.3970e-02],
         [ 1.2557e-01,  1.1742e-01],
         [-7.9815e-02,  1.0149e-01],
         [-9.5855e-02,  7.0386e-02],
         [ 9.9664e-02,  1.0498e-01],
         [-1.0119e-01,  9.4359e-02],
         [ 9.5423e-02,  1.0496e-01],
         [-1.0419e-01,  6.9244e-02],
         [-1.1397e-01,  6.8772e-02],
         [-7.9559e-02, -1.8805e-01],
         [-5.3724e-02,  7.8163e-02],
         [-5.8636e-02, -1.7156e-01],
         [-4.9792e-02, -1.6958e-01],
         [-3.5434e-02, -1.4747e-01],
         [-6.0288e-02, -1.6831e-01],
         [-4.3926e-02, -1.5916e-01],
         [-3.7946e-02, -1.6511e-01],
         [-5.8748e-02, -9.0589e-03],
         [-6.7788e-02,  2.9268e-02],
         [-7.3400e-02,  4.6055e-02],
         [-7.7715e-02,  5.2924e-02],
         [-9.1400e-02,  5.5413e-02],
         [ 9.9197e-02,  5.6087e-02],
         [ 1.1872e-01,  5.6049e-02],
         [ 9.2737e-02,  5.5828e-02],
         [-9.9554e-02,  5.5592e-02],
         [ 1.1064e-01,  5.5430e-02],
         [ 1.2251e-01,  5.5317e-02],
         [ 1.1057e-01,  5.5267e-02],
         [-1.3321e-01,  5.5215e-02],
         [ 9.6490e-02,  5.5211e-02],
         [ 1.0416e-01,  5.5222e-02],
         [-1.1594e-01,  5.5202e-02],
         [-1.0765e-01,  5.5201e-02],
         [-8.5018e-02,  5.5205e-02],
         [-7.3465e-02,  5.5216e-02],
         [-8.3122e-02,  5.5229e-02],
         [-7.0459e-02,  5.5229e-02],
         [-8.5054e-02,  5.5230e-02],
         [ 1.0109e-01,  5.5229e-02],
         [ 9.3778e-02,  5.5232e-02],
         [ 9.9818e-02,  5.5236e-02],
         [-9.7959e-02,  5.5235e-02],
         [-7.8004e-02,  5.5232e-02],
         [-9.9653e-02,  5.5232e-02],
         [-9.6312e-02,  5.5231e-02],
         [-7.7166e-02,  5.5231e-02],
         [-6.7918e-02,  5.5231e-02],
         [-5.8862e-02,  5.5231e-02],
         [-5.6729e-02,  5.5231e-02],
         [-5.5892e-02,  5.5231e-02],
         [-5.4805e-02,  5.5231e-02],
         [-5.3408e-02,  5.5231e-02],
         [-8.2850e-02,  5.5231e-02],
         [-8.4233e-02,  5.5231e-02],
         [-8.4251e-02,  5.5231e-02],
         [ 8.8993e-02,  5.5231e-02],
         [-1.0587e-01,  5.5231e-02],
         [-1.0905e-01,  5.5231e-02],
         [-8.7596e-02,  5.5231e-02],
         [-7.6751e-02,  5.5231e-02],
         [-6.1696e-02,  5.5231e-02],
         [-6.7288e-02,  5.5231e-02],
         [-5.8775e-02,  5.5231e-02],
         [-5.1992e-02,  5.5231e-02],
         [-7.3542e-02,  5.5231e-02],
         [-7.5667e-02,  5.5231e-02],
         [-7.6744e-02,  5.5231e-02],
         [-7.7306e-02,  5.5231e-02],
         [-9.7009e-02,  5.5231e-02],
         [-9.2153e-02,  5.5231e-02],
         [-9.2230e-02,  5.5231e-02],
         [-1.0402e-01,  5.5231e-02],
         [ 1.1627e-01,  5.5231e-02],
         [ 1.2792e-01,  5.5231e-02],
         [ 1.1097e-01,  5.5231e-02],
         [-1.4036e-01,  5.5231e-02],
         [ 1.0765e-01,  5.5231e-02],
         [ 1.1919e-01,  5.5231e-02],
         [ 1.0911e-01,  5.5231e-02],
         [ 1.2506e-01,  5.5231e-02],
         [ 1.4812e-01,  5.5231e-02],
         [ 1.3746e-01,  5.5231e-02],
         [ 1.0251e-01,  5.5231e-02],
         [ 8.8769e-02,  5.5231e-02],
         [ 1.1512e-01,  5.5231e-02],
         [ 9.2493e-02,  5.5231e-02],
         [ 8.4513e-02,  5.5231e-02],
         [ 1.0516e-01,  5.5231e-02],
         [ 8.3673e-02,  5.5231e-02],
         [-1.7905e-01,  5.5231e-02],
         [-1.5571e-01,  5.5231e-02],
         [ 8.8306e-02,  5.5231e-02],
         [ 1.1381e-01,  5.5231e-02],
         [-2.6373e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.4450e-05, device='cuda:0') tensor(0.0020, device='cuda:0') tensor(-0.0029, device='cuda:0')
mixer_td_error tensor(0.6166, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4824, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8153, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0624, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2037, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0424, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2425742.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2495, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.8217e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0023, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2040, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2938, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2040, device='cuda:0', grad_fn=<MinBackward1>)
t_env 3958
target_mac_out tensor([[[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3339e-02,  9.6645e-02,  ...,  1.7415e-02,
            1.4616e-01, -1.0000e+07],
          [-1.0000e+07, -3.2135e-02,  1.2998e-01,  ..., -1.6960e-03,
            1.4491e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.8271e-02,  1.0525e-01,  ...,  1.1768e-02,
            1.6624e-01, -1.0000e+07],
          [-1.0000e+07, -3.6496e-02,  1.0583e-01,  ...,  9.2376e-04,
            1.5021e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6454e-02,  9.8041e-02,  ...,  2.6212e-02,
            1.4254e-01, -1.0000e+07],
          [-1.0000e+07, -6.9791e-02,  1.1912e-01,  ...,  2.3814e-02,
            1.4958e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0073e-01,  1.1228e-01,  ...,  2.1527e-02,
            1.5677e-01, -1.0000e+07],
          [-1.0000e+07, -7.4430e-02,  1.2619e-01,  ...,  2.5142e-02,
            1.4711e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0575e-01,  1.1552e-01,  ...,  5.7407e-02,
            1.7511e-01, -3.2794e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1218e-01,  1.1068e-01,  ...,  5.6260e-02,
            1.7721e-01, -3.2753e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.7746e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.4778e-02, -8.8067e-03],
         [-8.3339e-02,  1.2998e-01],
         [-9.8271e-02, -3.6496e-02],
         [ 1.1486e-01, -3.6523e-02],
         [-1.4034e-01, -4.8004e-02],
         [-1.0643e-01, -4.6541e-02],
         [-8.5312e-02, -3.2434e-02],
         [-8.5009e-02, -2.1440e-02],
         [-9.9463e-02,  1.4157e-01],
         [-1.0543e-01,  1.5234e-01],
         [-9.7917e-02,  1.6066e-01],
         [-9.6388e-02,  1.6676e-01],
         [-1.0855e-01,  1.6929e-01],
         [-9.6606e-02,  1.2703e-01],
         [-5.8224e-02,  1.1151e-01],
         [-6.8688e-02,  1.2190e-01],
         [-1.0957e-01,  1.5786e-01],
         [-1.0489e-01,  1.4298e-01],
         [-1.2640e-01, -1.7485e-01],
         [-1.4521e-01,  1.1424e-01],
         [ 1.2727e-01,  1.1902e-01],
         [-1.4449e-01, -1.9877e-01],
         [ 1.3626e-01, -1.4863e-01],
         [ 1.4267e-01,  1.5298e-01],
         [ 1.4227e-01,  1.4244e-01],
         [ 1.1605e-01,  1.3980e-01],
         [-1.4011e-01, -1.2958e-01],
         [-1.5206e-01,  1.4591e-01],
         [-1.4510e-01,  1.3294e-01],
         [-1.5705e-01,  1.4758e-01],
         [-1.5236e-01,  1.5953e-01],
         [-1.4644e-01,  1.3253e-01],
         [-1.4791e-01, -1.4100e-01],
         [-1.4037e-01,  1.4544e-01],
         [-1.3473e-01, -1.2531e-01],
         [-1.6279e-01, -1.3676e-01],
         [-1.6726e-01,  6.9326e-04],
         [-1.5209e-01,  2.8621e-02],
         [-1.4334e-01,  4.3060e-02],
         [-1.4862e-01,  4.9973e-02],
         [-1.6345e-01,  5.3064e-02],
         [-1.6281e-01,  5.4390e-02],
         [-1.5010e-01,  5.4954e-02],
         [ 1.2820e-01,  5.5160e-02],
         [-1.8476e-01,  5.5232e-02],
         [ 1.0279e-01,  5.5230e-02],
         [ 1.2032e-01,  5.5213e-02],
         [ 9.8441e-02,  5.5218e-02],
         [ 1.1997e-01,  5.5222e-02],
         [ 1.2656e-01,  5.5225e-02],
         [ 1.1176e-01,  5.5229e-02],
         [ 9.1520e-02,  5.5207e-02],
         [-1.6760e-01,  5.5213e-02],
         [-1.5500e-01,  5.5217e-02],
         [-1.4775e-01,  5.5216e-02],
         [-1.3807e-01,  5.5221e-02],
         [-1.4756e-01,  5.5223e-02],
         [-1.4867e-01,  5.5232e-02],
         [-4.8677e-03,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-4.5201e-02,  1.3755e-01],
         [-7.6454e-02, -6.9791e-02],
         [ 1.1228e-01, -7.4430e-02],
         [-9.7914e-02, -9.7806e-02],
         [-9.3815e-02, -1.0272e-01],
         [-6.9760e-02, -1.1685e-01],
         [-7.9699e-02,  9.9376e-02],
         [-9.4670e-02, -1.3090e-01],
         [-1.1410e-01, -8.7246e-02],
         [-1.0847e-01, -6.6225e-02],
         [-1.1888e-01, -6.7477e-02],
         [-1.0693e-01,  1.3676e-01],
         [-8.7417e-02,  1.1305e-01],
         [-7.5781e-02, -7.1461e-02],
         [-7.2878e-02,  1.3933e-01],
         [-7.7453e-02,  1.5308e-01],
         [-9.4343e-02,  1.4767e-01],
         [-1.1193e-01,  1.2407e-01],
         [-1.1238e-01, -1.2465e-01],
         [-1.3058e-01, -1.0396e-01],
         [ 1.0269e-01,  1.4122e-01],
         [-1.3949e-01,  1.5638e-01],
         [-1.2686e-01,  1.3731e-01],
         [-1.2425e-01,  1.5575e-01],
         [-1.4008e-01,  1.6546e-01],
         [-1.4286e-01,  1.3939e-01],
         [-1.3649e-01,  1.6230e-01],
         [-1.3430e-01,  1.8396e-01],
         [-1.2127e-01,  1.5706e-01],
         [-1.2921e-01,  1.5702e-01],
         [ 1.2101e-01,  1.5701e-01],
         [ 1.2505e-01, -1.2776e-01],
         [ 1.2304e-01, -1.1364e-01],
         [-1.4597e-01, -1.0477e-01],
         [-1.0834e-01, -1.0646e-01],
         [-9.9828e-02, -1.2416e-01],
         [-1.1557e-01, -2.0544e-02],
         [-1.4668e-01,  2.3882e-02],
         [-1.1204e-01,  4.3476e-02],
         [-1.1647e-01,  5.1597e-02],
         [-1.4404e-01,  5.4689e-02],
         [ 1.2592e-01,  5.5643e-02],
         [ 1.3374e-01,  5.5776e-02],
         [-1.6796e-01,  5.5666e-02],
         [ 1.1648e-01,  5.5511e-02],
         [-1.4817e-01,  5.5378e-02],
         [-1.5059e-01,  5.5285e-02],
         [ 1.0704e-01,  5.5246e-02],
         [-1.3101e-01,  5.5226e-02],
         [-1.3763e-01,  5.5235e-02],
         [-1.2176e-01,  5.5201e-02],
         [-1.3189e-01,  5.5199e-02],
         [-1.0662e-01,  5.5208e-02],
         [-1.2003e-01,  5.5219e-02],
         [-1.1678e-01,  5.5216e-02],
         [-1.1802e-01,  5.5218e-02],
         [-1.1966e-01,  5.5227e-02],
         [-1.1406e-01,  5.5232e-02],
         [-1.0622e-01,  5.5230e-02],
         [-1.0048e-01,  5.5230e-02],
         [-8.5366e-02,  5.5231e-02],
         [-9.5783e-02,  5.5236e-02],
         [-1.1754e-01,  5.5235e-02],
         [-1.1608e-01,  5.5232e-02],
         [-9.8317e-02,  5.5232e-02],
         [-1.1723e-01,  5.5231e-02],
         [-1.2946e-01,  5.5231e-02],
         [-9.9766e-02,  5.5231e-02],
         [-8.1074e-02,  5.5231e-02],
         [-9.6020e-02,  5.5231e-02],
         [-7.4372e-02,  5.5231e-02],
         [-9.0995e-02,  5.5231e-02],
         [-1.0425e-01,  5.5231e-02],
         [-8.3496e-02,  5.5231e-02],
         [-8.9426e-02,  5.5231e-02],
         [-1.0672e-01,  5.5231e-02],
         [-1.0416e-01,  5.5231e-02],
         [-1.1828e-01,  5.5231e-02],
         [-9.3662e-02,  5.5231e-02],
         [-1.0894e-01,  5.5231e-02],
         [-8.0988e-02,  5.5231e-02],
         [-6.5458e-02,  5.5231e-02],
         [-5.4783e-02,  5.5231e-02],
         [-4.2284e-02,  5.5231e-02],
         [-3.7984e-02,  5.5231e-02],
         [-4.1981e-02,  5.5231e-02],
         [-6.4957e-02,  5.5231e-02],
         [-6.8494e-02,  5.5231e-02],
         [-8.9018e-02,  5.5231e-02],
         [-6.4930e-02,  5.5231e-02],
         [-5.2584e-02,  5.5231e-02],
         [-1.6482e-02,  5.5231e-02],
         [-4.8175e-02,  5.5231e-02],
         [-6.2841e-02,  5.5231e-02],
         [-5.0349e-02,  5.5231e-02],
         [-3.7229e-02,  5.5231e-02],
         [-4.9564e-02,  5.5231e-02],
         [-6.8678e-02,  5.5231e-02],
         [-8.8382e-02,  5.5231e-02],
         [-8.4055e-02,  5.5231e-02],
         [-5.8359e-02,  5.5231e-02],
         [-1.9431e-02,  5.5231e-02],
         [-1.8759e-02,  5.5231e-02],
         [-5.2005e-02,  5.5231e-02],
         [-7.9434e-02,  5.5231e-02],
         [-9.1158e-02,  5.5231e-02],
         [-8.4884e-02,  5.5231e-02],
         [-8.3419e-02,  5.5231e-02],
         [-8.6405e-02,  5.5231e-02],
         [-8.5407e-02,  5.5231e-02],
         [-8.0558e-02,  5.5231e-02],
         [-9.5194e-02,  5.5231e-02],
         [-9.2530e-02,  5.5231e-02],
         [-7.6547e-02,  5.5231e-02],
         [-7.6282e-02,  5.5231e-02],
         [-2.1377e-02,  5.5231e-02],
         [-2.1971e-02,  5.5231e-02],
         [-4.2730e-02,  5.5231e-02],
         [-3.5601e-02,  5.5231e-02],
         [-3.8748e-02,  5.5231e-02],
         [-8.4820e-03,  5.5231e-02],
         [-6.1485e-03,  5.5231e-02],
         [-1.3235e-02,  5.5231e-02],
         [ 2.4327e-03,  5.5231e-02],
         [-7.3893e-03,  5.5231e-02],
         [-4.5372e-02,  5.5231e-02],
         [-5.7264e-02,  5.5231e-02],
         [-7.5313e-02,  5.5231e-02],
         [-7.8540e-02,  5.5231e-02],
         [-9.7576e-02,  5.5231e-02],
         [-9.4656e-02,  5.5231e-02],
         [-9.0396e-02,  5.5231e-02],
         [-7.0770e-02,  5.5231e-02],
         [-7.1266e-02,  5.5231e-02],
         [-7.6003e-02,  5.5231e-02],
         [-7.9034e-02,  5.5231e-02],
         [-9.5928e-02,  5.5231e-02],
         [-3.6010e-02,  5.5231e-02],
         [-3.1493e-02,  5.5231e-02],
         [-3.0247e-02,  5.5231e-02],
         [-3.6103e-02,  5.5231e-02],
         [-5.9124e-02,  5.5231e-02],
         [-7.5796e-02,  5.5231e-02],
         [-1.0985e-01,  5.5231e-02],
         [ 1.2884e-01,  5.5231e-02],
         [-1.0724e-01,  5.5231e-02],
         [-9.6694e-02,  5.5231e-02],
         [-1.0630e-01,  5.5231e-02],
         [-6.6975e-02,  5.5231e-02],
         [-7.5675e-02,  5.5231e-02],
         [-6.6594e-02,  5.5231e-02],
         [-7.5006e-02,  5.5231e-02],
         [-9.6974e-02,  5.5231e-02],
         [-1.0301e-01,  5.5231e-02],
         [-1.2914e-01,  5.5231e-02],
         [ 1.3547e-01,  5.5231e-02],
         [ 1.3105e-01,  5.5231e-02],
         [ 1.3519e-01,  5.5231e-02],
         [-1.6143e-01,  5.5231e-02],
         [ 1.1483e-01,  5.5231e-02],
         [ 1.1990e-01,  5.5231e-02],
         [ 1.1759e-01,  5.5231e-02],
         [ 1.1518e-01,  5.5231e-02],
         [ 1.4205e-01,  5.5231e-02],
         [ 1.0749e-01,  5.5231e-02],
         [ 1.4153e-01,  5.5231e-02],
         [ 1.0763e-01,  5.5231e-02],
         [ 9.2709e-02,  5.5231e-02],
         [ 1.3073e-01,  5.5231e-02],
         [ 1.2880e-01,  5.5231e-02],
         [ 1.3816e-01,  5.5231e-02],
         [ 1.4230e-01,  5.5231e-02],
         [ 1.1640e-01,  5.5231e-02],
         [ 1.2042e-01,  5.5231e-02],
         [ 1.1552e-01,  5.5231e-02],
         [ 1.1068e-01,  5.5231e-02],
         [ 2.7746e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.2059e-05, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0012, device='cuda:0')
mixer_td_error tensor(0.8519, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4671, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5515, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0559, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1778, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0621, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3333333., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1840, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.3347e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0007, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1089, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2961, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1089, device='cuda:0', grad_fn=<MinBackward1>)
t_env 4016
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2225e-02,  6.2394e-02,  ...,  2.0084e-02,
            1.2912e-01, -1.0000e+07],
          [-1.0000e+07, -7.7190e-02,  1.6041e-01,  ...,  7.2365e-02,
            1.5573e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.0171e-02,  4.6061e-02,  ...,  4.1223e-02,
            1.3816e-01, -1.0000e+07],
          [-1.0000e+07, -1.2417e-01,  1.0542e-01,  ...,  6.0142e-02,
            1.7534e-01, -1.0000e+07]],

         ...,

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3740e-01,  4.1005e-02,  ...,  3.3463e-02,
            2.0037e-01, -1.0000e+07]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.2245e-01,  2.2864e-02,  ...,  1.2143e-02,
            1.9666e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.2287e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6085e-02,  1.0713e-01,  ...,  2.0049e-02,
            1.6247e-01, -1.0000e+07],
          [-1.0000e+07, -1.6729e-02,  1.0948e-01,  ...,  2.6640e-03,
            1.2965e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3875e-02,  8.8061e-02,  ..., -8.4055e-03,
            1.5805e-01, -1.0000e+07],
          [-1.0000e+07, -3.6246e-02,  1.0894e-01,  ..., -3.0980e-02,
            1.3536e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.9256e-02,  1.4162e-01],
         [-6.2225e-02, -7.7190e-02],
         [-5.0171e-02, -1.2417e-01],
         [-5.5750e-02, -1.6707e-01],
         [-6.0333e-02, -1.8800e-01],
         [-4.5322e-02,  1.1083e-01],
         [-5.4950e-02, -2.0342e-01],
         [-7.1698e-02, -1.9488e-01],
         [-8.9908e-02, -1.6529e-01],
         [-8.8833e-02, -2.0003e-01],
         [-8.6353e-02, -1.5952e-01],
         [-9.3121e-02, -1.5221e-01],
         [-1.0690e-01, -1.0543e-01],
         [-1.1034e-01, -8.6728e-02],
         [-1.2086e-01, -7.3845e-02],
         [-1.2914e-01, -8.3828e-02],
         [-1.1353e-01,  1.5074e-01],
         [-1.2451e-01, -1.1008e-01],
         [-1.3116e-01, -9.6470e-02],
         [-1.1104e-01, -1.1788e-01],
         [-9.6136e-02, -9.7966e-02],
         [-8.1049e-02, -9.0314e-02],
         [-6.6191e-02, -8.6038e-02],
         [-8.5934e-02, -9.1300e-02],
         [-7.0868e-02, -8.2171e-02],
         [-9.1293e-02, -9.2198e-02],
         [-8.4688e-02, -8.6714e-02],
         [-8.0745e-02, -1.2155e-01],
         [-8.2549e-02, -1.0604e-01],
         [-9.7385e-02, -1.2388e-01],
         [-9.3445e-02, -1.3454e-01],
         [-7.9059e-02, -1.0901e-01],
         [-6.8257e-02, -1.0784e-01],
         [-6.2877e-02, -1.3352e-01],
         [-7.9941e-02, -1.0942e-01],
         [-6.9004e-02, -1.1358e-01],
         [-6.1038e-02, -9.8990e-02],
         [-4.6700e-02, -8.5677e-02],
         [-4.0838e-02, -9.0660e-02],
         [-4.2937e-02, -7.3351e-02],
         [-6.2249e-02, -6.9499e-02],
         [-6.9709e-02, -6.8537e-02],
         [-7.7115e-02, -7.3024e-02],
         [-6.8878e-02, -9.6045e-02],
         [-8.1623e-02, -9.4505e-02],
         [-6.1602e-02, -8.3677e-02],
         [-7.2736e-02, -9.3405e-02],
         [-6.3625e-02, -8.2644e-02],
         [-5.7862e-02, -8.0513e-02],
         [-6.1121e-02, -8.8742e-02],
         [-4.8498e-02, -8.1731e-02],
         [-5.2068e-02, -7.8955e-02],
         [-4.6674e-02, -8.0622e-02],
         [-5.3021e-02, -6.9637e-02],
         [-7.4812e-02, -1.0627e-01],
         [-8.4894e-02, -1.1495e-01],
         [-7.6806e-02, -1.3333e-01],
         [-9.3026e-02, -1.4517e-01],
         [-7.6624e-02, -1.2105e-01],
         [-8.6545e-02, -1.1305e-01],
         [-8.4799e-02, -1.0185e-01],
         [-8.5123e-02, -1.0816e-01],
         [-8.9595e-02, -1.2705e-01],
         [ 1.7276e-01, -1.5509e-01],
         [ 1.7542e-01, -1.3494e-01],
         [ 1.5339e-01, -1.6029e-01],
         [ 1.7310e-01, -1.5219e-01],
         [ 1.9181e-01,  1.2856e-01],
         [ 1.4465e-01, -1.5636e-01],
         [-1.6692e-01, -1.4369e-01],
         [-1.5489e-01, -1.4515e-01],
         [-1.5891e-01, -1.5587e-01],
         [ 1.6759e-01,  1.1759e-01],
         [ 1.7295e-01, -1.6748e-01],
         [ 1.8473e-01, -1.6753e-01],
         [ 1.5782e-01, -1.6418e-01],
         [-1.6513e-01, -1.4819e-01],
         [ 1.6038e-01, -1.4315e-01],
         [-1.5843e-01, -1.3339e-01],
         [ 1.6362e-01, -1.4066e-01],
         [ 1.7874e-01, -1.0875e-01],
         [ 1.8657e-01,  1.4008e-01],
         [ 1.9861e-01,  1.6050e-01],
         [-1.5705e-01,  1.5866e-01],
         [ 3.7360e-03,  1.4849e-01],
         [ 2.4588e-02,  1.4539e-01],
         [ 3.7796e-02,  1.4573e-01],
         [ 4.4747e-02,  1.5611e-01],
         [ 4.8003e-02, -5.4810e-02],
         [ 4.9379e-02, -5.7033e-02],
         [ 4.9888e-02,  1.5403e-01],
         [ 5.0033e-02,  1.7582e-01],
         [ 5.0053e-02, -5.2941e-02],
         [ 5.0057e-02, -3.8881e-02],
         [ 5.0038e-02, -5.1325e-02],
         [ 5.0012e-02,  1.5908e-01],
         [ 5.0025e-02, -4.1979e-02],
         [ 5.0015e-02, -5.2161e-02],
         [ 5.0025e-02,  1.5183e-01],
         [ 5.0020e-02,  1.6311e-01],
         [ 5.0021e-02,  1.8162e-01],
         [ 5.0018e-02, -9.2120e-02],
         [ 5.0025e-02, -1.3383e-01],
         [ 5.0018e-02, -1.4719e-01],
         [ 5.0009e-02, -1.5709e-01],
         [ 5.0019e-02, -1.5732e-01],
         [ 5.0005e-02, -1.4853e-01],
         [ 5.0007e-02, -1.6434e-01],
         [ 5.0008e-02, -1.8347e-01],
         [ 5.0008e-02, -1.5611e-01],
         [ 5.0008e-02, -1.3327e-01],
         [ 5.0009e-02, -1.4981e-01],
         [ 5.0008e-02, -1.4467e-01],
         [ 5.0008e-02, -1.6552e-01],
         [ 5.0008e-02, -1.5647e-01],
         [ 5.0008e-02, -1.3740e-01],
         [ 5.0008e-02, -1.2245e-01],
         [ 5.0009e-02,  1.2287e-02]],

        [[-7.2275e-02, -1.3772e-02],
         [-9.6085e-02, -1.6729e-02],
         [-9.3875e-02, -3.6246e-02],
         [-8.3684e-02, -3.0700e-02],
         [-8.3479e-02, -5.2606e-02],
         [-9.8128e-02, -4.0782e-02],
         [-5.0888e-02, -5.7989e-02],
         [-3.7096e-02, -6.3909e-02],
         [-5.9501e-02, -7.1258e-02],
         [-7.4686e-02, -5.4691e-02],
         [-9.2496e-02, -4.4071e-02],
         [-1.4150e-01, -4.9890e-02],
         [-1.6530e-01,  1.6509e-01],
         [-1.8353e-01,  1.6682e-01],
         [-1.9004e-01,  1.6277e-01],
         [-1.9500e-01,  1.6612e-01],
         [-1.4735e-01,  1.2394e-01],
         [-1.7770e-01, -6.7941e-02],
         [-1.4258e-01,  1.4207e-01],
         [-1.8166e-01,  1.5596e-01],
         [-1.9272e-01,  1.2716e-01],
         [-1.8095e-01,  1.1264e-01],
         [-1.9577e-01, -1.4897e-01],
         [-2.1429e-01, -1.3844e-01],
         [-2.1323e-01, -1.3551e-01],
         [ 1.4057e-01,  1.8054e-01],
         [-2.2141e-01,  1.7876e-01],
         [-2.1508e-01, -1.3127e-01],
         [-1.8639e-01, -1.1781e-01],
         [-1.8151e-01, -1.1179e-01],
         [-1.8743e-01, -1.2224e-01],
         [ 1.3098e-01, -1.0769e-01],
         [ 1.3012e-01, -1.0320e-01],
         [-1.8694e-01, -1.0290e-01],
         [ 1.3104e-01,  1.4288e-01],
         [-2.0541e-01, -1.3641e-01],
         [-1.9967e-01, -1.2104e-01],
         [-1.7193e-01,  1.5734e-01],
         [-1.4674e-01,  1.3776e-01],
         [-1.4801e-01,  1.1786e-01],
         [-1.0401e-01, -1.9286e-01],
         [-1.0119e-01, -2.0066e-01],
         [-7.3282e-02, -2.1472e-01],
         [-8.0858e-02, -2.0009e-01],
         [-1.1280e-01, -1.9523e-01],
         [-1.3056e-01, -2.1835e-01],
         [ 1.2186e-01, -1.7497e-01],
         [-1.9159e-01, -1.5150e-01],
         [-1.7641e-01, -1.3366e-01],
         [-1.8604e-01, -1.1579e-01],
         [ 1.0728e-01, -9.9206e-02],
         [-1.6040e-01, -1.3112e-01],
         [ 9.6498e-02, -1.1043e-01],
         [-1.4781e-01, -1.6702e-01],
         [-1.4570e-01, -1.5211e-01],
         [-1.4404e-01, -1.9181e-01],
         [-1.6128e-01, -2.0604e-01],
         [-1.4057e-01, -1.6404e-01],
         [-1.2869e-01, -1.8978e-01],
         [-1.3186e-01, -2.0783e-01],
         [-1.4247e-01, -2.1563e-01],
         [-1.3404e-01, -2.1698e-01],
         [-1.1818e-01,  2.5994e-01],
         [-1.3238e-01, -1.8313e-01],
         [-1.3646e-01, -1.6130e-02],
         [-1.5619e-01,  2.2383e-02],
         [-1.4554e-01,  4.1224e-02],
         [ 1.0865e-01,  4.9815e-02],
         [-1.8399e-01,  5.3394e-02],
         [-1.5288e-01,  5.4752e-02],
         [-1.4522e-01,  5.5197e-02],
         [-1.3252e-01,  5.5260e-02],
         [-1.2247e-01,  5.5271e-02],
         [-1.3183e-01,  5.5242e-02],
         [-1.3998e-01,  5.5212e-02],
         [-1.4584e-01,  5.5195e-02],
         [-1.3369e-01,  5.5188e-02],
         [-1.2341e-01,  5.5194e-02],
         [-1.0620e-01,  5.5217e-02],
         [-6.5778e-02,  5.5199e-02],
         [-6.3363e-02,  5.5205e-02],
         [-6.6059e-02,  5.5211e-02],
         [-7.1007e-02,  5.5207e-02],
         [-7.3044e-02,  5.5212e-02],
         [-7.3217e-02,  5.5229e-02],
         [-1.0671e-01,  5.5230e-02],
         [-1.3724e-01,  5.5230e-02],
         [-1.8356e-01,  5.5230e-02],
         [-1.7091e-01,  5.5234e-02],
         [ 1.0300e-01,  5.5235e-02],
         [-1.7566e-01,  5.5235e-02],
         [-1.7033e-01,  5.5232e-02],
         [-1.7180e-01,  5.5232e-02],
         [-1.7826e-01,  5.5231e-02],
         [-5.4609e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(9.1410e-05, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0007, device='cuda:0')
mixer_td_error tensor(0.3012, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4639, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3477, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0392, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1396, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0798, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-974576.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2599, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.6804e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2152, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2854, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2152, device='cuda:0', grad_fn=<MinBackward1>)
t_env 4137
target_mac_out tensor([[[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.5332e-02,  1.0633e-01,  ...,  1.1655e-02,
            1.4391e-01, -1.0000e+07],
          [-1.0000e+07, -2.6454e-02,  8.1447e-02,  ..., -2.4863e-04,
            1.4016e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0588e-01,  1.2326e-01,  ...,  4.2593e-02,
            1.5787e-01, -1.0000e+07],
          [-1.0000e+07, -2.5205e-02,  9.5811e-02,  ...,  2.0416e-02,
            1.3987e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.8762e-01,  9.8021e-02,  ...,  5.0257e-02,
            1.6085e-01, -3.1810e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.2009e-01,  1.1096e-01,  ...,  7.4524e-02,
            1.9348e-01, -3.3262e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 4.1767e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3011e-02,  8.5302e-02,  ...,  4.7299e-02,
            1.3351e-01, -1.0000e+07],
          [-1.0000e+07, -8.3580e-02,  1.5949e-01,  ...,  7.7397e-02,
            1.5469e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0035e-02,  7.8002e-02,  ...,  4.0203e-02,
            1.2817e-01, -1.0000e+07],
          [-1.0000e+07, -9.1473e-02,  1.2838e-01,  ...,  3.2495e-02,
            1.6125e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-6.8669e-02, -2.0465e-02],
         [-6.5332e-02, -2.6454e-02],
         [-1.0588e-01, -2.5205e-02],
         [-1.1671e-01, -1.2618e-02],
         [-1.5585e-01, -1.1568e-02],
         [-1.5811e-01, -1.8203e-02],
         [-1.2740e-01, -3.5795e-02],
         [-1.0946e-01, -2.8125e-02],
         [-1.1002e-01, -2.6789e-02],
         [-9.8912e-02, -2.9369e-02],
         [-1.2730e-01, -1.3803e-02],
         [-1.3953e-01, -2.3129e-02],
         [-1.4930e-01, -4.1006e-02],
         [-1.0189e-01, -4.9439e-02],
         [-1.0202e-01, -4.0344e-02],
         [-5.6225e-02, -5.4333e-02],
         [-5.9541e-02, -3.6434e-02],
         [-7.0885e-02, -4.6843e-02],
         [-7.2858e-02, -4.6221e-02],
         [-4.5355e-02, -3.2372e-02],
         [-6.3377e-02, -3.1388e-02],
         [-9.2776e-02, -3.1362e-02],
         [-8.3251e-02, -1.1357e-02],
         [-9.8747e-02, -3.4574e-02],
         [-1.1586e-01, -4.8661e-02],
         [-1.2481e-01, -5.7963e-02],
         [-1.3791e-01, -4.6993e-02],
         [-1.4032e-01, -5.8085e-02],
         [-1.2850e-01, -6.1262e-02],
         [-1.1457e-01, -6.7038e-02],
         [-1.2307e-01, -6.9158e-02],
         [-1.1369e-01, -6.4880e-02],
         [-7.6639e-02, -5.7208e-02],
         [-7.6228e-02, -6.0718e-02],
         [-7.2190e-02, -4.9659e-02],
         [-7.2431e-02, -5.9460e-02],
         [-4.2783e-02, -4.3379e-02],
         [-5.0009e-02, -3.6244e-02],
         [-2.0896e-02, -4.4724e-02],
         [-3.1626e-02, -3.4678e-02],
         [-5.2765e-02, -3.4089e-02],
         [-3.0631e-02, -3.2448e-02],
         [-4.4616e-02, -3.2722e-02],
         [-2.5375e-02, -4.4685e-02],
         [ 7.7391e-03, -4.8358e-02],
         [ 3.1768e-02, -4.2245e-02],
         [ 2.5968e-02, -4.7098e-02],
         [ 5.3542e-03, -5.9622e-02],
         [ 1.5352e-02, -6.2666e-02],
         [-3.2144e-02, -8.4151e-02],
         [-5.2619e-04, -7.5030e-02],
         [-4.2937e-02, -8.6730e-02],
         [-5.2002e-02, -7.2070e-02],
         [-5.7144e-02, -4.5560e-02],
         [-6.2749e-02, -4.6027e-02],
         [-5.9675e-02, -4.7328e-02],
         [-7.3091e-02, -5.2257e-02],
         [-1.9904e-02, -2.9274e-02],
         [ 4.6715e-04,  1.5793e-04],
         [ 6.4897e-03, -1.5818e-02],
         [ 5.5789e-03, -4.1912e-02],
         [ 8.8640e-03, -2.4279e-02],
         [-3.5913e-02, -1.6624e-02],
         [-6.3681e-02, -3.2892e-02],
         [-5.3724e-02, -6.4372e-02],
         [-7.9360e-02, -6.7365e-02],
         [-9.9420e-02, -7.3172e-02],
         [-5.6322e-02, -9.7610e-02],
         [-6.2482e-02, -9.8017e-02],
         [-3.9085e-02, -1.0675e-01],
         [-3.6937e-02, -1.1948e-01],
         [-4.5122e-02, -1.2382e-01],
         [-8.7873e-02, -1.2109e-01],
         [-1.1505e-01, -1.3002e-01],
         [-1.0637e-01, -1.1990e-01],
         [-1.3342e-01, -1.1437e-01],
         [-1.0632e-01, -1.2373e-01],
         [ 1.8534e-01, -1.2947e-01],
         [ 1.9915e-01, -1.1975e-01],
         [-5.5616e-02, -1.2475e-01],
         [-6.0084e-02, -1.1433e-01],
         [-6.8651e-02, -1.0761e-01],
         [-7.3094e-02, -1.0341e-01],
         [-9.7697e-02, -1.2284e-01],
         [-1.0173e-01, -1.0909e-01],
         [-8.3318e-02, -1.1416e-01],
         [-6.9706e-02, -1.8891e-02],
         [-9.6394e-02,  2.4529e-02],
         [-1.2176e-01,  4.3381e-02],
         [-1.4145e-01,  5.1127e-02],
         [-3.1560e-01,  5.4137e-02],
         [-3.1965e-01,  5.5151e-02],
         [-3.2962e-01,  5.5407e-02],
         [ 1.2640e-01,  5.5408e-02],
         [-3.3767e-01,  5.5346e-02],
         [-3.3710e-01,  5.5254e-02],
         [-2.0586e-01,  5.5222e-02],
         [ 1.3067e-01,  5.5227e-02],
         [ 1.3079e-01,  5.5202e-02],
         [ 1.3111e-01,  5.5215e-02],
         [-3.4278e-01,  5.5214e-02],
         [-3.3362e-01,  5.5188e-02],
         [-3.3090e-01,  5.5206e-02],
         [-3.2876e-01,  5.5210e-02],
         [-2.0390e-01,  5.5212e-02],
         [-2.0036e-01,  5.5219e-02],
         [-1.8150e-01,  5.5221e-02],
         [-1.8762e-01,  5.5231e-02],
         [-2.2009e-01,  5.5230e-02],
         [ 4.1767e-03,  5.5230e-02]],

        [[-1.0152e-01, -5.4216e-02],
         [-8.3011e-02, -8.3580e-02],
         [-7.0035e-02, -9.1473e-02],
         [-1.0232e-01, -9.6055e-02],
         [-1.0471e-01, -1.2050e-01],
         [-1.5567e-01, -1.3299e-01],
         [-1.8085e-01, -1.3516e-01],
         [-1.7580e-01, -1.2725e-01],
         [ 1.5084e-01, -1.4205e-01],
         [-1.8368e-01, -1.3700e-01],
         [-1.8931e-01, -1.4171e-01],
         [-1.7862e-01, -1.4306e-01],
         [-1.7346e-01, -1.4343e-01],
         [-1.8413e-01, -1.4134e-01],
         [ 1.6755e-01, -1.2121e-01],
         [-1.7902e-01, -1.2227e-01],
         [-1.5436e-01, -1.4641e-01],
         [-1.7501e-01, -1.5777e-01],
         [-1.7908e-01, -1.5670e-01],
         [-1.8584e-01, -1.3713e-01],
         [-1.7306e-01, -1.1358e-01],
         [-1.6030e-01, -9.7187e-02],
         [-1.7668e-01, -1.0516e-01],
         [-1.5696e-01, -9.1798e-02],
         [-1.7551e-01, -9.3557e-02],
         [-1.7597e-01, -1.1101e-02],
         [-1.9658e-01,  2.6444e-02],
         [ 1.3307e-01,  4.3606e-02],
         [-1.7859e-01,  5.1050e-02],
         [-2.0111e-01,  5.4063e-02],
         [-1.7740e-01,  5.5156e-02],
         [-1.4684e-01,  5.5470e-02],
         [-1.3707e-01,  5.5476e-02],
         [-1.3766e-01,  5.5380e-02],
         [-1.5578e-01,  5.5320e-02],
         [ 1.2244e-01,  5.5268e-02],
         [ 1.3275e-01,  5.5237e-02],
         [-1.8791e-01,  5.5215e-02],
         [ 1.2092e-01,  5.5205e-02],
         [ 1.2078e-01,  5.5220e-02],
         [ 1.4391e-01,  5.5217e-02],
         [ 1.5036e-01,  5.5221e-02],
         [ 1.1015e-01,  5.5202e-02],
         [-1.9624e-01,  5.5219e-02],
         [ 1.2297e-01,  5.5223e-02],
         [-2.0593e-01,  5.5231e-02],
         [-1.7559e-01,  5.5231e-02],
         [-1.7815e-01,  5.5230e-02],
         [-9.2490e-04,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.6310e-05, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0023, device='cuda:0')
mixer_td_error tensor(0.6646, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4600, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6081, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0192, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1027, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1444, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2772727., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1991, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.1388e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0013, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1612, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3744, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1612, device='cuda:0', grad_fn=<MinBackward1>)
t_env 4296
target_mac_out tensor([[[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.1908e-02,  7.1628e-02,  ...,  3.0978e-03,
            1.2913e-01, -1.0000e+07],
          [-1.0000e+07, -3.1400e-02,  1.4762e-01,  ...,  2.0198e-03,
            1.5187e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7357e-02,  7.2546e-02,  ..., -1.2115e-02,
            1.4121e-01, -1.0000e+07],
          [-1.0000e+07, -3.8792e-02,  1.6292e-01,  ..., -7.4744e-03,
            1.6052e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6666e-01,  6.7277e-02,  ...,  4.2074e-02,
            1.2994e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.5088e-01,  4.7743e-02,  ...,  4.6411e-02,
            1.1840e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.2708e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0799e-01,  1.0994e-01,  ...,  4.2512e-02,
            1.4205e-01, -1.0000e+07],
          [-1.0000e+07, -4.1562e-02,  1.2343e-01,  ...,  1.2672e-02,
            1.4219e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3438e-01,  9.7930e-02,  ...,  1.1659e-02,
            1.6183e-01, -1.0000e+07],
          [-1.0000e+07, -4.3874e-02,  1.2534e-01,  ...,  1.1010e-03,
            1.3669e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.3449e-02, -2.1358e-02],
         [-6.1908e-02, -3.1400e-02],
         [-7.7357e-02, -3.8792e-02],
         [-5.0601e-02, -5.8105e-02],
         [-7.3077e-02, -5.3262e-02],
         [-4.9715e-02, -5.8941e-02],
         [-5.2217e-02, -6.1788e-02],
         [ 1.5520e-01, -7.6118e-02],
         [ 1.6333e-01, -5.6495e-02],
         [ 1.7725e-01, -6.4970e-02],
         [-2.1181e-02, -5.5164e-02],
         [ 6.8323e-03, -7.3987e-02],
         [-8.4277e-03, -5.5711e-02],
         [-1.8376e-02, -6.0434e-02],
         [-3.2191e-02, -3.0044e-02],
         [-6.3426e-02, -2.5155e-02],
         [-8.9235e-02, -3.1515e-02],
         [ 1.7493e-01, -3.2455e-02],
         [ 1.7482e-01,  1.6139e-01],
         [-1.2819e-01,  1.4813e-01],
         [ 1.6799e-01,  1.5743e-01],
         [-9.7932e-02,  1.6295e-01],
         [-8.6336e-02,  1.2947e-01],
         [-8.4565e-02,  1.6513e-01],
         [ 1.7096e-01,  1.5775e-01],
         [-8.0227e-02, -7.0246e-02],
         [ 1.7557e-01,  1.5667e-01],
         [-7.8508e-02,  1.5379e-01],
         [-7.7332e-02, -1.0024e-01],
         [ 1.5597e-01, -8.8900e-02],
         [-7.5097e-02, -7.6478e-02],
         [ 1.5345e-01, -7.5209e-02],
         [ 1.5875e-01, -6.2893e-02],
         [ 1.4079e-01, -5.5314e-02],
         [-4.7229e-02, -3.4155e-02],
         [ 1.4175e-01, -2.1217e-02],
         [ 1.5854e-01, -9.2338e-03],
         [ 1.6767e-01, -2.2705e-02],
         [ 1.7125e-01, -2.2168e-02],
         [ 1.7332e-01, -4.3105e-02],
         [-8.0780e-02,  1.5144e-01],
         [ 1.6466e-01,  1.4136e-01],
         [ 1.7726e-01,  1.5784e-01],
         [ 1.6582e-01,  1.3438e-01],
         [ 1.6880e-01,  1.5975e-01],
         [-8.4694e-02,  1.6100e-01],
         [ 1.5924e-01,  1.5649e-01],
         [-8.8250e-02, -5.2704e-02],
         [ 1.5276e-01, -4.6195e-02],
         [ 1.6008e-01, -5.8270e-02],
         [ 1.6496e-01, -5.1359e-02],
         [ 1.7216e-01, -5.8309e-02],
         [ 1.8107e-01, -7.3638e-02],
         [ 1.7215e-01,  1.3829e-01],
         [ 1.6419e-01, -7.5399e-02],
         [-8.7308e-02, -5.6075e-02],
         [ 1.7146e-01, -6.8827e-02],
         [ 1.6866e-01, -6.4713e-02],
         [ 1.7657e-01, -6.8092e-02],
         [ 1.8622e-01, -7.1879e-02],
         [ 1.7354e-01, -5.2687e-02],
         [ 1.6929e-01, -5.5074e-02],
         [ 1.6901e-01, -6.6767e-02],
         [ 1.6529e-01, -7.1163e-02],
         [ 1.7046e-01, -6.4783e-02],
         [ 1.7566e-01, -8.0132e-02],
         [ 1.7735e-01, -9.1049e-02],
         [ 1.7775e-01,  1.3002e-01],
         [ 1.6543e-01, -8.2819e-02],
         [ 8.9521e-02, -7.4158e-02],
         [ 8.1663e-02, -7.1632e-02],
         [ 1.7752e-01, -7.2757e-02],
         [ 1.8903e-01, -8.7245e-02],
         [ 1.8810e-01,  1.6416e-01],
         [ 1.8029e-01,  1.6664e-01],
         [ 1.7282e-01,  1.7105e-01],
         [ 1.6848e-01,  1.7135e-01],
         [ 1.4629e-01,  1.7812e-01],
         [ 1.7132e-01,  1.6232e-01],
         [ 1.6232e-01,  1.5699e-01],
         [ 1.7734e-01,  1.5438e-01],
         [ 1.7387e-01, -6.3942e-02],
         [ 2.0663e-01, -6.5658e-02],
         [ 2.1053e-01, -7.3397e-02],
         [ 1.9966e-01, -8.2369e-02],
         [ 1.8272e-01, -8.6819e-02],
         [ 1.7529e-01, -7.5248e-02],
         [-1.1579e-01, -6.1299e-02],
         [ 1.9205e-01, -5.6447e-02],
         [-1.1900e-01, -7.0391e-02],
         [ 1.6333e-01, -6.7150e-02],
         [-9.2779e-02, -1.6950e-02],
         [-6.6610e-02, -3.2856e-02],
         [ 1.8335e-01, -2.6543e-03],
         [ 1.6117e-01, -3.4410e-02],
         [-6.4571e-02, -2.2195e-02],
         [-5.3063e-02, -5.9894e-02],
         [-4.9596e-02, -5.7370e-02],
         [ 1.5497e-01, -7.4282e-02],
         [ 1.6355e-01,  1.8434e-01],
         [ 1.2354e-01,  1.9079e-01],
         [ 1.4998e-01,  1.9972e-01],
         [ 1.5832e-01, -1.0361e-01],
         [ 1.4427e-01, -9.9337e-02],
         [ 1.6025e-01, -9.5831e-02],
         [ 1.4561e-01, -9.7715e-02],
         [ 1.5942e-01, -9.1430e-02],
         [ 1.6564e-01,  1.8814e-01],
         [ 1.4706e-01,  1.9038e-01],
         [ 1.6831e-01,  1.9214e-01],
         [ 1.5318e-01, -9.4637e-02],
         [ 1.4131e-01, -8.9556e-02],
         [ 1.6012e-01, -9.9694e-02],
         [ 1.6104e-01,  1.8931e-01],
         [ 1.5376e-01, -1.2071e-01],
         [ 1.4226e-01, -1.1938e-01],
         [ 1.3007e-01, -1.3522e-01],
         [ 1.8052e-01, -1.2973e-01],
         [ 1.9230e-01,  2.0649e-01],
         [ 2.0304e-01, -1.1773e-01],
         [ 2.2267e-01,  1.9073e-01],
         [ 1.7576e-01, -1.2342e-01],
         [-6.4402e-02, -1.1694e-01],
         [-5.1294e-02, -1.1217e-01],
         [ 1.7760e-01,  1.7928e-01],
         [ 1.9990e-01, -1.1591e-01],
         [-5.4693e-02, -1.1477e-01],
         [ 1.8377e-01,  1.8845e-01],
         [ 1.9061e-01,  1.9397e-01],
         [ 1.6260e-01,  1.9409e-01],
         [-8.6076e-02, -1.1161e-01],
         [-5.3733e-02, -9.5706e-02],
         [-5.5057e-02, -6.5637e-03],
         [-3.0857e-02,  3.0356e-02],
         [-2.5816e-02,  4.6682e-02],
         [-6.3654e-02,  5.3259e-02],
         [-2.0505e-02,  5.5532e-02],
         [-5.8999e-02,  5.6072e-02],
         [-8.3611e-02,  5.5997e-02],
         [-9.7164e-02,  5.5767e-02],
         [-7.6884e-02,  5.5556e-02],
         [-9.0684e-02,  5.5411e-02],
         [-1.1674e-01,  5.5299e-02],
         [-1.3473e-01,  5.5256e-02],
         [-1.2687e-01,  5.5219e-02],
         [-1.0905e-01,  5.5217e-02],
         [-1.2881e-01,  5.5210e-02],
         [-9.1174e-02,  5.5206e-02],
         [-5.4478e-02,  5.5215e-02],
         [ 1.6166e-01,  5.5219e-02],
         [ 1.8111e-01,  5.5211e-02],
         [-1.0327e-01,  5.5217e-02],
         [-1.0147e-01,  5.5223e-02],
         [-1.4142e-01,  5.5232e-02],
         [ 1.3384e-01,  5.5230e-02],
         [ 1.5766e-01,  5.5230e-02],
         [ 1.8700e-01,  5.5231e-02],
         [ 1.8438e-01,  5.5236e-02],
         [ 1.4085e-01,  5.5235e-02],
         [ 1.3668e-01,  5.5232e-02],
         [ 1.6956e-01,  5.5232e-02],
         [ 1.0725e-01,  5.5231e-02],
         [-1.7221e-01,  5.5231e-02],
         [ 1.0312e-01,  5.5231e-02],
         [ 1.7009e-01,  5.5231e-02],
         [ 1.0921e-01,  5.5231e-02],
         [ 1.0841e-01,  5.5231e-02],
         [-3.2553e-01,  5.5231e-02],
         [-3.2182e-01,  5.5231e-02],
         [-3.1247e-01,  5.5231e-02],
         [-3.0927e-01,  5.5231e-02],
         [-1.6666e-01,  5.5231e-02],
         [-1.5088e-01,  5.5231e-02],
         [ 3.2708e-02,  5.5231e-02]],

        [[ 1.4067e-01, -1.6811e-02],
         [ 1.4205e-01, -4.1562e-02],
         [ 1.6183e-01, -4.3874e-02],
         [ 1.6357e-01,  1.3966e-01],
         [ 1.6226e-01,  1.4718e-01],
         [-9.1905e-02,  1.4742e-01],
         [-7.7597e-02,  1.6346e-01],
         [ 1.7695e-01, -7.2884e-02],
         [ 1.6812e-01, -7.6688e-02],
         [ 1.6006e-01,  1.6255e-01],
         [ 1.6605e-01,  1.5677e-01],
         [ 1.6922e-01,  1.6262e-01],
         [ 1.7006e-01, -8.8427e-02],
         [ 1.7811e-01, -7.7269e-02],
         [ 1.9059e-01, -7.7716e-02],
         [ 1.8629e-01, -6.5687e-02],
         [ 1.8679e-01, -7.9206e-02],
         [ 1.7791e-01, -8.2964e-02],
         [ 1.8339e-01, -8.8579e-02],
         [ 1.8246e-01, -9.4719e-02],
         [ 1.7468e-01, -9.7851e-02],
         [ 1.7126e-01, -9.9383e-02],
         [-1.2970e-01, -1.0069e-01],
         [-1.2569e-01,  1.3441e-01],
         [-1.2373e-01, -1.1028e-01],
         [-8.5710e-03, -8.2824e-02],
         [ 2.0147e-02, -6.9538e-02],
         [ 3.6399e-02, -7.5921e-02],
         [ 4.4441e-02, -6.2365e-02],
         [ 4.8131e-02, -7.8547e-02],
         [ 4.9595e-02, -7.3254e-02],
         [ 5.0121e-02, -6.7328e-02],
         [ 5.0214e-02, -5.7440e-02],
         [ 5.0189e-02, -5.5234e-02],
         [ 5.0129e-02, -5.4974e-02],
         [ 5.0072e-02, -3.9688e-02],
         [ 5.0047e-02, -1.7821e-03],
         [ 5.0023e-02,  5.5546e-03],
         [ 5.0026e-02, -1.5447e-02],
         [ 5.0031e-02, -4.4415e-02],
         [ 5.0021e-02, -3.4436e-02],
         [ 5.0018e-02, -5.0084e-02],
         [ 5.0009e-02, -5.0979e-02],
         [ 5.0017e-02, -6.7211e-02],
         [ 5.0022e-02, -5.9878e-02],
         [ 5.0015e-02, -6.4159e-02],
         [ 5.0006e-02, -7.7342e-02],
         [ 5.0007e-02, -2.5247e-02],
         [ 5.0007e-02, -9.8839e-03],
         [ 5.0008e-02, -4.2000e-02],
         [ 5.0008e-02, -3.2936e-02],
         [ 5.0008e-02, -3.2373e-02],
         [ 5.0008e-02, -3.5115e-02],
         [ 5.0008e-02, -3.7828e-02],
         [ 5.0008e-02, -5.1359e-03],
         [ 5.0008e-02,  5.0580e-03],
         [ 5.0008e-02,  8.2051e-03],
         [ 5.0009e-02,  6.5308e-03],
         [ 5.0009e-02,  5.4792e-03],
         [ 5.0009e-02, -1.5851e-02],
         [ 5.0009e-02, -5.1729e-03],
         [ 5.0009e-02, -8.4784e-03],
         [ 5.0009e-02,  2.3201e-03],
         [ 5.0009e-02, -1.5290e-02],
         [ 5.0009e-02, -2.5984e-02],
         [ 5.0009e-02, -3.2550e-02],
         [ 5.0009e-02, -5.2805e-02],
         [ 5.0009e-02, -6.6105e-02],
         [ 5.0009e-02, -5.5886e-02],
         [ 5.0009e-02, -9.8871e-02],
         [ 5.0009e-02, -1.0803e-01],
         [ 5.0009e-02, -1.1816e-01],
         [ 5.0009e-02, -1.2414e-01],
         [ 5.0009e-02, -1.1472e-01],
         [ 5.0009e-02, -1.1821e-01],
         [ 5.0009e-02,  1.0636e-01],
         [ 5.0009e-02,  1.0683e-01],
         [ 5.0009e-02, -1.3640e-01],
         [ 5.0009e-02,  2.1647e-01],
         [ 5.0009e-02,  2.1616e-01],
         [ 5.0009e-02, -1.2263e-01],
         [ 5.0009e-02,  2.1645e-01],
         [ 5.0009e-02,  2.2646e-01],
         [ 5.0009e-02,  2.3087e-01],
         [ 5.0009e-02,  1.0764e-01],
         [ 5.0009e-02,  1.1552e-01],
         [ 5.0009e-02,  1.2484e-01],
         [ 5.0009e-02,  2.1375e-01],
         [ 5.0009e-02, -1.5720e-01],
         [ 5.0009e-02, -1.5423e-01],
         [ 5.0009e-02, -1.5107e-01],
         [ 5.0009e-02, -1.6552e-01],
         [ 5.0009e-02, -1.8411e-01],
         [ 5.0009e-02, -1.7427e-01],
         [ 5.0009e-02, -1.6810e-01],
         [ 5.0009e-02, -1.8747e-01],
         [ 5.0009e-02, -1.6583e-01],
         [ 5.0009e-02, -1.5896e-01],
         [ 5.0009e-02,  2.1483e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-6.2708e-05, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0013, device='cuda:0')
mixer_td_error tensor(0.4754, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4624, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6092, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0030, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1019, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1544, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2155172., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2309, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.5741e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3085, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2943, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3085, device='cuda:0', grad_fn=<MinBackward1>)
t_env 4342
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2179e-02,  8.7653e-02,  ...,  1.1971e-02,
            1.4701e-01, -1.0000e+07],
          [-1.0000e+07, -3.7128e-02,  1.3220e-01,  ...,  9.6965e-03,
            1.4422e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0670e-01,  9.3996e-02,  ...,  1.3476e-02,
            1.4757e-01, -1.0000e+07],
          [-1.0000e+07, -5.6947e-02,  1.4811e-01,  ...,  1.4058e-03,
            1.5377e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6512e-01,  6.2216e-02,  ...,  3.5608e-02,
            2.0634e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6362e-01,  6.8986e-02,  ...,  3.7427e-02,
            2.0629e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 3.7007e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.3745e-02,  1.1397e-01,  ...,  6.2087e-02,
            1.3778e-01, -1.0000e+07],
          [-1.0000e+07, -2.4539e-02,  9.4233e-02,  ..., -1.0851e-02,
            1.2427e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.7459e-02,  9.8722e-02,  ...,  1.3931e-02,
            1.3959e-01, -1.0000e+07],
          [-1.0000e+07, -6.3419e-02,  1.4570e-01,  ...,  3.8138e-02,
            1.4407e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0222e-01,  1.1143e-01,  ...,  1.4510e-02,
            1.5951e-01, -1.0000e+07],
          [-1.0000e+07, -9.0719e-02,  1.6389e-01,  ...,  6.4728e-02,
            1.5741e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 8.7653e-02,  1.3220e-01],
         [ 9.3996e-02,  1.4811e-01],
         [ 6.5283e-02,  1.5513e-01],
         [ 9.2574e-02,  1.5842e-01],
         [ 1.0242e-01,  1.2394e-01],
         [ 1.1377e-01,  1.3279e-01],
         [ 1.2544e-01,  1.0676e-01],
         [ 1.1743e-01,  9.2826e-02],
         [ 1.2237e-01,  1.1837e-01],
         [ 9.5157e-02,  1.2418e-01],
         [ 1.1802e-01,  1.2446e-01],
         [ 1.0894e-01,  1.4675e-01],
         [ 1.3345e-01,  1.5462e-01],
         [ 1.0603e-01,  1.1303e-01],
         [ 1.0521e-01,  8.3441e-02],
         [ 1.2589e-01,  8.2617e-02],
         [ 1.2423e-01,  9.5111e-02],
         [ 1.0900e-01,  6.9949e-02],
         [ 1.2291e-01,  6.4228e-02],
         [ 1.5192e-01,  1.0663e-01],
         [ 1.3989e-01,  1.3384e-01],
         [ 1.5501e-01,  1.0506e-01],
         [ 1.2127e-01,  1.0173e-01],
         [ 1.2150e-01,  1.3216e-01],
         [ 1.1812e-01,  1.4443e-01],
         [ 1.3912e-01,  1.4668e-01],
         [ 1.6477e-01,  1.1413e-01],
         [ 1.5757e-01,  1.0561e-01],
         [ 1.8044e-01,  9.6696e-02],
         [ 1.9289e-01,  1.0787e-01],
         [ 1.6681e-01,  1.1206e-01],
         [ 1.8349e-01,  1.2394e-01],
         [ 1.8538e-01,  1.0958e-01],
         [ 1.8016e-01,  1.1862e-01],
         [ 1.7555e-01,  1.3401e-01],
         [ 1.7898e-01,  8.2080e-02],
         [ 1.9823e-01,  1.7630e-01],
         [ 1.3561e-01,  6.7358e-02],
         [ 1.3009e-01,  7.9019e-02],
         [ 1.3595e-01,  4.9959e-02],
         [ 1.3681e-01,  7.3724e-02],
         [ 1.4178e-01,  1.2215e-01],
         [ 1.4101e-01,  1.3957e-01],
         [ 1.6424e-01,  1.1359e-01],
         [ 2.0194e-01,  1.3199e-01],
         [ 2.0504e-01,  1.3972e-01],
         [ 2.0049e-01,  1.1514e-01],
         [ 2.1277e-01,  1.3961e-01],
         [ 1.8867e-01,  7.1289e-02],
         [ 1.4929e-01,  9.1089e-02],
         [ 1.3924e-01,  1.2953e-01],
         [ 1.6471e-01,  1.6884e-01],
         [ 7.8821e-02,  1.3433e-01],
         [ 6.2908e-02,  6.9179e-02],
         [ 1.6953e-01,  1.4826e-01],
         [ 6.1393e-02,  1.2821e-01],
         [-2.6481e-01,  1.2046e-01],
         [ 2.1132e-03,  1.1829e-01],
         [ 2.6834e-02,  1.2756e-01],
         [ 3.9943e-02,  8.0869e-02],
         [ 4.6352e-02,  1.0399e-01],
         [ 4.9214e-02,  5.9673e-02],
         [ 5.0319e-02,  4.3460e-02],
         [ 5.0604e-02,  4.7600e-02],
         [ 5.0568e-02,  8.0804e-02],
         [ 5.0458e-02,  5.6413e-02],
         [ 5.0300e-02,  7.9092e-02],
         [ 5.0204e-02,  9.1574e-02],
         [ 5.0123e-02,  7.4707e-02],
         [ 5.0097e-02,  8.4628e-02],
         [ 5.0035e-02,  5.6050e-02],
         [ 5.0035e-02,  7.8432e-02],
         [ 5.0014e-02,  1.0533e-01],
         [ 5.0021e-02,  1.1583e-01],
         [ 5.0019e-02,  1.0105e-01],
         [ 5.0017e-02,  5.7137e-02],
         [ 5.0014e-02,  7.8675e-02],
         [ 5.0005e-02,  8.8978e-02],
         [ 5.0007e-02,  6.1761e-02],
         [ 5.0007e-02,  3.9668e-02],
         [ 5.0007e-02,  3.1980e-02],
         [ 5.0008e-02,  6.9784e-02],
         [ 5.0008e-02,  5.5134e-02],
         [ 5.0008e-02,  7.8682e-02],
         [ 5.0008e-02,  9.9678e-02],
         [ 5.0008e-02,  9.1694e-02],
         [ 5.0008e-02,  7.9433e-02],
         [ 5.0008e-02,  7.2547e-02],
         [ 5.0009e-02,  6.1291e-02],
         [ 5.0009e-02,  6.9846e-02],
         [ 5.0009e-02,  7.5851e-02],
         [ 5.0009e-02,  6.4771e-02],
         [ 5.0009e-02,  5.0253e-02],
         [ 5.0009e-02,  6.2216e-02],
         [ 5.0009e-02,  6.8986e-02],
         [ 5.0009e-02,  3.7007e-03]],

        [[ 1.1397e-01,  9.4233e-02],
         [ 9.8722e-02,  1.4570e-01],
         [ 1.1143e-01,  1.6389e-01],
         [ 1.3586e-01,  1.7871e-01],
         [ 1.4687e-01,  1.8179e-01],
         [ 1.5585e-01,  1.4926e-01],
         [ 1.4400e-01,  1.3019e-01],
         [ 1.3895e-01,  1.3914e-01],
         [ 1.1510e-01,  1.5959e-01],
         [ 1.4274e-01,  1.6537e-01],
         [ 1.4816e-01,  1.5004e-01],
         [ 1.1324e-01,  1.5712e-01],
         [ 9.8118e-02,  1.5338e-01],
         [ 1.2477e-01,  1.4664e-01],
         [ 1.3309e-01,  1.5508e-01],
         [ 1.3092e-01,  1.2094e-01],
         [ 9.1389e-02,  1.3626e-01],
         [ 6.8309e-02,  9.6291e-02],
         [ 8.8464e-02,  1.2488e-01],
         [ 7.6859e-02,  1.1966e-01],
         [ 1.1995e-01,  1.1632e-01],
         [ 1.3344e-01,  9.7680e-02],
         [ 1.4191e-01,  1.3203e-01],
         [ 1.0639e-01,  1.0285e-01],
         [ 1.4119e-01,  1.0939e-01],
         [ 1.1021e-01,  1.3258e-01],
         [ 1.3964e-01,  1.4360e-01],
         [ 1.5788e-01,  1.1475e-01],
         [ 1.3786e-01,  1.2930e-01],
         [ 1.4924e-01,  1.4228e-01],
         [ 1.5448e-01,  1.2233e-01],
         [ 1.5518e-01,  1.0699e-01],
         [ 1.3310e-01,  1.3047e-01],
         [ 1.5171e-01,  1.0209e-01],
         [ 1.3595e-01,  3.4605e-03],
         [ 9.9990e-02,  3.3985e-02],
         [ 1.2957e-01,  4.7351e-02],
         [ 1.0111e-01,  5.2776e-02],
         [ 1.1923e-01,  5.4770e-02],
         [ 1.3168e-01,  5.5340e-02],
         [ 1.2891e-01,  5.5415e-02],
         [ 9.9288e-02,  5.5387e-02],
         [ 9.6720e-02,  5.5311e-02],
         [ 8.9051e-02,  5.5234e-02],
         [ 6.7090e-02,  5.5215e-02],
         [-7.9893e-03,  5.5204e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-7.4877e-05, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(0.6151, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4657, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8804, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0304, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1608, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0899, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2628865.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2128, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.6104e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0014, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2107, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2548, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2107, device='cuda:0', grad_fn=<MinBackward1>)
t_env 4398
target_mac_out tensor([[[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.5027e-02,  7.1936e-02,  ..., -3.0500e-03,
            1.2911e-01, -1.0000e+07],
          [-1.0000e+07, -2.2961e-02,  9.6708e-02,  ..., -2.0494e-02,
            1.3243e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.1139e-02,  8.5369e-02,  ...,  1.4716e-02,
            1.3164e-01, -1.0000e+07],
          [-1.0000e+07, -3.0575e-02,  9.4245e-02,  ..., -4.3856e-02,
            1.3745e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.9938e-01,  1.0586e-01,  ...,  4.4793e-02,
            1.6853e-01, -3.1699e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.8366e-01,  7.2695e-02,  ...,  4.2428e-02,
            1.5227e-01, -3.1359e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.6262e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3011e-02,  8.5302e-02,  ...,  4.7299e-02,
            1.3351e-01, -1.0000e+07],
          [-1.0000e+07, -8.3580e-02,  1.5949e-01,  ...,  7.7397e-02,
            1.5469e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0035e-02,  7.8002e-02,  ...,  4.0203e-02,
            1.2817e-01, -1.0000e+07],
          [-1.0000e+07, -9.1473e-02,  1.2838e-01,  ...,  3.2495e-02,
            1.6125e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.0670e-02,  8.4050e-02],
         [ 7.1936e-02,  9.6708e-02],
         [ 8.5369e-02,  9.4245e-02],
         [ 1.0957e-01,  1.1600e-01],
         [ 1.0896e-01,  1.1381e-01],
         [ 1.4632e-01,  1.3353e-01],
         [ 1.2837e-01,  1.0659e-01],
         [ 1.1660e-01,  1.0882e-01],
         [ 1.3067e-01,  1.3858e-01],
         [ 1.5041e-01,  8.6393e-02],
         [ 1.6852e-01, -1.5386e-02],
         [ 1.3174e-01, -8.4988e-03],
         [ 1.6914e-01,  6.5463e-02],
         [ 1.3683e-01, -4.0398e-02],
         [ 1.3427e-01, -4.7884e-02],
         [ 1.2737e-01,  8.6319e-02],
         [ 1.2065e-01,  1.0241e-01],
         [ 1.0288e-01,  1.0723e-01],
         [ 1.4248e-01,  1.3861e-01],
         [ 1.2420e-01,  1.1778e-01],
         [ 1.1322e-01,  1.1742e-01],
         [ 1.0830e-01,  1.1024e-01],
         [ 7.0876e-02,  8.0633e-02],
         [ 9.3324e-02,  1.0793e-01],
         [ 1.0936e-01, -1.1027e-02],
         [ 1.0331e-01, -1.1783e-02],
         [ 1.5426e-01,  6.8686e-02],
         [ 1.7741e-01, -3.0440e-02],
         [ 1.7950e-01,  7.9972e-02],
         [ 1.7848e-01,  9.5407e-02],
         [ 1.3708e-01,  7.3367e-02],
         [ 1.6343e-01, -4.7370e-02],
         [ 1.8144e-01, -2.5316e-02],
         [ 1.3893e-01,  9.2127e-02],
         [ 8.5617e-02,  1.3353e-01],
         [ 1.0307e-01,  1.4873e-01],
         [ 7.3886e-02,  1.1367e-01],
         [ 9.7996e-02,  1.3962e-01],
         [ 9.6801e-02,  1.5129e-01],
         [ 1.2020e-01,  1.1250e-01],
         [ 1.3091e-01,  1.2301e-01],
         [ 1.2777e-01,  1.0402e-01],
         [ 1.5403e-01,  9.7388e-02],
         [ 1.6515e-01,  9.9281e-02],
         [ 1.7729e-01,  1.1371e-01],
         [ 1.7978e-01,  1.0285e-01],
         [ 1.2463e-01,  1.1852e-01],
         [ 1.1360e-01,  1.0884e-01],
         [ 1.2853e-01,  1.3620e-01],
         [ 1.4989e-01,  8.0995e-02],
         [ 1.6592e-01,  9.8872e-02],
         [ 1.2034e-01,  1.4419e-01],
         [ 1.2796e-01,  1.6298e-01],
         [ 1.5526e-01,  1.6761e-01],
         [ 1.6354e-01,  1.3651e-01],
         [ 1.2214e-01,  1.6277e-01],
         [ 1.3145e-01,  1.8230e-01],
         [ 1.2651e-01,  1.8624e-01],
         [ 1.4976e-01,  1.8383e-01],
         [ 1.3096e-01,  1.5660e-01],
         [ 1.5719e-01,  1.1360e-01],
         [ 1.2639e-01,  9.2760e-02],
         [ 9.8559e-02,  7.1618e-02],
         [ 1.2064e-01,  4.6336e-02],
         [ 1.0465e-01,  5.9508e-02],
         [ 1.3051e-01,  1.1030e-01],
         [ 1.0501e-01,  1.3248e-01],
         [ 1.1574e-01,  1.0984e-01],
         [ 1.2416e-01,  1.3082e-01],
         [ 1.4123e-01,  1.3335e-01],
         [ 1.0080e-01,  1.5099e-01],
         [ 1.2277e-01,  1.1573e-01],
         [ 1.3046e-01,  4.7317e-03],
         [ 1.2593e-01,  3.5153e-02],
         [ 1.3922e-01,  4.7874e-02],
         [ 1.8498e-01,  5.2807e-02],
         [ 1.5769e-01,  5.4573e-02],
         [ 1.3009e-01,  5.5107e-02],
         [ 1.2383e-01,  5.5214e-02],
         [ 1.3862e-01,  5.5201e-02],
         [ 1.3305e-01,  5.5187e-02],
         [ 1.4448e-01,  5.5161e-02],
         [ 1.0565e-01,  5.5155e-02],
         [ 1.2594e-01,  5.5158e-02],
         [ 1.3153e-01,  5.5200e-02],
         [ 1.4550e-01,  5.5186e-02],
         [ 1.2056e-01,  5.5187e-02],
         [ 1.2911e-01,  5.5204e-02],
         [ 1.3020e-01,  5.5219e-02],
         [ 1.0828e-01,  5.5208e-02],
         [ 1.1543e-01,  5.5215e-02],
         [ 8.3100e-02,  5.5218e-02],
         [ 1.0123e-01,  5.5227e-02],
         [ 1.0586e-01,  5.5231e-02],
         [ 7.2695e-02,  5.5230e-02],
         [ 2.6262e-03,  5.5230e-02]],

        [[ 1.1386e-01,  1.4136e-01],
         [ 8.5302e-02,  1.5949e-01],
         [ 7.8002e-02,  1.2838e-01],
         [ 1.1232e-01,  1.3565e-01],
         [ 1.0642e-01,  1.5668e-01],
         [ 1.3544e-01,  1.6352e-01],
         [ 1.3959e-01,  1.3349e-01],
         [ 1.3447e-01,  1.0802e-01],
         [ 1.5084e-01,  1.3931e-01],
         [ 1.2846e-01,  1.2154e-01],
         [ 1.3975e-01,  1.3081e-01],
         [ 1.3557e-01,  1.0657e-01],
         [ 1.3442e-01,  9.3321e-02],
         [ 1.4762e-01,  8.7857e-02],
         [ 1.6755e-01,  9.0569e-02],
         [ 1.3888e-01,  1.0355e-01],
         [ 1.0996e-01,  1.2434e-01],
         [ 1.5552e-01,  1.3217e-01],
         [ 1.2878e-01,  1.3385e-01],
         [ 1.4660e-01,  1.2502e-01],
         [ 1.2377e-01,  9.5403e-02],
         [ 1.1216e-01,  1.0181e-01],
         [ 1.3138e-01,  8.4058e-02],
         [ 9.2004e-02,  7.3707e-02],
         [ 1.1616e-01,  9.5058e-02],
         [ 1.0192e-01, -1.1101e-02],
         [ 1.0965e-01,  2.6444e-02],
         [ 1.3307e-01,  4.3606e-02],
         [ 8.3517e-02,  5.1050e-02],
         [ 1.0754e-01,  5.4063e-02],
         [ 7.6421e-02,  5.5156e-02],
         [ 6.2273e-02,  5.5470e-02],
         [ 7.1631e-02,  5.5476e-02],
         [ 9.1042e-02,  5.5380e-02],
         [ 1.0280e-01,  5.5320e-02],
         [ 1.2244e-01,  5.5268e-02],
         [ 1.3275e-01,  5.5237e-02],
         [ 8.8606e-02,  5.5215e-02],
         [ 1.2092e-01,  5.5205e-02],
         [ 1.2078e-01,  5.5220e-02],
         [ 1.4391e-01,  5.5217e-02],
         [ 1.5036e-01,  5.5221e-02],
         [ 1.1015e-01,  5.5202e-02],
         [ 8.5368e-02,  5.5219e-02],
         [ 1.2297e-01,  5.5223e-02],
         [ 9.4978e-02,  5.5231e-02],
         [ 9.0813e-02,  5.5231e-02],
         [ 1.0092e-01,  5.5230e-02],
         [-9.2490e-04,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.7924e-05, device='cuda:0') tensor(0.0014, device='cuda:0') tensor(-0.0017, device='cuda:0')
mixer_td_error tensor(0.5853, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4884, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4947, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0450, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1954, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0542, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2447916.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1862, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.8134e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1872, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0888, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1872, device='cuda:0', grad_fn=<MinBackward1>)
t_env 4495
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0660e-01,  1.0891e-01,  ...,  4.0960e-02,
            1.4451e-01, -1.0000e+07],
          [-1.0000e+07, -1.8482e-02,  1.0351e-01,  ...,  3.3942e-02,
            1.3388e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8928e-02,  7.1365e-02,  ...,  2.7223e-02,
            1.4807e-01, -1.0000e+07],
          [-1.0000e+07, -6.4588e-03,  1.1091e-01,  ...,  1.4417e-02,
            1.1999e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -5.3589e-02,  1.3369e-01,  ...,  4.2509e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -6.3608e-02,  1.4634e-01,  ...,  5.5140e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.7686e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.3745e-02,  1.1397e-01,  ...,  6.2087e-02,
            1.3778e-01, -1.0000e+07],
          [-1.0000e+07, -2.4539e-02,  9.4233e-02,  ..., -1.0851e-02,
            1.2427e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.1816e-02,  1.0293e-01,  ...,  8.5142e-03,
            1.3906e-01, -1.0000e+07],
          [-1.0000e+07, -3.5735e-02,  9.6497e-02,  ..., -3.4171e-02,
            1.3232e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.1353e-02,  1.1193e-01,  ...,  1.4043e-02,
            1.4122e-01, -1.0000e+07],
          [-1.0000e+07, -4.9343e-02,  1.1785e-01,  ..., -1.9798e-02,
            1.4554e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 1.0891e-01,  1.0351e-01],
         [ 7.1365e-02,  1.1091e-01],
         [ 1.0232e-01,  1.3664e-01],
         [ 7.2960e-02,  1.4697e-01],
         [ 1.0329e-01,  1.3410e-01],
         [ 1.0722e-01,  1.1105e-01],
         [ 7.4140e-02,  1.0349e-01],
         [ 7.3321e-02,  1.0143e-01],
         [ 9.5557e-02,  9.7142e-02],
         [ 1.0693e-01,  1.2286e-01],
         [ 9.5909e-02,  1.0741e-01],
         [ 7.2147e-02,  1.3140e-01],
         [ 8.3277e-02,  1.4134e-01],
         [ 1.0789e-01,  1.6046e-01],
         [ 1.2220e-01,  1.3346e-01],
         [ 1.2203e-01,  9.5938e-02],
         [ 1.0645e-01,  1.2609e-01],
         [ 1.3163e-01,  1.2211e-01],
         [ 1.3612e-01,  1.0114e-01],
         [ 1.0972e-01,  8.5977e-02],
         [ 1.0088e-01,  8.8142e-02],
         [ 1.1610e-01,  1.3562e-01],
         [ 1.3325e-01,  1.5198e-01],
         [ 1.4066e-01,  1.4183e-01],
         [ 1.2262e-01,  9.1951e-02],
         [ 1.0962e-01,  9.7596e-02],
         [ 8.1806e-02,  6.2137e-02],
         [ 9.6653e-02,  7.2180e-02],
         [ 1.2296e-01,  8.2419e-02],
         [ 9.2967e-02,  4.5509e-02],
         [ 9.7192e-02,  2.1180e-01],
         [ 1.0872e-01,  9.1904e-02],
         [ 1.1913e-01,  9.4866e-02],
         [ 1.0491e-01,  9.7274e-02],
         [ 1.1757e-01,  1.0496e-01],
         [ 1.2348e-01,  1.2557e-01],
         [ 7.9301e-02,  1.2184e-01],
         [ 7.2027e-02,  8.3242e-02],
         [ 6.7933e-02,  8.3151e-02],
         [ 9.1154e-02,  7.6459e-02],
         [ 7.6238e-02,  2.1584e-01],
         [ 9.4505e-02,  7.0447e-02],
         [ 9.4086e-02,  6.0095e-02],
         [ 6.1796e-02,  9.9076e-02],
         [ 5.2681e-02,  5.6504e-02],
         [ 8.6235e-02,  8.5389e-02],
         [ 7.5013e-02,  9.1901e-02],
         [ 9.4536e-02,  1.0512e-01],
         [ 7.6552e-02,  9.8362e-02],
         [ 9.8397e-02,  9.4596e-02],
         [ 1.0604e-01,  6.4166e-02],
         [ 1.0807e-01,  9.8112e-02],
         [ 1.1879e-01,  1.0005e-01],
         [ 1.1360e-01,  8.3395e-02],
         [ 1.1549e-01,  1.0946e-01],
         [ 1.0928e-01,  1.2266e-01],
         [ 1.3305e-01,  1.0439e-01],
         [ 1.0559e-01,  8.5825e-02],
         [ 1.3164e-01,  1.1369e-01],
         [ 1.3856e-01,  9.5307e-02],
         [ 1.4407e-01,  1.1329e-01],
         [ 1.7035e-01,  1.2186e-01],
         [ 1.3371e-01,  8.8530e-02],
         [ 1.4009e-01,  7.1392e-02],
         [ 1.0089e-01,  7.2937e-02],
         [ 1.2762e-01,  8.9119e-02],
         [ 1.4125e-01,  9.5281e-02],
         [ 1.4634e-01,  1.0041e-01],
         [ 1.4501e-01,  9.6483e-02],
         [ 1.0114e-01,  7.5197e-02],
         [ 4.5363e-02, -8.8102e-02],
         [ 4.5874e-02, -8.5134e-02],
         [ 4.8161e-02,  4.7517e-02],
         [ 4.9559e-02,  2.9706e-02],
         [ 5.0116e-02,  5.2010e-02],
         [ 5.0224e-02,  6.0389e-02],
         [ 5.0164e-02,  4.6658e-02],
         [ 5.0077e-02, -9.7295e-02],
         [ 5.0000e-02,  4.4727e-02],
         [ 4.9980e-02, -9.3247e-02],
         [ 4.9969e-02,  2.9716e-02],
         [ 4.9963e-02, -8.6838e-02],
         [ 4.9972e-02, -8.4312e-02],
         [ 4.9979e-02, -8.3054e-02],
         [ 4.9996e-02, -4.2544e-02],
         [ 5.0000e-02, -4.2143e-02],
         [ 5.0017e-02,  4.6068e-02],
         [ 5.0009e-02,  3.6644e-02],
         [ 5.0016e-02, -8.0504e-02],
         [ 5.0019e-02,  4.7998e-02],
         [ 5.0012e-02,  6.0842e-02],
         [ 5.0012e-02,  3.5138e-02],
         [ 5.0006e-02,  5.3112e-02],
         [ 5.0008e-02,  9.6558e-02],
         [ 5.0008e-02,  5.5508e-02],
         [ 5.0008e-02, -1.3267e-02],
         [ 5.0008e-02,  9.2911e-02],
         [ 5.0008e-02,  7.2137e-02],
         [ 5.0008e-02,  7.1514e-02],
         [ 5.0008e-02,  7.2525e-02],
         [ 5.0008e-02,  7.3659e-02],
         [ 5.0008e-02,  5.1056e-02],
         [ 5.0008e-02,  6.2098e-02],
         [ 5.0009e-02,  6.7826e-02],
         [ 5.0009e-02,  7.0866e-02],
         [ 5.0009e-02,  7.2535e-02],
         [ 5.0009e-02,  4.0870e-02],
         [ 5.0009e-02,  5.4795e-02],
         [ 5.0009e-02,  6.4876e-02],
         [ 5.0009e-02,  4.2280e-02],
         [ 5.0009e-02,  5.4565e-02],
         [ 5.0009e-02,  1.0135e-01],
         [ 5.0009e-02,  1.2118e-01],
         [ 5.0009e-02,  8.6418e-02],
         [ 5.0009e-02,  7.8670e-02],
         [ 5.0009e-02,  1.1152e-01],
         [ 5.0009e-02,  1.2383e-01],
         [ 5.0009e-02,  1.2864e-01],
         [ 5.0009e-02,  1.3082e-01],
         [ 5.0009e-02,  6.9218e-02],
         [ 5.0009e-02,  2.7622e-03],
         [ 5.0009e-02,  1.0138e-01],
         [ 5.0009e-02,  1.2165e-01],
         [ 5.0009e-02,  1.3272e-01],
         [ 5.0009e-02,  1.3925e-01],
         [ 5.0009e-02,  7.2853e-02],
         [ 5.0009e-02,  6.9259e-02],
         [ 5.0009e-02,  8.2112e-02],
         [ 5.0009e-02, -7.5416e-02],
         [ 5.0009e-02,  7.1647e-02],
         [ 5.0009e-02, -8.4093e-02],
         [ 5.0009e-02,  5.9879e-02],
         [ 5.0009e-02, -1.0365e-01],
         [ 5.0009e-02, -9.6471e-02],
         [ 5.0009e-02,  4.7889e-02],
         [ 5.0009e-02,  1.0175e-01],
         [ 5.0009e-02,  1.2143e-01],
         [ 5.0009e-02,  1.3214e-01],
         [ 5.0009e-02,  1.4587e-01],
         [ 5.0009e-02,  1.0074e-01],
         [ 5.0009e-02,  1.2682e-01],
         [ 5.0009e-02,  1.3574e-01],
         [ 5.0009e-02,  1.4887e-01],
         [ 5.0009e-02,  1.4346e-01],
         [ 5.0009e-02,  1.5426e-01],
         [ 5.0009e-02,  1.0013e-01],
         [ 5.0009e-02,  1.3369e-01],
         [ 5.0009e-02,  1.4634e-01],
         [ 5.0009e-02,  2.7686e-02]],

        [[ 1.1397e-01,  9.4233e-02],
         [ 1.0293e-01,  9.6497e-02],
         [ 1.1193e-01,  1.1785e-01],
         [ 1.1367e-01,  1.0951e-01],
         [ 1.2104e-01,  1.4467e-01],
         [ 1.3965e-01,  1.5094e-01],
         [ 1.6048e-01,  1.2500e-01],
         [ 1.6528e-01,  1.3990e-01],
         [ 1.5929e-01,  1.6563e-01],
         [ 1.7129e-01,  1.8542e-01],
         [ 1.7524e-01,  1.4795e-01],
         [ 1.7094e-01,  1.3974e-01],
         [ 1.6695e-01,  1.2111e-01],
         [ 1.4460e-01,  9.6086e-02],
         [ 1.4557e-01,  9.0636e-02],
         [ 1.3518e-01,  1.4677e-01],
         [ 1.2395e-01,  1.3289e-01],
         [ 1.2924e-01,  1.0954e-01],
         [ 1.6370e-01,  1.4459e-01],
         [ 1.5113e-01,  1.3502e-01],
         [ 1.6756e-01,  1.0600e-01],
         [ 1.3511e-01,  8.8334e-02],
         [ 1.5706e-01,  1.2859e-01],
         [ 1.3250e-01,  9.3897e-02],
         [ 1.3979e-01,  8.6861e-02],
         [ 1.2541e-01,  1.2227e-01],
         [ 1.1967e-01,  1.3789e-01],
         [ 1.5147e-02,  7.6200e-02],
         [ 3.3039e-02,  9.1039e-02],
         [ 4.2226e-02,  9.7688e-02],
         [ 4.6520e-02,  6.2380e-02],
         [ 4.8429e-02,  5.1227e-02],
         [ 4.9264e-02,  7.6589e-02],
         [ 4.9619e-02,  7.5762e-02],
         [ 4.9764e-02,  7.2408e-02],
         [ 4.9854e-02,  7.6904e-02],
         [ 4.9899e-02,  7.3279e-02],
         [ 4.9943e-02,  9.0788e-02],
         [ 4.9950e-02,  1.1105e-01],
         [ 4.9978e-02,  7.4781e-02],
         [ 4.9989e-02,  4.1990e-02],
         [ 5.0004e-02,  6.7463e-02],
         [ 5.0021e-02,  7.6718e-02],
         [ 5.0020e-02,  4.8972e-02],
         [ 5.0015e-02,  6.4111e-02],
         [ 5.0018e-02,  6.9910e-02],
         [ 5.0020e-02,  7.2341e-02],
         [ 5.0012e-02,  3.6751e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.3813e-05, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0012, device='cuda:0')
mixer_td_error tensor(0.8573, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4781, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4099, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0565, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2087, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0369, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3399999.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2158, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.6520e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2350, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1145, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2350, device='cuda:0', grad_fn=<MinBackward1>)
t_env 4690
target_mac_out tensor([[[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.4360e-02,  7.4236e-02,  ...,  6.2640e-03,
            1.2703e-01, -1.0000e+07],
          [-1.0000e+07, -7.0404e-02,  1.5810e-01,  ...,  4.6388e-02,
            1.4908e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0383e-01,  9.7922e-02,  ...,  1.2565e-02,
            1.4072e-01, -1.0000e+07],
          [-1.0000e+07, -9.8419e-02,  1.7124e-01,  ...,  6.4498e-02,
            1.6552e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2400e-02,  9.8029e-02,  ...,  3.1969e-02,
            1.6101e-01, -1.0000e+07],
          [-1.0000e+07, -4.6060e-02,  1.1430e-01,  ...,  3.6765e-02,
            1.4675e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2108e-01,  1.1981e-01,  ...,  5.4917e-02,
            1.6785e-01, -1.0000e+07],
          [-1.0000e+07, -8.3276e-02,  1.6010e-01,  ...,  6.2015e-02,
            1.4833e-01, -1.0000e+07]],

         ...,

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.7130e-01,  7.6967e-02,  ...,  8.8144e-02,
            2.1366e-01, -3.2696e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6059e-01,  8.2038e-02,  ...,  7.3630e-02,
            2.0875e-01, -3.1667e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 6.0608e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.3473e-02,  1.3755e-01],
         [ 7.4236e-02,  1.5810e-01],
         [ 9.7922e-02,  1.7124e-01],
         [ 3.7014e-02,  1.5098e-01],
         [ 1.0214e-01,  7.9768e-02],
         [ 1.0069e-01,  9.4059e-02],
         [ 1.1921e-01,  9.3205e-02],
         [ 1.5301e-01,  5.7789e-02],
         [ 1.7431e-01,  9.6146e-02],
         [ 1.7710e-01,  6.0274e-02],
         [ 1.3745e-01,  1.1000e-01],
         [ 1.3742e-01,  1.4969e-01],
         [ 1.1970e-01,  1.6965e-01],
         [ 1.1135e-01,  1.6665e-01],
         [ 1.2149e-01,  1.6551e-01],
         [ 1.1117e-01,  9.9754e-02],
         [ 1.2073e-01,  1.3876e-01],
         [ 8.4568e-02,  1.0318e-01],
         [ 9.4919e-02,  6.7308e-02],
         [ 8.5131e-02, -1.7051e-01],
         [ 1.0608e-01, -1.3034e-01],
         [ 7.7939e-02, -1.4796e-01],
         [ 1.0957e-01,  1.9309e-02],
         [ 8.9119e-02,  4.1537e-02],
         [-7.8832e-02,  5.1971e-02],
         [ 8.8339e-02,  5.5940e-02],
         [ 1.1391e-01,  5.6931e-02],
         [ 1.2687e-01,  5.6799e-02],
         [ 9.7271e-02,  5.6349e-02],
         [ 1.1140e-01,  5.5964e-02],
         [ 7.4655e-02,  5.5651e-02],
         [ 1.1591e-01,  5.5474e-02],
         [ 1.3126e-01,  5.5348e-02],
         [ 1.2722e-01,  5.5283e-02],
         [ 8.6774e-02,  5.5242e-02],
         [ 1.1623e-01,  5.5190e-02],
         [ 1.5374e-01,  5.5229e-02],
         [ 1.8613e-01,  5.5209e-02],
         [ 1.4649e-01,  5.5214e-02],
         [ 1.2912e-01,  5.5203e-02],
         [ 1.4835e-01,  5.5219e-02],
         [ 1.3968e-01,  5.5224e-02],
         [ 1.7577e-01,  5.5226e-02],
         [ 1.7443e-01,  5.5230e-02],
         [ 1.4300e-01,  5.5230e-02],
         [ 1.4270e-01,  5.5230e-02],
         [ 9.5536e-02,  5.5232e-02],
         [ 7.2049e-02,  5.5236e-02],
         [ 1.2583e-01,  5.5235e-02],
         [ 1.1949e-01,  5.5232e-02],
         [ 8.9068e-03,  5.5232e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 7.4276e-02,  1.4162e-01],
         [ 9.8029e-02,  1.1430e-01],
         [ 1.1981e-01,  1.6010e-01],
         [ 1.2099e-01,  1.3587e-01],
         [ 1.2405e-01,  1.0769e-01],
         [ 1.1617e-01,  1.0273e-01],
         [ 1.2096e-01,  1.0874e-01],
         [ 1.0856e-01,  9.8483e-02],
         [ 1.1427e-01,  1.0355e-01],
         [ 1.0246e-01,  1.2860e-01],
         [ 1.1083e-01,  1.6549e-01],
         [ 1.1385e-01,  1.2081e-01],
         [ 1.0887e-01,  1.0818e-01],
         [ 1.2204e-01,  1.0554e-01],
         [ 1.2137e-01,  1.0093e-01],
         [ 1.1431e-01,  9.8108e-02],
         [ 8.7508e-02, -4.1350e-02],
         [ 1.0155e-01, -1.7261e-02],
         [ 1.3277e-01, -4.9241e-03],
         [ 1.2791e-01,  1.8534e-03],
         [ 1.2414e-01, -3.3053e-02],
         [ 1.3450e-01,  8.2046e-02],
         [ 1.0929e-01,  9.1476e-02],
         [ 1.3411e-01,  1.2883e-01],
         [ 1.0465e-01,  1.6546e-01],
         [ 1.3397e-01,  1.3890e-01],
         [ 1.0756e-01,  1.5844e-01],
         [ 1.5579e-03,  1.4760e-01],
         [ 2.6799e-02,  1.0044e-01],
         [ 3.9880e-02,  5.7773e-02],
         [ 4.6012e-02,  8.9315e-02],
         [ 4.8653e-02,  7.7549e-02],
         [ 4.9652e-02, -1.4242e-01],
         [ 4.9987e-02,  7.3435e-02],
         [ 5.0055e-02,  5.1268e-02],
         [ 5.0046e-02,  7.8729e-02],
         [ 5.0032e-02,  9.0704e-02],
         [ 5.0015e-02,  5.2722e-02],
         [ 5.0017e-02,  8.2167e-02],
         [ 4.9999e-02,  9.5221e-02],
         [ 5.0030e-02,  1.1551e-01],
         [ 5.0039e-02,  7.8776e-02],
         [ 5.0019e-02,  1.1246e-01],
         [ 5.0020e-02,  1.1242e-01],
         [ 5.0023e-02,  1.1280e-01],
         [ 5.0024e-02,  8.0236e-02],
         [ 5.0021e-02,  9.8004e-02],
         [ 5.0015e-02,  1.0403e-01],
         [ 5.0007e-02,  7.5190e-02],
         [ 5.0007e-02,  6.4532e-02],
         [ 5.0008e-02,  9.8158e-02],
         [ 5.0008e-02, -1.6907e-01],
         [ 5.0008e-02,  9.0339e-02],
         [ 5.0008e-02,  9.4990e-02],
         [ 5.0008e-02, -1.6434e-01],
         [ 5.0008e-02,  7.6967e-02],
         [ 5.0008e-02,  8.2038e-02],
         [ 5.0008e-02,  6.0608e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.0756e-05, device='cuda:0') tensor(0.0017, device='cuda:0') tensor(-0.0026, device='cuda:0')
mixer_td_error tensor(0.1698, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5246, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6930, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0684, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1885, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0297, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-603448.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1861, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.2911e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0018, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1393, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2237, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1393, device='cuda:0', grad_fn=<MinBackward1>)
t_env 4812
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0695e-02,  8.8884e-02,  ...,  1.4652e-02,
            1.4204e-01, -1.0000e+07],
          [-1.0000e+07, -3.4872e-02,  9.9288e-02,  ..., -3.2764e-02,
            1.3673e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3586e-01,  4.0597e-02,  ...,  4.7742e-02,
            1.9922e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1941e-01,  1.6392e-02,  ...,  4.5058e-02,
            1.8264e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.1394e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.3297e-02,  7.5482e-02,  ...,  2.0656e-03,
            1.2204e-01, -1.0000e+07],
          [-1.0000e+07, -1.9084e-02,  9.7086e-02,  ..., -1.3971e-02,
            1.2488e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4835e-02,  1.0068e-01,  ...,  2.7234e-02,
            1.5901e-01, -1.0000e+07],
          [-1.0000e+07, -2.5852e-02,  9.3294e-02,  ..., -3.4115e-04,
            1.3873e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9054e-02,  1.0069e-01,  ...,  1.9605e-02,
            1.5300e-01, -1.0000e+07],
          [-1.0000e+07, -2.5418e-02,  1.0335e-01,  ...,  1.9610e-02,
            1.3840e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02,  8.7099e-02],
         [ 6.9213e-02,  1.0899e-01],
         [ 8.8884e-02,  9.9288e-02],
         [ 9.1497e-02,  8.8649e-02],
         [ 1.1814e-01,  1.1219e-01],
         [ 1.0716e-01,  1.1003e-01],
         [ 1.0986e-01,  9.5288e-02],
         [ 1.2487e-01,  1.1727e-01],
         [ 1.1758e-01,  1.0258e-01],
         [ 1.5183e-01,  1.2731e-01],
         [ 1.7336e-01,  1.1188e-01],
         [ 1.8323e-01,  1.0340e-01],
         [ 1.5019e-01,  1.2251e-01],
         [ 1.6608e-01,  1.3316e-01],
         [ 1.4368e-01,  9.9764e-02],
         [ 1.3013e-01,  1.2584e-01],
         [ 1.5058e-01,  1.1515e-01],
         [ 1.7461e-01,  1.4160e-01],
         [ 1.8083e-01,  1.2839e-01],
         [ 1.3143e-01,  1.4630e-01],
         [ 1.4003e-01,  1.5612e-01],
         [ 1.6183e-01,  1.5992e-01],
         [ 1.1678e-01,  1.3547e-01],
         [ 1.3169e-01,  1.2089e-01],
         [ 1.5533e-01,  1.4156e-01],
         [ 1.6582e-01,  1.5210e-01],
         [ 1.8747e-01,  1.3380e-01],
         [ 1.9394e-01, -3.4138e-02],
         [ 1.9964e-01, -3.0103e-02],
         [ 1.5332e-01, -5.1397e-02],
         [ 1.0850e-01, -4.7618e-02],
         [ 1.1844e-01, -4.9616e-02],
         [ 1.2093e-01,  7.1316e-02],
         [ 1.1190e-01,  8.2845e-02],
         [ 1.5083e-01,  1.2766e-01],
         [ 1.5953e-01,  1.1280e-01],
         [ 1.6312e-01,  1.3203e-01],
         [ 1.5568e-01,  8.2679e-02],
         [ 1.5366e-01, -7.4816e-02],
         [ 1.1933e-01, -7.8308e-02],
         [ 1.2067e-01, -6.1851e-02],
         [ 1.2170e-01,  8.1386e-02],
         [ 1.2081e-01, -6.7306e-02],
         [ 1.2439e-01, -4.8074e-02],
         [ 1.0154e-01, -5.8890e-02],
         [ 7.2165e-02,  9.4530e-02],
         [-1.7374e-01, -5.2451e-02],
         [-6.7529e-03, -3.1846e-02],
         [ 2.1785e-02, -1.9923e-02],
         [ 3.6720e-02, -3.5356e-03],
         [ 4.4121e-02, -1.9083e-02],
         [ 4.7585e-02, -1.6124e-02],
         [ 4.9116e-02, -1.1797e-02],
         [ 4.9755e-02,  1.0193e-03],
         [ 4.9969e-02, -3.3511e-02],
         [ 5.0025e-02, -4.2697e-02],
         [ 5.0041e-02,  7.6199e-02],
         [ 5.0028e-02, -6.2789e-02],
         [ 5.0030e-02, -1.4365e-02],
         [ 5.0032e-02, -2.7605e-03],
         [ 5.0026e-02, -2.0673e-02],
         [ 5.0025e-02,  3.7915e-03],
         [ 5.0002e-02,  7.3887e-03],
         [ 5.0023e-02,  7.5001e-03],
         [ 5.0015e-02, -3.1327e-02],
         [ 5.0015e-02, -5.4273e-02],
         [ 5.0017e-02,  1.1190e-01],
         [ 5.0010e-02,  1.1439e-01],
         [ 5.0006e-02,  1.2453e-01],
         [ 5.0007e-02, -1.1636e-01],
         [ 5.0007e-02,  9.5517e-02],
         [ 5.0008e-02,  1.0419e-01],
         [ 5.0008e-02, -1.2531e-01],
         [ 5.0008e-02, -1.0838e-01],
         [ 5.0009e-02, -1.0181e-01],
         [ 5.0008e-02, -8.8699e-02],
         [ 5.0008e-02,  7.1791e-02],
         [ 5.0008e-02, -8.8897e-02],
         [ 5.0008e-02,  7.9627e-02],
         [ 5.0009e-02, -8.8788e-02],
         [ 5.0009e-02,  8.0606e-02],
         [ 5.0009e-02, -8.1417e-02],
         [ 5.0009e-02, -3.3128e-02],
         [ 5.0009e-02,  9.3214e-02],
         [ 5.0009e-02,  9.8088e-02],
         [ 5.0009e-02,  9.4704e-02],
         [ 5.0009e-02,  1.2971e-01],
         [ 5.0009e-02,  1.4388e-01],
         [ 5.0009e-02,  9.4154e-02],
         [ 5.0009e-02,  9.3596e-02],
         [ 5.0009e-02,  9.0519e-02],
         [ 5.0009e-02,  1.2746e-01],
         [ 5.0009e-02,  8.6365e-02],
         [ 5.0009e-02,  9.9241e-02],
         [ 5.0009e-02,  9.6803e-02],
         [ 5.0009e-02,  1.0001e-01],
         [ 5.0009e-02, -8.2693e-02],
         [ 5.0009e-02, -8.4994e-02],
         [ 5.0009e-02,  7.5075e-02],
         [ 5.0009e-02,  9.0214e-02],
         [ 5.0009e-02,  9.2185e-02],
         [ 5.0009e-02,  1.2950e-01],
         [ 5.0009e-02,  1.4499e-01],
         [ 5.0009e-02,  1.5198e-01],
         [ 5.0009e-02,  1.1823e-01],
         [ 5.0009e-02,  1.4446e-01],
         [ 5.0009e-02,  1.5428e-01],
         [ 5.0009e-02,  1.3487e-01],
         [ 5.0009e-02, -1.2618e-02],
         [ 5.0009e-02,  3.3931e-03],
         [ 5.0009e-02,  1.3910e-01],
         [ 5.0009e-02,  1.5229e-01],
         [ 5.0009e-02,  1.6581e-01],
         [ 5.0009e-02,  1.2716e-01],
         [ 5.0009e-02,  1.5911e-01],
         [ 5.0009e-02,  1.6409e-01],
         [ 5.0009e-02, -4.3286e-02],
         [ 5.0009e-02, -5.1520e-02],
         [ 5.0009e-02,  8.4554e-02],
         [ 5.0009e-02, -5.3361e-02],
         [ 5.0009e-02,  8.8785e-02],
         [ 5.0009e-02, -2.2396e-02],
         [ 5.0009e-02, -1.8733e-02],
         [ 5.0009e-02, -2.6026e-02],
         [ 5.0009e-02, -3.1849e-02],
         [ 5.0009e-02, -1.3676e-02],
         [ 5.0009e-02, -2.5572e-02],
         [ 5.0009e-02, -9.9668e-03],
         [ 5.0009e-02, -1.0698e-02],
         [ 5.0009e-02, -2.0732e-02],
         [ 5.0009e-02, -6.1543e-03],
         [ 5.0009e-02, -8.4494e-03],
         [ 5.0009e-02,  2.5393e-03],
         [ 5.0009e-02,  6.7060e-03],
         [ 5.0009e-02,  8.4499e-03],
         [ 5.0009e-02,  3.3570e-05],
         [ 5.0009e-02,  7.4983e-03],
         [ 5.0009e-02, -1.2278e-02],
         [ 5.0009e-02, -4.1027e-02],
         [ 5.0009e-02,  9.2616e-02],
         [ 5.0009e-02,  9.9661e-02],
         [ 5.0009e-02, -5.7020e-02],
         [ 5.0009e-02, -3.4903e-02],
         [ 5.0009e-02, -3.4755e-02],
         [ 5.0009e-02, -2.4225e-02],
         [ 5.0009e-02, -2.9173e-02],
         [ 5.0009e-02,  8.9622e-02],
         [ 5.0009e-02,  9.4775e-02],
         [ 5.0009e-02,  9.5306e-02],
         [ 5.0009e-02,  1.0071e-01],
         [ 5.0009e-02, -5.1489e-02],
         [ 5.0009e-02, -3.0790e-02],
         [ 5.0009e-02, -3.1867e-02],
         [ 5.0009e-02, -1.2692e-02],
         [ 5.0009e-02, -4.1902e-02],
         [ 5.0009e-02, -3.1691e-02],
         [ 5.0009e-02, -3.0797e-02],
         [ 5.0009e-02, -2.0897e-02],
         [ 5.0009e-02, -2.6814e-02],
         [ 5.0009e-02, -1.9622e-02],
         [ 5.0009e-02, -2.6434e-02],
         [ 5.0009e-02,  8.9166e-02],
         [ 5.0009e-02,  9.4569e-02],
         [ 5.0009e-02, -4.2529e-03],
         [ 5.0009e-02, -1.7457e-02],
         [ 5.0009e-02,  1.9800e-03],
         [ 5.0009e-02, -1.6050e-02],
         [ 5.0009e-02, -5.2368e-02],
         [ 5.0009e-02,  9.2678e-02],
         [ 5.0009e-02, -5.6799e-02],
         [ 5.0009e-02, -1.3798e-02],
         [ 5.0009e-02,  1.4091e-01],
         [ 5.0009e-02,  1.5993e-01],
         [ 5.0009e-02,  1.6269e-01],
         [ 5.0009e-02, -3.5386e-02],
         [ 5.0009e-02,  9.5644e-02],
         [ 5.0009e-02, -3.6206e-02],
         [ 5.0009e-02, -9.1769e-03],
         [ 5.0009e-02, -2.5406e-02],
         [ 5.0009e-02, -1.6255e-02],
         [ 5.0009e-02,  1.2638e-01],
         [ 5.0009e-02,  1.5315e-01],
         [ 5.0009e-02,  1.6703e-01],
         [ 5.0009e-02, -8.0687e-03],
         [ 5.0009e-02,  6.1416e-03],
         [ 5.0009e-02,  1.4609e-01],
         [ 5.0009e-02,  1.6603e-01],
         [ 5.0009e-02, -3.7727e-02],
         [ 5.0009e-02,  1.0114e-01],
         [ 5.0009e-02,  1.0021e-01],
         [ 5.0009e-02,  1.1800e-01],
         [ 5.0009e-02, -9.7924e-02],
         [ 5.0009e-02,  1.1388e-01],
         [ 5.0009e-02, -1.2954e-01],
         [ 5.0009e-02, -1.1491e-01],
         [ 5.0009e-02, -1.0161e-01],
         [ 5.0009e-02, -7.0541e-02],
         [ 5.0009e-02, -5.0242e-02],
         [ 5.0009e-02,  1.2139e-01],
         [ 5.0009e-02,  8.7706e-02],
         [ 5.0009e-02,  7.0982e-02],
         [ 5.0009e-02,  9.6345e-02],
         [ 5.0009e-02,  8.3077e-02],
         [ 5.0009e-02,  7.4376e-02],
         [ 5.0009e-02,  7.7576e-02],
         [ 5.0009e-02, -1.5955e-01],
         [ 5.0009e-02,  5.8213e-02],
         [ 5.0009e-02,  7.4738e-02],
         [ 5.0009e-02,  8.2372e-02],
         [ 5.0009e-02,  5.8282e-02],
         [ 5.0009e-02,  6.2606e-02],
         [ 5.0009e-02,  7.4427e-02],
         [ 5.0009e-02,  5.2736e-02],
         [ 5.0009e-02,  4.4371e-02],
         [ 5.0009e-02,  8.5261e-02],
         [ 5.0009e-02,  5.6428e-02],
         [ 5.0009e-02,  7.1099e-02],
         [ 5.0009e-02, -1.4896e-01],
         [ 5.0009e-02,  8.2815e-02],
         [ 5.0009e-02, -1.5489e-01],
         [ 5.0009e-02,  7.2760e-02],
         [ 5.0009e-02, -1.3586e-01],
         [ 5.0009e-02, -1.1941e-01],
         [ 5.0009e-02,  5.1394e-02]],

        [[ 7.5482e-02,  9.7086e-02],
         [ 1.0068e-01,  9.3294e-02],
         [ 1.0069e-01,  1.0335e-01],
         [ 1.1583e-01,  1.4030e-01],
         [ 9.7189e-02,  1.5024e-01],
         [ 1.2218e-01,  1.2506e-01],
         [ 1.2466e-01,  1.3818e-01],
         [ 1.3220e-01,  1.1480e-01],
         [ 1.1648e-01,  1.3453e-01],
         [ 1.4691e-01,  1.3740e-01],
         [ 1.6446e-01,  1.0102e-01],
         [ 1.6730e-01,  8.0992e-02],
         [ 1.7587e-01,  8.4080e-02],
         [ 1.7871e-01,  7.6988e-02],
         [ 1.5113e-01,  7.3651e-02],
         [ 1.7729e-01,  1.1539e-01],
         [ 1.5111e-01,  1.2512e-01],
         [ 1.4113e-01,  8.5442e-02],
         [ 1.3039e-01,  1.0418e-01],
         [ 1.2732e-01,  6.4403e-02],
         [ 1.5320e-01, -7.6786e-02],
         [ 1.2375e-01, -7.8586e-02],
         [ 1.4435e-01,  8.4455e-02],
         [ 1.5861e-01,  1.0022e-01],
         [ 1.6486e-01, -5.6457e-02],
         [ 1.6792e-01, -4.2571e-02],
         [ 1.7192e-01, -5.2210e-02],
         [ 1.7065e-01,  7.6617e-02],
         [ 1.7058e-01,  9.9807e-02],
         [ 1.2394e-01,  9.6899e-02],
         [ 9.8329e-02, -2.1030e-02],
         [ 1.3344e-01,  1.5209e-01],
         [ 1.1068e-01,  1.1642e-01],
         [ 1.4764e-01,  1.1413e-01],
         [ 1.6476e-01,  1.6018e-01],
         [ 1.6219e-01,  1.8103e-01],
         [ 1.7489e-01,  1.3608e-01],
         [ 1.7774e-01, -7.3015e-02],
         [ 1.8387e-01, -8.7813e-02],
         [ 1.8724e-01,  8.6500e-02],
         [-3.2408e-02, -7.6270e-02],
         [ 8.6133e-03, -7.5397e-02],
         [ 3.0226e-02, -3.6203e-02],
         [ 4.0974e-02, -3.9076e-02],
         [ 4.6110e-02, -6.3540e-02],
         [ 4.8453e-02, -5.5810e-02],
         [ 4.9465e-02, -4.8608e-02],
         [ 4.9862e-02, -5.0276e-02],
         [ 5.0008e-02, -5.8366e-02],
         [ 5.0033e-02, -5.3502e-02],
         [ 5.0035e-02, -5.2857e-02],
         [ 5.0019e-02, -4.8221e-02],
         [ 5.0017e-02, -7.0556e-02],
         [ 5.0016e-02, -6.3663e-02],
         [ 5.0031e-02,  7.9226e-02],
         [ 5.0043e-02, -6.4730e-02],
         [ 5.0020e-02, -7.1411e-02],
         [ 5.0008e-02,  1.1383e-01],
         [ 5.0022e-02,  9.4502e-02],
         [ 5.0015e-02,  9.8246e-02],
         [ 5.0021e-02,  1.0208e-01],
         [ 5.0020e-02, -1.3854e-01],
         [ 5.0005e-02, -1.1423e-01],
         [ 5.0007e-02, -1.0382e-01],
         [ 5.0008e-02, -9.3043e-02],
         [ 5.0008e-02,  9.1918e-02],
         [ 5.0008e-02, -1.2127e-01],
         [ 5.0008e-02,  8.2528e-02],
         [ 5.0008e-02,  1.0609e-01],
         [ 5.0008e-02, -1.2935e-01],
         [ 5.0008e-02,  5.8070e-02],
         [ 5.0008e-02,  9.7021e-02],
         [ 5.0008e-02,  6.1195e-02],
         [ 5.0009e-02, -1.4253e-01],
         [ 5.0009e-02,  5.0995e-02],
         [ 5.0009e-02,  4.4612e-02],
         [ 5.0009e-02, -1.4535e-01],
         [ 5.0009e-02,  6.7260e-02],
         [ 5.0009e-02,  8.3678e-02],
         [ 5.0009e-02,  1.0892e-01],
         [ 5.0009e-02,  1.0277e-01],
         [ 5.0009e-02,  8.7774e-02],
         [ 5.0009e-02,  7.0933e-02],
         [ 5.0009e-02, -1.5011e-01],
         [ 5.0009e-02, -1.3197e-01],
         [ 5.0009e-02, -1.2198e-01],
         [ 5.0009e-02,  8.4245e-02],
         [ 5.0009e-02, -1.4194e-01],
         [ 5.0009e-02,  8.9642e-02],
         [ 5.0009e-02,  9.0533e-02],
         [ 5.0009e-02, -1.5135e-01],
         [ 5.0009e-02, -1.2499e-01],
         [ 5.0009e-02, -1.1699e-01],
         [ 5.0009e-02, -1.0317e-01],
         [ 5.0009e-02,  6.1229e-02],
         [ 5.0009e-02, -1.0245e-01],
         [ 5.0009e-02, -9.1886e-02],
         [ 5.0009e-02, -7.8131e-02],
         [ 5.0009e-02, -7.0858e-02],
         [ 5.0009e-02, -7.2379e-02],
         [ 5.0009e-02, -7.5894e-02],
         [ 5.0009e-02,  6.6085e-02],
         [ 5.0009e-02, -9.0521e-02],
         [ 5.0009e-02,  6.4395e-02],
         [ 5.0009e-02, -9.0136e-02],
         [ 5.0009e-02, -6.7447e-02],
         [ 5.0009e-02, -6.6274e-02],
         [ 5.0009e-02, -9.1122e-02],
         [ 5.0009e-02,  6.8301e-02],
         [ 5.0009e-02, -9.3850e-02],
         [ 5.0009e-02, -8.6228e-02],
         [ 5.0009e-02, -7.7893e-02],
         [ 5.0009e-02, -7.6806e-02],
         [ 5.0009e-02, -7.2181e-02],
         [ 5.0009e-02, -3.4754e-02],
         [ 5.0009e-02, -3.9056e-02],
         [ 5.0009e-02, -5.7407e-02],
         [ 5.0009e-02, -8.8094e-02],
         [ 5.0009e-02, -8.9241e-02],
         [ 5.0009e-02, -4.8877e-02],
         [ 5.0009e-02,  1.0200e-01],
         [ 5.0009e-02,  1.1894e-01],
         [ 5.0009e-02,  1.2899e-01],
         [ 5.0009e-02,  1.3685e-01],
         [ 5.0009e-02,  1.4194e-01],
         [ 5.0009e-02,  1.4333e-01],
         [ 5.0009e-02,  1.4260e-01],
         [ 5.0009e-02, -8.2457e-02],
         [ 5.0009e-02, -1.0745e-01],
         [ 5.0009e-02, -1.3490e-01],
         [ 5.0009e-02, -1.2913e-01],
         [ 5.0009e-02, -1.3003e-01],
         [ 5.0009e-02, -1.2710e-01],
         [ 5.0009e-02, -1.4074e-01],
         [ 5.0009e-02, -1.1674e-01],
         [ 5.0009e-02, -1.2994e-01],
         [ 5.0009e-02, -1.1046e-01],
         [ 5.0009e-02,  5.3609e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.7723e-06, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.4690, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4687, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6575, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0566, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2165, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0480, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1919642.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1996, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.0759e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1355, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2489, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1355, device='cuda:0', grad_fn=<MinBackward1>)
t_env 4953
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6527e-02,  7.9265e-02,  ...,  4.2534e-02,
            1.3764e-01, -1.0000e+07],
          [-1.0000e+07, -3.4160e-02,  1.2734e-01,  ...,  3.6650e-02,
            1.4514e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7552e-02,  6.9527e-02,  ...,  3.6922e-02,
            1.3246e-01, -1.0000e+07],
          [-1.0000e+07, -6.9459e-02,  1.5722e-01,  ...,  6.3242e-02,
            1.5510e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4887e-01,  4.9958e-02,  ...,  3.2413e-02,
            1.7518e-01, -3.0026e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6329e-01,  7.7314e-02,  ...,  6.4431e-02,
            1.9656e-01, -3.1323e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-8.6026e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0948e-02,  7.3316e-02,  ...,  4.2360e-02,
            1.4141e-01, -1.0000e+07],
          [-1.0000e+07, -1.8789e-02,  1.1070e-01,  ...,  4.1064e-03,
            1.2950e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0493e-01,  9.5342e-02,  ...,  2.8501e-02,
            1.6248e-01, -1.0000e+07],
          [-1.0000e+07, -2.5057e-02,  1.2023e-01,  ..., -1.0731e-02,
            1.3315e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 7.9265e-02,  1.2734e-01],
         [-6.7552e-02,  1.5722e-01],
         [-7.9998e-02,  1.3407e-01],
         [-8.9205e-02, -4.7719e-02],
         [ 1.1077e-01, -5.3990e-02],
         [ 1.0885e-01, -4.7570e-02],
         [ 1.1219e-01,  1.0466e-01],
         [ 1.2187e-01,  9.2092e-02],
         [ 1.2941e-01, -5.0582e-02],
         [ 1.2847e-01,  1.2769e-01],
         [ 1.3701e-01, -9.8820e-02],
         [ 1.1949e-01, -1.1117e-01],
         [ 9.6336e-02, -1.1942e-01],
         [ 1.0414e-01, -9.7406e-02],
         [-4.7995e-02, -9.4385e-02],
         [-4.2335e-02, -8.5589e-02],
         [ 1.2142e-01,  9.3602e-02],
         [ 1.0903e-01,  1.0871e-01],
         [ 1.2760e-01,  8.5809e-02],
         [ 1.3876e-01,  1.0593e-01],
         [ 1.3461e-01,  1.0264e-01],
         [ 1.3718e-01,  1.0112e-01],
         [ 1.4534e-01, -8.3229e-02],
         [ 1.3053e-01, -7.8827e-02],
         [ 1.5854e-01,  8.0270e-02],
         [ 1.6483e-01,  1.0052e-01],
         [ 1.8051e-01,  1.4853e-01],
         [ 1.4739e-01,  1.6411e-01],
         [ 1.6740e-01,  1.5900e-01],
         [ 1.7496e-01,  1.8515e-01],
         [ 1.8802e-01,  1.9385e-01],
         [ 1.8790e-01,  1.4945e-01],
         [ 1.8971e-01, -8.2770e-02],
         [ 1.5564e-01,  1.3987e-01],
         [ 1.7631e-01, -1.2418e-01],
         [ 1.6737e-01, -1.5064e-01],
         [ 1.7581e-01,  1.1055e-01],
         [ 1.9133e-01,  9.9574e-02],
         [ 2.0358e-01, -1.4168e-01],
         [ 1.6890e-01,  1.0010e-01],
         [ 1.9061e-01, -1.5290e-01],
         [ 1.9686e-01, -1.3350e-01],
         [ 1.5919e-01,  9.0457e-02],
         [-1.1981e-01,  1.0169e-01],
         [-1.1430e-01,  1.3351e-01],
         [-6.2971e-03, -1.1240e-01],
         [ 2.3971e-02, -1.0619e-01],
         [ 3.8744e-02, -6.2238e-02],
         [ 4.5555e-02,  1.3037e-01],
         [ 4.8516e-02,  1.4562e-01],
         [ 4.9665e-02, -6.0960e-02],
         [ 5.0048e-02, -4.1698e-02],
         [ 5.0141e-02,  1.3513e-01],
         [ 5.0132e-02,  1.6858e-01],
         [ 5.0067e-02, -6.3315e-02],
         [ 5.0055e-02, -9.9408e-02],
         [ 5.0023e-02, -1.1838e-01],
         [ 5.0024e-02, -1.1157e-01],
         [ 5.0018e-02, -1.1959e-01],
         [ 5.0000e-02, -1.3599e-01],
         [ 5.0017e-02, -1.3071e-01],
         [ 5.0013e-02, -1.1818e-01],
         [ 5.0027e-02, -1.1340e-01],
         [ 5.0017e-02,  7.7275e-02],
         [ 5.0017e-02,  8.6950e-02],
         [ 5.0012e-02, -1.2467e-01],
         [ 5.0009e-02, -1.1681e-01],
         [ 5.0006e-02,  7.8928e-02],
         [ 5.0008e-02, -1.1502e-01],
         [ 5.0007e-02,  8.0987e-02],
         [ 5.0008e-02, -1.1624e-01],
         [ 5.0008e-02,  1.0192e-01],
         [ 5.0008e-02,  1.1354e-01],
         [ 5.0008e-02, -1.4146e-01],
         [ 5.0008e-02, -1.4544e-01],
         [ 5.0008e-02, -1.3784e-01],
         [ 5.0008e-02, -1.2199e-01],
         [ 5.0008e-02, -1.2875e-01],
         [ 5.0009e-02, -1.2153e-01],
         [ 5.0009e-02, -1.1661e-01],
         [ 5.0009e-02,  7.7326e-02],
         [ 5.0009e-02,  8.7918e-02],
         [ 5.0009e-02,  9.2311e-02],
         [ 5.0009e-02,  7.7767e-02],
         [ 5.0009e-02,  1.0283e-01],
         [ 5.0009e-02,  9.8664e-02],
         [ 5.0009e-02, -1.5582e-01],
         [ 5.0009e-02, -1.5815e-01],
         [ 5.0009e-02,  9.6231e-02],
         [ 5.0009e-02,  9.6428e-02],
         [ 5.0009e-02,  1.0940e-01],
         [ 5.0009e-02,  9.9618e-02],
         [ 5.0009e-02, -1.6088e-01],
         [ 5.0009e-02, -1.4374e-01],
         [ 5.0009e-02, -1.4898e-01],
         [ 5.0009e-02, -1.3490e-01],
         [ 5.0009e-02, -1.2238e-01],
         [ 5.0009e-02, -1.2558e-01],
         [ 5.0009e-02, -1.2425e-01],
         [ 5.0009e-02, -1.1895e-01],
         [ 5.0009e-02, -1.1868e-01],
         [ 5.0009e-02, -1.1464e-01],
         [ 5.0009e-02, -1.1565e-01],
         [ 5.0009e-02, -1.1008e-01],
         [ 5.0009e-02, -9.6754e-02],
         [ 5.0009e-02, -7.3389e-02],
         [ 5.0009e-02, -7.8106e-02],
         [ 5.0009e-02, -7.5235e-02],
         [ 5.0009e-02, -7.7414e-02],
         [ 5.0009e-02, -4.0796e-02],
         [ 5.0009e-02, -4.5881e-02],
         [ 5.0009e-02, -6.4675e-02],
         [ 5.0009e-02, -9.4603e-02],
         [ 5.0009e-02,  7.5200e-02],
         [ 5.0009e-02, -1.0317e-01],
         [ 5.0009e-02, -8.9556e-02],
         [ 5.0009e-02, -4.2387e-02],
         [ 5.0009e-02, -4.3789e-02],
         [ 5.0009e-02, -2.2137e-02],
         [ 5.0009e-02, -2.3770e-02],
         [ 5.0009e-02, -3.6895e-02],
         [ 5.0009e-02, -7.9451e-02],
         [ 5.0009e-02, -9.1011e-02],
         [ 5.0009e-02, -8.7119e-02],
         [ 5.0009e-02, -8.0948e-02],
         [ 5.0009e-02, -9.9129e-02],
         [ 5.0009e-02, -9.8523e-02],
         [ 5.0009e-02, -9.7874e-02],
         [ 5.0009e-02, -1.1337e-01],
         [ 5.0009e-02,  8.6841e-02],
         [ 5.0009e-02,  9.6118e-02],
         [ 5.0009e-02,  1.0580e-01],
         [ 5.0009e-02, -1.5400e-01],
         [ 5.0009e-02, -1.4740e-01],
         [ 5.0009e-02, -1.5267e-01],
         [ 5.0009e-02, -1.5522e-01],
         [ 5.0009e-02, -1.5498e-01],
         [ 5.0009e-02, -1.4887e-01],
         [ 5.0009e-02, -1.6329e-01],
         [ 5.0009e-02, -8.6026e-03]],

        [[ 1.0780e-01,  8.9914e-02],
         [ 7.3316e-02,  1.1070e-01],
         [ 9.5342e-02,  1.2023e-01],
         [-9.2587e-02,  1.4156e-01],
         [ 8.1485e-02, -4.0353e-02],
         [-7.6575e-02, -4.8187e-02],
         [ 9.7613e-02, -3.1261e-02],
         [-8.4542e-02,  9.9181e-02],
         [-9.1425e-02, -4.0001e-02],
         [ 9.8131e-02, -4.6573e-02],
         [-9.2479e-02, -6.3116e-02],
         [-8.8738e-02, -7.2894e-02],
         [-7.3215e-02,  1.1220e-01],
         [-5.2229e-02, -9.1545e-02],
         [-6.8613e-02,  1.0364e-01],
         [-7.4374e-02,  1.1695e-01],
         [-5.6511e-02,  7.7338e-02],
         [-4.0418e-02,  1.1185e-01],
         [-5.1149e-02,  1.2157e-01],
         [-5.6808e-02, -1.7781e-01],
         [-4.2105e-02,  9.8220e-02],
         [-5.2184e-02,  1.1613e-01],
         [-6.9471e-02, -1.9969e-01],
         [-4.9075e-02,  9.6023e-02],
         [-5.2413e-02,  1.0995e-01],
         [-6.8974e-02,  9.8083e-02],
         [ 1.3189e-01, -1.6438e-01],
         [ 1.5355e-01, -1.4232e-01],
         [ 1.3319e-01, -1.2817e-01],
         [ 1.4755e-01, -1.3862e-01],
         [ 1.4394e-01, -1.3374e-01],
         [ 1.1068e-01, -1.1742e-01],
         [ 1.3933e-01, -1.1364e-01],
         [ 1.0936e-01, -1.0852e-01],
         [ 1.4213e-01, -1.1956e-01],
         [ 1.1816e-01, -6.4278e-03],
         [-1.9170e-01,  2.5142e-02],
         [-1.8751e-01,  4.2084e-02],
         [-1.5910e-01,  5.0180e-02],
         [-1.7277e-01,  5.3727e-02],
         [ 1.0120e-01,  5.5128e-02],
         [ 8.3156e-02,  5.5544e-02],
         [ 1.2780e-01,  5.5612e-02],
         [ 9.8728e-02,  5.5523e-02],
         [ 1.1408e-01,  5.5444e-02],
         [ 8.9938e-02,  5.5359e-02],
         [ 9.4646e-02,  5.5309e-02],
         [ 9.5243e-02,  5.5259e-02],
         [ 9.3598e-02,  5.5215e-02],
         [ 8.0578e-02,  5.5232e-02],
         [ 7.5030e-02,  5.5209e-02],
         [ 1.0299e-01,  5.5215e-02],
         [ 8.2706e-02,  5.5215e-02],
         [ 1.1988e-01,  5.5220e-02],
         [ 8.9034e-02,  5.5223e-02],
         [-1.6264e-01,  5.5231e-02],
         [-1.4641e-01,  5.5232e-02],
         [ 1.5547e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.2598e-05, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0015, device='cuda:0')
mixer_td_error tensor(0.7498, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4897, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5394, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0603, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2243, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0290, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2943261.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2036, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.0334e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1189, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2873, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1189, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5087
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2714e-01,  1.2420e-01,  ...,  7.0546e-02,
            1.5857e-01, -1.0000e+07],
          [-1.0000e+07, -3.8311e-02,  1.3382e-01,  ...,  4.0568e-02,
            1.4396e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4124e-01,  1.2148e-01,  ...,  5.2743e-02,
            1.5640e-01, -1.0000e+07],
          [-1.0000e+07, -4.4101e-02,  1.1387e-01,  ...,  3.1959e-02,
            1.4699e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.8956e-01,  8.1104e-02,  ...,  8.0826e-02,
            2.1827e-01, -3.2595e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6913e-01,  3.3983e-02,  ...,  7.0350e-02,
            1.9429e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-7.5836e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9711e-02,  8.6010e-02,  ...,  5.5065e-03,
            1.3727e-01, -1.0000e+07],
          [-1.0000e+07, -4.5321e-02,  1.0753e-01,  ...,  3.5616e-02,
            1.4810e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.8586e-02,  7.7246e-02,  ..., -1.5416e-02,
            1.4423e-01, -1.0000e+07],
          [-1.0000e+07, -7.5122e-02,  1.5329e-01,  ...,  6.1145e-02,
            1.5160e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6433e-01,  9.7892e-02,  ...,  2.8258e-02,
            1.4259e-01, -3.1301e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7204e-01,  7.2450e-02,  ...,  3.8370e-02,
            1.4430e-01, -3.1364e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.1153e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 1.2420e-01,  1.3382e-01],
         [ 1.2148e-01,  1.1387e-01],
         [ 1.0986e-01,  1.4507e-01],
         [ 1.0952e-01, -6.5580e-02],
         [ 1.2025e-01, -6.5969e-02],
         [ 1.4318e-01, -6.4253e-02],
         [ 1.5263e-01, -7.6448e-02],
         [ 1.0886e-01, -5.6641e-02],
         [ 1.2477e-01, -4.5811e-02],
         [ 9.5833e-02, -5.5508e-02],
         [ 1.3488e-01, -6.6582e-02],
         [ 1.1366e-01, -7.3897e-02],
         [ 1.2369e-01, -6.5384e-02],
         [ 1.1317e-01,  1.0651e-01],
         [ 1.3141e-01,  1.1024e-01],
         [ 1.3784e-01,  1.1873e-01],
         [ 1.3961e-01,  1.1539e-01],
         [-1.8368e-01,  1.1476e-01],
         [ 1.1373e-01,  7.9695e-02],
         [ 1.1599e-01, -1.4127e-01],
         [-1.6329e-01, -1.4983e-01],
         [ 3.3602e-03,  1.0712e-01],
         [ 2.9334e-02,  1.1335e-01],
         [ 4.1687e-02,  1.1630e-01],
         [ 4.7262e-02, -1.6147e-01],
         [ 4.9526e-02, -1.5784e-01],
         [ 5.0302e-02,  9.7265e-02],
         [ 5.0450e-02, -1.5729e-01],
         [ 5.0377e-02, -1.6910e-01],
         [ 5.0258e-02, -1.6804e-01],
         [ 5.0170e-02, -1.8278e-01],
         [ 5.0082e-02, -1.7968e-01],
         [ 5.0056e-02, -1.7803e-01],
         [ 5.0041e-02, -1.5856e-01],
         [ 5.0034e-02, -1.5340e-01],
         [ 5.0018e-02, -1.4143e-01],
         [ 5.0013e-02,  9.2782e-02],
         [ 5.0012e-02,  9.0262e-02],
         [ 5.0011e-02, -1.6047e-01],
         [ 5.0013e-02, -1.5245e-01],
         [ 5.0014e-02, -1.3224e-01],
         [ 5.0016e-02, -1.3536e-01],
         [ 5.0008e-02,  8.8205e-02],
         [ 5.0008e-02,  1.0803e-01],
         [ 5.0007e-02,  8.4232e-02],
         [ 5.0007e-02,  9.7753e-02],
         [ 5.0008e-02, -1.5738e-01],
         [ 5.0008e-02, -1.3075e-01],
         [ 5.0008e-02, -1.3200e-01],
         [ 5.0008e-02, -1.2322e-01],
         [ 5.0008e-02,  9.2425e-02],
         [ 5.0008e-02,  1.0459e-01],
         [ 5.0008e-02,  9.5812e-02],
         [ 5.0009e-02,  9.2397e-02],
         [ 5.0009e-02, -1.9052e-01],
         [ 5.0009e-02,  1.0857e-01],
         [ 5.0009e-02, -1.8720e-01],
         [ 5.0009e-02, -1.7166e-01],
         [ 5.0009e-02, -1.8956e-01],
         [ 5.0009e-02, -1.6913e-01],
         [ 5.0009e-02, -7.5836e-04]],

        [[ 7.4276e-02,  1.4162e-01],
         [ 8.6010e-02,  1.0753e-01],
         [-7.8586e-02,  1.5329e-01],
         [ 1.0076e-01,  1.3148e-01],
         [ 1.0388e-01,  1.4759e-01],
         [-1.0577e-01,  1.1312e-01],
         [-9.2450e-02,  1.5570e-01],
         [-9.3624e-02,  1.3358e-01],
         [ 1.0653e-01,  1.5320e-01],
         [-8.4031e-02,  1.2994e-01],
         [-9.1158e-02,  1.3363e-01],
         [ 1.0493e-01, -1.2910e-01],
         [ 1.0353e-01,  1.4016e-01],
         [-9.8481e-02,  1.6199e-01],
         [ 1.0925e-01,  1.5031e-01],
         [ 7.8066e-02, -1.3941e-01],
         [ 9.8661e-02, -1.3729e-01],
         [ 1.1791e-01, -1.2779e-01],
         [ 1.1777e-01, -1.2437e-01],
         [ 1.2904e-01, -1.3354e-01],
         [ 1.3727e-01, -1.1966e-01],
         [ 1.5609e-01, -1.2379e-01],
         [ 1.6293e-01, -1.1847e-01],
         [ 1.1898e-01, -2.5146e-05],
         [ 1.3153e-01,  3.0002e-02],
         [ 1.0374e-01,  4.5015e-02],
         [-1.6699e-01,  5.1843e-02],
         [-1.7326e-01,  5.4623e-02],
         [-1.5734e-01,  5.5590e-02],
         [ 1.0763e-01,  5.5764e-02],
         [-1.7039e-01,  5.5709e-02],
         [-1.4381e-01,  5.5519e-02],
         [-1.2245e-01,  5.5416e-02],
         [ 9.5371e-02,  5.5326e-02],
         [ 1.0704e-01,  5.5294e-02],
         [ 1.0364e-01,  5.5259e-02],
         [ 7.1136e-02,  5.5208e-02],
         [ 7.9778e-02,  5.5235e-02],
         [ 8.9420e-02,  5.5219e-02],
         [ 1.0514e-01,  5.5214e-02],
         [-1.1522e-01,  5.5201e-02],
         [-9.2833e-02,  5.5219e-02],
         [ 1.0094e-01,  5.5223e-02],
         [ 8.9426e-02,  5.5231e-02],
         [ 9.2179e-02,  5.5231e-02],
         [ 7.8348e-02,  5.5230e-02],
         [ 9.8602e-02,  5.5231e-02],
         [ 1.0804e-01,  5.5232e-02],
         [ 1.2502e-01,  5.5236e-02],
         [ 1.3312e-01,  5.5236e-02],
         [ 1.3634e-01,  5.5232e-02],
         [ 1.2766e-01,  5.5232e-02],
         [ 1.2473e-01,  5.5231e-02],
         [ 1.0027e-01,  5.5231e-02],
         [ 1.0140e-01,  5.5231e-02],
         [ 8.8376e-02,  5.5231e-02],
         [ 9.1831e-02,  5.5231e-02],
         [-1.7426e-01,  5.5231e-02],
         [-1.5715e-01,  5.5231e-02],
         [-1.6433e-01,  5.5231e-02],
         [-1.7204e-01,  5.5231e-02],
         [ 2.1153e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.6895e-05, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(-0.0018, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.3962, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3484, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0570, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1645, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0512, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(0.0274, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1629, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1905, device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.6428e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(1.2673e-09, device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(0.2851, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1348, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2851, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1348, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5133
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0799e-01,  1.0994e-01,  ...,  4.2512e-02,
            1.4205e-01, -1.0000e+07],
          [-1.0000e+07, -4.1562e-02,  1.2343e-01,  ...,  1.2672e-02,
            1.4219e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3438e-01,  9.7930e-02,  ...,  1.1659e-02,
            1.6183e-01, -1.0000e+07],
          [-1.0000e+07, -4.3874e-02,  1.2534e-01,  ...,  1.1010e-03,
            1.3669e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6085e-02,  1.0713e-01,  ...,  2.0049e-02,
            1.6247e-01, -1.0000e+07],
          [-1.0000e+07, -1.6729e-02,  1.0948e-01,  ...,  2.6640e-03,
            1.2965e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2949e-01,  1.2515e-01,  ...,  4.9588e-02,
            1.6998e-01, -1.0000e+07],
          [-1.0000e+07, -4.1626e-02,  1.0611e-01,  ..., -2.7111e-02,
            1.3520e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6136e-01,  7.7979e-02,  ...,  6.1733e-02,
            2.1013e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5838e-01,  5.7839e-02,  ...,  4.5371e-02,
            2.0169e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.9531e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 1.0994e-01,  1.2343e-01],
         [ 9.7930e-02,  1.2534e-01],
         [ 1.0625e-01,  1.3966e-01],
         [ 1.1269e-01,  1.4718e-01],
         [ 8.1481e-02,  1.4742e-01],
         [ 1.0400e-01,  1.0735e-01],
         [ 1.2266e-01,  9.1390e-02],
         [ 1.4349e-01,  8.1006e-02],
         [ 1.3349e-01,  1.1534e-01],
         [ 1.4140e-01,  1.5677e-01],
         [ 1.4851e-01,  1.0557e-01],
         [ 1.4070e-01,  9.0153e-02],
         [ 1.5193e-01,  1.0268e-01],
         [ 1.6019e-01,  1.0578e-01],
         [ 1.3743e-01, -6.5687e-02],
         [ 1.1959e-01,  1.1829e-01],
         [ 1.0580e-01,  9.9678e-02],
         [ 1.2391e-01,  1.2517e-01],
         [ 1.5386e-01,  9.8218e-02],
         [ 1.3260e-01,  8.3014e-02],
         [ 1.5643e-01,  1.1507e-01],
         [ 1.6528e-01,  8.4373e-02],
         [ 1.6542e-01,  1.3441e-01],
         [ 1.6946e-01,  8.1155e-02],
         [-8.5710e-03, -8.2824e-02],
         [ 2.0147e-02, -6.9538e-02],
         [ 3.6399e-02, -7.5921e-02],
         [ 4.4441e-02, -6.2365e-02],
         [ 4.8131e-02,  8.1286e-02],
         [ 4.9595e-02, -7.3254e-02],
         [ 5.0121e-02, -6.7328e-02],
         [ 5.0214e-02, -5.7440e-02],
         [ 5.0189e-02, -5.5234e-02],
         [ 5.0129e-02, -5.4974e-02],
         [ 5.0072e-02, -3.9688e-02],
         [ 5.0047e-02, -1.7821e-03],
         [ 5.0023e-02,  5.5546e-03],
         [ 5.0026e-02, -1.5447e-02],
         [ 5.0031e-02, -4.4415e-02],
         [ 5.0021e-02, -3.4436e-02],
         [ 5.0018e-02, -5.0084e-02],
         [ 5.0009e-02, -5.0979e-02],
         [ 5.0017e-02,  8.3787e-02],
         [ 5.0022e-02, -5.9878e-02],
         [ 5.0015e-02, -6.4159e-02],
         [ 5.0006e-02,  7.5641e-02],
         [ 5.0007e-02, -2.5247e-02],
         [ 5.0007e-02, -9.8839e-03],
         [ 5.0008e-02, -4.2000e-02],
         [ 5.0008e-02, -3.2936e-02],
         [ 5.0008e-02, -3.2373e-02],
         [ 5.0008e-02,  9.5297e-02],
         [ 5.0008e-02,  9.8804e-02],
         [ 5.0008e-02, -5.1359e-03],
         [ 5.0008e-02,  1.4415e-01],
         [ 5.0008e-02,  1.6120e-01],
         [ 5.0009e-02,  6.5308e-03],
         [ 5.0009e-02,  5.4792e-03],
         [ 5.0009e-02, -1.5851e-02],
         [ 5.0009e-02, -5.1729e-03],
         [ 5.0009e-02, -8.4784e-03],
         [ 5.0009e-02,  2.3201e-03],
         [ 5.0009e-02, -1.5290e-02],
         [ 5.0009e-02, -2.5984e-02],
         [ 5.0009e-02,  9.1845e-02],
         [ 5.0009e-02,  9.3659e-02],
         [ 5.0009e-02,  9.7269e-02],
         [ 5.0009e-02, -5.5886e-02],
         [ 5.0009e-02,  1.0572e-01],
         [ 5.0009e-02, -1.0803e-01],
         [ 5.0009e-02, -1.1816e-01],
         [ 5.0009e-02, -1.2414e-01],
         [ 5.0009e-02, -1.1472e-01],
         [ 5.0009e-02,  7.2448e-02],
         [ 5.0009e-02,  1.0636e-01],
         [ 5.0009e-02,  1.0683e-01],
         [ 5.0009e-02,  5.9114e-02],
         [ 5.0009e-02,  8.4279e-02],
         [ 5.0009e-02,  7.6117e-02],
         [ 5.0009e-02,  6.8341e-02],
         [ 5.0009e-02,  4.7834e-02],
         [ 5.0009e-02,  7.3401e-02],
         [ 5.0009e-02,  8.4969e-02],
         [ 5.0009e-02,  1.0764e-01],
         [ 5.0009e-02,  1.1552e-01],
         [ 5.0009e-02,  1.2484e-01],
         [ 5.0009e-02,  6.6300e-02],
         [ 5.0009e-02, -1.5720e-01],
         [ 5.0009e-02, -1.5423e-01],
         [ 5.0009e-02, -1.5107e-01],
         [ 5.0009e-02, -1.6552e-01],
         [ 5.0009e-02,  8.5541e-02],
         [ 5.0009e-02, -1.7427e-01],
         [ 5.0009e-02, -1.6810e-01],
         [ 5.0009e-02, -1.8747e-01],
         [ 5.0009e-02, -1.6583e-01],
         [ 5.0009e-02, -1.5896e-01],
         [ 5.0009e-02,  2.1483e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.6186e-02,  8.7099e-02],
         [ 1.0713e-01,  1.0948e-01],
         [ 1.2515e-01,  1.0611e-01],
         [ 8.0899e-02,  1.1336e-01],
         [-8.0354e-02,  1.0185e-01],
         [-6.3036e-02,  1.2298e-01],
         [-4.6483e-02,  9.6206e-02],
         [ 1.2665e-01,  1.1432e-01],
         [ 1.1247e-01,  1.2499e-01],
         [ 1.1252e-01,  9.3804e-02],
         [ 1.1003e-01,  9.8019e-02],
         [-3.4142e-02,  1.2589e-01],
         [-2.5507e-02,  1.0686e-01],
         [-2.1500e-02, -7.2733e-03],
         [ 1.2242e-01, -1.4600e-02],
         [ 1.2792e-01,  2.4736e-03],
         [ 1.3248e-01,  1.1565e-01],
         [ 1.3427e-01,  1.6453e-03],
         [ 1.1331e-01, -9.1634e-04],
         [ 1.2380e-01,  1.1041e-01],
         [ 1.2819e-01,  8.5536e-02],
         [ 1.3231e-01,  1.1466e-01],
         [ 1.3176e-01,  8.8409e-02],
         [ 1.2536e-01, -1.4568e-02],
         [ 1.3468e-01, -7.1965e-03],
         [ 1.1689e-01, -7.4266e-03],
         [ 1.2810e-01, -1.0687e-03],
         [ 1.3390e-01, -1.0687e-02],
         [ 1.2425e-01,  1.2665e-01],
         [ 1.3223e-01,  1.0507e-01],
         [ 1.3749e-01, -2.6051e-02],
         [ 1.3619e-01,  1.1780e-01],
         [ 1.2289e-01,  1.3038e-01],
         [ 1.2628e-01,  1.3136e-01],
         [ 1.1671e-01,  1.1052e-01],
         [ 1.3199e-01,  1.1744e-01],
         [ 1.3197e-01, -4.7816e-02],
         [ 1.2690e-01,  1.1468e-01],
         [ 1.1842e-01,  1.2454e-01],
         [ 1.2883e-01,  1.2811e-01],
         [ 9.9860e-02,  1.1142e-01],
         [ 1.0214e-01, -5.7370e-02],
         [ 1.2861e-01, -4.8169e-02],
         [ 1.2280e-01, -4.6007e-02],
         [ 1.3095e-01,  1.2189e-01],
         [ 1.1298e-01,  1.2948e-01],
         [ 1.3060e-01,  1.3407e-01],
         [ 1.1445e-01, -4.0849e-02],
         [ 1.2675e-01, -3.3967e-02],
         [ 1.3037e-01,  1.1688e-01],
         [ 1.3527e-01,  1.1145e-01],
         [ 1.3276e-01,  1.3142e-01],
         [ 1.0142e-01,  1.4162e-01],
         [ 1.3241e-01,  1.6224e-01],
         [ 1.0126e-01,  1.0793e-01],
         [ 9.7777e-02,  1.0523e-01],
         [ 1.1396e-01,  1.2053e-01],
         [ 1.3390e-01,  1.1367e-01],
         [ 1.3639e-01,  1.0583e-01],
         [ 1.3709e-01,  1.2124e-01],
         [ 1.0766e-01,  1.4208e-01],
         [ 1.2675e-01,  1.5251e-01],
         [ 1.3079e-01,  1.5448e-01],
         [ 1.4527e-01,  9.9324e-02],
         [ 1.5234e-01,  8.1534e-02],
         [ 1.2637e-01,  1.1337e-01],
         [ 1.4666e-01,  8.1669e-02],
         [ 1.5202e-01,  8.0329e-02],
         [ 1.5750e-01,  7.4920e-02],
         [ 1.5763e-01,  7.9899e-02],
         [ 1.5727e-01,  1.0330e-01],
         [ 1.3804e-01,  8.7934e-02],
         [ 1.2791e-01,  8.5560e-02],
         [ 1.1156e-01,  6.1356e-02],
         [ 1.4442e-01,  5.9097e-02],
         [ 1.3595e-01,  9.9758e-02],
         [ 1.3881e-01,  7.8513e-02],
         [ 1.4518e-01,  1.0798e-01],
         [ 1.0868e-01,  8.5542e-02],
         [ 9.5629e-02,  7.9942e-02],
         [ 1.2690e-01,  7.7177e-02],
         [ 1.3988e-01,  1.0154e-01],
         [ 1.3920e-01,  8.4300e-02],
         [ 1.5214e-01,  1.1349e-01],
         [ 1.3801e-01,  1.2262e-01],
         [ 1.5075e-01,  1.0082e-01],
         [ 1.5866e-01,  1.2287e-01],
         [ 1.3687e-01,  9.1488e-02],
         [ 1.3561e-01,  1.0362e-01],
         [ 1.3528e-01,  1.0941e-01],
         [-1.9949e-01,  1.1764e-01],
         [-7.1922e-03, -1.0780e-01],
         [ 1.6213e-02, -8.0468e-02],
         [ 3.2136e-02, -8.5812e-02],
         [ 4.1262e-02,  8.4014e-02],
         [ 4.6006e-02,  9.1413e-02],
         [ 4.8333e-02,  6.6010e-02],
         [ 4.9397e-02,  9.1410e-02],
         [ 4.9831e-02, -8.1566e-02],
         [ 5.0029e-02, -5.0763e-02],
         [ 5.0049e-02, -5.4832e-02],
         [ 5.0070e-02, -7.2186e-02],
         [ 5.0045e-02, -6.9299e-02],
         [ 5.0052e-02, -6.6710e-02],
         [ 5.0030e-02, -5.8681e-02],
         [ 5.0026e-02, -5.8359e-02],
         [ 5.0025e-02, -5.5200e-02],
         [ 5.0024e-02, -6.2861e-02],
         [ 5.0047e-02,  6.9341e-02],
         [ 5.0026e-02, -7.4350e-02],
         [ 5.0007e-02, -5.4113e-02],
         [ 5.0016e-02, -4.6430e-02],
         [ 5.0015e-02,  8.9857e-02],
         [ 5.0008e-02, -3.0966e-02],
         [ 5.0008e-02, -3.3476e-02],
         [ 5.0009e-02,  8.8298e-02],
         [ 5.0009e-02, -3.8207e-02],
         [ 5.0008e-02, -2.1701e-02],
         [ 5.0008e-02,  8.7932e-03],
         [ 5.0008e-02,  1.3411e-01],
         [ 5.0008e-02,  1.5607e-01],
         [ 5.0008e-02,  1.1941e-01],
         [ 5.0008e-02, -3.8029e-02],
         [ 5.0008e-02, -3.5575e-02],
         [ 5.0009e-02, -7.4685e-04],
         [ 5.0009e-02,  1.3751e-01],
         [ 5.0009e-02,  1.5849e-01],
         [ 5.0009e-02,  1.6696e-01],
         [ 5.0009e-02,  5.8487e-03],
         [ 5.0009e-02, -1.7561e-02],
         [ 5.0009e-02,  9.6108e-02],
         [ 5.0009e-02, -1.3329e-02],
         [ 5.0009e-02, -2.5841e-02],
         [ 5.0009e-02, -1.9824e-02],
         [ 5.0009e-02, -2.6416e-02],
         [ 5.0009e-02, -3.1827e-02],
         [ 5.0009e-02,  9.4761e-02],
         [ 5.0009e-02, -1.5903e-02],
         [ 5.0009e-02, -1.4392e-02],
         [ 5.0009e-02, -2.2945e-02],
         [ 5.0009e-02,  4.8837e-03],
         [ 5.0009e-02, -2.9409e-02],
         [ 5.0009e-02, -3.5167e-02],
         [ 5.0009e-02, -4.8477e-02],
         [ 5.0009e-02, -4.7522e-02],
         [ 5.0009e-02, -6.8352e-02],
         [ 5.0009e-02, -5.9285e-02],
         [ 5.0009e-02, -5.5571e-02],
         [ 5.0009e-02, -6.9711e-02],
         [ 5.0009e-02,  9.2868e-02],
         [ 5.0009e-02, -6.0093e-02],
         [ 5.0009e-02,  8.8516e-02],
         [ 5.0009e-02,  1.0019e-01],
         [ 5.0009e-02,  1.0272e-01],
         [ 5.0009e-02, -6.7342e-02],
         [ 5.0009e-02, -6.6704e-02],
         [ 5.0009e-02, -5.6138e-02],
         [ 5.0009e-02, -6.6396e-02],
         [ 5.0009e-02, -5.6237e-02],
         [ 5.0009e-02, -5.4717e-02],
         [ 5.0009e-02,  9.5212e-02],
         [ 5.0009e-02, -1.1212e-01],
         [ 5.0009e-02,  9.0742e-02],
         [ 5.0009e-02,  6.4022e-02],
         [ 5.0009e-02,  9.7395e-02],
         [ 5.0009e-02,  6.2976e-02],
         [ 5.0009e-02, -1.3479e-01],
         [ 5.0009e-02, -1.2201e-01],
         [ 5.0009e-02,  7.8263e-02],
         [ 5.0009e-02, -1.1928e-01],
         [ 5.0009e-02,  7.8058e-02],
         [ 5.0009e-02,  5.7546e-02],
         [ 5.0009e-02,  8.0579e-02],
         [ 5.0009e-02,  5.7042e-02],
         [ 5.0009e-02,  4.6639e-02],
         [ 5.0009e-02,  7.8451e-02],
         [ 5.0009e-02,  9.1922e-02],
         [ 5.0009e-02,  1.1326e-01],
         [ 5.0009e-02,  1.1961e-01],
         [ 5.0009e-02,  1.2729e-01],
         [ 5.0009e-02,  1.0692e-01],
         [ 5.0009e-02, -1.7356e-01],
         [ 5.0009e-02, -1.7129e-01],
         [ 5.0009e-02,  9.3280e-02],
         [ 5.0009e-02, -1.6783e-01],
         [ 5.0009e-02, -1.5394e-01],
         [ 5.0009e-02,  7.0202e-02],
         [ 5.0009e-02,  7.6510e-02],
         [ 5.0009e-02, -1.6136e-01],
         [ 5.0009e-02, -1.5838e-01],
         [ 5.0009e-02,  1.9531e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.4040e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.5684, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4644, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4892, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0481, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1735, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0892, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2408376.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1695, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.5671e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1334, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.3518, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1334, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5227
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3285e-02,  8.7210e-02,  ..., -7.6795e-03,
            1.4393e-01, -1.0000e+07],
          [-1.0000e+07, -2.8180e-02,  9.9658e-02,  ..., -1.6816e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5860e-02,  1.0411e-01,  ...,  2.0191e-02,
            1.7078e-01, -1.0000e+07],
          [-1.0000e+07, -2.5520e-02,  1.0800e-01,  ...,  9.6872e-03,
            1.3684e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4689e-02,  1.0709e-01,  ...,  1.4450e-02,
            1.5237e-01, -1.0000e+07],
          [-1.0000e+07, -2.1835e-02,  9.9402e-02,  ..., -1.5839e-02,
            1.3204e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0286e-02,  1.0929e-01,  ...,  4.9539e-03,
            1.4714e-01, -1.0000e+07],
          [-1.0000e+07, -4.0755e-02,  1.1664e-01,  ..., -1.3107e-02,
            1.4728e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5109e-01,  4.3734e-02,  ...,  2.5633e-02,
            1.9335e-01, -3.0600e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4069e-01,  2.7674e-02,  ...,  3.4865e-02,
            1.7954e-01, -3.0370e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.5720e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02,  8.7099e-02],
         [ 8.7210e-02,  9.9658e-02],
         [ 1.0411e-01,  1.0800e-01],
         [ 8.4719e-02,  1.1353e-01],
         [ 1.1527e-01,  1.1500e-01],
         [ 1.3986e-01,  1.3945e-01],
         [ 1.5921e-01,  1.2947e-01],
         [ 1.8385e-01,  1.5109e-01],
         [ 1.9812e-01,  1.6420e-01],
         [ 2.0879e-01,  1.3194e-01],
         [ 2.1005e-01,  1.7221e-01],
         [-9.5974e-02,  1.1014e-01],
         [ 1.7339e-01,  1.4619e-01],
         [ 1.6457e-01,  1.7519e-01],
         [ 1.6330e-01,  1.9288e-01],
         [ 1.4416e-01,  1.9414e-01],
         [ 1.3343e-01,  1.8718e-01],
         [ 1.1781e-01,  1.0292e-01],
         [ 1.5939e-01,  1.1416e-01],
         [ 1.3005e-01,  7.5181e-02],
         [ 1.7852e-01, -1.2116e-01],
         [ 1.3769e-01, -1.4056e-01],
         [ 1.5594e-01,  1.0584e-01],
         [ 1.2068e-01,  1.1093e-01],
         [ 1.0612e-01,  1.1869e-01],
         [ 6.7176e-02,  8.0068e-02],
         [ 9.5707e-02,  1.0542e-01],
         [ 6.7872e-02,  1.1147e-01],
         [ 9.8581e-02,  9.3722e-02],
         [ 7.0509e-02, -2.0527e-01],
         [ 7.4457e-02, -2.1701e-01],
         [ 1.0869e-01, -2.1486e-01],
         [ 1.3879e-01, -2.0481e-01],
         [ 1.6416e-01, -1.6333e-01],
         [ 1.7761e-01, -1.4853e-01],
         [ 1.7199e-01, -3.1680e-03],
         [ 1.8096e-01,  3.0600e-02],
         [ 1.9578e-01,  4.5776e-02],
         [ 1.8672e-01,  5.2215e-02],
         [ 2.0169e-01,  5.4716e-02],
         [ 2.0767e-01,  5.5529e-02],
         [ 1.6171e-01,  5.5666e-02],
         [ 1.9383e-01,  5.5585e-02],
         [ 1.8742e-01,  5.5473e-02],
         [ 1.4716e-01,  5.5392e-02],
         [ 1.3056e-01,  5.5314e-02],
         [ 1.5688e-01,  5.5237e-02],
         [ 1.7954e-01,  5.5227e-02],
         [ 1.3839e-01,  5.5213e-02],
         [ 1.7126e-01,  5.5235e-02],
         [ 1.2922e-01,  5.5220e-02],
         [ 1.3455e-02,  5.5202e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.2300e-02,  8.8635e-02],
         [ 1.0709e-01,  9.9402e-02],
         [ 1.0929e-01,  1.1664e-01],
         [ 1.1707e-01,  1.4906e-01],
         [ 1.2279e-01,  1.5190e-01],
         [ 9.8224e-02,  1.1788e-01],
         [ 9.0415e-02,  1.1747e-01],
         [ 1.1010e-01, -9.5070e-02],
         [ 1.0275e-01, -7.5380e-02],
         [ 1.1137e-01, -6.3207e-02],
         [ 1.1450e-01,  8.5916e-02],
         [-2.6783e-02,  8.5467e-02],
         [ 1.0226e-01,  1.1707e-01],
         [ 1.2004e-01,  1.3088e-01],
         [ 1.1997e-01,  8.9258e-02],
         [ 1.2702e-01,  1.0430e-01],
         [ 1.0899e-01,  8.6519e-02],
         [ 1.0240e-01,  1.2646e-01],
         [ 1.0996e-01,  1.3615e-01],
         [ 1.1185e-01,  1.4356e-01],
         [ 1.2247e-01,  1.2033e-01],
         [ 1.2840e-01,  9.6356e-02],
         [ 1.2090e-01,  1.0689e-01],
         [ 9.7435e-02,  1.1374e-01],
         [ 1.2041e-01,  1.1817e-01],
         [ 1.1333e-01,  1.0346e-01],
         [ 1.1270e-01,  9.2009e-02],
         [ 1.3086e-01,  1.1294e-01],
         [ 1.3902e-01,  1.1477e-01],
         [ 1.2469e-01,  8.2680e-02],
         [ 1.1915e-01, -7.6878e-02],
         [ 1.1927e-01, -6.6109e-02],
         [ 1.1176e-01, -5.7405e-02],
         [ 1.2861e-01,  8.1180e-02],
         [ 1.3395e-01,  1.1226e-01],
         [ 1.4656e-01,  1.0098e-01],
         [ 1.4738e-01,  1.2232e-01],
         [ 1.3493e-01,  1.3158e-01],
         [ 9.9820e-02,  1.1388e-01],
         [ 9.7208e-02,  1.2943e-01],
         [ 8.8163e-02,  1.4022e-01],
         [ 1.0250e-01,  1.4787e-01],
         [ 7.1497e-02,  1.2195e-01],
         [ 9.1572e-02,  1.4120e-01],
         [ 1.0760e-01,  1.0981e-01],
         [ 9.7120e-02,  1.2752e-01],
         [ 1.1733e-01,  9.8038e-02],
         [ 1.1415e-01,  1.2168e-01],
         [ 1.1194e-01,  1.3593e-01],
         [ 1.2551e-01,  1.2816e-01],
         [ 1.3092e-01,  1.0309e-01],
         [ 1.3263e-01,  1.2196e-01],
         [ 1.3071e-01,  1.1071e-01],
         [ 1.1640e-01,  9.5609e-02],
         [ 1.1093e-01,  8.8856e-02],
         [ 1.2401e-01,  1.2196e-01],
         [ 1.0169e-01,  1.3879e-01],
         [ 1.1193e-01,  1.5026e-01],
         [ 1.1108e-01,  1.4903e-01],
         [ 1.1977e-01,  1.1366e-01],
         [ 1.3219e-01,  1.3963e-01],
         [ 1.1138e-01,  1.1566e-01],
         [ 1.2885e-01,  1.4543e-01],
         [ 1.2644e-01,  1.1881e-01],
         [ 1.3949e-01,  1.4211e-01],
         [ 1.4276e-01,  1.4916e-01],
         [ 1.4168e-01,  1.4817e-01],
         [ 1.1640e-01,  1.0859e-01],
         [ 1.4400e-01,  1.2352e-01],
         [ 1.2612e-01,  1.3480e-01],
         [ 1.2655e-01,  1.1539e-01],
         [ 1.4689e-01,  8.5303e-02],
         [ 1.4433e-01,  1.1715e-01],
         [ 1.5643e-01,  1.3132e-01],
         [ 1.3460e-01,  8.9971e-02],
         [ 1.5093e-01,  8.7945e-02],
         [ 1.6464e-01,  1.1095e-01],
         [ 1.6342e-01,  7.6047e-02],
         [ 2.4488e-03, -6.0971e-02],
         [ 2.3410e-02, -3.7074e-02],
         [ 3.6787e-02, -3.5789e-02],
         [ 4.3993e-02, -1.5429e-02],
         [ 4.7565e-02, -2.6782e-02],
         [ 4.9168e-02, -2.0664e-02],
         [ 4.9817e-02, -2.7034e-02],
         [ 5.0045e-02, -1.9710e-02],
         [ 5.0112e-02, -2.6331e-02],
         [ 5.0088e-02,  8.5826e-02],
         [ 5.0075e-02, -5.1540e-02],
         [ 5.0057e-02, -4.7392e-02],
         [ 5.0027e-02,  7.8125e-02],
         [ 5.0040e-02, -5.2743e-02],
         [ 5.0031e-02, -2.2996e-02],
         [ 5.0025e-02, -1.7798e-02],
         [ 5.0022e-02, -4.2187e-02],
         [ 5.0021e-02,  8.8702e-02],
         [ 5.0015e-02,  9.7786e-02],
         [ 5.0012e-02,  6.0236e-02],
         [ 5.0019e-02, -6.1691e-02],
         [ 5.0005e-02, -4.8752e-02],
         [ 5.0006e-02, -2.0558e-02],
         [ 5.0008e-02, -4.5918e-02],
         [ 5.0008e-02, -3.3800e-02],
         [ 5.0008e-02,  8.3104e-02],
         [ 5.0009e-02,  9.4228e-02],
         [ 5.0008e-02,  9.8239e-02],
         [ 5.0008e-02, -1.6848e-02],
         [ 5.0008e-02, -4.4272e-02],
         [ 5.0008e-02, -3.2779e-02],
         [ 5.0008e-02,  8.5381e-02],
         [ 5.0009e-02,  9.3723e-02],
         [ 5.0009e-02,  1.0113e-01],
         [ 5.0009e-02, -6.4674e-02],
         [ 5.0009e-02, -4.6148e-02],
         [ 5.0009e-02, -2.7205e-02],
         [ 5.0009e-02, -4.6880e-02],
         [ 5.0009e-02, -4.9745e-02],
         [ 5.0009e-02, -3.5934e-02],
         [ 5.0009e-02, -1.1604e-02],
         [ 5.0009e-02, -1.5037e-03],
         [ 5.0009e-02, -3.5710e-02],
         [ 5.0009e-02, -3.8721e-02],
         [ 5.0009e-02, -6.1944e-02],
         [ 5.0009e-02, -5.3529e-02],
         [ 5.0009e-02, -5.1740e-02],
         [ 5.0009e-02, -3.6481e-02],
         [ 5.0009e-02, -3.4334e-02],
         [ 5.0009e-02, -1.4424e-02],
         [ 5.0009e-02, -2.6294e-02],
         [ 5.0009e-02, -1.0880e-02],
         [ 5.0009e-02, -2.1796e-03],
         [ 5.0009e-02, -3.5703e-02],
         [ 5.0009e-02,  8.5182e-02],
         [ 5.0009e-02, -5.4805e-02],
         [ 5.0009e-02,  8.2107e-02],
         [ 5.0009e-02,  9.4690e-02],
         [ 5.0009e-02,  5.8548e-02],
         [ 5.0009e-02, -6.1959e-02],
         [ 5.0009e-02,  7.8351e-02],
         [ 5.0009e-02,  9.2915e-02],
         [ 5.0009e-02, -6.6492e-02],
         [ 5.0009e-02,  8.4851e-02],
         [ 5.0009e-02, -5.8931e-02],
         [ 5.0009e-02, -5.5145e-02],
         [ 5.0009e-02, -4.9577e-02],
         [ 5.0009e-02, -5.1569e-02],
         [ 5.0009e-02, -5.9566e-02],
         [ 5.0009e-02, -5.4384e-02],
         [ 5.0009e-02, -4.4343e-02],
         [ 5.0009e-02, -5.7328e-02],
         [ 5.0009e-02,  8.9803e-02],
         [ 5.0009e-02, -5.1495e-02],
         [ 5.0009e-02, -3.1097e-02],
         [ 5.0009e-02, -1.0031e-02],
         [ 5.0009e-02, -1.0247e-02],
         [ 5.0009e-02, -7.9768e-03],
         [ 5.0009e-02, -5.9288e-03],
         [ 5.0009e-02, -3.4743e-02],
         [ 5.0009e-02, -2.7162e-02],
         [ 5.0009e-02, -6.2309e-03],
         [ 5.0009e-02, -3.7196e-02],
         [ 5.0009e-02,  8.8279e-02],
         [ 5.0009e-02, -4.9438e-02],
         [ 5.0009e-02, -4.3943e-02],
         [ 5.0009e-02, -4.7101e-02],
         [ 5.0009e-02, -4.0317e-02],
         [ 5.0009e-02, -2.4805e-02],
         [ 5.0009e-02, -6.2786e-03],
         [ 5.0009e-02, -2.0382e-02],
         [ 5.0009e-02,  8.5649e-02],
         [ 5.0009e-02, -1.2467e-02],
         [ 5.0009e-02, -4.1956e-02],
         [ 5.0009e-02,  8.8902e-02],
         [ 5.0009e-02, -5.0565e-02],
         [ 5.0009e-02,  8.5305e-02],
         [ 5.0009e-02,  9.6662e-02],
         [ 5.0009e-02,  1.0111e-01],
         [ 5.0009e-02,  1.0525e-01],
         [ 5.0009e-02,  1.2110e-01],
         [ 5.0009e-02,  1.1905e-01],
         [ 5.0009e-02,  8.1493e-02],
         [ 5.0009e-02,  5.4724e-02],
         [ 5.0009e-02,  8.5680e-02],
         [ 5.0009e-02,  9.8182e-02],
         [ 5.0009e-02,  7.0510e-02],
         [ 5.0009e-02,  9.8478e-02],
         [ 5.0009e-02,  6.5444e-02],
         [ 5.0009e-02,  7.1292e-02],
         [ 5.0009e-02,  8.0597e-02],
         [ 5.0009e-02,  7.6084e-02],
         [ 5.0009e-02,  7.0666e-02],
         [ 5.0009e-02,  8.5560e-02],
         [ 5.0009e-02,  8.5482e-02],
         [ 5.0009e-02,  8.8488e-02],
         [ 5.0009e-02,  5.7154e-02],
         [ 5.0009e-02, -1.9640e-01],
         [ 5.0009e-02,  6.8469e-02],
         [ 5.0009e-02, -1.6561e-01],
         [ 5.0009e-02, -1.5109e-01],
         [ 5.0009e-02, -1.4069e-01],
         [ 5.0009e-02,  8.5720e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.1772e-05, device='cuda:0') tensor(0.0012, device='cuda:0') tensor(-0.0015, device='cuda:0')
mixer_td_error tensor(0.9232, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4676, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8375, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0527, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1964, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0890, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3706467., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2100, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.2298e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0013, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1921, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2836, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1921, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5297
target_mac_out tensor([[[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5616e-02,  9.4210e-02,  ...,  7.3878e-03,
            1.5537e-01, -1.0000e+07],
          [-1.0000e+07, -2.6778e-02,  1.1172e-01,  ...,  1.0212e-02,
            1.4563e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6670e-02,  6.7967e-02,  ...,  1.6771e-02,
            1.4736e-01, -1.0000e+07],
          [-1.0000e+07, -4.0458e-02,  1.4132e-01,  ...,  2.4393e-02,
            1.5301e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.5332e-02,  1.0633e-01,  ...,  1.1655e-02,
            1.4391e-01, -1.0000e+07],
          [-1.0000e+07, -2.6454e-02,  8.1447e-02,  ..., -2.4863e-04,
            1.4016e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0588e-01,  1.2326e-01,  ...,  4.2593e-02,
            1.5787e-01, -1.0000e+07],
          [-1.0000e+07, -2.5205e-02,  9.5811e-02,  ...,  2.0416e-02,
            1.3987e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.8762e-01,  9.8021e-02,  ...,  5.0257e-02,
            1.6085e-01, -3.1810e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.2009e-01,  1.1096e-01,  ...,  7.4524e-02,
            1.9348e-01, -3.3262e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 4.1767e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.2334e-02,  1.2843e-01],
         [ 9.4210e-02,  1.1172e-01],
         [ 6.7967e-02,  1.4132e-01],
         [ 9.4476e-02,  1.5350e-01],
         [ 9.6950e-02,  1.5582e-01],
         [ 1.1263e-01,  1.2656e-01],
         [ 8.6617e-02,  1.0403e-01],
         [ 9.3209e-02,  9.1718e-02],
         [ 9.6887e-02,  7.9109e-02],
         [ 1.2725e-01, -4.0279e-02],
         [ 1.3948e-01,  1.0046e-01],
         [ 1.3956e-01,  1.2324e-01],
         [ 1.0675e-01,  1.5398e-01],
         [ 1.2642e-01,  1.0202e-01],
         [ 1.3666e-01,  1.0467e-01],
         [ 1.3114e-01,  1.1772e-01],
         [ 1.4585e-01,  9.2078e-02],
         [ 1.5430e-01,  1.2583e-01],
         [ 1.4894e-01,  1.2902e-01],
         [ 1.6615e-01,  1.0315e-01],
         [ 1.6668e-01,  9.1633e-02],
         [ 1.7680e-01,  8.6050e-02],
         [ 1.5964e-01, -7.2269e-02],
         [ 1.4176e-01,  7.8185e-02],
         [ 1.4823e-01,  8.8306e-02],
         [ 1.4364e-01,  1.3236e-01],
         [ 1.4081e-01,  1.3988e-01],
         [ 1.7035e-01,  1.3946e-01],
         [ 1.6107e-01,  1.2548e-01],
         [ 1.7370e-01,  1.5120e-01],
         [ 1.4516e-01,  1.4849e-01],
         [ 1.6219e-01,  1.3046e-01],
         [ 1.7123e-01,  1.3859e-01],
         [ 1.3796e-01,  1.2250e-01],
         [ 1.5600e-01,  1.3855e-01],
         [ 1.2844e-01,  1.4882e-01],
         [ 1.5321e-01,  1.1716e-01],
         [-2.6794e-02,  7.1650e-02],
         [ 1.2694e-02, -1.0489e-01],
         [ 3.2720e-02, -7.9862e-02],
         [ 4.2500e-02, -7.5181e-02],
         [ 4.7060e-02,  7.2315e-02],
         [ 4.9041e-02, -7.0234e-02],
         [ 4.9831e-02, -6.3753e-02],
         [ 5.0090e-02,  7.5003e-02],
         [ 5.0148e-02,  9.0500e-02],
         [ 5.0123e-02,  9.9550e-02],
         [ 5.0104e-02, -7.1433e-02],
         [ 5.0055e-02, -4.8114e-02],
         [ 5.0053e-02,  8.4142e-02],
         [ 5.0037e-02, -5.6051e-02],
         [ 5.0035e-02,  8.4584e-02],
         [ 5.0018e-02,  9.6284e-02],
         [ 5.0014e-02,  6.5931e-02],
         [ 5.0027e-02,  9.0036e-02],
         [ 5.0014e-02, -3.3868e-02],
         [ 5.0018e-02,  8.2049e-02],
         [ 5.0012e-02, -1.4853e-02],
         [ 5.0009e-02, -4.3108e-03],
         [ 5.0006e-02,  1.9502e-03],
         [ 5.0008e-02,  5.7588e-03],
         [ 5.0007e-02,  8.0655e-03],
         [ 5.0008e-02, -2.9433e-02],
         [ 5.0008e-02, -3.4398e-02],
         [ 5.0008e-02,  7.9436e-02],
         [ 5.0008e-02,  8.9974e-02],
         [ 5.0008e-02, -6.8031e-02],
         [ 5.0008e-02, -5.7201e-02],
         [ 5.0008e-02,  7.6034e-02],
         [ 5.0008e-02, -6.6755e-02],
         [ 5.0009e-02,  7.8667e-02],
         [ 5.0009e-02,  1.0735e-01],
         [ 5.0009e-02,  8.7148e-02],
         [ 5.0009e-02,  1.0248e-01],
         [ 5.0009e-02,  1.0741e-01],
         [ 5.0009e-02,  7.8701e-02],
         [ 5.0009e-02,  6.3627e-02],
         [ 5.0009e-02,  1.0202e-01],
         [ 5.0009e-02, -1.8157e-01],
         [ 5.0009e-02,  9.1847e-02],
         [ 5.0009e-02,  1.0255e-01],
         [ 5.0009e-02,  7.3281e-02],
         [ 5.0009e-02, -1.8180e-01],
         [ 5.0009e-02,  9.4603e-02],
         [ 5.0009e-02,  1.1070e-01],
         [ 5.0009e-02,  1.0668e-01],
         [ 5.0009e-02, -1.8775e-01],
         [ 5.0009e-02, -1.6965e-01],
         [ 5.0009e-02, -1.6599e-01],
         [ 5.0009e-02, -1.8249e-01],
         [ 5.0009e-02, -1.7278e-01],
         [ 5.0009e-02, -1.8329e-01],
         [ 5.0009e-02, -1.7266e-01],
         [ 5.0009e-02,  5.9990e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.9115e-02,  9.3163e-02],
         [ 1.0633e-01,  8.1447e-02],
         [ 1.2326e-01,  9.5811e-02],
         [ 1.0209e-01,  1.0845e-01],
         [ 1.1345e-01, -1.1568e-02],
         [ 8.6090e-02, -1.8203e-02],
         [ 6.7351e-02,  1.0827e-01],
         [-1.0946e-01,  1.0714e-01],
         [ 6.7471e-02,  1.0828e-01],
         [-9.8912e-02,  1.3123e-01],
         [ 8.5888e-02,  1.2711e-01],
         [ 1.0156e-01,  1.0859e-01],
         [ 1.1046e-01,  1.3448e-01],
         [ 1.4076e-01,  1.1277e-01],
         [ 1.6449e-01,  1.1756e-01],
         [ 1.3111e-01, -5.4333e-02],
         [ 1.6790e-01, -3.6434e-02],
         [ 1.7868e-01,  1.3362e-01],
         [ 1.6904e-01, -4.6221e-02],
         [ 1.4997e-01,  1.2518e-01],
         [ 1.2970e-01,  1.4220e-01],
         [ 1.2449e-01,  1.1878e-01],
         [ 1.0096e-01,  1.1681e-01],
         [ 1.2198e-01,  1.3589e-01],
         [ 1.2483e-01,  1.4656e-01],
         [ 1.2198e-01,  1.1893e-01],
         [ 1.2071e-01,  1.2022e-01],
         [ 1.2143e-01,  1.0214e-01],
         [ 9.9884e-02,  1.3052e-01],
         [ 1.0480e-01,  1.0650e-01],
         [ 1.1209e-01,  1.2812e-01],
         [ 9.6353e-02,  1.4003e-01],
         [ 1.3159e-01,  1.0958e-01],
         [ 1.6149e-01,  1.3708e-01],
         [ 1.7222e-01,  1.2323e-01],
         [ 1.7733e-01,  1.4750e-01],
         [ 1.3807e-01,  1.2516e-01],
         [ 1.6807e-01,  1.1191e-01],
         [ 1.5980e-01,  1.3150e-01],
         [ 1.8409e-01,  1.1224e-01],
         [ 1.4157e-01,  1.3227e-01],
         [ 1.6084e-01,  1.0939e-01],
         [ 1.3497e-01,  1.2870e-01],
         [ 1.5698e-01,  1.3682e-01],
         [ 1.6402e-01,  1.0488e-01],
         [ 1.9035e-01,  7.9802e-02],
         [ 1.9028e-01,  1.0904e-01],
         [ 1.5493e-01,  1.2148e-01],
         [ 1.7353e-01,  1.2630e-01],
         [ 1.5617e-01,  1.5255e-01],
         [ 1.6572e-01,  1.0297e-01],
         [ 1.5983e-01,  1.3527e-01],
         [ 1.4428e-01, -7.2070e-02],
         [ 1.3760e-01,  9.4970e-02],
         [ 1.1936e-01, -4.6027e-02],
         [ 1.1304e-01, -4.7328e-02],
         [ 1.2637e-01,  9.3234e-02],
         [ 1.5770e-01,  1.1154e-01],
         [ 1.8732e-01,  1.2091e-01],
         [ 1.9770e-01, -1.5818e-02],
         [ 2.0187e-01,  1.0678e-01],
         [ 2.0561e-01,  1.1291e-01],
         [ 1.7478e-01,  1.5796e-01],
         [ 1.6317e-01, -3.2892e-02],
         [ 1.2012e-01,  1.2237e-01],
         [ 1.3146e-01, -6.7365e-02],
         [ 1.3350e-01, -7.3172e-02],
         [ 1.5048e-01,  1.2996e-01],
         [ 1.3490e-01,  1.2888e-01],
         [ 1.5841e-01,  1.1021e-01],
         [ 1.8857e-01,  1.4185e-01],
         [ 2.0284e-01,  1.4932e-01],
         [ 1.6203e-01,  1.2447e-01],
         [ 1.4946e-01,  1.5988e-01],
         [ 1.0070e-01,  1.2547e-01],
         [ 1.2451e-01,  1.4325e-01],
         [ 1.4350e-01,  1.5392e-01],
         [ 1.8534e-01,  1.6056e-01],
         [ 1.9915e-01,  1.2467e-01],
         [ 1.5871e-01,  1.6190e-01],
         [ 1.9370e-01,  1.4221e-01],
         [ 2.2276e-01, -1.0761e-01],
         [ 2.3350e-01,  1.2971e-01],
         [ 1.6795e-01,  1.5259e-01],
         [ 1.0717e-01, -1.0909e-01],
         [ 1.4469e-01,  1.4810e-01],
         [ 1.8612e-01, -1.8891e-02],
         [ 1.3314e-01,  2.4529e-02],
         [ 1.1846e-01,  4.3381e-02],
         [ 1.1239e-01,  5.1127e-02],
         [ 1.1311e-01,  5.4137e-02],
         [ 1.1244e-01,  5.5151e-02],
         [ 8.8744e-02,  5.5407e-02],
         [ 1.2640e-01,  5.5408e-02],
         [ 1.2512e-01,  5.5346e-02],
         [ 1.0735e-01,  5.5254e-02],
         [ 8.8420e-02,  5.5222e-02],
         [ 1.3067e-01,  5.5227e-02],
         [ 1.3079e-01,  5.5202e-02],
         [ 1.3111e-01,  5.5215e-02],
         [ 9.9499e-02,  5.5214e-02],
         [ 1.1345e-01,  5.5188e-02],
         [ 8.9446e-02,  5.5206e-02],
         [ 1.1053e-01,  5.5210e-02],
         [ 7.9633e-02,  5.5212e-02],
         [ 7.6857e-02,  5.5219e-02],
         [ 8.3704e-02,  5.5221e-02],
         [ 9.8021e-02,  5.5231e-02],
         [ 1.1096e-01,  5.5230e-02],
         [ 4.1767e-03,  5.5230e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.4939e-05, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0018, device='cuda:0')
mixer_td_error tensor(0.1601, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4654, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5542, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0665, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2101, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0527, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-727272.5625, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2335, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.0972e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1452, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2461, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1452, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5359
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0948e-02,  7.3316e-02,  ...,  4.2360e-02,
            1.4141e-01, -1.0000e+07],
          [-1.0000e+07, -1.8789e-02,  1.1070e-01,  ...,  4.1064e-03,
            1.2950e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0493e-01,  9.5342e-02,  ...,  2.8501e-02,
            1.6248e-01, -1.0000e+07],
          [-1.0000e+07, -2.5057e-02,  1.2023e-01,  ..., -1.0731e-02,
            1.3315e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6264e-01,  7.0128e-02,  ...,  6.8910e-02,
            1.4320e-01, -3.1352e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.4641e-01,  4.9474e-02,  ...,  5.9720e-02,
            1.2513e-01, -1.0000e+07],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.5547e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7413e-02,  9.1951e-02,  ...,  4.7431e-02,
            1.5634e-01, -1.0000e+07],
          [-1.0000e+07, -1.9542e-02,  9.5194e-02,  ...,  4.5180e-03,
            1.4030e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4907e-02,  9.5719e-02,  ...,  2.4923e-02,
            1.5235e-01, -1.0000e+07],
          [-1.0000e+07, -3.7884e-02,  9.5978e-02,  ..., -2.8356e-02,
            1.3624e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 4.2360e-02,  1.1070e-01],
         [ 9.5342e-02,  1.2023e-01],
         [ 2.9640e-02,  1.4156e-01],
         [ 8.1485e-02, -4.0353e-02],
         [-7.6575e-02, -4.8187e-02],
         [ 9.7613e-02,  1.0066e-01],
         [ 7.2808e-02,  9.9181e-02],
         [ 9.0928e-02, -4.0001e-02],
         [ 9.8131e-02, -4.6573e-02],
         [ 7.5187e-02, -6.3116e-02],
         [-8.8738e-02,  8.7967e-02],
         [-7.3215e-02,  1.1220e-01],
         [-5.2229e-02, -9.1545e-02],
         [-6.8613e-02,  1.0364e-01],
         [-7.4374e-02,  1.1695e-01],
         [-5.6511e-02,  7.7338e-02],
         [-4.0418e-02,  1.1185e-01],
         [-5.1149e-02,  1.2157e-01],
         [ 1.0297e-01,  7.8122e-02],
         [-4.2105e-02,  9.8220e-02],
         [-5.2184e-02,  1.1613e-01],
         [ 1.0156e-01,  8.1639e-02],
         [-4.9075e-02,  9.6023e-02],
         [ 9.7458e-02,  1.0995e-01],
         [ 1.0464e-01,  9.8083e-02],
         [ 1.3189e-01, -1.6438e-01],
         [ 1.5355e-01, -1.4232e-01],
         [ 1.3319e-01, -1.2817e-01],
         [ 1.4755e-01, -1.3862e-01],
         [ 1.4394e-01, -1.3374e-01],
         [ 1.1068e-01, -1.1742e-01],
         [ 1.3933e-01, -1.1364e-01],
         [ 1.0936e-01, -1.0852e-01],
         [ 1.4213e-01, -1.1956e-01],
         [ 1.1816e-01, -6.4278e-03],
         [ 1.0565e-01,  2.5142e-02],
         [ 8.6109e-02,  4.2084e-02],
         [-1.5910e-01,  5.0180e-02],
         [ 8.0208e-02,  5.3727e-02],
         [ 1.0120e-01,  5.5128e-02],
         [ 8.3156e-02,  5.5544e-02],
         [ 1.2780e-01,  5.5612e-02],
         [ 9.8728e-02,  5.5523e-02],
         [ 1.1408e-01,  5.5444e-02],
         [ 8.9938e-02,  5.5359e-02],
         [ 9.4646e-02,  5.5309e-02],
         [ 9.5243e-02,  5.5259e-02],
         [ 9.3598e-02,  5.5215e-02],
         [ 8.0578e-02,  5.5232e-02],
         [ 7.5030e-02,  5.5209e-02],
         [ 1.0299e-01,  5.5215e-02],
         [ 8.2706e-02,  5.5215e-02],
         [ 1.1988e-01,  5.5220e-02],
         [ 8.9034e-02,  5.5223e-02],
         [-1.6264e-01,  5.5231e-02],
         [-1.4641e-01,  5.5232e-02],
         [ 1.5547e-02,  5.5230e-02]],

        [[ 5.8068e-02,  1.0699e-01],
         [ 9.1951e-02,  9.5194e-02],
         [ 9.5719e-02,  9.5978e-02],
         [-6.1909e-02,  1.2112e-01],
         [ 1.0181e-01,  1.1712e-01],
         [ 1.2325e-01,  1.0181e-01],
         [ 1.1046e-01,  1.4455e-01],
         [ 1.1896e-01,  1.6088e-01],
         [ 4.2906e-02,  1.3627e-01],
         [ 4.9518e-02,  1.4786e-01],
         [ 5.5583e-02,  1.5513e-01],
         [ 1.3661e-01,  1.0765e-01],
         [ 1.4742e-01,  9.5794e-02],
         [ 1.5836e-01, -1.3350e-01],
         [ 1.5084e-01,  1.2005e-01],
         [ 1.6046e-01, -1.2867e-01],
         [ 1.2381e-01, -1.2440e-01],
         [ 1.4381e-01, -1.1944e-01],
         [ 1.2491e-01,  1.2143e-01],
         [ 1.3591e-01,  1.3413e-01],
         [ 1.5950e-01,  1.0017e-01],
         [ 1.6351e-01,  1.2531e-01],
         [ 1.7499e-01,  9.3300e-02],
         [ 1.7988e-01,  1.1284e-01],
         [ 1.4202e-01,  8.4452e-02],
         [ 1.6703e-01, -1.7602e-01],
         [ 1.1923e-01, -1.7924e-01],
         [ 1.5715e-01,  1.0990e-01],
         [ 1.6606e-01,  1.2561e-01],
         [ 1.4386e-01,  9.4504e-02],
         [ 1.5060e-01, -1.5697e-01],
         [ 1.6097e-01, -1.5013e-01],
         [ 1.2056e-01, -1.4969e-01],
         [ 1.0239e-01, -1.3681e-01],
         [ 1.0432e-01, -1.4035e-01],
         [ 1.2342e-01, -1.2966e-01],
         [ 1.3042e-01, -1.3355e-01],
         [ 9.9325e-02,  2.7572e-03],
         [ 1.0769e-01,  2.8626e-02],
         [ 8.8383e-02,  4.3828e-02],
         [ 7.9083e-02,  5.1240e-02],
         [ 9.5773e-02,  5.4425e-02],
         [ 7.9592e-02,  5.5534e-02],
         [ 1.0483e-01,  5.5772e-02],
         [ 7.1628e-02,  5.5706e-02],
         [-1.4193e-01,  5.5571e-02],
         [ 7.9819e-02,  5.5459e-02],
         [ 8.7825e-02,  5.5338e-02],
         [ 7.8459e-02,  5.5317e-02],
         [ 8.3961e-02,  5.5260e-02],
         [ 8.4669e-02,  5.5226e-02],
         [ 9.8537e-02,  5.5230e-02],
         [ 1.0101e-01,  5.5215e-02],
         [ 1.0315e-02,  5.5217e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(8.0235e-05, device='cuda:0') tensor(0.0024, device='cuda:0') tensor(-0.0025, device='cuda:0')
mixer_td_error tensor(0.1171, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5103, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7164, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0710, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2257, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0372, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-344827.5312, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1799, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0018, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1166, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2582, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1166, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5417
target_mac_out tensor([[[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3382e-02,  7.9674e-02,  ...,  2.9347e-03,
            1.4357e-01, -1.0000e+07],
          [-1.0000e+07, -1.6607e-02,  1.1113e-01,  ...,  2.2597e-03,
            1.2947e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.8440e-02,  5.7460e-02,  ..., -4.9726e-03,
            1.5747e-01, -1.0000e+07],
          [-1.0000e+07, -3.3268e-02,  6.1468e-02,  ...,  2.8033e-02,
            1.5274e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.2218e-01,  1.1603e-01,  ...,  8.8825e-02,
            1.9273e-01, -3.4327e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.9542e-01,  7.0641e-02,  ...,  8.0455e-02,
            1.5643e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.5650e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.3996e-02,  8.6686e-02,  ...,  2.0696e-02,
            1.2691e-01, -1.0000e+07],
          [-1.0000e+07, -1.5667e-02,  8.3441e-02,  ...,  2.3244e-02,
            1.3188e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0102e-02,  1.0732e-01,  ...,  1.1500e-02,
            1.5480e-01, -1.0000e+07],
          [-1.0000e+07, -3.1643e-02,  8.8622e-02,  ..., -1.4512e-02,
            1.3162e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.8261e-02,  9.5030e-02,  ..., -2.3518e-02,
            1.4902e-01, -1.0000e+07],
          [-1.0000e+07, -2.4227e-02,  9.6884e-02,  ...,  9.5930e-03,
            1.3763e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.0205e-02,  9.0702e-02],
         [ 7.9674e-02,  1.1113e-01],
         [-7.8440e-02, -3.3268e-02],
         [-7.7057e-02, -1.7950e-02],
         [-6.2874e-02, -4.4145e-02],
         [-2.6337e-02, -4.9233e-02],
         [ 1.4096e-01, -3.6035e-02],
         [ 1.6714e-01, -3.3940e-02],
         [ 1.2319e-01,  1.1045e-01],
         [-7.1019e-02,  1.3892e-01],
         [ 1.0282e-01,  1.5236e-01],
         [ 8.4418e-02,  1.2944e-01],
         [ 8.6654e-02,  1.2305e-01],
         [ 7.0944e-02,  1.4173e-01],
         [ 8.9887e-02,  1.2287e-01],
         [ 1.5389e-01,  1.3889e-01],
         [ 9.8309e-02,  1.6250e-01],
         [ 1.0943e-01,  1.1874e-01],
         [ 1.0969e-01,  1.0469e-01],
         [ 1.2822e-01,  1.4224e-01],
         [ 1.5813e-01,  1.2451e-01],
         [ 1.7510e-01,  1.1136e-01],
         [ 1.8255e-01,  1.5612e-01],
         [ 1.4230e-01,  1.6958e-01],
         [ 1.4571e-01,  1.6495e-01],
         [ 1.2951e-01,  1.3509e-01],
         [ 1.6287e-01,  1.6685e-01],
         [ 1.7633e-01,  1.6216e-01],
         [ 1.7510e-01,  1.2900e-01],
         [ 1.3645e-01,  1.6227e-01],
         [ 1.6178e-01,  1.2986e-01],
         [ 1.7149e-01,  1.5448e-01],
         [ 1.7263e-01,  1.6642e-01],
         [ 1.2707e-01,  1.2379e-01],
         [ 1.2787e-01,  1.6267e-01],
         [ 1.6779e-01,  1.7743e-01],
         [ 1.8064e-01,  1.0716e-01],
         [-2.4356e-02, -1.6725e-01],
         [ 6.1634e-03,  7.6674e-02],
         [ 1.6477e-01, -1.7398e-01],
         [-5.4611e-02, -1.0783e-01],
         [ 1.1163e-01, -7.5970e-02],
         [ 1.1182e-01,  1.3546e-01],
         [ 1.1236e-01, -6.0575e-02],
         [-1.0674e-01,  9.8160e-02],
         [-1.0268e-01,  1.2087e-01],
         [-1.0011e-01,  1.2477e-01],
         [-9.3815e-02,  1.3221e-01],
         [-7.5629e-02, -5.9705e-02],
         [-7.1071e-02, -5.1505e-02],
         [-7.2209e-02, -6.0972e-02],
         [ 1.0302e-01, -8.4292e-02],
         [ 1.0192e-01, -9.1475e-02],
         [ 9.6997e-02, -2.2417e-02],
         [ 1.0086e-01,  2.0640e-02],
         [-6.7975e-02,  4.0824e-02],
         [-7.1776e-02,  4.9666e-02],
         [-7.8815e-02,  5.3332e-02],
         [ 9.1781e-02,  5.4708e-02],
         [ 9.9900e-02,  5.5190e-02],
         [ 7.8142e-02,  5.5286e-02],
         [-8.7008e-02,  5.5262e-02],
         [-8.8245e-02,  5.5242e-02],
         [-8.6290e-02,  5.5228e-02],
         [-8.5258e-02,  5.5201e-02],
         [-8.3805e-02,  5.5180e-02],
         [-7.9520e-02,  5.5216e-02],
         [-8.0483e-02,  5.5211e-02],
         [ 1.0164e-01,  5.5204e-02],
         [ 9.2112e-02,  5.5218e-02],
         [ 6.2117e-02,  5.5218e-02],
         [ 1.0774e-01,  5.5213e-02],
         [ 1.0443e-01,  5.5222e-02],
         [ 7.0555e-02,  5.5228e-02],
         [ 9.5771e-02,  5.5229e-02],
         [ 9.3458e-02,  5.5233e-02],
         [ 1.0013e-01,  5.5235e-02],
         [ 6.5921e-02,  5.5235e-02],
         [ 6.6639e-02,  5.5232e-02],
         [-8.4019e-02,  5.5231e-02],
         [-7.9693e-02,  5.5231e-02],
         [-6.8065e-02,  5.5231e-02],
         [-6.1724e-02,  5.5231e-02],
         [-5.5030e-02,  5.5231e-02],
         [-6.4980e-02,  5.5231e-02],
         [ 7.8602e-02,  5.5231e-02],
         [ 8.5976e-02,  5.5231e-02],
         [ 9.0356e-02,  5.5231e-02],
         [ 9.2933e-02,  5.5231e-02],
         [ 7.4840e-02,  5.5231e-02],
         [ 9.9034e-02,  5.5231e-02],
         [-7.6966e-02,  5.5231e-02],
         [-6.5290e-02,  5.5231e-02],
         [ 8.9860e-02,  5.5231e-02],
         [ 1.0093e-01,  5.5231e-02],
         [ 9.4762e-02,  5.5231e-02],
         [ 1.0072e-01,  5.5231e-02],
         [ 1.0375e-01,  5.5231e-02],
         [ 1.0612e-01,  5.5231e-02],
         [ 6.9198e-02,  5.5231e-02],
         [ 9.3882e-02,  5.5231e-02],
         [ 1.0288e-01,  5.5231e-02],
         [ 8.3422e-02,  5.5231e-02],
         [ 7.4192e-02,  5.5231e-02],
         [ 1.0755e-01,  5.5231e-02],
         [ 1.2109e-01,  5.5231e-02],
         [ 9.8501e-02,  5.5231e-02],
         [ 1.0300e-01,  5.5231e-02],
         [ 1.1665e-01,  5.5231e-02],
         [ 8.9919e-02,  5.5231e-02],
         [ 9.9790e-02,  5.5231e-02],
         [ 1.0759e-01,  5.5231e-02],
         [ 9.5090e-02,  5.5231e-02],
         [ 8.8522e-02,  5.5231e-02],
         [ 9.7505e-02,  5.5231e-02],
         [ 5.9807e-02,  5.5231e-02],
         [ 7.9994e-02,  5.5231e-02],
         [ 6.3079e-02,  5.5231e-02],
         [ 7.7705e-02,  5.5231e-02],
         [ 1.1603e-01,  5.5231e-02],
         [ 7.0641e-02,  5.5231e-02],
         [ 1.5650e-02,  5.5231e-02]],

        [[ 8.6686e-02,  8.3441e-02],
         [ 1.0732e-01,  8.8622e-02],
         [ 9.5030e-02,  9.6884e-02],
         [ 1.2098e-01,  1.3290e-01],
         [ 1.2325e-01,  1.4126e-01],
         [ 1.3365e-01,  1.3064e-01],
         [ 1.4022e-01, -3.2706e-02],
         [ 8.5622e-02, -1.9489e-02],
         [ 9.6917e-02, -1.0321e-02],
         [ 1.0856e-01, -2.2892e-02],
         [ 9.9795e-02, -2.0675e-02],
         [ 1.1006e-01,  8.7953e-02],
         [ 1.3601e-01,  1.2731e-01],
         [ 9.5884e-02, -5.2785e-02],
         [ 1.2038e-01,  1.2276e-01],
         [ 1.3498e-01,  1.0872e-01],
         [ 9.6684e-02,  1.0434e-01],
         [ 1.1369e-01,  6.8297e-02],
         [ 1.3817e-01,  8.7432e-02],
         [ 1.3556e-01, -3.1101e-02],
         [ 1.2402e-01, -2.3534e-02],
         [ 1.2632e-01, -1.5724e-02],
         [ 1.1690e-01, -1.0194e-02],
         [ 8.4363e-02, -1.9883e-02],
         [ 8.4303e-03, -1.5697e-02],
         [ 3.1519e-02, -4.1235e-02],
         [ 4.2588e-02, -4.6850e-02],
         [ 4.7443e-02, -5.0045e-02],
         [ 4.9336e-02, -3.6502e-02],
         [ 4.9961e-02,  7.3386e-02],
         [ 5.0090e-02, -2.3212e-03],
         [ 5.0054e-02,  9.2937e-02],
         [ 5.0036e-02, -1.5449e-02],
         [ 5.0000e-02,  1.4018e-01],
         [ 4.9993e-02,  3.9920e-04],
         [ 4.9970e-02, -2.1061e-02],
         [ 4.9987e-02,  4.3721e-03],
         [ 4.9984e-02,  9.9312e-02],
         [ 4.9993e-02,  1.1230e-01],
         [ 4.9993e-02,  5.8323e-03],
         [ 5.0012e-02, -1.6027e-02],
         [ 5.0012e-02,  9.4911e-02],
         [ 5.0015e-02,  9.5328e-02],
         [ 5.0018e-02, -5.4035e-02],
         [ 5.0019e-02, -4.9193e-02],
         [ 5.0005e-02, -4.0339e-02],
         [ 5.0007e-02, -1.5238e-02],
         [ 5.0007e-02, -2.5409e-02],
         [ 5.0007e-02,  8.8238e-02],
         [ 5.0008e-02, -2.3467e-02],
         [ 5.0008e-02, -4.5565e-02],
         [ 5.0008e-02,  8.9465e-02],
         [ 5.0008e-02, -5.1566e-02],
         [ 5.0008e-02, -4.4974e-02],
         [ 5.0008e-02,  8.2831e-02],
         [ 5.0008e-02, -6.6786e-02],
         [ 5.0009e-02, -4.8204e-02],
         [ 5.0009e-02, -1.9561e-02],
         [ 5.0009e-02, -4.5440e-02],
         [ 5.0009e-02, -4.9571e-02],
         [ 5.0009e-02, -3.5815e-02],
         [ 5.0009e-02, -1.1379e-02],
         [ 5.0009e-02, -1.0583e-02],
         [ 5.0009e-02, -2.0972e-02],
         [ 5.0009e-02, -6.9179e-03],
         [ 5.0009e-02, -2.1775e-02],
         [ 5.0009e-02, -1.7640e-02],
         [ 5.0009e-02, -3.0858e-03],
         [ 5.0009e-02, -6.1574e-03],
         [ 5.0009e-02, -3.5186e-02],
         [ 5.0009e-02, -2.6952e-02],
         [ 5.0009e-02,  6.8774e-03],
         [ 5.0009e-02,  9.1072e-02],
         [ 5.0009e-02, -3.3925e-02],
         [ 5.0009e-02,  8.3212e-02],
         [ 5.0009e-02,  1.1073e-01],
         [ 5.0009e-02,  1.2140e-01],
         [ 5.0009e-02,  7.8195e-02],
         [ 5.0009e-02,  1.0376e-01],
         [ 5.0009e-02,  1.1356e-01],
         [ 5.0009e-02,  1.2192e-01],
         [ 5.0009e-02, -1.3856e-01],
         [ 5.0009e-02,  1.0959e-01],
         [ 5.0009e-02, -1.1723e-01],
         [ 5.0009e-02, -1.2737e-01],
         [ 5.0009e-02, -1.4417e-01],
         [ 5.0009e-02,  9.9541e-02],
         [ 5.0009e-02,  1.0060e-01],
         [ 5.0009e-02,  9.5356e-02],
         [ 5.0009e-02,  8.7053e-02],
         [ 5.0009e-02, -1.7908e-01],
         [ 5.0009e-02,  8.5383e-02],
         [ 5.0009e-02,  8.8820e-02],
         [ 5.0009e-02, -1.7468e-01],
         [ 5.0009e-02, -1.8408e-01],
         [ 5.0009e-02, -1.9011e-01],
         [ 5.0009e-02,  1.1967e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.5415e-05, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0012, device='cuda:0')
mixer_td_error tensor(0.2425, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4639, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4580, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0553, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1717, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0582, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1024590., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1825, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.4455e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1441, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2294, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1441, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5469
target_mac_out tensor([[[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.5332e-02,  1.0633e-01,  ...,  1.1655e-02,
            1.4391e-01, -1.0000e+07],
          [-1.0000e+07, -2.6454e-02,  8.1447e-02,  ..., -2.4863e-04,
            1.4016e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0588e-01,  1.2326e-01,  ...,  4.2593e-02,
            1.5787e-01, -1.0000e+07],
          [-1.0000e+07, -2.5205e-02,  9.5811e-02,  ...,  2.0416e-02,
            1.3987e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6527e-02,  7.9265e-02,  ...,  4.2534e-02,
            1.3764e-01, -1.0000e+07],
          [-1.0000e+07, -3.4160e-02,  1.2734e-01,  ...,  3.6650e-02,
            1.4514e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7552e-02,  6.9527e-02,  ...,  3.6922e-02,
            1.3246e-01, -1.0000e+07],
          [-1.0000e+07, -6.9459e-02,  1.5722e-01,  ...,  6.3242e-02,
            1.5510e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4887e-01,  4.9958e-02,  ...,  3.2413e-02,
            1.7518e-01, -3.0026e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6329e-01,  7.7314e-02,  ...,  6.4431e-02,
            1.9656e-01, -3.1323e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-8.6026e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.9115e-02,  9.3163e-02],
         [ 1.0633e-01, -2.6454e-02],
         [ 1.2326e-01,  9.5811e-02],
         [ 1.0209e-01, -1.2618e-02],
         [ 1.1345e-01, -1.1568e-02],
         [ 8.6090e-02, -1.8203e-02],
         [-1.2740e-01,  1.0827e-01],
         [-1.0946e-01,  1.0714e-01],
         [-1.1002e-01,  1.0828e-01],
         [-9.8912e-02,  1.3123e-01],
         [ 8.5888e-02,  1.2711e-01],
         [ 1.0156e-01,  1.0859e-01],
         [ 1.1046e-01,  1.3448e-01],
         [ 1.4076e-01,  1.1277e-01],
         [ 1.6449e-01,  1.1756e-01],
         [ 1.3111e-01, -5.4333e-02],
         [ 1.6790e-01, -3.6434e-02],
         [ 1.7868e-01,  1.3362e-01],
         [ 1.6904e-01, -4.6221e-02],
         [ 1.4997e-01,  1.2518e-01],
         [ 1.2970e-01,  1.4220e-01],
         [ 1.2449e-01,  1.1878e-01],
         [ 1.0096e-01, -1.1357e-02],
         [ 1.2198e-01,  1.3589e-01],
         [ 1.2483e-01,  1.4656e-01],
         [ 1.2198e-01,  1.1893e-01],
         [ 1.2071e-01,  1.2022e-01],
         [ 1.2143e-01,  1.0214e-01],
         [ 9.9884e-02,  1.3052e-01],
         [ 1.0480e-01,  1.0650e-01],
         [ 1.1209e-01,  1.2812e-01],
         [ 9.6353e-02,  1.4003e-01],
         [ 1.3159e-01,  1.0958e-01],
         [ 1.6149e-01,  1.3708e-01],
         [ 1.7222e-01,  1.2323e-01],
         [ 1.7733e-01,  1.4750e-01],
         [ 1.3807e-01,  1.2516e-01],
         [ 1.6807e-01,  1.1191e-01],
         [ 1.5980e-01,  1.3150e-01],
         [ 1.8409e-01,  1.1224e-01],
         [ 1.4157e-01,  1.3227e-01],
         [ 1.6084e-01,  1.0939e-01],
         [ 1.3497e-01,  1.2870e-01],
         [ 1.5698e-01,  1.3682e-01],
         [ 1.6402e-01,  1.0488e-01],
         [ 1.9035e-01, -4.2245e-02],
         [ 1.9028e-01,  1.0904e-01],
         [ 1.5493e-01,  1.2148e-01],
         [ 1.7353e-01,  1.2630e-01],
         [ 1.5617e-01,  1.5255e-01],
         [ 1.6572e-01, -7.5030e-02],
         [ 1.5983e-01,  1.3527e-01],
         [ 1.4428e-01, -7.2070e-02],
         [ 1.3760e-01, -4.5560e-02],
         [ 1.1936e-01, -4.6027e-02],
         [ 1.1304e-01, -4.7328e-02],
         [ 1.2637e-01, -5.2257e-02],
         [ 1.5770e-01, -2.9274e-02],
         [ 1.8732e-01,  1.5793e-04],
         [ 1.9770e-01, -1.5818e-02],
         [ 2.0187e-01, -4.1912e-02],
         [ 2.0561e-01,  1.1291e-01],
         [ 1.7478e-01,  1.5796e-01],
         [ 1.6317e-01, -3.2892e-02],
         [ 1.2012e-01, -6.4372e-02],
         [ 1.3146e-01, -6.7365e-02],
         [ 1.3350e-01, -7.3172e-02],
         [ 1.5048e-01, -9.7610e-02],
         [ 1.3490e-01, -9.8017e-02],
         [ 1.5841e-01, -1.0675e-01],
         [ 1.8857e-01,  1.4185e-01],
         [ 2.0284e-01,  1.4932e-01],
         [ 1.6203e-01,  1.2447e-01],
         [ 1.4946e-01,  1.5988e-01],
         [ 1.0070e-01, -1.1990e-01],
         [ 1.2451e-01, -1.1437e-01],
         [ 1.4350e-01, -1.2373e-01],
         [ 1.8534e-01,  1.6056e-01],
         [ 1.9915e-01, -1.1975e-01],
         [ 1.5871e-01,  1.6190e-01],
         [ 1.9370e-01, -1.1433e-01],
         [ 2.2276e-01, -1.0761e-01],
         [ 2.3350e-01, -1.0341e-01],
         [ 1.6795e-01,  1.5259e-01],
         [-1.0173e-01, -1.0909e-01],
         [ 1.4469e-01, -1.1416e-01],
         [ 1.8612e-01, -1.8891e-02],
         [-9.6394e-02,  2.4529e-02],
         [-1.2176e-01,  4.3381e-02],
         [-1.4145e-01,  5.1127e-02],
         [ 1.1311e-01,  5.4137e-02],
         [ 1.1244e-01,  5.5151e-02],
         [ 8.8744e-02,  5.5407e-02],
         [ 1.2640e-01,  5.5408e-02],
         [ 1.2512e-01,  5.5346e-02],
         [ 1.0735e-01,  5.5254e-02],
         [ 8.8420e-02,  5.5222e-02],
         [ 1.3067e-01,  5.5227e-02],
         [ 1.3079e-01,  5.5202e-02],
         [ 1.3111e-01,  5.5215e-02],
         [ 9.9499e-02,  5.5214e-02],
         [ 1.1345e-01,  5.5188e-02],
         [ 8.9446e-02,  5.5206e-02],
         [ 1.1053e-01,  5.5210e-02],
         [-2.0390e-01,  5.5212e-02],
         [-2.0036e-01,  5.5219e-02],
         [-1.8150e-01,  5.5221e-02],
         [-1.8762e-01,  5.5231e-02],
         [ 1.1096e-01,  5.5230e-02],
         [ 4.1767e-03,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0780e-01,  8.9914e-02],
         [-7.6527e-02,  1.2734e-01],
         [-6.7552e-02,  1.5722e-01],
         [-7.9998e-02,  1.3407e-01],
         [-8.9205e-02, -4.7719e-02],
         [ 1.1077e-01, -5.3990e-02],
         [ 1.0885e-01, -4.7570e-02],
         [-7.0055e-02,  1.0466e-01],
         [ 1.2187e-01,  9.2092e-02],
         [ 1.2941e-01, -5.0582e-02],
         [ 1.2847e-01,  1.2769e-01],
         [ 1.3701e-01, -9.8820e-02],
         [ 1.1949e-01, -1.1117e-01],
         [ 9.6336e-02, -1.1942e-01],
         [ 1.0414e-01, -9.7406e-02],
         [-4.7995e-02, -9.4385e-02],
         [-4.2335e-02, -8.5589e-02],
         [ 1.2142e-01,  9.3602e-02],
         [ 1.0903e-01,  1.0871e-01],
         [ 1.2760e-01,  8.5809e-02],
         [ 1.3876e-01,  1.0593e-01],
         [ 1.3461e-01,  1.0264e-01],
         [ 1.3718e-01,  1.0112e-01],
         [ 1.4534e-01, -8.3229e-02],
         [ 1.3053e-01, -7.8827e-02],
         [ 1.5854e-01,  8.0270e-02],
         [ 1.6483e-01,  1.0052e-01],
         [ 1.8051e-01,  1.4853e-01],
         [ 1.4739e-01,  1.6411e-01],
         [ 1.6740e-01,  1.5900e-01],
         [ 1.7496e-01,  1.8515e-01],
         [ 1.8802e-01,  1.9385e-01],
         [ 1.8790e-01,  1.4945e-01],
         [ 1.8971e-01,  1.1596e-01],
         [ 1.5564e-01,  1.3987e-01],
         [ 1.7631e-01, -1.2418e-01],
         [ 1.6737e-01,  1.0210e-01],
         [ 1.7581e-01,  1.1055e-01],
         [ 1.9133e-01,  9.9574e-02],
         [ 2.0358e-01, -1.4168e-01],
         [ 1.6890e-01,  1.0010e-01],
         [ 1.9061e-01, -1.5290e-01],
         [ 1.9686e-01, -1.3350e-01],
         [ 1.5919e-01,  9.0457e-02],
         [-1.1981e-01,  1.0169e-01],
         [-1.1430e-01,  1.3351e-01],
         [-6.2971e-03, -1.1240e-01],
         [ 2.3971e-02,  8.9282e-02],
         [ 3.8744e-02, -6.2238e-02],
         [ 4.5555e-02,  1.3037e-01],
         [ 4.8516e-02,  1.4562e-01],
         [ 4.9665e-02, -6.0960e-02],
         [ 5.0048e-02, -4.1698e-02],
         [ 5.0141e-02,  1.3513e-01],
         [ 5.0132e-02,  1.6858e-01],
         [ 5.0067e-02, -6.3315e-02],
         [ 5.0055e-02, -9.9408e-02],
         [ 5.0023e-02, -1.1838e-01],
         [ 5.0024e-02, -1.1157e-01],
         [ 5.0018e-02, -1.1959e-01],
         [ 5.0000e-02, -1.3599e-01],
         [ 5.0017e-02, -1.3071e-01],
         [ 5.0013e-02, -1.1818e-01],
         [ 5.0027e-02, -1.1340e-01],
         [ 5.0017e-02,  7.7275e-02],
         [ 5.0017e-02,  8.6950e-02],
         [ 5.0012e-02,  5.0850e-02],
         [ 5.0009e-02,  4.8595e-02],
         [ 5.0006e-02,  7.8928e-02],
         [ 5.0008e-02, -1.1502e-01],
         [ 5.0007e-02,  8.0987e-02],
         [ 5.0008e-02,  7.5495e-02],
         [ 5.0008e-02,  1.0192e-01],
         [ 5.0008e-02,  1.1354e-01],
         [ 5.0008e-02, -1.4146e-01],
         [ 5.0008e-02, -1.4544e-01],
         [ 5.0008e-02, -1.3784e-01],
         [ 5.0008e-02, -1.2199e-01],
         [ 5.0008e-02,  7.4136e-02],
         [ 5.0009e-02,  5.7429e-02],
         [ 5.0009e-02, -1.1661e-01],
         [ 5.0009e-02,  7.7326e-02],
         [ 5.0009e-02,  8.7918e-02],
         [ 5.0009e-02,  9.2311e-02],
         [ 5.0009e-02,  7.7767e-02],
         [ 5.0009e-02,  1.0283e-01],
         [ 5.0009e-02,  9.8664e-02],
         [ 5.0009e-02, -1.5582e-01],
         [ 5.0009e-02, -1.5815e-01],
         [ 5.0009e-02,  9.6231e-02],
         [ 5.0009e-02,  9.6428e-02],
         [ 5.0009e-02,  1.0940e-01],
         [ 5.0009e-02,  9.9618e-02],
         [ 5.0009e-02, -1.6088e-01],
         [ 5.0009e-02, -1.4374e-01],
         [ 5.0009e-02, -1.4898e-01],
         [ 5.0009e-02, -1.3490e-01],
         [ 5.0009e-02, -1.2238e-01],
         [ 5.0009e-02,  6.8596e-02],
         [ 5.0009e-02, -1.2425e-01],
         [ 5.0009e-02, -1.1895e-01],
         [ 5.0009e-02, -1.1868e-01],
         [ 5.0009e-02, -1.1464e-01],
         [ 5.0009e-02, -1.1565e-01],
         [ 5.0009e-02, -1.1008e-01],
         [ 5.0009e-02, -9.6754e-02],
         [ 5.0009e-02, -7.3389e-02],
         [ 5.0009e-02, -7.8106e-02],
         [ 5.0009e-02, -7.5235e-02],
         [ 5.0009e-02, -7.7414e-02],
         [ 5.0009e-02, -4.0796e-02],
         [ 5.0009e-02, -4.5881e-02],
         [ 5.0009e-02, -6.4675e-02],
         [ 5.0009e-02,  6.7291e-02],
         [ 5.0009e-02,  7.5200e-02],
         [ 5.0009e-02, -1.0317e-01],
         [ 5.0009e-02, -8.9556e-02],
         [ 5.0009e-02, -4.2387e-02],
         [ 5.0009e-02, -4.3789e-02],
         [ 5.0009e-02, -2.2137e-02],
         [ 5.0009e-02,  1.0332e-01],
         [ 5.0009e-02, -3.6895e-02],
         [ 5.0009e-02, -7.9451e-02],
         [ 5.0009e-02, -9.1011e-02],
         [ 5.0009e-02, -8.7119e-02],
         [ 5.0009e-02, -8.0948e-02],
         [ 5.0009e-02,  6.9831e-02],
         [ 5.0009e-02, -9.8523e-02],
         [ 5.0009e-02, -9.7874e-02],
         [ 5.0009e-02,  6.1663e-02],
         [ 5.0009e-02,  8.6841e-02],
         [ 5.0009e-02,  9.6118e-02],
         [ 5.0009e-02,  1.0580e-01],
         [ 5.0009e-02, -1.5400e-01],
         [ 5.0009e-02, -1.4740e-01],
         [ 5.0009e-02, -1.5267e-01],
         [ 5.0009e-02, -1.5522e-01],
         [ 5.0009e-02, -1.5498e-01],
         [ 5.0009e-02, -1.4887e-01],
         [ 5.0009e-02, -1.6329e-01],
         [ 5.0009e-02, -8.6026e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-6.1186e-06, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0012, device='cuda:0')
mixer_td_error tensor(0.2698, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4639, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4177, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0656, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2168, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0509, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1099290.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2335, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.4058e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1603, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2517, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1603, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5514
target_mac_out tensor([[[[-1.0000e+07, -3.8669e-02,  6.6123e-02,  ...,  3.1808e-02,
            1.1543e-01, -1.0000e+07],
          [-1.0000e+07, -1.7411e-02,  9.1207e-02,  ..., -1.4688e-02,
            1.2647e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.1289e-02,  9.2718e-02,  ...,  1.9208e-02,
            1.1967e-01, -1.0000e+07],
          [-1.0000e+07, -5.9044e-02,  1.3579e-01,  ...,  3.9523e-02,
            1.5288e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.4152e-02,  9.5388e-02,  ...,  2.5996e-02,
            1.2299e-01, -1.0000e+07],
          [-1.0000e+07, -7.9071e-02,  1.4334e-01,  ...,  3.7160e-02,
            1.5727e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5898e-02,  1.0054e-01,  ...,  4.1830e-02,
            1.6437e-01, -1.0000e+07],
          [-1.0000e+07, -3.7039e-02,  1.0473e-01,  ..., -3.1371e-02,
            1.3582e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.9098e-01,  8.2850e-02,  ...,  9.2807e-02,
            2.2962e-01, -3.3740e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6709e-01,  5.4118e-02,  ...,  5.6809e-02,
            2.0959e-01, -3.2237e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 7.7317e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.6123e-02,  9.1207e-02],
         [ 9.2718e-02,  1.3579e-01],
         [-4.4152e-02,  1.4334e-01],
         [ 1.2585e-01,  1.5485e-01],
         [ 1.3393e-01, -1.0125e-01],
         [ 1.1701e-01, -1.0431e-01],
         [ 1.2987e-01, -1.1112e-01],
         [ 1.3754e-01,  1.5381e-01],
         [ 1.3826e-01,  1.5278e-01],
         [ 1.0270e-01,  1.5996e-01],
         [ 1.0295e-01,  1.5961e-01],
         [ 1.0048e-01,  1.5394e-01],
         [-1.0616e-01,  1.6986e-01],
         [-9.8186e-02,  1.6235e-01],
         [ 1.0899e-01, -1.5109e-01],
         [ 1.1205e-01, -1.5712e-01],
         [ 1.0592e-01, -1.6660e-01],
         [-6.6960e-02, -1.7715e-01],
         [-6.2168e-02, -1.7429e-01],
         [ 1.1529e-01, -1.3398e-01],
         [ 1.2305e-01, -1.1771e-01],
         [ 1.0975e-01, -1.6124e-01],
         [-8.4848e-02,  8.6080e-03],
         [-8.6989e-02,  3.6199e-02],
         [-5.8515e-02,  4.8625e-02],
         [-5.7526e-02,  5.3620e-02],
         [-5.9290e-02,  5.5335e-02],
         [ 1.0687e-01,  5.5706e-02],
         [-7.7208e-02,  5.5662e-02],
         [-8.2617e-02,  5.5490e-02],
         [ 9.4703e-02,  5.5360e-02],
         [-9.2150e-02,  5.5278e-02],
         [-6.3281e-02,  5.5212e-02],
         [-7.4487e-02,  5.5206e-02],
         [ 1.0286e-01,  5.5200e-02],
         [-6.6641e-02,  5.5187e-02],
         [ 9.4241e-02,  5.5197e-02],
         [ 1.0494e-01,  5.5208e-02],
         [-7.4241e-02,  5.5214e-02],
         [-7.7804e-02,  5.5208e-02],
         [ 9.7631e-02,  5.5203e-02],
         [-7.1752e-02,  5.5221e-02],
         [-7.6097e-02,  5.5228e-02],
         [-5.7198e-02,  5.5231e-02],
         [-4.0832e-02,  5.5230e-02],
         [-5.1518e-02,  5.5230e-02],
         [ 1.0075e-01,  5.5231e-02],
         [-4.9671e-02,  5.5236e-02],
         [-4.2908e-02,  5.5235e-02],
         [-5.9292e-02,  5.5232e-02],
         [-4.4181e-02,  5.5232e-02],
         [-5.2230e-02,  5.5231e-02],
         [-3.8075e-02,  5.5231e-02],
         [-3.3059e-02,  5.5231e-02],
         [-4.2769e-02,  5.5231e-02],
         [-5.1346e-02,  5.5231e-02],
         [ 1.0162e-01,  5.5231e-02],
         [-7.1413e-02,  5.5231e-02],
         [ 9.4476e-02,  5.5231e-02],
         [ 9.9660e-02,  5.5231e-02],
         [-9.8350e-02,  5.5231e-02],
         [ 9.5261e-02,  5.5231e-02],
         [-1.0307e-01,  5.5231e-02],
         [ 9.6023e-02,  5.5231e-02],
         [-9.8127e-02,  5.5231e-02],
         [-9.8093e-02,  5.5231e-02],
         [ 7.7410e-02,  5.5231e-02],
         [ 8.2035e-02,  5.5231e-02],
         [ 8.4582e-02,  5.5231e-02],
         [ 8.3171e-02,  5.5231e-02],
         [ 8.8774e-02,  5.5231e-02],
         [ 8.7355e-02,  5.5231e-02],
         [-7.6676e-02,  5.5231e-02],
         [-8.2960e-02,  5.5231e-02],
         [-1.0788e-01,  5.5231e-02],
         [ 1.1131e-01,  5.5231e-02],
         [ 1.2265e-01,  5.5231e-02],
         [ 8.9693e-02,  5.5231e-02],
         [ 9.9607e-02,  5.5231e-02],
         [ 1.0440e-01,  5.5231e-02],
         [ 1.0796e-01,  5.5231e-02],
         [ 1.1004e-01,  5.5231e-02],
         [ 1.1186e-01,  5.5231e-02],
         [ 1.1021e-01,  5.5231e-02],
         [ 1.1182e-01,  5.5231e-02],
         [ 9.4842e-02,  5.5231e-02],
         [ 8.5851e-02,  5.5231e-02],
         [ 7.5708e-02,  5.5231e-02],
         [ 9.5999e-02,  5.5231e-02],
         [ 8.1700e-02,  5.5231e-02],
         [ 4.7708e-02,  5.5231e-02],
         [ 7.9249e-02,  5.5231e-02],
         [ 9.0015e-02,  5.5231e-02],
         [ 2.3140e-01,  5.5231e-02],
         [ 2.2502e-01,  5.5231e-02],
         [-2.5833e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.6186e-02,  8.7099e-02],
         [-6.7838e-02, -1.4399e-02],
         [ 1.0054e-01,  1.0473e-01],
         [-7.0085e-02,  1.2846e-01],
         [-7.7645e-02,  1.2174e-01],
         [-7.2394e-02,  9.8736e-02],
         [ 1.1932e-01,  8.6049e-02],
         [-5.3548e-02,  8.5364e-02],
         [ 1.2353e-01,  1.1663e-01],
         [ 1.3797e-01,  1.0732e-01],
         [-7.3692e-02,  1.3067e-01],
         [-5.6930e-02,  1.0504e-01],
         [-4.0191e-02,  8.6715e-02],
         [-2.6975e-02,  1.0996e-01],
         [ 1.3455e-01, -1.8133e-02],
         [ 1.4066e-01,  1.0717e-01],
         [ 1.3162e-01,  1.0793e-01],
         [ 1.3845e-01, -6.6556e-02],
         [ 1.4298e-01, -6.2646e-02],
         [-3.3808e-02,  1.0184e-01],
         [ 1.3219e-01, -6.2139e-02],
         [ 1.4796e-01, -6.5015e-02],
         [ 1.2216e-01, -1.7075e-02],
         [ 1.1143e-01,  1.2334e-01],
         [ 1.2215e-01,  1.5181e-01],
         [ 1.4332e-01,  1.6300e-01],
         [ 1.2056e-01,  1.1553e-01],
         [-4.9790e-02,  1.0135e-01],
         [-5.9718e-02,  1.0145e-01],
         [ 1.0317e-01, -6.5109e-02],
         [ 1.0319e-01,  8.5217e-02],
         [ 1.0485e-01, -5.9176e-02],
         [ 1.0517e-01,  8.6492e-02],
         [ 1.3033e-01,  1.2265e-01],
         [-8.0862e-02,  1.0710e-01],
         [ 1.2240e-01,  1.0243e-01],
         [-5.5779e-02,  9.6051e-02],
         [ 1.3477e-01, -7.9570e-02],
         [ 1.0187e-01, -7.9416e-02],
         [ 1.2417e-01, -7.3383e-02],
         [ 1.5434e-01, -9.3775e-02],
         [ 1.0743e-01, -3.1132e-02],
         [ 1.0294e-01, -5.0785e-02],
         [ 1.1113e-01, -7.4617e-02],
         [ 1.2676e-01, -8.1379e-02],
         [ 1.6209e-01, -7.3483e-02],
         [ 1.5323e-01,  9.5454e-02],
         [ 1.6167e-01,  7.7789e-02],
         [ 1.6836e-01,  1.0884e-01],
         [ 1.3134e-01,  1.0926e-01],
         [ 1.5380e-01, -1.0109e-01],
         [ 1.6571e-01,  8.1627e-02],
         [ 1.5162e-01, -1.1236e-01],
         [ 1.4845e-01, -1.0807e-01],
         [ 1.0752e-01,  8.0493e-02],
         [ 1.2681e-01,  1.1036e-01],
         [ 1.4247e-01, -1.2122e-01],
         [ 1.4781e-01, -1.0538e-01],
         [ 1.1204e-01,  1.0972e-01],
         [ 1.4207e-01,  8.1686e-02],
         [ 1.4843e-01, -1.5793e-01],
         [ 1.6215e-01,  7.7008e-02],
         [ 1.7869e-01,  7.3587e-02],
         [ 1.5282e-01,  7.9914e-02],
         [ 1.6030e-01,  1.2369e-01],
         [ 1.6376e-01,  1.2750e-01],
         [ 1.3191e-01,  8.9051e-02],
         [ 1.5730e-01,  8.2708e-02],
         [ 1.4165e-01,  6.2142e-02],
         [ 1.0788e-01,  5.7694e-02],
         [ 1.3217e-01,  7.5260e-02],
         [-1.8161e-01,  7.9808e-02],
         [-1.7108e-01,  1.1031e-01],
         [-1.5483e-01,  9.3386e-02],
         [-1.6252e-01,  8.8485e-02],
         [-1.5549e-01,  6.5543e-02],
         [-1.4815e-01,  1.1065e-01],
         [-1.5092e-01,  9.7337e-02],
         [-2.7880e-02,  9.6369e-02],
         [ 1.1731e-02,  9.7769e-02],
         [ 3.2451e-02,  9.7303e-02],
         [ 4.2652e-02,  9.9711e-02],
         [ 4.7360e-02, -9.8532e-02],
         [ 4.9350e-02, -8.6290e-02],
         [ 5.0077e-02,  7.0882e-02],
         [ 5.0260e-02,  6.9613e-02],
         [ 5.0237e-02, -8.2090e-02],
         [ 5.0194e-02, -8.3019e-02],
         [ 5.0129e-02,  9.1984e-02],
         [ 5.0073e-02,  7.7525e-02],
         [ 5.0050e-02,  9.9920e-02],
         [ 5.0032e-02,  7.0477e-02],
         [ 5.0042e-02,  8.3020e-02],
         [ 5.0034e-02,  9.0730e-02],
         [ 5.0034e-02,  7.9712e-02],
         [ 5.0024e-02, -1.9040e-01],
         [ 5.0012e-02,  9.9623e-02],
         [ 5.0007e-02,  1.1556e-01],
         [ 5.0013e-02,  7.8086e-02],
         [ 5.0005e-02, -1.8662e-01],
         [ 5.0006e-02, -1.7315e-01],
         [ 5.0008e-02, -1.5965e-01],
         [ 5.0008e-02, -1.5086e-01],
         [ 5.0008e-02, -1.7917e-01],
         [ 5.0009e-02, -1.9098e-01],
         [ 5.0008e-02, -1.6709e-01],
         [ 5.0008e-02,  7.7317e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.2770e-05, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0007, device='cuda:0')
mixer_td_error tensor(0.1492, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5013, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3789, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0641, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1898, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0633, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-514018.5625, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2314, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.0877e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1675, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.3038, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1675, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5643
target_mac_out tensor([[[[-1.0000e+07, -3.8669e-02,  6.6123e-02,  ...,  3.1808e-02,
            1.1543e-01, -1.0000e+07],
          [-1.0000e+07, -1.7411e-02,  9.1207e-02,  ..., -1.4688e-02,
            1.2647e-01, -1.0000e+07]],

         [[-1.0000e+07, -3.6332e-02,  8.6041e-02,  ...,  3.6983e-02,
            1.1897e-01, -1.0000e+07],
          [-1.0000e+07, -5.4525e-02,  1.3548e-01,  ...,  3.6722e-02,
            1.5423e-01, -1.0000e+07]],

         [[-1.0000e+07, -3.4270e-02,  1.1046e-01,  ...,  2.4179e-02,
            1.0725e-01, -1.0000e+07],
          [-1.0000e+07, -7.7038e-02,  1.4298e-01,  ...,  3.5555e-02,
            1.5766e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6092e-01,  7.8666e-02,  ...,  5.9505e-02,
            2.0379e-01, -3.1092e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5692e-01,  6.5416e-02,  ...,  4.8571e-02,
            2.0049e-01, -3.1313e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 9.5391e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.8799e-02,  1.1017e-01,  ...,  6.1516e-02,
            1.3971e-01, -1.0000e+07],
          [-1.0000e+07, -2.8322e-02,  1.2490e-01,  ...,  1.4773e-02,
            1.3610e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3357e-02,  7.6576e-02,  ...,  4.4627e-02,
            1.3934e-01, -1.0000e+07],
          [-1.0000e+07, -2.5884e-02,  1.2689e-01,  ..., -4.2544e-03,
            1.3727e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.9090e-02,  5.8755e-02,  ...,  3.9416e-02,
            1.3901e-01, -1.0000e+07],
          [-1.0000e+07, -2.5911e-02,  1.2652e-01,  ..., -1.9137e-02,
            1.3974e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.6123e-02,  9.1207e-02],
         [ 8.6041e-02,  1.3548e-01],
         [-3.4270e-02,  1.4298e-01],
         [ 1.2698e-01,  1.5653e-01],
         [ 1.2722e-01, -1.0582e-01],
         [ 1.0284e-01, -1.0920e-01],
         [ 1.1617e-01, -9.1268e-02],
         [-5.1484e-02, -8.4747e-02],
         [ 1.2559e-01,  1.2101e-01],
         [ 1.2568e-01,  1.2656e-01],
         [ 1.2537e-01,  1.1921e-01],
         [ 1.3350e-01,  1.2405e-01],
         [ 1.0208e-01,  1.2959e-01],
         [ 1.1755e-01,  1.3057e-01],
         [ 1.2910e-01, -7.3136e-02],
         [ 1.1296e-01,  1.2090e-01],
         [-4.2008e-02,  1.2335e-01],
         [ 1.2788e-01, -6.7770e-02],
         [ 1.1064e-01, -5.6879e-02],
         [ 1.2492e-01,  1.1964e-01],
         [ 1.2889e-01,  1.0650e-01],
         [ 1.1000e-01,  1.0232e-01],
         [ 1.3118e-01,  1.2461e-01],
         [-9.1112e-02,  1.3246e-01],
         [-8.4005e-02,  1.1842e-01],
         [-8.3857e-02,  1.2826e-01],
         [ 1.0653e-01,  1.0903e-01],
         [-8.4395e-02,  1.0472e-01],
         [-7.0986e-02,  8.8159e-02],
         [ 1.2866e-01,  8.1419e-02],
         [ 1.2174e-01,  7.8715e-02],
         [ 1.2994e-01,  1.0425e-01],
         [ 1.3392e-01,  8.5958e-02],
         [ 1.2424e-01,  1.1188e-01],
         [ 1.3495e-01,  9.3247e-02],
         [-4.1606e-02, -5.8223e-02],
         [ 1.1406e-01,  9.8695e-02],
         [ 1.3699e-01, -7.8718e-02],
         [ 1.5107e-01, -8.4394e-02],
         [ 1.6075e-01, -9.1859e-02],
         [ 1.4192e-01, -1.0066e-01],
         [ 1.5468e-01,  8.9067e-02],
         [ 1.5846e-01, -7.3938e-02],
         [ 1.5814e-01, -7.6360e-02],
         [ 1.5908e-01, -7.6726e-02],
         [ 1.6935e-01,  8.7575e-02],
         [ 1.7438e-01,  1.3092e-01],
         [ 1.8352e-01,  1.0878e-01],
         [ 1.4954e-01, -1.3650e-01],
         [ 1.5311e-01, -1.2989e-01],
         [ 1.6112e-01, -1.4118e-01],
         [ 1.8539e-01, -1.4531e-01],
         [ 1.8357e-01,  1.0719e-01],
         [ 1.4757e-01,  1.1998e-01],
         [ 1.5930e-01,  1.4591e-01],
         [ 1.7150e-01,  1.0105e-01],
         [ 1.8308e-01, -1.6221e-01],
         [ 1.8704e-01, -1.7081e-01],
         [ 1.8790e-01,  9.7630e-02],
         [ 1.9565e-01, -1.5655e-01],
         [ 1.6214e-01, -1.1581e-01],
         [ 1.4794e-01, -1.0475e-01],
         [ 9.4649e-02, -8.0603e-02],
         [ 1.0977e-01, -5.3263e-02],
         [-2.1748e-01, -3.1039e-02],
         [ 1.1262e-01, -9.8549e-03],
         [-2.4894e-02, -8.5131e-04],
         [ 1.4789e-02,  3.6392e-03],
         [ 3.4447e-02, -3.0448e-03],
         [ 4.3734e-02, -3.3605e-02],
         [ 4.7862e-02, -4.1717e-02],
         [ 4.9545e-02, -3.0876e-02],
         [ 5.0122e-02, -4.7817e-02],
         [ 5.0247e-02,  8.9562e-02],
         [ 5.0202e-02, -5.3723e-02],
         [ 5.0140e-02, -5.2899e-02],
         [ 5.0083e-02, -7.3512e-02],
         [ 5.0048e-02, -6.4785e-02],
         [ 5.0020e-02,  8.3601e-02],
         [ 5.0017e-02, -6.9661e-02],
         [ 5.0024e-02,  8.4472e-02],
         [ 5.0007e-02,  9.4901e-02],
         [ 5.0018e-02, -8.1351e-02],
         [ 5.0020e-02, -7.2366e-02],
         [ 5.0016e-02,  9.4092e-02],
         [ 5.0008e-02, -8.7241e-02],
         [ 5.0016e-02, -6.9120e-02],
         [ 5.0007e-02, -6.1590e-02],
         [ 5.0007e-02, -5.3466e-02],
         [ 5.0007e-02, -5.9105e-02],
         [ 5.0008e-02, -7.4131e-02],
         [ 5.0008e-02, -5.4860e-02],
         [ 5.0008e-02, -2.4403e-02],
         [ 5.0008e-02, -4.8593e-02],
         [ 5.0008e-02,  9.1933e-02],
         [ 5.0008e-02,  9.9468e-02],
         [ 5.0008e-02,  1.0142e-01],
         [ 5.0008e-02, -7.5186e-02],
         [ 5.0009e-02,  8.6758e-02],
         [ 5.0009e-02,  1.1536e-01],
         [ 5.0009e-02,  1.2429e-01],
         [ 5.0009e-02,  1.3347e-01],
         [ 5.0009e-02,  1.2516e-01],
         [ 5.0009e-02, -1.7084e-01],
         [ 5.0009e-02, -1.5267e-01],
         [ 5.0009e-02,  8.1064e-02],
         [ 5.0009e-02,  5.9618e-02],
         [ 5.0009e-02,  7.9431e-02],
         [ 5.0009e-02,  8.8114e-02],
         [ 5.0009e-02,  8.1428e-02],
         [ 5.0009e-02,  7.4711e-02],
         [ 5.0009e-02,  8.8588e-02],
         [ 5.0009e-02,  1.0442e-01],
         [ 5.0009e-02, -2.0150e-01],
         [ 5.0009e-02, -1.8685e-01],
         [ 5.0009e-02, -1.7171e-01],
         [ 5.0009e-02, -1.5702e-01],
         [ 5.0009e-02, -1.6874e-01],
         [ 5.0009e-02, -1.6092e-01],
         [ 5.0009e-02, -1.5692e-01],
         [ 5.0009e-02,  9.5391e-03]],

        [[ 1.1017e-01,  1.2490e-01],
         [-8.3357e-02,  1.2689e-01],
         [-7.9090e-02, -2.5911e-02],
         [-8.9977e-02,  1.4016e-01],
         [ 9.7377e-02,  1.2443e-01],
         [-1.0006e-01,  1.0546e-01],
         [-9.2104e-02,  1.2260e-01],
         [-7.5913e-02,  1.2862e-01],
         [ 1.0173e-01,  1.3239e-01],
         [ 1.1362e-01,  1.1837e-01],
         [ 1.1453e-01,  1.3216e-01],
         [ 9.0659e-02,  1.4369e-01],
         [ 1.1898e-01,  1.2355e-01],
         [ 1.0675e-01,  1.1615e-01],
         [ 1.0052e-01,  1.1174e-01],
         [ 9.6374e-02,  1.3320e-01],
         [ 1.2098e-01,  1.5047e-01],
         [ 1.1359e-01, -1.3640e-01],
         [ 1.3350e-01,  8.0978e-02],
         [ 1.4640e-01, -1.4455e-01],
         [ 1.1619e-01,  6.5704e-02],
         [ 9.2573e-02,  6.4320e-02],
         [ 1.1584e-01,  9.9201e-02],
         [ 1.0966e-01,  1.1802e-01],
         [ 8.6072e-02, -1.5890e-01],
         [ 1.0683e-01,  9.9457e-02],
         [ 1.0230e-01, -1.6407e-01],
         [-1.6526e-01,  1.3665e-01],
         [-1.6304e-01,  1.2979e-01],
         [-1.6010e-01,  1.7145e-01],
         [ 1.0459e-01,  1.3897e-01],
         [ 1.3237e-01, -1.7954e-01],
         [ 1.1212e-01, -1.5940e-01],
         [ 1.1680e-01,  1.1592e-01],
         [ 1.5335e-01,  1.1074e-01],
         [ 1.2648e-01,  1.1028e-01],
         [ 7.2259e-02,  1.3994e-01],
         [ 1.0498e-01,  1.1687e-01],
         [ 1.2999e-01,  1.4187e-01],
         [ 1.6023e-01, -1.4472e-01],
         [ 1.7786e-01, -1.3441e-01],
         [ 1.3986e-01,  1.5269e-01],
         [ 1.2664e-01, -1.3795e-01],
         [ 1.2916e-01, -1.4397e-01],
         [ 1.0589e-01, -1.3949e-01],
         [ 1.3291e-01, -1.1716e-01],
         [ 1.4468e-01,  5.0993e-03],
         [-1.3988e-01,  3.1411e-02],
         [ 1.0849e-01,  4.5714e-02],
         [-1.6039e-01,  5.2212e-02],
         [ 9.6770e-02,  5.4775e-02],
         [-1.5471e-01,  5.5544e-02],
         [-1.5541e-01,  5.5643e-02],
         [ 1.0102e-01,  5.5543e-02],
         [-3.4857e-03,  5.5415e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.7058e-05, device='cuda:0') tensor(0.0008, device='cuda:0') tensor(-0.0015, device='cuda:0')
mixer_td_error tensor(0.6556, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4612, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4234, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0550, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1874, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0768, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2727272., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1956, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.8893e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1460, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2676, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1460, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5720
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2400e-02,  9.8029e-02,  ...,  3.1969e-02,
            1.6101e-01, -1.0000e+07],
          [-1.0000e+07, -4.6060e-02,  1.1430e-01,  ...,  3.6765e-02,
            1.4675e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2108e-01,  1.1981e-01,  ...,  5.4917e-02,
            1.6785e-01, -1.0000e+07],
          [-1.0000e+07, -8.3276e-02,  1.6010e-01,  ...,  6.2015e-02,
            1.4833e-01, -1.0000e+07]],

         ...,

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.7130e-01,  7.6967e-02,  ...,  8.8144e-02,
            2.1366e-01, -3.2696e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6059e-01,  8.2038e-02,  ...,  7.3630e-02,
            2.0875e-01, -3.1667e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 6.0608e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.4360e-02,  7.4236e-02,  ...,  6.2640e-03,
            1.2703e-01, -1.0000e+07],
          [-1.0000e+07, -7.0404e-02,  1.5810e-01,  ...,  4.6388e-02,
            1.4908e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0383e-01,  9.7922e-02,  ...,  1.2565e-02,
            1.4072e-01, -1.0000e+07],
          [-1.0000e+07, -9.8419e-02,  1.7124e-01,  ...,  6.4498e-02,
            1.6552e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.4276e-02,  1.4162e-01],
         [ 9.8029e-02,  1.1430e-01],
         [ 1.1981e-01,  1.6010e-01],
         [ 1.2099e-01,  1.3587e-01],
         [ 1.2405e-01,  1.0769e-01],
         [ 1.1617e-01,  1.0273e-01],
         [ 1.2096e-01,  1.0874e-01],
         [-1.4903e-01,  9.8483e-02],
         [-1.4964e-01,  1.0355e-01],
         [-1.5519e-01,  1.2860e-01],
         [-1.5528e-01,  1.6549e-01],
         [ 1.1385e-01,  1.2081e-01],
         [ 1.0887e-01,  1.0818e-01],
         [ 1.2204e-01,  1.0554e-01],
         [ 1.2137e-01,  1.0093e-01],
         [ 1.1431e-01,  9.8108e-02],
         [ 8.7508e-02, -4.1350e-02],
         [ 1.0155e-01, -1.7261e-02],
         [ 1.3277e-01, -4.9241e-03],
         [ 1.2791e-01,  1.8534e-03],
         [ 1.2414e-01, -3.3053e-02],
         [ 1.3450e-01, -5.4138e-02],
         [ 1.0929e-01,  9.1476e-02],
         [ 1.3411e-01,  1.2883e-01],
         [-1.6837e-01,  1.6546e-01],
         [ 1.3397e-01,  1.3890e-01],
         [-1.4036e-01,  1.5844e-01],
         [ 1.5579e-03,  1.4760e-01],
         [ 2.6799e-02,  1.0044e-01],
         [ 3.9880e-02, -1.5105e-01],
         [ 4.6012e-02,  8.9315e-02],
         [ 4.8653e-02, -1.6997e-01],
         [ 4.9652e-02, -1.4242e-01],
         [ 4.9987e-02,  7.3435e-02],
         [ 5.0055e-02, -1.1386e-01],
         [ 5.0046e-02,  7.8729e-02],
         [ 5.0032e-02,  9.0704e-02],
         [ 5.0015e-02, -1.0157e-01],
         [ 5.0017e-02,  8.2167e-02],
         [ 4.9999e-02,  9.5221e-02],
         [ 5.0030e-02,  1.1551e-01],
         [ 5.0039e-02,  7.8776e-02],
         [ 5.0019e-02,  1.1246e-01],
         [ 5.0020e-02,  1.1242e-01],
         [ 5.0023e-02,  1.1280e-01],
         [ 5.0024e-02, -1.9275e-01],
         [ 5.0021e-02,  9.8004e-02],
         [ 5.0015e-02,  1.0403e-01],
         [ 5.0007e-02, -1.9430e-01],
         [ 5.0007e-02, -1.8665e-01],
         [ 5.0008e-02, -1.9642e-01],
         [ 5.0008e-02, -1.6907e-01],
         [ 5.0008e-02, -1.8519e-01],
         [ 5.0008e-02, -1.8718e-01],
         [ 5.0008e-02, -1.6434e-01],
         [ 5.0008e-02, -1.7130e-01],
         [ 5.0008e-02, -1.6059e-01],
         [ 5.0008e-02,  6.0608e-03]],

        [[ 6.3473e-02,  1.3755e-01],
         [ 7.4236e-02,  1.5810e-01],
         [ 9.7922e-02,  1.7124e-01],
         [-7.6672e-02,  1.5098e-01],
         [-3.2289e-02, -1.5808e-01],
         [-5.7887e-02,  9.4059e-02],
         [ 1.1921e-01,  9.3205e-02],
         [ 1.5301e-01, -1.8244e-01],
         [ 1.7431e-01,  9.6146e-02],
         [ 1.7710e-01, -1.8408e-01],
         [ 1.3745e-01, -1.4846e-01],
         [ 1.3742e-01,  1.4969e-01],
         [ 1.1970e-01,  1.6965e-01],
         [ 1.1135e-01,  1.6665e-01],
         [ 1.2149e-01, -1.2265e-01],
         [ 1.1117e-01, -1.5917e-01],
         [ 1.2073e-01, -1.4443e-01],
         [ 8.4568e-02, -1.8126e-01],
         [ 9.4919e-02, -1.7636e-01],
         [-9.6449e-02, -1.7051e-01],
         [ 1.0608e-01, -1.3034e-01],
         [ 7.7939e-02, -1.4796e-01],
         [ 1.0957e-01,  1.9309e-02],
         [-7.0186e-02,  4.1537e-02],
         [-7.8832e-02,  5.1971e-02],
         [ 8.8339e-02,  5.5940e-02],
         [ 1.1391e-01,  5.6931e-02],
         [ 1.2687e-01,  5.6799e-02],
         [ 9.7271e-02,  5.6349e-02],
         [ 1.1140e-01,  5.5964e-02],
         [ 7.4655e-02,  5.5651e-02],
         [ 1.1591e-01,  5.5474e-02],
         [ 1.3126e-01,  5.5348e-02],
         [ 1.2722e-01,  5.5283e-02],
         [ 8.6774e-02,  5.5242e-02],
         [ 1.1623e-01,  5.5190e-02],
         [ 1.5374e-01,  5.5229e-02],
         [ 1.8613e-01,  5.5209e-02],
         [ 1.4649e-01,  5.5214e-02],
         [ 1.2912e-01,  5.5203e-02],
         [ 1.4835e-01,  5.5219e-02],
         [ 1.3968e-01,  5.5224e-02],
         [ 1.7577e-01,  5.5226e-02],
         [ 1.7443e-01,  5.5230e-02],
         [ 1.4300e-01,  5.5230e-02],
         [ 1.4270e-01,  5.5230e-02],
         [-1.9934e-01,  5.5232e-02],
         [-1.7306e-01,  5.5236e-02],
         [ 1.2583e-01,  5.5235e-02],
         [ 1.1949e-01,  5.5232e-02],
         [ 8.9068e-03,  5.5232e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.7186e-05, device='cuda:0') tensor(0.0020, device='cuda:0') tensor(-0.0027, device='cuda:0')
mixer_td_error tensor(0.1735, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5044, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6990, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0552, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1705, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0766, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-603448.1875, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1861, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.6008e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0019, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1819, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3240, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1819, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5797
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2225e-02,  6.2394e-02,  ...,  2.0084e-02,
            1.2912e-01, -1.0000e+07],
          [-1.0000e+07, -7.7190e-02,  1.6041e-01,  ...,  7.2365e-02,
            1.5573e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.0171e-02,  4.6061e-02,  ...,  4.1223e-02,
            1.3816e-01, -1.0000e+07],
          [-1.0000e+07, -1.2417e-01,  1.0542e-01,  ...,  6.0142e-02,
            1.7534e-01, -1.0000e+07]],

         ...,

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3740e-01,  4.1005e-02,  ...,  3.3463e-02,
            2.0037e-01, -1.0000e+07]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.2245e-01,  2.2864e-02,  ...,  1.2143e-02,
            1.9666e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.2287e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.9665e-02,  5.9675e-02,  ...,  1.7156e-02,
            1.3094e-01, -1.0000e+07],
          [-1.0000e+07, -6.0440e-02,  1.6172e-01,  ...,  4.7207e-02,
            1.5243e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3029e-02,  9.6897e-02,  ...,  4.0310e-02,
            1.5748e-01, -1.0000e+07],
          [-1.0000e+07, -8.1469e-02,  1.3480e-01,  ...,  1.5844e-02,
            1.5054e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.4276e-02,  1.4162e-01],
         [-6.2225e-02, -7.7190e-02],
         [-5.0171e-02, -1.2417e-01],
         [-5.5750e-02, -1.6707e-01],
         [-6.0333e-02, -1.8800e-01],
         [-4.5322e-02,  1.1083e-01],
         [-5.4950e-02, -2.0342e-01],
         [-7.1698e-02, -1.9488e-01],
         [-8.9908e-02, -1.6529e-01],
         [-8.8833e-02, -2.0003e-01],
         [-8.6353e-02, -1.5952e-01],
         [-9.3121e-02, -1.5221e-01],
         [-1.0690e-01, -1.0543e-01],
         [-1.1034e-01, -8.6728e-02],
         [-1.2086e-01, -7.3845e-02],
         [ 1.0957e-01,  1.4163e-01],
         [-1.1353e-01,  1.5074e-01],
         [ 1.0969e-01, -1.1008e-01],
         [ 1.1634e-01, -9.6470e-02],
         [-1.1104e-01, -1.1788e-01],
         [-9.6136e-02, -9.7966e-02],
         [-8.1049e-02, -9.0314e-02],
         [-6.6191e-02, -8.6038e-02],
         [ 1.2084e-01, -9.1300e-02],
         [-7.0868e-02, -8.2171e-02],
         [ 1.1740e-01, -9.2198e-02],
         [-8.4688e-02, -8.6714e-02],
         [-8.0745e-02, -1.2155e-01],
         [-8.2549e-02, -1.0604e-01],
         [ 1.2564e-01, -1.2388e-01],
         [ 1.3462e-01, -1.3454e-01],
         [ 1.2062e-01, -1.0901e-01],
         [-6.8257e-02, -1.0784e-01],
         [-6.2877e-02, -1.3352e-01],
         [ 1.2263e-01, -1.0942e-01],
         [-6.9004e-02, -1.1358e-01],
         [-6.1038e-02, -9.8990e-02],
         [-4.6700e-02, -8.5677e-02],
         [-4.0838e-02, -9.0660e-02],
         [-4.2937e-02, -7.3351e-02],
         [ 1.3812e-01, -6.9499e-02],
         [ 1.4719e-01, -6.8537e-02],
         [ 1.5098e-01, -7.3024e-02],
         [ 1.4491e-01,  1.1886e-01],
         [ 1.4630e-01, -9.4505e-02],
         [-6.1602e-02, -8.3677e-02],
         [ 1.3517e-01, -9.3405e-02],
         [ 1.2611e-01, -8.2644e-02],
         [-5.7862e-02, -8.0513e-02],
         [-6.1121e-02, -8.8742e-02],
         [-4.8498e-02, -8.1731e-02],
         [ 1.2033e-01, -7.8955e-02],
         [-4.6674e-02, -8.0622e-02],
         [ 1.2669e-01, -6.9637e-02],
         [ 1.3654e-01, -1.0627e-01],
         [ 1.4457e-01, -1.1495e-01],
         [ 1.0822e-01, -1.3333e-01],
         [ 1.3258e-01, -1.4517e-01],
         [-7.6624e-02, -1.2105e-01],
         [ 1.3642e-01, -1.1305e-01],
         [ 1.4824e-01, -1.0185e-01],
         [ 1.5449e-01, -1.0816e-01],
         [ 1.5433e-01, -1.2705e-01],
         [ 1.7276e-01,  1.2470e-01],
         [ 1.7542e-01, -1.3494e-01],
         [ 1.5339e-01, -1.6029e-01],
         [ 1.7310e-01, -1.5219e-01],
         [ 1.9181e-01,  1.2856e-01],
         [ 1.4465e-01, -1.5636e-01],
         [ 1.4087e-01, -1.4369e-01],
         [-1.5489e-01, -1.4515e-01],
         [-1.5891e-01,  1.0419e-01],
         [ 1.6759e-01,  1.1759e-01],
         [ 1.7295e-01, -1.6748e-01],
         [ 1.8473e-01, -1.6753e-01],
         [ 1.5782e-01, -1.6418e-01],
         [-1.6513e-01, -1.4819e-01],
         [ 1.6038e-01, -1.4315e-01],
         [-1.5843e-01, -1.3339e-01],
         [ 1.6362e-01, -1.4066e-01],
         [-1.5276e-01,  9.3304e-02],
         [-1.4671e-01,  1.4008e-01],
         [ 1.9861e-01,  1.6050e-01],
         [-1.5705e-01,  1.5866e-01],
         [ 3.7360e-03,  1.4849e-01],
         [ 2.4588e-02,  1.4539e-01],
         [ 3.7796e-02,  1.4573e-01],
         [ 4.4747e-02,  1.5611e-01],
         [ 4.8003e-02, -5.4810e-02],
         [ 4.9379e-02,  1.4921e-01],
         [ 4.9888e-02,  1.5403e-01],
         [ 5.0033e-02,  1.7582e-01],
         [ 5.0053e-02, -5.2941e-02],
         [ 5.0057e-02, -3.8881e-02],
         [ 5.0038e-02,  1.4044e-01],
         [ 5.0012e-02,  1.5908e-01],
         [ 5.0025e-02, -4.1979e-02],
         [ 5.0015e-02,  1.4436e-01],
         [ 5.0025e-02,  1.5183e-01],
         [ 5.0020e-02,  1.6311e-01],
         [ 5.0021e-02,  1.8162e-01],
         [ 5.0018e-02, -9.2120e-02],
         [ 5.0025e-02, -1.3383e-01],
         [ 5.0018e-02, -1.4719e-01],
         [ 5.0009e-02, -1.5709e-01],
         [ 5.0019e-02, -1.5732e-01],
         [ 5.0005e-02, -1.4853e-01],
         [ 5.0007e-02, -1.6434e-01],
         [ 5.0008e-02, -1.8347e-01],
         [ 5.0008e-02, -1.5611e-01],
         [ 5.0008e-02, -1.3327e-01],
         [ 5.0009e-02, -1.4981e-01],
         [ 5.0008e-02, -1.4467e-01],
         [ 5.0008e-02, -1.6552e-01],
         [ 5.0008e-02, -1.5647e-01],
         [ 5.0008e-02, -1.3740e-01],
         [ 5.0008e-02, -1.2245e-01],
         [ 5.0009e-02,  1.2287e-02]],

        [[ 7.2334e-02,  1.2843e-01],
         [-5.9665e-02,  1.6172e-01],
         [-8.3029e-02, -8.1469e-02],
         [-7.1385e-02, -9.1608e-02],
         [-9.1036e-02, -1.1195e-01],
         [-3.4255e-02, -1.6244e-01],
         [-6.1731e-02, -1.6382e-01],
         [ 1.2557e-01, -1.2402e-01],
         [-7.9815e-02, -1.4925e-01],
         [-9.5855e-02, -1.7143e-01],
         [-1.0758e-01, -1.9991e-01],
         [-1.0119e-01, -1.9652e-01],
         [-1.1274e-01, -2.2142e-01],
         [-1.0419e-01, -2.0869e-01],
         [-1.1397e-01, -2.0267e-01],
         [-7.9559e-02, -1.8805e-01],
         [-5.3724e-02, -1.8755e-01],
         [-5.8636e-02, -1.7156e-01],
         [-4.9792e-02, -1.6958e-01],
         [-3.5434e-02, -1.4747e-01],
         [-6.0288e-02, -1.6831e-01],
         [-4.3926e-02, -1.5916e-01],
         [-3.7946e-02, -1.6511e-01],
         [-5.8748e-02, -9.0589e-03],
         [-6.7788e-02,  2.9268e-02],
         [-7.3400e-02,  4.6055e-02],
         [-7.7715e-02,  5.2924e-02],
         [-9.1400e-02,  5.5413e-02],
         [-1.0292e-01,  5.6087e-02],
         [ 1.1872e-01,  5.6049e-02],
         [-1.3075e-01,  5.5828e-02],
         [-9.9554e-02,  5.5592e-02],
         [-1.2549e-01,  5.5430e-02],
         [ 1.2251e-01,  5.5317e-02],
         [-1.5967e-01,  5.5267e-02],
         [-1.3321e-01,  5.5215e-02],
         [ 9.6490e-02,  5.5211e-02],
         [ 1.0416e-01,  5.5222e-02],
         [-1.1594e-01,  5.5202e-02],
         [-1.0765e-01,  5.5201e-02],
         [-8.5018e-02,  5.5205e-02],
         [-7.3465e-02,  5.5216e-02],
         [-8.3122e-02,  5.5229e-02],
         [-7.0459e-02,  5.5229e-02],
         [-8.5054e-02,  5.5230e-02],
         [-1.0306e-01,  5.5229e-02],
         [-1.0539e-01,  5.5232e-02],
         [ 9.9818e-02,  5.5236e-02],
         [-9.7959e-02,  5.5235e-02],
         [-7.8004e-02,  5.5232e-02],
         [-9.9653e-02,  5.5232e-02],
         [-9.6312e-02,  5.5231e-02],
         [-7.7166e-02,  5.5231e-02],
         [-6.7918e-02,  5.5231e-02],
         [-5.8862e-02,  5.5231e-02],
         [-5.6729e-02,  5.5231e-02],
         [-5.5892e-02,  5.5231e-02],
         [-5.4805e-02,  5.5231e-02],
         [-5.3408e-02,  5.5231e-02],
         [-8.2850e-02,  5.5231e-02],
         [-8.4233e-02,  5.5231e-02],
         [-8.4251e-02,  5.5231e-02],
         [-1.0485e-01,  5.5231e-02],
         [-1.0587e-01,  5.5231e-02],
         [-1.0905e-01,  5.5231e-02],
         [-8.7596e-02,  5.5231e-02],
         [-7.6751e-02,  5.5231e-02],
         [-6.1696e-02,  5.5231e-02],
         [-6.7288e-02,  5.5231e-02],
         [-5.8775e-02,  5.5231e-02],
         [-5.1992e-02,  5.5231e-02],
         [-7.3542e-02,  5.5231e-02],
         [-7.5667e-02,  5.5231e-02],
         [-7.6744e-02,  5.5231e-02],
         [-7.7306e-02,  5.5231e-02],
         [-9.7009e-02,  5.5231e-02],
         [-9.2153e-02,  5.5231e-02],
         [-9.2230e-02,  5.5231e-02],
         [-1.0402e-01,  5.5231e-02],
         [-1.3048e-01,  5.5231e-02],
         [ 1.2792e-01,  5.5231e-02],
         [-1.4482e-01,  5.5231e-02],
         [-1.4036e-01,  5.5231e-02],
         [ 1.0765e-01,  5.5231e-02],
         [ 1.1919e-01,  5.5231e-02],
         [ 1.0911e-01,  5.5231e-02],
         [ 1.2506e-01,  5.5231e-02],
         [ 1.4812e-01,  5.5231e-02],
         [ 1.3746e-01,  5.5231e-02],
         [ 1.0251e-01,  5.5231e-02],
         [ 8.8769e-02,  5.5231e-02],
         [ 1.1512e-01,  5.5231e-02],
         [-2.2711e-01,  5.5231e-02],
         [-2.1270e-01,  5.5231e-02],
         [-2.0684e-01,  5.5231e-02],
         [-2.1104e-01,  5.5231e-02],
         [-1.7905e-01,  5.5231e-02],
         [-1.5571e-01,  5.5231e-02],
         [-1.8873e-01,  5.5231e-02],
         [-2.1272e-01,  5.5231e-02],
         [-2.6373e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.2463e-05, device='cuda:0') tensor(0.0016, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.2147, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4583, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4701, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0528, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1658, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0887, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-720338.9375, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1986, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.2985e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1108, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2971, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1108, device='cuda:0', grad_fn=<MinBackward1>)
t_env 5871
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0695e-02,  8.8884e-02,  ...,  1.4652e-02,
            1.4204e-01, -1.0000e+07],
          [-1.0000e+07, -3.4872e-02,  9.9288e-02,  ..., -3.2764e-02,
            1.3673e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3586e-01,  4.0597e-02,  ...,  4.7742e-02,
            1.9922e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1941e-01,  1.6392e-02,  ...,  4.5058e-02,
            1.8264e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.1394e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.3297e-02,  7.5482e-02,  ...,  2.0656e-03,
            1.2204e-01, -1.0000e+07],
          [-1.0000e+07, -1.9084e-02,  9.7086e-02,  ..., -1.3971e-02,
            1.2488e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4835e-02,  1.0068e-01,  ...,  2.7234e-02,
            1.5901e-01, -1.0000e+07],
          [-1.0000e+07, -2.5852e-02,  9.3294e-02,  ..., -3.4115e-04,
            1.3873e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9054e-02,  1.0069e-01,  ...,  1.9605e-02,
            1.5300e-01, -1.0000e+07],
          [-1.0000e+07, -2.5418e-02,  1.0335e-01,  ...,  1.9610e-02,
            1.3840e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-7.2275e-02, -1.3772e-02],
         [-6.7838e-02, -1.4399e-02],
         [-7.0695e-02, -3.4872e-02],
         [-4.9679e-02, -4.0589e-02],
         [-6.6429e-02, -4.8187e-02],
         [-4.9719e-02, -4.0892e-02],
         [-4.3531e-02, -4.7865e-02],
         [-5.1464e-02, -5.0239e-02],
         [-4.4687e-02, -5.0203e-02],
         [-1.8013e-02, -5.0604e-02],
         [-1.1318e-02, -3.5965e-02],
         [-4.3122e-03, -3.0927e-02],
         [-1.1730e-02, -4.1706e-02],
         [ 1.5813e-03, -4.9168e-02],
         [-3.9702e-02, -4.4297e-02],
         [-6.7924e-02, -5.0424e-02],
         [-4.0641e-02, -3.7645e-02],
         [-3.8083e-02, -4.8830e-02],
         [-3.3647e-02, -4.1056e-02],
         [-4.9475e-02, -4.5426e-02],
         [-3.3012e-02,  1.5612e-01],
         [-3.6520e-02,  1.5992e-01],
         [-5.9303e-02, -3.3803e-02],
         [-3.9183e-02, -3.9956e-02],
         [-3.2951e-02, -4.5840e-02],
         [-3.5875e-02,  1.5210e-01],
         [-3.5667e-02, -5.6073e-02],
         [-4.8678e-02, -3.4138e-02],
         [-7.2968e-02, -3.0103e-02],
         [-1.2112e-01, -5.1397e-02],
         [-1.5846e-01, -4.7618e-02],
         [-1.6464e-01, -4.9616e-02],
         [-1.4475e-01, -7.4179e-02],
         [-1.2816e-01, -7.3159e-02],
         [-1.4963e-01, -9.3419e-02],
         [-1.6707e-01, -9.3156e-02],
         [-1.7875e-01, -1.1065e-01],
         [-2.1551e-01, -8.7847e-02],
         [ 1.5366e-01, -7.4816e-02],
         [-2.0262e-01, -7.8308e-02],
         [-2.0325e-01, -6.1851e-02],
         [-2.0885e-01, -7.1838e-02],
         [-2.1489e-01, -6.7306e-02],
         [-2.2636e-01, -4.8074e-02],
         [-1.9145e-01, -5.8890e-02],
         [-1.8443e-01, -7.1859e-02],
         [-1.7374e-01, -5.2451e-02],
         [-6.7529e-03, -3.1846e-02],
         [ 2.1785e-02, -1.9923e-02],
         [ 3.6720e-02, -3.5356e-03],
         [ 4.4121e-02, -1.9083e-02],
         [ 4.7585e-02, -1.6124e-02],
         [ 4.9116e-02, -1.1797e-02],
         [ 4.9755e-02,  1.0193e-03],
         [ 4.9969e-02, -3.3511e-02],
         [ 5.0025e-02, -4.2697e-02],
         [ 5.0041e-02, -6.2665e-02],
         [ 5.0028e-02, -6.2789e-02],
         [ 5.0030e-02, -1.4365e-02],
         [ 5.0032e-02, -2.7605e-03],
         [ 5.0026e-02, -2.0673e-02],
         [ 5.0025e-02,  3.7915e-03],
         [ 5.0002e-02,  7.3887e-03],
         [ 5.0023e-02,  7.5001e-03],
         [ 5.0015e-02, -3.1327e-02],
         [ 5.0015e-02, -5.4273e-02],
         [ 5.0017e-02, -8.4716e-02],
         [ 5.0010e-02, -1.0182e-01],
         [ 5.0006e-02, -1.2343e-01],
         [ 5.0007e-02, -1.1636e-01],
         [ 5.0007e-02, -1.3203e-01],
         [ 5.0008e-02, -1.4475e-01],
         [ 5.0008e-02, -1.2531e-01],
         [ 5.0008e-02, -1.0838e-01],
         [ 5.0009e-02, -1.0181e-01],
         [ 5.0008e-02, -8.8699e-02],
         [ 5.0008e-02, -9.7029e-02],
         [ 5.0008e-02, -8.8897e-02],
         [ 5.0008e-02, -9.9439e-02],
         [ 5.0009e-02, -8.8788e-02],
         [ 5.0009e-02, -9.9703e-02],
         [ 5.0009e-02, -8.1417e-02],
         [ 5.0009e-02, -3.3128e-02],
         [ 5.0009e-02, -6.3181e-02],
         [ 5.0009e-02, -8.5393e-02],
         [ 5.0009e-02, -5.5682e-02],
         [ 5.0009e-02, -5.6207e-02],
         [ 5.0009e-02, -5.9562e-02],
         [ 5.0009e-02, -7.4775e-02],
         [ 5.0009e-02, -1.0059e-01],
         [ 5.0009e-02, -6.7548e-02],
         [ 5.0009e-02, -6.3498e-02],
         [ 5.0009e-02, -7.4139e-02],
         [ 5.0009e-02, -3.4269e-02],
         [ 5.0009e-02, -6.5660e-02],
         [ 5.0009e-02, -8.6216e-02],
         [ 5.0009e-02, -8.2693e-02],
         [ 5.0009e-02, -8.4994e-02],
         [ 5.0009e-02, -9.5304e-02],
         [ 5.0009e-02, -1.0073e-01],
         [ 5.0009e-02, -6.0988e-02],
         [ 5.0009e-02, -5.4778e-02],
         [ 5.0009e-02, -5.4033e-02],
         [ 5.0009e-02, -5.5095e-02],
         [ 5.0009e-02, -3.1402e-02],
         [ 5.0009e-02, -3.9633e-02],
         [ 5.0009e-02, -4.6317e-02],
         [ 5.0009e-02, -1.5543e-02],
         [ 5.0009e-02, -1.2618e-02],
         [ 5.0009e-02,  3.3931e-03],
         [ 5.0009e-02, -6.3612e-03],
         [ 5.0009e-02, -2.0794e-02],
         [ 5.0009e-02, -2.6692e-02],
         [ 5.0009e-02, -9.8019e-03],
         [ 5.0009e-02, -1.7422e-02],
         [ 5.0009e-02, -2.8153e-02],
         [ 5.0009e-02, -4.3286e-02],
         [ 5.0009e-02, -5.1520e-02],
         [ 5.0009e-02, -7.0784e-02],
         [ 5.0009e-02, -5.3361e-02],
         [ 5.0009e-02, -4.6715e-02],
         [ 5.0009e-02, -2.2396e-02],
         [ 5.0009e-02, -1.8733e-02],
         [ 5.0009e-02, -2.6026e-02],
         [ 5.0009e-02, -3.1849e-02],
         [ 5.0009e-02, -1.3676e-02],
         [ 5.0009e-02, -2.5572e-02],
         [ 5.0009e-02, -9.9668e-03],
         [ 5.0009e-02, -1.0698e-02],
         [ 5.0009e-02, -2.0732e-02],
         [ 5.0009e-02, -6.1543e-03],
         [ 5.0009e-02, -8.4494e-03],
         [ 5.0009e-02,  2.5393e-03],
         [ 5.0009e-02,  6.7060e-03],
         [ 5.0009e-02,  8.4499e-03],
         [ 5.0009e-02,  3.3570e-05],
         [ 5.0009e-02,  7.4983e-03],
         [ 5.0009e-02, -1.2278e-02],
         [ 5.0009e-02, -4.1027e-02],
         [ 5.0009e-02, -6.2090e-02],
         [ 5.0009e-02, -7.7211e-02],
         [ 5.0009e-02, -5.7020e-02],
         [ 5.0009e-02, -3.4903e-02],
         [ 5.0009e-02, -3.4755e-02],
         [ 5.0009e-02, -2.4225e-02],
         [ 5.0009e-02, -2.9173e-02],
         [ 5.0009e-02, -3.3879e-02],
         [ 5.0009e-02, -3.7286e-02],
         [ 5.0009e-02, -5.5701e-02],
         [ 5.0009e-02, -7.0784e-02],
         [ 5.0009e-02, -5.1489e-02],
         [ 5.0009e-02, -3.0790e-02],
         [ 5.0009e-02, -3.1867e-02],
         [ 5.0009e-02, -1.2692e-02],
         [ 5.0009e-02, -4.1902e-02],
         [ 5.0009e-02, -3.1691e-02],
         [ 5.0009e-02, -3.0797e-02],
         [ 5.0009e-02, -2.0897e-02],
         [ 5.0009e-02, -2.6814e-02],
         [ 5.0009e-02, -1.9622e-02],
         [ 5.0009e-02, -2.6434e-02],
         [ 5.0009e-02, -3.2200e-02],
         [ 5.0009e-02, -3.6243e-02],
         [ 5.0009e-02, -4.2529e-03],
         [ 5.0009e-02, -1.7457e-02],
         [ 5.0009e-02,  1.9800e-03],
         [ 5.0009e-02, -1.6050e-02],
         [ 5.0009e-02, -5.2368e-02],
         [ 5.0009e-02, -7.4076e-02],
         [ 5.0009e-02, -5.6799e-02],
         [ 5.0009e-02, -1.3798e-02],
         [ 5.0009e-02,  1.0269e-04],
         [ 5.0009e-02, -5.6068e-03],
         [ 5.0009e-02, -1.8152e-02],
         [ 5.0009e-02, -3.5386e-02],
         [ 5.0009e-02, -6.4978e-02],
         [ 5.0009e-02, -3.6206e-02],
         [ 5.0009e-02, -9.1769e-03],
         [ 5.0009e-02, -2.5406e-02],
         [ 5.0009e-02, -1.6255e-02],
         [ 5.0009e-02, -2.4482e-02],
         [ 5.0009e-02, -2.7098e-02],
         [ 5.0009e-02, -2.8141e-02],
         [ 5.0009e-02, -8.0687e-03],
         [ 5.0009e-02,  6.1416e-03],
         [ 5.0009e-02, -1.1549e-02],
         [ 5.0009e-02, -2.0182e-02],
         [ 5.0009e-02, -3.7727e-02],
         [ 5.0009e-02, -6.8896e-02],
         [ 5.0009e-02, -8.2456e-02],
         [ 5.0009e-02, -9.9671e-02],
         [ 5.0009e-02, -9.7924e-02],
         [ 5.0009e-02, -1.3422e-01],
         [ 5.0009e-02, -1.2954e-01],
         [ 5.0009e-02, -1.1491e-01],
         [ 5.0009e-02, -1.0161e-01],
         [ 5.0009e-02, -7.0541e-02],
         [ 5.0009e-02, -5.0242e-02],
         [ 5.0009e-02, -6.0859e-02],
         [ 5.0009e-02, -8.6454e-02],
         [ 5.0009e-02, -1.0270e-01],
         [ 5.0009e-02, -1.4073e-01],
         [ 5.0009e-02, -1.4681e-01],
         [ 5.0009e-02, -1.6239e-01],
         [ 5.0009e-02, -1.8493e-01],
         [ 5.0009e-02, -1.5955e-01],
         [ 5.0009e-02, -1.4338e-01],
         [ 5.0009e-02, -1.4636e-01],
         [ 5.0009e-02, -1.4762e-01],
         [ 5.0009e-02, -1.3525e-01],
         [ 5.0009e-02, -1.3009e-01],
         [ 5.0009e-02, -1.3969e-01],
         [ 5.0009e-02, -1.3098e-01],
         [ 5.0009e-02, -1.2422e-01],
         [ 5.0009e-02, -1.5478e-01],
         [ 5.0009e-02, -1.5169e-01],
         [ 5.0009e-02, -1.5306e-01],
         [ 5.0009e-02, -1.4896e-01],
         [ 5.0009e-02, -1.7457e-01],
         [ 5.0009e-02, -1.5489e-01],
         [ 5.0009e-02, -1.6223e-01],
         [ 5.0009e-02, -1.3586e-01],
         [ 5.0009e-02, -1.1941e-01],
         [ 5.0009e-02,  5.1394e-02]],

        [[-5.3297e-02, -1.9084e-02],
         [-7.4835e-02, -2.5852e-02],
         [-8.9054e-02, -2.5418e-02],
         [-1.2163e-01, -4.5979e-02],
         [-1.2238e-01, -6.3791e-02],
         [-1.4142e-01, -8.0468e-02],
         [-1.4927e-01, -9.5854e-02],
         [-1.5116e-01, -1.0032e-01],
         [-1.2951e-01, -9.9487e-02],
         [-1.5726e-01, -1.0475e-01],
         [-1.4777e-01, -1.0776e-01],
         [-1.4671e-01, -1.0944e-01],
         [-1.7451e-01, -1.0876e-01],
         [-1.7335e-01, -1.1950e-01],
         [-1.5480e-01, -1.0764e-01],
         [-1.6900e-01, -1.2091e-01],
         [-1.4260e-01, -1.1898e-01],
         [-1.3273e-01, -1.1319e-01],
         [-1.1504e-01, -1.0928e-01],
         [-1.0442e-01, -9.2305e-02],
         [-1.0428e-01, -7.6786e-02],
         [-8.6627e-02, -7.8586e-02],
         [-7.2160e-02, -8.8708e-02],
         [-6.7804e-02, -5.6347e-02],
         [-7.2518e-02, -5.6457e-02],
         [-7.0069e-02, -4.2571e-02],
         [-7.5047e-02, -5.2210e-02],
         [-7.3523e-02, -8.9044e-02],
         [-7.1519e-02, -5.6211e-02],
         [-7.5760e-02, -8.1534e-02],
         [-1.1326e-01, -2.1030e-02],
         [-8.6073e-02, -2.8049e-02],
         [-7.9406e-02, -6.5624e-02],
         [-8.8159e-02, -3.8203e-02],
         [-9.5061e-02, -3.9379e-02],
         [-7.6572e-02, -3.6947e-02],
         [-7.4272e-02, -7.1613e-02],
         [-7.6173e-02, -7.3015e-02],
         [-1.1358e-01, -8.7813e-02],
         [-1.3530e-01, -1.0452e-01],
         [-3.2408e-02, -7.6270e-02],
         [ 8.6133e-03, -7.5397e-02],
         [ 3.0226e-02, -3.6203e-02],
         [ 4.0974e-02, -3.9076e-02],
         [ 4.6110e-02, -6.3540e-02],
         [ 4.8453e-02, -5.5810e-02],
         [ 4.9465e-02, -4.8608e-02],
         [ 4.9862e-02, -5.0276e-02],
         [ 5.0008e-02, -5.8366e-02],
         [ 5.0033e-02, -5.3502e-02],
         [ 5.0035e-02, -5.2857e-02],
         [ 5.0019e-02, -4.8221e-02],
         [ 5.0017e-02, -7.0556e-02],
         [ 5.0016e-02, -6.3663e-02],
         [ 5.0031e-02, -7.9070e-02],
         [ 5.0043e-02, -6.4730e-02],
         [ 5.0020e-02, -7.1411e-02],
         [ 5.0008e-02, -1.0659e-01],
         [ 5.0022e-02, -1.1265e-01],
         [ 5.0015e-02, -1.4964e-01],
         [ 5.0021e-02, -1.6939e-01],
         [ 5.0020e-02, -1.3854e-01],
         [ 5.0005e-02, -1.1423e-01],
         [ 5.0007e-02, -1.0382e-01],
         [ 5.0008e-02, -9.3043e-02],
         [ 5.0008e-02, -1.4087e-01],
         [ 5.0008e-02, -1.2127e-01],
         [ 5.0008e-02, -1.2396e-01],
         [ 5.0008e-02, -1.6139e-01],
         [ 5.0008e-02, -1.2935e-01],
         [ 5.0008e-02, -1.4355e-01],
         [ 5.0008e-02, -1.7038e-01],
         [ 5.0008e-02, -1.5834e-01],
         [ 5.0009e-02, -1.4253e-01],
         [ 5.0009e-02, -1.6394e-01],
         [ 5.0009e-02, -1.7261e-01],
         [ 5.0009e-02, -1.4535e-01],
         [ 5.0009e-02, -1.4200e-01],
         [ 5.0009e-02, -1.4299e-01],
         [ 5.0009e-02, -1.7380e-01],
         [ 5.0009e-02, -1.8751e-01],
         [ 5.0009e-02, -1.8861e-01],
         [ 5.0009e-02, -1.7285e-01],
         [ 5.0009e-02, -1.5011e-01],
         [ 5.0009e-02, -1.3197e-01],
         [ 5.0009e-02, -1.2198e-01],
         [ 5.0009e-02, -1.6289e-01],
         [ 5.0009e-02, -1.4194e-01],
         [ 5.0009e-02, -1.7249e-01],
         [ 5.0009e-02, -1.8519e-01],
         [ 5.0009e-02, -1.5135e-01],
         [ 5.0009e-02, -1.2499e-01],
         [ 5.0009e-02, -1.1699e-01],
         [ 5.0009e-02, -1.0317e-01],
         [ 5.0009e-02, -1.1275e-01],
         [ 5.0009e-02, -1.0245e-01],
         [ 5.0009e-02, -9.1886e-02],
         [ 5.0009e-02, -7.8131e-02],
         [ 5.0009e-02, -7.0858e-02],
         [ 5.0009e-02, -7.2379e-02],
         [ 5.0009e-02, -7.5894e-02],
         [ 5.0009e-02, -1.0011e-01],
         [ 5.0009e-02, -9.0521e-02],
         [ 5.0009e-02, -1.0425e-01],
         [ 5.0009e-02, -9.0136e-02],
         [ 5.0009e-02, -6.7447e-02],
         [ 5.0009e-02, -6.6274e-02],
         [ 5.0009e-02, -9.1122e-02],
         [ 5.0009e-02, -1.0077e-01],
         [ 5.0009e-02, -9.3850e-02],
         [ 5.0009e-02, -8.6228e-02],
         [ 5.0009e-02, -7.7893e-02],
         [ 5.0009e-02, -7.6806e-02],
         [ 5.0009e-02, -7.2181e-02],
         [ 5.0009e-02, -3.4754e-02],
         [ 5.0009e-02, -3.9056e-02],
         [ 5.0009e-02, -5.7407e-02],
         [ 5.0009e-02, -8.8094e-02],
         [ 5.0009e-02, -8.9241e-02],
         [ 5.0009e-02, -4.8877e-02],
         [ 5.0009e-02, -3.6954e-02],
         [ 5.0009e-02, -3.2230e-02],
         [ 5.0009e-02, -4.0361e-02],
         [ 5.0009e-02, -4.8904e-02],
         [ 5.0009e-02, -5.4230e-02],
         [ 5.0009e-02, -5.6581e-02],
         [ 5.0009e-02, -5.9536e-02],
         [ 5.0009e-02, -8.2457e-02],
         [ 5.0009e-02, -1.0745e-01],
         [ 5.0009e-02, -1.3490e-01],
         [ 5.0009e-02, -1.2913e-01],
         [ 5.0009e-02, -1.3003e-01],
         [ 5.0009e-02, -1.2710e-01],
         [ 5.0009e-02, -1.4074e-01],
         [ 5.0009e-02, -1.1674e-01],
         [ 5.0009e-02, -1.2994e-01],
         [ 5.0009e-02, -1.1046e-01],
         [ 5.0009e-02,  5.3609e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-7.5149e-06, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.4555, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4599, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5795, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0303, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1488, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1565, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1919642.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1599, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.1752e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1503, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2892, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1503, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6002
target_mac_out tensor([[[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3268e-01,  1.1815e-01,  ...,  6.9543e-02,
            1.6155e-01, -1.0000e+07],
          [-1.0000e+07, -2.7664e-02,  1.0133e-01,  ...,  1.0988e-02,
            1.3958e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6339e-01,  1.3025e-01,  ...,  7.9943e-02,
            1.7916e-01, -3.7833e-01],
          [-1.0000e+07, -5.6401e-02,  1.3878e-01,  ...,  3.7180e-02,
            1.4673e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5616e-02,  9.4210e-02,  ...,  7.3878e-03,
            1.5537e-01, -1.0000e+07],
          [-1.0000e+07, -2.6778e-02,  1.1172e-01,  ...,  1.0212e-02,
            1.4563e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6670e-02,  6.7967e-02,  ...,  1.6771e-02,
            1.4736e-01, -1.0000e+07],
          [-1.0000e+07, -4.0458e-02,  1.4132e-01,  ...,  2.4393e-02,
            1.5301e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.8329e-01,  8.0878e-02,  ...,  8.4826e-02,
            2.2755e-01, -3.3026e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.7266e-01,  8.0218e-02,  ...,  7.2890e-02,
            2.1799e-01, -3.2035e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.9990e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.4019e-01, -1.1117e-02],
         [-1.3268e-01, -2.7664e-02],
         [-1.6339e-01, -5.6401e-02],
         [ 1.9163e-01, -8.2999e-02],
         [-1.7635e-01,  1.7314e-01],
         [-1.8472e-01,  1.7915e-01],
         [-1.9773e-01,  1.8166e-01],
         [-2.0860e-01,  1.9128e-01],
         [ 1.9596e-01, -1.6342e-01],
         [-2.0635e-01, -1.7975e-01],
         [-1.8965e-01,  2.2195e-01],
         [-1.4554e-01,  2.3706e-01],
         [-1.5309e-01, -1.7703e-01],
         [-1.6164e-01, -1.6345e-01],
         [-1.8105e-01, -1.6952e-01],
         [-1.9147e-01, -1.5186e-01],
         [-1.4374e-01, -1.3665e-01],
         [-1.4119e-01, -1.5597e-01],
         [-1.0029e-01, -1.6972e-01],
         [-9.6921e-02, -1.7456e-01],
         [-7.6913e-02, -1.6121e-01],
         [ 3.4286e-02, -1.7593e-01],
         [ 4.8491e-02, -1.6885e-01],
         [ 5.2648e-02, -1.5661e-01],
         [ 5.3158e-02, -1.6252e-01],
         [ 5.2547e-02, -1.8105e-01],
         [ 5.1760e-02, -1.7251e-01],
         [ 5.1121e-02, -1.6687e-01],
         [ 5.0658e-02, -1.6563e-01],
         [ 5.0389e-02,  2.3066e-01],
         [ 5.0232e-02, -1.8594e-01],
         [ 5.0121e-02,  2.4383e-01],
         [ 5.0043e-02,  2.2869e-01],
         [ 5.0036e-02,  2.4264e-01],
         [ 5.0026e-02, -1.7882e-01],
         [ 5.0025e-02,  2.3763e-01],
         [ 5.0005e-02, -1.9228e-01],
         [ 5.0005e-02, -1.7313e-01],
         [ 5.0012e-02, -1.6074e-01],
         [ 5.0015e-02, -1.5926e-01],
         [ 5.0016e-02, -1.4929e-01],
         [ 5.0014e-02,  2.3231e-01],
         [ 5.0008e-02,  2.2538e-01],
         [ 5.0007e-02, -1.6132e-01],
         [ 5.0007e-02,  1.3797e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.8723e-02, -2.2603e-02],
         [-8.5616e-02, -2.6778e-02],
         [-7.6670e-02, -4.0458e-02],
         [-1.0203e-01, -4.5799e-02],
         [-9.8907e-02, -5.2703e-02],
         [-1.0422e-01, -5.7515e-02],
         [-7.3542e-02, -5.4559e-02],
         [-6.5304e-02, -4.9985e-02],
         [-4.3495e-02, -4.6738e-02],
         [-5.8266e-02, -4.0279e-02],
         [-6.9759e-02, -5.1785e-02],
         [-7.6102e-02, -6.0525e-02],
         [-5.9654e-02, -8.6192e-02],
         [-7.4937e-02, -6.7622e-02],
         [-8.8789e-02, -5.3675e-02],
         [-7.3633e-02, -6.0735e-02],
         [-1.0614e-01, -6.0493e-02],
         [-1.2537e-01, -6.8724e-02],
         [-1.3632e-01, -8.0725e-02],
         [-1.5050e-01, -8.4976e-02],
         [-1.5304e-01, -9.2829e-02],
         [-1.5039e-01, -1.0045e-01],
         [ 1.9599e-01, -7.2269e-02],
         [ 1.9447e-01, -5.7593e-02],
         [ 2.1436e-01, -5.1313e-02],
         [-1.7687e-01,  1.3236e-01],
         [-1.4642e-01,  1.3988e-01],
         [-1.4063e-01,  1.6933e-01],
         [-1.4251e-01, -1.2600e-01],
         [-1.5788e-01, -1.5539e-01],
         [-1.3332e-01, -1.5437e-01],
         [-1.5667e-01, -1.4869e-01],
         [-1.4694e-01, -1.6631e-01],
         [-1.3625e-01, -1.5515e-01],
         [-1.5305e-01, -1.6891e-01],
         [-1.2797e-01, -1.6925e-01],
         [-1.4319e-01, -1.6796e-01],
         [-2.6794e-02, -1.3901e-01],
         [ 1.2694e-02, -1.0489e-01],
         [ 3.2720e-02, -7.9862e-02],
         [ 4.2500e-02, -7.5181e-02],
         [ 4.7060e-02, -8.3690e-02],
         [ 4.9041e-02, -7.0234e-02],
         [ 4.9831e-02, -6.3753e-02],
         [ 5.0090e-02, -7.5564e-02],
         [ 5.0148e-02, -8.2892e-02],
         [ 5.0123e-02, -8.8456e-02],
         [ 5.0104e-02, -7.1433e-02],
         [ 5.0055e-02, -4.8114e-02],
         [ 5.0053e-02, -5.8183e-02],
         [ 5.0037e-02, -5.6051e-02],
         [ 5.0035e-02, -7.0534e-02],
         [ 5.0018e-02, -8.2622e-02],
         [ 5.0014e-02, -6.0837e-02],
         [ 5.0027e-02, -5.0683e-02],
         [ 5.0014e-02, -3.3868e-02],
         [ 5.0018e-02, -3.4970e-02],
         [ 5.0012e-02, -1.4853e-02],
         [ 5.0009e-02, -4.3108e-03],
         [ 5.0006e-02,  1.9502e-03],
         [ 5.0008e-02,  5.7588e-03],
         [ 5.0007e-02,  8.0655e-03],
         [ 5.0008e-02, -2.9433e-02],
         [ 5.0008e-02, -3.4398e-02],
         [ 5.0008e-02, -6.1095e-02],
         [ 5.0008e-02, -7.4791e-02],
         [ 5.0008e-02, -6.8031e-02],
         [ 5.0008e-02, -5.7201e-02],
         [ 5.0008e-02, -7.2958e-02],
         [ 5.0008e-02, -6.6755e-02],
         [ 5.0009e-02, -7.6582e-02],
         [ 5.0009e-02, -1.2214e-01],
         [ 5.0009e-02, -1.3263e-01],
         [ 5.0009e-02, -1.6802e-01],
         [ 5.0009e-02,  2.2626e-01],
         [ 5.0009e-02, -1.8914e-01],
         [ 5.0009e-02, -1.8022e-01],
         [ 5.0009e-02, -1.9362e-01],
         [ 5.0009e-02, -1.8157e-01],
         [ 5.0009e-02, -1.9242e-01],
         [ 5.0009e-02, -2.0211e-01],
         [ 5.0009e-02, -1.9639e-01],
         [ 5.0009e-02, -1.8180e-01],
         [ 5.0009e-02, -2.0394e-01],
         [ 5.0009e-02,  2.4408e-01],
         [ 5.0009e-02, -2.1377e-01],
         [ 5.0009e-02, -1.8775e-01],
         [ 5.0009e-02, -1.6965e-01],
         [ 5.0009e-02, -1.6599e-01],
         [ 5.0009e-02, -1.8249e-01],
         [ 5.0009e-02, -1.7278e-01],
         [ 5.0009e-02, -1.8329e-01],
         [ 5.0009e-02, -1.7266e-01],
         [ 5.0009e-02,  5.9990e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(7.6649e-05, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(0.6809, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5500, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6656, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0197, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0938, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1450, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2606382.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2441, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.9713e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0011, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3773, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2434, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3773, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6087
target_mac_out tensor([[[[-1.0000e+07, -5.4255e-02,  8.7945e-02,  ...,  2.1998e-02,
            1.2409e-01, -1.0000e+07],
          [-1.0000e+07, -2.5887e-02,  1.2012e-01,  ...,  1.5133e-02,
            1.3440e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.9304e-02,  9.7787e-02,  ...,  1.0265e-02,
            1.3120e-01, -1.0000e+07],
          [-1.0000e+07, -7.0054e-02,  1.5427e-01,  ...,  5.5969e-02,
            1.5234e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1158e-01,  1.2211e-01,  ...,  4.4942e-02,
            1.4958e-01, -1.0000e+07],
          [-1.0000e+07, -9.6173e-02,  1.5735e-01,  ...,  4.8558e-02,
            1.4866e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3070e-01,  1.2391e-01,  ...,  7.1034e-02,
            1.5852e-01, -1.0000e+07],
          [-1.0000e+07, -3.6329e-02,  1.0540e-01,  ..., -2.3505e-02,
            1.3276e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4548e-01,  1.2388e-01,  ...,  5.2184e-02,
            1.5225e-01, -1.0000e+07],
          [-1.0000e+07, -7.9506e-02,  1.4849e-01,  ...,  2.9133e-02,
            1.4592e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5505e-01,  5.1068e-02,  ...,  3.8250e-02,
            2.0122e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5922e-01,  4.2900e-02,  ...,  2.9935e-02,
            1.9831e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.9150e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.4255e-02,  1.2012e-01],
         [-5.9304e-02,  1.5427e-01],
         [ 1.4958e-01,  1.5735e-01],
         [-1.1970e-01,  1.6519e-01],
         [ 1.1544e-01,  1.2899e-01],
         [ 1.2709e-01,  1.7206e-01],
         [ 1.3089e-01, -1.2090e-01],
         [ 1.3118e-01,  1.8306e-01],
         [-1.3298e-01,  1.8783e-01],
         [ 8.2569e-02,  1.9579e-01],
         [ 9.6692e-02,  2.0259e-01],
         [ 1.1493e-01,  2.0119e-01],
         [ 1.2607e-01,  2.0465e-01],
         [ 1.3131e-01, -1.3899e-01],
         [ 1.0119e-01, -1.2619e-01],
         [ 1.0641e-01,  1.9595e-01],
         [ 8.8374e-02, -1.3173e-01],
         [-8.5907e-02, -1.2492e-01],
         [ 1.1136e-01, -1.4157e-01],
         [ 9.3065e-02, -1.2652e-01],
         [ 1.1734e-01, -1.1898e-01],
         [ 9.4134e-02, -9.6623e-02],
         [-8.3177e-02,  1.6461e-02],
         [-5.6482e-02,  3.8956e-02],
         [ 8.8564e-02,  4.9595e-02],
         [-7.7033e-02,  5.3952e-02],
         [ 9.6016e-02,  5.5415e-02],
         [-7.0105e-02,  5.5722e-02],
         [-4.8339e-02,  5.5641e-02],
         [-4.0457e-02,  5.5468e-02],
         [ 8.9098e-02,  5.5340e-02],
         [-3.6497e-02,  5.5281e-02],
         [-3.8676e-02,  5.5239e-02],
         [ 8.5467e-02,  5.5214e-02],
         [-6.8778e-02,  5.5202e-02],
         [-7.7709e-02,  5.5205e-02],
         [ 9.1158e-02,  5.5225e-02],
         [ 7.1131e-02,  5.5202e-02],
         [ 7.6413e-02,  5.5220e-02],
         [ 6.3762e-02,  5.5208e-02],
         [ 8.5481e-02,  5.5211e-02],
         [ 9.6539e-02,  5.5221e-02],
         [ 1.0138e-01,  5.5228e-02],
         [ 1.1896e-01,  5.5232e-02],
         [ 1.2677e-01,  5.5230e-02],
         [ 1.1347e-01,  5.5230e-02],
         [ 1.0402e-01,  5.5231e-02],
         [ 6.9609e-02,  5.5236e-02],
         [ 7.7319e-02,  5.5235e-02],
         [ 7.8823e-02,  5.5232e-02],
         [ 5.9259e-02,  5.5232e-02],
         [ 8.5788e-02,  5.5231e-02],
         [ 6.0981e-02,  5.5231e-02],
         [ 8.6399e-02,  5.5231e-02],
         [ 1.0162e-01,  5.5231e-02],
         [ 1.0932e-01,  5.5231e-02],
         [ 1.0604e-01,  5.5231e-02],
         [ 1.0974e-01,  5.5231e-02],
         [ 9.1073e-02,  5.5231e-02],
         [ 2.2123e-01,  5.5231e-02],
         [ 8.8037e-02,  5.5231e-02],
         [ 1.0904e-01,  5.5231e-02],
         [ 1.2270e-01,  5.5231e-02],
         [ 1.2823e-01,  5.5231e-02],
         [ 1.4643e-01,  5.5231e-02],
         [ 1.0938e-01,  5.5231e-02],
         [ 1.0689e-01,  5.5231e-02],
         [ 1.1591e-01,  5.5231e-02],
         [ 8.9214e-02,  5.5231e-02],
         [ 5.9109e-02,  5.5231e-02],
         [-1.7434e-01,  5.5231e-02],
         [ 8.5118e-02,  5.5231e-02],
         [ 7.5511e-02,  5.5231e-02],
         [ 2.0747e-01,  5.5231e-02],
         [-2.7532e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.4019e-01,  1.0736e-01],
         [ 1.5852e-01,  1.0540e-01],
         [ 1.5225e-01,  1.4849e-01],
         [ 1.6848e-01,  1.1545e-01],
         [ 1.7824e-01,  1.0360e-01],
         [ 1.6804e-01,  1.6212e-01],
         [ 1.6676e-01,  1.3985e-01],
         [ 1.7416e-01,  1.2283e-01],
         [ 1.7650e-01,  1.4214e-01],
         [ 1.8651e-01,  1.6795e-01],
         [ 1.8745e-01,  1.8431e-01],
         [ 1.8152e-01,  1.5073e-01],
         [ 1.7870e-01,  1.3457e-01],
         [ 1.8096e-01,  1.1134e-01],
         [-1.5415e-01,  1.3791e-01],
         [ 1.7460e-01,  1.6636e-01],
         [ 1.7961e-01,  1.3594e-01],
         [ 1.8427e-01,  1.1079e-01],
         [ 1.8764e-01,  1.2379e-01],
         [-1.4367e-01,  8.9738e-02],
         [-1.3986e-01,  4.7128e-02],
         [ 1.5065e-02,  3.7195e-02],
         [ 3.1087e-02,  3.1123e-02],
         [ 4.1229e-02, -5.9451e-02],
         [ 4.6494e-02, -5.6659e-02],
         [ 4.8929e-02,  3.2086e-02],
         [ 4.9845e-02,  7.2299e-02],
         [ 5.0161e-02,  4.9700e-02],
         [ 5.0198e-02,  7.7594e-02],
         [ 5.0164e-02,  6.4016e-02],
         [ 5.0127e-02,  8.3781e-02],
         [ 5.0076e-02,  1.1153e-01],
         [ 5.0043e-02,  7.9167e-02],
         [ 5.0052e-02,  7.6035e-02],
         [ 5.0029e-02,  8.8515e-02],
         [ 5.0036e-02,  6.7258e-02],
         [ 5.0027e-02,  8.0908e-02],
         [ 5.0019e-02,  4.5657e-02],
         [ 5.0025e-02,  7.9332e-02],
         [ 5.0026e-02,  9.3016e-02],
         [ 5.0010e-02,  9.7706e-02],
         [ 5.0020e-02,  5.7490e-02],
         [ 5.0005e-02,  8.6472e-02],
         [ 5.0007e-02,  9.7147e-02],
         [ 5.0008e-02,  6.3430e-02],
         [ 5.0008e-02,  8.5475e-02],
         [ 5.0008e-02,  5.6860e-02],
         [ 5.0009e-02,  4.3634e-02],
         [ 5.0008e-02,  1.9408e-01],
         [ 5.0008e-02,  3.7612e-02],
         [ 5.0008e-02,  7.4572e-02],
         [ 5.0008e-02,  6.8489e-02],
         [ 5.0008e-02,  6.1119e-02],
         [ 5.0009e-02,  5.5672e-02],
         [ 5.0009e-02,  2.0696e-01],
         [ 5.0009e-02,  4.6479e-02],
         [ 5.0009e-02,  6.9029e-02],
         [ 5.0009e-02,  8.4975e-02],
         [ 5.0009e-02,  9.1598e-02],
         [ 5.0009e-02,  7.4213e-02],
         [ 5.0009e-02,  4.1839e-02],
         [ 5.0009e-02,  3.8502e-02],
         [ 5.0009e-02,  7.1914e-02],
         [ 5.0009e-02,  1.0388e-01],
         [ 5.0009e-02,  8.5299e-02],
         [ 5.0009e-02,  9.0344e-02],
         [ 5.0009e-02,  4.6900e-02],
         [ 5.0009e-02,  1.9767e-01],
         [ 5.0009e-02,  6.6682e-02],
         [ 5.0009e-02,  7.9862e-02],
         [ 5.0009e-02,  2.0500e-01],
         [ 5.0009e-02,  1.9406e-01],
         [ 5.0009e-02,  4.5653e-02],
         [ 5.0009e-02,  8.0870e-02],
         [ 5.0009e-02,  1.9739e-01],
         [ 5.0009e-02,  7.1534e-02],
         [ 5.0009e-02,  7.7649e-02],
         [ 5.0009e-02,  8.1230e-02],
         [ 5.0009e-02,  6.0169e-02],
         [ 5.0009e-02,  1.8841e-01],
         [ 5.0009e-02,  2.0700e-01],
         [ 5.0009e-02,  7.6477e-02],
         [ 5.0009e-02,  6.0402e-02],
         [ 5.0009e-02,  2.0761e-01],
         [ 5.0009e-02,  2.0655e-01],
         [ 5.0009e-02,  2.0571e-01],
         [ 5.0009e-02,  1.9706e-01],
         [ 5.0009e-02,  6.9579e-02],
         [ 5.0009e-02,  8.6352e-02],
         [ 5.0009e-02,  5.8278e-02],
         [ 5.0009e-02,  2.0882e-01],
         [ 5.0009e-02,  7.5007e-02],
         [ 5.0009e-02,  8.7675e-02],
         [ 5.0009e-02,  9.3339e-02],
         [ 5.0009e-02,  1.1464e-01],
         [ 5.0009e-02,  6.3624e-02],
         [ 5.0009e-02,  6.6775e-02],
         [ 5.0009e-02,  4.7620e-02],
         [ 5.0009e-02,  2.0335e-01],
         [ 5.0009e-02,  7.1689e-02],
         [ 5.0009e-02,  1.0404e-01],
         [ 5.0009e-02,  1.0427e-01],
         [ 5.0009e-02,  5.8940e-02],
         [ 5.0009e-02,  4.2998e-02],
         [ 5.0009e-02,  4.3363e-02],
         [ 5.0009e-02,  7.5933e-02],
         [ 5.0009e-02,  8.5900e-02],
         [ 5.0009e-02,  1.3334e-01],
         [ 5.0009e-02,  8.9865e-02],
         [ 5.0009e-02,  7.3448e-02],
         [ 5.0009e-02,  9.6982e-02],
         [ 5.0009e-02,  5.9533e-02],
         [ 5.0009e-02,  8.2586e-02],
         [ 5.0009e-02,  7.9531e-02],
         [ 5.0009e-02,  8.8877e-02],
         [ 5.0009e-02,  6.3198e-02],
         [ 5.0009e-02,  5.1944e-02],
         [ 5.0009e-02,  6.4473e-02],
         [ 5.0009e-02,  9.1396e-02],
         [ 5.0009e-02,  8.8900e-02],
         [ 5.0009e-02,  8.9520e-02],
         [ 5.0009e-02,  8.9573e-02],
         [ 5.0009e-02, -1.4103e-01],
         [ 5.0009e-02,  7.2536e-02],
         [ 5.0009e-02,  8.1444e-02],
         [ 5.0009e-02, -1.5050e-01],
         [ 5.0009e-02,  9.0362e-02],
         [ 5.0009e-02,  2.0682e-01],
         [ 5.0009e-02,  2.0122e-01],
         [ 5.0009e-02,  1.9831e-01],
         [ 5.0009e-02,  1.9150e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0001, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0022, device='cuda:0')
mixer_td_error tensor(0.4391, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4504, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8132, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0245, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1038, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1150, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2137404.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2212, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.9877e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0018, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3125, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1608, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3125, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6145
target_mac_out tensor([[[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3070e-01,  1.2391e-01,  ...,  7.1034e-02,
            1.5852e-01, -1.0000e+07],
          [-1.0000e+07, -3.6329e-02,  1.0540e-01,  ..., -2.3505e-02,
            1.3276e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4548e-01,  1.2388e-01,  ...,  5.2184e-02,
            1.5225e-01, -1.0000e+07],
          [-1.0000e+07, -7.9506e-02,  1.4849e-01,  ...,  2.9133e-02,
            1.4592e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5505e-01,  5.1068e-02,  ...,  3.8250e-02,
            2.0122e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5922e-01,  4.2900e-02,  ...,  2.9935e-02,
            1.9831e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.9150e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.7245e-02,  7.9477e-02,  ...,  3.3060e-02,
            1.4031e-01, -1.0000e+07],
          [-1.0000e+07, -1.3393e-02,  1.0346e-01,  ...,  1.0057e-02,
            1.4004e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0827e-01,  1.0736e-01],
         [ 1.2391e-01,  1.0540e-01],
         [ 1.2388e-01,  1.4849e-01],
         [ 1.1120e-01,  1.1545e-01],
         [ 8.1763e-02,  1.0360e-01],
         [ 1.0384e-01,  1.6212e-01],
         [ 1.0730e-01,  1.3985e-01],
         [ 1.2105e-01,  1.2283e-01],
         [ 1.3210e-01,  1.4214e-01],
         [ 1.5162e-01,  1.6795e-01],
         [ 1.6399e-01,  1.8431e-01],
         [ 1.3424e-01,  1.5073e-01],
         [ 1.3556e-01,  1.3457e-01],
         [ 1.2130e-01,  1.1134e-01],
         [ 1.4275e-01,  1.3791e-01],
         [ 5.5784e-02,  1.6636e-01],
         [ 1.4533e-01,  1.3594e-01],
         [ 1.5384e-01,  1.1079e-01],
         [ 1.4967e-01,  1.2379e-01],
         [ 1.3395e-01,  8.9738e-02],
         [ 9.3326e-02,  4.7128e-02],
         [ 1.5065e-02,  3.7195e-02],
         [ 3.1087e-02,  3.1123e-02],
         [ 4.1229e-02,  4.1234e-02],
         [ 4.6494e-02,  2.3417e-02],
         [ 4.8929e-02,  3.2086e-02],
         [ 4.9845e-02,  7.2299e-02],
         [ 5.0161e-02,  4.9700e-02],
         [ 5.0198e-02,  7.7594e-02],
         [ 5.0164e-02,  6.4016e-02],
         [ 5.0127e-02,  8.3781e-02],
         [ 5.0076e-02,  1.1153e-01],
         [ 5.0043e-02,  7.9167e-02],
         [ 5.0052e-02,  7.6035e-02],
         [ 5.0029e-02,  8.8515e-02],
         [ 5.0036e-02,  6.7258e-02],
         [ 5.0027e-02,  8.0908e-02],
         [ 5.0019e-02,  4.5657e-02],
         [ 5.0025e-02,  7.9332e-02],
         [ 5.0026e-02,  9.3016e-02],
         [ 5.0010e-02,  9.7706e-02],
         [ 5.0020e-02,  5.7490e-02],
         [ 5.0005e-02,  8.6472e-02],
         [ 5.0007e-02,  9.7147e-02],
         [ 5.0008e-02,  6.3430e-02],
         [ 5.0008e-02,  8.5475e-02],
         [ 5.0008e-02,  5.6860e-02],
         [ 5.0009e-02,  4.3634e-02],
         [ 5.0008e-02,  3.0384e-02],
         [ 5.0008e-02,  3.7612e-02],
         [ 5.0008e-02,  7.4572e-02],
         [ 5.0008e-02,  6.8489e-02],
         [ 5.0008e-02,  6.1119e-02],
         [ 5.0009e-02,  5.5672e-02],
         [ 5.0009e-02,  3.7676e-02],
         [ 5.0009e-02,  4.6479e-02],
         [ 5.0009e-02,  6.9029e-02],
         [ 5.0009e-02,  8.4975e-02],
         [ 5.0009e-02,  9.1598e-02],
         [ 5.0009e-02,  7.4213e-02],
         [ 5.0009e-02,  4.1839e-02],
         [ 5.0009e-02,  3.8502e-02],
         [ 5.0009e-02,  7.1914e-02],
         [ 5.0009e-02,  1.0388e-01],
         [ 5.0009e-02,  8.5299e-02],
         [ 5.0009e-02,  9.0344e-02],
         [ 5.0009e-02,  4.6900e-02],
         [ 5.0009e-02,  4.2289e-02],
         [ 5.0009e-02,  6.6682e-02],
         [ 5.0009e-02,  7.9862e-02],
         [ 5.0009e-02,  3.3461e-02],
         [ 5.0009e-02,  3.2876e-02],
         [ 5.0009e-02,  4.5653e-02],
         [ 5.0009e-02,  8.0870e-02],
         [ 5.0009e-02,  6.0900e-02],
         [ 5.0009e-02,  7.1534e-02],
         [ 5.0009e-02,  7.7649e-02],
         [ 5.0009e-02,  8.1230e-02],
         [ 5.0009e-02,  6.0169e-02],
         [ 5.0009e-02,  5.0937e-02],
         [ 5.0009e-02,  5.6693e-02],
         [ 5.0009e-02,  7.6477e-02],
         [ 5.0009e-02,  6.0402e-02],
         [ 5.0009e-02,  5.0377e-02],
         [ 5.0009e-02,  4.3616e-02],
         [ 5.0009e-02,  3.8999e-02],
         [ 5.0009e-02,  2.8196e-02],
         [ 5.0009e-02,  6.9579e-02],
         [ 5.0009e-02,  8.6352e-02],
         [ 5.0009e-02,  5.8278e-02],
         [ 5.0009e-02,  4.5538e-02],
         [ 5.0009e-02,  7.5007e-02],
         [ 5.0009e-02,  8.7675e-02],
         [ 5.0009e-02,  9.3339e-02],
         [ 5.0009e-02,  1.1464e-01],
         [ 5.0009e-02,  6.3624e-02],
         [ 5.0009e-02,  6.6775e-02],
         [ 5.0009e-02,  4.7620e-02],
         [ 5.0009e-02,  3.9063e-02],
         [ 5.0009e-02,  7.1689e-02],
         [ 5.0009e-02,  1.0404e-01],
         [ 5.0009e-02,  1.0427e-01],
         [ 5.0009e-02,  5.8940e-02],
         [ 5.0009e-02,  4.2998e-02],
         [ 5.0009e-02,  4.3363e-02],
         [ 5.0009e-02,  7.5933e-02],
         [ 5.0009e-02,  8.5900e-02],
         [ 5.0009e-02,  1.3334e-01],
         [ 5.0009e-02,  8.9865e-02],
         [ 5.0009e-02,  7.3448e-02],
         [ 5.0009e-02,  9.6982e-02],
         [ 5.0009e-02,  5.9533e-02],
         [ 5.0009e-02,  8.2586e-02],
         [ 5.0009e-02,  7.9531e-02],
         [ 5.0009e-02,  8.8877e-02],
         [ 5.0009e-02,  6.3198e-02],
         [ 5.0009e-02,  5.1944e-02],
         [ 5.0009e-02,  6.4473e-02],
         [ 5.0009e-02,  9.1396e-02],
         [ 5.0009e-02,  8.8900e-02],
         [ 5.0009e-02,  8.9520e-02],
         [ 5.0009e-02,  8.9573e-02],
         [ 5.0009e-02,  5.0133e-02],
         [ 5.0009e-02,  7.2536e-02],
         [ 5.0009e-02,  8.1444e-02],
         [ 5.0009e-02,  7.2294e-02],
         [ 5.0009e-02,  9.0362e-02],
         [ 5.0009e-02,  6.5614e-02],
         [ 5.0009e-02,  5.1068e-02],
         [ 5.0009e-02,  4.2900e-02],
         [ 5.0009e-02,  1.9150e-02]],

        [[ 9.6186e-02,  8.7099e-02],
         [ 6.9213e-02,  1.0899e-01],
         [ 3.3060e-02,  1.0346e-01],
         [ 9.4588e-02,  1.3402e-01],
         [ 1.0047e-01,  1.2302e-01],
         [ 6.1462e-02,  1.0085e-01],
         [ 1.0250e-01,  1.1286e-01],
         [ 1.1912e-01,  1.1130e-01],
         [ 1.1392e-01,  1.3568e-01],
         [ 6.7499e-02,  6.8089e-02],
         [ 8.5747e-02,  6.9882e-02],
         [ 1.0806e-01,  7.4106e-02],
         [ 1.0113e-01,  7.7855e-02],
         [ 1.0316e-01,  9.2208e-02],
         [ 1.0721e-01,  1.0173e-01],
         [ 1.2588e-01,  1.0544e-01],
         [ 1.5854e-01,  1.0491e-01],
         [ 1.6941e-01,  6.4716e-02],
         [ 1.8220e-01,  8.7938e-02],
         [ 1.4142e-01,  5.5530e-02],
         [ 1.6643e-01,  1.0031e-01],
         [ 1.2860e-01,  1.1410e-01],
         [ 1.3917e-01,  1.5399e-01],
         [ 1.2308e-01,  1.7211e-01],
         [ 1.1492e-01,  1.5424e-01],
         [ 9.4194e-02,  1.4319e-01],
         [ 7.5796e-02,  8.8144e-02],
         [ 8.9076e-02,  1.2815e-01],
         [ 1.0228e-01,  1.1005e-01],
         [ 1.2923e-01,  1.4497e-01],
         [ 1.4316e-01,  1.3877e-01],
         [ 1.3791e-01,  1.0917e-01],
         [ 1.0510e-01,  1.0033e-01],
         [ 8.6649e-02,  1.4105e-01],
         [ 7.0371e-02,  1.0673e-01],
         [ 1.0227e-01,  8.0218e-02],
         [ 1.2822e-01,  5.1538e-02],
         [ 1.0580e-01,  6.6828e-02],
         [ 1.2761e-01,  4.4473e-02],
         [ 1.6213e-01,  7.8023e-02],
         [ 1.9279e-01,  5.0455e-02],
         [ 9.8371e-02,  4.4637e-02],
         [ 1.5320e-01,  2.9010e-02],
         [ 1.1527e-01,  4.6689e-02],
         [ 1.1486e-01,  5.3856e-02],
         [ 9.8972e-02,  5.6210e-02],
         [ 9.4310e-03,  5.6568e-02],
         [ 1.1824e-01,  5.6340e-02],
         [ 1.2858e-01,  5.5960e-02],
         [ 3.3153e-02,  5.5660e-02],
         [ 1.2935e-01,  5.5416e-02],
         [ 7.7635e-02,  5.5306e-02],
         [ 5.7271e-02,  5.5236e-02],
         [ 1.3882e-01,  5.5216e-02],
         [ 9.8298e-02,  5.5202e-02],
         [ 9.5547e-02,  5.5176e-02],
         [ 1.1643e-01,  5.5217e-02],
         [ 1.1111e-01,  5.5210e-02],
         [ 1.0847e-01,  5.5201e-02],
         [ 1.4190e-01,  5.5195e-02],
         [ 1.5536e-01,  5.5203e-02],
         [ 1.1657e-01,  5.5221e-02],
         [ 6.3624e-02,  5.5229e-02],
         [ 8.6051e-02,  5.5231e-02],
         [ 1.2040e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.4908e-05, device='cuda:0') tensor(0.0008, device='cuda:0') tensor(-0.0021, device='cuda:0')
mixer_td_error tensor(0.6088, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4651, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6342, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0383, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1682, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0917, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2519083.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1928, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.0065e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0013, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2221, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0622, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2221, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6193
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3285e-02,  8.7210e-02,  ..., -7.6795e-03,
            1.4393e-01, -1.0000e+07],
          [-1.0000e+07, -2.8180e-02,  9.9658e-02,  ..., -1.6816e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.7787e-02,  1.0738e-01,  ...,  2.3533e-02,
            1.6867e-01, -1.0000e+07],
          [-1.0000e+07, -4.4595e-02,  1.3244e-01,  ...,  1.5387e-02,
            1.4813e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.9336e-02,  8.9318e-02,  ...,  1.5729e-02,
            1.2882e-01, -1.0000e+07],
          [-1.0000e+07, -2.5640e-02,  8.8110e-02,  ..., -1.8735e-02,
            1.3277e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.6715e-02,  8.6205e-02,  ..., -1.9925e-02,
            1.3653e-01, -1.0000e+07],
          [-1.0000e+07, -1.8158e-02,  9.3029e-02,  ...,  4.9172e-03,
            1.3856e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5429e-01,  7.3930e-02,  ...,  5.5188e-02,
            2.0320e-01, -3.1718e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4585e-01,  3.9728e-02,  ...,  5.0290e-02,
            1.8666e-01, -3.0990e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.1321e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02,  8.7099e-02],
         [ 8.7210e-02,  9.9658e-02],
         [ 1.0738e-01,  1.3244e-01],
         [ 7.5221e-02,  1.4355e-01],
         [ 9.7612e-02,  1.1308e-01],
         [ 2.2154e-02,  1.2102e-01],
         [ 8.8040e-02,  1.0408e-01],
         [ 9.6632e-02,  9.5103e-02],
         [ 8.6911e-02,  1.2263e-01],
         [ 1.0340e-01,  1.3429e-01],
         [ 1.1250e-01,  1.3876e-01],
         [ 1.0342e-01,  1.0098e-01],
         [ 1.1721e-01,  1.1194e-01],
         [ 1.1715e-01,  1.0414e-01],
         [ 1.2416e-01,  1.0393e-01],
         [ 9.7987e-02,  1.3297e-01],
         [ 1.0703e-01,  1.4353e-01],
         [ 1.1177e-01,  1.5086e-01],
         [ 7.6496e-02,  1.2715e-01],
         [ 8.7012e-02,  1.2154e-01],
         [ 2.5881e-02,  1.3398e-01],
         [ 1.1287e-01,  1.4188e-01],
         [ 1.1839e-01,  1.4403e-01],
         [ 1.2848e-01,  1.4622e-01],
         [ 1.3577e-01,  1.1358e-01],
         [ 1.1708e-01,  1.2433e-01],
         [ 1.1622e-01,  1.3479e-01],
         [ 1.2594e-01,  1.0367e-01],
         [ 1.3672e-01,  1.4011e-01],
         [ 1.3945e-01,  1.0720e-01],
         [ 1.3345e-01,  8.5742e-02],
         [ 1.4429e-01,  6.5878e-02],
         [ 1.6871e-01,  1.1576e-01],
         [ 1.7928e-01,  1.1501e-01],
         [ 1.4201e-01,  1.1502e-01],
         [ 1.6930e-01,  5.1797e-02],
         [ 1.6876e-01,  1.2499e-01],
         [ 1.4781e-01,  7.3424e-02],
         [ 1.6017e-01,  9.3732e-02],
         [ 1.4837e-01,  7.2138e-02],
         [ 1.6266e-01,  1.1500e-01],
         [ 1.3614e-01,  1.0015e-01],
         [ 8.0578e-02,  1.3749e-01],
         [ 9.9685e-02,  1.5706e-01],
         [ 1.5857e-01,  1.3301e-01],
         [ 1.7599e-01,  1.0157e-01],
         [ 1.5779e-01,  1.1485e-01],
         [ 1.1818e-01,  7.2016e-02],
         [ 1.6082e-01,  7.5943e-02],
         [ 1.7655e-01,  1.0290e-01],
         [ 1.4868e-01,  9.3577e-02],
         [ 1.7672e-01,  9.9411e-02],
         [ 1.5624e-01,  8.3801e-02],
         [ 1.6534e-01, -1.3791e-01],
         [ 1.1765e-01, -1.2912e-01],
         [ 1.4054e-01, -1.2370e-01],
         [ 1.5154e-01, -1.2845e-01],
         [ 1.2736e-01, -4.8911e-04],
         [ 1.2277e-01,  3.0945e-02],
         [ 8.2251e-02,  4.5791e-02],
         [ 1.1771e-01,  5.2142e-02],
         [ 1.4637e-01,  5.4596e-02],
         [ 1.3131e-01,  5.5345e-02],
         [ 1.1386e-01,  5.5488e-02],
         [ 7.6302e-02,  5.5448e-02],
         [ 1.2176e-01,  5.5342e-02],
         [ 1.2384e-01,  5.5257e-02],
         [ 1.2319e-01,  5.5219e-02],
         [ 7.5162e-02,  5.5185e-02],
         [ 7.5942e-02,  5.5208e-02],
         [ 5.3717e-02,  5.5200e-02],
         [ 8.3192e-02,  5.5184e-02],
         [ 1.3574e-02,  5.5209e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 6.0670e-02,  8.4050e-02],
         [ 8.9318e-02,  8.8110e-02],
         [ 8.6205e-02,  9.3029e-02],
         [ 7.9212e-02,  1.2713e-01],
         [ 8.0252e-02,  1.2305e-01],
         [ 9.7484e-02,  1.2077e-01],
         [ 9.2880e-02,  1.3771e-01],
         [ 9.5995e-02,  1.5641e-01],
         [ 4.8834e-02,  1.0564e-01],
         [ 8.7421e-02,  9.7873e-02],
         [ 9.9203e-02,  5.2959e-02],
         [ 1.2312e-01,  7.6151e-02],
         [ 8.7199e-02,  9.2369e-02],
         [ 7.5175e-02,  1.0030e-01],
         [ 9.6348e-02,  1.0220e-01],
         [ 9.2178e-02,  1.0544e-01],
         [ 6.8007e-02,  1.1686e-01],
         [ 6.2113e-02,  6.2421e-02],
         [ 8.6541e-02,  5.2282e-02],
         [ 8.7112e-02,  8.2918e-02],
         [ 9.9921e-02,  1.3363e-01],
         [ 1.0993e-01,  1.1581e-01],
         [ 1.2497e-01,  1.3996e-01],
         [ 1.2852e-01,  1.7366e-01],
         [ 1.5182e-01,  1.2420e-01],
         [ 7.0343e-02,  1.2131e-01],
         [ 4.2367e-02,  1.3834e-01],
         [ 1.3537e-01,  8.6083e-02],
         [ 1.4646e-01,  9.0422e-02],
         [ 1.5183e-01,  4.8601e-02],
         [ 1.3870e-01,  8.1963e-02],
         [ 1.0022e-01,  5.3132e-02],
         [ 1.1442e-01,  4.1479e-02],
         [ 1.2084e-01,  7.7650e-02],
         [ 1.0825e-01,  8.5983e-02],
         [ 9.0081e-02,  5.8932e-02],
         [-1.3405e-01,  1.1610e-01],
         [-1.3578e-01,  1.1495e-01],
         [-1.7049e-02,  1.0563e-01],
         [ 1.6099e-02,  5.9542e-02],
         [ 3.4188e-02,  5.8138e-02],
         [ 4.3249e-02,  4.7099e-02],
         [ 4.7464e-02,  3.4608e-02],
         [ 4.9250e-02,  3.5742e-02],
         [ 4.9928e-02,  4.6917e-02],
         [ 5.0124e-02,  3.2539e-02],
         [ 5.0152e-02,  4.5092e-02],
         [ 5.0120e-02,  1.8126e-02],
         [ 5.0086e-02,  4.9605e-02],
         [ 5.0056e-02,  7.7738e-02],
         [ 5.0047e-02,  5.9732e-02],
         [ 5.0045e-02,  8.9701e-02],
         [ 5.0049e-02,  9.8494e-02],
         [ 5.0024e-02,  5.7304e-02],
         [ 5.0016e-02,  8.6369e-02],
         [ 5.0020e-02,  5.2779e-02],
         [ 5.0020e-02,  8.7070e-02],
         [ 5.0021e-02,  9.9907e-02],
         [ 5.0015e-02,  5.8307e-02],
         [ 5.0006e-02,  4.6817e-02],
         [ 5.0007e-02,  7.0758e-02],
         [ 5.0007e-02,  4.6055e-02],
         [ 5.0007e-02,  7.3576e-02],
         [ 5.0008e-02,  8.2676e-02],
         [ 5.0008e-02,  8.5264e-02],
         [ 5.0008e-02,  7.2863e-02],
         [ 5.0008e-02,  4.7972e-02],
         [ 5.0008e-02,  4.8439e-02],
         [ 5.0008e-02,  4.2744e-02],
         [ 5.0008e-02,  3.6529e-02],
         [ 5.0009e-02,  7.0522e-02],
         [ 5.0009e-02,  8.6414e-02],
         [ 5.0009e-02,  1.1431e-01],
         [ 5.0009e-02,  6.1123e-02],
         [ 5.0009e-02,  8.6617e-02],
         [ 5.0009e-02,  9.6615e-02],
         [ 5.0009e-02,  6.2950e-02],
         [ 5.0009e-02,  8.5237e-02],
         [ 5.0009e-02,  5.0593e-02],
         [ 5.0009e-02,  6.0193e-02],
         [ 5.0009e-02,  4.3700e-02],
         [ 5.0009e-02,  3.9503e-02],
         [ 5.0009e-02,  3.7729e-02],
         [ 5.0009e-02,  3.4591e-02],
         [ 5.0009e-02,  6.6541e-02],
         [ 5.0009e-02,  8.0043e-02],
         [ 5.0009e-02,  8.6664e-02],
         [ 5.0009e-02,  9.4144e-02],
         [ 5.0009e-02,  9.6911e-02],
         [ 5.0009e-02,  7.7785e-02],
         [ 5.0009e-02,  8.8932e-02],
         [ 5.0009e-02,  1.1184e-01],
         [ 5.0009e-02,  9.1165e-02],
         [ 5.0009e-02,  9.0145e-02],
         [ 5.0009e-02,  1.0665e-01],
         [ 5.0009e-02,  1.2451e-01],
         [ 5.0009e-02,  8.4479e-02],
         [ 5.0009e-02,  1.1127e-01],
         [ 5.0009e-02,  1.1878e-01],
         [ 5.0009e-02,  1.2086e-01],
         [ 5.0009e-02,  1.1097e-01],
         [ 5.0009e-02,  7.3768e-02],
         [ 5.0009e-02,  4.7919e-02],
         [ 5.0009e-02,  7.6856e-02],
         [ 5.0009e-02,  9.0253e-02],
         [ 5.0009e-02,  8.7377e-02],
         [ 5.0009e-02,  7.3930e-02],
         [ 5.0009e-02,  3.9728e-02],
         [ 5.0009e-02,  1.1321e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.1839e-05, device='cuda:0') tensor(0.0008, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.3945, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4946, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4915, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0474, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1853, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0719, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1651375.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1793, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.7231e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1655, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1923, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1655, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6264
target_mac_out tensor([[[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.9336e-02,  8.9318e-02,  ...,  1.5729e-02,
            1.2882e-01, -1.0000e+07],
          [-1.0000e+07, -2.5640e-02,  8.8110e-02,  ..., -1.8735e-02,
            1.3277e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1056e-02,  1.1443e-01,  ...,  3.4915e-02,
            1.5353e-01, -1.0000e+07],
          [-1.0000e+07, -4.0997e-02,  1.1804e-01,  ...,  1.4397e-02,
            1.5161e-01, -1.0000e+07]],

         ...,

         [[ 5.0018e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3078e-01,  6.4518e-02,  ...,  5.7182e-02,
            1.8752e-01, -3.1153e-01]],

         [[ 5.0012e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5229e-01,  8.0086e-02,  ...,  7.9997e-02,
            2.0084e-01, -3.1993e-01]],

         [[ 5.0006e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.6862e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3285e-02,  8.7210e-02,  ..., -7.6795e-03,
            1.4393e-01, -1.0000e+07],
          [-1.0000e+07, -2.8180e-02,  9.9658e-02,  ..., -1.6816e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5860e-02,  1.0411e-01,  ...,  2.0191e-02,
            1.7078e-01, -1.0000e+07],
          [-1.0000e+07, -2.5520e-02,  1.0800e-01,  ...,  9.6872e-03,
            1.3684e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.0670e-02,  8.4050e-02],
         [ 8.9318e-02,  8.8110e-02],
         [ 1.1443e-01,  1.1804e-01],
         [ 9.9871e-02,  1.5258e-01],
         [ 9.3312e-02,  1.2726e-01],
         [ 1.0249e-01,  1.5020e-01],
         [ 8.5627e-02,  1.2289e-01],
         [ 7.7340e-02,  1.1034e-01],
         [ 9.1141e-02,  8.6120e-02],
         [ 9.5139e-02,  1.0410e-01],
         [ 9.6406e-02,  1.0702e-01],
         [ 1.0284e-01,  1.1568e-01],
         [ 1.2928e-01,  1.4971e-01],
         [ 1.1487e-01,  1.0543e-01],
         [ 1.2525e-01,  9.0735e-02],
         [ 9.8526e-02,  1.2577e-01],
         [ 1.3629e-01,  1.3224e-01],
         [ 1.3674e-01,  1.2695e-01],
         [ 1.4387e-01,  9.7083e-02],
         [ 1.5810e-01,  1.1503e-01],
         [ 1.3498e-01,  8.7541e-02],
         [ 1.4848e-01,  1.4187e-01],
         [ 1.8579e-01,  1.0893e-01],
         [ 1.8370e-01,  1.1060e-01],
         [ 1.8259e-01,  1.2024e-01],
         [ 1.4778e-01,  1.4804e-01],
         [ 1.4604e-01,  1.3924e-01],
         [ 1.5511e-01,  1.0351e-01],
         [ 1.4339e-01,  1.5043e-01],
         [ 1.2689e-01,  1.4078e-01],
         [ 1.4425e-01,  9.3116e-02],
         [ 1.6291e-01,  7.0636e-02],
         [ 1.7610e-01,  7.7270e-02],
         [ 1.7684e-01,  9.7497e-02],
         [-2.3915e-02,  6.9492e-02],
         [ 1.3968e-02,  3.5149e-02],
         [ 3.3473e-02,  6.9898e-02],
         [ 4.3011e-02,  4.8498e-02],
         [ 4.7409e-02,  9.4322e-02],
         [ 4.9303e-02,  1.0161e-01],
         [ 5.0036e-02,  1.1318e-01],
         [ 5.0220e-02,  1.2739e-01],
         [ 5.0249e-02,  8.5531e-02],
         [ 5.0166e-02,  7.0895e-02],
         [ 5.0125e-02,  1.0482e-01],
         [ 5.0075e-02,  7.3267e-02],
         [ 5.0058e-02,  4.9759e-02],
         [ 5.0032e-02,  8.0909e-02],
         [ 5.0030e-02,  1.0022e-01],
         [ 5.0018e-02,  5.1128e-02],
         [ 5.0011e-02,  7.6678e-02],
         [ 5.0027e-02,  7.3465e-02],
         [ 5.0014e-02,  6.7983e-02],
         [ 5.0018e-02, -1.3078e-01],
         [ 5.0012e-02,  8.0086e-02],
         [ 5.0006e-02,  2.6862e-02]],

        [[ 9.6186e-02,  8.7099e-02],
         [ 8.7210e-02,  9.9658e-02],
         [ 1.0411e-01,  1.0800e-01],
         [ 8.4719e-02,  1.1353e-01],
         [ 1.1527e-01,  1.1500e-01],
         [ 1.3986e-01,  1.3945e-01],
         [ 1.5921e-01,  1.2947e-01],
         [ 1.8385e-01,  1.5109e-01],
         [ 1.9812e-01,  1.6420e-01],
         [ 2.0879e-01,  1.3194e-01],
         [ 2.1005e-01,  1.7221e-01],
         [ 6.9272e-02,  1.1014e-01],
         [ 1.7339e-01,  1.4619e-01],
         [ 1.6457e-01,  1.7519e-01],
         [ 1.6330e-01,  1.9288e-01],
         [ 1.4416e-01,  1.9414e-01],
         [ 1.3343e-01,  1.8718e-01],
         [ 1.1781e-01,  1.0292e-01],
         [ 1.5939e-01,  1.1416e-01],
         [ 1.3005e-01,  7.5181e-02],
         [ 1.7852e-01,  1.0041e-01],
         [ 1.3769e-01,  7.2487e-02],
         [ 1.5594e-01,  1.0584e-01],
         [ 1.2068e-01,  1.1093e-01],
         [ 1.0612e-01,  1.1869e-01],
         [ 6.7176e-02,  8.0068e-02],
         [ 9.5707e-02,  1.0542e-01],
         [ 6.7872e-02,  1.1147e-01],
         [ 9.8581e-02,  9.3722e-02],
         [ 7.0509e-02,  2.4951e-01],
         [ 7.4457e-02,  2.3845e-01],
         [ 1.0869e-01,  2.3487e-01],
         [ 1.3879e-01,  2.1938e-01],
         [ 1.6416e-01, -1.6333e-01],
         [ 1.7761e-01, -1.4853e-01],
         [ 1.7199e-01, -3.1680e-03],
         [ 1.8096e-01,  3.0600e-02],
         [ 1.9578e-01,  4.5776e-02],
         [ 1.8672e-01,  5.2215e-02],
         [ 2.0169e-01,  5.4716e-02],
         [ 2.0767e-01,  5.5529e-02],
         [ 1.6171e-01,  5.5666e-02],
         [ 1.9383e-01,  5.5585e-02],
         [ 1.8742e-01,  5.5473e-02],
         [ 1.4716e-01,  5.5392e-02],
         [ 1.3056e-01,  5.5314e-02],
         [ 1.5688e-01,  5.5237e-02],
         [ 1.7954e-01,  5.5227e-02],
         [ 1.3839e-01,  5.5213e-02],
         [ 1.7126e-01,  5.5235e-02],
         [ 1.2922e-01,  5.5220e-02],
         [ 1.3455e-02,  5.5202e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(8.0916e-06, device='cuda:0') tensor(0.0028, device='cuda:0') tensor(-0.0036, device='cuda:0')
mixer_td_error tensor(0.0905, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4666, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8557, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0673, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2050, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0657, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-357142.7812, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2495, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0031, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2718, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1678, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2718, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6316
target_mac_out tensor([[[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.1908e-02,  7.1628e-02,  ...,  3.0978e-03,
            1.2913e-01, -1.0000e+07],
          [-1.0000e+07, -3.1400e-02,  1.4762e-01,  ...,  2.0198e-03,
            1.5187e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7357e-02,  7.2546e-02,  ..., -1.2115e-02,
            1.4121e-01, -1.0000e+07],
          [-1.0000e+07, -3.8792e-02,  1.6292e-01,  ..., -7.4744e-03,
            1.6052e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6666e-01,  6.7277e-02,  ...,  4.2074e-02,
            1.2994e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.5088e-01,  4.7743e-02,  ...,  4.6411e-02,
            1.1840e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.2708e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.3745e-02,  1.1397e-01,  ...,  6.2087e-02,
            1.3778e-01, -1.0000e+07],
          [-1.0000e+07, -2.4539e-02,  9.4233e-02,  ..., -1.0851e-02,
            1.2427e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.7459e-02,  9.8722e-02,  ...,  1.3931e-02,
            1.3959e-01, -1.0000e+07],
          [-1.0000e+07, -6.3419e-02,  1.4570e-01,  ...,  3.8138e-02,
            1.4407e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0222e-01,  1.1143e-01,  ...,  1.4510e-02,
            1.5951e-01, -1.0000e+07],
          [-1.0000e+07, -9.0719e-02,  1.6389e-01,  ...,  6.4728e-02,
            1.5741e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.2098e-02,  1.2351e-01],
         [ 7.1628e-02,  1.4762e-01],
         [ 7.2546e-02,  1.6292e-01],
         [ 1.0148e-01,  8.1967e-02],
         [ 9.0296e-02,  1.3629e-01],
         [ 1.0358e-01,  8.7815e-02],
         [ 1.3922e-01,  4.5473e-02],
         [ 1.5520e-01,  8.0131e-02],
         [ 1.6333e-01,  5.8460e-02],
         [ 1.7725e-01,  8.5128e-02],
         [ 1.3784e-01,  6.9594e-02],
         [ 1.3400e-01,  8.7540e-02],
         [ 1.0676e-01,  4.5903e-02],
         [ 9.0998e-02,  8.1933e-02],
         [ 1.0499e-01,  9.9977e-02],
         [ 1.1099e-01,  1.3375e-01],
         [ 1.1279e-01,  1.5824e-01],
         [ 1.1430e-01,  1.3294e-01],
         [ 1.1755e-01,  1.6139e-01],
         [ 1.0673e-01,  1.3278e-01],
         [ 9.2436e-02,  1.5743e-01],
         [ 6.2343e-02,  1.6295e-01],
         [-8.6336e-02,  1.2947e-01],
         [ 8.6210e-02,  1.4200e-01],
         [ 1.1339e-01,  1.0826e-01],
         [ 1.2281e-01,  1.2325e-01],
         [ 1.2728e-01,  1.5667e-01],
         [ 9.9314e-02,  1.5379e-01],
         [ 1.2422e-01,  9.8922e-02],
         [ 1.4286e-01,  7.7782e-02],
         [ 1.2072e-01,  6.2780e-02],
         [ 1.4590e-01,  5.5886e-02],
         [ 1.5875e-01,  6.3887e-02],
         [ 1.2778e-01,  9.9482e-02],
         [ 1.4217e-01,  8.3467e-02],
         [ 1.5344e-01,  7.3941e-02],
         [ 1.5482e-01, -9.2338e-03],
         [ 1.5599e-01,  9.9465e-02],
         [ 1.5403e-01,  8.0141e-02],
         [ 1.5243e-01,  1.1265e-01],
         [ 1.4938e-01,  8.6938e-02],
         [ 1.2706e-01,  1.1020e-01],
         [ 1.2503e-01,  1.3384e-01],
         [ 1.2814e-01,  1.3438e-01],
         [ 1.4334e-01,  1.0204e-01],
         [ 1.2434e-01,  9.0019e-02],
         [ 1.5214e-01,  8.3208e-02],
         [ 1.2740e-01,  8.0371e-02],
         [ 1.3035e-01,  6.8419e-02],
         [ 1.2618e-01,  1.0385e-01],
         [ 1.4117e-01,  8.6160e-02],
         [ 1.3474e-01,  1.1467e-01],
         [ 1.4109e-01,  1.3047e-01],
         [ 1.5707e-01,  1.3829e-01],
         [ 1.2882e-01,  9.7761e-02],
         [ 1.1123e-01,  9.7162e-02],
         [ 1.3704e-01,  1.1798e-01],
         [ 1.2698e-01,  9.7955e-02],
         [ 1.4222e-01,  8.5284e-02],
         [ 1.4209e-01,  1.2096e-01],
         [ 1.1797e-01,  9.5788e-02],
         [ 1.4616e-01,  1.1879e-01],
         [ 1.3627e-01,  1.3409e-01],
         [ 1.5640e-01,  9.3052e-02],
         [ 1.5776e-01,  8.9948e-02],
         [ 1.5448e-01,  1.1217e-01],
         [ 1.5636e-01,  1.2394e-01],
         [ 1.5875e-01,  1.3002e-01],
         [ 1.3190e-01,  1.0101e-01],
         [ 1.5792e-01,  8.3048e-02],
         [ 1.6727e-01,  7.1049e-02],
         [ 1.7752e-01,  6.2917e-02],
         [ 1.8903e-01,  9.7067e-02],
         [ 1.8810e-01,  1.0800e-01],
         [ 1.8029e-01,  6.4629e-02],
         [ 1.7282e-01,  4.5136e-02],
         [ 1.6848e-01,  7.6969e-02],
         [ 1.3929e-01,  6.2918e-02],
         [ 1.7132e-01,  9.5625e-02],
         [ 1.6232e-01,  1.1023e-01],
         [ 1.7734e-01,  1.1688e-01],
         [ 1.3139e-01,  6.0743e-02],
         [ 1.1768e-01,  7.6213e-02],
         [ 1.2347e-01,  8.8764e-02],
         [ 1.0153e-01,  9.6090e-02],
         [ 5.2038e-02,  9.8768e-02],
         [ 6.8662e-02,  6.0680e-02],
         [ 5.6812e-02,  5.6632e-02],
         [ 9.2789e-02,  3.2492e-02],
         [ 6.4290e-02,  7.4602e-02],
         [ 4.1622e-02,  5.0010e-02],
         [ 5.9600e-02,  8.9831e-02],
         [ 1.2247e-01,  7.6247e-02],
         [ 1.1558e-01,  8.3153e-02],
         [ 7.6349e-02,  8.4992e-02],
         [ 1.2031e-01,  1.0666e-01],
         [ 1.3138e-01,  1.0542e-01],
         [ 1.3206e-01,  7.9696e-02],
         [ 1.5497e-01,  4.9755e-02],
         [ 1.6355e-01,  7.5160e-02],
         [ 1.2585e-01,  7.7119e-02],
         [ 1.4998e-01,  8.5199e-02],
         [ 1.5832e-01,  6.4501e-02],
         [ 1.4427e-01,  3.5653e-02],
         [ 1.6025e-01,  2.7479e-02],
         [ 1.4561e-01,  6.1700e-02],
         [ 1.5942e-01,  4.2482e-02],
         [ 1.6564e-01,  8.1041e-02],
         [ 1.4706e-01,  9.5415e-02],
         [ 1.6831e-01,  1.2742e-01],
         [ 1.4852e-01,  1.0659e-01],
         [ 1.1419e-01,  9.6575e-02],
         [ 1.2630e-01,  9.8754e-02],
         [ 1.5329e-01,  1.3765e-01],
         [ 1.2278e-01,  1.1733e-01],
         [ 9.2013e-02,  1.4003e-01],
         [ 1.3007e-01,  1.6316e-01],
         [ 1.8052e-01,  1.3186e-01],
         [ 1.9230e-01,  1.0123e-01],
         [ 2.0304e-01,  1.1761e-01],
         [ 2.2267e-01,  1.0482e-01],
         [ 1.7576e-01,  9.4810e-02],
         [ 1.5637e-01,  9.2563e-02],
         [ 1.4828e-01,  9.2952e-02],
         [ 1.7760e-01,  1.3918e-01],
         [ 1.9990e-01,  1.1354e-01],
         [ 1.6392e-01,  1.3301e-01],
         [ 1.8377e-01,  1.5528e-01],
         [ 1.9061e-01,  1.6181e-01],
         [ 1.6260e-01,  1.6860e-01],
         [ 1.3200e-01, -1.1161e-01],
         [ 1.4028e-01, -9.5706e-02],
         [ 1.0372e-01, -6.5637e-03],
         [ 1.1430e-01,  3.0356e-02],
         [ 1.4587e-01,  4.6682e-02],
         [ 1.1518e-01,  5.3259e-02],
         [ 1.1905e-01,  5.5532e-02],
         [ 1.1289e-01,  5.6072e-02],
         [ 1.1163e-01,  5.5997e-02],
         [ 1.1215e-01,  5.5767e-02],
         [ 7.3656e-02,  5.5556e-02],
         [ 9.8693e-02,  5.5411e-02],
         [ 1.2663e-01,  5.5299e-02],
         [ 1.3750e-01,  5.5256e-02],
         [ 9.2181e-02,  5.5219e-02],
         [ 7.2079e-02,  5.5217e-02],
         [ 1.0030e-01,  5.5210e-02],
         [ 1.2360e-01,  5.5206e-02],
         [ 1.1400e-01,  5.5215e-02],
         [ 1.6166e-01,  5.5219e-02],
         [ 1.8111e-01,  5.5211e-02],
         [ 1.3334e-01,  5.5217e-02],
         [ 8.0508e-02,  5.5223e-02],
         [ 1.1653e-01,  5.5232e-02],
         [ 1.3384e-01,  5.5230e-02],
         [ 1.5766e-01,  5.5230e-02],
         [ 1.8700e-01,  5.5231e-02],
         [ 1.8438e-01,  5.5236e-02],
         [ 1.4085e-01,  5.5235e-02],
         [ 1.3668e-01,  5.5232e-02],
         [ 8.9249e-02,  5.5232e-02],
         [ 1.0725e-01,  5.5231e-02],
         [ 7.7874e-02,  5.5231e-02],
         [ 1.0312e-01,  5.5231e-02],
         [ 8.6308e-02,  5.5231e-02],
         [ 1.0921e-01,  5.5231e-02],
         [ 1.0841e-01,  5.5231e-02],
         [ 1.1240e-01,  5.5231e-02],
         [ 1.1658e-01,  5.5231e-02],
         [ 1.1827e-01,  5.5231e-02],
         [ 1.1759e-01,  5.5231e-02],
         [ 6.7277e-02,  5.5231e-02],
         [-1.5088e-01,  5.5231e-02],
         [ 3.2708e-02,  5.5231e-02]],

        [[ 1.1397e-01,  9.4233e-02],
         [ 9.8722e-02,  1.4570e-01],
         [ 1.1143e-01,  1.6389e-01],
         [ 1.3586e-01,  1.7871e-01],
         [ 1.4687e-01,  1.8179e-01],
         [ 1.5585e-01,  1.4926e-01],
         [ 1.4400e-01,  1.3019e-01],
         [ 1.3895e-01,  1.3914e-01],
         [ 1.1510e-01,  1.5959e-01],
         [ 1.4274e-01,  1.6537e-01],
         [ 1.4816e-01,  1.5004e-01],
         [ 1.1324e-01,  1.5712e-01],
         [ 9.8118e-02,  1.5338e-01],
         [ 1.2477e-01,  1.4664e-01],
         [ 1.3309e-01,  1.5508e-01],
         [ 1.3092e-01,  1.2094e-01],
         [ 9.1389e-02,  1.3626e-01],
         [ 6.8309e-02, -1.2344e-01],
         [ 8.8464e-02,  1.2488e-01],
         [ 7.6859e-02,  1.1966e-01],
         [ 1.1995e-01,  1.1632e-01],
         [ 1.3344e-01,  9.7680e-02],
         [ 1.4191e-01,  1.3203e-01],
         [ 1.0639e-01,  1.0285e-01],
         [ 1.4119e-01,  1.0939e-01],
         [ 1.1021e-01,  1.3258e-01],
         [ 1.3964e-01,  1.4360e-01],
         [ 1.5788e-01,  1.1475e-01],
         [ 1.3786e-01,  1.2930e-01],
         [ 1.4924e-01,  1.4228e-01],
         [ 1.5448e-01,  1.2233e-01],
         [ 1.5518e-01,  1.0699e-01],
         [ 1.3310e-01,  1.3047e-01],
         [ 1.5171e-01,  1.0209e-01],
         [ 1.3595e-01,  3.4605e-03],
         [ 9.9990e-02,  3.3985e-02],
         [ 1.2957e-01,  4.7351e-02],
         [ 1.0111e-01,  5.2776e-02],
         [ 1.1923e-01,  5.4770e-02],
         [ 1.3168e-01,  5.5340e-02],
         [ 1.2891e-01,  5.5415e-02],
         [ 9.9288e-02,  5.5387e-02],
         [ 9.6720e-02,  5.5311e-02],
         [-1.7224e-01,  5.5234e-02],
         [-1.6971e-01,  5.5215e-02],
         [-7.9893e-03,  5.5204e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.8153e-06, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.9084, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4632, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7931, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0715, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2304, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0282, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3678160.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2227, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.6192e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1390, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2725, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1390, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6425
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9711e-02,  8.6010e-02,  ...,  5.5065e-03,
            1.3727e-01, -1.0000e+07],
          [-1.0000e+07, -4.5321e-02,  1.0753e-01,  ...,  3.5616e-02,
            1.4810e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.8586e-02,  7.7246e-02,  ..., -1.5416e-02,
            1.4423e-01, -1.0000e+07],
          [-1.0000e+07, -7.5122e-02,  1.5329e-01,  ...,  6.1145e-02,
            1.5160e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6433e-01,  9.7892e-02,  ...,  2.8258e-02,
            1.4259e-01, -3.1301e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7204e-01,  7.2450e-02,  ...,  3.8370e-02,
            1.4430e-01, -3.1364e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.1153e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.9336e-02,  8.9318e-02,  ...,  1.5729e-02,
            1.2882e-01, -1.0000e+07],
          [-1.0000e+07, -2.5640e-02,  8.8110e-02,  ..., -1.8735e-02,
            1.3277e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1056e-02,  1.1443e-01,  ...,  3.4915e-02,
            1.5353e-01, -1.0000e+07],
          [-1.0000e+07, -4.0997e-02,  1.1804e-01,  ...,  1.4397e-02,
            1.5161e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.4276e-02,  1.4162e-01],
         [ 8.6010e-02,  1.0753e-01],
         [ 7.7246e-02,  1.5329e-01],
         [ 1.0076e-01,  1.3148e-01],
         [ 1.0388e-01,  1.4759e-01],
         [ 7.9082e-02,  1.1312e-01],
         [-7.7937e-02,  1.5570e-01],
         [ 6.4117e-02,  1.3358e-01],
         [ 1.0653e-01,  1.5320e-01],
         [ 9.6934e-02,  1.2994e-01],
         [ 9.1760e-02,  1.3363e-01],
         [ 1.0493e-01,  1.1379e-01],
         [ 1.0353e-01,  1.4016e-01],
         [ 7.4906e-02,  1.6199e-01],
         [ 1.0925e-01,  1.5031e-01],
         [ 7.8066e-02,  1.4431e-01],
         [ 9.8661e-02, -1.3729e-01],
         [ 1.1791e-01, -1.2779e-01],
         [ 1.1777e-01, -1.2437e-01],
         [ 1.2904e-01, -1.3354e-01],
         [ 1.3727e-01, -1.1966e-01],
         [ 1.5609e-01, -1.2379e-01],
         [ 1.6293e-01, -1.1847e-01],
         [ 1.1898e-01, -2.5146e-05],
         [ 1.3153e-01,  3.0002e-02],
         [ 1.0374e-01,  4.5015e-02],
         [ 6.8968e-02,  5.1843e-02],
         [ 7.3870e-02,  5.4623e-02],
         [ 6.3494e-02,  5.5590e-02],
         [ 1.0763e-01,  5.5764e-02],
         [ 8.0693e-02,  5.5709e-02],
         [ 6.5622e-02,  5.5519e-02],
         [ 8.5846e-02,  5.5416e-02],
         [ 9.5371e-02,  5.5326e-02],
         [ 1.0704e-01,  5.5294e-02],
         [ 1.0364e-01,  5.5259e-02],
         [ 7.1136e-02,  5.5208e-02],
         [ 7.9778e-02,  5.5235e-02],
         [ 8.9420e-02,  5.5219e-02],
         [ 1.0514e-01,  5.5214e-02],
         [ 5.9164e-02,  5.5201e-02],
         [ 6.8162e-02,  5.5219e-02],
         [ 1.0094e-01,  5.5223e-02],
         [ 8.9426e-02,  5.5231e-02],
         [ 9.2179e-02,  5.5231e-02],
         [ 7.8348e-02,  5.5230e-02],
         [ 9.8602e-02,  5.5231e-02],
         [ 1.0804e-01,  5.5232e-02],
         [ 1.2502e-01,  5.5236e-02],
         [ 1.3312e-01,  5.5236e-02],
         [ 1.3634e-01,  5.5232e-02],
         [ 1.2766e-01,  5.5232e-02],
         [ 1.2473e-01,  5.5231e-02],
         [ 1.0027e-01,  5.5231e-02],
         [ 1.0140e-01,  5.5231e-02],
         [ 8.8376e-02,  5.5231e-02],
         [ 9.1831e-02,  5.5231e-02],
         [ 8.9081e-02,  5.5231e-02],
         [ 8.3242e-02,  5.5231e-02],
         [ 9.7892e-02,  5.5231e-02],
         [ 7.2450e-02,  5.5231e-02],
         [ 2.1153e-02,  5.5231e-02]],

        [[ 6.0670e-02,  8.4050e-02],
         [ 8.9318e-02,  8.8110e-02],
         [ 1.1443e-01,  1.1804e-01],
         [ 9.9871e-02,  1.5258e-01],
         [ 9.3312e-02,  1.2726e-01],
         [ 1.0249e-01,  1.5020e-01],
         [ 8.5627e-02,  1.2289e-01],
         [ 7.7340e-02,  1.1034e-01],
         [ 9.1141e-02,  8.6120e-02],
         [ 9.5139e-02,  1.0410e-01],
         [ 9.6406e-02,  1.0702e-01],
         [ 1.0284e-01,  1.1568e-01],
         [ 1.2928e-01,  1.4971e-01],
         [ 1.1487e-01,  1.0543e-01],
         [ 1.2525e-01,  9.0735e-02],
         [ 9.8526e-02,  1.2577e-01],
         [ 1.3629e-01,  1.3224e-01],
         [ 1.3674e-01,  1.2695e-01],
         [ 1.4387e-01,  9.7083e-02],
         [ 1.5810e-01,  1.1503e-01],
         [ 7.8964e-02,  8.7541e-02],
         [ 1.4848e-01,  1.4187e-01],
         [ 1.8579e-01,  1.0893e-01],
         [ 1.8370e-01,  1.1060e-01],
         [ 1.8259e-01,  1.2024e-01],
         [ 1.4778e-01,  1.4804e-01],
         [ 1.4604e-01,  1.3924e-01],
         [ 1.5511e-01,  1.0351e-01],
         [ 1.4339e-01,  1.5043e-01],
         [-1.3298e-01,  1.4078e-01],
         [-1.2643e-01,  9.3116e-02],
         [ 1.6291e-01,  7.0636e-02],
         [ 1.7610e-01,  7.7270e-02],
         [ 1.7684e-01,  9.7497e-02],
         [-2.3915e-02,  6.9492e-02],
         [ 1.3968e-02,  3.5149e-02],
         [ 3.3473e-02,  6.9898e-02],
         [ 4.3011e-02,  4.8498e-02],
         [ 4.7409e-02,  9.4322e-02],
         [ 4.9303e-02,  1.0161e-01],
         [ 5.0036e-02,  1.1318e-01],
         [ 5.0220e-02,  1.2739e-01],
         [ 5.0249e-02,  8.5531e-02],
         [ 5.0166e-02,  7.0895e-02],
         [ 5.0125e-02,  1.0482e-01],
         [ 5.0075e-02,  7.3267e-02],
         [ 5.0058e-02,  4.9759e-02],
         [ 5.0032e-02,  8.0909e-02],
         [ 5.0030e-02,  1.0022e-01],
         [ 5.0018e-02,  5.1128e-02],
         [ 5.0011e-02, -1.2902e-01],
         [ 5.0027e-02,  7.3465e-02],
         [ 5.0014e-02, -1.2574e-01],
         [ 5.0018e-02, -1.3078e-01],
         [ 5.0012e-02,  8.0086e-02],
         [ 5.0006e-02,  2.6862e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.8035e-05, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.1197, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4660, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3709, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0804, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1992, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0306, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-483870.7812, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1858, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.3612e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1161, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2745, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1161, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6495
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6085e-02,  1.0713e-01,  ...,  2.0049e-02,
            1.6247e-01, -1.0000e+07],
          [-1.0000e+07, -1.6729e-02,  1.0948e-01,  ...,  2.6640e-03,
            1.2965e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3875e-02,  8.8061e-02,  ..., -8.4055e-03,
            1.5805e-01, -1.0000e+07],
          [-1.0000e+07, -3.6246e-02,  1.0894e-01,  ..., -3.0980e-02,
            1.3536e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.1908e-02,  7.1628e-02,  ...,  3.0978e-03,
            1.2913e-01, -1.0000e+07],
          [-1.0000e+07, -3.1400e-02,  1.4762e-01,  ...,  2.0198e-03,
            1.5187e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7357e-02,  7.2546e-02,  ..., -1.2115e-02,
            1.4121e-01, -1.0000e+07],
          [-1.0000e+07, -3.8792e-02,  1.6292e-01,  ..., -7.4744e-03,
            1.6052e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6666e-01,  6.7277e-02,  ...,  4.2074e-02,
            1.2994e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.5088e-01,  4.7743e-02,  ...,  4.6411e-02,
            1.1840e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.2708e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02,  8.7099e-02],
         [ 1.0713e-01,  1.0948e-01],
         [ 8.8061e-02,  1.0894e-01],
         [-9.4762e-02,  1.1901e-01],
         [-8.3479e-02,  6.9988e-02],
         [ 7.8029e-02, -4.0782e-02],
         [ 1.0628e-01,  4.0664e-02],
         [ 1.5289e-01,  5.2002e-02],
         [ 1.0786e-01,  7.5493e-02],
         [ 8.7930e-02,  3.4559e-02],
         [ 8.7067e-02,  1.1907e-01],
         [ 1.1051e-01,  1.5141e-01],
         [ 1.1411e-01,  1.6509e-01],
         [ 1.2271e-01,  1.6682e-01],
         [ 1.2024e-01,  1.6277e-01],
         [ 1.1130e-01,  1.6612e-01],
         [ 4.8126e-02,  1.2394e-01],
         [ 7.4310e-02,  1.0649e-01],
         [ 6.4487e-02,  1.4207e-01],
         [ 8.3813e-02,  1.5596e-01],
         [ 1.1534e-01,  1.2716e-01],
         [ 8.6700e-02,  1.1264e-01],
         [ 1.1286e-01,  1.2427e-01],
         [ 1.2074e-01,  1.1945e-01],
         [ 1.2001e-01,  1.6221e-01],
         [ 1.4057e-01,  1.8054e-01],
         [ 1.3404e-01,  1.7876e-01],
         [ 8.2030e-02,  1.4613e-01],
         [ 8.3591e-02,  1.0518e-01],
         [ 7.6843e-02,  1.3002e-01],
         [ 1.0854e-01,  1.2694e-01],
         [ 1.3098e-01,  1.0314e-01],
         [ 1.3012e-01,  1.2926e-01],
         [ 7.8268e-02,  1.3888e-01],
         [ 1.3104e-01,  1.4288e-01],
         [ 1.1995e-01,  1.3116e-01],
         [ 1.0989e-01,  1.0507e-01],
         [ 5.9633e-02,  1.5734e-01],
         [ 7.5788e-02,  1.3776e-01],
         [ 9.2760e-02,  1.1786e-01],
         [ 1.1007e-01,  9.1714e-02],
         [ 1.3964e-01,  6.0981e-02],
         [ 1.0639e-01,  9.0206e-02],
         [ 1.3396e-01,  7.1427e-02],
         [ 1.0815e-01,  7.0678e-02],
         [ 9.8372e-02,  9.8736e-02],
         [ 1.2186e-01,  9.0344e-02],
         [ 7.0507e-02,  8.9243e-02],
         [ 6.3981e-02, -1.3366e-01],
         [ 9.1739e-02, -1.1579e-01],
         [ 1.0728e-01,  1.1503e-01],
         [ 6.0738e-02,  9.1512e-02],
         [ 9.6498e-02,  1.2369e-01],
         [ 5.7662e-02,  1.0658e-01],
         [ 8.8447e-02,  5.8208e-02],
         [ 9.2699e-02,  6.6659e-02],
         [ 9.6148e-02,  7.1523e-02],
         [ 8.2403e-02,  2.1170e-01],
         [ 7.6061e-02,  6.0023e-02],
         [ 8.6408e-02,  7.3924e-02],
         [ 9.5735e-02,  7.8877e-02],
         [ 7.8302e-02,  7.3714e-02],
         [ 4.7327e-02,  2.5994e-01],
         [ 8.2177e-02, -1.8313e-01],
         [ 8.7683e-02, -1.6130e-02],
         [ 9.2751e-02,  2.2383e-02],
         [ 9.2730e-02,  4.1224e-02],
         [ 1.0865e-01,  4.9815e-02],
         [ 1.0521e-01,  5.3394e-02],
         [ 6.1773e-02,  5.4752e-02],
         [ 8.2728e-02,  5.5197e-02],
         [ 7.5271e-02,  5.5260e-02],
         [ 7.1240e-02,  5.5271e-02],
         [ 8.9970e-02,  5.5242e-02],
         [ 9.5932e-02,  5.5212e-02],
         [ 9.8053e-02,  5.5195e-02],
         [ 7.7203e-02,  5.5188e-02],
         [ 6.9477e-02,  5.5194e-02],
         [ 4.3896e-02,  5.5217e-02],
         [ 8.7711e-02,  5.5199e-02],
         [ 1.3347e-01,  5.5205e-02],
         [ 1.4507e-01,  5.5211e-02],
         [ 1.5629e-01,  5.5207e-02],
         [ 1.6322e-01,  5.5212e-02],
         [ 1.5895e-01,  5.5229e-02],
         [ 1.1127e-01,  5.5230e-02],
         [ 9.5475e-02,  5.5230e-02],
         [ 1.0614e-01,  5.5230e-02],
         [ 6.9667e-02,  5.5234e-02],
         [ 1.0300e-01,  5.5235e-02],
         [ 7.2349e-02,  5.5235e-02],
         [ 9.7220e-02,  5.5232e-02],
         [ 1.0048e-01,  5.5232e-02],
         [ 1.0546e-01,  5.5231e-02],
         [-5.4609e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 6.2098e-02,  1.2351e-01],
         [ 7.1628e-02,  1.4762e-01],
         [ 7.2546e-02,  1.6292e-01],
         [ 1.0148e-01,  8.1967e-02],
         [ 9.0296e-02,  1.3629e-01],
         [ 1.0358e-01,  8.7815e-02],
         [ 1.3922e-01,  4.5473e-02],
         [ 1.5520e-01,  8.0131e-02],
         [ 1.6333e-01,  5.8460e-02],
         [ 1.7725e-01,  8.5128e-02],
         [ 1.3784e-01,  6.9594e-02],
         [ 1.3400e-01,  8.7540e-02],
         [-8.4277e-03,  4.5903e-02],
         [-1.8376e-02,  8.1933e-02],
         [-3.2191e-02,  9.9977e-02],
         [ 1.1099e-01,  1.3375e-01],
         [ 1.1279e-01,  1.5824e-01],
         [ 1.1430e-01,  1.3294e-01],
         [ 1.1755e-01,  1.6139e-01],
         [ 3.7044e-02,  1.3278e-01],
         [ 9.2436e-02,  1.5743e-01],
         [ 2.1280e-02,  1.6295e-01],
         [ 2.9546e-02,  1.2947e-01],
         [ 2.8446e-02,  1.4200e-01],
         [ 1.1339e-01,  1.0826e-01],
         [ 1.2281e-01,  1.2325e-01],
         [ 1.2728e-01,  1.5667e-01],
         [ 9.9314e-02,  1.5379e-01],
         [ 1.2422e-01,  9.8922e-02],
         [ 1.4286e-01,  7.7782e-02],
         [ 1.2072e-01,  6.2780e-02],
         [ 1.4590e-01,  5.5886e-02],
         [ 1.5875e-01,  6.3887e-02],
         [ 1.2778e-01,  9.9482e-02],
         [ 1.4217e-01, -3.4155e-02],
         [ 1.5344e-01, -2.1217e-02],
         [ 1.5482e-01, -9.2338e-03],
         [ 1.5599e-01,  9.9465e-02],
         [ 1.5403e-01, -2.2168e-02],
         [ 1.5243e-01,  1.1265e-01],
         [ 1.4938e-01,  8.6938e-02],
         [ 1.2706e-01,  1.1020e-01],
         [ 1.2503e-01,  1.3384e-01],
         [ 1.2814e-01,  1.3438e-01],
         [ 1.4334e-01,  1.0204e-01],
         [ 1.2434e-01,  9.0019e-02],
         [ 1.5214e-01,  8.3208e-02],
         [ 1.2740e-01,  8.0371e-02],
         [ 1.3035e-01, -4.6195e-02],
         [ 1.2618e-01,  1.0385e-01],
         [ 1.4117e-01,  8.6160e-02],
         [ 1.3474e-01,  1.1467e-01],
         [ 1.4109e-01,  1.3047e-01],
         [ 7.0589e-02,  1.3829e-01],
         [ 5.9810e-02,  9.7761e-02],
         [ 5.9259e-02,  9.7162e-02],
         [ 1.3704e-01,  1.1798e-01],
         [ 1.2698e-01,  9.7955e-02],
         [ 1.4222e-01,  8.5284e-02],
         [ 1.4209e-01,  1.2096e-01],
         [ 6.6307e-02,  9.5788e-02],
         [ 1.4616e-01,  1.1879e-01],
         [ 1.3627e-01,  1.3409e-01],
         [ 1.5640e-01,  9.3052e-02],
         [ 1.5776e-01,  8.9948e-02],
         [ 1.5448e-01,  1.1217e-01],
         [ 1.5636e-01,  1.2394e-01],
         [ 1.5875e-01,  1.3002e-01],
         [ 6.3442e-02,  1.0101e-01],
         [ 1.5792e-01,  8.3048e-02],
         [ 1.6727e-01,  7.1049e-02],
         [ 1.7752e-01,  6.2917e-02],
         [ 1.8903e-01,  9.7067e-02],
         [ 1.8810e-01,  1.0800e-01],
         [ 1.8029e-01,  6.4629e-02],
         [ 1.7282e-01,  4.5136e-02],
         [ 1.6848e-01,  7.6969e-02],
         [ 1.3929e-01,  6.2918e-02],
         [ 1.7132e-01,  9.5625e-02],
         [ 1.6232e-01,  1.1023e-01],
         [ 1.7734e-01,  1.1688e-01],
         [ 1.3139e-01,  6.0743e-02],
         [ 1.1768e-01,  7.6213e-02],
         [ 1.2347e-01,  8.8764e-02],
         [ 1.0153e-01,  9.6090e-02],
         [ 1.8272e-01,  9.8768e-02],
         [ 6.8662e-02,  6.0680e-02],
         [ 5.6812e-02,  5.6632e-02],
         [ 9.2789e-02,  3.2492e-02],
         [ 6.4290e-02,  7.4602e-02],
         [ 4.1622e-02,  5.0010e-02],
         [ 5.9600e-02,  8.9831e-02],
         [ 1.2247e-01,  7.6247e-02],
         [ 1.1558e-01,  8.3153e-02],
         [ 5.9788e-02,  8.4992e-02],
         [ 1.2031e-01,  1.0666e-01],
         [ 1.3138e-01,  1.0542e-01],
         [ 1.3206e-01,  7.9696e-02],
         [ 1.5497e-01,  4.9755e-02],
         [ 1.6355e-01,  7.5160e-02],
         [ 1.2585e-01,  7.7119e-02],
         [ 1.4998e-01,  8.5199e-02],
         [ 1.5832e-01, -1.0361e-01],
         [ 1.4427e-01, -9.9337e-02],
         [ 1.6025e-01, -9.5831e-02],
         [ 1.4561e-01,  6.1700e-02],
         [ 1.5942e-01,  4.2482e-02],
         [ 1.6564e-01,  8.1041e-02],
         [ 1.4706e-01,  9.5415e-02],
         [ 1.6831e-01,  1.2742e-01],
         [ 1.4852e-01,  1.0659e-01],
         [ 1.1419e-01,  9.6575e-02],
         [ 1.2630e-01,  9.8754e-02],
         [ 1.5329e-01,  1.3765e-01],
         [ 1.2278e-01,  1.1733e-01],
         [ 9.2013e-02,  1.4003e-01],
         [ 1.3007e-01,  1.6316e-01],
         [ 1.8052e-01,  1.3186e-01],
         [ 1.9230e-01, -1.2413e-01],
         [ 2.0304e-01, -1.1773e-01],
         [ 2.2267e-01,  1.0482e-01],
         [ 1.7576e-01,  9.4810e-02],
         [ 1.5637e-01,  9.2563e-02],
         [ 1.4828e-01, -1.1217e-01],
         [ 1.7760e-01,  1.3918e-01],
         [ 1.9990e-01,  1.1354e-01],
         [ 1.6392e-01,  1.3301e-01],
         [ 1.8377e-01,  1.5528e-01],
         [ 1.9061e-01,  1.6181e-01],
         [ 1.6260e-01,  1.6860e-01],
         [ 1.3200e-01, -1.1161e-01],
         [ 1.4028e-01, -9.5706e-02],
         [ 1.0372e-01, -6.5637e-03],
         [ 1.1430e-01,  3.0356e-02],
         [ 1.4587e-01,  4.6682e-02],
         [ 1.1518e-01,  5.3259e-02],
         [ 1.1905e-01,  5.5532e-02],
         [ 1.1289e-01,  5.6072e-02],
         [ 1.1163e-01,  5.5997e-02],
         [ 1.1215e-01,  5.5767e-02],
         [ 7.3656e-02,  5.5556e-02],
         [ 9.8693e-02,  5.5411e-02],
         [ 1.2663e-01,  5.5299e-02],
         [ 1.3750e-01,  5.5256e-02],
         [ 9.2181e-02,  5.5219e-02],
         [ 7.2079e-02,  5.5217e-02],
         [ 1.0030e-01,  5.5210e-02],
         [ 1.2360e-01,  5.5206e-02],
         [ 1.1400e-01,  5.5215e-02],
         [ 1.6166e-01,  5.5219e-02],
         [ 1.8111e-01,  5.5211e-02],
         [ 1.3334e-01,  5.5217e-02],
         [ 8.0508e-02,  5.5223e-02],
         [ 1.1653e-01,  5.5232e-02],
         [ 1.3384e-01,  5.5230e-02],
         [ 1.5766e-01,  5.5230e-02],
         [ 1.8700e-01,  5.5231e-02],
         [ 1.8438e-01,  5.5236e-02],
         [ 1.4085e-01,  5.5235e-02],
         [ 1.3668e-01,  5.5232e-02],
         [ 8.9249e-02,  5.5232e-02],
         [ 1.0725e-01,  5.5231e-02],
         [ 7.7874e-02,  5.5231e-02],
         [ 1.0312e-01,  5.5231e-02],
         [ 8.6308e-02,  5.5231e-02],
         [ 1.0921e-01,  5.5231e-02],
         [ 1.0841e-01,  5.5231e-02],
         [ 1.1240e-01,  5.5231e-02],
         [ 1.1658e-01,  5.5231e-02],
         [ 1.1827e-01,  5.5231e-02],
         [ 1.1759e-01,  5.5231e-02],
         [-1.6666e-01,  5.5231e-02],
         [-1.5088e-01,  5.5231e-02],
         [ 3.2708e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.1177e-05, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0007, device='cuda:0')
mixer_td_error tensor(0.5673, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4622, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3484, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0784, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2232, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0127, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2270114.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2599, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.7326e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1949, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2532, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1949, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6552
target_mac_out tensor([[[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3683e-01,  1.1833e-01,  ...,  4.7582e-02,
            1.3756e-01, -1.0000e+07],
          [-1.0000e+07, -3.4730e-02,  1.3410e-01,  ...,  2.4027e-02,
            1.4590e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6866e-01,  1.2708e-01,  ...,  4.4227e-02,
            1.4453e-01, -1.0000e+07],
          [-1.0000e+07, -8.3233e-02,  1.6206e-01,  ...,  5.7360e-02,
            1.5029e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.7245e-02,  7.9477e-02,  ...,  3.3060e-02,
            1.4031e-01, -1.0000e+07],
          [-1.0000e+07, -1.3393e-02,  1.0346e-01,  ...,  1.0057e-02,
            1.4004e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.3125e-01,  6.3624e-02,  ...,  2.6348e-02,
            1.3662e-01, -1.0000e+07],
          [ 5.5229e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.4322e-01,  8.6051e-02,  ...,  2.6033e-02,
            1.5059e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.2040e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0827e-01,  1.0736e-01],
         [ 1.1833e-01,  1.3410e-01],
         [ 1.2708e-01,  1.6206e-01],
         [ 8.9987e-02,  1.3417e-01],
         [ 1.0940e-01,  1.2014e-01],
         [ 1.2983e-01,  1.5325e-01],
         [ 1.3845e-01,  1.6048e-01],
         [ 1.2512e-01,  1.2031e-01],
         [-1.9582e-01,  1.1437e-01],
         [-1.7154e-01,  1.0330e-01],
         [ 9.0323e-02,  7.4830e-02],
         [ 1.0983e-01,  1.1830e-01],
         [ 1.1925e-01,  1.3442e-01],
         [ 1.3475e-01,  1.2228e-01],
         [ 1.1197e-01,  9.7816e-02],
         [-1.9809e-01,  9.8313e-02],
         [ 8.5822e-02,  4.9057e-02],
         [ 1.2461e-01,  6.8371e-02],
         [ 1.3682e-01, -5.6543e-02],
         [ 1.4056e-01, -3.7470e-02],
         [ 1.1262e-01,  6.1381e-02],
         [ 1.1734e-01,  8.2258e-02],
         [ 1.1722e-01,  9.4672e-02],
         [ 1.2124e-01,  5.0966e-02],
         [ 8.1118e-02,  4.8383e-02],
         [ 1.4892e-02,  7.7840e-02],
         [ 3.4795e-02,  8.8487e-02],
         [ 4.4278e-02,  6.1794e-02],
         [ 4.8302e-02,  8.5376e-02],
         [ 4.9798e-02,  5.9120e-02],
         [ 5.0185e-02,  4.5445e-02],
         [ 5.0223e-02,  7.6600e-02],
         [ 5.0138e-02,  9.0235e-02],
         [ 5.0070e-02,  9.5147e-02],
         [ 5.0027e-02,  7.5814e-02],
         [ 4.9980e-02,  6.3297e-02],
         [ 4.9995e-02,  5.5629e-02],
         [ 5.0003e-02,  3.6898e-02],
         [ 4.9998e-02,  8.7359e-02],
         [ 5.0002e-02,  1.0757e-01],
         [ 4.9991e-02,  1.1491e-01],
         [ 5.0001e-02,  8.9862e-02],
         [ 5.0012e-02,  5.9950e-02],
         [ 5.0016e-02,  7.9676e-02],
         [ 5.0020e-02,  8.8780e-02],
         [ 5.0017e-02,  5.2195e-02],
         [ 5.0005e-02,  8.8855e-02],
         [ 5.0007e-02,  8.2079e-02],
         [ 5.0008e-02,  5.8059e-02],
         [ 5.0008e-02,  7.3622e-02],
         [ 5.0008e-02,  8.0231e-02],
         [ 5.0008e-02,  1.0331e-01],
         [ 5.0008e-02,  1.0558e-01],
         [ 5.0008e-02,  8.4347e-02],
         [ 5.0008e-02, -1.8235e-01],
         [ 5.0008e-02, -1.6370e-01],
         [ 5.0008e-02,  1.4074e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.6186e-02,  8.7099e-02],
         [-6.7838e-02,  1.0899e-01],
         [-5.7245e-02,  1.0346e-01],
         [-5.9561e-02,  1.3402e-01],
         [-5.8676e-02,  1.2302e-01],
         [-5.3396e-02,  1.0085e-01],
         [-6.7908e-02,  1.1286e-01],
         [ 1.1912e-01,  1.1130e-01],
         [-6.3318e-02,  1.3568e-01],
         [-5.6005e-02, -1.5380e-02],
         [-5.6666e-02, -3.0539e-02],
         [-2.0544e-02,  7.4106e-02],
         [ 1.0113e-01,  7.7855e-02],
         [ 1.0316e-01,  9.2208e-02],
         [ 1.0721e-01,  1.0173e-01],
         [ 1.2588e-01,  1.0544e-01],
         [ 1.5854e-01,  1.0491e-01],
         [ 1.6941e-01,  6.4716e-02],
         [ 1.8220e-01,  8.7938e-02],
         [ 1.4142e-01,  5.5530e-02],
         [ 1.6643e-01,  1.0031e-01],
         [ 1.2860e-01,  1.1410e-01],
         [ 1.3917e-01,  1.5399e-01],
         [ 1.2308e-01,  1.7211e-01],
         [ 1.1492e-01,  1.5424e-01],
         [ 4.7135e-02,  1.4319e-01],
         [-1.4986e-01,  8.8144e-02],
         [ 8.9076e-02,  1.2815e-01],
         [ 1.0228e-01,  1.1005e-01],
         [ 1.2923e-01,  1.4497e-01],
         [ 1.4316e-01,  1.3877e-01],
         [ 1.3791e-01, -1.3592e-01],
         [ 1.0510e-01, -1.2723e-01],
         [ 8.6649e-02, -1.3664e-01],
         [-1.5744e-01, -1.6724e-01],
         [ 1.0227e-01, -1.7934e-01],
         [ 1.2822e-01, -1.8521e-01],
         [-1.0684e-01,  6.6828e-02],
         [ 1.2761e-01, -1.7175e-01],
         [ 1.6213e-01,  7.8023e-02],
         [ 1.9279e-01, -1.6868e-01],
         [-8.2212e-02, -1.6263e-01],
         [ 1.5320e-01,  2.9010e-02],
         [ 1.1527e-01,  4.6689e-02],
         [ 1.1486e-01,  5.3856e-02],
         [ 9.8972e-02,  5.6210e-02],
         [-1.1622e-01,  5.6568e-02],
         [ 1.1824e-01,  5.6340e-02],
         [ 1.2858e-01,  5.5960e-02],
         [-1.4134e-01,  5.5660e-02],
         [ 1.2935e-01,  5.5416e-02],
         [-1.3583e-01,  5.5306e-02],
         [-1.4710e-01,  5.5236e-02],
         [ 1.3882e-01,  5.5216e-02],
         [ 9.8298e-02,  5.5202e-02],
         [ 9.5547e-02,  5.5176e-02],
         [ 1.1643e-01,  5.5217e-02],
         [ 1.1111e-01,  5.5210e-02],
         [-7.7241e-02,  5.5201e-02],
         [ 1.4190e-01,  5.5195e-02],
         [ 1.5536e-01,  5.5203e-02],
         [ 1.1657e-01,  5.5221e-02],
         [-1.3125e-01,  5.5229e-02],
         [ 8.6051e-02,  5.5231e-02],
         [ 1.2040e-02,  5.5230e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.8326e-06, device='cuda:0') tensor(0.0014, device='cuda:0') tensor(-0.0029, device='cuda:0')
mixer_td_error tensor(0.1609, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4630, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5508, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0728, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1953, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0117, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-615384.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1928, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(9.8102e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0016, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1056, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3223, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1056, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6603
target_mac_out tensor([[[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7175e-02,  8.1043e-02,  ...,  2.3772e-02,
            1.2601e-01, -1.0000e+07],
          [-1.0000e+07, -3.0851e-02,  1.2640e-01,  ...,  1.8911e-02,
            1.4901e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.1041e-02,  8.0018e-02,  ..., -7.0601e-04,
            1.3470e-01, -1.0000e+07],
          [-1.0000e+07, -6.5586e-02,  1.4954e-01,  ...,  4.8926e-02,
            1.5883e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1402e-02,  8.1983e-02,  ...,  3.9429e-02,
            1.3744e-01, -1.0000e+07],
          [-1.0000e+07, -3.2219e-02,  9.6327e-02,  ..., -1.4636e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2918e-02,  8.3033e-02,  ...,  1.5905e-03,
            1.3806e-01, -1.0000e+07],
          [-1.0000e+07, -4.3941e-02,  1.2828e-01,  ...,  1.4506e-02,
            1.4886e-01, -1.0000e+07]],

         ...,

         [[ 5.0062e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1756e-01,  6.2249e-02,  ...,  7.2620e-02,
            1.8534e-01, -1.0000e+07]],

         [[ 5.0040e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3118e-01,  7.9832e-02,  ...,  8.7176e-02,
            1.9510e-01, -1.0000e+07]],

         [[ 5.0049e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.4158e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.8313e-02,  1.0699e-01],
         [-6.7175e-02,  1.2640e-01],
         [-8.1041e-02,  1.4954e-01],
         [-9.1134e-02,  1.5612e-01],
         [-1.0799e-01, -1.2343e-01],
         [-1.0991e-01, -1.2816e-01],
         [ 1.0580e-01, -1.1606e-01],
         [-1.1033e-01, -8.9668e-02],
         [ 1.1349e-01, -1.0872e-01],
         [ 1.2588e-01, -1.1025e-01],
         [ 1.3629e-01, -9.7962e-02],
         [ 1.3259e-01, -9.0463e-02],
         [ 1.1578e-01,  1.1740e-01],
         [ 1.2220e-01,  1.3861e-01],
         [ 1.3780e-01,  1.2534e-01],
         [ 1.3741e-01, -1.3599e-01],
         [ 8.2695e-02, -1.3511e-01],
         [ 8.3863e-02, -1.4937e-01],
         [ 1.5210e-01,  1.4274e-01],
         [ 1.3708e-01, -1.5926e-01],
         [ 1.6772e-01,  1.4365e-01],
         [ 1.4498e-01, -1.6001e-01],
         [ 1.6518e-01,  1.3629e-01],
         [ 1.7584e-01, -1.5451e-01],
         [ 1.7664e-01, -1.5946e-01],
         [ 1.7651e-01, -1.6369e-01],
         [-1.7865e-01, -1.5726e-01],
         [ 1.7872e-01,  9.3367e-02],
         [-1.5929e-01, -1.6687e-01],
         [-1.3971e-01, -1.5868e-01],
         [-1.3435e-01, -1.5522e-01],
         [-7.9528e-03, -1.2939e-01],
         [ 1.8652e-02, -1.2624e-01],
         [ 3.4414e-02, -1.3678e-01],
         [ 4.2669e-02,  7.6256e-02],
         [ 4.6747e-02,  5.2870e-02],
         [ 4.8666e-02, -1.4420e-01],
         [ 4.9528e-02,  7.1479e-02],
         [ 4.9877e-02,  9.8945e-02],
         [ 5.0008e-02, -1.4778e-01],
         [ 5.0032e-02,  9.3015e-02],
         [ 5.0043e-02, -1.5243e-01],
         [ 5.0025e-02, -9.9847e-02],
         [ 5.0034e-02, -9.0438e-02],
         [ 5.0048e-02, -1.1192e-01],
         [ 5.0029e-02, -8.5671e-02],
         [ 5.0028e-02, -1.0126e-01],
         [ 5.0022e-02, -1.2439e-01],
         [ 5.0021e-02, -1.2151e-01],
         [ 5.0014e-02, -1.1172e-01],
         [ 5.0012e-02,  3.0082e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0780e-01,  8.9914e-02],
         [-7.1402e-02,  9.6327e-02],
         [-7.2918e-02,  1.2828e-01],
         [-8.7103e-02,  1.0682e-01],
         [-1.1015e-01,  1.0456e-01],
         [-1.1875e-01,  9.7676e-02],
         [-9.7095e-02,  9.3238e-02],
         [-7.6133e-02,  8.2896e-02],
         [-8.9235e-02, -5.1922e-02],
         [-6.7292e-02,  1.0789e-01],
         [-6.5269e-02,  1.1981e-01],
         [ 1.3246e-01,  1.0872e-01],
         [ 1.3294e-01,  1.2250e-01],
         [-8.5358e-02,  1.3508e-01],
         [-1.0168e-01,  1.3824e-01],
         [ 1.6550e-01,  1.0451e-01],
         [-2.1922e-02,  1.2367e-01],
         [-3.9386e-02, -6.8664e-02],
         [-6.4434e-02, -6.4707e-02],
         [-5.4748e-02, -2.6864e-02],
         [ 1.4503e-01,  1.5559e-01],
         [ 1.7699e-01,  1.8252e-01],
         [ 2.1308e-01,  1.5478e-01],
         [ 2.2450e-01, -2.0002e-02],
         [ 1.7363e-01, -3.2747e-02],
         [ 1.5799e-01, -5.0096e-02],
         [ 1.4927e-01,  9.1177e-02],
         [ 1.5257e-01,  1.2554e-01],
         [ 1.6329e-01, -8.7534e-02],
         [ 1.6940e-01,  1.4631e-01],
         [ 1.8631e-01, -1.3281e-01],
         [ 1.5079e-01,  1.6469e-01],
         [ 1.5646e-01, -1.2870e-01],
         [ 1.5936e-01, -1.4400e-01],
         [ 1.6924e-01, -1.6142e-01],
         [ 1.3913e-01, -1.5414e-01],
         [ 1.6944e-01, -1.2114e-01],
         [ 1.4515e-01, -9.8612e-02],
         [ 1.6190e-01, -9.0985e-02],
         [ 1.7382e-01, -8.7942e-02],
         [ 1.8228e-01, -1.0898e-01],
         [ 1.8840e-01,  1.2613e-01],
         [ 1.8909e-01,  1.5074e-01],
         [ 1.6448e-01,  1.2795e-01],
         [ 1.2279e-01, -8.4086e-02],
         [ 1.3814e-01, -5.1586e-02],
         [ 1.3328e-01, -8.0809e-02],
         [ 1.3287e-01,  8.2771e-02],
         [ 1.0036e-01,  1.1918e-01],
         [-2.1057e-01,  8.5093e-02],
         [-2.0906e-01, -1.0182e-01],
         [-1.9690e-01,  6.9637e-02],
         [-1.9094e-01,  6.7282e-02],
         [-1.8092e-01,  7.9863e-02],
         [-1.5370e-01,  8.8000e-02],
         [ 5.3851e-03,  1.0424e-01],
         [ 3.0878e-02,  9.4957e-02],
         [ 4.3042e-02,  1.0807e-01],
         [ 4.8367e-02, -1.5752e-01],
         [ 5.0411e-02,  9.3065e-02],
         [ 5.0932e-02, -1.3685e-01],
         [ 5.0872e-02, -1.4828e-01],
         [ 5.0672e-02, -1.4777e-01],
         [ 5.0470e-02, -1.3951e-01],
         [ 5.0299e-02, -1.2128e-01],
         [ 5.0180e-02, -1.0585e-01],
         [ 5.0109e-02, -9.9846e-02],
         [ 5.0062e-02, -1.1756e-01],
         [ 5.0040e-02, -1.3118e-01],
         [ 5.0049e-02,  4.4158e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.8791e-05, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0014, device='cuda:0')
mixer_td_error tensor(0.3658, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5499, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3875, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0744, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2030, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0335, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1357142.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2245, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.9007e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1409, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.3076, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1409, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6649
target_mac_out tensor([[[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3070e-01,  1.2391e-01,  ...,  7.1034e-02,
            1.5852e-01, -1.0000e+07],
          [-1.0000e+07, -3.6329e-02,  1.0540e-01,  ..., -2.3505e-02,
            1.3276e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4548e-01,  1.2388e-01,  ...,  5.2184e-02,
            1.5225e-01, -1.0000e+07],
          [-1.0000e+07, -7.9506e-02,  1.4849e-01,  ...,  2.9133e-02,
            1.4592e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5505e-01,  5.1068e-02,  ...,  3.8250e-02,
            2.0122e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5922e-01,  4.2900e-02,  ...,  2.9935e-02,
            1.9831e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.9150e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3683e-01,  1.1833e-01,  ...,  4.7582e-02,
            1.3756e-01, -1.0000e+07],
          [-1.0000e+07, -3.4730e-02,  1.3410e-01,  ...,  2.4027e-02,
            1.4590e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6866e-01,  1.2708e-01,  ...,  4.4227e-02,
            1.4453e-01, -1.0000e+07],
          [-1.0000e+07, -8.3233e-02,  1.6206e-01,  ...,  5.7360e-02,
            1.5029e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0827e-01, -1.1117e-02],
         [-1.3070e-01,  1.0540e-01],
         [-1.4548e-01,  1.4849e-01],
         [-1.5081e-01, -7.5766e-02],
         [-1.5082e-01,  1.0360e-01],
         [-1.5697e-01,  1.6212e-01],
         [-1.6938e-01,  1.3985e-01],
         [-1.7251e-01,  1.2283e-01],
         [-1.7008e-01,  1.4214e-01],
         [ 1.5162e-01,  1.6795e-01],
         [ 1.6399e-01,  1.8431e-01],
         [-1.9791e-01,  1.5073e-01],
         [-1.7771e-01,  1.3457e-01],
         [-1.7234e-01, -1.5708e-01],
         [-1.5415e-01,  1.3791e-01],
         [-1.5234e-01,  1.6636e-01],
         [-1.6935e-01,  1.3594e-01],
         [-1.7997e-01, -1.5516e-01],
         [-1.6583e-01,  1.2379e-01],
         [-1.4367e-01, -1.1832e-01],
         [-1.3986e-01, -9.6275e-02],
         [ 1.5065e-02, -8.0648e-02],
         [ 3.1087e-02, -7.0815e-02],
         [ 4.1229e-02, -5.9451e-02],
         [ 4.6494e-02, -5.6659e-02],
         [ 4.8929e-02, -3.9966e-02],
         [ 4.9845e-02, -5.3753e-02],
         [ 5.0161e-02, -5.3675e-02],
         [ 5.0198e-02,  7.7594e-02],
         [ 5.0164e-02, -5.6926e-02],
         [ 5.0127e-02,  8.3781e-02],
         [ 5.0076e-02,  1.1153e-01],
         [ 5.0043e-02,  7.9167e-02],
         [ 5.0052e-02, -1.2547e-01],
         [ 5.0029e-02,  8.8515e-02],
         [ 5.0036e-02, -1.3604e-01],
         [ 5.0027e-02,  8.0908e-02],
         [ 5.0019e-02, -1.1145e-01],
         [ 5.0025e-02,  7.9332e-02],
         [ 5.0026e-02,  9.3016e-02],
         [ 5.0010e-02,  9.7706e-02],
         [ 5.0020e-02, -9.9113e-02],
         [ 5.0005e-02,  8.6472e-02],
         [ 5.0007e-02,  9.7147e-02],
         [ 5.0008e-02,  6.3430e-02],
         [ 5.0008e-02,  8.5475e-02],
         [ 5.0008e-02,  5.6860e-02],
         [ 5.0009e-02, -9.3356e-02],
         [ 5.0008e-02, -8.3420e-02],
         [ 5.0008e-02, -6.6560e-02],
         [ 5.0008e-02,  7.4572e-02],
         [ 5.0008e-02, -7.6886e-02],
         [ 5.0008e-02, -8.0247e-02],
         [ 5.0009e-02, -8.3672e-02],
         [ 5.0009e-02, -8.7099e-02],
         [ 5.0009e-02, -8.3128e-02],
         [ 5.0009e-02,  6.9029e-02],
         [ 5.0009e-02,  8.4975e-02],
         [ 5.0009e-02,  9.1598e-02],
         [ 5.0009e-02,  7.4213e-02],
         [ 5.0009e-02, -8.3758e-02],
         [ 5.0009e-02, -7.7796e-02],
         [ 5.0009e-02,  7.1914e-02],
         [ 5.0009e-02,  1.0388e-01],
         [ 5.0009e-02,  8.5299e-02],
         [ 5.0009e-02,  9.0344e-02],
         [ 5.0009e-02, -1.4664e-01],
         [ 5.0009e-02, -1.2628e-01],
         [ 5.0009e-02,  6.6682e-02],
         [ 5.0009e-02,  7.9862e-02],
         [ 5.0009e-02, -1.1397e-01],
         [ 5.0009e-02, -9.0066e-02],
         [ 5.0009e-02, -7.8773e-02],
         [ 5.0009e-02,  8.0870e-02],
         [ 5.0009e-02, -7.9872e-02],
         [ 5.0009e-02,  7.1534e-02],
         [ 5.0009e-02,  7.7649e-02],
         [ 5.0009e-02,  8.1230e-02],
         [ 5.0009e-02, -8.0220e-02],
         [ 5.0009e-02, -6.3569e-02],
         [ 5.0009e-02, -8.5435e-02],
         [ 5.0009e-02,  7.6477e-02],
         [ 5.0009e-02, -9.6523e-02],
         [ 5.0009e-02, -9.4440e-02],
         [ 5.0009e-02, -9.4245e-02],
         [ 5.0009e-02, -9.4207e-02],
         [ 5.0009e-02, -9.0095e-02],
         [ 5.0009e-02,  6.9579e-02],
         [ 5.0009e-02,  8.6352e-02],
         [ 5.0009e-02,  5.8278e-02],
         [ 5.0009e-02, -1.0460e-01],
         [ 5.0009e-02,  7.5007e-02],
         [ 5.0009e-02,  8.7675e-02],
         [ 5.0009e-02,  9.3339e-02],
         [ 5.0009e-02,  1.1464e-01],
         [ 5.0009e-02, -1.2009e-01],
         [ 5.0009e-02, -1.0415e-01],
         [ 5.0009e-02, -9.8967e-02],
         [ 5.0009e-02, -9.2874e-02],
         [ 5.0009e-02,  7.1689e-02],
         [ 5.0009e-02,  1.0404e-01],
         [ 5.0009e-02,  1.0427e-01],
         [ 5.0009e-02, -1.1727e-01],
         [ 5.0009e-02, -9.8710e-02],
         [ 5.0009e-02, -8.9451e-02],
         [ 5.0009e-02,  7.5933e-02],
         [ 5.0009e-02,  8.5900e-02],
         [ 5.0009e-02,  1.3334e-01],
         [ 5.0009e-02, -6.4013e-02],
         [ 5.0009e-02, -8.2040e-02],
         [ 5.0009e-02,  9.6982e-02],
         [ 5.0009e-02, -1.0953e-01],
         [ 5.0009e-02, -1.3184e-01],
         [ 5.0009e-02, -1.3909e-01],
         [ 5.0009e-02,  8.8877e-02],
         [ 5.0009e-02, -1.5605e-01],
         [ 5.0009e-02, -1.4911e-01],
         [ 5.0009e-02, -1.4572e-01],
         [ 5.0009e-02,  9.1396e-02],
         [ 5.0009e-02,  8.8900e-02],
         [ 5.0009e-02, -1.6644e-01],
         [ 5.0009e-02, -1.6311e-01],
         [ 5.0009e-02, -1.4103e-01],
         [ 5.0009e-02, -1.4777e-01],
         [ 5.0009e-02, -1.5338e-01],
         [ 5.0009e-02, -1.5050e-01],
         [ 5.0009e-02, -1.7488e-01],
         [ 5.0009e-02, -1.5726e-01],
         [ 5.0009e-02, -1.5505e-01],
         [ 5.0009e-02, -1.5922e-01],
         [ 5.0009e-02,  1.9150e-02]],

        [[ 1.0827e-01, -1.1117e-02],
         [-1.3683e-01,  1.3410e-01],
         [-1.6866e-01,  1.6206e-01],
         [-1.4734e-01,  1.3417e-01],
         [-1.5951e-01, -1.2347e-01],
         [-1.8799e-01,  1.5325e-01],
         [ 1.3845e-01, -1.3088e-01],
         [-2.0439e-01, -1.2248e-01],
         [-1.9582e-01,  1.1437e-01],
         [-1.7154e-01, -1.0019e-01],
         [-1.9228e-01, -9.8439e-02],
         [-2.0204e-01,  1.1830e-01],
         [-2.0473e-01,  1.3442e-01],
         [ 1.3475e-01,  1.2228e-01],
         [-2.1874e-01,  9.7816e-02],
         [-1.9809e-01,  9.8313e-02],
         [-2.0521e-01, -9.2158e-02],
         [ 1.2461e-01, -8.1139e-02],
         [ 1.3682e-01, -5.6543e-02],
         [ 1.4056e-01, -3.7470e-02],
         [ 1.1262e-01, -5.1725e-02],
         [-1.9298e-01,  8.2258e-02],
         [-1.8761e-01,  9.4672e-02],
         [ 1.2124e-01, -7.4994e-02],
         [-1.7939e-01, -5.1529e-02],
         [ 1.4892e-02,  7.7840e-02],
         [ 3.4795e-02,  8.8487e-02],
         [ 4.4278e-02, -6.2192e-02],
         [ 4.8302e-02,  8.5376e-02],
         [ 4.9798e-02, -7.3235e-02],
         [ 5.0185e-02, -7.2950e-02],
         [ 5.0223e-02,  7.6600e-02],
         [ 5.0138e-02,  9.0235e-02],
         [ 5.0070e-02,  9.5147e-02],
         [ 5.0027e-02, -9.2876e-02],
         [ 4.9980e-02, -8.6023e-02],
         [ 4.9995e-02, -8.2210e-02],
         [ 5.0003e-02, -8.2764e-02],
         [ 4.9998e-02,  8.7359e-02],
         [ 5.0002e-02,  1.0757e-01],
         [ 4.9991e-02,  1.1491e-01],
         [ 5.0001e-02,  8.9862e-02],
         [ 5.0012e-02,  5.9950e-02],
         [ 5.0016e-02,  7.9676e-02],
         [ 5.0020e-02,  8.8780e-02],
         [ 5.0017e-02, -1.8457e-01],
         [ 5.0005e-02,  8.8855e-02],
         [ 5.0007e-02,  8.2079e-02],
         [ 5.0008e-02, -1.9298e-01],
         [ 5.0008e-02, -1.9668e-01],
         [ 5.0008e-02,  8.0231e-02],
         [ 5.0008e-02,  1.0331e-01],
         [ 5.0008e-02,  1.0558e-01],
         [ 5.0008e-02, -1.8823e-01],
         [ 5.0008e-02, -1.8235e-01],
         [ 5.0008e-02, -1.6370e-01],
         [ 5.0008e-02,  1.4074e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.0467e-06, device='cuda:0') tensor(0.0014, device='cuda:0') tensor(-0.0014, device='cuda:0')
mixer_td_error tensor(0.6856, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4572, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4093, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0493, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1708, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0772, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2824427., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1843, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.6306e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1504, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3167, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1504, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6706
target_mac_out tensor([[[[-1.0000e+07, -5.3297e-02,  7.5482e-02,  ...,  2.0656e-03,
            1.2204e-01, -1.0000e+07],
          [-1.0000e+07, -1.9084e-02,  9.7086e-02,  ..., -1.3971e-02,
            1.2488e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.9376e-02,  6.2572e-02,  ...,  1.0603e-02,
            1.3047e-01, -1.0000e+07],
          [-1.0000e+07, -2.0197e-02,  8.7256e-02,  ..., -4.7699e-03,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0652e-02,  9.3472e-02,  ...,  1.1340e-02,
            1.5230e-01, -1.0000e+07],
          [-1.0000e+07, -3.5509e-02,  1.2358e-01,  ...,  1.7736e-02,
            1.5126e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5616e-02,  9.4210e-02,  ...,  7.3878e-03,
            1.5537e-01, -1.0000e+07],
          [-1.0000e+07, -2.6778e-02,  1.1172e-01,  ...,  1.0212e-02,
            1.4563e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6670e-02,  6.7967e-02,  ...,  1.6771e-02,
            1.4736e-01, -1.0000e+07],
          [-1.0000e+07, -4.0458e-02,  1.4132e-01,  ...,  2.4393e-02,
            1.5301e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.8329e-01,  8.0878e-02,  ...,  8.4826e-02,
            2.2755e-01, -3.3026e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.7266e-01,  8.0218e-02,  ...,  7.2890e-02,
            2.1799e-01, -3.2035e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.9990e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.3297e-02,  9.7086e-02],
         [-4.9376e-02, -2.0197e-02],
         [-8.0652e-02, -3.5509e-02],
         [-1.0289e-01,  1.5540e-01],
         [-1.1144e-01,  1.6299e-01],
         [-1.0272e-01, -7.0984e-02],
         [-1.1140e-01, -5.4819e-02],
         [-9.4157e-02,  1.6193e-01],
         [-7.6723e-02,  1.3557e-01],
         [-9.4028e-02,  1.1910e-01],
         [-1.0262e-01,  1.2013e-01],
         [-1.0781e-01, -1.1317e-01],
         [-4.2669e-02,  1.1542e-01],
         [-8.3976e-02,  1.5187e-01],
         [ 1.2979e-01, -1.2781e-01],
         [ 1.3419e-01, -1.3190e-01],
         [ 1.4265e-01, -1.2375e-01],
         [-1.1379e-01, -1.3441e-01],
         [-1.1117e-01, -1.2500e-01],
         [-1.3504e-01, -1.1837e-01],
         [ 1.1457e-01, -1.2643e-01],
         [ 1.3285e-01, -1.1666e-01],
         [ 1.3930e-01, -1.1154e-01],
         [-1.5567e-01, -1.3911e-01],
         [-1.5461e-01, -1.5363e-01],
         [-1.5179e-01, -1.3370e-01],
         [-1.6360e-01, -1.4471e-01],
         [-1.4855e-01, -1.3535e-01],
         [-1.2553e-01, -1.6707e-02],
         [-1.4851e-01,  2.4713e-02],
         [-1.4866e-01,  4.3323e-02],
         [-1.5258e-01,  5.1013e-02],
         [ 1.0787e-01,  5.3948e-02],
         [ 1.1707e-01,  5.4925e-02],
         [ 1.3081e-01,  5.5185e-02],
         [ 1.0242e-01,  5.5231e-02],
         [ 1.1496e-01,  5.5187e-02],
         [ 8.7802e-02,  5.5177e-02],
         [ 9.0199e-02,  5.5157e-02],
         [-1.6469e-01,  5.5186e-02],
         [ 1.2171e-01,  5.5153e-02],
         [ 8.0981e-02,  5.5192e-02],
         [ 1.1086e-01,  5.5187e-02],
         [ 1.3322e-01,  5.5192e-02],
         [ 9.7490e-02,  5.5214e-02],
         [ 8.2394e-02,  5.5213e-02],
         [ 1.0894e-01,  5.5218e-02],
         [ 1.2309e-01,  5.5223e-02],
         [ 1.2606e-01,  5.5225e-02],
         [-1.9274e-01,  5.5231e-02],
         [ 1.0903e-01,  5.5233e-02],
         [-2.1791e-02,  5.5233e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.8723e-02,  1.2843e-01],
         [-8.5616e-02, -2.6778e-02],
         [-7.6670e-02,  1.4132e-01],
         [-1.0203e-01,  1.5350e-01],
         [-9.8907e-02,  1.5582e-01],
         [-1.0422e-01, -5.7515e-02],
         [-7.3542e-02, -5.4559e-02],
         [-6.5304e-02, -4.9985e-02],
         [-4.3495e-02, -4.6738e-02],
         [-5.8266e-02, -4.0279e-02],
         [-6.9759e-02, -5.1785e-02],
         [-7.6102e-02,  1.2324e-01],
         [-5.9654e-02, -8.6192e-02],
         [-7.4937e-02, -6.7622e-02],
         [-8.8789e-02, -5.3675e-02],
         [-7.3633e-02, -6.0735e-02],
         [-1.0614e-01, -6.0493e-02],
         [-1.2537e-01,  1.2583e-01],
         [-1.3632e-01,  1.2902e-01],
         [-1.5050e-01,  1.0315e-01],
         [-1.5304e-01,  9.1633e-02],
         [-1.5039e-01,  8.6050e-02],
         [ 1.5964e-01, -7.2269e-02],
         [ 1.4176e-01, -5.7593e-02],
         [ 1.4823e-01,  8.8306e-02],
         [-1.7687e-01,  1.3236e-01],
         [-1.4642e-01,  1.3988e-01],
         [-1.4063e-01,  1.3946e-01],
         [-1.4251e-01,  1.2548e-01],
         [-1.5788e-01,  1.5120e-01],
         [-1.3332e-01,  1.4849e-01],
         [-1.5667e-01,  1.3046e-01],
         [-1.4694e-01,  1.3859e-01],
         [-1.3625e-01,  1.2250e-01],
         [-1.5305e-01,  1.3855e-01],
         [-1.2797e-01,  1.4882e-01],
         [-1.4319e-01,  1.1716e-01],
         [-2.6794e-02, -1.3901e-01],
         [ 1.2694e-02, -1.0489e-01],
         [ 3.2720e-02, -7.9862e-02],
         [ 4.2500e-02, -7.5181e-02],
         [ 4.7060e-02,  7.2315e-02],
         [ 4.9041e-02, -7.0234e-02],
         [ 4.9831e-02, -6.3753e-02],
         [ 5.0090e-02,  7.5003e-02],
         [ 5.0148e-02,  9.0500e-02],
         [ 5.0123e-02,  9.9550e-02],
         [ 5.0104e-02, -7.1433e-02],
         [ 5.0055e-02, -4.8114e-02],
         [ 5.0053e-02,  8.4142e-02],
         [ 5.0037e-02, -5.6051e-02],
         [ 5.0035e-02,  8.4584e-02],
         [ 5.0018e-02,  9.6284e-02],
         [ 5.0014e-02,  6.5931e-02],
         [ 5.0027e-02,  9.0036e-02],
         [ 5.0014e-02, -3.3868e-02],
         [ 5.0018e-02,  8.2049e-02],
         [ 5.0012e-02, -1.4853e-02],
         [ 5.0009e-02, -4.3108e-03],
         [ 5.0006e-02,  1.9502e-03],
         [ 5.0008e-02,  5.7588e-03],
         [ 5.0007e-02,  8.0655e-03],
         [ 5.0008e-02, -2.9433e-02],
         [ 5.0008e-02, -3.4398e-02],
         [ 5.0008e-02,  7.9436e-02],
         [ 5.0008e-02,  8.9974e-02],
         [ 5.0008e-02, -6.8031e-02],
         [ 5.0008e-02, -5.7201e-02],
         [ 5.0008e-02,  7.6034e-02],
         [ 5.0008e-02, -6.6755e-02],
         [ 5.0009e-02,  7.8667e-02],
         [ 5.0009e-02,  1.0735e-01],
         [ 5.0009e-02,  8.7148e-02],
         [ 5.0009e-02,  1.0248e-01],
         [ 5.0009e-02,  1.0741e-01],
         [ 5.0009e-02,  7.8701e-02],
         [ 5.0009e-02, -1.8022e-01],
         [ 5.0009e-02,  1.0202e-01],
         [ 5.0009e-02, -1.8157e-01],
         [ 5.0009e-02,  9.1847e-02],
         [ 5.0009e-02,  1.0255e-01],
         [ 5.0009e-02, -1.9639e-01],
         [ 5.0009e-02, -1.8180e-01],
         [ 5.0009e-02,  9.4603e-02],
         [ 5.0009e-02,  1.1070e-01],
         [ 5.0009e-02,  1.0668e-01],
         [ 5.0009e-02, -1.8775e-01],
         [ 5.0009e-02, -1.6965e-01],
         [ 5.0009e-02, -1.6599e-01],
         [ 5.0009e-02, -1.8249e-01],
         [ 5.0009e-02, -1.7278e-01],
         [ 5.0009e-02, -1.8329e-01],
         [ 5.0009e-02, -1.7266e-01],
         [ 5.0009e-02,  5.9990e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.5642e-05, device='cuda:0') tensor(0.0016, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.5669, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4578, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4883, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0491, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1451, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0906, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2234042.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1630, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.9427e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1802, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2811, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1802, device='cuda:0', grad_fn=<MinBackward1>)
t_env 6812
target_mac_out tensor([[[[-1.0000e+07, -9.3745e-02,  1.1397e-01,  ...,  6.2087e-02,
            1.3778e-01, -1.0000e+07],
          [-1.0000e+07, -2.4539e-02,  9.4233e-02,  ..., -1.0851e-02,
            1.2427e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.1816e-02,  1.0293e-01,  ...,  8.5142e-03,
            1.3906e-01, -1.0000e+07],
          [-1.0000e+07, -3.5735e-02,  9.6497e-02,  ..., -3.4171e-02,
            1.3232e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.1353e-02,  1.1193e-01,  ...,  1.4043e-02,
            1.4122e-01, -1.0000e+07],
          [-1.0000e+07, -4.9343e-02,  1.1785e-01,  ..., -1.9798e-02,
            1.4554e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2714e-01,  1.2420e-01,  ...,  7.0546e-02,
            1.5857e-01, -1.0000e+07],
          [-1.0000e+07, -3.8311e-02,  1.3382e-01,  ...,  4.0568e-02,
            1.4396e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4124e-01,  1.2148e-01,  ...,  5.2743e-02,
            1.5640e-01, -1.0000e+07],
          [-1.0000e+07, -4.4101e-02,  1.1387e-01,  ...,  3.1959e-02,
            1.4699e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.8956e-01,  8.1104e-02,  ...,  8.0826e-02,
            2.1827e-01, -3.2595e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6913e-01,  3.3983e-02,  ...,  7.0350e-02,
            1.9429e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-7.5836e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-9.3745e-02, -2.4539e-02],
         [-8.1816e-02, -3.5735e-02],
         [-9.1353e-02, -4.9343e-02],
         [-1.0708e-01, -4.8474e-02],
         [-1.3291e-01, -8.9286e-02],
         [-1.6263e-01, -1.1434e-01],
         [-1.7019e-01, -1.3243e-01],
         [-1.7312e-01, -1.4887e-01],
         [-1.7159e-01, -1.6649e-01],
         [-1.8643e-01, -1.7933e-01],
         [-1.9294e-01, -1.7667e-01],
         [-1.7802e-01, -1.6535e-01],
         [-1.7879e-01, -1.7117e-01],
         [-1.6864e-01, -1.6773e-01],
         [-1.5360e-01, -1.6895e-01],
         [-1.4956e-01, -1.8148e-01],
         [-1.3897e-01, -1.6579e-01],
         [-1.4226e-01, -1.7136e-01],
         [-1.6644e-01, -1.8246e-01],
         [-1.6540e-01, -1.6584e-01],
         [-1.5060e-01, -1.6588e-01],
         [-1.3478e-01, -1.4657e-01],
         [-1.3449e-01, -1.5945e-01],
         [-1.2741e-01, -1.4147e-01],
         [-1.1535e-01, -1.3264e-01],
         [-1.1694e-01, -1.3773e-01],
         [-1.1366e-01, -1.4486e-01],
         [ 1.5147e-02, -1.3190e-01],
         [ 3.3039e-02, -1.4070e-01],
         [ 4.2226e-02, -1.4925e-01],
         [ 4.6520e-02, -1.3264e-01],
         [ 4.8429e-02, -1.3777e-01],
         [ 4.9264e-02, -1.4849e-01],
         [ 4.9619e-02, -1.4870e-01],
         [ 4.9764e-02, -1.5699e-01],
         [ 4.9854e-02, -1.7680e-01],
         [ 4.9899e-02, -1.7470e-01],
         [ 4.9943e-02, -1.9869e-01],
         [ 4.9950e-02, -2.0718e-01],
         [ 4.9978e-02, -1.7776e-01],
         [ 4.9989e-02, -1.5104e-01],
         [ 5.0004e-02, -1.5225e-01],
         [ 5.0021e-02, -1.5678e-01],
         [ 5.0020e-02, -1.3821e-01],
         [ 5.0015e-02, -1.3537e-01],
         [ 5.0018e-02, -1.3500e-01],
         [ 5.0020e-02, -1.3552e-01],
         [ 5.0012e-02,  3.6751e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-9.5620e-02, -1.6811e-02],
         [-1.2714e-01, -3.8311e-02],
         [-1.4124e-01, -4.4101e-02],
         [-1.4871e-01, -6.2131e-02],
         [-1.7136e-01, -6.5580e-02],
         [-1.8409e-01, -6.5969e-02],
         [-2.0885e-01, -6.4253e-02],
         [ 1.5263e-01, -7.6448e-02],
         [-1.9735e-01, -5.6641e-02],
         [-2.0130e-01, -4.5811e-02],
         [-1.9475e-01, -5.5508e-02],
         [ 1.3488e-01, -6.6582e-02],
         [-2.1400e-01, -7.3897e-02],
         [-2.2184e-01, -6.5384e-02],
         [-1.9965e-01, -9.2545e-02],
         [-2.1033e-01, -1.2405e-01],
         [-2.1968e-01, -1.5354e-01],
         [-2.2546e-01,  1.1539e-01],
         [-1.8368e-01,  1.1476e-01],
         [-1.9262e-01, -1.6460e-01],
         [-1.8349e-01, -1.4127e-01],
         [-1.6329e-01, -1.4983e-01],
         [ 3.3602e-03, -1.5908e-01],
         [ 2.9334e-02, -1.6577e-01],
         [ 4.1687e-02, -1.6987e-01],
         [ 4.7262e-02, -1.6147e-01],
         [ 4.9526e-02, -1.5784e-01],
         [ 5.0302e-02, -1.6736e-01],
         [ 5.0450e-02, -1.5729e-01],
         [ 5.0377e-02, -1.6910e-01],
         [ 5.0258e-02, -1.6804e-01],
         [ 5.0170e-02, -1.8278e-01],
         [ 5.0082e-02, -1.7968e-01],
         [ 5.0056e-02, -1.7803e-01],
         [ 5.0041e-02, -1.5856e-01],
         [ 5.0034e-02, -1.5340e-01],
         [ 5.0018e-02, -1.4143e-01],
         [ 5.0013e-02, -1.7978e-01],
         [ 5.0012e-02, -1.9161e-01],
         [ 5.0011e-02, -1.6047e-01],
         [ 5.0013e-02, -1.5245e-01],
         [ 5.0014e-02, -1.3224e-01],
         [ 5.0016e-02, -1.3536e-01],
         [ 5.0008e-02, -1.4431e-01],
         [ 5.0008e-02,  1.0803e-01],
         [ 5.0007e-02, -1.5655e-01],
         [ 5.0007e-02, -1.9024e-01],
         [ 5.0008e-02, -1.5738e-01],
         [ 5.0008e-02, -1.3075e-01],
         [ 5.0008e-02, -1.3200e-01],
         [ 5.0008e-02, -1.2322e-01],
         [ 5.0008e-02, -1.6578e-01],
         [ 5.0008e-02, -1.9456e-01],
         [ 5.0008e-02, -2.0078e-01],
         [ 5.0009e-02, -1.9335e-01],
         [ 5.0009e-02, -1.9052e-01],
         [ 5.0009e-02, -2.0393e-01],
         [ 5.0009e-02, -1.8720e-01],
         [ 5.0009e-02, -1.7166e-01],
         [ 5.0009e-02, -1.8956e-01],
         [ 5.0009e-02, -1.6913e-01],
         [ 5.0009e-02, -7.5836e-04]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(0.0001, device='cuda:0') tensor(0.0016, device='cuda:0') tensor(-0.0013, device='cuda:0')
mixer_td_error tensor(0.3255, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4580, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3361, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0285, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1036, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0892, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1129032.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1526, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.2436e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0009, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1326, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2684, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1326, device='cuda:0', grad_fn=<MinBackward1>)
t_env 7112
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2179e-02,  8.7653e-02,  ...,  1.1971e-02,
            1.4701e-01, -1.0000e+07],
          [-1.0000e+07, -3.7128e-02,  1.3220e-01,  ...,  9.6965e-03,
            1.4422e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0670e-01,  9.3996e-02,  ...,  1.3476e-02,
            1.4757e-01, -1.0000e+07],
          [-1.0000e+07, -5.6947e-02,  1.4811e-01,  ...,  1.4058e-03,
            1.5377e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.7344e-02,  8.2773e-02,  ...,  5.5160e-04,
            1.4831e-01, -1.0000e+07],
          [-1.0000e+07, -2.7700e-02,  1.3816e-01,  ..., -4.3951e-03,
            1.4720e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6811e-02,  8.2313e-02,  ...,  4.0371e-03,
            1.5378e-01, -1.0000e+07],
          [-1.0000e+07, -2.8490e-02,  1.3545e-01,  ..., -1.7911e-02,
            1.4236e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7243e-01,  1.1992e-01,  ...,  5.7868e-02,
            1.6752e-01, -3.1066e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7064e-01,  1.1772e-01,  ...,  5.0580e-02,
            1.6038e-01, -3.0600e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-6.6528e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-9.5620e-02, -1.6811e-02],
         [-9.2179e-02, -3.7128e-02],
         [-1.0670e-01, -5.6947e-02],
         [-8.7874e-02, -6.5921e-02],
         [-1.0109e-01, -7.1549e-02],
         [-8.6052e-02, -7.4454e-02],
         [-9.1497e-02, -7.4545e-02],
         [-8.8709e-02, -7.2704e-02],
         [-7.0546e-02, -6.7783e-02],
         [-5.9152e-02, -6.8085e-02],
         [-4.8828e-02, -6.7527e-02],
         [-6.9417e-02, -6.3172e-02],
         [-5.5009e-02, -8.5916e-02],
         [-7.4783e-02, -1.0278e-01],
         [-6.5360e-02, -9.9116e-02],
         [-6.2902e-02, -7.8468e-02],
         [-6.3644e-02, -7.1063e-02],
         [-5.2165e-02, -6.1032e-02],
         [-5.1552e-02, -5.6546e-02],
         [-5.4172e-02, -5.1234e-02],
         [-2.4465e-02, -5.9684e-02],
         [-6.0128e-02, -7.4352e-02],
         [-3.5283e-02, -6.9150e-02],
         [-4.9939e-02, -5.7192e-02],
         [-7.9141e-02, -7.1313e-02],
         [-9.5164e-02, -8.1111e-02],
         [-6.4217e-02, -8.0462e-02],
         [-6.3678e-02, -7.4813e-02],
         [-2.5612e-02, -7.2430e-02],
         [-1.4126e-02, -6.9868e-02],
         [-2.5521e-02, -6.4976e-02],
         [-6.8231e-03, -6.3075e-02],
         [-2.6686e-02, -7.9021e-02],
         [-4.2579e-02, -6.9711e-02],
         [-5.3547e-02, -5.1439e-02],
         [-6.2517e-02, -6.0200e-02],
         [-5.0918e-02, -5.0283e-02],
         [-5.2291e-02,  1.7630e-01],
         [-8.6846e-02,  1.8885e-01],
         [-1.3812e-01,  1.9391e-01],
         [-1.0887e-01, -4.8236e-02],
         [-7.6975e-02,  1.9103e-01],
         [-1.0247e-01, -6.6702e-02],
         [-1.4506e-01, -9.2262e-02],
         [-1.1808e-01, -9.9908e-02],
         [-1.1758e-01, -1.1504e-01],
         [-1.1669e-01, -1.2703e-01],
         [-1.3211e-01,  2.0479e-01],
         [-1.2830e-01,  1.8895e-01],
         [-1.4747e-01, -1.1133e-01],
         [-1.7442e-01, -1.0725e-01],
         [-1.6207e-01,  1.8522e-01],
         [-1.6713e-01, -1.5036e-01],
         [-1.7047e-01, -1.4508e-01],
         [-1.6589e-01, -1.1604e-01],
         [-1.4850e-01, -1.4168e-01],
         [-1.6353e-01, -1.3823e-01],
         [-1.6890e-01, -1.4117e-01],
         [ 2.1132e-03, -1.4526e-01],
         [ 2.6834e-02, -1.5433e-01],
         [ 3.9943e-02, -1.2875e-01],
         [ 4.6352e-02, -1.3295e-01],
         [ 4.9214e-02, -1.1928e-01],
         [ 5.0319e-02, -1.0100e-01],
         [ 5.0604e-02, -7.7991e-02],
         [ 5.0568e-02, -7.0598e-02],
         [ 5.0458e-02, -5.6308e-02],
         [ 5.0300e-02,  2.0292e-01],
         [ 5.0204e-02,  2.1013e-01],
         [ 5.0123e-02, -8.8178e-02],
         [ 5.0097e-02,  2.2214e-01],
         [ 5.0035e-02,  2.1014e-01],
         [ 5.0035e-02,  2.1966e-01],
         [ 5.0014e-02, -1.2066e-01],
         [ 5.0021e-02, -1.3605e-01],
         [ 5.0019e-02, -1.3645e-01],
         [ 5.0017e-02, -1.3791e-01],
         [ 5.0014e-02, -1.5621e-01],
         [ 5.0005e-02, -1.6822e-01],
         [ 5.0007e-02, -1.6028e-01],
         [ 5.0007e-02, -1.4463e-01],
         [ 5.0007e-02, -1.2715e-01],
         [ 5.0008e-02,  2.1789e-01],
         [ 5.0008e-02,  2.1358e-01],
         [ 5.0008e-02,  2.2575e-01],
         [ 5.0008e-02, -1.4828e-01],
         [ 5.0008e-02, -1.5016e-01],
         [ 5.0008e-02, -1.4859e-01],
         [ 5.0008e-02, -1.5771e-01],
         [ 5.0009e-02, -1.5878e-01],
         [ 5.0009e-02, -1.6963e-01],
         [ 5.0009e-02, -1.7200e-01],
         [ 5.0009e-02, -1.6601e-01],
         [ 5.0009e-02, -1.6172e-01],
         [ 5.0009e-02, -1.6512e-01],
         [ 5.0009e-02, -1.6362e-01],
         [ 5.0009e-02,  3.7007e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-7.8849e-02, -8.8067e-03],
         [-8.7344e-02, -2.7700e-02],
         [-9.6811e-02, -2.8490e-02],
         [-9.2285e-02, -5.4247e-02],
         [-9.6350e-02, -6.1587e-02],
         [-1.0725e-01, -3.6431e-02],
         [-1.3159e-01, -3.2421e-02],
         [-1.4722e-01, -4.7224e-02],
         [-1.4919e-01, -6.6884e-02],
         [-1.4913e-01, -7.0551e-02],
         [-1.6325e-01, -7.0068e-02],
         [-1.4422e-01, -7.3530e-02],
         [-1.6516e-01, -5.3220e-02],
         [-1.7068e-01, -4.5584e-02],
         [-1.8190e-01, -4.7344e-02],
         [-1.7578e-01, -6.6601e-02],
         [-1.5258e-01, -5.8787e-02],
         [-1.4507e-01, -8.2150e-02],
         [-1.4907e-01, -8.4423e-02],
         [-1.5266e-01, -1.1851e-01],
         [-1.4777e-01, -9.5416e-02],
         [-1.7006e-01, -8.5605e-02],
         [ 2.1963e-01, -8.2917e-02],
         [ 2.0086e-01, -1.2039e-01],
         [ 1.8839e-01, -1.4465e-01],
         [ 1.8455e-01, -1.3898e-01],
         [ 1.7705e-01, -1.4732e-01],
         [-1.5244e-01, -1.4905e-01],
         [-1.4497e-01, -1.4680e-01],
         [ 1.5910e-01, -1.4995e-01],
         [ 1.4337e-01, -1.5059e-01],
         [ 1.4628e-01, -1.4255e-01],
         [ 1.8332e-01, -1.7186e-01],
         [ 1.6663e-01, -1.4717e-01],
         [ 1.6032e-01, -1.7157e-01],
         [ 1.8082e-01, -1.8463e-01],
         [-9.0817e-02, -1.6323e-01],
         [ 1.6173e-01, -1.2269e-01],
         [-1.3022e-01, -1.1186e-01],
         [-1.0319e-01, -9.8418e-02],
         [-1.1916e-01, -1.0483e-01],
         [-9.4611e-02, -9.4788e-02],
         [-1.1749e-01, -1.1754e-01],
         [-1.5910e-01, -1.2918e-01],
         [ 1.4819e-01, -1.2892e-01],
         [-8.2954e-02,  1.8744e-02],
         [-6.7912e-02,  3.9393e-02],
         [-7.9022e-02,  4.9066e-02],
         [-8.5212e-02,  5.3184e-02],
         [ 1.7661e-01,  5.4741e-02],
         [ 1.6748e-01,  5.5223e-02],
         [-9.2447e-02,  5.5269e-02],
         [-8.5573e-02,  5.5275e-02],
         [ 1.8305e-01,  5.5215e-02],
         [ 1.9937e-01,  5.5200e-02],
         [-1.1054e-01,  5.5184e-02],
         [-1.3067e-01,  5.5173e-02],
         [-1.2419e-01,  5.5206e-02],
         [-7.4058e-02,  5.5178e-02],
         [-7.7624e-02,  5.5220e-02],
         [-8.0306e-02,  5.5202e-02],
         [-8.0839e-02,  5.5203e-02],
         [ 1.7134e-01,  5.5206e-02],
         [ 1.9006e-01,  5.5206e-02],
         [ 1.6023e-01,  5.5223e-02],
         [ 1.6884e-01,  5.5225e-02],
         [-8.8727e-02,  5.5232e-02],
         [-7.7824e-02,  5.5230e-02],
         [-7.4048e-02,  5.5230e-02],
         [-7.3776e-02,  5.5231e-02],
         [-6.9527e-02,  5.5236e-02],
         [-8.3634e-02,  5.5235e-02],
         [-7.6159e-02,  5.5232e-02],
         [-6.8195e-02,  5.5232e-02],
         [-8.5686e-02,  5.5231e-02],
         [ 1.7010e-01,  5.5231e-02],
         [ 1.7227e-01,  5.5231e-02],
         [ 1.8852e-01,  5.5231e-02],
         [ 1.9895e-01,  5.5231e-02],
         [-1.5049e-01,  5.5231e-02],
         [-1.1948e-01,  5.5231e-02],
         [-1.2967e-01,  5.5231e-02],
         [-1.1645e-01,  5.5231e-02],
         [-1.0706e-01,  5.5231e-02],
         [-7.2081e-02,  5.5231e-02],
         [-8.8205e-02,  5.5231e-02],
         [-1.1387e-01,  5.5231e-02],
         [ 2.0620e-01,  5.5231e-02],
         [-1.2867e-01,  5.5231e-02],
         [-1.2206e-01,  5.5231e-02],
         [-1.2955e-01,  5.5231e-02],
         [-8.6089e-02,  5.5231e-02],
         [-7.1215e-02,  5.5231e-02],
         [-9.3166e-02,  5.5231e-02],
         [-1.3008e-01,  5.5231e-02],
         [-1.6149e-01,  5.5231e-02],
         [-1.7980e-01,  5.5231e-02],
         [-1.5770e-01,  5.5231e-02],
         [-1.8069e-01,  5.5231e-02],
         [-1.5671e-01,  5.5231e-02],
         [ 1.7830e-01,  5.5231e-02],
         [ 1.9021e-01,  5.5231e-02],
         [ 1.8558e-01,  5.5231e-02],
         [ 1.8859e-01,  5.5231e-02],
         [-1.4070e-01,  5.5231e-02],
         [-1.5534e-01,  5.5231e-02],
         [-1.7844e-01,  5.5231e-02],
         [-1.7243e-01,  5.5231e-02],
         [-1.7064e-01,  5.5231e-02],
         [-6.6528e-04,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.4098e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.1110, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4525, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4576, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0105, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1058, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1665, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-590909., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2258, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.1207e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3008, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2032, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3008, device='cuda:0', grad_fn=<MinBackward1>)
t_env 7412
target_mac_out tensor([[[[-1.0000e+07, -9.3745e-02,  1.1397e-01,  ...,  6.2087e-02,
            1.3778e-01, -1.0000e+07],
          [-1.0000e+07, -2.4539e-02,  9.4233e-02,  ..., -1.0851e-02,
            1.2427e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.7459e-02,  9.8722e-02,  ...,  1.3931e-02,
            1.3959e-01, -1.0000e+07],
          [-1.0000e+07, -6.3419e-02,  1.4570e-01,  ...,  3.8138e-02,
            1.4407e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0222e-01,  1.1143e-01,  ...,  1.4510e-02,
            1.5951e-01, -1.0000e+07],
          [-1.0000e+07, -9.0719e-02,  1.6389e-01,  ...,  6.4728e-02,
            1.5741e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.4360e-02,  7.4236e-02,  ...,  6.2640e-03,
            1.2703e-01, -1.0000e+07],
          [-1.0000e+07, -7.0404e-02,  1.5810e-01,  ...,  4.6388e-02,
            1.4908e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0383e-01,  9.7922e-02,  ...,  1.2565e-02,
            1.4072e-01, -1.0000e+07],
          [-1.0000e+07, -9.8419e-02,  1.7124e-01,  ...,  6.4498e-02,
            1.6552e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.8144e-01,  1.2583e-01,  ...,  5.7234e-02,
            1.8553e-01, -2.8808e-01],
          [ 5.5235e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.8626e-01,  1.1949e-01,  ...,  5.1140e-02,
            1.8170e-01, -2.9839e-01],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 8.9068e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-9.3745e-02, -2.4539e-02],
         [-8.7459e-02, -6.3419e-02],
         [-1.0222e-01, -9.0719e-02],
         [-1.4442e-01, -1.1371e-01],
         [ 1.5535e-01, -1.2767e-01],
         [-1.7386e-01, -1.2692e-01],
         [-1.5844e-01, -1.1938e-01],
         [-1.5744e-01, -1.3899e-01],
         [-1.6118e-01, -1.5317e-01],
         [-1.6774e-01,  1.9280e-01],
         [-1.7495e-01,  1.8350e-01],
         [-1.5663e-01,  1.9376e-01],
         [-1.5046e-01, -1.5137e-01],
         [-1.7985e-01, -1.4826e-01],
         [-1.9605e-01, -1.5834e-01],
         [-1.9518e-01, -1.4299e-01],
         [-1.9029e-01, -1.3082e-01],
         [-1.5933e-01, -1.2344e-01],
         [-1.6242e-01, -1.2573e-01],
         [-1.6222e-01, -1.2944e-01],
         [-1.8674e-01, -1.3383e-01],
         [-1.9336e-01, -1.3300e-01],
         [-2.0650e-01, -1.4855e-01],
         [-1.8899e-01, -1.4654e-01],
         [-2.0589e-01, -1.5220e-01],
         [-1.8279e-01, -1.5401e-01],
         [-1.8436e-01, -1.6974e-01],
         [-2.1361e-01, -1.7178e-01],
         [-2.1082e-01, -1.6356e-01],
         [-2.0826e-01, -1.6338e-01],
         [-9.7110e-02, -1.6304e-01],
         [-2.1599e-01, -1.4662e-01],
         [-7.0976e-02, -1.4016e-01],
         [-8.5675e-02, -1.4101e-01],
         [ 2.0504e-01,  3.4605e-03],
         [ 2.0150e-01,  3.3985e-02],
         [ 2.2224e-01,  4.7351e-02],
         [ 2.0887e-01,  5.2776e-02],
         [ 2.0285e-01,  5.4770e-02],
         [ 2.1791e-01,  5.5340e-02],
         [ 2.0980e-01,  5.5415e-02],
         [-1.9692e-01,  5.5387e-02],
         [-1.7650e-01,  5.5311e-02],
         [-1.7224e-01,  5.5234e-02],
         [-1.6971e-01,  5.5215e-02],
         [-7.9893e-03,  5.5204e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-4.5201e-02, -4.8984e-02],
         [-6.4360e-02, -7.0404e-02],
         [-1.0383e-01, -9.8419e-02],
         [-7.6672e-02,  2.0227e-01],
         [-3.2289e-02, -1.5808e-01],
         [-5.7887e-02,  1.9812e-01],
         [-3.5895e-02,  2.1514e-01],
         [-4.3093e-02,  2.0576e-01],
         [-3.8140e-02,  2.2164e-01],
         [ 1.7710e-01,  2.0909e-01],
         [-4.5152e-02, -1.4846e-01],
         [-4.1867e-02, -1.3511e-01],
         [-7.2028e-02, -1.3788e-01],
         [-8.4416e-02, -1.3934e-01],
         [-1.0232e-01, -1.2265e-01],
         [-8.6635e-02, -1.5917e-01],
         [-1.1939e-01, -1.4443e-01],
         [-1.0085e-01,  2.1529e-01],
         [-1.0504e-01, -1.7636e-01],
         [-9.6449e-02, -1.7051e-01],
         [-1.2791e-01, -1.3034e-01],
         [-1.0761e-01, -1.4796e-01],
         [-6.2876e-02,  1.9309e-02],
         [-7.0186e-02,  4.1537e-02],
         [-7.8832e-02,  5.1971e-02],
         [-9.9095e-02,  5.5940e-02],
         [-1.3078e-01,  5.6931e-02],
         [-1.5062e-01,  5.6799e-02],
         [-1.5289e-01,  5.6349e-02],
         [-1.7373e-01,  5.5964e-02],
         [-1.3813e-01,  5.5651e-02],
         [ 9.1571e-02,  5.5474e-02],
         [ 1.0848e-01,  5.5348e-02],
         [ 1.9142e-01,  5.5283e-02],
         [ 8.3342e-02,  5.5242e-02],
         [-1.3893e-01,  5.5190e-02],
         [-1.4382e-01,  5.5229e-02],
         [ 1.8613e-01,  5.5209e-02],
         [-1.7081e-01,  5.5214e-02],
         [ 1.8880e-01,  5.5203e-02],
         [ 2.0258e-01,  5.5219e-02],
         [-1.7438e-01,  5.5224e-02],
         [ 1.7577e-01,  5.5226e-02],
         [ 1.7443e-01,  5.5230e-02],
         [-1.7601e-01,  5.5230e-02],
         [ 1.9371e-01,  5.5230e-02],
         [ 9.5536e-02,  5.5232e-02],
         [-2.6119e-01,  5.5236e-02],
         [-2.8808e-01,  5.5235e-02],
         [-1.8626e-01,  5.5232e-02],
         [ 8.9068e-03,  5.5232e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(7.0892e-05, device='cuda:0') tensor(0.0026, device='cuda:0') tensor(-0.0020, device='cuda:0')
mixer_td_error tensor(0.1408, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4553, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7022, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0124, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1096, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1393, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-490196.0625, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2222, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0014, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3198, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2555, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3198, device='cuda:0', grad_fn=<MinBackward1>)
t_env 7465
target_mac_out tensor([[[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6454e-02,  9.8041e-02,  ...,  2.6212e-02,
            1.4254e-01, -1.0000e+07],
          [-1.0000e+07, -6.9791e-02,  1.1912e-01,  ...,  2.3814e-02,
            1.4958e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0073e-01,  1.1228e-01,  ...,  2.1527e-02,
            1.5677e-01, -1.0000e+07],
          [-1.0000e+07, -7.4430e-02,  1.2619e-01,  ...,  2.5142e-02,
            1.4711e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0575e-01,  1.1552e-01,  ...,  5.7407e-02,
            1.7511e-01, -3.2794e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1218e-01,  1.1068e-01,  ...,  5.6260e-02,
            1.7721e-01, -3.2753e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.7746e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2179e-02,  8.7653e-02,  ...,  1.1971e-02,
            1.4701e-01, -1.0000e+07],
          [-1.0000e+07, -3.7128e-02,  1.3220e-01,  ...,  9.6965e-03,
            1.4422e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0670e-01,  9.3996e-02,  ...,  1.3476e-02,
            1.4757e-01, -1.0000e+07],
          [-1.0000e+07, -5.6947e-02,  1.4811e-01,  ...,  1.4058e-03,
            1.5377e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.5201e-02, -4.8984e-02],
         [-7.6454e-02, -6.9791e-02],
         [-1.0073e-01, -7.4430e-02],
         [-9.7914e-02, -9.7806e-02],
         [-9.3815e-02, -1.0272e-01],
         [-6.9760e-02,  7.2421e-02],
         [-7.9699e-02,  9.9376e-02],
         [-9.4670e-02, -1.3090e-01],
         [-1.1410e-01, -8.7246e-02],
         [-1.0847e-01, -6.6225e-02],
         [-1.1888e-01, -6.7477e-02],
         [-1.0693e-01, -7.5210e-02],
         [-8.7417e-02, -7.5946e-02],
         [-7.5781e-02, -7.1461e-02],
         [-7.2878e-02, -1.0398e-01],
         [-7.7453e-02, -1.2368e-01],
         [-9.4343e-02, -1.2195e-01],
         [-1.1193e-01, -1.3461e-01],
         [-1.1238e-01, -1.2465e-01],
         [-1.3058e-01, -1.0396e-01],
         [-1.4276e-01, -1.0438e-01],
         [-1.3949e-01, -1.0067e-01],
         [-1.2686e-01, -1.2077e-01],
         [-1.2425e-01, -1.3145e-01],
         [-1.4008e-01, -1.4247e-01],
         [-1.4286e-01, -1.4571e-01],
         [-1.3649e-01, -1.5089e-01],
         [-1.3430e-01, -1.4975e-01],
         [-1.2127e-01, -1.3664e-01],
         [-1.2921e-01, -1.2962e-01],
         [-1.6403e-01, -1.2397e-01],
         [-1.7723e-01, -1.2776e-01],
         [-1.6051e-01, -1.1364e-01],
         [-1.4597e-01, -1.0477e-01],
         [-1.0834e-01, -1.0646e-01],
         [-9.9828e-02, -1.2416e-01],
         [-1.1557e-01, -2.0544e-02],
         [-1.4668e-01,  2.3882e-02],
         [-1.1204e-01,  4.3476e-02],
         [-1.1647e-01,  5.1597e-02],
         [-1.4404e-01,  5.4689e-02],
         [ 1.2592e-01,  5.5643e-02],
         [ 1.3374e-01,  5.5776e-02],
         [-1.6796e-01,  5.5666e-02],
         [ 1.1648e-01,  5.5511e-02],
         [-1.4817e-01,  5.5378e-02],
         [ 1.0117e-01,  5.5285e-02],
         [ 1.0704e-01,  5.5246e-02],
         [-1.3101e-01,  5.5226e-02],
         [ 9.7130e-02,  5.5235e-02],
         [-1.2176e-01,  5.5201e-02],
         [ 9.3174e-02,  5.5199e-02],
         [-1.0662e-01,  5.5208e-02],
         [-1.2003e-01,  5.5219e-02],
         [-1.1678e-01,  5.5216e-02],
         [-1.1802e-01,  5.5218e-02],
         [-1.1966e-01,  5.5227e-02],
         [-1.1406e-01,  5.5232e-02],
         [-1.0622e-01,  5.5230e-02],
         [-1.0048e-01,  5.5230e-02],
         [-8.5366e-02,  5.5231e-02],
         [-9.5783e-02,  5.5236e-02],
         [-1.1754e-01,  5.5235e-02],
         [-1.1608e-01,  5.5232e-02],
         [-9.8317e-02,  5.5232e-02],
         [-1.1723e-01,  5.5231e-02],
         [ 9.9461e-02,  5.5231e-02],
         [-9.9766e-02,  5.5231e-02],
         [-8.1074e-02,  5.5231e-02],
         [-9.6020e-02,  5.5231e-02],
         [-7.4372e-02,  5.5231e-02],
         [-9.0995e-02,  5.5231e-02],
         [-1.0425e-01,  5.5231e-02],
         [-8.3496e-02,  5.5231e-02],
         [-8.9426e-02,  5.5231e-02],
         [-1.0672e-01,  5.5231e-02],
         [-1.0416e-01,  5.5231e-02],
         [-1.1828e-01,  5.5231e-02],
         [-9.3662e-02,  5.5231e-02],
         [-1.0894e-01,  5.5231e-02],
         [-8.0988e-02,  5.5231e-02],
         [-6.5458e-02,  5.5231e-02],
         [-5.4783e-02,  5.5231e-02],
         [-4.2284e-02,  5.5231e-02],
         [-3.7984e-02,  5.5231e-02],
         [-4.1981e-02,  5.5231e-02],
         [-6.4957e-02,  5.5231e-02],
         [-6.8494e-02,  5.5231e-02],
         [-8.9018e-02,  5.5231e-02],
         [-6.4930e-02,  5.5231e-02],
         [-5.2584e-02,  5.5231e-02],
         [-1.6482e-02,  5.5231e-02],
         [-4.8175e-02,  5.5231e-02],
         [-6.2841e-02,  5.5231e-02],
         [-5.0349e-02,  5.5231e-02],
         [-3.7229e-02,  5.5231e-02],
         [-4.9564e-02,  5.5231e-02],
         [-6.8678e-02,  5.5231e-02],
         [-8.8382e-02,  5.5231e-02],
         [-8.4055e-02,  5.5231e-02],
         [-5.8359e-02,  5.5231e-02],
         [-1.9431e-02,  5.5231e-02],
         [-1.8759e-02,  5.5231e-02],
         [-5.2005e-02,  5.5231e-02],
         [-7.9434e-02,  5.5231e-02],
         [-9.1158e-02,  5.5231e-02],
         [-8.4884e-02,  5.5231e-02],
         [-8.3419e-02,  5.5231e-02],
         [-8.6405e-02,  5.5231e-02],
         [-8.5407e-02,  5.5231e-02],
         [-8.0558e-02,  5.5231e-02],
         [-9.5194e-02,  5.5231e-02],
         [-9.2530e-02,  5.5231e-02],
         [-7.6547e-02,  5.5231e-02],
         [-7.6282e-02,  5.5231e-02],
         [-2.1377e-02,  5.5231e-02],
         [-2.1971e-02,  5.5231e-02],
         [-4.2730e-02,  5.5231e-02],
         [-3.5601e-02,  5.5231e-02],
         [-3.8748e-02,  5.5231e-02],
         [-8.4820e-03,  5.5231e-02],
         [-6.1485e-03,  5.5231e-02],
         [-1.3235e-02,  5.5231e-02],
         [ 2.4327e-03,  5.5231e-02],
         [-7.3893e-03,  5.5231e-02],
         [-4.5372e-02,  5.5231e-02],
         [-5.7264e-02,  5.5231e-02],
         [-7.5313e-02,  5.5231e-02],
         [-7.8540e-02,  5.5231e-02],
         [-9.7576e-02,  5.5231e-02],
         [-9.4656e-02,  5.5231e-02],
         [-9.0396e-02,  5.5231e-02],
         [-7.0770e-02,  5.5231e-02],
         [-7.1266e-02,  5.5231e-02],
         [-7.6003e-02,  5.5231e-02],
         [-7.9034e-02,  5.5231e-02],
         [-9.5928e-02,  5.5231e-02],
         [-3.6010e-02,  5.5231e-02],
         [-3.1493e-02,  5.5231e-02],
         [-3.0247e-02,  5.5231e-02],
         [-3.6103e-02,  5.5231e-02],
         [-5.9124e-02,  5.5231e-02],
         [-7.5796e-02,  5.5231e-02],
         [-1.0985e-01,  5.5231e-02],
         [-1.3811e-01,  5.5231e-02],
         [-1.0724e-01,  5.5231e-02],
         [-9.6694e-02,  5.5231e-02],
         [-1.0630e-01,  5.5231e-02],
         [-6.6975e-02,  5.5231e-02],
         [-7.5675e-02,  5.5231e-02],
         [-6.6594e-02,  5.5231e-02],
         [-7.5006e-02,  5.5231e-02],
         [-9.6974e-02,  5.5231e-02],
         [-1.0301e-01,  5.5231e-02],
         [-1.2914e-01,  5.5231e-02],
         [-1.4696e-01,  5.5231e-02],
         [ 1.3105e-01,  5.5231e-02],
         [ 1.3519e-01,  5.5231e-02],
         [-1.6143e-01,  5.5231e-02],
         [ 1.1483e-01,  5.5231e-02],
         [ 1.1990e-01,  5.5231e-02],
         [ 1.1759e-01,  5.5231e-02],
         [ 1.1518e-01,  5.5231e-02],
         [ 1.4205e-01,  5.5231e-02],
         [ 1.0749e-01,  5.5231e-02],
         [ 1.4153e-01,  5.5231e-02],
         [ 1.0763e-01,  5.5231e-02],
         [-2.0946e-01,  5.5231e-02],
         [ 1.3073e-01,  5.5231e-02],
         [ 1.2880e-01,  5.5231e-02],
         [ 1.3816e-01,  5.5231e-02],
         [ 1.4230e-01,  5.5231e-02],
         [ 1.1640e-01,  5.5231e-02],
         [-2.0322e-01,  5.5231e-02],
         [-2.0575e-01,  5.5231e-02],
         [-3.2753e-01,  5.5231e-02],
         [ 2.7746e-03,  5.5231e-02]],

        [[-9.5620e-02, -1.6811e-02],
         [-9.2179e-02, -3.7128e-02],
         [-1.0670e-01, -5.6947e-02],
         [-8.7874e-02, -6.5921e-02],
         [-1.0109e-01, -7.1549e-02],
         [-8.6052e-02, -7.4454e-02],
         [-9.1497e-02, -7.4545e-02],
         [-8.8709e-02, -7.2704e-02],
         [-7.0546e-02, -6.7783e-02],
         [-5.9152e-02, -6.8085e-02],
         [-4.8828e-02, -6.7527e-02],
         [-6.9417e-02, -6.3172e-02],
         [-5.5009e-02, -8.5916e-02],
         [-7.4783e-02, -1.0278e-01],
         [-6.5360e-02, -9.9116e-02],
         [-6.2902e-02, -7.8468e-02],
         [-6.3644e-02, -7.1063e-02],
         [-5.2165e-02, -6.1032e-02],
         [-5.1552e-02, -5.6546e-02],
         [-5.4172e-02, -5.1234e-02],
         [-2.4465e-02, -5.9684e-02],
         [-6.0128e-02, -7.4352e-02],
         [-3.5283e-02, -6.9150e-02],
         [-4.9939e-02, -5.7192e-02],
         [-7.9141e-02, -7.1313e-02],
         [-9.5164e-02, -8.1111e-02],
         [-6.4217e-02, -8.0462e-02],
         [-6.3678e-02, -7.4813e-02],
         [-2.5612e-02, -7.2430e-02],
         [-1.4126e-02, -6.9868e-02],
         [-2.5521e-02, -6.4976e-02],
         [-6.8231e-03, -6.3075e-02],
         [-2.6686e-02, -7.9021e-02],
         [-4.2579e-02, -6.9711e-02],
         [-5.3547e-02, -5.1439e-02],
         [-6.2517e-02, -6.0200e-02],
         [-5.0918e-02, -5.0283e-02],
         [-5.2291e-02, -5.0556e-02],
         [-8.6846e-02, -5.6060e-02],
         [-1.3812e-01,  7.9019e-02],
         [-1.0887e-01, -4.8236e-02],
         [-7.6975e-02,  7.3724e-02],
         [-1.0247e-01,  1.2215e-01],
         [-1.4506e-01,  1.3957e-01],
         [-1.1808e-01,  1.1359e-01],
         [-1.1758e-01,  1.3199e-01],
         [-1.1669e-01,  1.3972e-01],
         [-1.3211e-01,  1.1514e-01],
         [-1.2830e-01,  1.3961e-01],
         [ 1.8867e-01, -1.1133e-01],
         [-2.9813e-01,  9.1089e-02],
         [-1.6207e-01,  1.2953e-01],
         [-1.6713e-01,  1.6884e-01],
         [-1.7047e-01,  1.3433e-01],
         [-2.6784e-01, -1.1604e-01],
         [-1.4850e-01,  1.4826e-01],
         [-1.6353e-01,  1.2821e-01],
         [-2.6481e-01, -1.4117e-01],
         [ 2.1132e-03,  1.1829e-01],
         [ 2.6834e-02,  1.2756e-01],
         [ 3.9943e-02, -1.2875e-01],
         [ 4.6352e-02, -1.3295e-01],
         [ 4.9214e-02, -1.1928e-01],
         [ 5.0319e-02, -1.0100e-01],
         [ 5.0604e-02,  4.7600e-02],
         [ 5.0568e-02,  8.0804e-02],
         [ 5.0458e-02,  5.6413e-02],
         [ 5.0300e-02,  7.9092e-02],
         [ 5.0204e-02,  9.1574e-02],
         [ 5.0123e-02, -8.8178e-02],
         [ 5.0097e-02,  8.4628e-02],
         [ 5.0035e-02, -9.5127e-02],
         [ 5.0035e-02,  7.8432e-02],
         [ 5.0014e-02,  1.0533e-01],
         [ 5.0021e-02,  1.1583e-01],
         [ 5.0019e-02, -1.3645e-01],
         [ 5.0017e-02, -1.3791e-01],
         [ 5.0014e-02, -1.5621e-01],
         [ 5.0005e-02,  8.8978e-02],
         [ 5.0007e-02, -1.6028e-01],
         [ 5.0007e-02, -1.4463e-01],
         [ 5.0007e-02, -1.2715e-01],
         [ 5.0008e-02,  6.9784e-02],
         [ 5.0008e-02,  5.5134e-02],
         [ 5.0008e-02,  7.8682e-02],
         [ 5.0008e-02,  9.9678e-02],
         [ 5.0008e-02, -1.5016e-01],
         [ 5.0008e-02, -1.4859e-01],
         [ 5.0008e-02, -1.5771e-01],
         [ 5.0009e-02, -1.5878e-01],
         [ 5.0009e-02, -1.6963e-01],
         [ 5.0009e-02, -1.7200e-01],
         [ 5.0009e-02, -1.6601e-01],
         [ 5.0009e-02, -1.6172e-01],
         [ 5.0009e-02, -1.6512e-01],
         [ 5.0009e-02, -1.6362e-01],
         [ 5.0009e-02,  3.7007e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.8035e-05, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0007, device='cuda:0')
mixer_td_error tensor(0.5370, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4551, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4457, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0207, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1088, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1414, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2259886.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1887, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.1145e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1991, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2515, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1991, device='cuda:0', grad_fn=<MinBackward1>)
t_env 7516
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.7245e-02,  7.9477e-02,  ...,  3.3060e-02,
            1.4031e-01, -1.0000e+07],
          [-1.0000e+07, -1.3393e-02,  1.0346e-01,  ...,  1.0057e-02,
            1.4004e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2225e-02,  6.2394e-02,  ...,  2.0084e-02,
            1.2912e-01, -1.0000e+07],
          [-1.0000e+07, -7.7190e-02,  1.6041e-01,  ...,  7.2365e-02,
            1.5573e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.0171e-02,  4.6061e-02,  ...,  4.1223e-02,
            1.3816e-01, -1.0000e+07],
          [-1.0000e+07, -1.2417e-01,  1.0542e-01,  ...,  6.0142e-02,
            1.7534e-01, -1.0000e+07]],

         ...,

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3740e-01,  4.1005e-02,  ...,  3.3463e-02,
            2.0037e-01, -1.0000e+07]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.2245e-01,  2.2864e-02,  ...,  1.2143e-02,
            1.9666e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.2287e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-7.2275e-02, -1.3772e-02],
         [-6.7838e-02, -1.4399e-02],
         [-5.7245e-02, -1.3393e-02],
         [-5.9561e-02, -1.4934e-02],
         [-5.8676e-02, -9.8598e-03],
         [-5.3396e-02, -4.9519e-02],
         [-6.7908e-02, -3.6543e-02],
         [-7.6112e-02, -1.8267e-02],
         [-6.3318e-02, -1.6147e-02],
         [-5.6005e-02, -1.5380e-02],
         [-5.6666e-02, -3.0539e-02],
         [-2.0544e-02,  7.4106e-02],
         [-5.0392e-02,  7.7855e-02],
         [-7.1271e-02,  9.2208e-02],
         [-8.3782e-02,  1.0173e-01],
         [ 1.2588e-01,  1.0544e-01],
         [ 1.5854e-01,  1.0491e-01],
         [ 1.6941e-01,  6.4716e-02],
         [ 1.8220e-01,  8.7938e-02],
         [-1.7373e-02,  5.5530e-02],
         [ 1.6643e-01,  1.0031e-01],
         [-6.4460e-02,  1.1410e-01],
         [-1.1404e-01,  1.5399e-01],
         [-1.3268e-01, -1.2380e-01],
         [-1.5103e-01, -1.2143e-01],
         [-1.5528e-01, -1.2234e-01],
         [-1.4986e-01, -1.5830e-01],
         [-1.7354e-01, -1.5532e-01],
         [-1.8436e-01,  1.1005e-01],
         [-2.1462e-01,  1.4497e-01],
         [-2.2296e-01, -1.5191e-01],
         [-2.1745e-01, -1.3592e-01],
         [-2.0641e-01, -1.2723e-01],
         [-1.8861e-01, -1.3664e-01],
         [-1.5744e-01, -1.6724e-01],
         [-1.5074e-01, -1.7934e-01],
         [-9.5712e-02, -1.8521e-01],
         [-1.0684e-01,  6.6828e-02],
         [-7.8159e-02, -1.7175e-01],
         [ 1.6213e-01, -3.1857e-01],
         [ 1.9279e-01, -3.1047e-01],
         [-8.2212e-02, -1.6263e-01],
         [-1.1251e-01,  2.9010e-02],
         [-2.9314e-01,  4.6689e-02],
         [-2.9801e-01,  5.3856e-02],
         [-3.0769e-01,  5.6210e-02],
         [-1.1622e-01,  5.6568e-02],
         [-2.8789e-01,  5.6340e-02],
         [ 1.2858e-01,  5.5960e-02],
         [-1.4134e-01,  5.5660e-02],
         [ 1.2935e-01,  5.5416e-02],
         [-2.6301e-01,  5.5306e-02],
         [-2.4671e-01,  5.5236e-02],
         [ 1.3882e-01,  5.5216e-02],
         [-3.0091e-01,  5.5202e-02],
         [-3.1448e-01,  5.5176e-02],
         [ 1.1643e-01,  5.5217e-02],
         [-9.8911e-02,  5.5210e-02],
         [-7.7241e-02,  5.5201e-02],
         [ 1.4190e-01,  5.5195e-02],
         [ 1.5536e-01,  5.5203e-02],
         [-1.2366e-01,  5.5221e-02],
         [-1.3125e-01,  5.5229e-02],
         [-1.4322e-01,  5.5231e-02],
         [ 1.2040e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.9256e-02, -4.8886e-02],
         [-6.2225e-02, -7.7190e-02],
         [-5.0171e-02, -1.2417e-01],
         [-5.5750e-02,  9.9757e-02],
         [-6.0333e-02,  1.0032e-01],
         [-4.5322e-02,  1.1083e-01],
         [-5.4950e-02,  8.8379e-02],
         [-7.1698e-02,  5.0338e-02],
         [-8.9908e-02,  4.2047e-02],
         [-8.8833e-02,  7.0947e-02],
         [-8.6353e-02,  2.1765e-01],
         [-9.3121e-02,  6.7105e-02],
         [-1.0690e-01,  8.5601e-02],
         [-1.1034e-01, -8.6728e-02],
         [-1.2086e-01, -7.3845e-02],
         [-1.2914e-01, -8.3828e-02],
         [-1.1353e-01, -8.6107e-02],
         [-1.2451e-01, -1.1008e-01],
         [-1.3116e-01, -9.6470e-02],
         [-1.1104e-01, -1.1788e-01],
         [-9.6136e-02, -9.7966e-02],
         [-8.1049e-02, -9.0314e-02],
         [-6.6191e-02, -8.6038e-02],
         [-8.5934e-02, -9.1300e-02],
         [-7.0868e-02, -8.2171e-02],
         [-9.1293e-02, -9.2198e-02],
         [-8.4688e-02, -8.6714e-02],
         [-8.0745e-02, -1.2155e-01],
         [-8.2549e-02, -1.0604e-01],
         [-9.7385e-02, -1.2388e-01],
         [-9.3445e-02, -1.3454e-01],
         [-7.9059e-02, -1.0901e-01],
         [-6.8257e-02, -1.0784e-01],
         [-6.2877e-02, -1.3352e-01],
         [-7.9941e-02, -1.0942e-01],
         [-6.9004e-02, -1.1358e-01],
         [-6.1038e-02, -9.8990e-02],
         [-4.6700e-02, -8.5677e-02],
         [-4.0838e-02, -9.0660e-02],
         [-4.2937e-02, -7.3351e-02],
         [-6.2249e-02, -6.9499e-02],
         [-6.9709e-02, -6.8537e-02],
         [-7.7115e-02, -7.3024e-02],
         [-6.8878e-02, -9.6045e-02],
         [-8.1623e-02, -9.4505e-02],
         [-6.1602e-02,  1.8391e-01],
         [-7.2736e-02, -9.3405e-02],
         [-6.3625e-02, -8.2644e-02],
         [-5.7862e-02, -8.0513e-02],
         [-6.1121e-02, -8.8742e-02],
         [-4.8498e-02, -8.1731e-02],
         [-5.2068e-02, -7.8955e-02],
         [-4.6674e-02, -8.0622e-02],
         [-5.3021e-02, -6.9637e-02],
         [-7.4812e-02, -1.0627e-01],
         [-8.4894e-02, -1.1495e-01],
         [-7.6806e-02, -1.3333e-01],
         [-9.3026e-02, -1.4517e-01],
         [-7.6624e-02, -1.2105e-01],
         [-8.6545e-02, -1.1305e-01],
         [-8.4799e-02, -1.0185e-01],
         [-8.5123e-02, -1.0816e-01],
         [-8.9595e-02,  2.0520e-01],
         [ 1.7276e-01,  2.0964e-01],
         [-1.5106e-01, -1.3494e-01],
         [-1.6078e-01, -1.6029e-01],
         [ 1.7310e-01, -1.5219e-01],
         [ 1.9181e-01, -1.7864e-01],
         [-1.7264e-01, -1.5636e-01],
         [-1.6692e-01, -1.4369e-01],
         [-1.5489e-01, -1.4515e-01],
         [-1.5891e-01, -1.5587e-01],
         [-1.7720e-01,  2.0766e-01],
         [-1.8723e-01, -1.6748e-01],
         [ 1.8473e-01, -1.6753e-01],
         [-1.9421e-01, -1.6418e-01],
         [-1.6513e-01, -1.4819e-01],
         [-1.8135e-01, -1.4315e-01],
         [-1.5843e-01, -1.3339e-01],
         [-1.7556e-01, -1.4066e-01],
         [-1.5276e-01,  9.3304e-02],
         [-1.4671e-01,  1.4008e-01],
         [-1.7118e-01,  1.6050e-01],
         [-1.5705e-01,  1.5866e-01],
         [ 3.7360e-03,  1.4849e-01],
         [ 2.4588e-02,  1.4539e-01],
         [ 3.7796e-02,  1.4573e-01],
         [ 4.4747e-02,  1.5611e-01],
         [ 4.8003e-02,  1.1793e-01],
         [ 4.9379e-02,  1.4921e-01],
         [ 4.9888e-02,  1.5403e-01],
         [ 5.0033e-02,  1.7582e-01],
         [ 5.0053e-02,  1.2957e-01],
         [ 5.0057e-02,  1.1079e-01],
         [ 5.0038e-02,  1.4044e-01],
         [ 5.0012e-02,  1.5908e-01],
         [ 5.0025e-02,  1.2157e-01],
         [ 5.0015e-02,  1.4436e-01],
         [ 5.0025e-02,  1.5183e-01],
         [ 5.0020e-02,  1.6311e-01],
         [ 5.0021e-02,  1.8162e-01],
         [ 5.0018e-02,  1.1798e-01],
         [ 5.0025e-02,  1.0133e-01],
         [ 5.0018e-02,  8.6351e-02],
         [ 5.0009e-02, -3.1955e-01],
         [ 5.0019e-02, -1.5732e-01],
         [ 5.0005e-02, -1.4853e-01],
         [ 5.0007e-02,  6.7762e-02],
         [ 5.0008e-02,  9.7635e-02],
         [ 5.0008e-02, -1.5611e-01],
         [ 5.0008e-02, -1.3327e-01],
         [ 5.0009e-02,  7.8647e-02],
         [ 5.0008e-02, -1.4467e-01],
         [ 5.0008e-02, -1.6552e-01],
         [ 5.0008e-02, -1.5647e-01],
         [ 5.0008e-02, -1.3740e-01],
         [ 5.0008e-02, -1.2245e-01],
         [ 5.0009e-02,  1.2287e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.8424e-05, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(0.5402, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4581, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4739, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0015, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1115, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1580, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2245762.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2177, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.0259e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3075, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2663, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3075, device='cuda:0', grad_fn=<MinBackward1>)
t_env 7685
target_mac_out tensor([[[[-1.0000e+07, -5.4255e-02,  8.7945e-02,  ...,  2.1998e-02,
            1.2409e-01, -1.0000e+07],
          [-1.0000e+07, -2.5887e-02,  1.2012e-01,  ...,  1.5133e-02,
            1.3440e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.9304e-02,  9.7787e-02,  ...,  1.0265e-02,
            1.3120e-01, -1.0000e+07],
          [-1.0000e+07, -7.0054e-02,  1.5427e-01,  ...,  5.5969e-02,
            1.5234e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1158e-01,  1.2211e-01,  ...,  4.4942e-02,
            1.4958e-01, -1.0000e+07],
          [-1.0000e+07, -9.6173e-02,  1.5735e-01,  ...,  4.8558e-02,
            1.4866e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7229e-02,  1.0718e-01,  ...,  1.5798e-02,
            1.3791e-01, -1.0000e+07],
          [-1.0000e+07, -6.3204e-02,  1.3937e-01,  ...,  4.1475e-02,
            1.4929e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9425e-02,  1.1495e-01,  ...,  1.2519e-02,
            1.5796e-01, -1.0000e+07],
          [-1.0000e+07, -7.3710e-02,  1.2961e-01,  ...,  3.4332e-02,
            1.4764e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.1049e-01,  9.5954e-02,  ...,  4.3549e-02,
            1.9052e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.2270e-01,  1.0282e-01,  ...,  7.2312e-02,
            2.0724e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6719e-01,  1.2207e-01,  ...,  9.9992e-02,
            2.0307e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.4255e-02, -2.5887e-02],
         [-5.9304e-02, -7.0054e-02],
         [-1.1158e-01, -9.6173e-02],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-6.8669e-02, -2.0465e-02],
         [-6.7229e-02, -6.3204e-02],
         [-8.9425e-02, -7.3710e-02],
         ...,
         [ 9.5954e-02,  5.5231e-02],
         [ 1.0282e-01,  5.5231e-02],
         [ 1.2207e-01,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-5.0380e-07, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0003, device='cuda:0')
mixer_td_error tensor(0.9210, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4575, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3153, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0389, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1162, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1677, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3750000., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2561, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.1445e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3000, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3000, device='cuda:0', grad_fn=<MinBackward1>)
t_env 7753
target_mac_out tensor([[[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.9336e-02,  8.9318e-02,  ...,  1.5729e-02,
            1.2882e-01, -1.0000e+07],
          [-1.0000e+07, -2.5640e-02,  8.8110e-02,  ..., -1.8735e-02,
            1.3277e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1056e-02,  1.1443e-01,  ...,  3.4915e-02,
            1.5353e-01, -1.0000e+07],
          [-1.0000e+07, -4.0997e-02,  1.1804e-01,  ...,  1.4397e-02,
            1.5161e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2714e-01,  1.2420e-01,  ...,  7.0546e-02,
            1.5857e-01, -1.0000e+07],
          [-1.0000e+07, -3.8311e-02,  1.3382e-01,  ...,  4.0568e-02,
            1.4396e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4124e-01,  1.2148e-01,  ...,  5.2743e-02,
            1.5640e-01, -1.0000e+07],
          [-1.0000e+07, -4.4101e-02,  1.1387e-01,  ...,  3.1959e-02,
            1.4699e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.8956e-01,  8.1104e-02,  ...,  8.0826e-02,
            2.1827e-01, -3.2595e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6913e-01,  3.3983e-02,  ...,  7.0350e-02,
            1.9429e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-7.5836e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.2377e-02, -1.1096e-02],
         [-4.9336e-02, -2.5640e-02],
         [-7.1056e-02, -4.0997e-02],
         [-6.9460e-02, -7.4962e-02],
         [-6.7570e-02, -8.5771e-02],
         [-6.7522e-02, -1.0502e-01],
         [-7.6318e-02, -1.0908e-01],
         [-8.1295e-02, -1.0003e-01],
         [-7.7815e-02, -8.5835e-02],
         [-7.8726e-02, -7.4905e-02],
         [-7.9985e-02, -7.2302e-02],
         [-7.3931e-02, -8.3730e-02],
         [-1.2334e-01, -1.1537e-01],
         [-1.2809e-01, -9.7945e-02],
         [-1.4138e-01, -8.6165e-02],
         [-1.1817e-01,  1.2577e-01],
         [-1.5807e-01,  1.3224e-01],
         [-1.7362e-01,  1.2695e-01],
         [-1.6311e-01, -9.5981e-02],
         [-1.9390e-01,  1.1503e-01],
         [-1.6438e-01,  8.7541e-02],
         [-1.6772e-01,  1.4187e-01],
         [-1.8960e-01, -1.6197e-01],
         [-1.9140e-01, -1.6502e-01],
         [-1.8055e-01,  1.2024e-01],
         [-1.6644e-01,  1.4804e-01],
         [-1.5465e-01,  1.3924e-01],
         [-1.5250e-01, -1.7326e-01],
         [-1.4539e-01,  1.5043e-01],
         [-1.3298e-01,  1.4078e-01],
         [-1.2643e-01,  9.3116e-02],
         [-1.4537e-01,  7.0636e-02],
         [-1.6045e-01, -1.0353e-01],
         [-1.4405e-01,  9.7497e-02],
         [-2.3915e-02, -1.0217e-01],
         [ 1.3968e-02, -8.9654e-02],
         [ 3.3473e-02,  6.9898e-02],
         [ 4.3011e-02,  4.8498e-02],
         [ 4.7409e-02,  9.4322e-02],
         [ 4.9303e-02,  1.0161e-01],
         [ 5.0036e-02,  1.1318e-01],
         [ 5.0220e-02,  1.2739e-01],
         [ 5.0249e-02,  8.5531e-02],
         [ 5.0166e-02, -1.5507e-01],
         [ 5.0125e-02,  1.0482e-01],
         [ 5.0075e-02, -1.6017e-01],
         [ 5.0058e-02, -1.5059e-01],
         [ 5.0032e-02,  8.0909e-02],
         [ 5.0030e-02,  1.0022e-01],
         [ 5.0018e-02, -1.4533e-01],
         [ 5.0011e-02, -1.2902e-01],
         [ 5.0027e-02, -1.3750e-01],
         [ 5.0014e-02, -1.2574e-01],
         [ 5.0018e-02, -1.3078e-01],
         [ 5.0012e-02, -1.5229e-01],
         [ 5.0006e-02,  2.6862e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-9.5620e-02, -1.6811e-02],
         [-1.2714e-01,  1.3382e-01],
         [-1.4124e-01, -4.4101e-02],
         [-1.4871e-01,  1.4507e-01],
         [-1.7136e-01, -6.5580e-02],
         [ 1.2025e-01, -6.5969e-02],
         [ 1.4318e-01, -6.4253e-02],
         [ 1.5263e-01,  7.3579e-02],
         [ 1.0886e-01,  4.0443e-02],
         [ 1.2477e-01,  6.7225e-02],
         [ 9.5833e-02,  8.9611e-02],
         [ 1.3488e-01,  9.8538e-02],
         [ 1.1366e-01,  1.0190e-01],
         [ 1.2369e-01,  6.3696e-02],
         [-1.9965e-01,  1.0651e-01],
         [ 1.3141e-01,  1.1024e-01],
         [ 1.3784e-01,  1.1873e-01],
         [ 1.3961e-01,  1.1539e-01],
         [-1.8368e-01,  1.1476e-01],
         [ 1.1373e-01,  7.9695e-02],
         [ 1.1599e-01,  5.7161e-02],
         [-1.6329e-01,  9.2768e-02],
         [ 3.3602e-03,  1.0712e-01],
         [ 2.9334e-02,  1.1335e-01],
         [ 4.1687e-02,  1.1630e-01],
         [ 4.7262e-02,  8.2573e-02],
         [ 4.9526e-02,  6.1770e-02],
         [ 5.0302e-02,  9.7265e-02],
         [ 5.0450e-02,  8.3062e-02],
         [ 5.0377e-02,  7.4437e-02],
         [ 5.0258e-02,  4.3653e-02],
         [ 5.0170e-02,  7.3025e-02],
         [ 5.0082e-02,  5.5007e-02],
         [ 5.0056e-02,  6.7122e-02],
         [ 5.0041e-02,  3.3955e-02],
         [ 5.0034e-02,  6.6691e-02],
         [ 5.0018e-02,  6.6342e-02],
         [ 5.0013e-02,  9.2782e-02],
         [ 5.0012e-02,  9.0262e-02],
         [ 5.0011e-02,  4.7279e-02],
         [ 5.0013e-02,  7.4254e-02],
         [ 5.0014e-02,  4.3679e-02],
         [ 5.0016e-02,  7.3899e-02],
         [ 5.0008e-02,  8.8205e-02],
         [ 5.0008e-02,  1.0803e-01],
         [ 5.0007e-02,  8.4232e-02],
         [ 5.0007e-02,  9.7753e-02],
         [ 5.0008e-02,  4.9929e-02],
         [ 5.0008e-02,  3.3907e-02],
         [ 5.0008e-02,  6.9812e-02],
         [ 5.0008e-02,  5.4742e-02],
         [ 5.0008e-02,  9.2425e-02],
         [ 5.0008e-02,  1.0459e-01],
         [ 5.0008e-02,  9.5812e-02],
         [ 5.0009e-02,  9.2397e-02],
         [ 5.0009e-02,  8.9915e-02],
         [ 5.0009e-02,  1.0857e-01],
         [ 5.0009e-02, -1.8720e-01],
         [ 5.0009e-02, -1.7166e-01],
         [ 5.0009e-02,  8.1104e-02],
         [ 5.0009e-02, -1.6913e-01],
         [ 5.0009e-02, -7.5836e-04]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-6.9055e-05, device='cuda:0') tensor(0.0012, device='cuda:0') tensor(-0.0021, device='cuda:0')
mixer_td_error tensor(0.0911, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4598, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4161, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0107, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1059, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1312, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-483870.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1526, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.0183e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0009, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2197, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1937, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2197, device='cuda:0', grad_fn=<MinBackward1>)
t_env 7817
target_mac_out tensor([[[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2685e-01,  1.2531e-01,  ...,  5.6976e-02,
            1.5537e-01, -1.0000e+07],
          [-1.0000e+07, -4.3705e-02,  1.3064e-01,  ...,  2.3492e-02,
            1.4040e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.5273e-01,  1.3203e-01,  ...,  6.9187e-02,
            1.6531e-01, -1.0000e+07],
          [-1.0000e+07, -5.7402e-02,  1.4496e-01,  ...,  6.9303e-03,
            1.5600e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3011e-02,  8.5302e-02,  ...,  4.7299e-02,
            1.3351e-01, -1.0000e+07],
          [-1.0000e+07, -8.3580e-02,  1.5949e-01,  ...,  7.7397e-02,
            1.5469e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0035e-02,  7.8002e-02,  ...,  4.0203e-02,
            1.2817e-01, -1.0000e+07],
          [-1.0000e+07, -9.1473e-02,  1.2838e-01,  ...,  3.2495e-02,
            1.6125e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7559e-01,  9.0813e-02,  ...,  5.2964e-02,
            1.4962e-01, -3.1952e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7815e-01,  1.0092e-01,  ...,  5.0285e-02,
            1.5588e-01, -3.1829e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-9.2490e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.7167e-02,  1.3964e-01],
         [-1.2685e-01,  1.3064e-01],
         [-1.5273e-01,  1.4496e-01],
         [-1.6599e-01,  1.2948e-01],
         [-1.7740e-01,  1.6107e-01],
         [-1.8544e-01,  1.6400e-01],
         [ 1.5178e-01,  1.6787e-01],
         [ 1.5199e-01,  1.3780e-01],
         [-1.8074e-01,  1.1280e-01],
         [-1.7465e-01,  1.5903e-01],
         [ 1.4757e-01,  1.6745e-01],
         [-1.6259e-01,  1.7520e-01],
         [-1.5812e-01,  1.5232e-01],
         [-1.5486e-01,  1.7154e-01],
         [ 1.0736e-01,  1.8412e-01],
         [ 1.1157e-01,  1.8441e-01],
         [ 1.3150e-01,  1.3735e-01],
         [ 1.4223e-01,  1.3182e-01],
         [ 1.6024e-01,  1.6434e-01],
         [-2.1238e-01,  1.4521e-01],
         [ 1.4873e-01,  1.7104e-01],
         [-2.1766e-01,  1.8520e-01],
         [ 1.3619e-01,  1.5817e-01],
         [-1.9144e-01,  1.6599e-01],
         [ 1.2923e-01,  1.7776e-01],
         [ 1.3196e-01,  1.3014e-01],
         [ 9.6369e-02,  1.5908e-01],
         [-1.9928e-01,  1.1826e-01],
         [ 1.1903e-01,  9.3231e-02],
         [ 1.4110e-01,  1.2322e-01],
         [ 1.1448e-01,  1.3126e-01],
         [ 1.2788e-01,  1.5375e-01],
         [ 9.3069e-02,  1.3033e-01],
         [ 1.2797e-01,  1.0609e-01],
         [ 1.4460e-01, -8.3475e-03],
         [ 1.3483e-01,  2.5676e-02],
         [ 1.4555e-01,  4.2396e-02],
         [ 1.5035e-01,  4.9955e-02],
         [ 1.4960e-01,  5.3175e-02],
         [ 1.3873e-01,  5.4463e-02],
         [ 9.9860e-02,  5.4920e-02],
         [ 1.2687e-01,  5.5067e-02],
         [ 9.2817e-02,  5.5112e-02],
         [ 7.6580e-02,  5.5138e-02],
         [ 6.7404e-02,  5.5125e-02],
         [-5.4720e-03,  5.5144e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-1.0152e-01,  1.4136e-01],
         [-8.3011e-02,  1.5949e-01],
         [-7.0035e-02, -9.1473e-02],
         [-1.0232e-01,  1.3565e-01],
         [-1.0471e-01,  1.5668e-01],
         [ 1.3544e-01,  1.6352e-01],
         [ 1.3959e-01,  1.3349e-01],
         [ 1.3447e-01, -1.2725e-01],
         [ 1.5084e-01,  1.3931e-01],
         [ 1.2846e-01, -1.3700e-01],
         [ 1.3975e-01,  1.3081e-01],
         [ 1.3557e-01, -1.4306e-01],
         [ 1.3442e-01, -1.4343e-01],
         [ 1.4762e-01, -1.4134e-01],
         [ 1.6755e-01, -1.2121e-01],
         [ 1.3888e-01, -1.2227e-01],
         [ 1.0996e-01, -1.4641e-01],
         [ 1.5552e-01,  1.3217e-01],
         [ 1.2878e-01,  1.3385e-01],
         [ 1.4660e-01, -1.3713e-01],
         [ 1.2377e-01, -1.1358e-01],
         [ 1.1216e-01, -9.7187e-02],
         [ 1.3138e-01, -1.0516e-01],
         [ 9.2004e-02, -9.1798e-02],
         [ 1.1616e-01, -9.3557e-02],
         [ 1.0192e-01, -1.1101e-02],
         [ 1.0965e-01,  2.6444e-02],
         [ 1.3307e-01,  4.3606e-02],
         [ 8.3517e-02,  5.1050e-02],
         [ 1.0754e-01,  5.4063e-02],
         [ 7.6421e-02,  5.5156e-02],
         [ 6.2273e-02,  5.5470e-02],
         [ 7.1631e-02,  5.5476e-02],
         [ 9.1042e-02,  5.5380e-02],
         [ 1.0280e-01,  5.5320e-02],
         [ 1.2244e-01,  5.5268e-02],
         [ 1.3275e-01,  5.5237e-02],
         [ 8.8606e-02,  5.5215e-02],
         [ 1.2092e-01,  5.5205e-02],
         [ 1.2078e-01,  5.5220e-02],
         [ 1.4391e-01,  5.5217e-02],
         [ 1.5036e-01,  5.5221e-02],
         [ 1.1015e-01,  5.5202e-02],
         [ 8.5368e-02,  5.5219e-02],
         [ 1.2297e-01,  5.5223e-02],
         [ 9.4978e-02,  5.5231e-02],
         [ 9.0813e-02,  5.5231e-02],
         [ 1.0092e-01,  5.5230e-02],
         [-9.2490e-04,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0002, device='cuda:0') tensor(0.0021, device='cuda:0') tensor(-0.0033, device='cuda:0')
mixer_td_error tensor(0.0312, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4595, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6430, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0045, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0994, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1381, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-306122.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1852, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0021, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2404, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1859, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2404, device='cuda:0', grad_fn=<MinBackward1>)
t_env 7864
target_mac_out tensor([[[[-1.0000e+07, -6.0082e-02,  8.4218e-02,  ...,  2.3512e-02,
            1.2572e-01, -1.0000e+07],
          [-1.0000e+07, -1.1235e-02,  1.0290e-01,  ...,  6.8675e-03,
            1.2423e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2186e-02,  7.5614e-02,  ..., -6.4896e-03,
            1.3925e-01, -1.0000e+07],
          [-1.0000e+07, -3.0528e-02,  1.3220e-01,  ..., -2.5162e-03,
            1.4641e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.1680e-02,  6.1318e-02,  ...,  5.7171e-03,
            1.3834e-01, -1.0000e+07],
          [-1.0000e+07, -3.8335e-02,  1.1561e-01,  ..., -3.7671e-02,
            1.4580e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9290e-02,  1.0181e-01,  ...,  4.7758e-02,
            1.4846e-01, -1.0000e+07],
          [-1.0000e+07, -3.3519e-02,  1.1222e-01,  ..., -2.3922e-02,
            1.3929e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1333e-01,  1.3127e-01,  ...,  6.5502e-02,
            1.5589e-01, -1.0000e+07],
          [-1.0000e+07, -7.3291e-02,  1.5280e-01,  ...,  3.2253e-02,
            1.5267e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0905e-01,  1.0129e-01,  ...,  6.8682e-02,
            1.7894e-01, -3.2784e-01],
          [ 5.5831e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.0900e-01,  1.0655e-01,  ...,  5.8541e-02,
            1.8107e-01, -3.2474e-01],
          [ 5.5708e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.0339e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5505e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 8.4218e-02,  1.0290e-01],
         [ 7.5614e-02,  1.3220e-01],
         [-6.1680e-02,  1.1561e-01],
         [ 9.0288e-02,  1.1854e-01],
         [ 1.0589e-01,  1.2057e-01],
         [ 1.1571e-01,  5.1231e-02],
         [ 1.2393e-01,  2.5450e-02],
         [ 1.3731e-01,  5.7556e-02],
         [ 1.0357e-01,  7.1333e-02],
         [ 1.3475e-01,  8.9473e-02],
         [ 1.3355e-01,  4.8904e-02],
         [ 1.1020e-01,  8.4369e-02],
         [ 8.5822e-02,  1.0021e-01],
         [ 6.3921e-02,  5.4847e-02],
         [ 9.4012e-02,  8.7735e-02],
         [ 1.0645e-01,  5.9669e-02],
         [ 1.1206e-01,  6.0241e-02],
         [ 7.7325e-02,  4.1627e-02],
         [ 1.0274e-01,  7.2018e-02],
         [ 1.1183e-01,  8.2372e-02],
         [ 1.3467e-01,  8.5434e-02],
         [ 1.1133e-01,  7.3202e-02],
         [ 7.3602e-02,  4.8262e-02],
         [ 1.1514e-01,  7.5335e-02],
         [ 1.2919e-01,  9.2943e-02],
         [ 1.2503e-01,  1.0297e-01],
         [ 9.7167e-02,  5.4604e-02],
         [-1.5443e-02,  7.4007e-02],
         [ 1.8301e-02,  5.4623e-02],
         [ 3.5826e-02,  8.1443e-02],
         [ 4.4242e-02,  9.3067e-02],
         [ 4.8009e-02,  7.2052e-02],
         [ 4.9535e-02,  4.4620e-02],
         [ 5.0047e-02,  6.6528e-02],
         [ 5.0158e-02,  4.9998e-02],
         [ 5.0142e-02,  8.3152e-02],
         [ 5.0089e-02,  5.4268e-02],
         [ 5.0048e-02,  8.2765e-02],
         [ 5.0041e-02,  4.8447e-02],
         [ 5.0009e-02,  5.5372e-02],
         [ 5.0008e-02,  8.1630e-02],
         [ 5.0024e-02,  5.2350e-02],
         [ 5.0012e-02,  3.9359e-02],
         [ 5.0024e-02,  7.2941e-02],
         [ 5.0013e-02,  8.8419e-02],
         [ 5.0016e-02,  1.1234e-01],
         [ 5.0015e-02,  6.4578e-02],
         [ 5.0010e-02,  7.6542e-02],
         [ 5.0006e-02,  9.2320e-02],
         [ 5.0007e-02,  9.8535e-02],
         [ 5.0007e-02,  7.4386e-02],
         [ 5.0007e-02,  1.0060e-01],
         [ 5.0008e-02,  1.2008e-01],
         [ 5.0008e-02,  7.4618e-02],
         [ 5.0009e-02,  6.5466e-02],
         [ 5.0008e-02,  5.9879e-02],
         [ 5.0008e-02,  5.6385e-02],
         [ 5.0008e-02,  5.0268e-02],
         [ 5.0008e-02,  9.0650e-02],
         [ 5.0009e-02,  5.8117e-02],
         [ 5.0009e-02,  9.4006e-02],
         [ 5.0009e-02,  9.9937e-02],
         [ 5.0009e-02,  6.6133e-02],
         [ 5.0009e-02,  8.1864e-02],
         [ 5.0009e-02,  4.7732e-02],
         [ 5.0009e-02,  5.8812e-02],
         [ 5.0009e-02,  7.1442e-02],
         [ 5.0009e-02, -1.8459e-01],
         [ 5.0009e-02, -1.6795e-01],
         [ 5.0009e-02,  7.7470e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 6.2098e-02,  1.2351e-01],
         [ 1.0181e-01,  1.1222e-01],
         [ 1.3127e-01,  1.5280e-01],
         [ 1.2837e-01,  1.6291e-01],
         [ 9.5852e-02,  1.2428e-01],
         [ 1.3859e-01,  1.5452e-01],
         [ 1.4572e-01,  1.1588e-01],
         [ 1.0700e-01,  1.2083e-01],
         [ 8.6114e-02,  9.4543e-02],
         [ 1.1489e-01,  9.3817e-02],
         [ 1.1854e-01,  1.1548e-01],
         [ 1.2877e-01,  1.0008e-01],
         [ 1.2365e-01,  1.1167e-01],
         [ 1.2197e-01,  1.1521e-01],
         [ 1.2565e-01,  9.1372e-02],
         [ 1.3823e-01,  5.9090e-02],
         [ 1.4876e-01,  8.2787e-02],
         [ 1.6783e-01,  7.9772e-02],
         [ 1.2127e-01,  7.7370e-02],
         [ 1.3090e-01,  9.3493e-02],
         [ 1.4102e-01,  5.1346e-02],
         [ 1.2932e-01,  4.9428e-02],
         [ 8.9300e-02,  3.0096e-02],
         [ 1.0320e-01,  4.4489e-02],
         [ 1.2871e-01,  6.2670e-02],
         [ 1.0037e-01,  8.4708e-02],
         [ 1.0146e-01,  7.7035e-02],
         [ 8.5539e-02,  6.9510e-02],
         [ 7.0499e-02,  2.6884e-02],
         [ 7.9031e-02,  4.1102e-02],
         [ 8.4491e-02,  4.9144e-02],
         [ 1.1526e-01,  6.2689e-02],
         [ 1.0764e-01,  6.1126e-02],
         [ 1.0887e-01,  5.7355e-02],
         [ 1.0773e-01,  6.1010e-02],
         [ 1.0714e-01,  6.6354e-02],
         [ 1.0010e-01,  9.4367e-02],
         [ 9.2642e-02,  1.0019e-01],
         [ 8.5963e-02,  9.1463e-02],
         [ 1.1174e-01,  8.8744e-02],
         [ 1.2427e-01,  7.1726e-02],
         [ 1.1730e-01,  8.2398e-02],
         [ 1.2678e-01,  4.5400e-02],
         [ 1.3248e-01,  7.1729e-02],
         [ 1.2420e-01,  8.2116e-02],
         [ 1.0057e-01,  6.7396e-02],
         [ 1.1199e-01,  9.0181e-02],
         [ 1.2558e-01,  9.1028e-02],
         [ 1.3972e-01,  8.4169e-02],
         [ 1.0323e-01,  7.2301e-02],
         [ 1.0841e-01,  1.2391e-01],
         [ 9.0816e-02,  1.0897e-01],
         [ 1.2142e-01,  1.0291e-01],
         [ 1.4098e-01,  9.9261e-02],
         [ 1.5538e-01,  1.0258e-01],
         [ 1.1230e-01,  7.7386e-02],
         [ 1.0532e-01,  7.2365e-02],
         [ 6.3198e-02,  7.3872e-02],
         [ 1.2308e-01,  7.4342e-02],
         [ 1.4949e-01,  8.7137e-02],
         [ 1.5854e-01,  8.3594e-02],
         [ 1.1955e-01,  6.6225e-02],
         [ 9.9441e-02,  7.0303e-02],
         [ 1.1166e-01,  5.4024e-02],
         [ 1.0853e-01,  2.1410e-02],
         [ 1.0680e-01,  4.0733e-02],
         [ 1.0553e-01,  5.0641e-02],
         [ 1.0462e-01,  6.0025e-02],
         [ 1.1588e-01,  6.3588e-02],
         [ 1.4457e-01,  8.8946e-02],
         [ 1.2923e-01,  8.8887e-02],
         [ 1.0556e-01,  7.0199e-02],
         [ 9.4784e-02,  8.7342e-02],
         [ 9.5266e-02,  6.9133e-02],
         [ 1.1126e-01,  8.4431e-02],
         [ 1.3064e-01,  6.9992e-02],
         [ 1.3462e-01,  7.7782e-02],
         [ 1.1952e-01,  5.8504e-02],
         [ 1.4010e-01,  5.8632e-02],
         [ 1.2437e-01,  8.8969e-02],
         [ 1.3582e-01,  7.8072e-02],
         [ 1.5712e-01,  9.2437e-02],
         [ 1.5892e-01,  7.5126e-02],
         [ 1.7540e-01,  7.1766e-02],
         [ 1.7305e-01,  8.8803e-02],
         [ 1.3542e-01,  8.4649e-02],
         [ 1.6459e-01,  8.5476e-02],
         [ 1.8001e-01,  8.3920e-02],
         [ 1.8920e-01,  8.3836e-02],
         [ 1.3805e-01,  7.5273e-02],
         [ 1.2125e-01,  1.1110e-01],
         [ 9.4732e-02,  9.5379e-02],
         [ 9.2762e-02,  1.2610e-01],
         [ 1.0430e-01,  9.5639e-02],
         [ 5.9977e-02,  8.6069e-02],
         [ 9.6552e-02,  1.2411e-01],
         [ 5.9230e-02,  1.4164e-01],
         [ 8.9584e-02,  1.6417e-01],
         [ 1.0493e-01,  1.7310e-01],
         [ 1.1298e-01,  1.2758e-01],
         [ 1.1493e-01,  1.5034e-01],
         [ 7.5395e-02,  9.3793e-02],
         [ 1.0367e-01,  6.7430e-02],
         [ 1.1369e-01,  5.5854e-02],
         [ 1.1659e-01,  7.3041e-02],
         [ 1.5662e-01,  9.9545e-02],
         [ 1.8715e-01,  1.2717e-01],
         [ 1.7667e-01,  9.0710e-02],
         [ 1.7780e-01,  6.5056e-02],
         [ 1.5233e-01,  6.0279e-02],
         [ 1.5316e-01,  1.0233e-01],
         [ 1.7230e-01,  7.2476e-02],
         [ 1.2769e-01,  7.3174e-02],
         [ 1.6294e-01,  1.0039e-01],
         [ 1.2044e-01,  1.1008e-01],
         [ 1.5258e-01,  7.6368e-02],
         [ 1.2445e-01,  9.2721e-02],
         [ 1.3184e-01,  9.5908e-02],
         [ 1.5656e-01,  5.3166e-02],
         [ 1.7400e-01,  6.7876e-02],
         [ 1.6731e-01,  8.4690e-02],
         [ 1.5053e-01,  2.2583e-02],
         [ 1.1620e-01,  4.1458e-02],
         [ 1.1952e-01,  5.0637e-02],
         [ 1.1866e-01,  5.4424e-02],
         [ 9.0341e-02,  5.5681e-02],
         [ 1.0129e-01,  5.5831e-02],
         [ 1.0655e-01,  5.5708e-02],
         [ 2.0339e-03,  5.5505e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-5.3589e-05, device='cuda:0') tensor(0.0019, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.5258, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.6141, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7557, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0268, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1654, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1105, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2286821.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1892, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.2417e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0014, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2032, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2649, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2032, device='cuda:0', grad_fn=<MinBackward1>)
t_env 7911
target_mac_out tensor([[[[-1.0000e+07, -9.3745e-02,  1.1397e-01,  ...,  6.2087e-02,
            1.3778e-01, -1.0000e+07],
          [-1.0000e+07, -2.4539e-02,  9.4233e-02,  ..., -1.0851e-02,
            1.2427e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.7459e-02,  9.8722e-02,  ...,  1.3931e-02,
            1.3959e-01, -1.0000e+07],
          [-1.0000e+07, -6.3419e-02,  1.4570e-01,  ...,  3.8138e-02,
            1.4407e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0222e-01,  1.1143e-01,  ...,  1.4510e-02,
            1.5951e-01, -1.0000e+07],
          [-1.0000e+07, -9.0719e-02,  1.6389e-01,  ...,  6.4728e-02,
            1.5741e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.3996e-02,  8.6686e-02,  ...,  2.0696e-02,
            1.2691e-01, -1.0000e+07],
          [-1.0000e+07, -1.5667e-02,  8.3441e-02,  ...,  2.3244e-02,
            1.3188e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.1255e-02,  1.0085e-01,  ...,  1.3889e-02,
            1.5595e-01, -1.0000e+07],
          [-1.0000e+07, -1.9335e-02,  1.0315e-01,  ...,  4.0021e-03,
            1.3038e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2984e-01,  1.1306e-01,  ...,  4.4549e-02,
            1.6956e-01, -1.0000e+07],
          [-1.0000e+07, -2.9019e-02,  1.1227e-01,  ..., -9.0084e-03,
            1.3362e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.4822e-01,  5.1591e-02,  ...,  3.3976e-02,
            1.3626e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7536e-01,  8.8443e-02,  ...,  5.7649e-02,
            1.5296e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-5.7354e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1397e-01,  9.4233e-02],
         [ 9.8722e-02,  1.4570e-01],
         [ 1.1143e-01,  1.6389e-01],
         [ 1.3586e-01,  1.7871e-01],
         [ 1.4687e-01,  1.8179e-01],
         [ 1.5585e-01,  1.4926e-01],
         [ 1.4400e-01,  1.3019e-01],
         [ 1.3895e-01,  1.3914e-01],
         [ 1.1510e-01,  1.5959e-01],
         [ 1.4274e-01,  1.6537e-01],
         [ 1.4816e-01,  1.5004e-01],
         [ 1.1324e-01,  1.5712e-01],
         [ 9.8118e-02,  1.5338e-01],
         [ 1.2477e-01,  1.4664e-01],
         [ 1.3309e-01,  1.5508e-01],
         [ 1.3092e-01,  1.2094e-01],
         [ 9.1389e-02,  1.3626e-01],
         [ 6.8309e-02,  9.6291e-02],
         [ 8.8464e-02,  1.2488e-01],
         [ 7.6859e-02,  1.1966e-01],
         [ 1.1995e-01,  1.1632e-01],
         [ 1.3344e-01,  9.7680e-02],
         [ 1.4191e-01,  1.3203e-01],
         [ 1.0639e-01,  1.0285e-01],
         [ 1.4119e-01,  1.0939e-01],
         [ 1.1021e-01,  1.3258e-01],
         [ 1.3964e-01,  1.4360e-01],
         [ 1.5788e-01,  1.1475e-01],
         [ 1.3786e-01,  1.2930e-01],
         [ 1.4924e-01,  1.4228e-01],
         [ 1.5448e-01,  1.2233e-01],
         [ 1.5518e-01,  1.0699e-01],
         [ 1.3310e-01,  1.3047e-01],
         [ 1.5171e-01,  1.0209e-01],
         [ 1.3595e-01,  3.4605e-03],
         [ 9.9990e-02,  3.3985e-02],
         [ 1.2957e-01,  4.7351e-02],
         [ 1.0111e-01,  5.2776e-02],
         [ 1.1923e-01,  5.4770e-02],
         [ 1.3168e-01,  5.5340e-02],
         [ 1.2891e-01,  5.5415e-02],
         [ 9.9288e-02,  5.5387e-02],
         [ 9.6720e-02,  5.5311e-02],
         [ 8.9051e-02,  5.5234e-02],
         [-1.6971e-01,  5.5215e-02],
         [-7.9893e-03,  5.5204e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 8.6686e-02,  8.3441e-02],
         [ 1.0085e-01,  1.0315e-01],
         [ 1.1306e-01,  1.1227e-01],
         [ 1.0460e-01,  1.0424e-01],
         [ 1.0792e-01,  1.1858e-01],
         [ 1.1415e-01,  1.3027e-01],
         [ 1.0832e-01,  1.1268e-01],
         [ 1.0473e-01,  1.0402e-01],
         [ 8.4129e-02,  1.2751e-01],
         [ 1.1244e-01,  9.9947e-02],
         [ 9.6230e-02,  1.2257e-01],
         [ 1.1994e-01,  1.0231e-01],
         [ 1.3531e-01,  1.2877e-01],
         [ 1.4046e-01,  1.0503e-01],
         [ 1.4573e-01,  1.2740e-01],
         [ 1.1770e-01,  1.3539e-01],
         [ 1.3414e-01,  1.4243e-01],
         [ 1.1765e-01,  1.4143e-01],
         [ 1.4142e-01,  1.0107e-01],
         [ 1.4622e-01,  1.2521e-01],
         [ 1.4856e-01,  1.3191e-01],
         [ 1.5341e-01,  9.1052e-02],
         [ 1.2524e-01,  1.3590e-01],
         [ 1.2485e-01,  1.4389e-01],
         [ 1.3312e-01,  1.4144e-01],
         [ 1.3616e-01,  1.3762e-01],
         [ 1.3769e-01,  1.3267e-01],
         [ 1.4633e-01,  1.1129e-01],
         [ 1.4570e-01,  1.0481e-01],
         [ 1.4373e-01,  9.9976e-02],
         [ 1.1882e-01,  8.8704e-02],
         [ 1.3832e-01,  1.3155e-01],
         [ 1.4342e-01,  1.0580e-01],
         [ 1.0056e-01,  1.4391e-01],
         [ 8.0653e-02,  1.3440e-01],
         [ 1.2066e-01,  1.3861e-01],
         [ 1.3568e-01,  1.4246e-01],
         [ 1.4134e-01,  1.1570e-01],
         [ 1.4224e-01,  1.1562e-01],
         [ 1.4190e-01,  7.8742e-02],
         [ 1.2716e-01,  7.5479e-02],
         [ 1.3568e-01,  1.1330e-01],
         [ 1.4016e-01,  1.1841e-01],
         [ 1.1147e-01,  1.0902e-01],
         [ 9.3271e-02,  9.9197e-03],
         [ 6.7591e-02,  3.5311e-02],
         [ 8.7430e-02,  4.7854e-02],
         [ 6.2260e-02,  5.3260e-02],
         [ 7.8008e-02,  5.5237e-02],
         [ 8.0988e-02,  5.5798e-02],
         [ 9.8658e-02,  5.5771e-02],
         [ 1.0181e-01,  5.5608e-02],
         [ 1.0649e-01,  5.5471e-02],
         [ 9.9038e-02,  5.5352e-02],
         [ 1.0353e-01,  5.5259e-02],
         [ 1.0500e-01,  5.5247e-02],
         [ 1.0540e-01,  5.5208e-02],
         [ 7.9848e-02,  5.5209e-02],
         [ 9.5185e-02,  5.5209e-02],
         [ 1.0160e-01,  5.5202e-02],
         [ 1.0489e-01,  5.5222e-02],
         [ 1.1834e-01,  5.5205e-02],
         [ 9.4938e-02,  5.5213e-02],
         [ 7.2395e-02,  5.5223e-02],
         [ 6.0567e-02,  5.5229e-02],
         [ 1.1003e-01,  5.5233e-02],
         [ 1.2109e-01,  5.5230e-02],
         [ 1.1571e-01,  5.5231e-02],
         [ 7.4156e-02,  5.5231e-02],
         [ 7.7463e-02,  5.5236e-02],
         [ 1.0165e-01,  5.5235e-02],
         [ 6.6663e-02,  5.5232e-02],
         [ 9.1685e-02,  5.5232e-02],
         [ 9.9739e-02,  5.5231e-02],
         [ 1.0828e-01,  5.5231e-02],
         [ 1.1078e-01,  5.5231e-02],
         [ 9.0196e-02,  5.5231e-02],
         [ 9.9723e-02,  5.5231e-02],
         [ 8.3680e-02,  5.5231e-02],
         [ 1.0160e-01,  5.5231e-02],
         [ 1.0816e-01,  5.5231e-02],
         [ 1.1100e-01,  5.5231e-02],
         [ 6.9471e-02,  5.5231e-02],
         [ 9.2884e-02,  5.5231e-02],
         [ 1.0662e-01,  5.5231e-02],
         [ 5.6892e-02,  5.5231e-02],
         [ 9.4423e-02,  5.5231e-02],
         [ 5.5785e-02,  5.5231e-02],
         [ 9.5767e-02,  5.5231e-02],
         [ 5.7230e-02,  5.5231e-02],
         [ 9.6663e-02,  5.5231e-02],
         [ 1.1119e-01,  5.5231e-02],
         [ 1.1731e-01,  5.5231e-02],
         [ 7.5303e-02,  5.5231e-02],
         [ 8.5156e-02,  5.5231e-02],
         [ 9.2971e-02,  5.5231e-02],
         [ 9.6417e-02,  5.5231e-02],
         [ 9.4960e-02,  5.5231e-02],
         [ 8.7060e-02,  5.5231e-02],
         [ 8.1022e-02,  5.5231e-02],
         [ 5.9899e-02,  5.5231e-02],
         [ 9.3060e-02,  5.5231e-02],
         [ 1.1908e-01,  5.5231e-02],
         [ 9.9488e-02,  5.5231e-02],
         [ 6.7916e-02,  5.5231e-02],
         [ 9.8484e-02,  5.5231e-02],
         [ 8.5068e-02,  5.5231e-02],
         [ 7.8885e-02,  5.5231e-02],
         [ 9.8363e-02,  5.5231e-02],
         [ 1.1592e-01,  5.5231e-02],
         [ 1.1375e-01,  5.5231e-02],
         [ 6.7681e-02,  5.5231e-02],
         [ 8.8989e-02,  5.5231e-02],
         [ 8.1366e-02,  5.5231e-02],
         [ 9.7259e-02,  5.5231e-02],
         [ 1.0183e-01,  5.5231e-02],
         [ 8.2566e-02,  5.5231e-02],
         [ 7.5273e-02,  5.5231e-02],
         [ 9.9372e-02,  5.5231e-02],
         [ 7.7893e-02,  5.5231e-02],
         [ 4.8304e-02,  5.5231e-02],
         [ 6.4524e-02,  5.5231e-02],
         [ 8.5688e-02,  5.5231e-02],
         [ 9.0781e-02,  5.5231e-02],
         [ 9.5405e-02,  5.5231e-02],
         [ 1.0938e-01,  5.5231e-02],
         [ 1.0260e-01,  5.5231e-02],
         [ 8.1103e-02,  5.5231e-02],
         [ 5.1591e-02,  5.5231e-02],
         [ 8.8443e-02,  5.5231e-02],
         [-5.7354e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.4099e-05, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0012, device='cuda:0')
mixer_td_error tensor(0.8161, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4682, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8034, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1445, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0646, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3244274.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1818, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.2172e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0009, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1779, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1940, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1779, device='cuda:0', grad_fn=<MinBackward1>)
t_env 7957
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9711e-02,  8.6010e-02,  ...,  5.5065e-03,
            1.3727e-01, -1.0000e+07],
          [-1.0000e+07, -4.5321e-02,  1.0753e-01,  ...,  3.5616e-02,
            1.4810e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.8586e-02,  7.7246e-02,  ..., -1.5416e-02,
            1.4423e-01, -1.0000e+07],
          [-1.0000e+07, -7.5122e-02,  1.5329e-01,  ...,  6.1145e-02,
            1.5160e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5616e-02,  9.4210e-02,  ...,  7.3878e-03,
            1.5537e-01, -1.0000e+07],
          [-1.0000e+07, -2.6778e-02,  1.1172e-01,  ...,  1.0212e-02,
            1.4563e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6670e-02,  6.7967e-02,  ...,  1.6771e-02,
            1.4736e-01, -1.0000e+07],
          [-1.0000e+07, -4.0458e-02,  1.4132e-01,  ...,  2.4393e-02,
            1.5301e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.8329e-01,  8.0878e-02,  ...,  8.4826e-02,
            2.2755e-01, -3.3026e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.7266e-01,  8.0218e-02,  ...,  7.2890e-02,
            2.1799e-01, -3.2035e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.9990e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.4276e-02,  1.4162e-01],
         [ 8.6010e-02,  1.0753e-01],
         [ 7.7246e-02,  1.5329e-01],
         [ 1.0076e-01,  1.3148e-01],
         [ 1.0388e-01,  1.4759e-01],
         [ 7.9082e-02,  1.1312e-01],
         [ 1.5672e-02,  1.5570e-01],
         [ 6.4117e-02,  1.3358e-01],
         [ 1.0653e-01,  1.5320e-01],
         [ 9.6934e-02,  1.2994e-01],
         [ 9.1760e-02,  1.3363e-01],
         [ 1.0493e-01,  1.1379e-01],
         [ 1.0353e-01,  1.4016e-01],
         [ 7.4906e-02,  1.6199e-01],
         [ 1.0925e-01,  1.5031e-01],
         [ 7.8066e-02,  1.4431e-01],
         [ 9.8661e-02,  1.2048e-01],
         [ 1.1791e-01,  1.0510e-01],
         [ 1.1777e-01, -1.2437e-01],
         [ 1.2904e-01,  1.1127e-01],
         [ 1.3727e-01,  1.0111e-01],
         [ 1.5609e-01, -1.2379e-01],
         [ 1.6293e-01,  9.7875e-02],
         [ 1.1898e-01, -2.5146e-05],
         [ 1.3153e-01,  3.0002e-02],
         [ 1.0374e-01,  4.5015e-02],
         [ 6.8968e-02,  5.1843e-02],
         [ 7.3870e-02,  5.4623e-02],
         [ 6.3494e-02,  5.5590e-02],
         [ 1.0763e-01,  5.5764e-02],
         [ 8.0693e-02,  5.5709e-02],
         [ 6.5622e-02,  5.5519e-02],
         [ 5.8923e-02,  5.5416e-02],
         [ 9.5371e-02,  5.5326e-02],
         [ 1.0704e-01,  5.5294e-02],
         [ 1.0364e-01,  5.5259e-02],
         [ 7.1136e-02,  5.5208e-02],
         [ 7.9778e-02,  5.5235e-02],
         [ 8.9420e-02,  5.5219e-02],
         [ 1.0514e-01,  5.5214e-02],
         [ 5.9164e-02,  5.5201e-02],
         [ 6.8162e-02,  5.5219e-02],
         [ 1.0094e-01,  5.5223e-02],
         [ 8.9426e-02,  5.5231e-02],
         [ 9.2179e-02,  5.5231e-02],
         [ 7.8348e-02,  5.5230e-02],
         [ 9.8602e-02,  5.5231e-02],
         [ 1.0804e-01,  5.5232e-02],
         [ 1.2502e-01,  5.5236e-02],
         [ 1.3312e-01,  5.5236e-02],
         [ 1.3634e-01,  5.5232e-02],
         [ 1.2766e-01,  5.5232e-02],
         [ 1.2473e-01,  5.5231e-02],
         [ 1.0027e-01,  5.5231e-02],
         [ 1.0140e-01,  5.5231e-02],
         [ 8.8376e-02,  5.5231e-02],
         [ 9.1831e-02,  5.5231e-02],
         [ 8.9081e-02,  5.5231e-02],
         [ 8.3242e-02,  5.5231e-02],
         [ 9.7892e-02,  5.5231e-02],
         [ 7.2450e-02,  5.5231e-02],
         [ 2.1153e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 7.2334e-02,  1.2843e-01],
         [ 9.4210e-02,  1.1172e-01],
         [ 1.6771e-02,  1.4132e-01],
         [ 9.4476e-02,  1.5350e-01],
         [ 9.6950e-02,  1.5582e-01],
         [ 1.1263e-01,  1.2656e-01],
         [ 2.7565e-02,  1.0403e-01],
         [ 9.3209e-02,  9.1718e-02],
         [ 1.2677e-02,  7.9109e-02],
         [ 1.2725e-01,  6.6294e-02],
         [ 1.3948e-01,  1.0046e-01],
         [ 1.3956e-01,  1.2324e-01],
         [ 1.0675e-01,  1.5398e-01],
         [ 1.2642e-01,  1.0202e-01],
         [ 1.3666e-01,  1.0467e-01],
         [ 1.3114e-01,  1.1772e-01],
         [ 1.4585e-01,  9.2078e-02],
         [ 1.5430e-01,  1.2583e-01],
         [ 1.4894e-01,  1.2902e-01],
         [ 1.6615e-01,  1.0315e-01],
         [ 1.6668e-01,  9.1633e-02],
         [ 1.7680e-01,  8.6050e-02],
         [ 1.5964e-01,  5.2992e-02],
         [ 1.4176e-01,  7.8185e-02],
         [ 1.4823e-01,  8.8306e-02],
         [ 1.4364e-01,  1.3236e-01],
         [ 1.4081e-01,  1.3988e-01],
         [ 1.7035e-01,  1.3946e-01],
         [ 1.6107e-01,  1.2548e-01],
         [ 1.7370e-01,  1.5120e-01],
         [ 1.4516e-01,  1.4849e-01],
         [ 1.6219e-01,  1.3046e-01],
         [ 1.7123e-01,  1.3859e-01],
         [ 1.3796e-01,  1.2250e-01],
         [ 1.5600e-01,  1.3855e-01],
         [ 1.2844e-01,  1.4882e-01],
         [ 1.5321e-01,  1.1716e-01],
         [-2.6794e-02,  7.1650e-02],
         [ 1.2694e-02,  4.2041e-02],
         [ 3.2720e-02,  5.1409e-02],
         [ 4.2500e-02,  3.6503e-02],
         [ 4.7060e-02,  7.2315e-02],
         [ 4.9041e-02,  6.0649e-02],
         [ 4.9831e-02,  3.3900e-02],
         [ 5.0090e-02,  7.5003e-02],
         [ 5.0148e-02,  9.0500e-02],
         [ 5.0123e-02,  9.9550e-02],
         [ 5.0104e-02,  5.7068e-02],
         [ 5.0055e-02,  5.2107e-02],
         [ 5.0053e-02,  8.4142e-02],
         [ 5.0037e-02,  5.6714e-02],
         [ 5.0035e-02,  8.4584e-02],
         [ 5.0018e-02,  9.6284e-02],
         [ 5.0014e-02,  6.5931e-02],
         [ 5.0027e-02,  9.0036e-02],
         [ 5.0014e-02,  5.7394e-02],
         [ 5.0018e-02,  8.2049e-02],
         [ 5.0012e-02,  6.5623e-02],
         [ 5.0009e-02,  5.4677e-02],
         [ 5.0006e-02,  4.8189e-02],
         [ 5.0008e-02,  4.4529e-02],
         [ 5.0007e-02,  4.2549e-02],
         [ 5.0008e-02,  6.6008e-02],
         [ 5.0008e-02,  5.5699e-02],
         [ 5.0008e-02,  7.9436e-02],
         [ 5.0008e-02,  8.9974e-02],
         [ 5.0008e-02,  5.6480e-02],
         [ 5.0008e-02,  5.4526e-02],
         [ 5.0008e-02,  7.6034e-02],
         [ 5.0008e-02,  4.8589e-02],
         [ 5.0009e-02,  7.8667e-02],
         [ 5.0009e-02,  1.0735e-01],
         [ 5.0009e-02,  8.7148e-02],
         [ 5.0009e-02,  1.0248e-01],
         [ 5.0009e-02,  1.0741e-01],
         [ 5.0009e-02,  7.8701e-02],
         [ 5.0009e-02,  6.3627e-02],
         [ 5.0009e-02,  1.0202e-01],
         [ 5.0009e-02,  6.5074e-02],
         [ 5.0009e-02,  9.1847e-02],
         [ 5.0009e-02,  1.0255e-01],
         [ 5.0009e-02,  7.3281e-02],
         [ 5.0009e-02,  4.5128e-02],
         [ 5.0009e-02,  9.4603e-02],
         [ 5.0009e-02,  1.1070e-01],
         [ 5.0009e-02,  1.0668e-01],
         [ 5.0009e-02,  7.5672e-02],
         [ 5.0009e-02,  5.7879e-02],
         [ 5.0009e-02,  6.5212e-02],
         [ 5.0009e-02,  7.7017e-02],
         [ 5.0009e-02,  7.9772e-02],
         [ 5.0009e-02,  8.0878e-02],
         [ 5.0009e-02,  8.0218e-02],
         [ 5.0009e-02,  5.9990e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.1685e-05, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.4145, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5030, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4244, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0543, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1877, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0428, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1702127.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1768, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.2043e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1596, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.0989, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1596, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8003
target_mac_out tensor([[[[-1.0000e+07, -5.4255e-02,  8.7945e-02,  ...,  2.1998e-02,
            1.2409e-01, -1.0000e+07],
          [-1.0000e+07, -2.5887e-02,  1.2012e-01,  ...,  1.5133e-02,
            1.3440e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0159e-01,  1.1950e-01,  ...,  5.1083e-02,
            1.4701e-01, -1.0000e+07],
          [-1.0000e+07, -4.0845e-02,  1.0690e-01,  ..., -1.9599e-02,
            1.3754e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.9555e-02,  1.2774e-01,  ...,  3.8789e-02,
            1.4068e-01, -1.0000e+07],
          [-1.0000e+07, -5.0626e-02,  9.0328e-02,  ..., -3.6395e-02,
            1.4205e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4188e-01,  4.8346e-02,  ...,  2.2437e-02,
            1.8975e-01, -2.9740e-01]],

         [[ 5.0006e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6155e-01,  6.8167e-02,  ...,  5.5020e-02,
            2.1114e-01, -3.1359e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5938e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2685e-01,  1.2531e-01,  ...,  5.6976e-02,
            1.5537e-01, -1.0000e+07],
          [-1.0000e+07, -4.3705e-02,  1.3064e-01,  ...,  2.3492e-02,
            1.4040e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.5273e-01,  1.3203e-01,  ...,  6.9187e-02,
            1.6531e-01, -1.0000e+07],
          [-1.0000e+07, -5.7402e-02,  1.4496e-01,  ...,  6.9303e-03,
            1.5600e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6969e-01,  7.6580e-02,  ...,  6.3616e-02,
            1.4675e-01, -3.1929e-01],
          [ 5.5138e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.5569e-01,  6.7404e-02,  ...,  5.6059e-02,
            1.3478e-01, -3.1623e-01],
          [ 5.5125e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-5.4720e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5144e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 0.0879,  0.1201],
         [ 0.1195,  0.1069],
         [ 0.1277,  0.0903],
         [ 0.1380,  0.0704],
         [ 0.1280,  0.0831],
         [ 0.1437,  0.1065],
         [ 0.1422,  0.1282],
         [ 0.1705,  0.0964],
         [ 0.1842,  0.0818],
         [ 0.1559,  0.0830],
         [ 0.1427,  0.1338],
         [ 0.1421,  0.1056],
         [ 0.1745,  0.0758],
         [ 0.1866,  0.1374],
         [ 0.1622,  0.1554],
         [ 0.1792,  0.1165],
         [ 0.1667,  0.1381],
         [ 0.1466,  0.1615],
         [ 0.1643,  0.1266],
         [ 0.1283,  0.0634],
         [ 0.1149,  0.1432],
         [ 0.1434,  0.1346],
         [-0.0303,  0.0626],
         [ 0.0088,  0.1044],
         [ 0.0301,  0.1110],
         [ 0.0409,  0.1182],
         [ 0.0461,  0.1100],
         [ 0.0485,  0.0901],
         [ 0.0496,  0.1155],
         [ 0.0500,  0.0786],
         [ 0.0501,  0.1005],
         [ 0.0501,  0.1182],
         [ 0.0501,  0.0829],
         [ 0.0501,  0.0567],
         [ 0.0501,  0.0948],
         [ 0.0500,  0.0908],
         [ 0.0500,  0.1028],
         [ 0.0500,  0.0652],
         [ 0.0500,  0.0730],
         [ 0.0500,  0.0545],
         [ 0.0500,  0.0405],
         [ 0.0500,  0.0543],
         [ 0.0500,  0.0718],
         [ 0.0500,  0.0483],
         [ 0.0500,  0.0682],
         [ 0.0500,  0.0056]],

        [[ 0.0972,  0.1396],
         [ 0.1253,  0.1306],
         [ 0.0692,  0.1450],
         [ 0.1260,  0.1295],
         [ 0.1286,  0.1611],
         [ 0.1319,  0.1640],
         [ 0.1518,  0.1679],
         [ 0.1520,  0.1378],
         [ 0.1606,  0.1128],
         [ 0.1457,  0.1590],
         [ 0.1476,  0.1675],
         [ 0.1212,  0.1752],
         [ 0.0709,  0.1523],
         [ 0.1080,  0.1715],
         [ 0.1074,  0.1841],
         [ 0.1116,  0.1844],
         [ 0.1315,  0.1374],
         [ 0.1422,  0.1318],
         [ 0.1602,  0.1643],
         [ 0.0952,  0.1452],
         [ 0.1487,  0.1710],
         [ 0.1182,  0.1852],
         [ 0.1362,  0.1582],
         [ 0.1323,  0.1660],
         [ 0.1292,  0.1778],
         [ 0.1320,  0.1301],
         [ 0.0964,  0.1591],
         [ 0.0834,  0.1183],
         [ 0.1190,  0.0932],
         [ 0.1411,  0.1232],
         [ 0.1145,  0.1313],
         [ 0.1279,  0.1538],
         [ 0.0931,  0.1303],
         [ 0.1280,  0.1061],
         [ 0.1446, -0.0083],
         [ 0.1348,  0.0257],
         [ 0.1455,  0.0424],
         [ 0.1504,  0.0500],
         [ 0.1496,  0.0532],
         [ 0.1387,  0.0545],
         [ 0.0999,  0.0549],
         [ 0.1269,  0.0551],
         [ 0.0928,  0.0551],
         [ 0.0766,  0.0551],
         [ 0.0674,  0.0551],
         [-0.0055,  0.0551]]], device='cuda:0', grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.2820e-05, device='cuda:0') tensor(0.0025, device='cuda:0') tensor(-0.0030, device='cuda:0')
mixer_td_error tensor(0.0075, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.4438, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7545, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0676, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2032, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0467, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(0.1075, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1866, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0303, device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0023, device='cuda:0', grad_fn=<MaxBackward1>) tensor(3.4940e-09, device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(0.1337, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1760, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1337, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1760, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8058
target_mac_out tensor([[[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2423e-01,  1.2532e-01,  ...,  4.7861e-02,
            1.3552e-01, -1.0000e+07],
          [-1.0000e+07, -7.8216e-02,  1.2316e-01,  ...,  2.6434e-02,
            1.4308e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1324e-01,  1.0353e-01,  ...,  1.0987e-02,
            1.4385e-01, -1.0000e+07],
          [-1.0000e+07, -8.2875e-02,  1.3525e-01,  ...,  2.7717e-02,
            1.3862e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2697e-02,  8.6043e-02,  ...,  3.6569e-04,
            1.4043e-01, -1.0000e+07],
          [-1.0000e+07, -3.0029e-02,  9.6760e-02,  ..., -1.6551e-02,
            1.3110e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4736e-02,  1.0545e-01,  ..., -4.9368e-04,
            1.6235e-01, -1.0000e+07],
          [-1.0000e+07, -4.2605e-02,  9.2510e-02,  ..., -3.6784e-02,
            1.3493e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7641e-01, -1.0000e+07,  ...,  4.8869e-02,
           -1.0000e+07, -2.5364e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6360e-01, -1.0000e+07,  ...,  4.3823e-02,
           -1.0000e+07, -2.4145e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.8764e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1386e-01,  1.4136e-01],
         [ 1.2532e-01,  1.2316e-01],
         [ 1.0353e-01,  1.3525e-01],
         [ 1.3028e-01,  1.2061e-01],
         [ 1.4061e-01,  1.4195e-01],
         [ 1.2830e-01,  1.1294e-01],
         [ 1.4351e-01,  1.3139e-01],
         [ 9.9847e-02,  8.5891e-02],
         [ 8.6438e-02,  6.4711e-02],
         [ 1.1320e-01,  7.5890e-02],
         [ 1.2135e-01,  6.4024e-02],
         [ 9.1798e-02,  4.1215e-02],
         [ 6.8322e-02,  8.0666e-03],
         [ 9.9503e-02,  5.6254e-02],
         [ 1.0944e-01,  4.0167e-02],
         [ 1.4609e-01,  8.3001e-02],
         [ 1.5712e-01,  1.3172e-01],
         [ 1.0742e-01,  7.5501e-02],
         [ 9.8728e-02,  4.2043e-02],
         [ 7.7781e-02,  6.8468e-02],
         [ 1.1714e-01,  6.6993e-02],
         [ 8.3988e-02,  8.3415e-02],
         [ 1.0460e-01,  7.7621e-02],
         [ 1.2116e-01,  9.0402e-02],
         [ 1.2416e-01,  1.3137e-01],
         [ 1.3118e-01,  1.3809e-01],
         [-1.9901e-02,  7.4900e-02],
         [ 1.7280e-02,  4.9241e-02],
         [ 3.5852e-02,  8.3603e-02],
         [ 4.4656e-02,  5.7407e-02],
         [ 4.8486e-02,  3.8151e-02],
         [ 4.9986e-02,  7.7447e-02],
         [ 5.0409e-02,  9.1081e-02],
         [ 5.0440e-02,  1.1647e-01],
         [ 5.0324e-02,  8.1186e-02],
         [ 5.0212e-02,  7.7108e-02],
         [ 5.0138e-02,  5.3624e-02],
         [ 5.0065e-02,  8.8262e-02],
         [ 5.0032e-02,  9.1708e-02],
         [ 5.0029e-02,  8.1130e-02],
         [ 5.0020e-02,  9.4437e-02],
         [ 5.0019e-02,  9.1267e-02],
         [ 5.0024e-02,  9.1347e-02],
         [ 5.0016e-02,  1.1125e-01],
         [ 5.0016e-02,  8.4575e-02],
         [ 5.0019e-02,  9.8708e-02],
         [ 5.0014e-02,  6.9512e-02],
         [ 5.0005e-02,  8.3487e-02],
         [ 5.0007e-02,  4.6832e-02],
         [ 5.0008e-02,  4.4426e-02],
         [ 5.0007e-02, -1.3399e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 7.0205e-02,  9.0702e-02],
         [ 8.6043e-02,  9.6760e-02],
         [ 1.0545e-01,  9.2510e-02],
         [ 1.1684e-01,  1.1852e-01],
         [-6.9401e-02,  1.1198e-01],
         [ 1.0207e-01,  1.3997e-01],
         [ 2.4164e-02,  1.2643e-01],
         [ 1.0087e-01,  1.4404e-01],
         [-6.2544e-02,  9.4678e-02],
         [ 9.9763e-02,  4.1951e-02],
         [ 9.6511e-02,  2.8135e-02],
         [ 9.7529e-02,  6.9178e-02],
         [ 1.1645e-01,  8.7885e-02],
         [ 1.2056e-01,  6.8681e-02],
         [ 1.5746e-01,  1.0094e-01],
         [ 1.7028e-01,  1.0275e-01],
         [ 1.8137e-01,  1.2239e-01],
         [ 1.8975e-01,  1.1724e-01],
         [ 1.2731e-01,  1.2663e-01],
         [ 1.3004e-01,  1.1875e-01],
         [ 1.1769e-01,  8.1665e-02],
         [ 1.5515e-01,  9.9348e-02],
         [ 1.0939e-01,  7.6186e-02],
         [ 1.0205e-01,  1.0070e-01],
         [ 9.8908e-02, -1.1912e-01],
         [ 7.4470e-02, -1.0494e-01],
         [ 9.3168e-02, -1.0517e-01],
         [ 8.7312e-02, -9.5965e-02],
         [ 1.1217e-01,  1.2810e-01],
         [ 1.2174e-01, -9.1623e-02],
         [ 9.7153e-02, -8.8893e-02],
         [ 9.9713e-02,  1.5014e-02],
         [-5.2899e-02,  3.8661e-02],
         [ 8.7468e-02,  5.0011e-02],
         [ 1.1025e-01,  5.4585e-02],
         [-1.7715e-02,  5.6052e-02],
         [ 1.0898e-01,  5.6262e-02],
         [ 1.4634e-01,  5.6071e-02],
         [ 1.0157e-01,  5.5783e-02],
         [ 9.7480e-02,  5.5577e-02],
         [ 8.4765e-02,  5.5432e-02],
         [-6.2284e-02,  5.5317e-02],
         [-5.1036e-02,  5.5260e-02],
         [ 8.6271e-02,  5.5217e-02],
         [-4.0350e-02,  5.5217e-02],
         [ 9.2938e-02,  5.5210e-02],
         [ 9.9936e-02,  5.5211e-02],
         [ 1.0516e-01,  5.5226e-02],
         [ 1.0705e-01,  5.5208e-02],
         [ 1.0676e-01,  5.5218e-02],
         [ 1.2654e-01,  5.5221e-02],
         [ 1.3537e-01,  5.5223e-02],
         [ 9.2763e-02,  5.5232e-02],
         [ 1.1663e-01,  5.5230e-02],
         [ 7.9174e-02,  5.5230e-02],
         [ 1.2274e-01,  5.5231e-02],
         [ 9.6635e-02,  5.5236e-02],
         [ 1.0700e-01,  5.5235e-02],
         [ 1.0815e-01,  5.5232e-02],
         [ 1.2503e-01,  5.5232e-02],
         [ 1.2374e-01,  5.5231e-02],
         [ 1.3389e-01,  5.5231e-02],
         [ 1.5225e-01,  5.5231e-02],
         [ 1.5867e-01,  5.5231e-02],
         [ 1.6042e-01,  5.5231e-02],
         [ 1.1433e-01,  5.5231e-02],
         [ 9.6289e-02,  5.5231e-02],
         [ 1.3500e-01,  5.5231e-02],
         [ 1.3141e-01,  5.5231e-02],
         [ 1.3824e-01,  5.5231e-02],
         [ 1.3149e-01,  5.5231e-02],
         [ 1.0908e-01,  5.5231e-02],
         [ 7.1149e-02,  5.5231e-02],
         [-1.7992e-01,  5.5231e-02],
         [-1.7641e-01,  5.5231e-02],
         [-1.6360e-01,  5.5231e-02],
         [ 1.8764e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(8.7740e-05, device='cuda:0') tensor(0.0017, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.4481, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4680, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3524, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0652, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1871, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0151, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1688311.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1897, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.6937e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1058, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2411, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1058, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8108
target_mac_out tensor([[[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5616e-02,  9.4210e-02,  ...,  7.3878e-03,
            1.5537e-01, -1.0000e+07],
          [-1.0000e+07, -2.6778e-02,  1.1172e-01,  ...,  1.0212e-02,
            1.4563e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6670e-02,  6.7967e-02,  ...,  1.6771e-02,
            1.4736e-01, -1.0000e+07],
          [-1.0000e+07, -4.0458e-02,  1.4132e-01,  ...,  2.4393e-02,
            1.5301e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.9990e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -3.8669e-02,  6.6123e-02,  ...,  3.1808e-02,
            1.1543e-01, -1.0000e+07],
          [-1.0000e+07, -1.7411e-02,  9.1207e-02,  ..., -1.4688e-02,
            1.2647e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.1289e-02,  9.2718e-02,  ...,  1.9208e-02,
            1.1967e-01, -1.0000e+07],
          [-1.0000e+07, -5.9044e-02,  1.3579e-01,  ...,  3.9523e-02,
            1.5288e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.4152e-02,  9.5388e-02,  ...,  2.5996e-02,
            1.2299e-01, -1.0000e+07],
          [-1.0000e+07, -7.9071e-02,  1.4334e-01,  ...,  3.7160e-02,
            1.5727e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.4868e-01, -1.0000e+07,  ..., -1.0000e+07,
            2.3140e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.4731e-01, -1.0000e+07,  ..., -1.0000e+07,
            2.2502e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-2.5833e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.2334e-02,  1.2843e-01],
         [ 9.4210e-02,  1.1172e-01],
         [ 1.6771e-02,  1.4132e-01],
         [ 9.4476e-02,  1.5350e-01],
         [ 9.6950e-02,  1.5582e-01],
         [ 1.1263e-01,  1.2656e-01],
         [ 2.7565e-02,  1.0403e-01],
         [-6.5304e-02,  9.1718e-02],
         [ 1.2677e-02, -4.6738e-02],
         [ 3.5608e-02, -4.0279e-02],
         [ 1.3948e-01,  1.0046e-01],
         [ 1.3956e-01,  1.2324e-01],
         [ 2.6383e-02,  1.5398e-01],
         [ 1.2642e-01,  1.0202e-01],
         [ 1.3666e-01,  1.0467e-01],
         [ 1.3114e-01,  1.1772e-01],
         [ 5.1643e-02,  9.2078e-02],
         [ 6.7589e-02,  1.2583e-01],
         [ 5.1229e-02,  1.2902e-01],
         [ 7.1304e-02,  1.0315e-01],
         [ 1.6668e-01,  9.1633e-02],
         [ 1.7680e-01,  8.6050e-02],
         [ 1.5964e-01,  5.2992e-02],
         [ 1.4176e-01,  7.8185e-02],
         [ 1.4823e-01,  8.8306e-02],
         [ 1.4364e-01,  1.3236e-01],
         [ 1.4081e-01,  1.3988e-01],
         [ 1.7035e-01,  1.3946e-01],
         [ 1.6107e-01,  1.2548e-01],
         [ 1.7370e-01,  1.5120e-01],
         [ 1.4516e-01,  1.4849e-01],
         [ 1.6219e-01,  1.3046e-01],
         [ 1.7123e-01,  1.3859e-01],
         [ 1.3796e-01,  1.2250e-01],
         [ 1.5600e-01,  1.3855e-01],
         [-1.2797e-01,  1.4882e-01],
         [ 1.5321e-01,  1.1716e-01],
         [-2.6794e-02,  7.1650e-02],
         [ 1.2694e-02,  4.2041e-02],
         [ 3.2720e-02,  5.1409e-02],
         [ 4.2500e-02,  3.6503e-02],
         [ 4.7060e-02,  7.2315e-02],
         [ 4.9041e-02,  6.0649e-02],
         [ 4.9831e-02,  3.3900e-02],
         [ 5.0090e-02,  7.5003e-02],
         [ 5.0148e-02,  9.0500e-02],
         [ 5.0123e-02,  9.9550e-02],
         [ 5.0104e-02,  5.7068e-02],
         [ 5.0055e-02,  5.2107e-02],
         [ 5.0053e-02,  8.4142e-02],
         [ 5.0037e-02,  5.6714e-02],
         [ 5.0035e-02,  8.4584e-02],
         [ 5.0018e-02,  9.6284e-02],
         [ 5.0014e-02,  6.5931e-02],
         [ 5.0027e-02,  9.0036e-02],
         [ 5.0014e-02,  5.7394e-02],
         [ 5.0018e-02,  8.2049e-02],
         [ 5.0012e-02,  6.5623e-02],
         [ 5.0009e-02, -4.3108e-03],
         [ 5.0006e-02,  1.9502e-03],
         [ 5.0008e-02,  5.7588e-03],
         [ 5.0007e-02,  8.0655e-03],
         [ 5.0008e-02,  6.6008e-02],
         [ 5.0008e-02,  5.5699e-02],
         [ 5.0008e-02,  7.9436e-02],
         [ 5.0008e-02,  8.9974e-02],
         [ 5.0008e-02,  5.6480e-02],
         [ 5.0008e-02,  5.4526e-02],
         [ 5.0008e-02,  7.6034e-02],
         [ 5.0008e-02,  4.8589e-02],
         [ 5.0009e-02,  7.8667e-02],
         [ 5.0009e-02,  1.0735e-01],
         [ 5.0009e-02,  8.7148e-02],
         [ 5.0009e-02,  1.0248e-01],
         [ 5.0009e-02,  1.0741e-01],
         [ 5.0009e-02,  7.8701e-02],
         [ 5.0009e-02,  6.3627e-02],
         [ 5.0009e-02,  1.0202e-01],
         [ 5.0009e-02,  6.5074e-02],
         [ 5.0009e-02,  9.1847e-02],
         [ 5.0009e-02,  1.0255e-01],
         [ 5.0009e-02,  7.3281e-02],
         [ 5.0009e-02,  4.5128e-02],
         [ 5.0009e-02,  9.4603e-02],
         [ 5.0009e-02,  1.1070e-01],
         [ 5.0009e-02,  1.0668e-01],
         [ 5.0009e-02,  7.5672e-02],
         [ 5.0009e-02,  5.7879e-02],
         [ 5.0009e-02,  6.5212e-02],
         [ 5.0009e-02,  7.7017e-02],
         [ 5.0009e-02,  7.9772e-02],
         [ 5.0009e-02,  8.0878e-02],
         [ 5.0009e-02,  8.0218e-02],
         [ 5.0009e-02,  5.9990e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 3.1808e-02,  9.1207e-02],
         [ 9.2718e-02,  1.3579e-01],
         [ 2.5996e-02,  1.4334e-01],
         [ 1.2585e-01,  1.5485e-01],
         [ 1.3393e-01,  1.1345e-01],
         [ 1.1701e-01,  1.0497e-01],
         [ 1.2987e-01,  1.3023e-01],
         [ 1.3754e-01,  1.5381e-01],
         [ 1.3826e-01,  1.5278e-01],
         [ 1.0270e-01,  1.5996e-01],
         [ 1.0295e-01,  1.5961e-01],
         [ 1.0048e-01,  1.5394e-01],
         [ 4.8843e-02,  1.6986e-01],
         [ 5.9852e-02,  1.6235e-01],
         [ 1.0899e-01,  1.5952e-01],
         [ 1.1205e-01,  1.6436e-01],
         [ 1.0592e-01,  1.0696e-01],
         [-6.6960e-02,  6.4020e-02],
         [-6.2168e-02,  4.9931e-02],
         [ 1.1529e-01,  1.1805e-01],
         [ 1.2305e-01, -1.1771e-01],
         [ 1.0975e-01,  1.1116e-01],
         [-8.4848e-02,  8.6080e-03],
         [ 9.3601e-02,  3.6199e-02],
         [-5.8515e-02,  4.8625e-02],
         [ 9.7148e-02,  5.3620e-02],
         [ 1.0643e-01,  5.5335e-02],
         [ 1.0687e-01,  5.5706e-02],
         [ 9.3856e-02,  5.5662e-02],
         [ 8.5816e-02,  5.5490e-02],
         [ 9.4703e-02,  5.5360e-02],
         [ 7.3212e-02,  5.5278e-02],
         [-6.3281e-02,  5.5212e-02],
         [ 8.8440e-02,  5.5206e-02],
         [ 1.0286e-01,  5.5200e-02],
         [-6.6641e-02,  5.5187e-02],
         [ 9.4241e-02,  5.5197e-02],
         [ 1.0494e-01,  5.5208e-02],
         [-7.4241e-02,  5.5214e-02],
         [ 8.1205e-02,  5.5208e-02],
         [ 9.7631e-02,  5.5203e-02],
         [-7.1752e-02,  5.5221e-02],
         [ 7.8844e-02,  5.5228e-02],
         [-5.7198e-02,  5.5231e-02],
         [-4.0832e-02,  5.5230e-02],
         [ 9.4881e-02,  5.5230e-02],
         [ 1.0075e-01,  5.5231e-02],
         [-4.9671e-02,  5.5236e-02],
         [-4.2908e-02,  5.5235e-02],
         [-5.9292e-02,  5.5232e-02],
         [-4.4181e-02,  5.5232e-02],
         [-5.2230e-02,  5.5231e-02],
         [-3.8075e-02,  5.5231e-02],
         [-3.3059e-02,  5.5231e-02],
         [ 8.8957e-02,  5.5231e-02],
         [ 9.9542e-02,  5.5231e-02],
         [ 1.0162e-01,  5.5231e-02],
         [ 7.8543e-02,  5.5231e-02],
         [ 9.4476e-02,  5.5231e-02],
         [ 9.9660e-02,  5.5231e-02],
         [ 8.8309e-02,  5.5231e-02],
         [ 9.5261e-02,  5.5231e-02],
         [ 8.5645e-02,  5.5231e-02],
         [ 9.6023e-02,  5.5231e-02],
         [ 8.8069e-02,  5.5231e-02],
         [-9.8093e-02,  5.5231e-02],
         [ 7.7410e-02,  5.5231e-02],
         [ 8.2035e-02,  5.5231e-02],
         [ 8.4582e-02,  5.5231e-02],
         [ 8.3171e-02,  5.5231e-02],
         [ 8.8774e-02,  5.5231e-02],
         [ 8.7355e-02,  5.5231e-02],
         [-7.6676e-02,  5.5231e-02],
         [-8.2960e-02,  5.5231e-02],
         [ 8.2531e-02,  5.5231e-02],
         [ 1.1131e-01,  5.5231e-02],
         [ 1.2265e-01,  5.5231e-02],
         [ 8.9693e-02,  5.5231e-02],
         [ 9.9607e-02,  5.5231e-02],
         [ 1.0440e-01,  5.5231e-02],
         [ 1.0796e-01,  5.5231e-02],
         [ 1.1004e-01,  5.5231e-02],
         [ 1.1186e-01,  5.5231e-02],
         [ 1.1021e-01,  5.5231e-02],
         [ 1.1182e-01,  5.5231e-02],
         [ 9.4842e-02,  5.5231e-02],
         [ 8.5851e-02,  5.5231e-02],
         [ 7.5708e-02,  5.5231e-02],
         [ 9.5999e-02,  5.5231e-02],
         [ 8.1700e-02,  5.5231e-02],
         [ 4.7708e-02,  5.5231e-02],
         [ 7.9249e-02,  5.5231e-02],
         [ 9.0015e-02,  5.5231e-02],
         [ 2.3140e-01,  5.5231e-02],
         [ 2.2502e-01,  5.5231e-02],
         [-2.5833e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.0548e-06, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.0178, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4631, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4131, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0727, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1759, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0219, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-104166.5859, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2314, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.2216e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1663, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2052, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1663, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8206
target_mac_out tensor([[[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.9336e-02,  8.9318e-02,  ...,  1.5729e-02,
            1.2882e-01, -1.0000e+07],
          [-1.0000e+07, -2.5640e-02,  8.8110e-02,  ..., -1.8735e-02,
            1.3277e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.6715e-02,  8.6205e-02,  ..., -1.9925e-02,
            1.3653e-01, -1.0000e+07],
          [-1.0000e+07, -1.8158e-02,  9.3029e-02,  ...,  4.9172e-03,
            1.3856e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5429e-01,  7.3930e-02,  ...,  5.5188e-02,
            2.0320e-01, -3.1718e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4585e-01,  3.9728e-02,  ...,  5.0290e-02,
            1.8666e-01, -3.0990e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.1321e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3339e-02,  9.6645e-02,  ...,  1.7415e-02,
            1.4616e-01, -1.0000e+07],
          [-1.0000e+07, -3.2135e-02,  1.2998e-01,  ..., -1.6960e-03,
            1.4491e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3160e-01,  1.1777e-01,  ...,  4.7882e-02,
            1.6134e-01, -1.0000e+07],
          [-1.0000e+07, -4.8642e-02,  1.4400e-01,  ...,  1.8665e-02,
            1.5708e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 3.1469e-02,  8.4050e-02],
         [-4.9336e-02,  8.8110e-02],
         [-5.6715e-02,  9.3029e-02],
         [-6.4341e-02,  1.2713e-01],
         [-5.5152e-02, -3.8827e-03],
         [-8.1257e-02,  1.0950e-03],
         [ 9.2880e-02, -9.0083e-03],
         [ 9.5995e-02, -1.3961e-02],
         [-8.4926e-02,  1.0564e-01],
         [-9.4004e-02,  9.7873e-02],
         [ 9.9203e-02, -1.5697e-02],
         [ 1.2312e-01,  7.6151e-02],
         [-9.3184e-02,  9.2369e-02],
         [ 7.5175e-02,  1.0030e-01],
         [ 9.6348e-02,  1.0220e-01],
         [ 9.2178e-02,  1.0544e-01],
         [-1.0686e-01,  1.1686e-01],
         [ 6.2113e-02,  6.2421e-02],
         [ 8.6541e-02, -4.5029e-02],
         [ 8.7112e-02,  8.2918e-02],
         [ 9.9921e-02,  1.3363e-01],
         [ 3.4521e-02,  1.1581e-01],
         [ 5.8442e-02,  1.3996e-01],
         [ 1.2852e-01,  1.7366e-01],
         [ 1.5182e-01,  1.2420e-01],
         [ 7.0343e-02,  1.2131e-01],
         [ 4.2367e-02,  1.3834e-01],
         [ 1.3537e-01,  8.6083e-02],
         [ 1.4646e-01,  9.0422e-02],
         [ 1.5183e-01,  4.8601e-02],
         [ 1.3870e-01,  8.1963e-02],
         [ 1.0022e-01, -7.1725e-02],
         [ 1.1442e-01,  4.1479e-02],
         [ 1.2084e-01,  7.7650e-02],
         [-1.6687e-01,  8.5983e-02],
         [-1.5398e-01,  5.8932e-02],
         [-1.3405e-01,  1.1610e-01],
         [-1.3578e-01,  1.1495e-01],
         [-1.7049e-02,  1.0563e-01],
         [ 1.6099e-02, -7.2606e-02],
         [ 3.4188e-02,  5.8138e-02],
         [ 4.3249e-02,  4.7099e-02],
         [ 4.7464e-02, -5.5244e-02],
         [ 4.9250e-02,  3.5742e-02],
         [ 4.9928e-02,  4.6917e-02],
         [ 5.0124e-02, -5.2470e-02],
         [ 5.0152e-02,  4.5092e-02],
         [ 5.0120e-02, -5.3314e-02],
         [ 5.0086e-02, -5.7758e-02],
         [ 5.0056e-02,  7.7738e-02],
         [ 5.0047e-02,  5.9732e-02],
         [ 5.0045e-02,  8.9701e-02],
         [ 5.0049e-02,  9.8494e-02],
         [ 5.0024e-02,  5.7304e-02],
         [ 5.0016e-02,  8.6369e-02],
         [ 5.0020e-02,  5.2779e-02],
         [ 5.0020e-02,  8.7070e-02],
         [ 5.0021e-02,  9.9907e-02],
         [ 5.0015e-02,  5.8307e-02],
         [ 5.0006e-02, -5.9636e-02],
         [ 5.0007e-02,  7.0758e-02],
         [ 5.0007e-02,  4.6055e-02],
         [ 5.0007e-02,  7.3576e-02],
         [ 5.0008e-02,  8.2676e-02],
         [ 5.0008e-02,  8.5264e-02],
         [ 5.0008e-02, -4.6032e-02],
         [ 5.0008e-02, -3.0183e-02],
         [ 5.0008e-02, -1.2508e-02],
         [ 5.0008e-02, -6.7545e-03],
         [ 5.0008e-02, -4.9155e-03],
         [ 5.0009e-02,  7.0522e-02],
         [ 5.0009e-02,  8.6414e-02],
         [ 5.0009e-02,  1.1431e-01],
         [ 5.0009e-02,  6.1123e-02],
         [ 5.0009e-02,  8.6617e-02],
         [ 5.0009e-02,  9.6615e-02],
         [ 5.0009e-02,  6.2950e-02],
         [ 5.0009e-02,  8.5237e-02],
         [ 5.0009e-02,  5.0593e-02],
         [ 5.0009e-02,  6.0193e-02],
         [ 5.0009e-02,  4.3700e-02],
         [ 5.0009e-02,  3.9503e-02],
         [ 5.0009e-02,  3.7729e-02],
         [ 5.0009e-02,  3.4591e-02],
         [ 5.0009e-02,  6.6541e-02],
         [ 5.0009e-02,  8.0043e-02],
         [ 5.0009e-02,  8.6664e-02],
         [ 5.0009e-02,  9.4144e-02],
         [ 5.0009e-02,  9.6911e-02],
         [ 5.0009e-02,  7.7785e-02],
         [ 5.0009e-02,  8.8932e-02],
         [ 5.0009e-02,  1.1184e-01],
         [ 5.0009e-02,  9.1165e-02],
         [ 5.0009e-02,  9.0145e-02],
         [ 5.0009e-02,  1.0665e-01],
         [ 5.0009e-02,  1.2451e-01],
         [ 5.0009e-02,  8.4479e-02],
         [ 5.0009e-02,  1.1127e-01],
         [ 5.0009e-02,  1.1878e-01],
         [ 5.0009e-02,  1.2086e-01],
         [ 5.0009e-02,  1.1097e-01],
         [ 5.0009e-02,  7.3768e-02],
         [ 5.0009e-02,  4.7919e-02],
         [ 5.0009e-02,  7.6856e-02],
         [ 5.0009e-02,  9.0253e-02],
         [ 5.0009e-02,  8.7377e-02],
         [ 5.0009e-02,  7.3930e-02],
         [ 5.0009e-02, -1.4585e-01],
         [ 5.0009e-02,  1.1321e-03]],

        [[ 9.4778e-02,  1.0692e-01],
         [ 9.6645e-02,  1.2998e-01],
         [ 4.7882e-02,  1.4400e-01],
         [ 6.3187e-02,  1.1462e-01],
         [ 2.0025e-02,  1.0882e-01],
         [ 1.2160e-01, -4.7221e-02],
         [ 1.2200e-01, -2.5372e-02],
         [ 9.3507e-02,  7.4727e-02],
         [ 7.9455e-02,  5.0205e-02],
         [ 6.1355e-02, -4.8393e-02],
         [ 5.4345e-02,  3.5237e-02],
         [ 6.3237e-02,  1.0900e-01],
         [ 1.0255e-01,  1.0589e-01],
         [ 8.1013e-02,  7.3349e-02],
         [ 5.8497e-02, -6.3746e-02],
         [ 9.0388e-02, -5.3720e-02],
         [ 7.8296e-02,  6.9033e-02],
         [ 1.0927e-01,  9.0647e-02],
         [ 1.4323e-01,  9.7709e-02],
         [ 1.2367e-01,  6.1112e-02],
         [ 1.0930e-01,  8.5890e-02],
         [ 1.1947e-01,  9.6589e-02],
         [ 1.5744e-01,  7.3428e-02],
         [ 1.2182e-01,  4.1326e-02],
         [ 7.3658e-02,  7.9376e-02],
         [ 9.0879e-02,  5.2363e-02],
         [ 1.0322e-01,  5.7387e-02],
         [ 1.2635e-01,  7.8067e-02],
         [ 1.2381e-01,  8.8153e-02],
         [ 1.2268e-01,  9.3215e-02],
         [ 1.3587e-01, -6.5760e-02],
         [ 1.2816e-01,  6.3676e-02],
         [ 7.8189e-02,  1.2745e-01],
         [ 1.3545e-01,  1.5307e-01],
         [ 8.8157e-02,  1.3000e-01],
         [ 7.9697e-02,  1.1596e-01],
         [-1.4908e-01,  1.0737e-01],
         [ 9.9927e-02,  6.1056e-02],
         [ 6.4330e-02,  4.5697e-02],
         [ 7.4943e-02,  8.1580e-02],
         [ 1.0926e-01,  9.2965e-02],
         [ 1.4329e-01,  5.3831e-02],
         [ 1.5704e-01,  8.3183e-02],
         [ 1.1740e-01,  9.0627e-02],
         [ 1.0475e-01,  5.0328e-02],
         [ 1.1147e-01,  8.1398e-02],
         [ 1.4375e-01,  1.1608e-01],
         [ 1.4443e-01,  1.0540e-01],
         [ 1.1628e-01,  1.1048e-01],
         [ 1.0612e-01,  9.8121e-02],
         [ 1.2574e-01,  1.2472e-01],
         [ 1.3815e-01,  8.9994e-02],
         [ 1.0880e-01,  1.1554e-01],
         [ 1.2850e-01,  1.3903e-01],
         [ 1.3763e-01,  1.1481e-01],
         [ 1.4409e-01,  1.1135e-01],
         [ 1.1460e-01,  1.3143e-01],
         [ 1.3004e-01,  1.3346e-01],
         [ 7.0686e-03,  8.4842e-02],
         [ 2.8623e-02, -1.5916e-01],
         [ 4.0502e-02, -1.5803e-01],
         [ 4.6248e-02,  7.1869e-02],
         [ 4.8778e-02,  8.2718e-02],
         [ 4.9729e-02,  6.7001e-02],
         [ 5.0065e-02, -1.5528e-01],
         [ 5.0101e-02,  1.4303e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-8.9685e-06, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.4819, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5961, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4160, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0610, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1756, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0244, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1972476.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1737, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.2482e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0998, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1832, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0998, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8277
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0948e-02,  7.3316e-02,  ...,  4.2360e-02,
            1.4141e-01, -1.0000e+07],
          [-1.0000e+07, -1.8789e-02,  1.1070e-01,  ...,  4.1064e-03,
            1.2950e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0493e-01,  9.5342e-02,  ...,  2.8501e-02,
            1.6248e-01, -1.0000e+07],
          [-1.0000e+07, -2.5057e-02,  1.2023e-01,  ..., -1.0731e-02,
            1.3315e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2697e-02,  8.6043e-02,  ...,  3.6569e-04,
            1.4043e-01, -1.0000e+07],
          [-1.0000e+07, -3.0029e-02,  9.6760e-02,  ..., -1.6551e-02,
            1.3110e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4736e-02,  1.0545e-01,  ..., -4.9368e-04,
            1.6235e-01, -1.0000e+07],
          [-1.0000e+07, -4.2605e-02,  9.2510e-02,  ..., -3.6784e-02,
            1.3493e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7641e-01, -1.0000e+07,  ...,  4.8869e-02,
           -1.0000e+07, -2.5364e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6360e-01, -1.0000e+07,  ...,  4.3823e-02,
           -1.0000e+07, -2.4145e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.8764e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.0687e-02,  8.9914e-02],
         [-8.0948e-02,  1.1070e-01],
         [-1.0493e-01, -2.5057e-02],
         [-9.2587e-02,  1.4156e-01],
         [-1.0644e-01, -4.0353e-02],
         [-7.6575e-02, -4.8187e-02],
         [-8.9589e-02, -3.1261e-02],
         [-8.4542e-02,  9.9181e-02],
         [-9.1425e-02, -4.0001e-02],
         [ 9.8131e-02, -4.6573e-02],
         [-9.2479e-02,  7.2927e-02],
         [-8.8738e-02,  8.7967e-02],
         [-7.3215e-02,  1.1220e-01],
         [-5.2229e-02, -9.1545e-02],
         [-6.8613e-02,  1.0364e-01],
         [-7.4374e-02,  1.1695e-01],
         [-5.6511e-02,  7.7338e-02],
         [-4.0418e-02,  1.1185e-01],
         [-5.1149e-02,  1.2157e-01],
         [-5.6808e-02,  7.8122e-02],
         [-4.2105e-02,  9.8220e-02],
         [-5.2184e-02,  1.1613e-01],
         [-6.9471e-02,  8.1639e-02],
         [-4.9075e-02,  9.6023e-02],
         [-5.2413e-02,  1.0995e-01],
         [-6.8974e-02,  9.8083e-02],
         [ 1.3189e-01, -1.6438e-01],
         [ 1.5355e-01, -1.4232e-01],
         [ 1.3319e-01, -1.2817e-01],
         [ 1.4755e-01, -1.3862e-01],
         [ 1.4394e-01, -1.3374e-01],
         [ 1.1068e-01, -1.1742e-01],
         [ 1.3933e-01, -1.1364e-01],
         [ 1.0936e-01, -1.0852e-01],
         [ 1.4213e-01, -1.1956e-01],
         [ 1.1816e-01, -6.4278e-03],
         [-1.9170e-01,  2.5142e-02],
         [ 8.6109e-02,  4.2084e-02],
         [-1.5910e-01,  5.0180e-02],
         [ 8.0208e-02,  5.3727e-02],
         [ 1.0120e-01,  5.5128e-02],
         [ 8.3156e-02,  5.5544e-02],
         [ 1.2780e-01,  5.5612e-02],
         [ 9.8728e-02,  5.5523e-02],
         [ 1.1408e-01,  5.5444e-02],
         [ 8.9938e-02,  5.5359e-02],
         [ 9.4646e-02,  5.5309e-02],
         [ 9.5243e-02,  5.5259e-02],
         [ 9.3598e-02,  5.5215e-02],
         [ 8.0578e-02,  5.5232e-02],
         [ 7.5030e-02,  5.5209e-02],
         [ 1.0299e-01,  5.5215e-02],
         [ 8.2706e-02,  5.5215e-02],
         [ 1.1988e-01,  5.5220e-02],
         [ 8.9034e-02,  5.5223e-02],
         [-1.6264e-01,  5.5231e-02],
         [-1.4641e-01,  5.5232e-02],
         [ 1.5547e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.8559e-02,  9.0702e-02],
         [-6.2697e-02,  9.6760e-02],
         [-7.4736e-02,  9.2510e-02],
         [-8.4577e-02,  1.1852e-01],
         [-6.9401e-02, -4.2403e-02],
         [-7.1409e-02,  1.3997e-01],
         [-6.1283e-02, -8.1859e-02],
         [-7.4075e-02, -1.1118e-01],
         [-6.2544e-02,  9.4678e-02],
         [-2.3799e-02, -1.3246e-01],
         [-5.2935e-02, -1.1011e-01],
         [-8.0019e-02,  6.9178e-02],
         [ 1.1645e-01,  8.7885e-02],
         [-8.8876e-03,  6.8681e-02],
         [ 1.5746e-01,  1.0094e-01],
         [ 1.7028e-01,  1.0275e-01],
         [ 1.8137e-01,  1.2239e-01],
         [ 1.8975e-01,  1.1724e-01],
         [-5.2192e-02,  1.2663e-01],
         [ 1.3004e-01,  1.1875e-01],
         [-1.0766e-02,  8.1665e-02],
         [ 1.5515e-01,  9.9348e-02],
         [-6.0050e-02,  7.6186e-02],
         [ 1.0205e-01, -1.4736e-01],
         [ 9.8908e-02, -1.1912e-01],
         [-9.6951e-02, -1.0494e-01],
         [-8.2077e-02, -1.0517e-01],
         [-7.9326e-02, -9.5965e-02],
         [-8.4248e-02, -1.0010e-01],
         [-8.5441e-02, -9.1623e-02],
         [-7.5740e-02, -8.8893e-02],
         [-6.7316e-02,  1.5014e-02],
         [-5.2899e-02,  3.8661e-02],
         [-5.3683e-02,  5.0011e-02],
         [-1.7810e-02,  5.4585e-02],
         [-1.7715e-02,  5.6052e-02],
         [ 9.7084e-04,  5.6262e-02],
         [ 1.4634e-01,  5.6071e-02],
         [-3.3435e-02,  5.5783e-02],
         [ 9.7480e-02,  5.5577e-02],
         [-8.0924e-02,  5.5432e-02],
         [-6.2284e-02,  5.5317e-02],
         [-5.1036e-02,  5.5260e-02],
         [-5.4368e-02,  5.5217e-02],
         [-4.0350e-02,  5.5217e-02],
         [-6.4252e-02,  5.5210e-02],
         [ 9.9936e-02,  5.5211e-02],
         [ 1.0516e-01,  5.5226e-02],
         [ 1.0705e-01,  5.5208e-02],
         [ 1.0676e-01,  5.5218e-02],
         [ 1.2654e-01,  5.5221e-02],
         [ 1.3537e-01,  5.5223e-02],
         [-1.3124e-01,  5.5232e-02],
         [ 1.1663e-01,  5.5230e-02],
         [ 7.9174e-02,  5.5230e-02],
         [ 1.2274e-01,  5.5231e-02],
         [ 9.6635e-02,  5.5236e-02],
         [ 1.0700e-01,  5.5235e-02],
         [ 1.0815e-01,  5.5232e-02],
         [ 1.2503e-01,  5.5232e-02],
         [ 1.2374e-01,  5.5231e-02],
         [ 1.3389e-01,  5.5231e-02],
         [ 1.5225e-01,  5.5231e-02],
         [ 1.5867e-01,  5.5231e-02],
         [ 1.6042e-01,  5.5231e-02],
         [ 1.1433e-01,  5.5231e-02],
         [ 9.6289e-02,  5.5231e-02],
         [ 1.3500e-01,  5.5231e-02],
         [ 1.3141e-01,  5.5231e-02],
         [ 1.3824e-01,  5.5231e-02],
         [ 1.3149e-01,  5.5231e-02],
         [ 1.0908e-01,  5.5231e-02],
         [-1.8898e-01,  5.5231e-02],
         [-1.7992e-01,  5.5231e-02],
         [-1.7641e-01,  5.5231e-02],
         [-1.6360e-01,  5.5231e-02],
         [ 1.8764e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(0.0001, device='cuda:0') tensor(0.0016, device='cuda:0') tensor(-0.0017, device='cuda:0')
mixer_td_error tensor(0.3647, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4717, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4228, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0682, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1691, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0147, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1233766., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1897, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.7592e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1054, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2993, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1054, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8322
target_mac_out tensor([[[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1316e-01,  1.1405e-01,  ...,  4.5165e-02,
            1.3762e-01, -1.0000e+07],
          [-1.0000e+07, -5.2137e-02,  1.0687e-01,  ...,  4.0303e-02,
            1.4691e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3535e-01,  1.0750e-01,  ...,  1.7220e-02,
            1.5392e-01, -1.0000e+07],
          [-1.0000e+07, -9.3427e-02,  1.5680e-01,  ...,  7.1136e-02,
            1.4742e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0660e-01,  1.0891e-01,  ...,  4.0960e-02,
            1.4451e-01, -1.0000e+07],
          [-1.0000e+07, -1.8482e-02,  1.0351e-01,  ...,  3.3942e-02,
            1.3388e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8928e-02,  7.1365e-02,  ...,  2.7223e-02,
            1.4807e-01, -1.0000e+07],
          [-1.0000e+07, -6.4588e-03,  1.1091e-01,  ...,  1.4417e-02,
            1.1999e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -5.3589e-02,  1.3369e-01,  ...,  4.2509e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -6.3608e-02,  1.4634e-01,  ...,  5.5140e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.7686e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.2561e-02,  1.4136e-01],
         [ 4.5165e-02,  1.0687e-01],
         [-1.3535e-01,  1.5680e-01],
         [-1.4099e-01,  1.1287e-01],
         [-1.4718e-01,  1.0235e-01],
         [-1.2797e-01,  1.0276e-01],
         [-1.0056e-01,  9.5403e-02],
         [-9.8191e-02, -5.3408e-02],
         [-9.2720e-02, -2.6218e-02],
         [-7.2355e-02,  1.2852e-01],
         [-4.2763e-02,  1.4457e-01],
         [-5.8415e-02,  1.5174e-01],
         [ 1.7168e-01,  1.2656e-01],
         [-9.4477e-02,  1.4573e-01],
         [-1.0281e-01,  1.4921e-01],
         [-1.0601e-01, -5.6444e-02],
         [-7.3171e-02,  1.0559e-01],
         [-9.1293e-02, -4.6515e-02],
         [-1.1442e-01, -4.0512e-02],
         [ 1.9667e-01, -2.2922e-02],
         [-1.2273e-01,  1.3151e-01],
         [ 1.9460e-01, -4.1200e-02],
         [-1.0923e-01,  1.3779e-01],
         [-1.2253e-01, -3.8508e-02],
         [-1.0753e-01, -3.3591e-02],
         [-7.7339e-02, -2.7300e-02],
         [-5.3641e-02, -2.4812e-02],
         [-5.3764e-02, -5.9159e-03],
         [-6.4859e-02, -3.0387e-02],
         [-5.4220e-02,  1.2933e-01],
         [-7.7418e-02,  1.3417e-01],
         [-7.8937e-02, -4.6688e-02],
         [-8.9414e-02, -5.4071e-02],
         [-8.2515e-02, -5.3326e-02],
         [-6.8149e-02, -4.3880e-02],
         [-6.9199e-02, -5.3849e-02],
         [-8.7839e-02, -4.0259e-02],
         [-7.7394e-02, -5.7224e-02],
         [-7.2429e-02, -4.5732e-02],
         [-7.2239e-02, -3.5275e-02],
         [-9.7754e-02, -5.0106e-02],
         [ 5.2995e-02, -7.5594e-02],
         [-1.0129e-01, -6.2270e-02],
         [-9.8928e-02, -6.4270e-02],
         [-9.5342e-02, -8.3660e-02],
         [-7.9985e-02, -9.4776e-02],
         [-1.0160e-01, -9.5990e-02],
         [-1.0427e-01, -1.2161e-01],
         [ 1.1027e-01,  1.4325e-01],
         [ 1.1687e-01,  1.4936e-01],
         [-1.2676e-01, -1.3582e-01],
         [-1.1682e-01,  1.4036e-01],
         [-1.1345e-01, -1.2891e-01],
         [-1.1636e-01, -1.2859e-01],
         [ 1.1338e-01, -1.0875e-01],
         [ 1.1903e-01,  1.1782e-01],
         [ 1.2493e-01,  1.3311e-01],
         [ 1.2457e-01,  1.3930e-01],
         [-1.1718e-01,  1.3686e-01],
         [-9.9608e-02,  1.1550e-01],
         [-7.6183e-02, -9.0599e-02],
         [-7.8447e-02, -8.4003e-02],
         [-8.1427e-02, -1.1496e-01],
         [-7.8339e-02, -1.3661e-01],
         [-8.8979e-02, -1.4368e-01],
         [ 1.2843e-01, -1.4902e-01],
         [ 1.2783e-01, -1.3448e-01],
         [ 1.3372e-01, -1.4554e-01],
         [ 1.1717e-01, -1.2961e-01],
         [-1.0517e-01, -1.5478e-01],
         [ 1.1056e-01, -1.3499e-01],
         [-1.1554e-01, -1.1479e-01],
         [ 1.1866e-01,  2.1005e-02],
         [ 9.2700e-02,  4.1413e-02],
         [ 1.1245e-01,  5.0752e-02],
         [ 9.9266e-02,  5.4425e-02],
         [-1.6537e-01,  5.5606e-02],
         [ 8.9015e-02,  5.5785e-02],
         [ 9.0283e-02,  5.5652e-02],
         [ 8.1918e-02,  5.5501e-02],
         [ 1.0532e-01,  5.5357e-02],
         [ 1.1507e-01,  5.5283e-02],
         [ 7.3645e-02,  5.5240e-02],
         [ 9.6077e-02,  5.5211e-02],
         [ 1.0314e-01,  5.5201e-02],
         [ 1.0504e-01,  5.5186e-02],
         [ 1.0541e-01,  5.5224e-02],
         [ 1.2062e-01,  5.5188e-02],
         [ 1.2864e-01,  5.5218e-02],
         [ 8.9784e-02,  5.5211e-02],
         [ 1.1386e-01,  5.5213e-02],
         [ 9.8002e-02,  5.5221e-02],
         [ 1.1383e-01,  5.5229e-02],
         [ 9.5636e-02,  5.5232e-02],
         [ 1.0852e-01,  5.5230e-02],
         [ 1.2335e-01,  5.5231e-02],
         [ 1.2061e-01,  5.5231e-02],
         [ 1.0021e-01,  5.5236e-02],
         [ 1.0882e-01,  5.5235e-02],
         [ 9.1663e-02,  5.5232e-02],
         [ 1.2479e-01,  5.5232e-02],
         [ 7.6210e-02,  5.5231e-02],
         [-1.7074e-01,  5.5231e-02],
         [ 8.7737e-02,  5.5231e-02],
         [ 1.0439e-01,  5.5231e-02],
         [-8.7360e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 6.0687e-02,  8.9914e-02],
         [-1.0660e-01,  1.0351e-01],
         [-8.8928e-02, -6.4588e-03],
         [-1.2723e-01,  1.3664e-01],
         [-9.6845e-02,  1.4697e-01],
         [-1.3775e-01,  1.3410e-01],
         [-1.3517e-01,  1.1105e-01],
         [-1.0220e-01,  1.0349e-01],
         [-1.0871e-01, -3.4182e-02],
         [-1.2067e-01, -3.2360e-02],
         [-1.2919e-01,  1.2286e-01],
         [-1.1720e-01, -3.5147e-02],
         [-1.0012e-01,  1.3140e-01],
         [ 3.4930e-02,  1.4134e-01],
         [-8.1265e-02,  1.6046e-01],
         [ 5.4062e-02, -6.9796e-02],
         [ 4.2379e-02, -6.1864e-02],
         [ 4.9259e-02, -6.1988e-02],
         [ 1.3163e-01, -4.5172e-02],
         [ 5.8250e-02, -5.2699e-02],
         [-1.2060e-01, -4.5721e-02],
         [ 3.8779e-02, -4.7102e-02],
         [ 3.4019e-02,  1.3562e-01],
         [ 1.3325e-01,  1.5198e-01],
         [ 1.4066e-01, -1.1143e-01],
         [ 1.2262e-01,  9.1951e-02],
         [ 1.0962e-01,  9.7596e-02],
         [-1.0949e-01,  6.2137e-02],
         [ 9.6653e-02,  7.2180e-02],
         [ 1.2296e-01,  8.2419e-02],
         [ 9.2967e-02,  4.5509e-02],
         [ 9.7192e-02, -1.6757e-01],
         [ 1.0872e-01,  9.1904e-02],
         [ 1.1913e-01,  9.4866e-02],
         [ 1.0491e-01,  9.7274e-02],
         [ 1.1757e-01,  1.0496e-01],
         [ 1.2348e-01,  1.2557e-01],
         [-1.9505e-01,  1.2184e-01],
         [-1.6219e-01,  8.3242e-02],
         [-1.3973e-01,  8.3151e-02],
         [ 9.1154e-02,  2.3559e-01],
         [ 7.6238e-02,  2.1584e-01],
         [ 9.4505e-02,  7.0447e-02],
         [ 9.4086e-02,  6.0095e-02],
         [-1.2062e-01,  9.9076e-02],
         [-1.0549e-01,  5.6504e-02],
         [ 8.6235e-02,  8.5389e-02],
         [ 7.5013e-02,  9.1901e-02],
         [ 9.4536e-02,  1.0512e-01],
         [ 7.6552e-02,  9.8362e-02],
         [ 9.8397e-02,  9.4596e-02],
         [ 1.0604e-01,  6.4166e-02],
         [ 1.0807e-01, -1.4935e-01],
         [ 1.1879e-01, -1.2800e-01],
         [ 1.1360e-01, -1.0611e-01],
         [ 1.1549e-01, -9.0717e-02],
         [ 1.0928e-01,  1.2266e-01],
         [ 1.3305e-01, -8.6192e-02],
         [ 1.0559e-01, -8.7261e-02],
         [ 1.3164e-01,  1.1369e-01],
         [ 1.3856e-01,  9.5307e-02],
         [ 1.4407e-01,  1.1329e-01],
         [ 1.7035e-01,  1.2186e-01],
         [ 1.3371e-01,  8.8530e-02],
         [ 1.4009e-01,  7.1392e-02],
         [-1.7705e-01,  7.2937e-02],
         [-1.7149e-01,  8.9119e-02],
         [ 1.4125e-01,  9.5281e-02],
         [ 1.4634e-01,  1.0041e-01],
         [ 1.4501e-01,  9.6483e-02],
         [-1.6058e-01, -8.8676e-02],
         [ 4.5363e-02, -8.8102e-02],
         [ 4.5874e-02, -8.5134e-02],
         [ 4.8161e-02, -9.2496e-02],
         [ 4.9559e-02, -9.2230e-02],
         [ 5.0116e-02, -9.8284e-02],
         [ 5.0224e-02,  6.0389e-02],
         [ 5.0164e-02, -1.1042e-01],
         [ 5.0077e-02, -9.7295e-02],
         [ 5.0000e-02,  4.4727e-02],
         [ 4.9980e-02, -9.3247e-02],
         [ 4.9969e-02, -9.0482e-02],
         [ 4.9963e-02, -8.6838e-02],
         [ 4.9972e-02, -8.4312e-02],
         [ 4.9979e-02, -8.3054e-02],
         [ 4.9996e-02, -4.2544e-02],
         [ 5.0000e-02, -4.2143e-02],
         [ 5.0017e-02,  4.6068e-02],
         [ 5.0009e-02, -8.0027e-02],
         [ 5.0016e-02, -8.0504e-02],
         [ 5.0019e-02,  4.7998e-02],
         [ 5.0012e-02,  6.0842e-02],
         [ 5.0012e-02, -9.0781e-02],
         [ 5.0006e-02, -4.6383e-02],
         [ 5.0008e-02,  9.6558e-02],
         [ 5.0008e-02, -3.4917e-02],
         [ 5.0008e-02, -1.3267e-02],
         [ 5.0008e-02,  9.2911e-02],
         [ 5.0008e-02,  7.2137e-02],
         [ 5.0008e-02,  7.1514e-02],
         [ 5.0008e-02,  7.2525e-02],
         [ 5.0008e-02,  7.3659e-02],
         [ 5.0008e-02, -8.8620e-02],
         [ 5.0008e-02,  6.2098e-02],
         [ 5.0009e-02,  6.7826e-02],
         [ 5.0009e-02,  7.0866e-02],
         [ 5.0009e-02,  7.2535e-02],
         [ 5.0009e-02, -8.9379e-02],
         [ 5.0009e-02,  5.4795e-02],
         [ 5.0009e-02,  6.4876e-02],
         [ 5.0009e-02, -6.3228e-02],
         [ 5.0009e-02, -3.8461e-02],
         [ 5.0009e-02,  1.0135e-01],
         [ 5.0009e-02,  1.2118e-01],
         [ 5.0009e-02,  8.6418e-02],
         [ 5.0009e-02,  7.8670e-02],
         [ 5.0009e-02,  1.1152e-01],
         [ 5.0009e-02,  1.2383e-01],
         [ 5.0009e-02,  1.2864e-01],
         [ 5.0009e-02,  1.3082e-01],
         [ 5.0009e-02, -1.6182e-02],
         [ 5.0009e-02,  2.7622e-03],
         [ 5.0009e-02,  1.0138e-01],
         [ 5.0009e-02,  1.2165e-01],
         [ 5.0009e-02,  1.3272e-01],
         [ 5.0009e-02,  1.3925e-01],
         [ 5.0009e-02, -3.7249e-02],
         [ 5.0009e-02,  6.9259e-02],
         [ 5.0009e-02,  8.2112e-02],
         [ 5.0009e-02, -7.5416e-02],
         [ 5.0009e-02, -8.9079e-02],
         [ 5.0009e-02, -8.4093e-02],
         [ 5.0009e-02, -1.0652e-01],
         [ 5.0009e-02, -1.0365e-01],
         [ 5.0009e-02, -9.6471e-02],
         [ 5.0009e-02,  4.7889e-02],
         [ 5.0009e-02,  1.0175e-01],
         [ 5.0009e-02,  1.2143e-01],
         [ 5.0009e-02,  1.3214e-01],
         [ 5.0009e-02,  1.4587e-01],
         [ 5.0009e-02,  1.0074e-01],
         [ 5.0009e-02,  1.2682e-01],
         [ 5.0009e-02,  1.3574e-01],
         [ 5.0009e-02,  1.4887e-01],
         [ 5.0009e-02,  1.4346e-01],
         [ 5.0009e-02,  1.5426e-01],
         [ 5.0009e-02, -3.8568e-02],
         [ 5.0009e-02,  1.3369e-01],
         [ 5.0009e-02,  1.4634e-01],
         [ 5.0009e-02,  2.7686e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.3390e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.3481, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4557, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4454, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0596, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1367, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0222, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1466666.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2356, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.0039e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2137, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2376, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2137, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8409
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5898e-02,  1.0054e-01,  ...,  4.1830e-02,
            1.6437e-01, -1.0000e+07],
          [-1.0000e+07, -3.7039e-02,  1.0473e-01,  ..., -3.1371e-02,
            1.3582e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.9098e-01,  8.2850e-02,  ...,  9.2807e-02,
            2.2962e-01, -3.3740e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6709e-01,  5.4118e-02,  ...,  5.6809e-02,
            2.0959e-01, -3.2237e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 7.7317e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4725e-02,  7.3826e-02,  ..., -9.5147e-03,
            1.3830e-01, -1.0000e+07],
          [-1.0000e+07, -7.1175e-02,  1.6464e-01,  ...,  4.4025e-02,
            1.4698e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3461e-02,  8.0768e-02,  ..., -2.7243e-03,
            1.4735e-01, -1.0000e+07],
          [-1.0000e+07, -6.1149e-02,  1.2258e-01,  ...,  2.5322e-02,
            1.5353e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-7.2275e-02, -1.3772e-02],
         [-6.7838e-02, -1.4399e-02],
         [-8.5898e-02, -3.7039e-02],
         [-7.0085e-02, -4.7255e-02],
         [-7.7645e-02, -4.2822e-02],
         [-7.2394e-02, -5.5130e-02],
         [-7.9086e-02, -5.9508e-02],
         [-5.3548e-02, -4.2156e-02],
         [-6.6551e-02, -4.9623e-02],
         [-1.0358e-01, -4.2605e-02],
         [-7.3692e-02, -3.9232e-02],
         [-5.6930e-02, -4.3597e-02],
         [-4.0191e-02, -4.3882e-02],
         [-2.6975e-02, -3.8959e-02],
         [-4.4754e-02, -1.8133e-02],
         [-4.1412e-02, -4.4225e-02],
         [-4.2788e-02, -5.5343e-02],
         [-3.9149e-02, -6.6556e-02],
         [-3.7854e-02, -6.2646e-02],
         [-3.3808e-02, -6.0677e-02],
         [-3.4720e-02, -6.2139e-02],
         [-3.5918e-02, -6.5015e-02],
         [-6.5246e-02, -1.7075e-02],
         [-7.3247e-02, -8.4041e-04],
         [-3.7000e-02, -1.9121e-02],
         [-3.0549e-02, -2.9137e-02],
         [-5.8460e-02, -5.1759e-02],
         [-4.9790e-02, -6.6652e-02],
         [-5.9718e-02,  1.0145e-01],
         [-6.2740e-02, -6.5109e-02],
         [-7.6109e-02, -7.2763e-02],
         [-9.2419e-02, -5.9176e-02],
         [-1.0428e-01, -7.1048e-02],
         [-6.1418e-02, -4.3822e-02],
         [-8.0862e-02, -5.8653e-02],
         [-5.6284e-02, -8.5805e-02],
         [-5.5779e-02, -8.6979e-02],
         [-4.7365e-02, -7.9570e-02],
         [-7.4199e-02, -7.9416e-02],
         [-5.3724e-02, -7.3383e-02],
         [-5.6244e-02, -9.3775e-02],
         [-8.3508e-02, -3.1132e-02],
         [-1.0208e-01, -5.0785e-02],
         [-5.5325e-02, -7.4617e-02],
         [-4.3668e-02, -8.1379e-02],
         [-8.4641e-02, -7.3483e-02],
         [-9.7498e-02, -7.7779e-02],
         [-1.0755e-01, -7.5059e-02],
         [-9.2350e-02, -8.7536e-02],
         [-8.1581e-02, -1.0215e-01],
         [-7.3755e-02, -1.0109e-01],
         [-8.7106e-02, -1.1821e-01],
         [-8.8936e-02, -1.1236e-01],
         [-1.0080e-01, -1.0807e-01],
         [-8.6562e-02, -1.1047e-01],
         [-9.8142e-02, -1.4333e-01],
         [-9.8327e-02, -1.2122e-01],
         [-1.4117e-01, -1.0538e-01],
         [-1.1276e-01, -1.4169e-01],
         [-1.4379e-01, -1.5398e-01],
         [-1.4734e-01, -1.5793e-01],
         [-1.8002e-01, -1.4302e-01],
         [-1.9224e-01, -1.6569e-01],
         [-1.7914e-01, -1.4116e-01],
         [-1.7829e-01,  1.2369e-01],
         [-1.9170e-01,  1.2750e-01],
         [-1.7449e-01, -1.6117e-01],
         [-2.0462e-01, -1.4728e-01],
         [-2.0822e-01, -1.4799e-01],
         [-1.9939e-01, -1.4236e-01],
         [-2.0755e-01, -1.4152e-01],
         [-1.8161e-01, -1.3967e-01],
         [-1.7108e-01,  1.1031e-01],
         [-1.5483e-01, -1.3453e-01],
         [-1.6252e-01, -1.2270e-01],
         [-1.5549e-01, -1.1343e-01],
         [-1.4815e-01,  1.1065e-01],
         [-1.5092e-01,  9.7337e-02],
         [-2.7880e-02, -1.2127e-01],
         [ 1.1731e-02,  9.7769e-02],
         [ 3.2451e-02,  9.7303e-02],
         [ 4.2652e-02,  9.9711e-02],
         [ 4.7360e-02, -9.8532e-02],
         [ 4.9350e-02, -8.6290e-02],
         [ 5.0077e-02, -1.0153e-01],
         [ 5.0260e-02, -1.0161e-01],
         [ 5.0237e-02, -8.2090e-02],
         [ 5.0194e-02, -8.3019e-02],
         [ 5.0129e-02,  9.1984e-02],
         [ 5.0073e-02,  7.7525e-02],
         [ 5.0050e-02,  9.9920e-02],
         [ 5.0032e-02,  7.0477e-02],
         [ 5.0042e-02,  8.3020e-02],
         [ 5.0034e-02,  9.0730e-02],
         [ 5.0034e-02,  7.9712e-02],
         [ 5.0024e-02, -1.9040e-01],
         [ 5.0012e-02,  9.9623e-02],
         [ 5.0007e-02,  1.1556e-01],
         [ 5.0013e-02,  7.8086e-02],
         [ 5.0005e-02, -1.8662e-01],
         [ 5.0006e-02, -1.7315e-01],
         [ 5.0008e-02, -1.5965e-01],
         [ 5.0008e-02, -1.5086e-01],
         [ 5.0008e-02, -1.7917e-01],
         [ 5.0009e-02, -1.9098e-01],
         [ 5.0008e-02, -1.6709e-01],
         [ 5.0008e-02,  7.7317e-03]],

        [[-5.9256e-02, -4.8886e-02],
         [-7.4725e-02, -7.1175e-02],
         [-8.3461e-02, -6.1149e-02],
         [-1.0171e-01, -5.2159e-02],
         [-1.0962e-01, -6.0352e-02],
         [-1.3225e-01, -6.5661e-02],
         [-1.3539e-01, -5.7941e-02],
         [-1.3823e-01, -6.7401e-02],
         [-1.6412e-01, -6.3240e-02],
         [-1.8342e-01, -5.4766e-02],
         [-1.5347e-01, -4.2412e-02],
         [-1.6147e-01, -2.8899e-02],
         [-1.6420e-01, -3.8615e-02],
         [-1.8409e-01, -5.4143e-02],
         [-1.8372e-01, -5.4675e-02],
         [-1.8811e-01, -5.5527e-02],
         [-1.9240e-01,  1.2691e-01],
         [-1.8528e-01,  1.4442e-01],
         [-1.9452e-01, -8.7360e-02],
         [-1.3323e-01,  1.3601e-01],
         [-8.9317e-02,  1.4502e-01],
         [-1.0040e-01,  1.7659e-01],
         [-1.0933e-01,  1.8635e-01],
         [-1.1577e-01, -1.3943e-01],
         [-1.3214e-01, -1.4556e-01],
         [-1.1129e-01,  8.8129e-02],
         [-1.5158e-01, -1.6457e-01],
         [-1.7676e-01,  9.8646e-02],
         [-1.2902e-01,  1.1906e-01],
         [-1.3757e-01,  8.3028e-02],
         [-1.2711e-01,  1.5314e-01],
         [-1.2743e-01,  1.3825e-01],
         [-1.0876e-01, -1.5788e-01],
         [-1.2370e-01, -1.5100e-01],
         [-1.3645e-01, -1.5342e-01],
         [ 1.5921e-02, -1.4664e-01],
         [ 3.2868e-02, -1.4572e-01],
         [ 4.3130e-02, -1.4496e-01],
         [ 4.8107e-02, -1.5244e-01],
         [ 5.0149e-02, -1.4855e-01],
         [ 5.0761e-02, -1.4298e-01],
         [ 5.0763e-02, -1.5232e-01],
         [ 5.0591e-02, -1.1181e-01],
         [ 5.0435e-02, -9.8561e-02],
         [ 5.0262e-02, -6.6831e-02],
         [ 5.0157e-02, -7.3476e-02],
         [ 5.0111e-02, -5.3675e-02],
         [ 5.0069e-02, -4.6106e-02],
         [ 5.0051e-02, -6.8094e-02],
         [ 5.0043e-02, -9.2832e-02],
         [ 5.0026e-02, -1.0105e-01],
         [ 5.0009e-02,  3.4693e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.9175e-05, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.6687, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4610, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3075, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0468, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1712, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0522, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2570093., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1863, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.3257e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1255, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3018, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1255, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8464
target_mac_out tensor([[[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.1908e-02,  7.1628e-02,  ...,  3.0978e-03,
            1.2913e-01, -1.0000e+07],
          [-1.0000e+07, -3.1400e-02,  1.4762e-01,  ...,  2.0198e-03,
            1.5187e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7357e-02,  7.2546e-02,  ..., -1.2115e-02,
            1.4121e-01, -1.0000e+07],
          [-1.0000e+07, -3.8792e-02,  1.6292e-01,  ..., -7.4744e-03,
            1.6052e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6666e-01,  6.7277e-02,  ...,  4.2074e-02,
            1.2994e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.5088e-01,  4.7743e-02,  ...,  4.6411e-02,
            1.1840e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.2708e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5820e-02,  1.1367e-01,  ...,  2.0960e-02,
            1.5981e-01, -1.0000e+07],
          [-1.0000e+07, -3.3890e-02,  1.2184e-01,  ..., -9.4792e-03,
            1.4216e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1924e-01,  1.3271e-01,  ...,  5.0892e-02,
            1.6482e-01, -1.0000e+07],
          [-1.0000e+07, -3.9922e-02,  1.0263e-01,  ...,  1.4207e-03,
            1.4848e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.3449e-02, -2.1358e-02],
         [-6.1908e-02, -3.1400e-02],
         [-7.7357e-02, -3.8792e-02],
         [-5.0601e-02, -5.8105e-02],
         [-7.3077e-02, -5.3262e-02],
         [-4.9715e-02, -5.8941e-02],
         [-5.2217e-02, -6.1788e-02],
         [-5.6794e-02, -7.6118e-02],
         [-6.0736e-02, -5.6495e-02],
         [-5.0518e-02, -6.4970e-02],
         [-2.1181e-02, -5.5164e-02],
         [ 6.8323e-03, -7.3987e-02],
         [-8.4277e-03, -5.5711e-02],
         [-1.8376e-02, -6.0434e-02],
         [-3.2191e-02, -3.0044e-02],
         [-6.3426e-02, -2.5155e-02],
         [-8.9235e-02, -3.1515e-02],
         [-9.9461e-02, -3.2455e-02],
         [-1.3700e-01, -4.2422e-02],
         [-1.3699e-01, -4.5578e-02],
         [-1.5172e-01, -5.6171e-02],
         [-1.2481e-01, -6.4576e-02],
         [-1.0332e-01, -6.7885e-02],
         [-1.0331e-01, -7.2202e-02],
         [-1.1317e-01, -7.2475e-02],
         [-9.5544e-02, -7.0246e-02],
         [-1.0436e-01, -1.0649e-01],
         [-8.6150e-02, -1.1801e-01],
         [-7.9655e-02, -1.0024e-01],
         [-9.2678e-02, -8.8900e-02],
         [-6.8981e-02, -7.6478e-02],
         [-7.6985e-02, -7.5209e-02],
         [-8.2144e-02, -6.2893e-02],
         [-6.4067e-02, -5.5314e-02],
         [-4.7229e-02, -3.4155e-02],
         [-7.0472e-02, -2.1217e-02],
         [-8.0773e-02, -9.2338e-03],
         [-8.6787e-02, -2.2705e-02],
         [-1.0301e-01, -2.2168e-02],
         [-1.1051e-01, -4.3105e-02],
         [-8.9637e-02, -5.4618e-02],
         [-9.4151e-02, -6.4602e-02],
         [-1.0459e-01, -7.1704e-02],
         [-1.1221e-01, -8.0570e-02],
         [-1.2964e-01, -8.6689e-02],
         [-1.0200e-01, -7.7549e-02],
         [-1.4135e-01, -7.5736e-02],
         [-1.1096e-01, -5.2704e-02],
         [-1.3123e-01, -4.6195e-02],
         [-1.4532e-01, -5.8270e-02],
         [-1.4590e-01, -5.1359e-02],
         [-1.5852e-01, -5.8309e-02],
         [-1.7363e-01, -7.3638e-02],
         [-1.6889e-01, -8.3327e-02],
         [-1.3343e-01, -7.5399e-02],
         [-1.1365e-01, -5.6075e-02],
         [-1.3131e-01, -6.8827e-02],
         [-1.2233e-01, -6.4713e-02],
         [-1.6706e-01, -6.8092e-02],
         [-1.8463e-01, -7.1879e-02],
         [-1.4426e-01, -5.2687e-02],
         [-1.2301e-01, -5.5074e-02],
         [-1.1257e-01, -6.6767e-02],
         [-9.9781e-02, -7.1163e-02],
         [-1.5171e-01, -6.4783e-02],
         [-1.6849e-01, -8.0132e-02],
         [-1.7888e-01, -9.1049e-02],
         [-1.8510e-01, -9.8666e-02],
         [-1.4361e-01, -8.2819e-02],
         [-1.6985e-01, -7.4158e-02],
         [-1.7058e-01, -7.1632e-02],
         [-1.6933e-01, -7.2757e-02],
         [-1.3692e-01, -8.7245e-02],
         [-1.2762e-01, -1.0703e-01],
         [-1.2390e-01, -1.1501e-01],
         [-1.0528e-01, -1.1809e-01],
         [-1.2538e-01, -1.2804e-01],
         [-1.0669e-01, -1.1290e-01],
         [-9.5953e-02, -1.1190e-01],
         [-9.3585e-02, -1.0867e-01],
         [-9.9426e-02, -1.0724e-01],
         [-1.3330e-01, -6.3942e-02],
         [-1.6364e-01, -6.5658e-02],
         [-2.0979e-01, -7.3397e-02],
         [-1.9892e-01, -8.2369e-02],
         [-1.6522e-01, -8.6819e-02],
         [-1.3915e-01, -7.5248e-02],
         [-1.1579e-01, -6.1299e-02],
         [-1.3740e-01, -5.6447e-02],
         [-1.1900e-01, -7.0391e-02],
         [-1.1132e-01, -6.7150e-02],
         [-9.2779e-02, -1.6950e-02],
         [-6.6610e-02, -3.2856e-02],
         [-1.1212e-01, -2.6543e-03],
         [-1.0070e-01, -3.4410e-02],
         [-6.4571e-02, -2.2195e-02],
         [-5.3063e-02, -5.9894e-02],
         [-4.9596e-02, -5.7370e-02],
         [-7.2952e-02, -7.4282e-02],
         [-7.2905e-02, -9.3482e-02],
         [-7.2267e-02, -1.0213e-01],
         [-9.6035e-02, -1.0786e-01],
         [-9.2260e-02, -1.0361e-01],
         [-9.2498e-02, -9.9337e-02],
         [-9.9157e-02, -9.5831e-02],
         [-9.3351e-02, -9.7715e-02],
         [-9.6821e-02, -9.1430e-02],
         [-1.0747e-01, -9.7392e-02],
         [-9.6128e-02, -9.6195e-02],
         [-1.3395e-01, -1.1287e-01],
         [-1.3361e-01, -9.4637e-02],
         [-1.1186e-01, -8.9556e-02],
         [-1.3433e-01, -9.9694e-02],
         [-1.7602e-01, -1.2800e-01],
         [-1.5232e-01, -1.2071e-01],
         [-1.3002e-01, -1.1938e-01],
         [-1.1164e-01, -1.3522e-01],
         [-1.1071e-01, -1.2973e-01],
         [-1.0250e-01, -1.2413e-01],
         [-1.0631e-01, -1.1773e-01],
         [-1.2001e-01, -1.3026e-01],
         [-8.6238e-02, -1.2342e-01],
         [-6.4402e-02, -1.1694e-01],
         [-5.1294e-02, -1.1217e-01],
         [-7.4195e-02, -1.2657e-01],
         [-8.3580e-02, -1.1591e-01],
         [-5.4693e-02, -1.1477e-01],
         [-7.2631e-02, -1.3111e-01],
         [-8.6813e-02, -1.3893e-01],
         [-6.1649e-02, -1.2851e-01],
         [-8.6076e-02, -1.1161e-01],
         [-5.3733e-02, -9.5706e-02],
         [-5.5057e-02, -6.5637e-03],
         [-3.0857e-02,  3.0356e-02],
         [-2.5816e-02,  4.6682e-02],
         [-6.3654e-02,  5.3259e-02],
         [-2.0505e-02,  5.5532e-02],
         [-5.8999e-02,  5.6072e-02],
         [-8.3611e-02,  5.5997e-02],
         [-9.7164e-02,  5.5767e-02],
         [-7.6884e-02,  5.5556e-02],
         [-9.0684e-02,  5.5411e-02],
         [-1.1674e-01,  5.5299e-02],
         [-1.3473e-01,  5.5256e-02],
         [-1.2687e-01,  5.5219e-02],
         [-1.0905e-01,  5.5217e-02],
         [-1.2881e-01,  5.5210e-02],
         [-9.1174e-02,  5.5206e-02],
         [-5.4478e-02,  5.5215e-02],
         [-6.1476e-02,  5.5219e-02],
         [-6.6968e-02,  5.5211e-02],
         [-1.0327e-01,  5.5217e-02],
         [-1.0147e-01,  5.5223e-02],
         [-1.4142e-01,  5.5232e-02],
         [-1.0332e-01,  5.5230e-02],
         [-9.5328e-02,  5.5230e-02],
         [-9.1639e-02,  5.5231e-02],
         [-1.0614e-01,  5.5236e-02],
         [-1.4885e-01,  5.5235e-02],
         [-1.8938e-01,  5.5232e-02],
         [-1.7420e-01,  5.5232e-02],
         [-1.8876e-01,  5.5231e-02],
         [-1.7221e-01,  5.5231e-02],
         [-1.8400e-01,  5.5231e-02],
         [-1.8490e-01,  5.5231e-02],
         [-1.9768e-01,  5.5231e-02],
         [-1.8947e-01,  5.5231e-02],
         [-1.9452e-01,  5.5231e-02],
         [-2.0229e-01,  5.5231e-02],
         [-1.8926e-01,  5.5231e-02],
         [-1.8299e-01,  5.5231e-02],
         [-1.6666e-01,  5.5231e-02],
         [-1.5088e-01,  5.5231e-02],
         [ 3.2708e-02,  5.5231e-02]],

        [[-6.8669e-02, -2.0465e-02],
         [-8.5820e-02, -3.3890e-02],
         [-1.1924e-01, -3.9922e-02],
         [-1.3638e-01, -6.1391e-02],
         [-1.4252e-01, -8.1290e-02],
         [-1.3770e-01, -9.1211e-02],
         [-1.5027e-01, -1.0088e-01],
         [-1.5301e-01, -8.8933e-02],
         [-1.3834e-01, -9.3235e-02],
         [-1.6396e-01, -1.0427e-01],
         [-1.8588e-01, -8.7988e-02],
         [-1.4450e-01, -1.2839e-01],
         [-1.5262e-01, -1.0101e-01],
         [-1.2700e-01, -1.2726e-01],
         [-1.4797e-01, -9.7385e-02],
         [-1.2637e-01, -1.2452e-01],
         [-1.3984e-01, -9.5702e-02],
         [-1.4933e-01, -1.2375e-01],
         [-1.5525e-01, -1.4642e-01],
         [-1.2472e-01, -1.4086e-01],
         [-1.3138e-01, -1.6641e-01],
         [-1.5554e-01, -1.5885e-01],
         [-1.7209e-01, -1.5514e-01],
         [-1.7040e-01, -1.7605e-01],
         [-1.5731e-01, -1.7257e-01],
         [-1.4642e-01, -1.5916e-01],
         [-1.5664e-01, -1.4213e-01],
         [-1.2248e-01, -1.5603e-01],
         [-1.2162e-01, -1.7316e-01],
         [-1.2446e-01, -1.8644e-01],
         [-1.1268e-01, -1.6808e-01],
         [-1.4865e-01, -1.5552e-01],
         [-1.6432e-01, -1.4967e-01],
         [-1.8134e-01, -1.6745e-01],
         [-2.1196e-01, -1.7369e-01],
         [-2.1871e-01, -1.5680e-01],
         [-1.8482e-01, -1.4962e-01],
         [-1.8267e-01, -1.5227e-01],
         [-1.8344e-01, -1.4590e-01],
         [-1.9106e-01, -1.3854e-01],
         [-2.0230e-01, -1.2370e-01],
         [-2.0323e-01, -1.2546e-01],
         [-1.8970e-01,  8.7455e-03],
         [-1.9059e-01,  3.4000e-02],
         [-1.9431e-01,  4.6591e-02],
         [-1.9386e-01,  5.2196e-02],
         [-1.6481e-02,  5.4450e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.5899e-05, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.9095, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4529, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3769, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0328, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1326, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0946, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3649425., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0561, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.1034e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1121, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2999, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1121, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8528
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2179e-02,  8.7653e-02,  ...,  1.1971e-02,
            1.4701e-01, -1.0000e+07],
          [-1.0000e+07, -3.7128e-02,  1.3220e-01,  ...,  9.6965e-03,
            1.4422e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0670e-01,  9.3996e-02,  ...,  1.3476e-02,
            1.4757e-01, -1.0000e+07],
          [-1.0000e+07, -5.6947e-02,  1.4811e-01,  ...,  1.4058e-03,
            1.5377e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6512e-01,  6.2216e-02,  ...,  3.5608e-02,
            2.0634e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6362e-01,  6.8986e-02,  ...,  3.7427e-02,
            2.0629e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 3.7007e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.7245e-02,  7.9477e-02,  ...,  3.3060e-02,
            1.4031e-01, -1.0000e+07],
          [-1.0000e+07, -1.3393e-02,  1.0346e-01,  ...,  1.0057e-02,
            1.4004e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-9.5620e-02, -1.6811e-02],
         [-9.2179e-02, -3.7128e-02],
         [-1.0670e-01, -5.6947e-02],
         [-8.7874e-02, -6.5921e-02],
         [-1.0109e-01, -7.1549e-02],
         [-8.6052e-02, -7.4454e-02],
         [-9.1497e-02, -7.4545e-02],
         [-8.8709e-02, -7.2704e-02],
         [-7.0546e-02, -6.7783e-02],
         [-5.9152e-02, -6.8085e-02],
         [-4.8828e-02, -6.7527e-02],
         [-6.9417e-02, -6.3172e-02],
         [-5.5009e-02, -8.5916e-02],
         [-7.4783e-02, -1.0278e-01],
         [-6.5360e-02, -9.9116e-02],
         [-6.2902e-02, -7.8468e-02],
         [-6.3644e-02, -7.1063e-02],
         [-5.2165e-02, -6.1032e-02],
         [-5.1552e-02, -5.6546e-02],
         [-5.4172e-02, -5.1234e-02],
         [-2.4465e-02, -5.9684e-02],
         [-6.0128e-02, -7.4352e-02],
         [-3.5283e-02, -6.9150e-02],
         [-4.9939e-02, -5.7192e-02],
         [-7.9141e-02, -7.1313e-02],
         [-9.5164e-02, -8.1111e-02],
         [-6.4217e-02, -8.0462e-02],
         [-6.3678e-02, -7.4813e-02],
         [-2.5612e-02, -7.2430e-02],
         [-1.4126e-02, -6.9868e-02],
         [-2.5521e-02, -6.4976e-02],
         [-6.8231e-03, -6.3075e-02],
         [-2.6686e-02, -7.9021e-02],
         [-4.2579e-02, -6.9711e-02],
         [-5.3547e-02, -5.1439e-02],
         [-6.2517e-02, -6.0200e-02],
         [-5.0918e-02, -5.0283e-02],
         [-5.2291e-02, -5.0556e-02],
         [-8.6846e-02, -5.6060e-02],
         [-1.3812e-01, -5.9314e-02],
         [-1.0887e-01, -4.8236e-02],
         [-7.6975e-02, -5.1697e-02],
         [-1.0247e-01, -6.6702e-02],
         [-1.4506e-01, -9.2262e-02],
         [-1.1808e-01, -9.9908e-02],
         [-1.1758e-01, -1.1504e-01],
         [-1.1669e-01, -1.2703e-01],
         [-1.3211e-01, -1.2733e-01],
         [-1.2830e-01, -1.3864e-01],
         [-1.4747e-01, -1.1133e-01],
         [-1.7442e-01, -1.0725e-01],
         [-1.6207e-01, -1.1888e-01],
         [-1.6713e-01, -1.5036e-01],
         [-1.7047e-01, -1.4508e-01],
         [-2.6784e-01, -1.1604e-01],
         [-1.4850e-01, -1.4168e-01],
         [-1.6353e-01, -1.3823e-01],
         [-2.6481e-01, -1.4117e-01],
         [ 2.1132e-03, -1.4526e-01],
         [ 2.6834e-02, -1.5433e-01],
         [ 3.9943e-02, -1.2875e-01],
         [ 4.6352e-02, -1.3295e-01],
         [ 4.9214e-02, -1.1928e-01],
         [ 5.0319e-02, -1.0100e-01],
         [ 5.0604e-02, -7.7991e-02],
         [ 5.0568e-02, -7.0598e-02],
         [ 5.0458e-02, -5.6308e-02],
         [ 5.0300e-02, -7.6025e-02],
         [ 5.0204e-02, -9.2012e-02],
         [ 5.0123e-02, -8.8178e-02],
         [ 5.0097e-02, -1.0396e-01],
         [ 5.0035e-02, -9.5127e-02],
         [ 5.0035e-02, -1.0250e-01],
         [ 5.0014e-02, -1.2066e-01],
         [ 5.0021e-02, -1.3605e-01],
         [ 5.0019e-02, -1.3645e-01],
         [ 5.0017e-02, -1.3791e-01],
         [ 5.0014e-02, -1.5621e-01],
         [ 5.0005e-02, -1.6822e-01],
         [ 5.0007e-02, -1.6028e-01],
         [ 5.0007e-02, -1.4463e-01],
         [ 5.0007e-02, -1.2715e-01],
         [ 5.0008e-02, -1.3180e-01],
         [ 5.0008e-02, -1.2424e-01],
         [ 5.0008e-02, -1.3719e-01],
         [ 5.0008e-02, -1.4828e-01],
         [ 5.0008e-02, -1.5016e-01],
         [ 5.0008e-02, -1.4859e-01],
         [ 5.0008e-02, -1.5771e-01],
         [ 5.0009e-02, -1.5878e-01],
         [ 5.0009e-02, -1.6963e-01],
         [ 5.0009e-02, -1.7200e-01],
         [ 5.0009e-02, -1.6601e-01],
         [ 5.0009e-02, -1.6172e-01],
         [ 5.0009e-02, -1.6512e-01],
         [ 5.0009e-02, -1.6362e-01],
         [ 5.0009e-02,  3.7007e-03]],

        [[-7.2275e-02, -1.3772e-02],
         [-6.7838e-02, -1.4399e-02],
         [-5.7245e-02, -1.3393e-02],
         [-5.9561e-02, -1.4934e-02],
         [-5.8676e-02, -9.8598e-03],
         [-5.3396e-02, -4.9519e-02],
         [-6.7908e-02, -3.6543e-02],
         [-7.6112e-02, -1.8267e-02],
         [-6.3318e-02, -1.6147e-02],
         [-5.6005e-02, -1.5380e-02],
         [-5.6666e-02, -3.0539e-02],
         [-2.0544e-02, -3.4293e-02],
         [-5.0392e-02, -3.4341e-02],
         [-7.1271e-02, -4.9212e-02],
         [-8.3782e-02, -6.5238e-02],
         [-5.0835e-02, -7.8552e-02],
         [-5.0672e-02, -8.5195e-02],
         [-5.4181e-02, -7.4532e-02],
         [-4.5298e-02, -8.1656e-02],
         [-1.7373e-02, -7.3473e-02],
         [-3.6655e-02, -1.1646e-01],
         [-6.4460e-02, -1.0385e-01],
         [-1.1404e-01, -1.1047e-01],
         [-1.3268e-01, -1.2380e-01],
         [-1.5103e-01, -1.2143e-01],
         [-1.5528e-01, -1.2234e-01],
         [-1.4986e-01, -1.5830e-01],
         [-1.7354e-01, -1.5532e-01],
         [-1.8436e-01, -1.9949e-01],
         [-2.1462e-01, -1.6920e-01],
         [-2.2296e-01, -1.5191e-01],
         [-2.1745e-01, -1.3592e-01],
         [-2.0641e-01, -1.2723e-01],
         [-1.8861e-01, -1.3664e-01],
         [-1.5744e-01, -1.6724e-01],
         [-1.5074e-01, -1.7934e-01],
         [-9.5712e-02, -1.8521e-01],
         [-1.0684e-01, -1.9139e-01],
         [-7.8159e-02, -1.7175e-01],
         [-8.2426e-02, -1.8505e-01],
         [-7.5717e-02, -1.6868e-01],
         [-8.2212e-02, -1.6263e-01],
         [-1.1251e-01,  2.9010e-02],
         [-1.3562e-01,  4.6689e-02],
         [-1.3536e-01,  5.3856e-02],
         [-1.5277e-01,  5.6210e-02],
         [-1.1622e-01,  5.6568e-02],
         [-1.3855e-01,  5.6340e-02],
         [-1.7011e-01,  5.5960e-02],
         [-1.4134e-01,  5.5660e-02],
         [-1.0986e-01,  5.5416e-02],
         [-1.3583e-01,  5.5306e-02],
         [-1.4710e-01,  5.5236e-02],
         [-1.7792e-01,  5.5216e-02],
         [-1.7988e-01,  5.5202e-02],
         [-1.8132e-01,  5.5176e-02],
         [-1.3777e-01,  5.5217e-02],
         [-9.8911e-02,  5.5210e-02],
         [-7.7241e-02,  5.5201e-02],
         [-9.5670e-02,  5.5195e-02],
         [-9.2756e-02,  5.5203e-02],
         [-1.2366e-01,  5.5221e-02],
         [-1.3125e-01,  5.5229e-02],
         [-1.4322e-01,  5.5231e-02],
         [ 1.2040e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.0384e-05, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0020, device='cuda:0')
mixer_td_error tensor(0.3894, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4535, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5299, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0135, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0989, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1100, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1649484.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0566, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.5297e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0930, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2881, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0930, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8746
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5898e-02,  1.0054e-01,  ...,  4.1830e-02,
            1.6437e-01, -1.0000e+07],
          [-1.0000e+07, -3.7039e-02,  1.0473e-01,  ..., -3.1371e-02,
            1.3582e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3382e-02,  7.9674e-02,  ...,  2.9347e-03,
            1.4357e-01, -1.0000e+07],
          [-1.0000e+07, -1.6607e-02,  1.1113e-01,  ...,  2.2597e-03,
            1.2947e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.8440e-02,  5.7460e-02,  ..., -4.9726e-03,
            1.5747e-01, -1.0000e+07],
          [-1.0000e+07, -3.3268e-02,  6.1468e-02,  ...,  2.8033e-02,
            1.5274e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.2218e-01,  1.1603e-01,  ...,  8.8825e-02,
            1.9273e-01, -3.4327e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.9542e-01,  7.0641e-02,  ...,  8.0455e-02,
            1.5643e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.5650e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-7.2275e-02, -1.3772e-02],
         [-6.7838e-02, -1.4399e-02],
         [-8.5898e-02, -3.7039e-02],
         [-8.9532e-02, -4.7255e-02],
         [-8.5974e-02, -4.2822e-02],
         [-7.2062e-02, -6.7583e-02],
         [-8.0640e-02, -6.5509e-02],
         [-6.5701e-02, -4.2156e-02],
         [-8.3312e-02, -9.0406e-02],
         [-1.1008e-01,  1.5007e-01],
         [-7.8835e-02, -3.9232e-02],
         [-6.9704e-02,  1.4821e-01],
         [-6.2858e-02,  1.5540e-01],
         [-2.6975e-02,  1.5977e-01],
         [-8.2370e-02, -1.8133e-02],
         [-7.5605e-02, -4.4225e-02],
         [-6.9992e-02, -5.5343e-02],
         [-6.7937e-02, -7.9261e-02],
         [-6.1871e-02,  1.7182e-01],
         [-3.3808e-02,  1.7130e-01],
         [ 1.2136e-01,  1.7381e-01],
         [ 1.2152e-01,  1.7696e-01],
         [ 1.4356e-01, -1.7075e-02],
         [ 1.5243e-01, -8.4041e-04],
         [-3.7000e-02, -1.9121e-02],
         [-3.0549e-02, -2.9137e-02],
         [ 1.4052e-01, -5.1759e-02],
         [-4.9790e-02,  2.0436e-01],
         [-5.9718e-02,  2.0529e-01],
         [-6.2740e-02, -6.5109e-02],
         [-7.6109e-02, -7.2763e-02],
         [-9.2419e-02, -5.9176e-02],
         [ 1.8820e-01, -7.1048e-02],
         [-6.1418e-02, -4.3822e-02],
         [-8.0862e-02, -5.8653e-02],
         [-5.6284e-02, -8.5805e-02],
         [-5.5779e-02,  2.1765e-01],
         [-4.7365e-02, -7.9570e-02],
         [-7.4199e-02, -7.9416e-02],
         [-5.3724e-02, -7.3383e-02],
         [-5.6244e-02, -9.3775e-02],
         [-8.3508e-02, -3.1132e-02],
         [ 1.8810e-01, -5.0785e-02],
         [-5.5325e-02, -7.4617e-02],
         [-4.3668e-02, -8.1379e-02],
         [-8.4641e-02,  1.7304e-01],
         [-1.0402e-01,  1.8026e-01],
         [-1.0755e-01,  1.7130e-01],
         [-8.0901e-02,  1.5850e-01],
         [-7.4362e-02,  1.7937e-01],
         [-7.4499e-02, -1.0109e-01],
         [-8.6527e-02,  1.8218e-01],
         [-8.1704e-02, -1.1236e-01],
         [ 1.5502e-01, -1.0807e-01],
         [ 1.4591e-01,  1.8458e-01],
         [ 1.5823e-01,  1.8503e-01],
         [ 1.5813e-01, -9.2409e-02],
         [ 1.6939e-01, -1.0538e-01],
         [ 1.5668e-01, -1.4169e-01],
         [ 1.6331e-01, -9.2198e-02],
         [-9.2104e-02, -1.5793e-01],
         [-9.4523e-02,  1.7047e-01],
         [-8.9372e-02, -7.6873e-02],
         [-7.6382e-02,  1.6584e-01],
         [-7.0854e-02,  1.7015e-01],
         [-8.0802e-02, -9.2604e-02],
         [-7.9765e-02,  1.7316e-01],
         [-9.2356e-02,  1.6006e-01],
         [-8.7119e-02,  1.7442e-01],
         [-9.1228e-02,  1.7749e-01],
         [ 2.0275e-01, -1.4152e-01],
         [-7.7411e-02, -1.3967e-01],
         [-3.6900e-01,  1.7487e-01],
         [-3.6485e-01,  1.7305e-01],
         [-3.6410e-01, -1.2270e-01],
         [-3.5966e-01, -1.1343e-01],
         [-3.6271e-01, -1.2158e-01],
         [-3.6091e-01, -1.1756e-01],
         [-2.7880e-02,  2.0512e-01],
         [ 1.1731e-02,  2.1819e-01],
         [ 3.2451e-02,  2.2738e-01],
         [ 4.2652e-02,  2.2605e-01],
         [ 4.7360e-02, -9.8532e-02],
         [ 4.9350e-02, -8.6290e-02],
         [ 5.0077e-02,  2.0187e-01],
         [ 5.0260e-02,  2.1718e-01],
         [ 5.0237e-02, -8.2090e-02],
         [ 5.0194e-02, -8.3019e-02],
         [ 5.0129e-02, -1.3269e-01],
         [ 5.0073e-02, -1.4666e-01],
         [ 5.0050e-02, -1.6469e-01],
         [ 5.0032e-02, -1.8188e-01],
         [ 5.0042e-02,  2.2835e-01],
         [ 5.0034e-02,  2.4315e-01],
         [ 5.0034e-02,  2.2969e-01],
         [ 5.0024e-02, -1.9040e-01],
         [ 5.0012e-02,  2.3727e-01],
         [ 5.0007e-02,  2.5112e-01],
         [ 5.0013e-02,  2.2955e-01],
         [ 5.0005e-02, -1.8662e-01],
         [ 5.0006e-02, -1.7315e-01],
         [ 5.0008e-02, -1.5965e-01],
         [ 5.0008e-02, -1.5086e-01],
         [ 5.0008e-02, -1.7917e-01],
         [ 5.0009e-02,  2.2962e-01],
         [ 5.0008e-02, -1.6709e-01],
         [ 5.0008e-02,  7.7317e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.8559e-02, -1.1905e-02],
         [-7.3382e-02, -1.6607e-02],
         [-7.8440e-02, -3.3268e-02],
         [-7.7057e-02, -1.7950e-02],
         [-6.2874e-02, -4.4145e-02],
         [-2.6337e-02, -4.9233e-02],
         [-1.8291e-02, -3.6035e-02],
         [-1.7926e-02, -3.3940e-02],
         [-5.3006e-02, -1.7507e-02],
         [-7.1019e-02, -1.9767e-02],
         [-9.7735e-02, -3.5556e-02],
         [-8.7595e-02, -4.4422e-02],
         [-8.3290e-02, -3.9185e-02],
         [-8.1343e-02, -5.2304e-02],
         [-9.6984e-02, -7.7918e-02],
         [-9.0026e-02,  1.6154e-01],
         [-1.1139e-01, -8.7139e-02],
         [-1.1268e-01, -9.0526e-02],
         [-1.0846e-01, -8.8336e-02],
         [-1.0484e-01, -6.3328e-02],
         [-6.7096e-02, -8.7673e-02],
         [-5.2436e-02, -8.1291e-02],
         [-4.9275e-02, -1.0624e-01],
         [-7.8382e-02, -1.1774e-01],
         [-1.1374e-01, -1.1970e-01],
         [-9.3657e-02, -1.0718e-01],
         [-5.2585e-02, -1.2354e-01],
         [-6.5652e-02, -1.1601e-01],
         [-7.8815e-02, -1.2325e-01],
         [-1.0211e-01, -1.3557e-01],
         [-7.7051e-02, -1.2580e-01],
         [-8.7867e-02, -1.3228e-01],
         [-1.0167e-01, -1.2711e-01],
         [-7.5775e-02,  1.7773e-01],
         [-5.8579e-02, -1.2854e-01],
         [-8.3834e-02, -1.3671e-01],
         [-5.9741e-02,  1.9118e-01],
         [-2.4356e-02, -7.6308e-02],
         [ 6.1634e-03,  2.1339e-01],
         [-2.3146e-03, -8.0800e-02],
         [-5.4611e-02, -1.0783e-01],
         [-9.9930e-02, -7.5970e-02],
         [-1.2579e-01, -6.4081e-02],
         [-1.3730e-01, -6.0575e-02],
         [-7.5935e-02,  1.5793e-01],
         [-1.0268e-01, -6.9194e-02],
         [-1.0011e-01, -7.7837e-02],
         [-9.3815e-02, -6.6777e-02],
         [-7.5629e-02, -5.9705e-02],
         [-7.1071e-02, -5.1505e-02],
         [-7.2209e-02, -6.0972e-02],
         [-8.4775e-02, -8.4292e-02],
         [-7.9473e-02, -9.1475e-02],
         [-8.5807e-02, -2.2417e-02],
         [-8.9862e-02,  2.0640e-02],
         [-6.7975e-02,  4.0824e-02],
         [-7.1776e-02,  4.9666e-02],
         [-7.8815e-02,  5.3332e-02],
         [-9.8295e-02,  5.4708e-02],
         [ 2.0124e-01,  5.5190e-02],
         [-9.1480e-02,  5.5286e-02],
         [-8.7008e-02,  5.5262e-02],
         [-8.8245e-02,  5.5242e-02],
         [-8.6290e-02,  5.5228e-02],
         [-8.5258e-02,  5.5201e-02],
         [-8.3805e-02,  5.5180e-02],
         [-7.9520e-02,  5.5216e-02],
         [-8.0483e-02,  5.5211e-02],
         [-1.2960e-01,  5.5204e-02],
         [-1.4782e-01,  5.5218e-02],
         [-1.2640e-01,  5.5218e-02],
         [ 1.8056e-01,  5.5213e-02],
         [-1.8452e-01,  5.5222e-02],
         [-1.4745e-01,  5.5228e-02],
         [ 1.8985e-01,  5.5229e-02],
         [ 1.8016e-01,  5.5233e-02],
         [ 1.9875e-01,  5.5235e-02],
         [-1.1442e-01,  5.5235e-02],
         [-1.0635e-01,  5.5232e-02],
         [-8.4019e-02,  5.5231e-02],
         [-7.9693e-02,  5.5231e-02],
         [-6.8065e-02,  5.5231e-02],
         [-6.1724e-02,  5.5231e-02],
         [-5.5030e-02,  5.5231e-02],
         [-6.4980e-02,  5.5231e-02],
         [ 1.5272e-01,  5.5231e-02],
         [ 1.5653e-01,  5.5231e-02],
         [ 1.5855e-01,  5.5231e-02],
         [ 1.5955e-01,  5.5231e-02],
         [-7.4885e-02,  5.5231e-02],
         [-8.0765e-02,  5.5231e-02],
         [-7.6966e-02,  5.5231e-02],
         [-6.5290e-02,  5.5231e-02],
         [-8.6022e-02,  5.5231e-02],
         [ 1.9711e-01,  5.5231e-02],
         [-1.0324e-01,  5.5231e-02],
         [ 1.9538e-01,  5.5231e-02],
         [ 2.0842e-01,  5.5231e-02],
         [ 2.0651e-01,  5.5231e-02],
         [-1.0203e-01,  5.5231e-02],
         [ 1.8932e-01,  5.5231e-02],
         [ 2.0448e-01,  5.5231e-02],
         [-1.1860e-01,  5.5231e-02],
         [-1.0434e-01,  5.5231e-02],
         [-1.5376e-01,  5.5231e-02],
         [ 2.0437e-01,  5.5231e-02],
         [ 1.8387e-01,  5.5231e-02],
         [-2.0495e-01,  5.5231e-02],
         [ 2.0757e-01,  5.5231e-02],
         [ 1.8970e-01,  5.5231e-02],
         [ 2.2397e-01,  5.5231e-02],
         [ 2.0141e-01,  5.5231e-02],
         [ 2.0010e-01,  5.5231e-02],
         [ 1.9821e-01,  5.5231e-02],
         [ 2.1146e-01,  5.5231e-02],
         [ 1.8845e-01,  5.5231e-02],
         [-2.2337e-01,  5.5231e-02],
         [-1.9155e-01,  5.5231e-02],
         [-1.8719e-01,  5.5231e-02],
         [ 1.9273e-01,  5.5231e-02],
         [-1.9542e-01,  5.5231e-02],
         [ 1.5650e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-6.6961e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.0978, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4555, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4428, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0096, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1022, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1705, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-614754., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2511, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.6314e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3644, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3495, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3644, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8809
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1402e-02,  8.1983e-02,  ...,  3.9429e-02,
            1.3744e-01, -1.0000e+07],
          [-1.0000e+07, -3.2219e-02,  9.6327e-02,  ..., -1.4636e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2918e-02,  8.3033e-02,  ...,  1.5905e-03,
            1.3806e-01, -1.0000e+07],
          [-1.0000e+07, -4.3941e-02,  1.2828e-01,  ...,  1.4506e-02,
            1.4886e-01, -1.0000e+07]],

         ...,

         [[ 5.0062e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1756e-01,  6.2249e-02,  ...,  7.2620e-02,
            1.8534e-01, -1.0000e+07]],

         [[ 5.0040e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3118e-01,  7.9832e-02,  ...,  8.7176e-02,
            1.9510e-01, -1.0000e+07]],

         [[ 5.0049e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.4158e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9711e-02,  8.6010e-02,  ...,  5.5065e-03,
            1.3727e-01, -1.0000e+07],
          [-1.0000e+07, -4.5321e-02,  1.0753e-01,  ...,  3.5616e-02,
            1.4810e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.8586e-02,  7.7246e-02,  ..., -1.5416e-02,
            1.4423e-01, -1.0000e+07],
          [-1.0000e+07, -7.5122e-02,  1.5329e-01,  ...,  6.1145e-02,
            1.5160e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-9.5620e-02, -1.6811e-02],
         [-7.1402e-02, -3.2219e-02],
         [-7.2918e-02, -4.3941e-02],
         [-8.7103e-02, -4.5109e-02],
         [-1.1015e-01, -5.8668e-02],
         [-1.1875e-01, -6.8148e-02],
         [-9.7095e-02, -6.0145e-02],
         [-8.2003e-02, -5.1762e-02],
         [-8.9235e-02, -5.1922e-02],
         [-7.9704e-02, -6.2554e-02],
         [-6.5269e-02, -6.6925e-02],
         [-9.1613e-02, -6.3487e-02],
         [-1.0219e-01,  1.2250e-01],
         [-8.5358e-02,  1.3508e-01],
         [-1.0168e-01,  1.3824e-01],
         [-6.0172e-02, -7.3815e-02],
         [-2.1922e-02, -6.7031e-02],
         [-3.9386e-02, -6.8664e-02],
         [-6.4434e-02, -6.4707e-02],
         [-5.4748e-02, -2.6864e-02],
         [-7.6566e-02, -2.1727e-02],
         [ 1.7699e-01, -2.0110e-02],
         [ 2.1308e-01, -2.8294e-03],
         [ 2.2450e-01, -2.0002e-02],
         [-6.0319e-02, -3.2747e-02],
         [-8.0236e-02, -5.0096e-02],
         [-7.9405e-02, -6.6565e-02],
         [ 1.5257e-01, -9.4225e-02],
         [ 1.5416e-01, -8.7534e-02],
         [ 7.4210e-02, -1.2107e-01],
         [ 8.9907e-02, -1.3281e-01],
         [-1.1990e-01, -1.4084e-01],
         [-1.5655e-01, -1.2870e-01],
         [-1.6635e-01, -3.5237e-01],
         [ 1.6924e-01, -3.6093e-01],
         [ 1.3913e-01, -3.5861e-01],
         [ 1.6944e-01, -1.2114e-01],
         [ 1.4515e-01, -9.8612e-02],
         [-1.6164e-01, -9.0985e-02],
         [ 1.7382e-01, -8.7942e-02],
         [ 1.8228e-01, -1.0898e-01],
         [ 1.8840e-01,  1.2613e-01],
         [-3.4241e-01,  1.5074e-01],
         [-3.4363e-01,  1.2795e-01],
         [-3.4541e-01,  9.6963e-02],
         [ 1.3814e-01,  9.5225e-02],
         [ 1.3328e-01,  7.6364e-02],
         [ 1.3287e-01,  8.2771e-02],
         [-3.1256e-01,  1.1918e-01],
         [-2.8213e-01,  8.5093e-02],
         [-2.6737e-01,  1.9940e-01],
         [-2.5323e-01,  6.9637e-02],
         [-2.4693e-01,  6.7282e-02],
         [-2.7909e-01,  7.9863e-02],
         [-2.6229e-01,  8.8000e-02],
         [ 5.3851e-03,  1.0424e-01],
         [ 3.0878e-02,  9.4957e-02],
         [ 4.3042e-02,  1.0807e-01],
         [ 4.8367e-02, -1.5752e-01],
         [ 5.0411e-02,  9.3065e-02],
         [ 5.0932e-02, -1.3685e-01],
         [ 5.0872e-02, -1.4828e-01],
         [ 5.0672e-02, -1.4777e-01],
         [ 5.0470e-02, -1.3951e-01],
         [ 5.0299e-02, -1.2128e-01],
         [ 5.0180e-02, -1.0585e-01],
         [ 5.0109e-02, -9.9846e-02],
         [ 5.0062e-02, -1.1756e-01],
         [ 5.0040e-02, -1.3118e-01],
         [ 5.0049e-02,  4.4158e-03]],

        [[-5.9256e-02, -4.8886e-02],
         [-6.9711e-02, -4.5321e-02],
         [-7.8586e-02, -7.5122e-02],
         [-9.1502e-02, -9.2753e-02],
         [-1.0453e-01, -1.0553e-01],
         [-1.0577e-01, -9.7214e-02],
         [-9.2450e-02, -1.1505e-01],
         [-9.3624e-02, -1.1661e-01],
         [-7.7258e-02, -1.2545e-01],
         [-8.4031e-02, -1.2674e-01],
         [-9.1158e-02, -1.2259e-01],
         [-1.0274e-01, -1.2910e-01],
         [-9.8919e-02,  1.9941e-01],
         [-9.8481e-02, -3.4787e-01],
         [-1.2452e-01, -3.5176e-01],
         [-1.1699e-01, -3.4895e-01],
         [-1.1208e-01, -3.3385e-01],
         [-1.2205e-01, -3.2750e-01],
         [-1.0871e-01, -3.2991e-01],
         [ 1.2904e-01, -3.3771e-01],
         [ 1.3727e-01, -3.4713e-01],
         [ 1.5609e-01, -3.3385e-01],
         [ 1.6293e-01, -3.2436e-01],
         [-1.7324e-01, -2.5146e-05],
         [ 1.3153e-01,  3.0002e-02],
         [-1.9005e-01,  4.5015e-02],
         [-1.6699e-01,  5.1843e-02],
         [ 7.3870e-02,  5.4623e-02],
         [-1.5734e-01,  5.5590e-02],
         [ 1.0763e-01,  5.5764e-02],
         [-1.7039e-01,  5.5709e-02],
         [-1.4381e-01,  5.5519e-02],
         [-1.2245e-01,  5.5416e-02],
         [ 9.5371e-02,  5.5326e-02],
         [ 1.0704e-01,  5.5294e-02],
         [ 1.0364e-01,  5.5259e-02],
         [ 1.7380e-01,  5.5208e-02],
         [ 1.6464e-01,  5.5235e-02],
         [ 1.7025e-01,  5.5219e-02],
         [ 1.0514e-01,  5.5214e-02],
         [ 1.7356e-01,  5.5201e-02],
         [-9.2833e-02,  5.5219e-02],
         [ 1.0094e-01,  5.5223e-02],
         [-1.0365e-01,  5.5231e-02],
         [ 1.6995e-01,  5.5231e-02],
         [-9.7614e-02,  5.5230e-02],
         [ 9.8602e-02,  5.5231e-02],
         [ 1.0804e-01,  5.5232e-02],
         [ 1.2502e-01,  5.5236e-02],
         [ 1.3312e-01,  5.5236e-02],
         [ 1.3634e-01,  5.5232e-02],
         [ 1.2766e-01,  5.5232e-02],
         [ 1.2473e-01,  5.5231e-02],
         [ 1.0027e-01,  5.5231e-02],
         [-3.3443e-01,  5.5231e-02],
         [-3.3406e-01,  5.5231e-02],
         [-3.2836e-01,  5.5231e-02],
         [-3.1851e-01,  5.5231e-02],
         [-3.1498e-01,  5.5231e-02],
         [-3.1301e-01,  5.5231e-02],
         [-3.1364e-01,  5.5231e-02],
         [ 2.1153e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.1791e-05, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.1627, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4829, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4331, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0017, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1000, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1431, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-571428.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2245, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.1901e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2608, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3359, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2608, device='cuda:0', grad_fn=<MinBackward1>)
t_env 8873
target_mac_out tensor([[[[-1.0000e+07, -9.3745e-02,  1.1397e-01,  ...,  6.2087e-02,
            1.3778e-01, -1.0000e+07],
          [-1.0000e+07, -2.4539e-02,  9.4233e-02,  ..., -1.0851e-02,
            1.2427e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.6842e-02,  9.2673e-02,  ...,  3.9973e-02,
            1.3230e-01, -1.0000e+07],
          [-1.0000e+07, -3.3041e-02,  9.0873e-02,  ..., -3.5459e-02,
            1.3338e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2516e-02,  1.1566e-01,  ...,  2.8046e-02,
            1.5267e-01, -1.0000e+07],
          [-1.0000e+07, -6.8894e-02,  1.3834e-01,  ...,  2.9285e-02,
            1.5445e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2707e-02,  8.4580e-02,  ..., -1.5876e-03,
            1.4548e-01, -1.0000e+07],
          [-1.0000e+07, -2.6524e-02,  1.0689e-01,  ..., -3.0931e-02,
            1.3391e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.4452e-02,  1.0088e-01,  ...,  2.5699e-02,
            1.7334e-01, -1.0000e+07],
          [-1.0000e+07, -3.2522e-02,  9.8135e-02,  ..., -1.2687e-02,
            1.4405e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.3231e-01,  1.2048e-01,  ...,  9.8392e-02,
            2.1710e-01, -3.4056e-01],
          [ 5.5229e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1107e-01,  8.6853e-02,  ...,  8.4553e-02,
            1.9610e-01, -3.2675e-01],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0382e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-9.3745e-02, -2.4539e-02],
         [-6.6842e-02, -3.3041e-02],
         [-8.2516e-02, -6.8894e-02],
         [-9.5686e-02, -9.3769e-02],
         [-1.0718e-01, -9.6914e-02],
         [-1.1376e-01, -1.1048e-01],
         [-1.1256e-01, -1.1365e-01],
         [-1.0527e-01, -1.0633e-01],
         [-1.1733e-01, -1.0517e-01],
         [-1.2911e-01,  1.2120e-01],
         [-1.3069e-01,  1.6012e-01],
         [-1.2207e-01,  1.6517e-01],
         [-9.7186e-02,  1.7071e-01],
         [-6.7942e-02,  1.7337e-01],
         [-8.6843e-02,  1.7404e-01],
         [-3.2367e-02,  1.1284e-01],
         [ 1.5942e-01,  7.4869e-02],
         [ 1.7645e-01,  7.4090e-02],
         [ 1.7798e-01,  8.5483e-02],
         [-6.2847e-02,  8.8479e-02],
         [ 1.2384e-01,  8.4416e-02],
         [-6.4106e-02, -1.6297e-01],
         [-9.5745e-02, -1.2831e-01],
         [-1.1470e-01, -1.1169e-01],
         [ 8.8421e-02, -1.2744e-02],
         [ 9.2946e-02,  2.4992e-02],
         [-9.0553e-02,  4.2975e-02],
         [ 8.5469e-02,  5.0799e-02],
         [ 9.6315e-02,  5.3942e-02],
         [ 1.0306e-01,  5.5076e-02],
         [ 1.0542e-01,  5.5362e-02],
         [-1.0396e-01,  5.5377e-02],
         [-8.2232e-02,  5.5320e-02],
         [-9.7377e-02,  5.5282e-02],
         [ 9.7848e-02,  5.5221e-02],
         [ 1.0148e-01,  5.5213e-02],
         [ 1.0267e-01,  5.5203e-02],
         [-8.3365e-02,  5.5221e-02],
         [-7.4443e-02,  5.5214e-02],
         [-5.2184e-02,  5.5212e-02],
         [-5.8272e-02,  5.5217e-02],
         [-6.0766e-02,  5.5211e-02],
         [-6.1951e-02,  5.5213e-02],
         [-4.4768e-02,  5.5221e-02],
         [-6.5926e-02,  5.5227e-02],
         [-6.8066e-02,  5.5232e-02],
         [-4.7268e-02,  5.5230e-02],
         [-3.3269e-02,  5.5230e-02],
         [-3.5496e-02,  5.5231e-02],
         [-5.8198e-02,  5.5236e-02],
         [-6.3471e-02,  5.5235e-02],
         [-4.5243e-02,  5.5232e-02],
         [-5.0905e-02,  5.5232e-02],
         [-5.6414e-02,  5.5231e-02],
         [-6.0263e-02,  5.5231e-02],
         [-7.5047e-02,  5.5231e-02],
         [-5.3115e-02,  5.5231e-02],
         [-5.5205e-02,  5.5231e-02],
         [-5.8269e-02,  5.5231e-02],
         [-6.0741e-02,  5.5231e-02],
         [-7.4789e-02,  5.5231e-02],
         [ 1.0739e-01,  5.5231e-02],
         [-9.0186e-02,  5.5231e-02],
         [-9.8908e-02,  5.5231e-02],
         [-8.9071e-02,  5.5231e-02],
         [ 1.1243e-01,  5.5231e-02],
         [ 1.2210e-01,  5.5231e-02],
         [ 1.0907e-01,  5.5231e-02],
         [ 8.9137e-02,  5.5231e-02],
         [ 1.1011e-01,  5.5231e-02],
         [ 1.2501e-01,  5.5231e-02],
         [ 1.4853e-01,  5.5231e-02],
         [ 9.3539e-02,  5.5231e-02],
         [ 1.3836e-01,  5.5231e-02],
         [ 1.3899e-01,  5.5231e-02],
         [ 1.5387e-01,  5.5231e-02],
         [ 1.5918e-01,  5.5231e-02],
         [ 1.5966e-01,  5.5231e-02],
         [ 1.4760e-01,  5.5231e-02],
         [ 1.4069e-01,  5.5231e-02],
         [ 1.0353e-01,  5.5231e-02],
         [ 1.0005e-01,  5.5231e-02],
         [ 1.1581e-01,  5.5231e-02],
         [-3.1775e-01,  5.5231e-02],
         [ 1.0583e-01,  5.5231e-02],
         [-3.0909e-01,  5.5231e-02],
         [ 9.6567e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-7.8849e-02, -8.8067e-03],
         [-8.2707e-02, -2.6524e-02],
         [-9.4452e-02, -3.2522e-02],
         [-1.0440e-01,  1.3271e-01],
         [-8.6131e-02, -4.0075e-02],
         [-8.5475e-02,  1.0662e-01],
         [-9.8038e-02,  1.1760e-01],
         [-1.0169e-01,  1.1740e-01],
         [-1.1532e-01,  1.4278e-01],
         [-1.3655e-01, -2.7439e-02],
         [-1.4010e-01,  1.0427e-01],
         [-1.4174e-01,  1.4285e-01],
         [-1.1333e-01,  1.1864e-01],
         [-7.8628e-02,  1.3773e-01],
         [-9.7462e-02,  1.0675e-01],
         [-8.9808e-02,  1.3139e-01],
         [-1.0893e-01,  1.6673e-01],
         [-9.8123e-02, -9.4897e-02],
         [ 1.0648e-01, -1.0524e-01],
         [-1.3215e-01, -1.0479e-01],
         [ 1.1281e-01, -9.4547e-02],
         [-1.2100e-01, -9.3868e-02],
         [-9.9721e-02, -7.5711e-02],
         [-9.7103e-02,  1.1688e-01],
         [-8.1989e-02,  1.3077e-01],
         [-7.2402e-02, -4.1034e-02],
         [-8.1663e-02, -2.9444e-02],
         [-9.5778e-02, -4.1719e-02],
         [ 1.2510e-01,  1.4144e-01],
         [-1.0141e-01, -5.8940e-02],
         [-1.0509e-01,  1.4886e-01],
         [ 1.2327e-01,  1.5218e-01],
         [ 1.3105e-01,  1.5649e-01],
         [ 1.2915e-01, -7.8358e-02],
         [-1.3291e-01,  1.4185e-01],
         [-1.2466e-01,  1.4674e-01],
         [-1.3399e-01,  1.2084e-01],
         [-1.0561e-01,  1.0323e-01],
         [-1.1739e-01,  1.2969e-01],
         [-9.1050e-02, -8.0909e-02],
         [-1.0015e-01, -8.1734e-02],
         [-1.3205e-01, -7.4957e-02],
         [-9.9421e-02,  1.1626e-01],
         [-9.4292e-02, -7.2173e-02],
         [-8.7124e-02,  1.2115e-01],
         [-9.7273e-02,  1.0380e-01],
         [-8.4362e-02,  1.2488e-01],
         [-6.8048e-02,  1.3420e-01],
         [-6.1558e-02,  1.2971e-01],
         [-1.1030e-01, -9.5428e-02],
         [-8.2255e-02, -9.4739e-02],
         [-7.1273e-02, -7.9962e-02],
         [-6.2643e-02, -9.0318e-02],
         [-1.1027e-01, -9.1374e-02],
         [-8.9953e-02, -1.2776e-01],
         [-7.8804e-02, -1.5365e-01],
         [ 1.6839e-01, -3.7566e-01],
         [ 1.2199e-01, -3.7926e-01],
         [ 1.5958e-01, -3.8366e-01],
         [ 1.4014e-01, -3.9327e-01],
         [ 1.5639e-01, -3.8266e-01],
         [-1.4944e-01, -3.7659e-01],
         [ 1.0892e-01, -3.5195e-01],
         [ 9.4308e-02, -3.3216e-01],
         [ 1.1279e-01, -3.1848e-01],
         [ 1.3050e-01, -3.1484e-01],
         [ 1.3388e-01, -1.5466e-01],
         [-2.3089e-01, -1.5483e-01],
         [-1.8278e-01, -1.5095e-01],
         [-1.5708e-01, -1.5892e-01],
         [-1.5435e-01, -3.5579e-01],
         [-1.3191e-01, -1.5253e-01],
         [-1.1921e-01, -3.5912e-01],
         [-1.2024e-01, -3.5461e-01],
         [ 1.3268e-01, -3.3607e-01],
         [ 9.5049e-02, -3.2357e-03],
         [ 1.0982e-01,  2.9352e-02],
         [ 1.1501e-01,  4.5215e-02],
         [-1.5633e-01,  5.2154e-02],
         [ 1.0475e-01,  5.4819e-02],
         [ 8.8455e-02,  5.5629e-02],
         [ 1.0345e-01,  5.5731e-02],
         [ 1.2860e-01,  5.5633e-02],
         [ 1.2270e-01,  5.5472e-02],
         [ 8.9819e-02,  5.5380e-02],
         [ 1.1736e-01,  5.5284e-02],
         [ 1.2694e-01,  5.5247e-02],
         [ 9.7617e-02,  5.5221e-02],
         [ 9.8147e-02,  5.5219e-02],
         [ 1.1330e-01,  5.5250e-02],
         [ 1.1960e-01,  5.5221e-02],
         [ 1.3014e-01,  5.5218e-02],
         [ 1.0758e-01,  5.5210e-02],
         [ 1.1704e-01,  5.5211e-02],
         [ 1.2096e-01,  5.5223e-02],
         [ 1.2048e-01,  5.5229e-02],
         [ 8.6853e-02,  5.5232e-02],
         [-1.0382e-04,  5.5230e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.6634e-05, device='cuda:0') tensor(0.0014, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.1516, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4584, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4632, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0028, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1031, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1535, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-561224.4375, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1780, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.5311e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0007, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2303, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3246, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2303, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9020
target_mac_out tensor([[[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.3231e-02,  8.0496e-02,  ...,  2.7923e-02,
            1.3305e-01, -1.0000e+07],
          [-1.0000e+07, -7.1417e-02,  1.2004e-01,  ...,  2.4416e-02,
            1.4860e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9630e-02,  1.0726e-01,  ...,  2.2145e-02,
            1.4804e-01, -1.0000e+07],
          [-1.0000e+07, -9.3495e-02,  1.4606e-01,  ...,  5.7287e-02,
            1.6459e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1316e-01,  1.1405e-01,  ...,  4.5165e-02,
            1.3762e-01, -1.0000e+07],
          [-1.0000e+07, -5.2137e-02,  1.0687e-01,  ...,  4.0303e-02,
            1.4691e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3535e-01,  1.0750e-01,  ...,  1.7220e-02,
            1.5392e-01, -1.0000e+07],
          [-1.0000e+07, -9.3427e-02,  1.5680e-01,  ...,  7.1136e-02,
            1.4742e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7497e-01,  8.7737e-02,  ...,  5.8484e-02,
            1.4736e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.0489e-01,  1.0439e-01,  ...,  7.7469e-02,
            1.6904e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-8.7360e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-7.5802e-02, -5.1416e-02],
         [-6.3231e-02, -7.1417e-02],
         [-8.9630e-02, -9.3495e-02],
         [-8.4679e-02, -9.5708e-02],
         [-7.6498e-02, -1.1342e-01],
         [-9.7749e-02, -1.2130e-01],
         [-8.7907e-02, -1.3181e-01],
         [ 1.2148e-01, -1.3277e-01],
         [-1.1079e-01, -1.3793e-01],
         [-1.1133e-01, -3.2579e-01],
         [-1.1178e-01, -3.2440e-01],
         [-1.2312e-01, -1.4515e-01],
         [ 1.0866e-01, -1.3654e-01],
         [-1.4010e-01, -3.2867e-01],
         [ 1.0546e-01, -3.1762e-01],
         [ 1.1844e-01, -3.1069e-01],
         [ 1.2047e-01, -3.0959e-01],
         [ 1.3820e-01, -1.1299e-01],
         [-9.1566e-02, -9.3883e-02],
         [-1.0352e-01, -9.0428e-02],
         [ 1.4377e-01, -6.1941e-02],
         [-9.9327e-02, -3.3899e-03],
         [-1.0456e-01,  3.2344e-02],
         [-8.9938e-02,  4.7872e-02],
         [-1.0490e-01,  5.3895e-02],
         [-1.3139e-01,  5.5818e-02],
         [-1.1534e-01,  5.6140e-02],
         [ 1.0207e-01,  5.5988e-02],
         [ 1.2134e-01,  5.5728e-02],
         [-7.9622e-02,  5.5511e-02],
         [-9.6249e-02,  5.5376e-02],
         [ 1.0415e-01,  5.5264e-02],
         [ 7.8302e-02,  5.5241e-02],
         [ 1.1127e-01,  5.5227e-02],
         [ 1.5893e-01,  5.5225e-02],
         [-5.2042e-02,  5.5210e-02],
         [ 1.9383e-01,  5.5204e-02],
         [ 2.0543e-01,  5.5207e-02],
         [ 2.1276e-01,  5.5214e-02],
         [-1.0647e-01,  5.5221e-02],
         [ 1.6496e-01,  5.5218e-02],
         [ 1.4782e-01,  5.5221e-02],
         [-1.5593e-01,  5.5232e-02],
         [-1.6115e-01,  5.5230e-02],
         [ 1.4059e-01,  5.5230e-02],
         [ 1.3764e-01,  5.5234e-02],
         [ 1.4770e-01,  5.5235e-02],
         [ 1.4024e-01,  5.5235e-02],
         [-3.0587e-01,  5.5232e-02],
         [ 1.0963e-01,  5.5232e-02],
         [-3.1223e-01,  5.5231e-02],
         [-2.9092e-01,  5.5231e-02],
         [-2.6541e-01,  5.5231e-02],
         [ 1.2361e-01,  5.5231e-02],
         [ 1.1766e-01,  5.5231e-02],
         [-2.7119e-01,  5.5231e-02],
         [-6.0612e-04,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-1.0152e-01, -5.4216e-02],
         [-1.1316e-01, -5.2137e-02],
         [-1.3535e-01, -9.3427e-02],
         [-1.4099e-01, -8.3678e-02],
         [-1.4718e-01, -7.2622e-02],
         [-1.2797e-01, -7.2874e-02],
         [-1.0056e-01, -7.2417e-02],
         [-9.8191e-02, -5.3408e-02],
         [-9.2720e-02, -2.6218e-02],
         [-7.2355e-02, -3.3392e-02],
         [-4.2763e-02, -4.8211e-02],
         [-5.8415e-02,  1.5174e-01],
         [-7.2070e-02, -4.6418e-02],
         [-9.4477e-02, -5.7077e-02],
         [-1.0281e-01, -6.5050e-02],
         [-1.0601e-01, -5.6444e-02],
         [-7.3171e-02, -5.6426e-02],
         [-9.1293e-02, -4.6515e-02],
         [-1.1442e-01, -4.0512e-02],
         [-1.2960e-01, -2.2922e-02],
         [-1.2273e-01, -4.7564e-02],
         [-1.3013e-01, -4.1200e-02],
         [-1.0923e-01, -5.1113e-02],
         [-1.2253e-01, -3.8508e-02],
         [-1.0753e-01, -3.3591e-02],
         [-7.7339e-02, -2.7300e-02],
         [-5.3641e-02, -2.4812e-02],
         [-5.3764e-02, -5.9159e-03],
         [-6.4859e-02, -3.0387e-02],
         [-5.4220e-02, -4.6695e-02],
         [-7.7418e-02, -5.1543e-02],
         [-7.8937e-02, -4.6688e-02],
         [-8.9414e-02, -5.4071e-02],
         [-8.2515e-02, -5.3326e-02],
         [-6.8149e-02, -4.3880e-02],
         [-6.9199e-02, -5.3849e-02],
         [-8.7839e-02, -4.0259e-02],
         [-7.7394e-02, -5.7224e-02],
         [-7.2429e-02, -4.5732e-02],
         [-7.2239e-02, -3.5275e-02],
         [-9.7754e-02, -5.0106e-02],
         [-1.0727e-01, -7.5594e-02],
         [-1.0129e-01, -6.2270e-02],
         [-9.8928e-02, -6.4270e-02],
         [-9.5342e-02, -8.3660e-02],
         [-7.9985e-02, -9.4776e-02],
         [-1.0160e-01, -9.5990e-02],
         [-1.0427e-01, -1.2161e-01],
         [-1.2150e-01, -1.2884e-01],
         [ 1.1687e-01, -1.3236e-01],
         [-1.2676e-01, -1.3582e-01],
         [-1.1682e-01, -1.4267e-01],
         [-1.1345e-01, -1.2891e-01],
         [-1.1636e-01, -1.2859e-01],
         [-1.1899e-01, -1.0875e-01],
         [-1.2139e-01, -1.0513e-01],
         [ 1.2493e-01,  1.3311e-01],
         [-1.2946e-01, -1.0064e-01],
         [-1.1718e-01, -1.0032e-01],
         [-9.9608e-02, -9.7681e-02],
         [-7.6183e-02, -9.0599e-02],
         [-7.8447e-02, -8.4003e-02],
         [-8.1427e-02, -1.1496e-01],
         [-7.8339e-02, -1.3661e-01],
         [-8.8979e-02, -1.4368e-01],
         [ 1.2843e-01, -1.4902e-01],
         [ 1.2783e-01, -1.3448e-01],
         [ 1.3372e-01, -1.4554e-01],
         [-1.4029e-01, -3.3702e-01],
         [-1.0517e-01, -3.2840e-01],
         [-1.2550e-01, -3.1632e-01],
         [-1.1554e-01, -1.1479e-01],
         [ 1.1866e-01,  2.1005e-02],
         [ 9.2700e-02,  4.1413e-02],
         [ 1.1245e-01,  5.0752e-02],
         [ 9.9266e-02,  5.4425e-02],
         [-1.6537e-01,  5.5606e-02],
         [ 8.9015e-02,  5.5785e-02],
         [ 9.0283e-02,  5.5652e-02],
         [ 8.1918e-02,  5.5501e-02],
         [ 1.0532e-01,  5.5357e-02],
         [ 1.1507e-01,  5.5283e-02],
         [-1.6393e-01,  5.5240e-02],
         [ 9.6077e-02,  5.5211e-02],
         [ 1.0314e-01,  5.5201e-02],
         [ 1.0504e-01,  5.5186e-02],
         [ 1.0541e-01,  5.5224e-02],
         [ 1.2062e-01,  5.5188e-02],
         [ 1.2864e-01,  5.5218e-02],
         [ 8.9784e-02,  5.5211e-02],
         [ 1.1386e-01,  5.5213e-02],
         [ 9.8002e-02,  5.5221e-02],
         [ 1.1383e-01,  5.5229e-02],
         [ 9.5636e-02,  5.5232e-02],
         [ 1.0852e-01,  5.5230e-02],
         [ 1.2335e-01,  5.5231e-02],
         [ 1.2061e-01,  5.5231e-02],
         [ 1.0021e-01,  5.5236e-02],
         [ 1.0882e-01,  5.5235e-02],
         [ 9.1663e-02,  5.5232e-02],
         [ 1.2479e-01,  5.5232e-02],
         [-1.9702e-01,  5.5231e-02],
         [-1.7074e-01,  5.5231e-02],
         [-1.7497e-01,  5.5231e-02],
         [ 1.0439e-01,  5.5231e-02],
         [-8.7360e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-8.8778e-06, device='cuda:0') tensor(0.0008, device='cuda:0') tensor(-0.0015, device='cuda:0')
mixer_td_error tensor(0.5671, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4567, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5091, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0092, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1035, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1566, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2311320.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2128, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.9793e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2013, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3416, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2013, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9073
target_mac_out tensor([[[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.5027e-02,  7.1936e-02,  ..., -3.0500e-03,
            1.2911e-01, -1.0000e+07],
          [-1.0000e+07, -2.2961e-02,  9.6708e-02,  ..., -2.0494e-02,
            1.3243e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.1139e-02,  8.5369e-02,  ...,  1.4716e-02,
            1.3164e-01, -1.0000e+07],
          [-1.0000e+07, -3.0575e-02,  9.4245e-02,  ..., -4.3856e-02,
            1.3745e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6925e-02,  8.6937e-02,  ..., -1.6604e-03,
            1.4376e-01, -1.0000e+07],
          [-1.0000e+07, -1.7353e-02,  1.0934e-01,  ..., -1.8735e-02,
            1.3111e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.4390e-02,  7.5624e-02,  ..., -1.8883e-02,
            1.5165e-01, -1.0000e+07],
          [-1.0000e+07, -2.5647e-02,  9.8485e-02,  ..., -9.5951e-03,
            1.4446e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3207e-01,  2.9529e-02,  ...,  2.3329e-02,
            1.9205e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6563e-01,  6.0914e-02,  ...,  6.0275e-02,
            2.1014e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-2.5434e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.2377e-02, -1.1096e-02],
         [-5.5027e-02, -2.2961e-02],
         [-4.1139e-02, -3.0575e-02],
         [-3.2662e-02, -4.3250e-02],
         [-4.2330e-02, -3.3436e-02],
         [-2.3718e-02, -4.0629e-02],
         [-5.8590e-02, -4.0934e-02],
         [-8.4974e-02, -2.9617e-02],
         [-5.9925e-02,  1.3858e-01],
         [ 1.5041e-01, -2.3082e-02],
         [ 1.6852e-01, -1.5386e-02],
         [-2.0264e-02, -8.4988e-03],
         [ 1.6914e-01, -3.7857e-02],
         [-6.2545e-03, -4.0398e-02],
         [ 1.5086e-02, -4.7884e-02],
         [-1.8821e-02, -3.0138e-02],
         [-6.0220e-02, -1.4213e-02],
         [-4.9873e-02, -1.2104e-02],
         [-3.0518e-02, -2.5654e-02],
         [-3.3560e-02, -1.8829e-02],
         [-3.7333e-02, -3.2817e-03],
         [-6.9114e-02, -6.3185e-03],
         [-7.3922e-02, -3.1255e-02],
         [-8.7049e-02,  1.0793e-01],
         [ 1.0936e-01, -1.1027e-02],
         [-1.9287e-02, -1.1783e-02],
         [ 1.5426e-01, -3.9562e-02],
         [ 1.7741e-01, -3.0440e-02],
         [ 1.7950e-01,  7.9972e-02],
         [ 1.7848e-01,  9.5407e-02],
         [-2.2659e-02, -5.7749e-02],
         [ 1.6343e-01, -4.7370e-02],
         [ 1.8144e-01, -2.5316e-02],
         [-7.4753e-02,  9.2127e-02],
         [-7.1515e-02,  1.3353e-01],
         [-9.6875e-02,  1.4873e-01],
         [-8.2046e-02, -3.6629e-02],
         [-1.0228e-01,  1.3962e-01],
         [-8.1084e-02,  1.5129e-01],
         [-8.3552e-02, -4.4975e-02],
         [ 1.3091e-01, -3.3770e-02],
         [ 1.2777e-01,  1.0402e-01],
         [ 1.5403e-01,  9.7388e-02],
         [ 1.6515e-01,  9.9281e-02],
         [-3.1608e-02,  1.1371e-01],
         [-5.0022e-02, -4.4041e-02],
         [-7.5821e-02, -3.3466e-02],
         [-9.8260e-02, -4.6174e-02],
         [-6.9414e-02,  1.3620e-01],
         [ 1.4989e-01, -6.0776e-02],
         [ 1.6592e-01,  9.8872e-02],
         [-7.7386e-02,  1.4419e-01],
         [-5.8726e-02,  1.6298e-01],
         [ 1.5526e-01,  1.6761e-01],
         [ 1.6354e-01, -1.1073e-01],
         [-1.1235e-01,  1.6277e-01],
         [-1.5573e-01,  1.8230e-01],
         [ 1.2651e-01,  1.8624e-01],
         [ 1.4976e-01,  1.8383e-01],
         [-1.0310e-01, -3.2435e-01],
         [ 1.5719e-01, -3.3314e-01],
         [-4.3478e-02, -3.3879e-01],
         [-6.5489e-02,  7.1618e-02],
         [ 1.2064e-01,  4.6336e-02],
         [-1.2185e-01,  5.9508e-02],
         [ 1.3051e-01,  1.1030e-01],
         [ 1.0501e-01, -1.4338e-01],
         [ 1.1574e-01, -1.2058e-01],
         [ 1.2416e-01, -1.0954e-01],
         [ 1.4123e-01, -2.9840e-01],
         [-1.6648e-01, -3.1217e-01],
         [ 1.2277e-01, -3.1040e-01],
         [ 1.3046e-01,  4.7317e-03],
         [ 1.2593e-01,  3.5153e-02],
         [ 1.3922e-01,  4.7874e-02],
         [ 1.8498e-01,  5.2807e-02],
         [-6.9397e-02,  5.4573e-02],
         [ 1.3009e-01,  5.5107e-02],
         [ 1.2383e-01,  5.5214e-02],
         [ 1.3862e-01,  5.5201e-02],
         [ 1.3305e-01,  5.5187e-02],
         [ 1.4448e-01,  5.5161e-02],
         [ 1.0565e-01,  5.5155e-02],
         [ 1.2594e-01,  5.5158e-02],
         [ 1.3153e-01,  5.5200e-02],
         [ 1.4550e-01,  5.5186e-02],
         [ 1.2056e-01,  5.5187e-02],
         [ 1.2911e-01,  5.5204e-02],
         [ 1.3020e-01,  5.5219e-02],
         [ 1.0828e-01,  5.5208e-02],
         [ 1.1543e-01,  5.5215e-02],
         [ 8.3100e-02,  5.5218e-02],
         [ 1.0123e-01,  5.5227e-02],
         [ 1.0586e-01,  5.5231e-02],
         [ 7.2695e-02,  5.5230e-02],
         [ 2.6262e-03,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-6.8669e-02, -2.0465e-02],
         [-7.6925e-02, -1.7353e-02],
         [-8.4390e-02, -2.5647e-02],
         [-9.9761e-02,  1.3864e-01],
         [-8.6230e-02,  1.5428e-01],
         [-1.0641e-01, -4.7889e-02],
         [-1.2032e-01,  1.5151e-01],
         [ 1.1142e-01,  1.1972e-01],
         [ 1.4533e-01, -7.5543e-02],
         [ 1.6836e-01,  8.7324e-02],
         [-2.2087e-02,  9.5613e-02],
         [ 1.7014e-01, -7.3037e-02],
         [ 1.8658e-01, -5.7724e-02],
         [ 1.8505e-01, -5.4661e-02],
         [-1.7039e-02,  7.4679e-02],
         [ 1.6641e-01, -5.7910e-02],
         [ 1.7401e-01, -5.5035e-02],
         [ 1.7605e-01,  7.6683e-02],
         [-8.0121e-02,  1.0667e-01],
         [ 1.2180e-01,  1.0267e-01],
         [ 1.5040e-01,  7.3858e-02],
         [ 1.7125e-01,  4.4771e-02],
         [-7.4066e-02,  7.5779e-02],
         [ 1.2696e-01,  9.0483e-02],
         [ 1.2235e-01,  9.6227e-02],
         [ 1.3168e-01,  5.9400e-02],
         [ 1.6329e-01, -6.3472e-02],
         [ 1.9292e-01, -4.1926e-02],
         [ 2.0441e-01, -2.3997e-02],
         [ 1.0361e-01, -5.7803e-03],
         [ 1.6756e-01,  1.3210e-03],
         [-1.5351e-01,  7.1890e-02],
         [ 1.3740e-01, -1.5006e-02],
         [ 7.6314e-02,  7.3571e-02],
         [ 1.5180e-01, -8.5264e-03],
         [ 1.3743e-01, -3.9514e-02],
         [ 1.3990e-01,  9.0447e-02],
         [ 9.9613e-02,  9.6142e-02],
         [ 8.3859e-02, -6.0417e-02],
         [ 1.0745e-01, -5.0715e-02],
         [ 1.1943e-01,  8.0846e-02],
         [ 1.1839e-01,  5.2344e-02],
         [ 1.2015e-01,  3.8897e-02],
         [ 2.2459e-03, -5.1447e-02],
         [ 2.5260e-02,  7.2656e-02],
         [ 3.8489e-02,  9.1561e-02],
         [ 4.5278e-02,  9.7992e-02],
         [ 4.8398e-02,  1.2115e-01],
         [ 4.9725e-02,  1.1990e-01],
         [ 5.0172e-02,  9.6464e-02],
         [ 5.0244e-02,  1.0885e-01],
         [ 5.0222e-02,  6.5088e-02],
         [ 5.0161e-02,  9.0493e-02],
         [ 5.0109e-02,  7.1971e-02],
         [ 5.0066e-02,  8.4856e-02],
         [ 5.0032e-02,  7.0057e-02],
         [ 5.0034e-02,  4.5524e-02],
         [ 5.0022e-02,  3.8366e-02],
         [ 5.0023e-02, -8.5124e-02],
         [ 5.0024e-02,  7.2051e-02],
         [ 5.0013e-02,  5.1837e-02],
         [ 5.0016e-02,  7.9613e-02],
         [ 5.0017e-02,  4.7507e-02],
         [ 5.0017e-02,  4.2915e-02],
         [ 5.0004e-02,  5.3759e-02],
         [ 5.0006e-02,  4.1850e-02],
         [ 5.0008e-02,  7.3218e-02],
         [ 5.0008e-02,  8.5276e-02],
         [ 5.0008e-02,  9.0303e-02],
         [ 5.0009e-02,  9.4667e-02],
         [ 5.0008e-02,  9.9575e-02],
         [ 5.0008e-02,  1.1964e-01],
         [ 5.0008e-02,  8.5813e-02],
         [ 5.0008e-02, -1.0637e-01],
         [ 5.0008e-02,  7.0720e-02],
         [ 5.0009e-02,  6.8122e-02],
         [ 5.0009e-02,  6.6373e-02],
         [ 5.0009e-02,  1.0093e-01],
         [ 5.0009e-02,  1.0806e-01],
         [ 5.0009e-02,  7.3677e-02],
         [ 5.0009e-02,  5.8296e-02],
         [ 5.0009e-02,  8.1359e-02],
         [ 5.0009e-02,  8.6712e-02],
         [ 5.0009e-02,  6.4313e-02],
         [ 5.0009e-02,  5.4413e-02],
         [ 5.0009e-02,  5.2003e-02],
         [ 5.0009e-02,  6.7435e-02],
         [ 5.0009e-02,  7.5357e-02],
         [ 5.0009e-02,  3.4582e-02],
         [ 5.0009e-02,  6.4295e-02],
         [ 5.0009e-02,  7.2990e-02],
         [ 5.0009e-02,  5.8773e-02],
         [ 5.0009e-02, -1.7133e-01],
         [ 5.0009e-02, -1.4727e-01],
         [ 5.0009e-02,  4.7772e-02],
         [ 5.0009e-02, -1.4610e-01],
         [ 5.0009e-02, -1.4174e-01],
         [ 5.0009e-02, -1.2020e-01],
         [ 5.0009e-02,  5.0972e-02],
         [ 5.0009e-02,  3.2605e-02],
         [ 5.0009e-02,  2.8422e-02],
         [ 5.0009e-02,  6.0664e-02],
         [ 5.0009e-02, -1.2632e-01],
         [ 5.0009e-02, -1.3207e-01],
         [ 5.0009e-02,  6.0914e-02],
         [ 5.0009e-02, -2.5434e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-7.2161e-05, device='cuda:0') tensor(0.0008, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.0543, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4563, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5375, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0063, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1019, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1218, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-471698.0312, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2044, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.6794e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2531, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2554, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2531, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9130
target_mac_out tensor([[[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1316e-01,  1.1405e-01,  ...,  4.5165e-02,
            1.3762e-01, -1.0000e+07],
          [-1.0000e+07, -5.2137e-02,  1.0687e-01,  ...,  4.0303e-02,
            1.4691e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3535e-01,  1.0750e-01,  ...,  1.7220e-02,
            1.5392e-01, -1.0000e+07],
          [-1.0000e+07, -9.3427e-02,  1.5680e-01,  ...,  7.1136e-02,
            1.4742e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7497e-01,  8.7737e-02,  ...,  5.8484e-02,
            1.4736e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.0489e-01,  1.0439e-01,  ...,  7.7469e-02,
            1.6904e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-8.7360e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2697e-02,  8.6043e-02,  ...,  3.6569e-04,
            1.4043e-01, -1.0000e+07],
          [-1.0000e+07, -3.0029e-02,  9.6760e-02,  ..., -1.6551e-02,
            1.3110e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4736e-02,  1.0545e-01,  ..., -4.9368e-04,
            1.6235e-01, -1.0000e+07],
          [-1.0000e+07, -4.2605e-02,  9.2510e-02,  ..., -3.6784e-02,
            1.3493e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.2561e-02,  1.4136e-01],
         [-1.1316e-01,  1.0687e-01],
         [-1.3535e-01,  1.5680e-01],
         [-1.4099e-01,  1.1287e-01],
         [-1.4718e-01,  1.0235e-01],
         [-1.2797e-01,  1.0276e-01],
         [-1.0056e-01,  9.5403e-02],
         [-9.8191e-02,  9.8256e-02],
         [-9.2720e-02,  1.0912e-01],
         [-7.2355e-02,  1.2852e-01],
         [-4.2763e-02,  1.4457e-01],
         [ 1.5972e-01,  1.5174e-01],
         [ 1.7168e-01,  1.2656e-01],
         [ 1.2822e-01,  1.4573e-01],
         [ 1.1219e-01,  1.4921e-01],
         [ 9.1059e-02,  1.1279e-01],
         [ 1.3050e-01,  1.0559e-01],
         [ 1.0893e-01,  1.1180e-01],
         [ 1.0651e-01,  1.0079e-01],
         [ 1.1001e-01,  1.1031e-01],
         [ 1.0097e-01,  1.3151e-01],
         [ 1.0438e-01,  1.1283e-01],
         [-1.0923e-01,  1.3779e-01],
         [ 9.6939e-02,  1.1717e-01],
         [ 1.0960e-01,  9.9436e-02],
         [-7.7339e-02, -2.7300e-02],
         [ 1.2071e-01,  1.1294e-01],
         [-5.3764e-02, -5.9159e-03],
         [ 1.2235e-01,  1.2246e-01],
         [ 1.2825e-01,  1.2933e-01],
         [ 1.3540e-01,  1.3417e-01],
         [ 1.2550e-01,  1.1616e-01],
         [ 1.3151e-01,  8.8897e-02],
         [ 1.1660e-01,  1.1416e-01],
         [ 1.0615e-01, -4.3880e-02],
         [ 1.1131e-01,  1.2584e-01],
         [ 1.3091e-01, -4.0259e-02],
         [ 8.0762e-02, -5.7224e-02],
         [ 1.0281e-01, -4.5732e-02],
         [-7.2239e-02, -3.5275e-02],
         [ 1.2118e-01, -5.0106e-02],
         [ 1.2719e-01,  1.0718e-01],
         [ 1.1393e-01, -6.2270e-02],
         [ 9.4687e-02,  1.1824e-01],
         [ 8.6466e-02,  1.1831e-01],
         [-7.9985e-02,  1.1063e-01],
         [ 9.7655e-02, -9.5990e-02],
         [ 9.8608e-02,  1.3535e-01],
         [ 1.1027e-01,  1.4325e-01],
         [ 1.1687e-01,  1.4936e-01],
         [ 8.8444e-02,  1.2981e-01],
         [ 9.5480e-02,  1.4036e-01],
         [ 7.8910e-02, -1.2891e-01],
         [ 1.0198e-01, -1.2859e-01],
         [ 1.1338e-01, -1.0875e-01],
         [ 1.1903e-01,  1.1782e-01],
         [ 1.2493e-01,  1.3311e-01],
         [ 1.2457e-01,  1.3930e-01],
         [ 1.1092e-01,  1.3686e-01],
         [-9.9608e-02,  1.1550e-01],
         [-7.6183e-02,  1.0355e-01],
         [ 1.0951e-01,  1.1759e-01],
         [ 9.5126e-02,  1.4113e-01],
         [ 1.0214e-01, -1.3661e-01],
         [ 1.2009e-01, -1.4368e-01],
         [ 1.2843e-01, -1.4902e-01],
         [ 1.2783e-01, -1.3448e-01],
         [ 1.3372e-01, -1.4554e-01],
         [ 1.1717e-01, -3.3702e-01],
         [-1.0517e-01,  9.7992e-02],
         [ 1.1056e-01, -3.1632e-01],
         [ 1.0994e-01, -1.1479e-01],
         [ 1.1866e-01,  2.1005e-02],
         [ 9.2700e-02,  4.1413e-02],
         [ 1.1245e-01,  5.0752e-02],
         [ 9.9266e-02,  5.4425e-02],
         [ 7.0981e-02,  5.5606e-02],
         [ 8.9015e-02,  5.5785e-02],
         [ 9.0283e-02,  5.5652e-02],
         [ 8.1918e-02,  5.5501e-02],
         [ 1.0532e-01,  5.5357e-02],
         [ 1.1507e-01,  5.5283e-02],
         [ 7.3645e-02,  5.5240e-02],
         [ 9.6077e-02,  5.5211e-02],
         [ 1.0314e-01,  5.5201e-02],
         [ 1.0504e-01,  5.5186e-02],
         [ 1.0541e-01,  5.5224e-02],
         [ 1.2062e-01,  5.5188e-02],
         [ 1.2864e-01,  5.5218e-02],
         [ 8.9784e-02,  5.5211e-02],
         [ 1.1386e-01,  5.5213e-02],
         [ 9.8002e-02,  5.5221e-02],
         [ 1.1383e-01,  5.5229e-02],
         [ 9.5636e-02,  5.5232e-02],
         [ 1.0852e-01,  5.5230e-02],
         [ 1.2335e-01,  5.5231e-02],
         [ 1.2061e-01,  5.5231e-02],
         [ 1.0021e-01,  5.5236e-02],
         [ 1.0882e-01,  5.5235e-02],
         [ 9.1663e-02,  5.5232e-02],
         [ 1.2479e-01,  5.5232e-02],
         [ 7.6210e-02,  5.5231e-02],
         [ 5.6913e-02,  5.5231e-02],
         [ 8.7737e-02,  5.5231e-02],
         [ 1.0439e-01,  5.5231e-02],
         [-8.7360e-03,  5.5231e-02]],

        [[-5.8559e-02, -1.1905e-02],
         [-6.2697e-02,  9.6760e-02],
         [-7.4736e-02,  9.2510e-02],
         [ 1.1684e-01,  1.1852e-01],
         [-6.9401e-02, -4.2403e-02],
         [-7.1409e-02,  1.3997e-01],
         [-6.1283e-02, -8.1859e-02],
         [ 1.0087e-01, -1.1118e-01],
         [ 6.5937e-02,  9.4678e-02],
         [ 9.9763e-02,  4.1951e-02],
         [ 9.6511e-02,  2.8135e-02],
         [ 9.7529e-02,  6.9178e-02],
         [ 1.1645e-01,  8.7885e-02],
         [ 1.2056e-01,  6.8681e-02],
         [ 1.5746e-01,  1.0094e-01],
         [ 1.7028e-01,  1.0275e-01],
         [ 1.8137e-01,  1.2239e-01],
         [ 1.8975e-01,  1.1724e-01],
         [ 1.2731e-01,  1.2663e-01],
         [ 1.3004e-01,  1.1875e-01],
         [ 1.1769e-01,  8.1665e-02],
         [ 1.5515e-01,  9.9348e-02],
         [ 1.0939e-01,  7.6186e-02],
         [ 1.0205e-01, -1.4736e-01],
         [ 9.8908e-02, -1.1912e-01],
         [ 7.4470e-02, -1.0494e-01],
         [ 9.3168e-02, -1.0517e-01],
         [ 8.7312e-02, -9.5965e-02],
         [ 1.1217e-01, -1.0010e-01],
         [ 1.2174e-01, -9.1623e-02],
         [ 9.7153e-02, -8.8893e-02],
         [ 9.9713e-02,  1.5014e-02],
         [-5.2899e-02,  3.8661e-02],
         [ 8.7468e-02,  5.0011e-02],
         [ 1.1025e-01,  5.4585e-02],
         [-1.7715e-02,  5.6052e-02],
         [ 1.0898e-01,  5.6262e-02],
         [ 1.4634e-01,  5.6071e-02],
         [ 1.0157e-01,  5.5783e-02],
         [ 9.7480e-02,  5.5577e-02],
         [ 8.4765e-02,  5.5432e-02],
         [-6.2284e-02,  5.5317e-02],
         [ 5.4192e-02,  5.5260e-02],
         [ 8.6271e-02,  5.5217e-02],
         [ 8.1628e-02,  5.5217e-02],
         [ 9.2938e-02,  5.5210e-02],
         [ 9.9936e-02,  5.5211e-02],
         [ 1.0516e-01,  5.5226e-02],
         [ 1.0705e-01,  5.5208e-02],
         [ 1.0676e-01,  5.5218e-02],
         [ 1.2654e-01,  5.5221e-02],
         [ 1.3537e-01,  5.5223e-02],
         [ 9.2763e-02,  5.5232e-02],
         [ 1.1663e-01,  5.5230e-02],
         [ 7.9174e-02,  5.5230e-02],
         [ 1.2274e-01,  5.5231e-02],
         [ 9.6635e-02,  5.5236e-02],
         [ 1.0700e-01,  5.5235e-02],
         [ 1.0815e-01,  5.5232e-02],
         [ 1.2503e-01,  5.5232e-02],
         [ 1.2374e-01,  5.5231e-02],
         [ 1.3389e-01,  5.5231e-02],
         [ 1.5225e-01,  5.5231e-02],
         [ 1.5867e-01,  5.5231e-02],
         [ 1.6042e-01,  5.5231e-02],
         [ 1.1433e-01,  5.5231e-02],
         [ 9.6289e-02,  5.5231e-02],
         [ 1.3500e-01,  5.5231e-02],
         [ 1.3141e-01,  5.5231e-02],
         [ 1.3824e-01,  5.5231e-02],
         [ 1.3149e-01,  5.5231e-02],
         [ 1.0908e-01,  5.5231e-02],
         [ 7.1149e-02,  5.5231e-02],
         [-2.6948e-01,  5.5231e-02],
         [-2.5364e-01,  5.5231e-02],
         [-2.4145e-01,  5.5231e-02],
         [ 1.8764e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.7033e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.3255, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.6159, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4950, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0153, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1073, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1172, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1367924.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1897, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.5489e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1955, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2863, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1955, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9177
target_mac_out tensor([[[[-1.0000e+07, -7.3919e-02,  9.6747e-02,  ...,  2.7699e-02,
            1.4092e-01, -1.0000e+07],
          [-1.0000e+07, -2.4705e-02,  1.2426e-01,  ...,  1.4439e-02,
            1.3627e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0597e-02,  9.7682e-02,  ...,  1.7515e-02,
            1.4517e-01, -1.0000e+07],
          [-1.0000e+07, -2.5978e-02,  1.2275e-01,  ..., -3.2520e-03,
            1.3768e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.9450e-02,  9.6473e-02,  ...,  6.2977e-03,
            1.5033e-01, -1.0000e+07],
          [-1.0000e+07, -3.6634e-02,  9.5858e-02,  ...,  1.1550e-03,
            1.4854e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.3996e-02,  8.6686e-02,  ...,  2.0696e-02,
            1.2691e-01, -1.0000e+07],
          [-1.0000e+07, -1.5667e-02,  8.3441e-02,  ...,  2.3244e-02,
            1.3188e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.3490e-02,  7.7649e-02,  ..., -1.5480e-02,
            1.3988e-01, -1.0000e+07],
          [-1.0000e+07, -1.2273e-02,  9.9245e-02,  ...,  2.9906e-02,
            1.3396e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.7225e-02,  9.3853e-02,  ..., -6.7708e-03,
            1.6523e-01, -1.0000e+07],
          [-1.0000e+07, -1.8636e-03,  1.1336e-01,  ...,  1.1373e-02,
            1.1794e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -5.6026e-02,  1.2154e-01,  ...,  3.8353e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -5.9207e-02,  1.4030e-01,  ...,  5.3465e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.1527e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6747e-02,  1.2426e-01],
         [ 9.7682e-02,  1.2275e-01],
         [ 9.6473e-02,  9.5858e-02],
         [ 1.0983e-01,  9.1722e-02],
         [ 1.2105e-01,  8.1311e-02],
         [ 1.3035e-01,  1.1239e-01],
         [ 1.4684e-01,  1.1927e-01],
         [ 1.4700e-01,  1.2489e-01],
         [ 5.3364e-02,  1.2725e-01],
         [ 1.5207e-01,  9.0737e-02],
         [ 1.6636e-01,  6.9216e-02],
         [ 1.3934e-01,  5.2832e-02],
         [ 1.5973e-01,  7.2915e-02],
         [ 1.6478e-01,  1.1419e-01],
         [ 1.4438e-01,  1.0889e-01],
         [ 1.1372e-01,  1.2362e-01],
         [ 1.3413e-01, -1.4590e-01],
         [ 1.1311e-01,  1.2002e-01],
         [ 9.5761e-02, -1.4626e-01],
         [ 1.2719e-01, -1.4491e-01],
         [ 1.3971e-01, -1.4683e-01],
         [ 1.4509e-01,  9.9050e-02],
         [ 1.4928e-01,  7.8128e-02],
         [ 1.5139e-01, -1.5045e-01],
         [ 1.5476e-01,  6.0995e-02],
         [ 1.5877e-01,  8.3049e-02],
         [ 1.6000e-01,  1.1284e-01],
         [ 1.5681e-01,  9.5515e-02],
         [ 1.5462e-01,  6.9899e-02],
         [ 1.7017e-01,  8.8953e-02],
         [ 1.7714e-01,  7.3526e-02],
         [ 1.5025e-01,  1.0646e-01],
         [ 1.6550e-01,  1.1366e-01],
         [ 1.4340e-01,  8.4028e-02],
         [ 1.6326e-01,  9.2262e-02],
         [ 1.3887e-01,  6.6598e-02],
         [ 1.5437e-01,  9.7894e-02],
         [ 1.6240e-01,  1.2353e-01],
         [ 1.8591e-01,  1.3171e-01],
         [ 1.8777e-01,  1.1590e-01],
         [ 1.6100e-01,  1.1546e-01],
         [ 1.7391e-01,  1.1748e-01],
         [ 1.4269e-01,  1.1931e-01],
         [ 1.3565e-01,  1.2042e-01],
         [ 1.4610e-01,  1.1454e-01],
         [ 1.5359e-01,  8.3356e-02],
         [ 1.5699e-01,  1.0119e-01],
         [ 1.6432e-02,  6.9077e-02],
         [ 3.5244e-02,  3.1277e-02],
         [ 4.4472e-02,  7.0533e-02],
         [ 4.8442e-02,  7.4496e-02],
         [ 4.9899e-02,  3.5778e-02],
         [ 5.0302e-02,  3.9699e-02],
         [ 5.0287e-02,  3.6882e-02],
         [ 5.0197e-02,  3.9108e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 8.6686e-02,  8.3441e-02],
         [-6.3490e-02,  9.9245e-02],
         [ 9.3853e-02,  1.1336e-01],
         [-8.1104e-02,  1.1095e-01],
         [ 5.2530e-02,  9.3353e-02],
         [ 5.2087e-02,  5.2299e-02],
         [ 7.8247e-02,  7.5221e-02],
         [ 1.0421e-01,  6.1078e-02],
         [ 9.1635e-02,  3.8899e-02],
         [ 9.9649e-02,  7.2743e-02],
         [ 1.1699e-01,  8.8922e-02],
         [ 1.0706e-01,  6.8914e-02],
         [ 1.2228e-01,  8.5878e-02],
         [ 1.5503e-01,  5.2522e-02],
         [ 1.7563e-01,  1.7671e-02],
         [ 1.1937e-01,  6.1300e-02],
         [ 6.7971e-02,  4.3631e-02],
         [ 9.0847e-02,  7.3201e-02],
         [ 8.5973e-02,  7.0195e-02],
         [ 9.0418e-02,  1.0335e-01],
         [ 9.9638e-02,  1.4001e-01],
         [-8.7093e-02,  1.6380e-01],
         [ 5.4923e-02,  1.2709e-01],
         [ 7.8712e-02,  7.1162e-02],
         [ 9.1623e-02,  7.9654e-02],
         [ 9.7766e-02,  7.2462e-02],
         [ 7.4806e-02,  5.6397e-02],
         [ 8.4691e-02,  8.7122e-02],
         [ 6.2528e-02,  9.7264e-02],
         [ 9.0836e-02,  1.1572e-01],
         [-9.2239e-02,  1.0508e-01],
         [ 1.0430e-01,  1.4056e-01],
         [ 1.0964e-01,  1.2054e-01],
         [ 1.1250e-01,  1.0474e-01],
         [ 1.0522e-01,  9.8891e-02],
         [ 1.2087e-01,  9.3334e-02],
         [ 1.1408e-01,  9.5325e-02],
         [ 1.1560e-01,  1.1790e-01],
         [ 1.0055e-01,  1.0549e-01],
         [ 1.1458e-01,  5.5744e-03],
         [ 1.0905e-01,  1.1286e-01],
         [ 1.2145e-01,  9.3485e-02],
         [ 1.3227e-01,  1.1444e-01],
         [ 1.0943e-01,  1.0441e-01],
         [ 9.2285e-02,  1.3226e-01],
         [ 9.2401e-02,  1.4366e-01],
         [ 1.1591e-01,  1.1542e-01],
         [ 1.5079e-01,  1.0409e-01],
         [ 1.7411e-01,  1.1190e-01],
         [ 1.4275e-01,  9.6925e-02],
         [ 1.2698e-01,  9.7738e-02],
         [ 1.1173e-01,  1.1970e-01],
         [ 1.1679e-01,  1.3529e-01],
         [-7.3396e-02,  1.2956e-01],
         [ 9.7903e-02,  1.4199e-01],
         [ 1.1156e-01,  1.0984e-01],
         [ 1.1386e-01,  9.8527e-02],
         [ 1.1545e-01,  1.0747e-01],
         [ 1.1708e-01,  9.9227e-02],
         [ 1.0823e-01,  9.3978e-02],
         [ 1.2134e-01,  1.1875e-01],
         [ 1.3208e-01,  1.2975e-01],
         [ 1.3321e-01,  8.9740e-02],
         [ 1.3792e-01,  1.1600e-01],
         [ 1.2071e-01,  1.0143e-01],
         [ 1.2774e-01,  1.2037e-01],
         [ 1.1319e-01,  1.2953e-01],
         [ 1.5921e-01,  1.0588e-01],
         [ 1.9422e-01,  9.8908e-02],
         [ 2.0691e-01,  1.2764e-01],
         [ 2.1105e-01,  1.4330e-01],
         [ 2.1817e-01,  1.4428e-01],
         [ 2.1722e-01,  1.4302e-01],
         [ 2.3833e-01,  1.4328e-01],
         [ 2.3721e-01,  1.0220e-01],
         [ 1.9594e-01,  1.1819e-01],
         [ 1.8130e-01,  1.6400e-01],
         [ 1.4823e-01,  1.7924e-01],
         [ 1.7377e-01,  2.0754e-01],
         [ 1.9771e-01,  1.5539e-01],
         [ 1.7154e-01,  1.1934e-01],
         [ 5.0999e-02,  7.7195e-02],
         [ 1.8605e-01,  1.0422e-01],
         [ 1.8689e-01,  1.1724e-01],
         [ 1.5793e-01,  1.1266e-01],
         [ 1.7811e-01,  8.2225e-02],
         [ 1.8191e-01,  8.7617e-02],
         [ 1.5638e-01,  6.4972e-02],
         [ 1.7490e-01,  7.2359e-02],
         [ 1.6697e-01,  1.3069e-01],
         [ 1.5831e-01,  1.6085e-01],
         [ 1.7368e-01,  1.7385e-01],
         [ 1.8251e-01,  1.7024e-01],
         [ 1.7671e-01,  1.9141e-01],
         [ 1.5573e-02,  1.1079e-01],
         [ 3.3264e-02,  1.0407e-01],
         [ 4.2949e-02,  7.6128e-02],
         [ 4.7538e-02,  6.4411e-02],
         [ 4.9465e-02,  4.3067e-02],
         [ 5.0144e-02,  7.3750e-02],
         [ 5.0287e-02,  5.1764e-02],
         [ 5.0248e-02,  7.8280e-02],
         [ 5.0170e-02,  5.1017e-02],
         [ 5.0115e-02,  7.8993e-02],
         [ 5.0086e-02,  8.4933e-02],
         [ 5.0048e-02,  1.2484e-01],
         [ 5.0020e-02,  1.3912e-01],
         [ 5.0010e-02,  1.5267e-01],
         [ 5.0027e-02,  1.6060e-01],
         [ 5.0021e-02,  1.5701e-01],
         [ 5.0012e-02,  1.7459e-01],
         [ 5.0017e-02,  1.6737e-01],
         [ 5.0019e-02,  1.5916e-01],
         [ 5.0012e-02,  1.7296e-01],
         [ 5.0011e-02,  1.2508e-01],
         [ 5.0013e-02,  1.4453e-01],
         [ 5.0007e-02,  1.1444e-01],
         [ 5.0008e-02,  8.1922e-02],
         [ 5.0008e-02,  8.5299e-02],
         [ 5.0008e-02,  1.1861e-01],
         [ 5.0008e-02,  1.4372e-01],
         [ 5.0009e-02,  1.0544e-01],
         [ 5.0008e-02,  1.2915e-01],
         [ 5.0008e-02,  9.7376e-02],
         [ 5.0008e-02,  1.2542e-01],
         [ 5.0008e-02,  9.6701e-02],
         [ 5.0009e-02,  1.2515e-01],
         [ 5.0009e-02,  7.8430e-02],
         [ 5.0009e-02,  8.6127e-02],
         [ 5.0009e-02,  7.9205e-02],
         [ 5.0009e-02,  7.4345e-02],
         [ 5.0009e-02,  1.2154e-01],
         [ 5.0009e-02,  1.4030e-01],
         [ 5.0009e-02,  2.1527e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.5400e-05, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0010, device='cuda:0')
mixer_td_error tensor(0.7134, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4654, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4720, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0293, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1514, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0944, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2947760.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2383, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.7721e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2091, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1310, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2091, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9222
target_mac_out tensor([[[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7229e-02,  1.0718e-01,  ...,  1.5798e-02,
            1.3791e-01, -1.0000e+07],
          [-1.0000e+07, -6.3204e-02,  1.3937e-01,  ...,  4.1475e-02,
            1.4929e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9425e-02,  1.1495e-01,  ...,  1.2519e-02,
            1.5796e-01, -1.0000e+07],
          [-1.0000e+07, -7.3710e-02,  1.2961e-01,  ...,  3.4332e-02,
            1.4764e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.1049e-01,  9.5954e-02,  ...,  4.3549e-02,
            1.9052e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.2270e-01,  1.0282e-01,  ...,  7.2312e-02,
            2.0724e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6719e-01,  1.2207e-01,  ...,  9.9992e-02,
            2.0307e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3339e-02,  9.6645e-02,  ...,  1.7415e-02,
            1.4616e-01, -1.0000e+07],
          [-1.0000e+07, -3.2135e-02,  1.2998e-01,  ..., -1.6960e-03,
            1.4491e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.8271e-02,  1.0525e-01,  ...,  1.1768e-02,
            1.6624e-01, -1.0000e+07],
          [-1.0000e+07, -3.6496e-02,  1.0583e-01,  ...,  9.2376e-04,
            1.5021e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.9115e-02,  9.3163e-02],
         [ 1.0718e-01,  1.3937e-01],
         [ 1.1495e-01,  1.2961e-01],
         ...,
         [ 9.5954e-02,  5.5231e-02],
         [ 1.0282e-01,  5.5231e-02],
         [ 1.2207e-01,  5.5231e-02]],

        [[ 9.4778e-02,  1.0692e-01],
         [ 9.6645e-02,  1.2998e-01],
         [ 1.0525e-01,  1.0583e-01],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.0982e-05, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(1.0007, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4638, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5213, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0527, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1609, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0743, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-4016666.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2561, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.5645e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1889, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1809, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1889, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9271
target_mac_out tensor([[[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1864e-01,  1.1645e-01,  ...,  4.7226e-02,
            1.2989e-01, -1.0000e+07],
          [-1.0000e+07, -8.8152e-02,  1.5925e-01,  ...,  8.0349e-02,
            1.5339e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4282e-01,  1.2437e-01,  ...,  4.5437e-02,
            1.3326e-01, -1.0000e+07],
          [-1.0000e+07, -1.1550e-01,  1.7096e-01,  ...,  9.3482e-02,
            1.6726e-01, -3.2914e-01]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.7917e-02,  5.6894e-02,  ...,  1.4246e-02,
            1.3320e-01, -1.0000e+07],
          [-1.0000e+07, -2.8716e-02,  1.3079e-01,  ...,  3.1594e-02,
            1.4516e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.5003e-02,  8.7594e-02,  ...,  1.3130e-02,
            1.5415e-01, -1.0000e+07],
          [-1.0000e+07, -2.3731e-02,  1.3239e-01,  ...,  4.4457e-03,
            1.3966e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4468e-01,  6.7090e-02,  ...,  4.1082e-02,
            2.1067e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4501e-01,  6.8656e-02,  ...,  4.1647e-02,
            2.1103e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.8011e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.2561e-02,  1.4136e-01],
         [ 4.7226e-02,  1.5925e-01],
         [ 4.5437e-02,  1.7096e-01],
         [ 4.2677e-02,  1.6804e-01],
         [ 1.1966e-01,  1.5936e-01],
         [ 9.6480e-02, -1.1291e-01],
         [ 1.0827e-01,  1.3492e-01],
         [ 1.1504e-01, -1.2712e-01],
         [ 5.2138e-02,  6.7503e-02],
         [ 1.1711e-01,  9.5739e-02],
         [ 6.7148e-02,  9.8055e-02],
         [ 1.0966e-01,  7.6357e-02],
         [ 7.5569e-02,  1.0202e-01],
         [ 9.5001e-02,  1.0096e-01],
         [ 1.2416e-01,  8.6189e-02],
         [ 1.3910e-01,  1.1043e-01],
         [ 1.4155e-01, -1.6932e-01],
         [ 1.4807e-01,  1.0157e-01],
         [ 1.7075e-01, -1.6262e-01],
         [ 1.5083e-01, -1.6174e-01],
         [ 1.5753e-01, -1.5272e-01],
         [ 1.6595e-01, -1.4843e-01],
         [ 1.1423e-01, -1.4504e-01],
         [ 9.3032e-02, -1.4348e-01],
         [ 1.0014e-01,  7.1575e-02],
         [ 1.0298e-01,  1.2032e-03],
         [ 1.1725e-01,  3.1698e-02],
         [ 1.2430e-01,  4.6665e-02],
         [ 1.2460e-01,  5.3081e-02],
         [ 1.4029e-01,  5.5420e-02],
         [ 1.1855e-01,  5.5990e-02],
         [ 8.8230e-02,  5.5955e-02],
         [ 5.1006e-02,  5.5733e-02],
         [ 8.4578e-02,  5.5530e-02],
         [ 9.9809e-02,  5.5391e-02],
         [ 9.6239e-02,  5.5313e-02],
         [ 9.1297e-02,  5.5232e-02],
         [ 9.7713e-02,  5.5206e-02],
         [ 1.0032e-01,  5.5200e-02],
         [ 2.4096e-01,  5.5220e-02],
         [ 5.6085e-02,  5.5211e-02],
         [ 8.2782e-02,  5.5211e-02],
         [ 1.1488e-01,  5.5210e-02],
         [ 9.9489e-02,  5.5211e-02],
         [-1.7744e-02,  5.5222e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 7.0205e-02,  9.0702e-02],
         [ 1.4246e-02,  1.3079e-01],
         [ 8.7594e-02,  1.3239e-01],
         [ 1.0323e-01,  1.1632e-01],
         [ 1.0442e-01,  9.9824e-02],
         [ 2.5283e-02,  1.0463e-01],
         [ 1.1329e-01,  1.2338e-01],
         [ 1.2336e-01,  1.0604e-01],
         [ 3.8489e-02,  9.1427e-02],
         [ 1.1133e-01,  9.7647e-02],
         [ 1.0949e-01,  9.6679e-02],
         [ 1.1446e-01,  7.4387e-02],
         [ 1.1938e-01,  9.3969e-02],
         [ 1.1305e-01,  8.5103e-02],
         [ 8.9471e-02,  9.7480e-02],
         [ 9.2231e-04,  8.9395e-02],
         [ 1.8552e-02,  1.1319e-01],
         [ 1.2590e-02,  9.8562e-02],
         [ 1.0599e-01,  1.2382e-01],
         [ 1.1815e-01,  1.0896e-01],
         [ 9.5826e-02,  1.3550e-01],
         [ 8.2340e-02,  1.5038e-01],
         [ 9.1575e-02,  1.2323e-01],
         [ 1.2559e-02,  1.1935e-01],
         [ 1.0437e-02,  1.2784e-01],
         [ 1.1841e-01,  1.3572e-01],
         [ 1.2912e-01,  1.1052e-01],
         [ 1.3375e-01,  1.2535e-01],
         [ 3.0162e-02,  1.1741e-01],
         [ 3.3091e-02,  9.9905e-02],
         [ 1.7289e-02,  1.2590e-01],
         [ 1.2617e-01,  1.3348e-01],
         [ 1.3035e-01,  1.3546e-01],
         [ 1.3674e-01,  1.3952e-01],
         [ 1.0740e-01,  1.3001e-01],
         [ 1.1634e-01,  1.0889e-01],
         [ 9.5707e-02,  1.0311e-01],
         [ 7.6443e-03,  1.2891e-01],
         [-9.8316e-03,  1.2829e-01],
         [ 1.1863e-01,  1.4456e-01],
         [ 1.2777e-01,  1.5435e-01],
         [ 1.2186e-01,  1.6289e-01],
         [ 4.0487e-02,  1.6766e-01],
         [ 2.4001e-02,  1.3828e-01],
         [ 1.2972e-01,  1.5015e-01],
         [ 1.2529e-01,  1.5741e-01],
         [ 1.1941e-01,  1.6168e-01],
         [ 3.6235e-02,  1.6385e-01],
         [ 2.4531e-02,  1.3089e-01],
         [ 1.2358e-01,  1.4555e-01],
         [ 1.2812e-01,  1.1961e-01],
         [ 1.2617e-01,  1.1724e-01],
         [ 6.3045e-02,  1.1687e-01],
         [ 4.4845e-02,  1.3152e-01],
         [ 1.1515e-02,  1.1632e-01],
         [ 2.2913e-02,  1.0638e-01],
         [ 2.6610e-02,  9.6836e-02],
         [ 3.1000e-02,  1.1938e-01],
         [ 3.3072e-02,  1.3077e-01],
         [ 1.1471e-01,  1.3866e-01],
         [ 3.3912e-02,  1.4009e-01],
         [ 1.0784e-01,  1.2762e-01],
         [ 1.2075e-01,  1.3854e-01],
         [ 4.7147e-02,  1.4647e-01],
         [ 3.7587e-02,  1.0276e-01],
         [ 7.3910e-03,  1.0008e-01],
         [ 1.3111e-02,  1.2603e-01],
         [ 1.4127e-02,  1.1502e-01],
         [ 1.1468e-02,  1.2541e-01],
         [ 1.2649e-01,  1.3151e-01],
         [ 1.2646e-01,  1.3425e-01],
         [ 1.3543e-01,  9.2310e-02],
         [ 1.3322e-01,  8.8026e-02],
         [ 1.2016e-01,  1.0138e-01],
         [ 1.2657e-01,  7.4282e-02],
         [ 1.4841e-01,  9.8571e-02],
         [ 1.2229e-01,  7.0307e-02],
         [ 1.5138e-01,  5.4075e-02],
         [ 1.6548e-01,  6.2565e-02],
         [ 1.6812e-01,  7.0297e-02],
         [ 1.6668e-01,  9.2309e-02],
         [ 1.2924e-01,  9.9003e-02],
         [ 1.3129e-01,  5.8584e-02],
         [ 1.0394e-01,  4.9766e-02],
         [ 1.2823e-01,  9.9660e-02],
         [ 1.3830e-01,  8.8876e-02],
         [ 1.5438e-01,  1.1270e-01],
         [ 1.4216e-01,  1.2451e-01],
         [ 1.1787e-01,  1.2416e-01],
         [ 1.3289e-01,  1.0755e-01],
         [ 1.3960e-01,  1.1841e-01],
         [ 1.1653e-01,  1.1136e-01],
         [ 1.1983e-01,  9.4732e-02],
         [ 1.2907e-01,  8.8509e-02],
         [ 1.3716e-01,  8.4313e-02],
         [ 1.3722e-01,  1.1118e-01],
         [ 4.0743e-02,  1.2344e-01],
         [ 3.3859e-02,  9.2421e-02],
         [ 3.6670e-02,  1.1624e-01],
         [ 1.3603e-01,  1.2921e-01],
         [ 1.4665e-01,  1.3749e-01],
         [ 1.5144e-01,  1.3813e-01],
         [ 2.5158e-02,  1.3254e-01],
         [ 1.4532e-01,  1.0282e-01],
         [ 1.6822e-02,  1.2125e-01],
         [ 1.2385e-01,  1.2903e-01],
         [ 1.3081e-01,  8.6515e-02],
         [ 1.3495e-01,  8.5769e-02],
         [ 1.3049e-01,  1.1011e-01],
         [ 1.3884e-01,  9.7711e-02],
         [ 1.3502e-01,  1.1457e-01],
         [ 1.2904e-01,  8.6167e-02],
         [ 1.3954e-01,  1.0901e-01],
         [ 1.3579e-01,  1.2054e-01],
         [ 1.3852e-01,  1.2702e-01],
         [ 1.2165e-01,  1.2237e-01],
         [ 1.1463e-01,  7.5931e-02],
         [ 1.2219e-01,  1.0417e-01],
         [ 1.1297e-01,  9.0407e-02],
         [ 1.4211e-01,  6.2769e-02],
         [ 1.2931e-01, -4.8397e-02],
         [ 1.4074e-01,  9.8347e-02],
         [ 1.4301e-01,  1.1295e-01],
         [ 1.2469e-01,  1.2170e-01],
         [ 1.1691e-01,  1.0220e-01],
         [ 9.5465e-02,  8.4128e-02],
         [ 1.2366e-01,  1.1696e-01],
         [ 6.5842e-02,  9.7391e-02],
         [ 4.5893e-02,  1.2196e-01],
         [ 3.8044e-02,  1.3366e-01],
         [ 2.7900e-02,  1.0497e-01],
         [ 3.0137e-02,  8.6270e-02],
         [ 1.3144e-01,  1.1244e-01],
         [ 1.3952e-01,  8.5599e-02],
         [ 1.4833e-01,  8.0999e-02],
         [ 1.3860e-01,  1.1188e-01],
         [ 1.1400e-01,  9.8299e-02],
         [ 1.1121e-01,  7.9088e-02],
         [ 1.4424e-01,  9.5651e-02],
         [ 1.3921e-01,  8.4921e-02],
         [ 1.2263e-01,  1.1194e-01],
         [ 1.3248e-01,  9.8273e-02],
         [ 1.3616e-01,  1.2599e-01],
         [ 1.3964e-01,  1.3534e-01],
         [-6.6370e-02,  9.3361e-02],
         [ 1.3123e-01,  7.4053e-02],
         [-5.2632e-02,  7.5581e-02],
         [-4.3047e-02,  1.0740e-01],
         [ 1.2700e-01,  8.5475e-02],
         [ 1.4137e-01,  7.3850e-02],
         [ 1.6623e-01,  7.0927e-02],
         [ 1.8105e-01,  9.3837e-02],
         [ 1.6525e-01,  1.0353e-01],
         [ 1.5752e-01,  6.8802e-02],
         [ 1.4085e-01,  4.5780e-02],
         [ 1.7392e-01,  4.2385e-02],
         [ 1.2638e-01,  6.3405e-02],
         [ 1.2063e-01,  8.5005e-02],
         [ 1.1187e-01,  1.3262e-01],
         [ 9.1755e-02,  1.2221e-01],
         [ 8.3572e-02,  1.5351e-01],
         [ 1.3487e-01,  1.3997e-01],
         [ 1.6708e-01,  1.2965e-01],
         [ 1.6798e-01,  1.1612e-01],
         [ 1.8082e-01,  1.1231e-01],
         [ 2.0483e-01,  1.5558e-01],
         [ 1.9077e-01,  1.8743e-01],
         [ 1.9418e-01,  1.2014e-01],
         [ 1.7888e-01,  1.2155e-01],
         [ 1.8379e-01,  1.2362e-01],
         [-1.1019e-01,  1.4484e-01],
         [-1.0083e-01,  1.9042e-01],
         [ 1.4964e-01,  2.0966e-01],
         [-1.9947e-02,  1.8789e-01],
         [ 1.5737e-02,  1.7246e-01],
         [ 3.4325e-02,  1.6597e-01],
         [ 4.3325e-02,  9.9831e-02],
         [ 4.7501e-02,  9.4814e-02],
         [ 4.9270e-02,  1.3159e-01],
         [ 4.9924e-02,  1.0925e-01],
         [ 5.0131e-02,  1.4172e-01],
         [ 5.0164e-02,  1.5433e-01],
         [ 5.0119e-02,  1.3513e-01],
         [ 5.0091e-02,  1.6147e-01],
         [ 5.0037e-02,  1.2440e-01],
         [ 5.0028e-02,  1.2322e-01],
         [ 5.0044e-02,  1.1161e-01],
         [ 5.0032e-02,  1.0691e-01],
         [ 5.0043e-02,  1.0459e-01],
         [ 5.0017e-02,  1.4597e-01],
         [ 5.0003e-02,  9.2938e-02],
         [ 5.0021e-02,  9.2611e-02],
         [ 5.0021e-02,  1.3056e-01],
         [ 5.0020e-02,  1.4713e-01],
         [ 5.0016e-02,  9.1341e-02],
         [ 5.0006e-02,  9.4173e-02],
         [ 5.0007e-02,  1.1454e-01],
         [ 5.0008e-02,  1.1394e-01],
         [ 5.0007e-02,  1.2168e-01],
         [ 5.0008e-02,  1.1299e-01],
         [ 5.0008e-02,  1.1165e-01],
         [ 5.0008e-02,  8.8157e-02],
         [ 5.0008e-02,  8.9354e-02],
         [ 5.0008e-02,  5.7063e-02],
         [ 5.0008e-02,  7.0777e-02],
         [ 5.0008e-02,  7.1377e-02],
         [ 5.0009e-02,  7.8301e-02],
         [ 5.0009e-02,  5.5717e-02],
         [ 5.0009e-02,  6.5914e-02],
         [ 5.0009e-02,  4.3096e-02],
         [ 5.0009e-02,  7.6981e-02],
         [ 5.0009e-02,  4.5213e-02],
         [ 5.0009e-02,  4.7755e-02],
         [ 5.0009e-02,  5.8247e-02],
         [ 5.0009e-02,  6.3998e-02],
         [ 5.0009e-02,  6.7090e-02],
         [ 5.0009e-02,  6.8656e-02],
         [ 5.0009e-02,  2.8011e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.6620e-05, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.9587, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4600, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8190, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0503, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2094, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0498, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3967889.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2410, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.5447e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0007, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1685, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1503, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1685, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9318
target_mac_out tensor([[[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.8475e-02,  8.3930e-02,  ...,  2.9168e-03,
            1.4114e-01, -1.0000e+07],
          [-1.0000e+07, -2.8572e-02,  1.0818e-01,  ...,  1.1152e-02,
            1.4585e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1306e-02,  8.6921e-02,  ..., -3.6412e-03,
            1.5129e-01, -1.0000e+07],
          [-1.0000e+07, -2.5687e-02,  1.0845e-01,  ...,  2.2908e-02,
            1.4218e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3070e-01,  1.2391e-01,  ...,  7.1034e-02,
            1.5852e-01, -1.0000e+07],
          [-1.0000e+07, -3.6329e-02,  1.0540e-01,  ..., -2.3505e-02,
            1.3276e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4548e-01,  1.2388e-01,  ...,  5.2184e-02,
            1.5225e-01, -1.0000e+07],
          [-1.0000e+07, -7.9506e-02,  1.4849e-01,  ...,  2.9133e-02,
            1.4592e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5505e-01,  5.1068e-02,  ...,  3.8250e-02,
            2.0122e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5922e-01,  4.2900e-02,  ...,  2.9935e-02,
            1.9831e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.9150e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.2334e-02,  1.2843e-01],
         [ 8.3930e-02,  1.0818e-01],
         [ 8.6921e-02,  1.0845e-01],
         [-5.9246e-02,  1.3467e-01],
         [ 1.4079e-02,  1.4503e-01],
         [ 1.0447e-01,  1.4866e-01],
         [ 1.1596e-01,  1.2756e-01],
         [ 1.2122e-01,  1.3965e-01],
         [ 5.9566e-02,  1.4910e-01],
         [ 4.5224e-02,  1.2084e-01],
         [ 1.6853e-02,  1.0404e-01],
         [ 1.1905e-01,  9.2736e-02],
         [ 1.2676e-01,  9.5823e-02],
         [ 1.2947e-01,  8.8226e-02],
         [ 7.3711e-02,  1.1663e-01],
         [ 4.4114e-02,  1.4169e-01],
         [ 6.0602e-02,  1.1530e-01],
         [ 3.6869e-02,  1.0774e-01],
         [ 1.0176e-01, -3.2668e-02],
         [ 1.0365e-01,  7.8517e-02],
         [ 1.2059e-01, -3.9493e-02],
         [ 8.7165e-02,  7.8808e-02],
         [ 1.1784e-01, -9.9973e-03],
         [ 8.5136e-02,  1.1179e-01],
         [ 9.2479e-02,  1.0458e-01],
         [ 7.4687e-02,  6.3215e-02],
         [ 4.1600e-02,  1.1612e-01],
         [ 8.6666e-02,  8.0882e-02],
         [ 5.2790e-02,  8.5783e-02],
         [ 6.4680e-02,  9.4266e-02],
         [ 9.6260e-02,  9.8277e-02],
         [ 8.5407e-02,  1.0104e-01],
         [ 1.2424e-01,  1.2004e-01],
         [ 1.3649e-01,  1.2468e-01],
         [ 1.0283e-01,  1.2215e-01],
         [ 1.2145e-01,  1.1222e-01],
         [ 1.3870e-01,  8.2000e-02],
         [ 1.0532e-01,  7.5387e-02],
         [ 9.5750e-02,  6.8666e-02],
         [ 1.0113e-01,  8.4208e-02],
         [ 9.3375e-02,  5.9565e-02],
         [ 5.6848e-02,  7.1971e-02],
         [ 9.2008e-02,  6.8996e-02],
         [ 1.0534e-01,  5.9581e-02],
         [ 1.3942e-01,  1.3646e-01],
         [ 9.2233e-02,  8.0797e-02],
         [ 1.0784e-01,  2.7996e-02],
         [ 7.7165e-02,  5.4345e-02],
         [ 5.4297e-02,  2.1527e-02],
         [ 6.3901e-02,  3.7742e-02],
         [ 1.4504e-02,  8.1158e-02],
         [ 3.2923e-02,  9.2443e-02],
         [ 4.2669e-02,  9.1257e-02],
         [ 4.7293e-02,  2.4872e-01],
         [ 4.9259e-02,  2.3509e-01],
         [ 4.9997e-02,  2.1777e-01],
         [ 5.0192e-02, -1.6841e-01],
         [ 5.0199e-02,  1.3414e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 6.1307e-02,  1.0736e-01],
         [ 7.1034e-02,  1.0540e-01],
         [ 1.2388e-01,  1.4849e-01],
         [ 2.0463e-02,  1.1545e-01],
         [ 8.1763e-02,  1.0360e-01],
         [ 1.0384e-01,  1.6212e-01],
         [ 3.2146e-02,  1.3985e-01],
         [ 4.2303e-02,  1.2283e-01],
         [ 5.0321e-02,  1.4214e-01],
         [ 1.5162e-01,  1.6795e-01],
         [ 1.6399e-01,  1.8431e-01],
         [ 7.6526e-02,  1.5073e-01],
         [ 1.3556e-01,  1.3457e-01],
         [ 5.2204e-02,  1.1134e-01],
         [ 5.7688e-02,  1.3791e-01],
         [ 5.5784e-02,  1.6636e-01],
         [ 7.4548e-02,  1.3594e-01],
         [ 1.5384e-01,  1.1079e-01],
         [ 1.4967e-01,  1.2379e-01],
         [-1.4367e-01,  8.9738e-02],
         [ 9.3326e-02,  4.7128e-02],
         [ 1.5065e-02,  3.7195e-02],
         [ 3.1087e-02,  3.1123e-02],
         [ 4.1229e-02,  4.1234e-02],
         [ 4.6494e-02,  2.3417e-02],
         [ 4.8929e-02,  3.2086e-02],
         [ 4.9845e-02,  7.2299e-02],
         [ 5.0161e-02,  4.9700e-02],
         [ 5.0198e-02,  7.7594e-02],
         [ 5.0164e-02,  6.4016e-02],
         [ 5.0127e-02,  8.3781e-02],
         [ 5.0076e-02,  1.1153e-01],
         [ 5.0043e-02,  7.9167e-02],
         [ 5.0052e-02,  7.6035e-02],
         [ 5.0029e-02,  8.8515e-02],
         [ 5.0036e-02,  6.7258e-02],
         [ 5.0027e-02,  8.0908e-02],
         [ 5.0019e-02,  4.5657e-02],
         [ 5.0025e-02,  7.9332e-02],
         [ 5.0026e-02,  9.3016e-02],
         [ 5.0010e-02,  9.7706e-02],
         [ 5.0020e-02,  5.7490e-02],
         [ 5.0005e-02,  8.6472e-02],
         [ 5.0007e-02,  9.7147e-02],
         [ 5.0008e-02,  6.3430e-02],
         [ 5.0008e-02,  8.5475e-02],
         [ 5.0008e-02,  5.6860e-02],
         [ 5.0009e-02,  4.3634e-02],
         [ 5.0008e-02,  3.0384e-02],
         [ 5.0008e-02,  3.7612e-02],
         [ 5.0008e-02,  7.4572e-02],
         [ 5.0008e-02,  6.8489e-02],
         [ 5.0008e-02,  6.1119e-02],
         [ 5.0009e-02,  5.5672e-02],
         [ 5.0009e-02,  3.7676e-02],
         [ 5.0009e-02,  4.6479e-02],
         [ 5.0009e-02,  6.9029e-02],
         [ 5.0009e-02,  8.4975e-02],
         [ 5.0009e-02,  9.1598e-02],
         [ 5.0009e-02,  7.4213e-02],
         [ 5.0009e-02,  4.1839e-02],
         [ 5.0009e-02,  3.8502e-02],
         [ 5.0009e-02,  7.1914e-02],
         [ 5.0009e-02,  1.0388e-01],
         [ 5.0009e-02,  8.5299e-02],
         [ 5.0009e-02,  9.0344e-02],
         [ 5.0009e-02,  4.6900e-02],
         [ 5.0009e-02,  4.2289e-02],
         [ 5.0009e-02,  6.6682e-02],
         [ 5.0009e-02,  7.9862e-02],
         [ 5.0009e-02,  3.3461e-02],
         [ 5.0009e-02,  3.2876e-02],
         [ 5.0009e-02,  4.5653e-02],
         [ 5.0009e-02,  8.0870e-02],
         [ 5.0009e-02,  6.0900e-02],
         [ 5.0009e-02,  7.1534e-02],
         [ 5.0009e-02,  7.7649e-02],
         [ 5.0009e-02,  8.1230e-02],
         [ 5.0009e-02,  6.0169e-02],
         [ 5.0009e-02,  5.0937e-02],
         [ 5.0009e-02,  5.6693e-02],
         [ 5.0009e-02,  7.6477e-02],
         [ 5.0009e-02,  6.0402e-02],
         [ 5.0009e-02,  5.0377e-02],
         [ 5.0009e-02,  4.3616e-02],
         [ 5.0009e-02,  3.8999e-02],
         [ 5.0009e-02,  2.8196e-02],
         [ 5.0009e-02,  6.9579e-02],
         [ 5.0009e-02,  8.6352e-02],
         [ 5.0009e-02,  5.8278e-02],
         [ 5.0009e-02,  4.5538e-02],
         [ 5.0009e-02,  7.5007e-02],
         [ 5.0009e-02,  8.7675e-02],
         [ 5.0009e-02,  9.3339e-02],
         [ 5.0009e-02,  1.1464e-01],
         [ 5.0009e-02,  6.3624e-02],
         [ 5.0009e-02,  6.6775e-02],
         [ 5.0009e-02,  4.7620e-02],
         [ 5.0009e-02,  3.9063e-02],
         [ 5.0009e-02,  7.1689e-02],
         [ 5.0009e-02,  1.0404e-01],
         [ 5.0009e-02,  1.0427e-01],
         [ 5.0009e-02,  5.8940e-02],
         [ 5.0009e-02,  4.2998e-02],
         [ 5.0009e-02,  4.3363e-02],
         [ 5.0009e-02,  7.5933e-02],
         [ 5.0009e-02,  8.5900e-02],
         [ 5.0009e-02,  1.3334e-01],
         [ 5.0009e-02,  8.9865e-02],
         [ 5.0009e-02,  7.3448e-02],
         [ 5.0009e-02,  9.6982e-02],
         [ 5.0009e-02,  5.9533e-02],
         [ 5.0009e-02,  8.2586e-02],
         [ 5.0009e-02,  7.9531e-02],
         [ 5.0009e-02,  8.8877e-02],
         [ 5.0009e-02,  6.3198e-02],
         [ 5.0009e-02,  5.1944e-02],
         [ 5.0009e-02,  6.4473e-02],
         [ 5.0009e-02,  9.1396e-02],
         [ 5.0009e-02,  8.8900e-02],
         [ 5.0009e-02,  8.9520e-02],
         [ 5.0009e-02,  8.9573e-02],
         [ 5.0009e-02,  5.0133e-02],
         [ 5.0009e-02,  7.2536e-02],
         [ 5.0009e-02,  8.1444e-02],
         [ 5.0009e-02,  7.2294e-02],
         [ 5.0009e-02,  9.0362e-02],
         [ 5.0009e-02,  6.5614e-02],
         [ 5.0009e-02,  5.1068e-02],
         [ 5.0009e-02,  4.2900e-02],
         [ 5.0009e-02,  1.9150e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.6464e-05, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0014, device='cuda:0')
mixer_td_error tensor(0.7022, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4640, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4728, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0513, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1861, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0483, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2786259., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2487, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.3979e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2660, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1644, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2660, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9366
target_mac_out tensor([[[[-1.0000e+07, -6.3466e-02,  7.0474e-02,  ...,  7.2381e-03,
            1.2779e-01, -1.0000e+07],
          [-1.0000e+07, -6.3055e-03,  1.1210e-01,  ...,  5.1485e-03,
            1.2331e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2587e-02,  7.6481e-02,  ...,  7.7070e-03,
            1.4308e-01, -1.0000e+07],
          [-1.0000e+07, -1.4318e-02,  1.1976e-01,  ..., -1.1387e-02,
            1.3100e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.9504e-02,  8.1150e-02,  ...,  1.8671e-02,
            1.7899e-01, -1.0000e+07],
          [-1.0000e+07, -4.5628e-02,  5.5136e-02,  ..., -1.0000e+07,
            1.5721e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5656e-01,  4.5832e-02,  ...,  8.5851e-02,
            1.9715e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4955e-01,  6.4268e-02,  ...,  6.7706e-02,
            1.9920e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 3.3283e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.3297e-02,  7.5482e-02,  ...,  2.0656e-03,
            1.2204e-01, -1.0000e+07],
          [-1.0000e+07, -1.9084e-02,  9.7086e-02,  ..., -1.3971e-02,
            1.2488e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4835e-02,  1.0068e-01,  ...,  2.7234e-02,
            1.5901e-01, -1.0000e+07],
          [-1.0000e+07, -2.5852e-02,  9.3294e-02,  ..., -3.4115e-04,
            1.3873e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9054e-02,  1.0069e-01,  ...,  1.9605e-02,
            1.5300e-01, -1.0000e+07],
          [-1.0000e+07, -2.5418e-02,  1.0335e-01,  ...,  1.9610e-02,
            1.3840e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.0474e-02,  1.1210e-01],
         [ 7.6481e-02,  1.1976e-01],
         [ 8.1150e-02, -4.5628e-02],
         [ 1.0666e-01,  5.0300e-02],
         [ 6.5101e-02,  5.6482e-02],
         [ 6.4871e-02,  8.5779e-02],
         [ 8.9003e-02, -9.1078e-02],
         [ 7.1528e-02, -6.3859e-02],
         [-7.2996e-02, -4.5735e-02],
         [ 1.0104e-01,  6.4745e-02],
         [ 1.4683e-01,  5.4588e-02],
         [ 1.6326e-01,  4.5213e-02],
         [ 1.6950e-01,  5.1415e-02],
         [ 1.7225e-01,  3.5764e-02],
         [ 1.7370e-01,  2.4270e-02],
         [ 1.8381e-01,  7.0909e-02],
         [ 1.4212e-01,  6.2232e-02],
         [-6.1581e-02,  9.7053e-02],
         [ 1.1953e-01,  5.8976e-02],
         [ 1.5873e-01, -2.1849e-02],
         [ 1.6931e-01,  7.2635e-02],
         [ 1.3240e-01,  4.9188e-02],
         [ 1.6992e-01,  8.0208e-02],
         [ 1.3766e-01,  6.5407e-02],
         [ 1.0642e-01, -4.9209e-02],
         [ 1.0360e-01,  6.2294e-02],
         [ 9.7161e-02,  1.2044e-01],
         [ 9.1372e-02,  1.5158e-01],
         [ 7.6644e-02,  1.3440e-01],
         [ 9.7427e-02,  1.5115e-01],
         [ 7.6765e-02,  1.2268e-01],
         [ 8.3222e-02,  7.1014e-02],
         [ 9.0749e-02,  8.7677e-02],
         [ 1.1364e-01,  6.0549e-02],
         [ 1.0940e-01,  8.5712e-02],
         [ 1.5019e-01,  9.5902e-02],
         [ 1.2494e-01,  7.3823e-02],
         [ 9.8726e-02, -5.3262e-02],
         [ 1.1423e-01,  7.9834e-02],
         [ 1.6766e-01,  1.0876e-01],
         [ 1.7469e-01,  7.4987e-02],
         [ 1.4125e-01,  9.4451e-02],
         [ 1.2481e-01,  9.5342e-02],
         [ 1.2016e-01,  1.2223e-01],
         [ 1.2580e-01,  1.3331e-01],
         [ 1.3176e-01,  1.4085e-01],
         [ 1.2898e-01,  1.2621e-01],
         [ 1.2740e-01,  9.3266e-02],
         [ 1.2831e-01,  1.1164e-01],
         [ 1.3448e-01,  1.2398e-01],
         [ 1.1613e-01,  1.3854e-01],
         [ 1.2881e-01,  1.0254e-01],
         [ 1.3150e-01,  1.1628e-01],
         [ 1.3140e-01,  1.3444e-01],
         [ 1.5448e-01,  1.0571e-01],
         [ 1.3494e-01,  1.2163e-01],
         [ 1.4661e-01,  9.0072e-02],
         [ 1.4391e-01,  9.2861e-02],
         [ 1.3475e-01,  8.8651e-02],
         [ 1.3573e-01,  8.3263e-02],
         [ 1.2464e-01,  1.1600e-01],
         [ 1.2043e-01,  9.8642e-02],
         [ 1.3708e-01,  8.8853e-02],
         [ 1.2502e-01,  1.1762e-01],
         [ 1.4148e-01,  1.3200e-01],
         [ 1.4636e-01,  1.1577e-01],
         [ 1.5839e-01,  1.3778e-01],
         [ 5.4104e-02,  1.1533e-01],
         [ 1.3649e-01,  1.2797e-01],
         [ 1.4915e-01,  1.1051e-01],
         [-1.6102e-01,  1.0270e-01],
         [ 1.4575e-01,  1.2830e-01],
         [ 1.2806e-01,  1.0824e-01],
         [ 1.4475e-01,  9.4987e-02],
         [ 1.5304e-01,  1.2239e-01],
         [ 1.4963e-01,  6.9942e-02],
         [ 1.3436e-01, -2.8528e-02],
         [ 9.9067e-02, -3.0319e-02],
         [ 1.2606e-01,  8.3794e-02],
         [ 1.1663e-01,  1.2395e-01],
         [-1.6578e-01,  1.4203e-01],
         [-1.6598e-01,  1.0932e-01],
         [-1.3193e-01,  8.3082e-02],
         [-1.2054e-01,  1.2089e-01],
         [-1.1861e-01,  9.3854e-02],
         [ 4.1395e-03,  5.0161e-02],
         [ 2.4914e-02, -4.9438e-02],
         [ 3.8011e-02, -1.9060e-02],
         [ 4.4862e-02,  7.5425e-02],
         [ 4.8084e-02,  5.3374e-02],
         [ 4.9444e-02,  8.1507e-02],
         [ 4.9938e-02,  6.7311e-02],
         [ 5.0105e-02,  8.6437e-02],
         [ 5.0106e-02,  9.6375e-02],
         [ 5.0078e-02,  9.9632e-02],
         [ 5.0066e-02,  6.0977e-02],
         [ 5.0044e-02,  7.5696e-02],
         [ 5.0022e-02, -6.2816e-02],
         [ 5.0014e-02, -3.8875e-02],
         [ 5.0027e-02,  6.9510e-02],
         [ 5.0027e-02,  5.5172e-02],
         [ 5.0028e-02,  8.4641e-02],
         [ 5.0025e-02,  5.4262e-02],
         [ 5.0022e-02,  8.0050e-02],
         [ 5.0012e-02,  9.0614e-02],
         [ 5.0016e-02,  6.9030e-02],
         [ 5.0006e-02,  8.3027e-02],
         [ 5.0006e-02,  9.0938e-02],
         [ 5.0008e-02, -1.4410e-02],
         [ 5.0008e-02,  6.6335e-02],
         [ 5.0008e-02,  7.4818e-02],
         [ 5.0008e-02, -1.4559e-02],
         [ 5.0008e-02, -8.7757e-03],
         [ 5.0008e-02,  3.4148e-03],
         [ 5.0008e-02,  7.3721e-02],
         [ 5.0008e-02,  4.5735e-02],
         [ 5.0008e-02,  7.4586e-02],
         [ 5.0009e-02,  6.1022e-02],
         [ 5.0009e-02, -9.8564e-03],
         [ 5.0009e-02, -7.7386e-03],
         [ 5.0009e-02,  6.6945e-02],
         [ 5.0009e-02,  4.2960e-02],
         [ 5.0009e-02, -1.3824e-03],
         [ 5.0009e-02,  7.1956e-02],
         [ 5.0009e-02,  5.8515e-02],
         [ 5.0009e-02, -8.7558e-03],
         [ 5.0009e-02,  6.9457e-02],
         [ 5.0009e-02,  5.8141e-02],
         [ 5.0009e-02,  7.7305e-02],
         [ 5.0009e-02,  8.7816e-02],
         [ 5.0009e-02,  9.1415e-02],
         [ 5.0009e-02,  6.1923e-02],
         [ 5.0009e-02, -1.1482e-02],
         [ 5.0009e-02,  8.0173e-02],
         [ 5.0009e-02,  5.6652e-02],
         [ 5.0009e-02, -1.6185e-02],
         [ 5.0009e-02, -3.4284e-04],
         [ 5.0009e-02,  7.5627e-02],
         [ 5.0009e-02, -5.3459e-03],
         [ 5.0009e-02,  7.3473e-02],
         [ 5.0009e-02, -3.8347e-02],
         [ 5.0009e-02,  6.9528e-02],
         [ 5.0009e-02,  6.8252e-02],
         [ 5.0009e-02,  8.4909e-02],
         [ 5.0009e-02, -5.7513e-02],
         [ 5.0009e-02,  7.5520e-02],
         [ 5.0009e-02,  7.5811e-02],
         [ 5.0009e-02, -5.3922e-02],
         [ 5.0009e-02, -5.8485e-02],
         [ 5.0009e-02,  8.5104e-02],
         [ 5.0009e-02,  8.0125e-02],
         [ 5.0009e-02,  6.2491e-02],
         [ 5.0009e-02,  9.1733e-02],
         [ 5.0009e-02,  1.0203e-01],
         [ 5.0009e-02,  1.0562e-01],
         [ 5.0009e-02,  7.9230e-02],
         [ 5.0009e-02,  1.0627e-01],
         [ 5.0009e-02,  1.0531e-01],
         [ 5.0009e-02,  1.0515e-01],
         [ 5.0009e-02,  7.1686e-02],
         [ 5.0009e-02,  9.0917e-02],
         [ 5.0009e-02,  9.2005e-02],
         [ 5.0009e-02,  9.3408e-02],
         [ 5.0009e-02,  6.4568e-02],
         [ 5.0009e-02,  4.2366e-02],
         [ 5.0009e-02,  2.9529e-02],
         [ 5.0009e-02,  2.6544e-02],
         [ 5.0009e-02,  5.3375e-02],
         [ 5.0009e-02,  7.5595e-02],
         [ 5.0009e-02,  4.2649e-02],
         [ 5.0009e-02,  3.9182e-02],
         [ 5.0009e-02,  5.8927e-02],
         [ 5.0009e-02,  4.7374e-02],
         [ 5.0009e-02,  5.9143e-02],
         [ 5.0009e-02,  8.0537e-02],
         [ 5.0009e-02,  8.7959e-02],
         [ 5.0009e-02,  6.1583e-02],
         [ 5.0009e-02,  5.1418e-02],
         [ 5.0009e-02,  4.6209e-02],
         [ 5.0009e-02,  4.2734e-02],
         [ 5.0009e-02,  6.8170e-02],
         [ 5.0009e-02,  8.1954e-02],
         [ 5.0009e-02,  7.2380e-02],
         [ 5.0009e-02,  9.3389e-02],
         [ 5.0009e-02,  6.3173e-02],
         [ 5.0009e-02,  7.6049e-02],
         [ 5.0009e-02,  3.6582e-02],
         [ 5.0009e-02,  7.6805e-02],
         [ 5.0009e-02,  3.7273e-02],
         [ 5.0009e-02,  7.7231e-02],
         [ 5.0009e-02,  8.9976e-02],
         [ 5.0009e-02,  1.0108e-01],
         [ 5.0009e-02,  4.5832e-02],
         [ 5.0009e-02,  6.4268e-02],
         [ 5.0009e-02,  3.3283e-02]],

        [[ 7.5482e-02,  9.7086e-02],
         [ 1.0068e-01,  9.3294e-02],
         [-8.9054e-02,  1.0335e-01],
         [ 4.5927e-02,  1.4030e-01],
         [-1.2238e-01,  1.5024e-01],
         [ 4.3401e-02,  1.2506e-01],
         [ 3.9755e-02,  1.3818e-01],
         [ 1.3220e-01,  1.1480e-01],
         [ 4.2876e-02,  1.3453e-01],
         [ 6.7667e-02,  1.3740e-01],
         [ 1.6446e-01,  1.0102e-01],
         [ 1.6730e-01,  8.0992e-02],
         [ 1.7587e-01,  8.4080e-02],
         [ 1.7871e-01,  7.6988e-02],
         [ 1.5113e-01,  7.3651e-02],
         [ 1.7729e-01,  1.1539e-01],
         [ 1.5111e-01,  1.2512e-01],
         [ 4.6883e-02,  8.5442e-02],
         [ 5.0141e-02,  1.0418e-01],
         [ 5.5605e-02,  6.4403e-02],
         [ 1.5320e-01, -7.6786e-02],
         [-8.6627e-02, -7.8586e-02],
         [ 1.4435e-01,  8.4455e-02],
         [ 1.5861e-01,  1.0022e-01],
         [ 1.6486e-01, -5.6457e-02],
         [ 1.6792e-01,  8.8018e-02],
         [ 1.7192e-01, -5.2210e-02],
         [ 1.7065e-01,  7.6617e-02],
         [ 1.7058e-01,  9.9807e-02],
         [ 1.2394e-01,  9.6899e-02],
         [ 9.8329e-02,  1.0378e-01],
         [ 1.3344e-01,  1.5209e-01],
         [ 1.1068e-01,  1.1642e-01],
         [ 1.4764e-01,  1.1413e-01],
         [ 1.6476e-01,  1.6018e-01],
         [ 1.6219e-01,  1.8103e-01],
         [ 1.7489e-01,  1.3608e-01],
         [ 1.7774e-01,  8.7672e-02],
         [ 1.8387e-01,  5.7163e-02],
         [ 1.8724e-01,  8.6500e-02],
         [-3.2408e-02,  4.1982e-02],
         [ 8.6133e-03,  7.3809e-02],
         [ 3.0226e-02,  8.7279e-02],
         [ 4.0974e-02,  6.5005e-02],
         [ 4.6110e-02,  7.8679e-02],
         [ 4.8453e-02,  4.3388e-02],
         [ 4.9465e-02,  5.1561e-02],
         [ 4.9862e-02,  5.0243e-02],
         [ 5.0008e-02,  3.3974e-02],
         [ 5.0033e-02,  4.1872e-02],
         [ 5.0035e-02,  2.4136e-02],
         [ 5.0019e-02,  4.1443e-02],
         [ 5.0017e-02,  7.3933e-02],
         [ 5.0016e-02,  6.1473e-02],
         [ 5.0031e-02,  7.9226e-02],
         [ 5.0043e-02,  4.5172e-02],
         [ 5.0020e-02,  7.9315e-02],
         [ 5.0008e-02,  1.1383e-01],
         [ 5.0022e-02,  9.4502e-02],
         [ 5.0015e-02,  9.8246e-02],
         [ 5.0021e-02,  1.0208e-01],
         [ 5.0020e-02,  5.5037e-02],
         [ 5.0005e-02,  6.1310e-02],
         [ 5.0007e-02,  4.4265e-02],
         [ 5.0008e-02,  5.1889e-02],
         [ 5.0008e-02,  9.1918e-02],
         [ 5.0008e-02,  6.9973e-02],
         [ 5.0008e-02,  8.2528e-02],
         [ 5.0008e-02,  1.0609e-01],
         [ 5.0008e-02,  5.6883e-02],
         [ 5.0008e-02,  5.8070e-02],
         [ 5.0008e-02,  9.7021e-02],
         [ 5.0008e-02,  6.1195e-02],
         [ 5.0009e-02,  6.2063e-02],
         [ 5.0009e-02,  5.0995e-02],
         [ 5.0009e-02,  4.4612e-02],
         [ 5.0009e-02,  2.7573e-02],
         [ 5.0009e-02,  6.7260e-02],
         [ 5.0009e-02,  8.3678e-02],
         [ 5.0009e-02,  1.0892e-01],
         [ 5.0009e-02,  1.0277e-01],
         [ 5.0009e-02,  8.7774e-02],
         [ 5.0009e-02,  7.0933e-02],
         [ 5.0009e-02,  3.5469e-02],
         [ 5.0009e-02,  3.9060e-02],
         [ 5.0009e-02,  3.9678e-02],
         [ 5.0009e-02,  8.4245e-02],
         [ 5.0009e-02,  4.3959e-02],
         [ 5.0009e-02,  8.9642e-02],
         [ 5.0009e-02,  9.0533e-02],
         [ 5.0009e-02,  4.6276e-02],
         [ 5.0009e-02,  2.8848e-02],
         [ 5.0009e-02,  4.7425e-02],
         [ 5.0009e-02,  3.0230e-02],
         [ 5.0009e-02,  6.1229e-02],
         [ 5.0009e-02,  4.5215e-02],
         [ 5.0009e-02,  2.9583e-02],
         [ 5.0009e-02,  2.4084e-02],
         [ 5.0009e-02,  1.8688e-02],
         [ 5.0009e-02,  4.4247e-02],
         [ 5.0009e-02,  5.4637e-02],
         [ 5.0009e-02,  6.6085e-02],
         [ 5.0009e-02,  3.7500e-02],
         [ 5.0009e-02,  6.4395e-02],
         [ 5.0009e-02,  3.9563e-02],
         [ 5.0009e-02,  4.7981e-02],
         [ 5.0009e-02,  2.8468e-02],
         [ 5.0009e-02,  5.5470e-02],
         [ 5.0009e-02,  6.8301e-02],
         [ 5.0009e-02,  3.9144e-02],
         [ 5.0009e-02,  5.8649e-02],
         [ 5.0009e-02,  3.4613e-02],
         [ 5.0009e-02,  5.2754e-02],
         [ 5.0009e-02,  2.9458e-02],
         [ 5.0009e-02,  5.2530e-02],
         [ 5.0009e-02,  4.4515e-02],
         [ 5.0009e-02,  5.2088e-02],
         [ 5.0009e-02,  6.3071e-02],
         [ 5.0009e-02,  4.1977e-02],
         [ 5.0009e-02,  5.9187e-02],
         [ 5.0009e-02,  1.0200e-01],
         [ 5.0009e-02,  1.1894e-01],
         [ 5.0009e-02,  1.2899e-01],
         [ 5.0009e-02,  1.3685e-01],
         [ 5.0009e-02,  1.4194e-01],
         [ 5.0009e-02,  1.4333e-01],
         [ 5.0009e-02,  1.4260e-01],
         [ 5.0009e-02,  8.4832e-02],
         [ 5.0009e-02,  5.9484e-02],
         [ 5.0009e-02,  6.4184e-02],
         [ 5.0009e-02,  3.6908e-02],
         [ 5.0009e-02,  4.0710e-02],
         [ 5.0009e-02, -1.2710e-01],
         [ 5.0009e-02,  5.9927e-02],
         [ 5.0009e-02, -1.1674e-01],
         [ 5.0009e-02,  6.1141e-02],
         [ 5.0009e-02, -1.1046e-01],
         [ 5.0009e-02,  5.3609e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.5070e-06, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0004, device='cuda:0')
mixer_td_error tensor(0.3622, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4632, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3747, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0551, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1798, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0355, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1461538.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1872, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.3059e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1490, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2001, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1490, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9413
target_mac_out tensor([[[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7175e-02,  8.1043e-02,  ...,  2.3772e-02,
            1.2601e-01, -1.0000e+07],
          [-1.0000e+07, -3.0851e-02,  1.2640e-01,  ...,  1.8911e-02,
            1.4901e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3968e-02,  1.0288e-01,  ...,  4.2058e-02,
            1.5994e-01, -1.0000e+07],
          [-1.0000e+07, -2.7312e-02,  1.2249e-01,  ..., -4.1138e-03,
            1.4328e-01, -1.0000e+07]],

         ...,

         [[ 5.0006e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4190e-01,  7.7815e-02,  ...,  4.5801e-02,
            1.9438e-01, -3.0147e-01]],

         [[ 5.0007e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4717e-01,  8.1833e-02,  ...,  4.5655e-02,
            1.9854e-01, -3.0290e-01]],

         [[ 5.0007e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.5325e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2685e-01,  1.2531e-01,  ...,  5.6976e-02,
            1.5537e-01, -1.0000e+07],
          [-1.0000e+07, -4.3705e-02,  1.3064e-01,  ...,  2.3492e-02,
            1.4040e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.5273e-01,  1.3203e-01,  ...,  6.9187e-02,
            1.6531e-01, -1.0000e+07],
          [-1.0000e+07, -5.7402e-02,  1.4496e-01,  ...,  6.9303e-03,
            1.5600e-01, -1.0000e+07]],

         ...,

         [[-5.4720e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5144e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 3.4876e-02,  1.0699e-01],
         [ 8.1043e-02,  1.2640e-01],
         [ 1.0288e-01,  1.2249e-01],
         [ 1.1553e-01,  9.9773e-02],
         [ 7.0756e-02,  1.0244e-01],
         [ 5.2922e-02,  1.2480e-01],
         [ 4.9486e-02,  9.8743e-02],
         [ 1.1031e-01,  1.0269e-01],
         [ 1.0219e-01,  1.2862e-01],
         [ 3.9113e-02,  1.3757e-01],
         [ 4.7633e-02,  1.6846e-01],
         [ 1.3120e-01,  1.7501e-01],
         [ 1.4537e-01,  1.3935e-01],
         [ 1.6311e-01,  1.2787e-01],
         [ 9.2758e-02,  1.0447e-01],
         [ 9.0394e-02,  9.3771e-02],
         [ 1.6869e-01,  1.0476e-01],
         [ 9.4000e-02,  1.3519e-01],
         [ 6.0652e-02,  1.1437e-01],
         [-1.4116e-01,  9.5838e-02],
         [-1.4438e-01,  1.5028e-01],
         [-1.4144e-01,  1.6731e-01],
         [-1.5776e-01,  1.5707e-01],
         [ 6.2367e-02,  1.3139e-01],
         [-6.9574e-03,  1.2520e-01],
         [ 2.2558e-02,  8.3195e-02],
         [ 3.8409e-02,  4.8135e-02],
         [ 4.5885e-02, -1.8422e-01],
         [ 4.9005e-02,  5.7037e-02],
         [ 5.0101e-02,  4.8652e-02],
         [ 5.0365e-02,  5.2045e-02],
         [ 5.0330e-02,  7.1487e-02],
         [ 5.0222e-02,  8.6209e-02],
         [ 5.0149e-02,  1.0217e-01],
         [ 5.0067e-02,  7.1009e-02],
         [ 5.0044e-02,  8.7310e-02],
         [ 5.0028e-02,  5.3849e-02],
         [ 5.0015e-02,  5.3954e-02],
         [ 5.0018e-02,  8.2849e-02],
         [ 5.0030e-02,  9.6745e-02],
         [ 5.0021e-02,  6.1564e-02],
         [ 5.0014e-02,  4.8652e-02],
         [ 5.0015e-02, -1.5390e-01],
         [ 5.0013e-02, -1.3433e-01],
         [ 5.0018e-02,  6.6798e-02],
         [ 5.0006e-02,  7.7815e-02],
         [ 5.0007e-02,  8.1833e-02],
         [ 5.0007e-02,  1.5325e-02]],

        [[ 9.7167e-02,  1.3964e-01],
         [ 1.2531e-01,  1.3064e-01],
         [ 1.3203e-01,  1.4496e-01],
         [ 1.2596e-01,  1.2948e-01],
         [ 1.2857e-01,  1.6107e-01],
         [ 1.3187e-01,  1.6400e-01],
         [ 1.5178e-01,  1.6787e-01],
         [ 1.5199e-01,  1.3780e-01],
         [ 1.6062e-01,  1.1280e-01],
         [ 1.4569e-01,  1.5903e-01],
         [ 1.4757e-01,  1.6745e-01],
         [ 5.9694e-02,  1.7520e-01],
         [ 7.0909e-02,  1.5232e-01],
         [ 4.5579e-02,  1.7154e-01],
         [ 1.0736e-01,  1.8412e-01],
         [ 1.1157e-01,  1.8441e-01],
         [ 1.3150e-01,  1.3735e-01],
         [ 1.4223e-01,  1.3182e-01],
         [ 1.6024e-01,  1.6434e-01],
         [ 9.5186e-02,  1.4521e-01],
         [ 1.4873e-01,  1.7104e-01],
         [ 1.1818e-01,  1.8520e-01],
         [ 1.3619e-01,  1.5817e-01],
         [ 1.3234e-01,  1.6599e-01],
         [ 1.2923e-01,  1.7776e-01],
         [ 1.3196e-01,  1.3014e-01],
         [ 9.6369e-02,  1.5908e-01],
         [ 6.8136e-02, -1.5204e-01],
         [ 1.1903e-01,  9.3231e-02],
         [ 1.4110e-01,  1.2322e-01],
         [ 1.1448e-01,  1.3126e-01],
         [ 1.2788e-01,  1.5375e-01],
         [ 9.3069e-02, -1.5280e-01],
         [ 1.2797e-01, -1.3991e-01],
         [ 1.4460e-01, -8.3475e-03],
         [ 1.3483e-01,  2.5676e-02],
         [ 1.4555e-01,  4.2396e-02],
         [ 1.5035e-01,  4.9955e-02],
         [ 1.4960e-01,  5.3175e-02],
         [ 1.3873e-01,  5.4463e-02],
         [ 9.9860e-02,  5.4920e-02],
         [ 1.2687e-01,  5.5067e-02],
         [ 9.2817e-02,  5.5112e-02],
         [ 7.6580e-02,  5.5138e-02],
         [ 6.7404e-02,  5.5125e-02],
         [-5.4720e-03,  5.5144e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.3750e-05, device='cuda:0') tensor(0.0018, device='cuda:0') tensor(-0.0032, device='cuda:0')
mixer_td_error tensor(0.0470, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4597, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7097, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0642, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1791, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0388, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-208333.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1852, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0020, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1451, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2661, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1451, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9459
target_mac_out tensor([[[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2685e-01,  1.2531e-01,  ...,  5.6976e-02,
            1.5537e-01, -1.0000e+07],
          [-1.0000e+07, -4.3705e-02,  1.3064e-01,  ...,  2.3492e-02,
            1.4040e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.5273e-01,  1.3203e-01,  ...,  6.9187e-02,
            1.6531e-01, -1.0000e+07],
          [-1.0000e+07, -5.7402e-02,  1.4496e-01,  ...,  6.9303e-03,
            1.5600e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.8799e-02,  1.1017e-01,  ...,  6.1516e-02,
            1.3971e-01, -1.0000e+07],
          [-1.0000e+07, -2.8322e-02,  1.2490e-01,  ...,  1.4773e-02,
            1.3610e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3357e-02,  7.6576e-02,  ...,  4.4627e-02,
            1.3934e-01, -1.0000e+07],
          [-1.0000e+07, -2.5884e-02,  1.2689e-01,  ..., -4.2544e-03,
            1.3727e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.9090e-02,  5.8755e-02,  ...,  3.9416e-02,
            1.3901e-01, -1.0000e+07],
          [-1.0000e+07, -2.5911e-02,  1.2652e-01,  ..., -1.9137e-02,
            1.3974e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.5541e-01,  8.3715e-02,  ...,  4.9574e-02,
            1.4720e-01, -1.0000e+07],
          [ 5.5643e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.8508e-01,  1.0102e-01,  ...,  6.5255e-02,
            1.6698e-01, -1.0000e+07],
          [ 5.5543e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-3.4857e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5415e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.7167e-02,  1.3964e-01],
         [ 1.2531e-01,  1.3064e-01],
         [ 1.3203e-01,  1.4496e-01],
         [ 1.2596e-01,  1.2948e-01],
         [ 1.2857e-01,  1.6107e-01],
         [ 1.3187e-01,  1.6400e-01],
         [ 1.5178e-01,  1.6787e-01],
         [ 1.5199e-01,  1.3780e-01],
         [ 1.6062e-01,  1.1280e-01],
         [ 1.4569e-01,  1.5903e-01],
         [ 1.4757e-01,  1.6745e-01],
         [ 5.9694e-02,  1.7520e-01],
         [ 7.0909e-02, -1.3232e-01],
         [ 4.5579e-02,  1.7154e-01],
         [ 1.0736e-01,  1.8412e-01],
         [ 1.1157e-01,  1.8441e-01],
         [ 1.3150e-01,  1.3735e-01],
         [ 1.4223e-01,  1.3182e-01],
         [ 1.6024e-01,  1.6434e-01],
         [ 9.5186e-02,  1.4521e-01],
         [ 1.4873e-01,  1.7104e-01],
         [ 1.1818e-01,  1.8520e-01],
         [ 1.3619e-01,  1.5817e-01],
         [ 1.3234e-01,  1.6599e-01],
         [ 1.2923e-01,  1.7776e-01],
         [ 1.3196e-01,  1.3014e-01],
         [ 9.6369e-02,  1.5908e-01],
         [ 6.8136e-02, -1.5204e-01],
         [ 1.1903e-01, -1.4597e-01],
         [ 1.4110e-01,  1.2322e-01],
         [ 1.1448e-01,  1.3126e-01],
         [ 1.2788e-01,  1.5375e-01],
         [ 9.3069e-02, -1.5280e-01],
         [ 1.2797e-01, -1.3991e-01],
         [ 1.4460e-01, -8.3475e-03],
         [ 1.3483e-01,  2.5676e-02],
         [ 1.4555e-01,  4.2396e-02],
         [ 1.5035e-01,  4.9955e-02],
         [ 1.4960e-01,  5.3175e-02],
         [ 1.3873e-01,  5.4463e-02],
         [ 9.9860e-02,  5.4920e-02],
         [ 1.2687e-01,  5.5067e-02],
         [ 9.2817e-02,  5.5112e-02],
         [ 7.6580e-02,  5.5138e-02],
         [ 6.7404e-02,  5.5125e-02],
         [-5.4720e-03,  5.5144e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.1017e-01,  1.2490e-01],
         [ 4.4627e-02,  1.2689e-01],
         [ 3.9416e-02,  1.2652e-01],
         [ 2.8149e-02,  1.4016e-01],
         [ 9.7377e-02,  1.2443e-01],
         [ 9.1265e-02,  1.0546e-01],
         [ 9.0258e-02,  1.2260e-01],
         [ 1.7980e-02, -5.9637e-02],
         [ 1.0173e-01, -6.1765e-02],
         [ 1.1362e-01, -7.7556e-02],
         [ 1.1453e-01,  1.3216e-01],
         [ 9.0659e-02,  1.4369e-01],
         [ 1.1898e-01,  1.2355e-01],
         [ 1.0675e-01,  1.1615e-01],
         [ 1.0052e-01,  1.1174e-01],
         [ 9.6374e-02,  1.3320e-01],
         [ 1.2098e-01,  1.5047e-01],
         [ 1.1359e-01, -1.3640e-01],
         [ 1.3350e-01,  8.0978e-02],
         [ 1.4640e-01, -1.4455e-01],
         [ 1.1619e-01,  6.5704e-02],
         [ 9.2573e-02,  6.4320e-02],
         [ 1.1584e-01,  9.9201e-02],
         [ 1.0966e-01,  1.1802e-01],
         [ 8.6072e-02,  6.8494e-02],
         [ 1.0683e-01,  9.9457e-02],
         [ 1.0230e-01,  6.1851e-02],
         [ 4.8278e-02,  1.3665e-01],
         [ 6.0017e-02,  1.2979e-01],
         [ 6.5224e-02,  1.7145e-01],
         [ 1.0459e-01,  1.3897e-01],
         [ 1.3237e-01, -1.7954e-01],
         [ 1.1212e-01, -1.5940e-01],
         [ 1.1680e-01,  1.1592e-01],
         [ 1.5335e-01,  1.1074e-01],
         [ 1.2648e-01,  1.1028e-01],
         [ 5.0138e-02,  1.3994e-01],
         [ 1.0498e-01,  1.1687e-01],
         [ 1.2999e-01,  1.4187e-01],
         [ 1.6023e-01,  1.1625e-01],
         [ 1.7786e-01,  1.2838e-01],
         [ 1.3986e-01,  1.5269e-01],
         [ 1.2664e-01, -1.3795e-01],
         [ 1.2916e-01, -1.4397e-01],
         [ 1.0589e-01, -1.3949e-01],
         [ 1.3291e-01, -1.1716e-01],
         [ 1.4468e-01,  5.0993e-03],
         [ 1.0870e-01,  3.1411e-02],
         [ 1.0849e-01,  4.5714e-02],
         [ 6.0736e-02,  5.2212e-02],
         [ 9.6770e-02,  5.4775e-02],
         [ 6.4718e-02,  5.5544e-02],
         [ 8.3715e-02,  5.5643e-02],
         [ 1.0102e-01,  5.5543e-02],
         [-3.4857e-03,  5.5415e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(7.3988e-06, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0021, device='cuda:0')
mixer_td_error tensor(0.2069, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4587, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4068, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0734, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1696, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0349, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-818181.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1852, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.9565e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1333, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2646, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1333, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9504
target_mac_out tensor([[[[-1.0000e+07, -3.8669e-02,  6.6123e-02,  ...,  3.1808e-02,
            1.1543e-01, -1.0000e+07],
          [-1.0000e+07, -1.7411e-02,  9.1207e-02,  ..., -1.4688e-02,
            1.2647e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.4455e-02,  7.5856e-02,  ..., -1.4145e-05,
            1.2524e-01, -1.0000e+07],
          [-1.0000e+07, -2.7500e-02,  1.2427e-01,  ..., -1.2084e-02,
            1.4531e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.7291e-02,  8.7584e-02,  ...,  2.0094e-02,
            1.2978e-01, -1.0000e+07],
          [-1.0000e+07, -3.5027e-02,  1.4061e-01,  ..., -1.4446e-02,
            1.5624e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -9.8607e-02,  1.5511e-01,  ...,  4.5435e-02,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0997e-01,  1.7317e-01,  ...,  6.7116e-02,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.4572e-01,  1.3015e-01,  ...,  5.3074e-02,
            1.7131e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.1908e-02,  7.1628e-02,  ...,  3.0978e-03,
            1.2913e-01, -1.0000e+07],
          [-1.0000e+07, -3.1400e-02,  1.4762e-01,  ...,  2.0198e-03,
            1.5187e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7357e-02,  7.2546e-02,  ..., -1.2115e-02,
            1.4121e-01, -1.0000e+07],
          [-1.0000e+07, -3.8792e-02,  1.6292e-01,  ..., -7.4744e-03,
            1.6052e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 3.1808e-02,  9.1207e-02],
         [ 7.5856e-02,  1.2427e-01],
         [ 2.0094e-02,  1.4061e-01],
         ...,
         [ 1.5511e-01,  5.5231e-02],
         [ 1.7317e-01,  5.5231e-02],
         [ 1.3015e-01,  5.5231e-02]],

        [[ 3.3330e-02,  1.2351e-01],
         [ 7.1628e-02,  1.4762e-01],
         [ 7.2546e-02,  1.6292e-01],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.1481e-05, device='cuda:0') tensor(0.0004, device='cuda:0') tensor(-0.0003, device='cuda:0')
mixer_td_error tensor(0.5330, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4770, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3475, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0730, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2048, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0307, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2099999.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2333, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.0566e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1623, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2458, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1623, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9552
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2225e-02,  6.2394e-02,  ...,  2.0084e-02,
            1.2912e-01, -1.0000e+07],
          [-1.0000e+07, -7.7190e-02,  1.6041e-01,  ...,  7.2365e-02,
            1.5573e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.0171e-02,  4.6061e-02,  ...,  4.1223e-02,
            1.3816e-01, -1.0000e+07],
          [-1.0000e+07, -1.2417e-01,  1.0542e-01,  ...,  6.0142e-02,
            1.7534e-01, -1.0000e+07]],

         ...,

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3740e-01,  4.1005e-02,  ...,  3.3463e-02,
            2.0037e-01, -1.0000e+07]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.2245e-01,  2.2864e-02,  ...,  1.2143e-02,
            1.9666e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.2287e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.1854e-02,  7.0055e-02,  ...,  1.2276e-02,
            1.5385e-01, -1.0000e+07],
          [-1.0000e+07, -3.4827e-02,  6.7545e-02,  ...,  7.2149e-03,
            1.6403e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.1132e-02,  8.8784e-02,  ...,  5.2829e-02,
            1.9024e-01, -1.0000e+07],
          [-1.0000e+07, -4.8099e-02,  3.2742e-02,  ...,  2.3593e-02,
            1.7144e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.4276e-02,  1.4162e-01],
         [-6.2225e-02, -7.7190e-02],
         [-5.0171e-02, -1.2417e-01],
         [-5.5750e-02,  9.9757e-02],
         [-6.0333e-02,  1.0032e-01],
         [-4.5322e-02,  1.1083e-01],
         [-5.4950e-02,  8.8379e-02],
         [-7.1698e-02, -1.9488e-01],
         [ 1.0315e-01, -1.6529e-01],
         [-8.8833e-02,  7.0947e-02],
         [-8.6353e-02, -1.5952e-01],
         [-9.3121e-02,  6.7105e-02],
         [-1.0690e-01, -1.0543e-01],
         [-1.1034e-01, -8.6728e-02],
         [ 1.0189e-01, -7.3845e-02],
         [ 1.0957e-01, -8.3828e-02],
         [-1.1353e-01, -8.6107e-02],
         [ 1.0969e-01, -1.1008e-01],
         [ 1.1634e-01, -9.6470e-02],
         [-1.1104e-01, -1.1788e-01],
         [-9.6136e-02, -9.7966e-02],
         [-8.1049e-02, -9.0314e-02],
         [-6.6191e-02, -8.6038e-02],
         [ 1.2084e-01, -9.1300e-02],
         [-7.0868e-02, -8.2171e-02],
         [ 1.1740e-01,  1.2457e-01],
         [-8.4688e-02, -8.6714e-02],
         [-8.0745e-02, -1.2155e-01],
         [-8.2549e-02, -1.0604e-01],
         [ 1.2564e-01, -1.2388e-01],
         [ 1.3462e-01, -1.3454e-01],
         [ 1.2062e-01, -1.0901e-01],
         [-6.8257e-02, -1.0784e-01],
         [-6.2877e-02, -1.3352e-01],
         [-7.9941e-02, -1.0942e-01],
         [-6.9004e-02, -1.1358e-01],
         [-6.1038e-02, -9.8990e-02],
         [-4.6700e-02, -8.5677e-02],
         [-4.0838e-02, -9.0660e-02],
         [-4.2937e-02, -7.3351e-02],
         [-6.2249e-02, -6.9499e-02],
         [ 1.4719e-01, -6.8537e-02],
         [ 1.5098e-01,  1.1294e-01],
         [ 1.4491e-01,  1.1886e-01],
         [ 1.4630e-01, -9.4505e-02],
         [-6.1602e-02, -8.3677e-02],
         [ 1.3517e-01, -9.3405e-02],
         [-6.3625e-02, -8.2644e-02],
         [-5.7862e-02, -8.0513e-02],
         [-6.1121e-02, -8.8742e-02],
         [-4.8498e-02, -8.1731e-02],
         [ 1.2033e-01, -7.8955e-02],
         [-4.6674e-02, -8.0622e-02],
         [ 1.2669e-01, -6.9637e-02],
         [ 1.3654e-01, -1.0627e-01],
         [ 1.4457e-01, -1.1495e-01],
         [-7.6806e-02, -1.3333e-01],
         [ 1.3258e-01, -1.4517e-01],
         [-7.6624e-02, -1.2105e-01],
         [ 1.3642e-01, -1.1305e-01],
         [ 1.4824e-01, -1.0185e-01],
         [ 1.5449e-01, -1.0816e-01],
         [ 1.5433e-01, -1.2705e-01],
         [ 1.7276e-01, -1.5509e-01],
         [ 1.7542e-01, -1.3494e-01],
         [ 1.5339e-01, -1.6029e-01],
         [ 1.7310e-01, -1.5219e-01],
         [ 1.9181e-01,  1.2856e-01],
         [ 1.4465e-01, -1.5636e-01],
         [ 1.4087e-01, -1.4369e-01],
         [-1.5489e-01,  9.4826e-02],
         [ 1.5315e-01,  1.0419e-01],
         [ 1.6759e-01,  1.1759e-01],
         [ 1.7295e-01,  1.0442e-01],
         [ 1.8473e-01,  7.3958e-02],
         [ 1.5782e-01, -1.6418e-01],
         [-1.6513e-01, -1.4819e-01],
         [ 1.6038e-01,  6.1309e-02],
         [-1.5843e-01, -1.3339e-01],
         [-1.7556e-01,  5.7766e-02],
         [-1.5276e-01,  9.3304e-02],
         [ 1.8657e-01,  1.4008e-01],
         [ 1.9861e-01,  1.6050e-01],
         [-1.5705e-01,  1.5866e-01],
         [ 3.7360e-03,  1.4849e-01],
         [ 2.4588e-02,  1.4539e-01],
         [ 3.7796e-02,  1.4573e-01],
         [ 4.4747e-02,  1.5611e-01],
         [ 4.8003e-02, -5.4810e-02],
         [ 4.9379e-02,  1.4921e-01],
         [ 4.9888e-02,  1.5403e-01],
         [ 5.0033e-02,  1.7582e-01],
         [ 5.0053e-02, -5.2941e-02],
         [ 5.0057e-02, -3.8881e-02],
         [ 5.0038e-02,  1.4044e-01],
         [ 5.0012e-02,  1.5908e-01],
         [ 5.0025e-02,  1.2157e-01],
         [ 5.0015e-02,  1.4436e-01],
         [ 5.0025e-02,  1.5183e-01],
         [ 5.0020e-02,  1.6311e-01],
         [ 5.0021e-02,  1.8162e-01],
         [ 5.0018e-02, -9.2120e-02],
         [ 5.0025e-02,  1.0133e-01],
         [ 5.0018e-02,  8.6351e-02],
         [ 5.0009e-02, -1.5709e-01],
         [ 5.0019e-02, -1.5732e-01],
         [ 5.0005e-02, -1.4853e-01],
         [ 5.0007e-02,  6.7762e-02],
         [ 5.0008e-02,  9.7635e-02],
         [ 5.0008e-02, -1.5611e-01],
         [ 5.0008e-02, -1.3327e-01],
         [ 5.0009e-02, -1.4981e-01],
         [ 5.0008e-02, -1.4467e-01],
         [ 5.0008e-02, -1.6552e-01],
         [ 5.0008e-02, -1.5647e-01],
         [ 5.0008e-02, -1.3740e-01],
         [ 5.0008e-02, -1.2245e-01],
         [ 5.0009e-02,  1.2287e-02]],

        [[ 9.4778e-02,  1.0692e-01],
         [ 7.0055e-02, -3.4827e-02],
         [ 8.8784e-02, -4.8099e-02],
         [-7.1647e-02,  7.2555e-02],
         [-5.8568e-02,  8.8207e-02],
         [-4.2377e-02,  9.7911e-02],
         [-5.0031e-02,  1.0047e-01],
         [-5.6546e-02,  1.1810e-01],
         [-6.0774e-02,  1.2176e-01],
         [ 1.0824e-01,  1.2036e-01],
         [-6.3958e-02, -1.8044e-01],
         [-4.6377e-02,  8.4597e-02],
         [-5.4652e-02,  8.9025e-02],
         [-5.8301e-02, -2.2069e-01],
         [-7.2783e-02,  2.5063e-01],
         [-7.6206e-02,  2.5481e-01],
         [-5.6658e-02, -2.2878e-01],
         [-3.9714e-02,  7.5184e-02],
         [-5.0145e-02,  2.6591e-01],
         [-6.8357e-02, -2.1747e-01],
         [ 1.0471e-01, -2.0470e-01],
         [ 1.0542e-01,  9.0297e-02],
         [-9.2761e-02, -1.9794e-01],
         [-9.7158e-02, -1.9657e-01],
         [ 1.0297e-01, -1.9452e-01],
         [ 1.0423e-01, -2.1268e-01],
         [ 1.0421e-01, -2.0803e-01],
         [ 1.2166e-01, -1.7212e-01],
         [ 1.2566e-01, -1.6272e-01],
         [ 1.2680e-01,  1.4768e-02],
         [ 1.2714e-01,  3.6358e-02],
         [ 1.2721e-01,  4.7548e-02],
         [ 1.2736e-01,  5.2692e-02],
         [ 1.3334e-01,  5.4831e-02],
         [ 1.1711e-01,  5.5533e-02],
         [-1.7138e-01,  5.5678e-02],
         [ 1.1666e-01,  5.5605e-02],
         [ 1.4771e-01,  5.5473e-02],
         [ 1.1121e-01,  5.5379e-02],
         [ 1.2796e-01,  5.5305e-02],
         [ 1.4742e-01,  5.5271e-02],
         [ 1.5482e-01,  5.5242e-02],
         [ 1.5724e-01,  5.5227e-02],
         [ 1.1207e-01,  5.5237e-02],
         [ 1.3672e-01,  5.5225e-02],
         [ 1.4496e-01,  5.5199e-02],
         [ 1.0139e-01,  5.5218e-02],
         [ 8.9030e-02,  5.5219e-02],
         [-1.7114e-01,  5.5223e-02],
         [-1.5663e-01,  5.5231e-02],
         [-1.6766e-01,  5.5230e-02],
         [-1.6001e-01,  5.5230e-02],
         [ 6.7435e-03,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(7.6962e-05, device='cuda:0') tensor(0.0012, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.7260, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4625, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2908, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0683, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1708, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0288, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2754236.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2659, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.5009e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0007, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1801, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3371, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1801, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9646
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.3968e-02,  7.4645e-02,  ...,  2.6303e-02,
            1.3721e-01, -1.0000e+07],
          [-1.0000e+07, -3.0414e-02,  1.2473e-01,  ...,  3.3265e-02,
            1.4622e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.8974e-02,  9.2037e-02,  ...,  1.5111e-02,
            1.3979e-01, -1.0000e+07],
          [-1.0000e+07, -3.2213e-02,  9.7344e-02,  ...,  2.1619e-02,
            1.4951e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.9665e-02,  5.9675e-02,  ...,  1.7156e-02,
            1.3094e-01, -1.0000e+07],
          [-1.0000e+07, -6.0440e-02,  1.6172e-01,  ...,  4.7207e-02,
            1.5243e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3029e-02,  9.6897e-02,  ...,  4.0310e-02,
            1.5748e-01, -1.0000e+07],
          [-1.0000e+07, -8.1469e-02,  1.3480e-01,  ...,  1.5844e-02,
            1.5054e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.8873e-01,  8.8306e-02,  ...,  8.2151e-02,
            1.6087e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1272e-01,  1.1381e-01,  ...,  9.6378e-02,
            1.8654e-01, -3.3632e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-2.6373e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-7.2275e-02, -1.3772e-02],
         [-6.3968e-02, -3.0414e-02],
         [-6.8974e-02, -3.2213e-02],
         [-8.5159e-02, -2.6016e-02],
         [-9.7631e-02, -1.1071e-02],
         [-1.1061e-01, -1.2976e-02],
         [-9.7714e-02, -2.0851e-02],
         [-7.0813e-02, -2.2167e-02],
         [-8.0273e-02, -2.0794e-02],
         [-8.3353e-02, -2.7591e-02],
         [-1.1442e-01, -3.4694e-02],
         [-1.1232e-01, -5.2650e-02],
         [-1.4575e-01, -5.7400e-02],
         [-1.6222e-01, -7.0152e-02],
         [-1.6523e-01,  1.4533e-01],
         [-1.6753e-01, -9.1009e-02],
         [-1.5938e-01, -8.4897e-02],
         [-1.6614e-01, -8.3121e-02],
         [-1.7217e-01, -8.7480e-02],
         [-1.5902e-01,  1.2388e-01],
         [-1.6096e-01,  1.3361e-01],
         [ 1.5898e-01, -9.5096e-02],
         [-1.7717e-01, -1.1649e-01],
         [-1.9459e-01, -8.0266e-02],
         [ 1.2804e-01, -7.7271e-02],
         [-1.9488e-01, -5.0739e-02],
         [ 1.2436e-01, -4.1030e-02],
         [-2.0497e-01, -1.6888e-02],
         [-1.8052e-01, -2.6703e-02],
         [-1.9835e-01, -3.2534e-02],
         [-1.8612e-01, -3.6073e-02],
         [ 1.0637e-02, -5.4549e-02],
         [ 2.9036e-02, -3.8946e-02],
         [ 4.0193e-02, -2.1815e-02],
         [ 4.6018e-02, -1.2796e-02],
         [ 4.8754e-02,  1.3658e-02],
         [ 4.9875e-02,  1.7042e-02],
         [ 5.0239e-02,  1.2838e-02],
         [ 5.0276e-02, -1.2720e-02],
         [ 5.0246e-02, -2.6546e-02],
         [ 5.0184e-02, -3.3994e-02],
         [ 5.0107e-02, -5.4285e-02],
         [ 5.0074e-02, -7.0161e-02],
         [ 5.0040e-02, -6.6828e-02],
         [ 5.0046e-02, -7.5525e-02],
         [ 5.0018e-02, -8.2710e-02],
         [ 5.0016e-02, -6.7503e-02],
         [ 5.0032e-02, -7.4022e-02],
         [ 5.0012e-02, -8.1713e-02],
         [ 5.0016e-02, -6.6979e-02],
         [ 5.0015e-02, -7.3932e-02],
         [ 5.0013e-02, -6.1121e-02],
         [ 5.0005e-02, -7.7647e-02],
         [ 5.0007e-02, -7.2494e-02],
         [ 5.0007e-02, -8.1950e-02],
         [ 5.0007e-02, -4.5805e-02],
         [ 5.0008e-02, -3.5456e-02],
         [ 5.0008e-02, -3.0464e-02],
         [ 5.0008e-02, -8.0773e-03],
         [ 5.0008e-02, -1.8884e-02],
         [ 5.0008e-02, -3.1289e-03],
         [ 5.0008e-02, -1.8286e-02],
         [ 5.0008e-02, -2.4522e-02],
         [ 5.0009e-02,  1.6701e-01],
         [ 5.0009e-02, -4.5506e-02],
         [ 5.0009e-02, -8.1222e-02],
         [ 5.0009e-02, -9.9456e-02],
         [ 5.0009e-02, -1.1384e-01],
         [ 5.0009e-02, -1.3354e-01],
         [ 5.0009e-02, -1.4875e-01],
         [ 5.0009e-02, -1.3823e-01],
         [ 5.0009e-02, -1.3616e-01],
         [ 5.0009e-02, -1.5586e-01],
         [ 5.0009e-02, -1.6084e-01],
         [ 5.0009e-02, -1.5354e-01],
         [ 5.0009e-02, -1.7867e-01],
         [ 5.0009e-02, -1.5974e-01],
         [ 5.0009e-02, -1.4697e-01],
         [ 5.0009e-02, -1.3368e-01],
         [ 5.0009e-02, -8.6340e-02],
         [ 5.0009e-02, -7.8135e-02],
         [ 5.0009e-02, -1.0485e-01],
         [ 5.0009e-02, -1.2257e-01],
         [ 5.0009e-02, -1.2641e-01],
         [ 5.0009e-02, -1.2820e-01],
         [ 5.0009e-02, -1.3414e-01],
         [ 5.0009e-02, -1.2250e-01],
         [ 5.0009e-02,  3.8968e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.8723e-02, -2.2603e-02],
         [-5.9665e-02, -6.0440e-02],
         [-8.3029e-02, -8.1469e-02],
         [-7.1385e-02, -9.1608e-02],
         [-9.1036e-02, -1.1195e-01],
         [-3.4255e-02, -1.6244e-01],
         [-6.1731e-02, -1.6382e-01],
         [-9.8688e-02, -1.2402e-01],
         [-7.9815e-02, -1.4925e-01],
         [-9.5855e-02, -1.7143e-01],
         [-1.0758e-01, -1.9991e-01],
         [-1.0119e-01, -1.9652e-01],
         [-1.1274e-01, -2.2142e-01],
         [-1.0419e-01, -2.0869e-01],
         [-1.1397e-01, -2.0267e-01],
         [-7.9559e-02, -1.8805e-01],
         [-5.3724e-02, -1.8755e-01],
         [-5.8636e-02, -1.7156e-01],
         [-4.9792e-02, -1.6958e-01],
         [-3.5434e-02, -1.4747e-01],
         [-6.0288e-02, -1.6831e-01],
         [-4.3926e-02, -1.5916e-01],
         [-3.7946e-02, -1.6511e-01],
         [-5.8748e-02, -9.0589e-03],
         [-6.7788e-02,  2.9268e-02],
         [-7.3400e-02,  4.6055e-02],
         [-7.7715e-02,  5.2924e-02],
         [-9.1400e-02,  5.5413e-02],
         [-1.0292e-01,  5.6087e-02],
         [-1.3150e-01,  5.6049e-02],
         [-1.3075e-01,  5.5828e-02],
         [-9.9554e-02,  5.5592e-02],
         [-1.2549e-01,  5.5430e-02],
         [-1.4893e-01,  5.5317e-02],
         [-1.5967e-01,  5.5267e-02],
         [-1.3321e-01,  5.5215e-02],
         [-1.4216e-01,  5.5211e-02],
         [ 1.0416e-01,  5.5222e-02],
         [-1.1594e-01,  5.5202e-02],
         [-1.0765e-01,  5.5201e-02],
         [-8.5018e-02,  5.5205e-02],
         [-7.3465e-02,  5.5216e-02],
         [-8.3122e-02,  5.5229e-02],
         [-7.0459e-02,  5.5229e-02],
         [-8.5054e-02,  5.5230e-02],
         [-1.0306e-01,  5.5229e-02],
         [-1.0539e-01,  5.5232e-02],
         [-1.2458e-01,  5.5236e-02],
         [-9.7959e-02,  5.5235e-02],
         [-7.8004e-02,  5.5232e-02],
         [-9.9653e-02,  5.5232e-02],
         [-9.6312e-02,  5.5231e-02],
         [-7.7166e-02,  5.5231e-02],
         [-6.7918e-02,  5.5231e-02],
         [-5.8862e-02,  5.5231e-02],
         [-5.6729e-02,  5.5231e-02],
         [-5.5892e-02,  5.5231e-02],
         [-5.4805e-02,  5.5231e-02],
         [-5.3408e-02,  5.5231e-02],
         [-8.2850e-02,  5.5231e-02],
         [-8.4233e-02,  5.5231e-02],
         [-8.4251e-02,  5.5231e-02],
         [-1.0485e-01,  5.5231e-02],
         [-1.0587e-01,  5.5231e-02],
         [-1.0905e-01,  5.5231e-02],
         [-8.7596e-02,  5.5231e-02],
         [-7.6751e-02,  5.5231e-02],
         [-6.1696e-02,  5.5231e-02],
         [-6.7288e-02,  5.5231e-02],
         [-5.8775e-02,  5.5231e-02],
         [-5.1992e-02,  5.5231e-02],
         [-7.3542e-02,  5.5231e-02],
         [-7.5667e-02,  5.5231e-02],
         [-7.6744e-02,  5.5231e-02],
         [-7.7306e-02,  5.5231e-02],
         [-9.7009e-02,  5.5231e-02],
         [-9.2153e-02,  5.5231e-02],
         [-9.2230e-02,  5.5231e-02],
         [-1.0402e-01,  5.5231e-02],
         [-1.3048e-01,  5.5231e-02],
         [-1.4759e-01,  5.5231e-02],
         [-1.4482e-01,  5.5231e-02],
         [-1.4036e-01,  5.5231e-02],
         [-1.7137e-01,  5.5231e-02],
         [ 1.1919e-01,  5.5231e-02],
         [ 1.0911e-01,  5.5231e-02],
         [ 1.2506e-01,  5.5231e-02],
         [ 1.4812e-01,  5.5231e-02],
         [ 1.3746e-01,  5.5231e-02],
         [-2.3725e-01,  5.5231e-02],
         [-2.2940e-01,  5.5231e-02],
         [-2.2813e-01,  5.5231e-02],
         [-2.2711e-01,  5.5231e-02],
         [-2.1270e-01,  5.5231e-02],
         [-2.0684e-01,  5.5231e-02],
         [-2.1104e-01,  5.5231e-02],
         [-1.7905e-01,  5.5231e-02],
         [-1.5571e-01,  5.5231e-02],
         [-1.8873e-01,  5.5231e-02],
         [-2.1272e-01,  5.5231e-02],
         [-2.6373e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.7984e-05, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.1667, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4483, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4075, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0558, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1458, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0499, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-643564.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1670, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.6457e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1099, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3220, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1099, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9725
target_mac_out tensor([[[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.3231e-02,  8.0496e-02,  ...,  2.7923e-02,
            1.3305e-01, -1.0000e+07],
          [-1.0000e+07, -7.1417e-02,  1.2004e-01,  ...,  2.4416e-02,
            1.4860e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9630e-02,  1.0726e-01,  ...,  2.2145e-02,
            1.4804e-01, -1.0000e+07],
          [-1.0000e+07, -9.3495e-02,  1.4606e-01,  ...,  5.7287e-02,
            1.6459e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.7245e-02,  7.9477e-02,  ...,  3.3060e-02,
            1.4031e-01, -1.0000e+07],
          [-1.0000e+07, -1.3393e-02,  1.0346e-01,  ...,  1.0057e-02,
            1.4004e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.3125e-01,  6.3624e-02,  ...,  2.6348e-02,
            1.3662e-01, -1.0000e+07],
          [ 5.5229e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.4322e-01,  8.6051e-02,  ...,  2.6033e-02,
            1.5059e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.2040e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-7.5802e-02, -5.1416e-02],
         [-6.3231e-02, -7.1417e-02],
         [-8.9630e-02, -9.3495e-02],
         [-8.4679e-02, -9.5708e-02],
         [-7.6498e-02, -1.1342e-01],
         [-9.7749e-02, -1.2130e-01],
         [-8.7907e-02, -1.3181e-01],
         [-1.0804e-01, -1.3277e-01],
         [-1.1079e-01, -1.3793e-01],
         [-1.1133e-01, -1.2999e-01],
         [-1.1178e-01, -1.3665e-01],
         [-1.2312e-01, -1.4515e-01],
         [-1.4503e-01, -1.3654e-01],
         [-1.4010e-01, -1.3650e-01],
         [-1.4097e-01, -1.2191e-01],
         [-1.4635e-01, -1.1973e-01],
         [-1.4330e-01, -1.2117e-01],
         [-9.8757e-02, -1.1299e-01],
         [-9.1566e-02, -9.3883e-02],
         [-1.0352e-01, -9.0428e-02],
         [-1.2466e-01, -6.1941e-02],
         [-9.9327e-02, -3.3899e-03],
         [-1.0456e-01,  3.2344e-02],
         [-8.9938e-02,  4.7872e-02],
         [-1.0490e-01,  5.3895e-02],
         [-1.3139e-01,  5.5818e-02],
         [-1.1534e-01,  5.6140e-02],
         [-1.1827e-01,  5.5988e-02],
         [-7.4205e-02,  5.5728e-02],
         [-7.9622e-02,  5.5511e-02],
         [-9.6249e-02,  5.5376e-02],
         [-1.3786e-01,  5.5264e-02],
         [-1.2305e-01,  5.5241e-02],
         [-7.8002e-02,  5.5227e-02],
         [-5.6067e-02,  5.5225e-02],
         [-5.2042e-02,  5.5210e-02],
         [-6.6533e-02,  5.5204e-02],
         [-8.0200e-02,  5.5207e-02],
         [-8.9967e-02,  5.5214e-02],
         [-1.0647e-01,  5.5221e-02],
         [-1.4194e-01,  5.5218e-02],
         [-1.8951e-01,  5.5221e-02],
         [-1.5593e-01,  5.5232e-02],
         [-1.6115e-01,  5.5230e-02],
         [-1.2569e-01,  5.5230e-02],
         [-1.6798e-01,  5.5234e-02],
         [-2.1015e-01,  5.5235e-02],
         [ 1.4024e-01,  5.5235e-02],
         [-2.1239e-01,  5.5232e-02],
         [-1.9315e-01,  5.5232e-02],
         [-1.9284e-01,  5.5231e-02],
         [-1.7969e-01,  5.5231e-02],
         [-1.8092e-01,  5.5231e-02],
         [-1.8702e-01,  5.5231e-02],
         [-1.8741e-01,  5.5231e-02],
         [-1.5737e-01,  5.5231e-02],
         [-6.0612e-04,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-7.2275e-02, -1.3772e-02],
         [-6.7838e-02, -1.4399e-02],
         [-5.7245e-02, -1.3393e-02],
         [-5.9561e-02, -1.4934e-02],
         [-5.8676e-02, -9.8598e-03],
         [-5.3396e-02, -4.9519e-02],
         [-6.7908e-02, -3.6543e-02],
         [-7.6112e-02, -1.8267e-02],
         [-6.3318e-02, -1.6147e-02],
         [-5.6005e-02, -1.5380e-02],
         [-5.6666e-02, -3.0539e-02],
         [-2.0544e-02, -3.4293e-02],
         [-5.0392e-02, -3.4341e-02],
         [-7.1271e-02, -4.9212e-02],
         [-8.3782e-02, -6.5238e-02],
         [-5.0835e-02, -7.8552e-02],
         [-5.0672e-02, -8.5195e-02],
         [-5.4181e-02, -7.4532e-02],
         [-4.5298e-02, -8.1656e-02],
         [-1.7373e-02, -7.3473e-02],
         [-3.6655e-02, -1.1646e-01],
         [-6.4460e-02, -1.0385e-01],
         [-1.1404e-01, -1.1047e-01],
         [-1.3268e-01, -1.2380e-01],
         [-1.5103e-01, -1.2143e-01],
         [-1.5528e-01, -1.2234e-01],
         [-1.4986e-01, -1.5830e-01],
         [-1.7354e-01, -1.5532e-01],
         [-1.8436e-01, -1.9949e-01],
         [-2.1462e-01, -1.6920e-01],
         [-2.2296e-01, -1.5191e-01],
         [-2.1745e-01, -1.3592e-01],
         [-2.0641e-01, -1.2723e-01],
         [-1.8861e-01, -1.3664e-01],
         [-1.5744e-01, -1.6724e-01],
         [-1.5074e-01, -1.7934e-01],
         [-9.5712e-02, -1.8521e-01],
         [-1.0684e-01, -1.9139e-01],
         [-7.8159e-02, -1.7175e-01],
         [-8.2426e-02, -1.8505e-01],
         [-7.5717e-02, -1.6868e-01],
         [-8.2212e-02, -1.6263e-01],
         [-1.1251e-01,  2.9010e-02],
         [-1.3562e-01,  4.6689e-02],
         [-1.3536e-01,  5.3856e-02],
         [-1.5277e-01,  5.6210e-02],
         [-1.1622e-01,  5.6568e-02],
         [-1.3855e-01,  5.6340e-02],
         [-1.7011e-01,  5.5960e-02],
         [-1.4134e-01,  5.5660e-02],
         [-1.0986e-01,  5.5416e-02],
         [-1.3583e-01,  5.5306e-02],
         [-1.4710e-01,  5.5236e-02],
         [-1.7792e-01,  5.5216e-02],
         [-1.7988e-01,  5.5202e-02],
         [-1.8132e-01,  5.5176e-02],
         [-1.3777e-01,  5.5217e-02],
         [-9.8911e-02,  5.5210e-02],
         [-7.7241e-02,  5.5201e-02],
         [-9.5670e-02,  5.5195e-02],
         [-9.2756e-02,  5.5203e-02],
         [-1.2366e-01,  5.5221e-02],
         [-1.3125e-01,  5.5229e-02],
         [-1.4322e-01,  5.5231e-02],
         [ 1.2040e-02,  5.5230e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.4853e-05, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0024, device='cuda:0')
mixer_td_error tensor(0.1816, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4476, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4989, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0356, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1327, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0840, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-615384.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1402, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.5129e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1024, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2734, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1024, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9803
target_mac_out tensor([[[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.7422e-02,  8.6498e-02,  ...,  2.0309e-02,
            1.2644e-01, -1.0000e+07],
          [-1.0000e+07, -3.4692e-02,  1.3810e-01,  ...,  3.4424e-03,
            1.4959e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.5588e-02,  1.1308e-01,  ...,  3.7493e-02,
            1.5276e-01, -1.0000e+07],
          [-1.0000e+07, -4.4682e-02,  1.1460e-01,  ..., -3.0351e-02,
            1.4642e-01, -1.0000e+07]],

         ...,

         [[ 4.9268e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3213e-01,  7.4714e-02,  ...,  7.7072e-02,
            2.0661e-01, -1.0000e+07]],

         [[ 5.0123e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4517e-01,  8.0839e-02,  ...,  8.8541e-02,
            2.0606e-01, -1.0000e+07]],

         [[ 5.0325e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-5.0453e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.8475e-02,  8.3930e-02,  ...,  2.9168e-03,
            1.4114e-01, -1.0000e+07],
          [-1.0000e+07, -2.8572e-02,  1.0818e-01,  ...,  1.1152e-02,
            1.4585e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1306e-02,  8.6921e-02,  ..., -3.6412e-03,
            1.5129e-01, -1.0000e+07],
          [-1.0000e+07, -2.5687e-02,  1.0845e-01,  ...,  2.2908e-02,
            1.4218e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.3449e-02, -2.1358e-02],
         [-5.7422e-02, -3.4692e-02],
         [-7.5588e-02, -4.4682e-02],
         [-6.2272e-02, -4.7636e-02],
         [-4.7290e-02, -5.0358e-02],
         [-6.9826e-02, -8.2665e-02],
         [-6.5345e-02, -1.0036e-01],
         [-7.8601e-02, -1.0296e-01],
         [-9.5162e-02, -9.2660e-02],
         [-1.0723e-01, -1.1495e-01],
         [-1.1611e-01, -1.1121e-01],
         [-1.0263e-01, -1.3000e-01],
         [-8.6485e-02, -1.3629e-01],
         [-8.8273e-02, -1.3684e-01],
         [-1.0302e-01, -1.0747e-01],
         [-1.0131e-01, -9.2446e-02],
         [-1.2041e-01, -7.3572e-02],
         [-1.3303e-01, -7.7295e-02],
         [-1.1667e-01, -7.7865e-02],
         [-1.0488e-01, -7.2421e-02],
         [-1.1118e-01, -7.2946e-02],
         [-8.7912e-02, -1.0033e-01],
         [-7.1285e-02, -1.1458e-01],
         [-7.8355e-02, -1.2779e-01],
         [-8.1692e-02, -1.2991e-01],
         [-1.0269e-01, -1.3602e-01],
         [-1.0709e-01, -1.3221e-01],
         [-1.1031e-01, -1.1114e-01],
         [-1.1739e-01, -1.3002e-01],
         [-9.7434e-02, -1.3407e-01],
         [-1.0832e-01, -1.3055e-01],
         [-1.1300e-01, -1.1891e-01],
         [-1.1797e-01, -1.2371e-01],
         [-1.2167e-01, -1.2448e-01],
         [-1.2038e-01, -1.1930e-01],
         [-8.7208e-02, -9.5712e-02],
         [-1.1892e-01, -8.4030e-02],
         [-1.3435e-01, -8.1273e-02],
         [-1.5875e-01, -1.1354e-01],
         [-1.6657e-01, -1.0984e-01],
         [-1.7152e-01, -1.1183e-01],
         [-1.5601e-01, -1.0971e-01],
         [-1.8052e-01, -1.1768e-01],
         [-1.7501e-01, -1.4004e-01],
         [-1.7698e-01, -1.2532e-01],
         [-1.7500e-01, -1.2101e-01],
         [-1.8059e-01, -1.2170e-01],
         [-1.8400e-01, -1.1929e-01],
         [-1.8019e-01, -1.3071e-01],
         [-1.8207e-01, -1.3523e-01],
         [-1.7908e-01, -1.4366e-01],
         [-1.7034e-01, -1.5178e-01],
         [-1.7384e-01, -1.7844e-01],
         [-1.6078e-01, -1.7343e-01],
         [-1.4189e-01, -1.3810e-01],
         [-1.3954e-01, -1.2427e-01],
         [-1.4826e-01, -1.2073e-01],
         [ 2.6120e-03, -1.2622e-01],
         [ 2.8130e-02, -1.0230e-01],
         [ 4.0915e-02, -9.7566e-02],
         [ 4.6766e-02, -1.1446e-01],
         [ 4.9268e-02, -1.3213e-01],
         [ 5.0123e-02, -1.4517e-01],
         [ 5.0325e-02, -5.0453e-03]],

        [[-5.8723e-02, -2.2603e-02],
         [-6.8475e-02, -2.8572e-02],
         [-7.1306e-02, -2.5687e-02],
         [-5.9246e-02, -2.6092e-02],
         [-4.4252e-02, -2.4443e-02],
         [-3.1243e-02, -2.4662e-02],
         [-5.9564e-02, -1.0531e-02],
         [-7.7253e-02, -2.4002e-02],
         [-1.1867e-01, -3.5305e-02],
         [-1.2702e-01, -3.4533e-02],
         [-1.3871e-01, -3.7655e-02],
         [-1.4944e-01, -3.9152e-02],
         [-1.6386e-01, -2.3581e-02],
         [-1.7928e-01, -2.6467e-02],
         [-2.0193e-01, -5.3058e-02],
         [-1.9316e-01, -6.5972e-02],
         [-1.6742e-01, -7.0993e-02],
         [-1.6776e-01, -5.6819e-02],
         [-1.8624e-01, -3.2668e-02],
         [-2.0177e-01, -5.2921e-02],
         [-2.2299e-01, -3.9493e-02],
         [-1.9237e-01, -2.6359e-02],
         [-2.0745e-01, -9.9973e-03],
         [-1.9318e-01, -3.4250e-02],
         [-1.8240e-01, -6.0072e-02],
         [-1.5812e-01, -5.9977e-02],
         [-1.3864e-01, -5.5113e-02],
         [-1.3464e-01, -5.8082e-02],
         [-1.2815e-01, -4.7433e-02],
         [-1.1888e-01, -7.4025e-02],
         [-8.0289e-02, -8.7967e-02],
         [-5.3507e-02, -9.5626e-02],
         [-6.3456e-02, -1.3600e-01],
         [-6.5639e-02, -1.6223e-01],
         [-4.8570e-02, -1.8707e-01],
         [-4.2619e-02, -1.9457e-01],
         [-5.8962e-02, -1.8533e-01],
         [-9.3969e-02, -1.7629e-01],
         [-1.2953e-01, -1.9043e-01],
         [-1.5986e-01, -2.1644e-01],
         [-1.5812e-01, -2.1679e-01],
         [-1.5049e-01, -2.3257e-01],
         [-1.8062e-01, -2.1469e-01],
         [-1.9728e-01, -2.0462e-01],
         [-2.3234e-01, -1.7661e-01],
         [-2.0235e-01, -2.0172e-01],
         [-1.8034e-01, -2.0388e-01],
         [-1.7387e-01, -2.1442e-01],
         [-1.6536e-01, -2.0046e-01],
         [-1.4108e-01, -1.7924e-01],
         [ 1.4504e-02, -1.9652e-01],
         [ 3.2923e-02, -2.0624e-01],
         [ 4.2669e-02, -1.9803e-01],
         [ 4.7293e-02, -2.1157e-01],
         [ 4.9259e-02, -2.1419e-01],
         [ 4.9997e-02, -2.0695e-01],
         [ 5.0192e-02, -1.6841e-01],
         [ 5.0199e-02,  1.3414e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.6698e-06, device='cuda:0') tensor(0.0012, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.1189, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4460, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4113, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0005, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0880, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1110, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-468750.0312, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0503, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.0958e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0962, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2297, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0962, device='cuda:0', grad_fn=<MinBackward1>)
t_env 9994
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2714e-01,  1.2420e-01,  ...,  7.0546e-02,
            1.5857e-01, -1.0000e+07],
          [-1.0000e+07, -3.8311e-02,  1.3382e-01,  ...,  4.0568e-02,
            1.4396e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4124e-01,  1.2148e-01,  ...,  5.2743e-02,
            1.5640e-01, -1.0000e+07],
          [-1.0000e+07, -4.4101e-02,  1.1387e-01,  ...,  3.1959e-02,
            1.4699e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.8956e-01,  8.1104e-02,  ...,  8.0826e-02,
            2.1827e-01, -3.2595e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6913e-01,  3.3983e-02,  ...,  7.0350e-02,
            1.9429e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-7.5836e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.8397e-02,  1.2205e-01,  ...,  5.0119e-02,
            1.4587e-01, -1.0000e+07],
          [-1.0000e+07, -3.9020e-02,  1.1618e-01,  ..., -7.4191e-03,
            1.4128e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1971e-01,  1.2784e-01,  ...,  4.0002e-02,
            1.4336e-01, -1.0000e+07],
          [-1.0000e+07, -5.2764e-02,  1.3040e-01,  ..., -6.1400e-03,
            1.5020e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-9.5620e-02, -1.6811e-02],
         [-1.2714e-01, -3.8311e-02],
         [-1.4124e-01, -4.4101e-02],
         [-1.4871e-01, -6.2131e-02],
         [ 1.7770e-01, -6.5580e-02],
         [ 1.9121e-01, -6.5969e-02],
         [ 2.0466e-01, -6.2162e-02],
         [ 2.1298e-01, -7.6448e-02],
         [ 1.1058e-01, -5.6641e-02],
         [-2.0130e-01, -4.5811e-02],
         [-1.9475e-01, -5.5508e-02],
         [ 1.0789e-01, -6.6582e-02],
         [-2.1400e-01, -7.3897e-02],
         [-2.2184e-01, -6.5384e-02],
         [-1.9965e-01, -9.2545e-02],
         [-2.1033e-01, -1.2405e-01],
         [ 1.0544e-01, -1.5354e-01],
         [ 1.1552e-01, -9.5484e-02],
         [-1.8368e-01, -9.5794e-02],
         [-1.9262e-01, -8.0336e-02],
         [-1.8349e-01, -7.1523e-02],
         [-1.6329e-01, -8.5336e-02],
         [ 3.3602e-03, -9.1273e-02],
         [ 2.9334e-02, -9.4251e-02],
         [ 4.1687e-02, -9.5909e-02],
         [ 4.7262e-02, -8.0191e-02],
         [ 4.9526e-02, -7.7106e-02],
         [ 5.0302e-02, -1.0114e-01],
         [ 5.0450e-02, -1.5729e-01],
         [ 5.0377e-02,  2.0396e-01],
         [ 5.0258e-02, -8.3952e-02],
         [ 5.0170e-02, -8.6707e-02],
         [ 5.0082e-02, -7.8161e-02],
         [ 5.0056e-02, -1.7803e-01],
         [ 5.0041e-02,  2.0729e-01],
         [ 5.0034e-02,  2.2365e-01],
         [ 5.0018e-02,  2.1783e-01],
         [ 5.0013e-02,  2.2643e-01],
         [ 5.0012e-02, -1.9161e-01],
         [ 5.0011e-02,  2.1378e-01],
         [ 5.0013e-02,  2.2668e-01],
         [ 5.0014e-02,  2.0894e-01],
         [ 5.0016e-02,  2.2285e-01],
         [ 5.0008e-02,  2.2893e-01],
         [ 5.0008e-02, -1.7649e-01],
         [ 5.0007e-02,  2.2601e-01],
         [ 5.0007e-02,  2.3372e-01],
         [ 5.0008e-02,  2.1848e-01],
         [ 5.0008e-02,  2.0427e-01],
         [ 5.0008e-02,  2.1989e-01],
         [ 5.0008e-02,  2.1433e-01],
         [ 5.0008e-02, -1.6578e-01],
         [ 5.0008e-02,  2.3322e-01],
         [ 5.0008e-02,  2.3482e-01],
         [ 5.0009e-02, -1.9335e-01],
         [ 5.0009e-02, -1.9052e-01],
         [ 5.0009e-02, -2.0393e-01],
         [ 5.0009e-02, -1.8720e-01],
         [ 5.0009e-02, -1.7166e-01],
         [ 5.0009e-02, -1.8956e-01],
         [ 5.0009e-02, -1.6913e-01],
         [ 5.0009e-02, -7.5836e-04]],

        [[-4.8078e-02, -2.1879e-02],
         [-9.8397e-02, -3.9020e-02],
         [-1.1971e-01, -5.2764e-02],
         [-1.3183e-01, -9.7043e-02],
         [ 1.6419e-01, -1.1112e-01],
         [ 1.5823e-01, -1.3625e-01],
         [ 1.5367e-01, -1.3931e-01],
         [ 5.9959e-02, -1.3335e-01],
         [ 1.6244e-01, -7.1576e-02],
         [ 6.4306e-02, -1.1553e-01],
         [ 6.8332e-02, -1.1093e-01],
         [ 6.2824e-02, -1.2363e-01],
         [ 8.6789e-02, -1.4083e-01],
         [ 8.0345e-02, -1.4193e-01],
         [ 7.2143e-02, -1.4049e-01],
         [ 9.4897e-02, -1.5334e-01],
         [-1.9639e-01, -1.5394e-01],
         [ 9.4133e-02, -1.7145e-01],
         [ 7.8240e-02, -1.8714e-01],
         [-1.9891e-01, -1.8501e-01],
         [ 7.8103e-02, -1.1674e-01],
         [ 9.4627e-02, -1.0074e-01],
         [ 8.5366e-02, -1.5536e-01],
         [-8.9674e-02, -1.4047e-01],
         [-1.9139e-01, -1.4966e-01],
         [-2.1230e-01, -1.4863e-01],
         [-1.9712e-01, -1.3988e-01],
         [-1.8988e-01, -1.4137e-01],
         [-2.0452e-01, -1.4042e-01],
         [-7.8768e-02, -1.3789e-01],
         [-1.6723e-01, -1.2835e-01],
         [-9.2199e-02, -1.3958e-01],
         [-7.4965e-02, -1.4907e-01],
         [-1.4149e-01, -1.5130e-01],
         [-6.0387e-02, -1.4882e-01],
         [-6.9051e-02, -1.5597e-01],
         [-5.3865e-02, -1.5733e-01],
         [-1.4666e-02, -1.4577e-01],
         [ 1.7236e-02, -1.3945e-01],
         [ 3.4572e-02, -1.4955e-01],
         [ 4.3333e-02, -1.2807e-01],
         [ 4.7491e-02, -1.1811e-01],
         [ 4.9286e-02, -1.0250e-01],
         [ 4.9989e-02, -1.1406e-01],
         [ 5.0196e-02,  2.1439e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-5.6500e-05, device='cuda:0') tensor(0.0018, device='cuda:0') tensor(-0.0019, device='cuda:0')
mixer_td_error tensor(0.3059, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4478, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7741, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0073, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1013, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1649, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1370967.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2348, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.8430e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0013, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3097, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1927, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3097, device='cuda:0', grad_fn=<MinBackward1>)
t_env 10294
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2714e-01,  1.2420e-01,  ...,  7.0546e-02,
            1.5857e-01, -1.0000e+07],
          [-1.0000e+07, -3.8311e-02,  1.3382e-01,  ...,  4.0568e-02,
            1.4396e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4124e-01,  1.2148e-01,  ...,  5.2743e-02,
            1.5640e-01, -1.0000e+07],
          [-1.0000e+07, -4.4101e-02,  1.1387e-01,  ...,  3.1959e-02,
            1.4699e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.8956e-01,  8.1104e-02,  ...,  8.0826e-02,
            2.1827e-01, -3.2595e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6913e-01,  3.3983e-02,  ...,  7.0350e-02,
            1.9429e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-7.5836e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2569e-02,  8.7906e-02,  ...,  2.3893e-02,
            1.1855e-01, -1.0000e+07],
          [-1.0000e+07, -8.0652e-02,  1.5325e-01,  ...,  7.7602e-02,
            1.6031e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.5652e-02,  1.0565e-01,  ...,  1.8007e-02,
            1.4507e-01, -1.0000e+07],
          [-1.0000e+07, -8.3956e-02,  1.4261e-01,  ...,  5.7116e-02,
            1.5566e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.0687e-02,  1.3085e-01],
         [ 7.0546e-02,  1.4396e-01],
         [ 5.2743e-02, -1.0041e-01],
         [-1.4633e-01,  1.5107e-01],
         [ 1.7770e-01, -8.2848e-02],
         [ 1.9121e-01, -6.7801e-02],
         [ 2.0466e-01, -6.2162e-02],
         [ 1.2749e-01, -8.3232e-02],
         [ 1.1058e-01,  1.8111e-01],
         [ 9.2785e-02,  1.6758e-01],
         [ 8.7573e-02,  1.9338e-01],
         [ 1.0789e-01,  2.0759e-01],
         [ 6.6766e-02,  2.1502e-01],
         [ 6.4831e-02,  2.0178e-01],
         [ 5.9662e-02, -8.7023e-02],
         [ 8.8696e-02, -8.6029e-02],
         [ 1.0544e-01, -9.4938e-02],
         [ 1.1552e-01, -9.5484e-02],
         [-1.3335e-01, -9.5794e-02],
         [ 9.7189e-02, -8.0336e-02],
         [ 7.8031e-02, -7.1523e-02],
         [-1.2737e-01, -8.5336e-02],
         [ 3.3602e-03, -9.1273e-02],
         [ 2.9334e-02, -9.4251e-02],
         [ 4.1687e-02, -9.5909e-02],
         [ 4.7262e-02, -8.0191e-02],
         [ 4.9526e-02, -7.7106e-02],
         [ 5.0302e-02, -1.0114e-01],
         [ 5.0450e-02,  1.9992e-01],
         [ 5.0377e-02,  2.0396e-01],
         [ 5.0258e-02, -8.3952e-02],
         [ 5.0170e-02, -8.6707e-02],
         [ 5.0082e-02, -7.8161e-02],
         [ 5.0056e-02,  2.0931e-01],
         [ 5.0041e-02,  2.0729e-01],
         [ 5.0034e-02,  2.2365e-01],
         [ 5.0018e-02,  2.1783e-01],
         [ 5.0013e-02,  2.2643e-01],
         [ 5.0012e-02,  2.2672e-01],
         [ 5.0011e-02,  2.1378e-01],
         [ 5.0013e-02,  2.2668e-01],
         [ 5.0014e-02,  2.0894e-01],
         [ 5.0016e-02,  2.2285e-01],
         [ 5.0008e-02,  2.2893e-01],
         [ 5.0008e-02,  2.2917e-01],
         [ 5.0007e-02,  2.2601e-01],
         [ 5.0007e-02,  2.3372e-01],
         [ 5.0008e-02,  2.1848e-01],
         [ 5.0008e-02,  2.0427e-01],
         [ 5.0008e-02,  2.1989e-01],
         [ 5.0008e-02,  2.1433e-01],
         [ 5.0008e-02,  2.2390e-01],
         [ 5.0008e-02,  2.3322e-01],
         [ 5.0008e-02,  2.3482e-01],
         [ 5.0009e-02,  2.2779e-01],
         [ 5.0009e-02, -8.3714e-02],
         [ 5.0009e-02,  2.3099e-01],
         [ 5.0009e-02, -9.3399e-02],
         [ 5.0009e-02, -7.3106e-02],
         [ 5.0009e-02, -8.3346e-02],
         [ 5.0009e-02, -7.2545e-02],
         [ 5.0009e-02, -7.5836e-04]],

        [[ 3.5195e-02, -4.8984e-02],
         [ 1.1855e-01, -8.0652e-02],
         [ 1.4507e-01, -9.3246e-02],
         [ 1.3011e-01, -8.6180e-02],
         [ 1.3028e-01, -7.8050e-02],
         [ 1.4427e-01, -9.8189e-02],
         [ 1.3092e-01, -1.0076e-01],
         [ 1.4155e-01, -1.0768e-01],
         [ 6.5318e-02, -9.5692e-02],
         [ 7.4774e-02, -1.1262e-01],
         [-7.9505e-02, -1.0193e-01],
         [ 6.1653e-02, -8.3761e-02],
         [-7.1348e-02,  1.9059e-01],
         [-7.4291e-02,  1.9288e-01],
         [-5.9983e-02,  1.8248e-01],
         [-5.8937e-02,  1.8964e-01],
         [-7.6815e-02,  1.8520e-01],
         [-6.7831e-02,  1.9419e-01],
         [ 1.2612e-01,  2.0013e-01],
         [-8.6990e-02,  1.9743e-01],
         [-9.6324e-02, -9.3688e-02],
         [ 1.3139e-01, -7.7162e-02],
         [-7.8750e-02, -7.6782e-02],
         [-8.2890e-02, -7.3188e-02],
         [-8.7129e-02, -6.3536e-02],
         [-7.6824e-02, -5.9621e-02],
         [-8.5392e-02, -8.6379e-02],
         [-1.1355e-01, -8.2036e-02],
         [ 1.4163e-01, -6.7941e-02],
         [ 1.2521e-01, -8.3359e-02],
         [-1.0542e-01, -7.4238e-02],
         [-1.2231e-01, -7.0982e-02],
         [ 1.1800e-01, -7.1881e-02],
         [ 1.5052e-01, -7.1708e-02],
         [ 1.7761e-01, -2.0583e-02],
         [ 1.9125e-01,  2.1121e-02],
         [ 2.0327e-01,  4.1139e-02],
         [ 2.0933e-01,  5.0013e-02],
         [-1.2251e-01,  5.3649e-02],
         [ 2.0095e-01,  5.4989e-02],
         [ 1.9239e-01,  5.5372e-02],
         [ 9.1844e-02,  5.5418e-02],
         [ 9.2039e-02,  5.5400e-02],
         [ 2.0489e-01,  5.5328e-02],
         [ 1.9431e-01,  5.5259e-02],
         [ 1.8583e-01,  5.5233e-02],
         [ 9.3303e-02,  5.5210e-02],
         [ 6.6474e-02,  5.5212e-02],
         [ 1.1579e-01,  5.5213e-02],
         [ 1.2067e-01,  5.5188e-02],
         [ 6.6527e-02,  5.5206e-02],
         [ 1.9607e-01,  5.5219e-02],
         [ 8.7201e-02,  5.5206e-02],
         [-1.7483e-01,  5.5216e-02],
         [ 6.5110e-02,  5.5223e-02],
         [ 1.8398e-01,  5.5232e-02],
         [ 1.7406e-01,  5.5230e-02],
         [-1.4477e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0001, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0012, device='cuda:0')
mixer_td_error tensor(0.0242, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4508, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3974, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0051, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1022, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1368, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-322580.5625, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2348, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.3752e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)[INFO 10:09:13] my_main t_env: 10294 / 2050000
[INFO 10:09:13] my_main Estimated time left: 15 hours, 59 minutes, 10 seconds. Time passed: 4 minutes, 56 seconds

q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2951, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1247, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2951, device='cuda:0', grad_fn=<MinBackward1>)
[INFO 10:09:40] my_main Recent Stats | t_env:      10294 | Episode:      113
battle_won_mean:           0.0000	dead_allies_mean:          1.9866	dead_enemies_mean:         0.0000	ep_length_mean:           74.6964
epsilon:                   0.8101	mixer_grad_norm:           0.5269	mixer_loss:                0.0599	mixer_target_mean:        -0.0346
mixer_td_error_abs:        0.1823	q_grad_norm:               0.2512	q_loss:                    0.0345	q_q_taken_mean:           -0.0160
q_selected_weight_mean:    1.0000	q_td_error_abs:            0.1471	return_mean:               2.1782	return_std:                0.5932
reward_i_mean:            -0.1237	test_battle_won_mean:      0.0000	test_dead_allies_mean:     2.0000	test_dead_enemies_mean:    0.0000
test_ep_length_mean:      47.2656	test_return_mean:          0.0000	test_return_std:           0.0000	
t_env 10341
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0660e-01,  1.0891e-01,  ...,  4.0960e-02,
            1.4451e-01, -1.0000e+07],
          [-1.0000e+07, -1.8482e-02,  1.0351e-01,  ...,  3.3942e-02,
            1.3388e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8928e-02,  7.1365e-02,  ...,  2.7223e-02,
            1.4807e-01, -1.0000e+07],
          [-1.0000e+07, -6.4588e-03,  1.1091e-01,  ...,  1.4417e-02,
            1.1999e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -5.3589e-02,  1.3369e-01,  ...,  4.2509e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -6.3608e-02,  1.4634e-01,  ...,  5.5140e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.7686e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.3745e-02,  1.1397e-01,  ...,  6.2087e-02,
            1.3778e-01, -1.0000e+07],
          [-1.0000e+07, -2.4539e-02,  9.4233e-02,  ..., -1.0851e-02,
            1.2427e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.6842e-02,  9.2673e-02,  ...,  3.9973e-02,
            1.3230e-01, -1.0000e+07],
          [-1.0000e+07, -3.3041e-02,  9.0873e-02,  ..., -3.5459e-02,
            1.3338e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2516e-02,  1.1566e-01,  ...,  2.8046e-02,
            1.5267e-01, -1.0000e+07],
          [-1.0000e+07, -6.8894e-02,  1.3834e-01,  ...,  2.9285e-02,
            1.5445e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.0687e-02,  8.9914e-02],
         [-1.0660e-01,  1.0351e-01],
         [-9.3534e-02,  1.1091e-01],
         [-1.2201e-01,  1.3664e-01],
         [-9.0039e-02,  1.4697e-01],
         [-1.2644e-01,  1.3410e-01],
         [-1.2356e-01,  1.1105e-01],
         [-8.2020e-02,  1.0349e-01],
         [-8.2462e-02,  1.0143e-01],
         [ 9.5557e-02,  9.7142e-02],
         [ 1.0693e-01,  1.2286e-01],
         [ 9.5909e-02,  1.0741e-01],
         [-8.6190e-02,  1.3140e-01],
         [ 8.3277e-02,  1.4134e-01],
         [ 1.0789e-01,  1.6046e-01],
         [ 1.2220e-01,  1.3346e-01],
         [ 1.2203e-01, -7.2454e-02],
         [ 1.0645e-01,  1.2609e-01],
         [ 1.3163e-01,  1.2211e-01],
         [ 1.3612e-01,  1.0114e-01],
         [ 1.0972e-01, -6.8865e-02],
         [ 1.0088e-01,  8.8142e-02],
         [ 1.1610e-01,  1.3562e-01],
         [ 1.3325e-01,  1.5198e-01],
         [ 1.4066e-01,  1.4183e-01],
         [ 1.2262e-01,  9.1951e-02],
         [ 1.0962e-01,  9.7596e-02],
         [ 8.1806e-02,  6.2137e-02],
         [ 9.6653e-02,  7.2180e-02],
         [ 1.2296e-01,  8.2419e-02],
         [ 9.2967e-02,  4.5509e-02],
         [ 9.7192e-02,  2.1198e-02],
         [ 1.0872e-01,  9.1904e-02],
         [ 1.1913e-01,  9.4866e-02],
         [ 1.0491e-01,  9.7274e-02],
         [ 1.1757e-01,  1.0496e-01],
         [ 1.2348e-01,  1.2557e-01],
         [ 7.9301e-02,  1.2184e-01],
         [ 7.2027e-02,  8.3242e-02],
         [ 6.7933e-02,  8.3151e-02],
         [ 9.1154e-02,  2.3559e-01],
         [ 7.6238e-02,  2.1584e-01],
         [ 9.4505e-02,  7.0447e-02],
         [ 9.4086e-02,  6.0095e-02],
         [ 6.1796e-02,  9.9076e-02],
         [ 5.2681e-02,  5.6504e-02],
         [ 8.6235e-02,  8.5389e-02],
         [ 7.5013e-02,  9.1901e-02],
         [ 9.4536e-02,  1.0512e-01],
         [ 7.6552e-02,  9.8362e-02],
         [ 9.8397e-02,  9.4596e-02],
         [ 1.0604e-01,  6.4166e-02],
         [ 1.0807e-01,  9.8112e-02],
         [ 1.1879e-01,  1.0005e-01],
         [ 1.1360e-01,  8.3395e-02],
         [ 1.1549e-01,  1.0946e-01],
         [ 1.0928e-01,  1.2266e-01],
         [ 1.3305e-01,  1.0439e-01],
         [ 1.0559e-01,  8.5825e-02],
         [ 1.3164e-01,  1.1369e-01],
         [ 1.3856e-01,  9.5307e-02],
         [ 1.4407e-01,  1.1329e-01],
         [ 1.7035e-01,  1.2186e-01],
         [ 1.3371e-01,  8.8530e-02],
         [ 1.4009e-01,  7.1392e-02],
         [ 1.0089e-01,  7.2937e-02],
         [ 1.2762e-01,  8.9119e-02],
         [ 1.4125e-01,  9.5281e-02],
         [ 1.4634e-01,  1.0041e-01],
         [ 1.4501e-01,  9.6483e-02],
         [ 1.0114e-01,  7.5197e-02],
         [ 4.5363e-02, -6.6790e-02],
         [ 4.5874e-02, -5.1600e-02],
         [ 4.8161e-02,  4.7517e-02],
         [ 4.9559e-02,  2.9706e-02],
         [ 5.0116e-02,  5.2010e-02],
         [ 5.0224e-02,  6.0389e-02],
         [ 5.0164e-02,  4.6658e-02],
         [ 5.0077e-02,  1.3127e-02],
         [ 5.0000e-02,  4.4727e-02],
         [ 4.9980e-02,  1.6449e-02],
         [ 4.9969e-02,  2.9716e-02],
         [ 4.9963e-02,  2.0938e-02],
         [ 4.9972e-02,  1.6699e-02],
         [ 4.9979e-02,  1.4424e-02],
         [ 4.9996e-02,  4.1006e-02],
         [ 5.0000e-02,  3.3005e-02],
         [ 5.0017e-02,  4.6068e-02],
         [ 5.0009e-02,  3.6644e-02],
         [ 5.0016e-02,  2.1235e-02],
         [ 5.0019e-02,  4.7998e-02],
         [ 5.0012e-02,  6.0842e-02],
         [ 5.0012e-02,  3.5138e-02],
         [ 5.0006e-02,  5.3112e-02],
         [ 5.0008e-02,  9.6558e-02],
         [ 5.0008e-02,  5.5508e-02],
         [ 5.0008e-02,  5.3877e-02],
         [ 5.0008e-02,  9.2911e-02],
         [ 5.0008e-02,  7.2137e-02],
         [ 5.0008e-02,  7.1514e-02],
         [ 5.0008e-02,  7.2525e-02],
         [ 5.0008e-02,  7.3659e-02],
         [ 5.0008e-02,  5.1056e-02],
         [ 5.0008e-02,  6.2098e-02],
         [ 5.0009e-02,  6.7826e-02],
         [ 5.0009e-02,  7.0866e-02],
         [ 5.0009e-02,  7.2535e-02],
         [ 5.0009e-02,  4.0870e-02],
         [ 5.0009e-02,  5.4795e-02],
         [ 5.0009e-02,  6.4876e-02],
         [ 5.0009e-02,  4.2280e-02],
         [ 5.0009e-02,  5.4565e-02],
         [ 5.0009e-02,  1.0135e-01],
         [ 5.0009e-02,  1.2118e-01],
         [ 5.0009e-02,  8.6418e-02],
         [ 5.0009e-02,  7.8670e-02],
         [ 5.0009e-02,  1.1152e-01],
         [ 5.0009e-02,  1.2383e-01],
         [ 5.0009e-02,  1.2864e-01],
         [ 5.0009e-02,  1.3082e-01],
         [ 5.0009e-02,  6.9218e-02],
         [ 5.0009e-02,  6.1939e-02],
         [ 5.0009e-02,  1.0138e-01],
         [ 5.0009e-02,  1.2165e-01],
         [ 5.0009e-02,  1.3272e-01],
         [ 5.0009e-02,  1.3925e-01],
         [ 5.0009e-02,  7.2853e-02],
         [ 5.0009e-02,  6.9259e-02],
         [ 5.0009e-02,  8.2112e-02],
         [ 5.0009e-02,  3.0991e-02],
         [ 5.0009e-02,  7.1647e-02],
         [ 5.0009e-02,  5.1519e-02],
         [ 5.0009e-02,  5.9879e-02],
         [ 5.0009e-02, -7.2483e-02],
         [ 5.0009e-02,  9.7682e-03],
         [ 5.0009e-02,  4.7889e-02],
         [ 5.0009e-02,  1.0175e-01],
         [ 5.0009e-02,  1.2143e-01],
         [ 5.0009e-02,  1.3214e-01],
         [ 5.0009e-02,  1.4587e-01],
         [ 5.0009e-02,  1.0074e-01],
         [ 5.0009e-02,  1.2682e-01],
         [ 5.0009e-02,  1.3574e-01],
         [ 5.0009e-02,  1.4887e-01],
         [ 5.0009e-02,  1.4346e-01],
         [ 5.0009e-02,  1.5426e-01],
         [ 5.0009e-02,  1.0013e-01],
         [ 5.0009e-02,  1.3369e-01],
         [ 5.0009e-02,  1.4634e-01],
         [ 5.0009e-02,  2.7686e-02]],

        [[ 6.2087e-02,  9.4233e-02],
         [ 3.9973e-02,  9.0873e-02],
         [ 1.1566e-01,  1.3834e-01],
         [ 1.2599e-01,  1.5543e-01],
         [ 1.2628e-01, -1.0149e-01],
         [ 1.2609e-01,  1.4068e-01],
         [ 1.2796e-01,  1.2066e-01],
         [ 1.0094e-01,  1.2908e-01],
         [ 1.1155e-01,  9.5456e-02],
         [ 1.1914e-01,  1.2120e-01],
         [ 1.1983e-01,  1.6012e-01],
         [ 9.1219e-02,  1.6517e-01],
         [ 1.1746e-01,  1.7071e-01],
         [ 1.0647e-01,  1.7337e-01],
         [ 1.4824e-01,  1.7404e-01],
         [ 1.3109e-01,  1.1284e-01],
         [ 1.5942e-01,  7.4869e-02],
         [ 1.7645e-01,  7.4090e-02],
         [ 1.7798e-01,  8.5483e-02],
         [ 1.1862e-01,  8.8479e-02],
         [ 1.2384e-01,  8.4416e-02],
         [ 9.5371e-02,  6.1646e-02],
         [ 8.7212e-02,  1.2471e-01],
         [ 8.2537e-02,  1.3737e-01],
         [ 8.8421e-02, -1.2744e-02],
         [ 9.2946e-02,  2.4992e-02],
         [ 5.6442e-02,  4.2975e-02],
         [ 8.5469e-02,  5.0799e-02],
         [ 9.6315e-02,  5.3942e-02],
         [ 1.0306e-01,  5.5076e-02],
         [ 1.0542e-01,  5.5362e-02],
         [ 9.2387e-02,  5.5377e-02],
         [ 5.8234e-02,  5.5320e-02],
         [ 8.7394e-02,  5.5282e-02],
         [ 9.7848e-02,  5.5221e-02],
         [ 1.0148e-01,  5.5213e-02],
         [ 1.0267e-01,  5.5203e-02],
         [ 6.9409e-02,  5.5221e-02],
         [ 9.6171e-02,  5.5214e-02],
         [ 8.8667e-02,  5.5212e-02],
         [ 9.9609e-02,  5.5217e-02],
         [ 1.0450e-01,  5.5211e-02],
         [ 1.0665e-01,  5.5213e-02],
         [ 9.0677e-02,  5.5221e-02],
         [ 9.7477e-02,  5.5227e-02],
         [ 7.7093e-02,  5.5232e-02],
         [-4.7268e-02,  5.5230e-02],
         [ 7.5374e-02,  5.5230e-02],
         [ 5.9751e-02,  5.5231e-02],
         [ 8.6094e-02,  5.5236e-02],
         [ 7.2099e-02,  5.5235e-02],
         [-4.5243e-02,  5.5232e-02],
         [ 9.0170e-02,  5.5232e-02],
         [ 1.0194e-01,  5.5231e-02],
         [ 1.0603e-01,  5.5231e-02],
         [ 1.0525e-01,  5.5231e-02],
         [-5.3115e-02,  5.5231e-02],
         [ 9.8351e-02,  5.5231e-02],
         [ 1.0692e-01,  5.5231e-02],
         [ 1.0919e-01,  5.5231e-02],
         [ 1.0732e-01,  5.5231e-02],
         [ 1.0739e-01,  5.5231e-02],
         [ 9.3221e-02,  5.5231e-02],
         [ 1.0091e-01,  5.5231e-02],
         [ 7.9049e-02,  5.5231e-02],
         [ 1.1243e-01,  5.5231e-02],
         [ 1.2210e-01,  5.5231e-02],
         [ 1.0907e-01,  5.5231e-02],
         [ 8.9137e-02,  5.5231e-02],
         [ 1.1011e-01,  5.5231e-02],
         [ 1.2501e-01,  5.5231e-02],
         [ 1.4853e-01,  5.5231e-02],
         [ 9.3539e-02,  5.5231e-02],
         [ 1.3836e-01,  5.5231e-02],
         [ 1.3899e-01,  5.5231e-02],
         [ 1.5387e-01,  5.5231e-02],
         [ 1.5918e-01,  5.5231e-02],
         [ 1.5966e-01,  5.5231e-02],
         [ 1.4760e-01,  5.5231e-02],
         [ 1.4069e-01,  5.5231e-02],
         [ 1.0353e-01,  5.5231e-02],
         [ 1.0005e-01,  5.5231e-02],
         [ 1.1581e-01,  5.5231e-02],
         [ 8.3139e-02,  5.5231e-02],
         [ 1.0583e-01,  5.5231e-02],
         [ 7.4844e-02,  5.5231e-02],
         [ 9.6567e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.0650e-05, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.4952, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4584, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4815, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0300, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0961, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0709, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2099999.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2356, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.2971e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2333, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1096, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2333, device='cuda:0', grad_fn=<MinBackward1>)
t_env 10389
target_mac_out tensor([[[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9935e-02,  7.7646e-02,  ...,  3.1390e-02,
            1.3386e-01, -1.0000e+07],
          [-1.0000e+07, -8.0190e-02,  1.5693e-01,  ...,  7.6112e-02,
            1.5810e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.7343e-02,  1.0893e-01,  ...,  5.0269e-02,
            1.5882e-01, -1.0000e+07],
          [-1.0000e+07, -8.4950e-02,  1.5101e-01,  ...,  5.7346e-02,
            1.5028e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.3919e-02,  9.6747e-02,  ...,  2.7699e-02,
            1.4092e-01, -1.0000e+07],
          [-1.0000e+07, -2.4705e-02,  1.2426e-01,  ...,  1.4439e-02,
            1.3627e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.5817e-02,  1.0215e-01,  ...,  1.7378e-02,
            1.4024e-01, -1.0000e+07],
          [-1.0000e+07, -6.8111e-02,  1.5801e-01,  ...,  5.3456e-02,
            1.5212e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8336e-02,  1.1442e-01,  ...,  1.2781e-02,
            1.6008e-01, -1.0000e+07],
          [-1.0000e+07, -8.6413e-02,  1.2682e-01,  ...,  2.0315e-02,
            1.5557e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.4024e-01,  9.2157e-02,  ...,  3.0018e-02,
            1.5550e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.4314e-01,  5.6542e-02,  ...,  3.5605e-02,
            1.3800e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 7.0161e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.7167e-02,  1.3964e-01],
         [ 7.7646e-02,  1.5693e-01],
         [ 1.0893e-01,  1.5101e-01],
         [ 7.3300e-02,  1.0692e-01],
         [ 1.0724e-01,  1.0942e-01],
         [ 8.7339e-02,  1.0876e-01],
         [ 1.0220e-01,  1.3038e-01],
         [ 5.8071e-02,  7.8419e-02],
         [ 8.3768e-02,  7.7554e-02],
         [-7.3632e-02,  8.2349e-02],
         [-5.0564e-02,  1.0266e-01],
         [ 9.3711e-02,  8.5697e-02],
         [ 1.0173e-01,  8.5883e-02],
         [ 6.9860e-02,  4.3213e-02],
         [ 9.1399e-02,  8.5434e-02],
         [ 9.7961e-02,  9.9004e-02],
         [ 1.0461e-01,  1.0184e-01],
         [ 9.3538e-02,  7.7290e-02],
         [ 1.1942e-01,  6.5101e-02],
         [ 1.2457e-01,  3.0430e-02],
         [ 1.2629e-01,  2.6645e-02],
         [ 7.7149e-02,  4.3959e-02],
         [ 9.8446e-02,  5.6323e-02],
         [ 7.8870e-02,  1.7393e-02],
         [ 6.9893e-02,  6.7612e-03],
         [ 9.2929e-02,  3.4455e-02],
         [ 1.2402e-01,  4.7073e-02],
         [ 1.3604e-01,  5.2349e-02],
         [ 1.2336e-01,  5.4317e-02],
         [-8.3250e-03,  5.4949e-02],
         [ 1.4338e-02,  5.5121e-02],
         [-2.8485e-02,  5.5158e-02],
         [ 8.9536e-02,  5.5148e-02],
         [ 9.5633e-02,  5.5147e-02],
         [ 7.3303e-02,  5.5136e-02],
         [ 7.7686e-02,  5.5157e-02],
         [ 9.2463e-02,  5.5167e-02],
         [ 7.4070e-02,  5.5176e-02],
         [ 9.4480e-02,  5.5202e-02],
         [ 9.2467e-02,  5.5216e-02],
         [ 7.4683e-02,  5.5199e-02],
         [ 9.2827e-02,  5.5216e-02],
         [ 9.0283e-02,  5.5201e-02],
         [ 7.2443e-02,  5.5212e-02],
         [ 1.0871e-01,  5.5223e-02],
         [ 9.0190e-02,  5.5232e-02],
         [ 9.3819e-02,  5.5230e-02],
         [ 5.6811e-02,  5.5230e-02],
         [ 7.2520e-02,  5.5231e-02],
         [ 6.3695e-02,  5.5236e-02],
         [ 8.6576e-02,  5.5235e-02],
         [ 1.1249e-01,  5.5232e-02],
         [ 1.5011e-01,  5.5232e-02],
         [ 1.6401e-01,  5.5231e-02],
         [ 1.7870e-01,  5.5231e-02],
         [ 1.8821e-01,  5.5231e-02],
         [ 2.0756e-01,  5.5231e-02],
         [ 2.0078e-01,  5.5231e-02],
         [ 2.0917e-01,  5.5231e-02],
         [ 2.1491e-01,  5.5231e-02],
         [ 1.6557e-01,  5.5231e-02],
         [ 1.0124e-01,  5.5231e-02],
         [ 1.3880e-01,  5.5231e-02],
         [ 1.0734e-01,  5.5231e-02],
         [ 9.5370e-02,  5.5231e-02],
         [ 1.3526e-01,  5.5231e-02],
         [ 1.1629e-01,  5.5231e-02],
         [ 8.6550e-02,  5.5231e-02],
         [ 1.4303e-01,  5.5231e-02],
         [ 4.5254e-02,  5.5231e-02],
         [ 9.4683e-02,  5.5231e-02],
         [ 7.4196e-02,  5.5231e-02],
         [ 9.9837e-02,  5.5231e-02],
         [ 1.1518e-01,  5.5231e-02],
         [ 7.9009e-02,  5.5231e-02],
         [-1.4961e-01,  5.5231e-02],
         [ 7.3024e-02,  5.5231e-02],
         [ 1.5953e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.6747e-02,  1.2426e-01],
         [ 1.0215e-01,  1.5801e-01],
         [ 1.1442e-01,  1.2682e-01],
         [ 8.2119e-02,  1.2726e-01],
         [ 8.2707e-02,  8.7220e-02],
         [ 1.1584e-01,  1.3367e-01],
         [ 1.0874e-01,  9.7875e-02],
         [ 1.2315e-01,  1.1942e-01],
         [ 1.1835e-01,  9.0905e-02],
         [ 1.1904e-01,  1.1491e-01],
         [ 1.1420e-01,  1.0072e-01],
         [ 1.1736e-01,  1.3873e-01],
         [ 1.0583e-01,  1.1776e-01],
         [ 1.2060e-01,  1.2997e-01],
         [ 8.3805e-02,  1.4370e-01],
         [ 7.3296e-02,  1.3940e-01],
         [-9.2989e-02,  1.0659e-01],
         [ 7.7902e-02,  1.0038e-01],
         [ 6.9809e-02,  1.3009e-01],
         [ 8.3010e-02,  1.3965e-01],
         [ 7.4367e-02,  1.5497e-01],
         [ 1.0593e-01,  1.6081e-01],
         [ 7.2978e-02,  1.3526e-01],
         [ 8.6900e-02,  1.3413e-01],
         [ 1.0585e-01,  1.5358e-01],
         [ 1.2373e-01,  1.5064e-01],
         [ 9.0204e-02,  1.5856e-01],
         [ 9.4493e-02,  9.9870e-02],
         [ 1.2492e-01,  1.3461e-01],
         [ 1.1629e-01,  1.2680e-01],
         [ 9.7685e-02,  1.2818e-01],
         [ 1.1578e-01,  1.4086e-01],
         [ 9.6689e-02,  1.5074e-01],
         [ 1.2708e-01,  1.6178e-01],
         [ 1.2503e-01, -1.2090e-01],
         [ 1.3650e-01,  1.4475e-01],
         [ 1.2793e-01,  1.5639e-01],
         [ 7.9747e-02, -2.8422e-02],
         [ 1.1918e-01,  1.8166e-02],
         [ 1.3197e-01,  3.9698e-02],
         [ 9.4703e-02,  4.9178e-02],
         [ 1.0968e-01,  5.3146e-02],
         [ 1.1181e-01,  5.4703e-02],
         [ 1.1033e-01,  5.5232e-02],
         [ 9.3309e-02,  5.5341e-02],
         [ 6.3569e-02,  5.5344e-02],
         [ 1.2110e-01,  5.5305e-02],
         [ 9.7164e-02,  5.5242e-02],
         [ 7.1081e-02,  5.5213e-02],
         [ 6.3818e-02,  5.5219e-02],
         [ 9.7287e-02,  5.5202e-02],
         [ 8.8125e-02,  5.5225e-02],
         [ 6.2220e-02,  5.5209e-02],
         [ 7.2202e-02,  5.5220e-02],
         [ 1.1059e-01,  5.5213e-02],
         [ 7.2877e-02,  5.5206e-02],
         [ 5.8545e-02,  5.5220e-02],
         [ 9.6116e-02,  5.5227e-02],
         [ 6.9758e-02,  5.5232e-02],
         [ 1.0141e-01,  5.5230e-02],
         [ 8.3137e-02,  5.5230e-02],
         [ 1.0340e-01,  5.5231e-02],
         [ 8.1444e-02,  5.5236e-02],
         [ 9.7866e-02,  5.5235e-02],
         [ 1.0105e-01,  5.5232e-02],
         [ 6.8687e-02,  5.5232e-02],
         [ 6.9787e-02,  5.5231e-02],
         [ 9.7842e-02,  5.5231e-02],
         [ 1.0482e-01,  5.5231e-02],
         [ 7.1549e-02,  5.5231e-02],
         [ 1.0126e-01,  5.5231e-02],
         [ 1.1716e-01,  5.5231e-02],
         [ 1.3738e-01,  5.5231e-02],
         [ 1.1761e-01,  5.5231e-02],
         [ 1.2632e-01,  5.5231e-02],
         [ 1.4789e-01,  5.5231e-02],
         [ 1.5508e-01,  5.5231e-02],
         [ 1.5779e-01,  5.5231e-02],
         [ 1.5893e-01,  5.5231e-02],
         [ 1.2763e-01,  5.5231e-02],
         [ 1.0466e-01,  5.5231e-02],
         [ 1.0472e-01,  5.5231e-02],
         [ 1.2155e-01,  5.5231e-02],
         [ 1.1402e-01,  5.5231e-02],
         [ 1.1109e-01,  5.5231e-02],
         [ 1.2489e-01,  5.5231e-02],
         [ 1.5878e-01,  5.5231e-02],
         [ 1.2178e-01,  5.5231e-02],
         [ 1.0535e-01,  5.5231e-02],
         [ 1.0574e-01,  5.5231e-02],
         [ 8.1582e-02,  5.5231e-02],
         [ 8.9386e-02,  5.5231e-02],
         [ 9.8626e-02,  5.5231e-02],
         [ 1.0240e-01,  5.5231e-02],
         [ 1.2113e-01,  5.5231e-02],
         [ 1.3095e-01,  5.5231e-02],
         [ 8.7095e-02,  5.5231e-02],
         [ 6.6228e-02,  5.5231e-02],
         [ 1.0085e-01,  5.5231e-02],
         [ 1.2383e-01,  5.5231e-02],
         [ 1.3373e-01,  5.5231e-02],
         [ 1.0084e-01,  5.5231e-02],
         [ 1.1567e-01,  5.5231e-02],
         [ 1.2127e-01,  5.5231e-02],
         [ 1.0559e-01,  5.5231e-02],
         [ 9.5944e-02,  5.5231e-02],
         [ 9.2157e-02,  5.5231e-02],
         [ 5.6542e-02,  5.5231e-02],
         [ 7.0161e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.6112e-05, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.3288, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4631, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4598, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0417, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1138, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0591, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1422018., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2149, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.9576e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1908, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1139, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1908, device='cuda:0', grad_fn=<MinBackward1>)
t_env 10456
target_mac_out tensor([[[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1864e-01,  1.1645e-01,  ...,  4.7226e-02,
            1.2989e-01, -1.0000e+07],
          [-1.0000e+07, -8.8152e-02,  1.5925e-01,  ...,  8.0349e-02,
            1.5339e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4282e-01,  1.2437e-01,  ...,  4.5437e-02,
            1.3326e-01, -1.0000e+07],
          [-1.0000e+07, -1.1550e-01,  1.7096e-01,  ...,  9.3482e-02,
            1.6726e-01, -3.2914e-01]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.9336e-02,  8.9318e-02,  ...,  1.5729e-02,
            1.2882e-01, -1.0000e+07],
          [-1.0000e+07, -2.5640e-02,  8.8110e-02,  ..., -1.8735e-02,
            1.3277e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.6715e-02,  8.6205e-02,  ..., -1.9925e-02,
            1.3653e-01, -1.0000e+07],
          [-1.0000e+07, -1.8158e-02,  9.3029e-02,  ...,  4.9172e-03,
            1.3856e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5429e-01,  7.3930e-02,  ...,  5.5188e-02,
            2.0320e-01, -3.1718e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4585e-01,  3.9728e-02,  ...,  5.0290e-02,
            1.8666e-01, -3.0990e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.1321e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1386e-01,  1.4136e-01],
         [ 1.1645e-01,  1.5925e-01],
         [ 1.2437e-01,  1.7096e-01],
         [ 9.5376e-02,  1.6804e-01],
         [ 1.1966e-01,  1.5936e-01],
         [ 9.6480e-02,  1.1984e-01],
         [ 1.0827e-01,  1.3492e-01],
         [ 1.1504e-01,  1.0198e-01],
         [ 6.8714e-02,  6.7503e-02],
         [ 1.1711e-01,  9.5739e-02],
         [ 7.5314e-02,  9.8055e-02],
         [ 1.0966e-01,  7.6357e-02],
         [ 7.5569e-02,  1.0202e-01],
         [ 9.5001e-02,  1.0096e-01],
         [ 1.2416e-01,  8.6189e-02],
         [ 1.3910e-01,  1.1043e-01],
         [ 1.4155e-01,  9.2561e-02],
         [ 1.4807e-01,  1.0157e-01],
         [ 1.7075e-01,  8.3550e-02],
         [ 1.5083e-01,  6.3369e-02],
         [ 1.5753e-01,  7.0596e-02],
         [ 1.6595e-01,  8.5701e-02],
         [ 1.1423e-01,  9.2195e-02],
         [ 9.3032e-02,  6.3156e-02],
         [ 1.0014e-01,  7.1575e-02],
         [ 1.0298e-01,  1.2032e-03],
         [ 1.1725e-01,  3.1698e-02],
         [ 1.2430e-01,  4.6665e-02],
         [ 1.2460e-01,  5.3081e-02],
         [ 1.4029e-01,  5.5420e-02],
         [ 1.1855e-01,  5.5990e-02],
         [ 8.8230e-02,  5.5955e-02],
         [ 5.1006e-02,  5.5733e-02],
         [ 8.4578e-02,  5.5530e-02],
         [ 9.9809e-02,  5.5391e-02],
         [ 9.6239e-02,  5.5313e-02],
         [ 9.1297e-02,  5.5232e-02],
         [ 9.7713e-02,  5.5206e-02],
         [ 1.0032e-01,  5.5200e-02],
         [ 2.4096e-01,  5.5220e-02],
         [ 5.6085e-02,  5.5211e-02],
         [ 8.2782e-02,  5.5211e-02],
         [ 1.1488e-01,  5.5210e-02],
         [ 9.9489e-02,  5.5211e-02],
         [-1.7744e-02,  5.5222e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 3.1469e-02,  8.4050e-02],
         [ 8.9318e-02,  8.8110e-02],
         [ 8.6205e-02,  9.3029e-02],
         [ 7.9212e-02,  1.2713e-01],
         [ 8.0252e-02,  1.2305e-01],
         [ 9.7484e-02,  1.2077e-01],
         [ 9.2880e-02, -9.0083e-03],
         [ 9.5995e-02,  3.1836e-02],
         [ 6.7004e-02,  1.0564e-01],
         [ 8.7421e-02,  9.7873e-02],
         [ 9.9203e-02,  5.2959e-02],
         [ 1.2312e-01,  7.6151e-02],
         [ 7.8297e-02,  9.2369e-02],
         [ 7.5175e-02,  1.0030e-01],
         [ 9.6348e-02,  1.0220e-01],
         [ 9.2178e-02,  1.0544e-01],
         [ 6.8007e-02,  1.1686e-01],
         [ 6.2113e-02,  6.2421e-02],
         [ 8.6541e-02,  5.2282e-02],
         [ 8.7112e-02,  8.2918e-02],
         [ 9.9921e-02,  1.3363e-01],
         [ 1.0993e-01,  1.1581e-01],
         [ 1.2497e-01,  1.3996e-01],
         [ 1.2852e-01,  1.7366e-01],
         [ 1.5182e-01,  1.2420e-01],
         [ 7.0343e-02,  1.2131e-01],
         [ 1.1289e-01,  1.3834e-01],
         [ 1.3537e-01,  8.6083e-02],
         [ 1.4646e-01,  9.0422e-02],
         [ 1.5183e-01,  4.8601e-02],
         [ 1.3870e-01,  8.1963e-02],
         [ 1.0022e-01,  5.3132e-02],
         [ 1.1442e-01,  4.1479e-02],
         [ 1.2084e-01,  7.7650e-02],
         [ 1.0825e-01,  8.5983e-02],
         [ 9.0081e-02,  5.8932e-02],
         [-1.3405e-01,  1.1610e-01],
         [ 1.0357e-01,  1.1495e-01],
         [-1.7049e-02,  1.0563e-01],
         [ 1.6099e-02,  5.9542e-02],
         [ 3.4188e-02,  5.8138e-02],
         [ 4.3249e-02,  4.7099e-02],
         [ 4.7464e-02,  3.4608e-02],
         [ 4.9250e-02,  3.5742e-02],
         [ 4.9928e-02,  4.6917e-02],
         [ 5.0124e-02,  3.2539e-02],
         [ 5.0152e-02,  4.5092e-02],
         [ 5.0120e-02, -5.3314e-02],
         [ 5.0086e-02,  4.9605e-02],
         [ 5.0056e-02,  7.7738e-02],
         [ 5.0047e-02,  5.9732e-02],
         [ 5.0045e-02,  8.9701e-02],
         [ 5.0049e-02,  9.8494e-02],
         [ 5.0024e-02,  5.7304e-02],
         [ 5.0016e-02,  8.6369e-02],
         [ 5.0020e-02,  5.2779e-02],
         [ 5.0020e-02,  8.7070e-02],
         [ 5.0021e-02,  9.9907e-02],
         [ 5.0015e-02,  5.8307e-02],
         [ 5.0006e-02,  4.6817e-02],
         [ 5.0007e-02,  7.0758e-02],
         [ 5.0007e-02,  4.6055e-02],
         [ 5.0007e-02,  7.3576e-02],
         [ 5.0008e-02,  8.2676e-02],
         [ 5.0008e-02,  8.5264e-02],
         [ 5.0008e-02,  7.2863e-02],
         [ 5.0008e-02, -3.0183e-02],
         [ 5.0008e-02, -1.2508e-02],
         [ 5.0008e-02,  4.2744e-02],
         [ 5.0008e-02,  3.6529e-02],
         [ 5.0009e-02,  7.0522e-02],
         [ 5.0009e-02,  8.6414e-02],
         [ 5.0009e-02,  1.1431e-01],
         [ 5.0009e-02,  6.1123e-02],
         [ 5.0009e-02,  8.6617e-02],
         [ 5.0009e-02,  9.6615e-02],
         [ 5.0009e-02,  6.2950e-02],
         [ 5.0009e-02,  8.5237e-02],
         [ 5.0009e-02,  5.0593e-02],
         [ 5.0009e-02,  6.0193e-02],
         [ 5.0009e-02,  4.3700e-02],
         [ 5.0009e-02,  3.9503e-02],
         [ 5.0009e-02,  3.7729e-02],
         [ 5.0009e-02,  3.4591e-02],
         [ 5.0009e-02,  6.6541e-02],
         [ 5.0009e-02,  8.0043e-02],
         [ 5.0009e-02,  8.6664e-02],
         [ 5.0009e-02,  9.4144e-02],
         [ 5.0009e-02,  9.6911e-02],
         [ 5.0009e-02,  7.7785e-02],
         [ 5.0009e-02,  8.8932e-02],
         [ 5.0009e-02,  1.1184e-01],
         [ 5.0009e-02,  9.1165e-02],
         [ 5.0009e-02,  9.0145e-02],
         [ 5.0009e-02,  1.0665e-01],
         [ 5.0009e-02,  1.2451e-01],
         [ 5.0009e-02,  8.4479e-02],
         [ 5.0009e-02,  1.1127e-01],
         [ 5.0009e-02,  1.1878e-01],
         [ 5.0009e-02,  1.2086e-01],
         [ 5.0009e-02,  1.1097e-01],
         [ 5.0009e-02,  7.3768e-02],
         [ 5.0009e-02,  4.7919e-02],
         [ 5.0009e-02,  7.6856e-02],
         [ 5.0009e-02,  9.0253e-02],
         [ 5.0009e-02,  8.7377e-02],
         [ 5.0009e-02,  7.3930e-02],
         [ 5.0009e-02,  3.9728e-02],
         [ 5.0009e-02,  1.1321e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.0632e-05, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0014, device='cuda:0')
mixer_td_error tensor(0.7076, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4618, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8617, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0439, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1510, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0711, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2935779.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2410, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.4903e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1697, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1125, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1697, device='cuda:0', grad_fn=<MinBackward1>)
t_env 10502
target_mac_out tensor([[[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3382e-02,  7.9674e-02,  ...,  2.9347e-03,
            1.4357e-01, -1.0000e+07],
          [-1.0000e+07, -1.6607e-02,  1.1113e-01,  ...,  2.2597e-03,
            1.2947e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.8440e-02,  5.7460e-02,  ..., -4.9726e-03,
            1.5747e-01, -1.0000e+07],
          [-1.0000e+07, -3.3268e-02,  6.1468e-02,  ...,  2.8033e-02,
            1.5274e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.2218e-01,  1.1603e-01,  ...,  8.8825e-02,
            1.9273e-01, -3.4327e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.9542e-01,  7.0641e-02,  ...,  8.0455e-02,
            1.5643e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.5650e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.3919e-02,  9.6747e-02,  ...,  2.7699e-02,
            1.4092e-01, -1.0000e+07],
          [-1.0000e+07, -2.4705e-02,  1.2426e-01,  ...,  1.4439e-02,
            1.3627e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.5817e-02,  1.0215e-01,  ...,  1.7378e-02,
            1.4024e-01, -1.0000e+07],
          [-1.0000e+07, -6.8111e-02,  1.5801e-01,  ...,  5.3456e-02,
            1.5212e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8336e-02,  1.1442e-01,  ...,  1.2781e-02,
            1.6008e-01, -1.0000e+07],
          [-1.0000e+07, -8.6413e-02,  1.2682e-01,  ...,  2.0315e-02,
            1.5557e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.0205e-02,  9.0702e-02],
         [ 7.9674e-02,  1.1113e-01],
         [ 5.7460e-02,  6.1468e-02],
         [ 5.2195e-02, -1.7950e-02],
         [ 3.7389e-02,  7.1208e-02],
         [ 9.2285e-02,  4.8128e-02],
         [ 1.4096e-01,  4.1744e-02],
         [ 1.6714e-01,  7.7641e-02],
         [ 1.2319e-01,  1.1045e-01],
         [ 1.0087e-01,  1.3892e-01],
         [ 1.0282e-01,  1.5236e-01],
         [ 8.4418e-02,  1.2944e-01],
         [ 8.6654e-02,  1.2305e-01],
         [ 7.0944e-02,  1.4173e-01],
         [ 8.9887e-02,  1.2287e-01],
         [ 6.5322e-02,  1.3889e-01],
         [ 9.8309e-02,  1.6250e-01],
         [ 1.0943e-01,  1.1874e-01],
         [ 1.0969e-01,  1.0469e-01],
         [ 1.2822e-01,  1.4224e-01],
         [ 1.5813e-01,  1.2451e-01],
         [ 1.7510e-01,  1.1136e-01],
         [ 1.8255e-01,  1.5612e-01],
         [ 1.4230e-01,  1.6958e-01],
         [ 1.4571e-01,  1.6495e-01],
         [ 1.2951e-01,  1.3509e-01],
         [ 1.6287e-01,  1.6685e-01],
         [ 1.7633e-01,  1.6216e-01],
         [ 1.7510e-01,  1.2900e-01],
         [ 1.3645e-01,  1.6227e-01],
         [ 1.6178e-01,  1.2986e-01],
         [ 1.7149e-01,  1.5448e-01],
         [ 1.7263e-01,  1.6642e-01],
         [ 1.2707e-01,  1.2379e-01],
         [ 1.2787e-01,  1.6267e-01],
         [ 1.6779e-01,  1.7743e-01],
         [ 1.8064e-01,  1.0716e-01],
         [ 1.3936e-01,  4.9620e-02],
         [ 1.3360e-01,  7.6674e-02],
         [ 1.6477e-01,  3.9735e-02],
         [ 1.1265e-01,  7.3313e-02],
         [ 1.1163e-01,  1.0128e-01],
         [ 1.1182e-01,  1.3546e-01],
         [ 1.1236e-01,  1.0747e-01],
         [ 6.0105e-02,  9.8160e-02],
         [ 7.4719e-02,  1.2087e-01],
         [ 8.1573e-02,  1.2477e-01],
         [ 8.5105e-02,  1.3221e-01],
         [ 6.3845e-02,  1.2586e-01],
         [ 7.0164e-02,  8.6331e-02],
         [ 7.4526e-02,  1.1606e-01],
         [ 1.0302e-01,  1.3563e-01],
         [ 1.0192e-01,  1.4440e-01],
         [ 9.6997e-02, -2.2417e-02],
         [ 1.0086e-01,  2.0640e-02],
         [ 6.4018e-02,  4.0824e-02],
         [ 7.7575e-02,  4.9666e-02],
         [ 7.9310e-02,  5.3332e-02],
         [ 9.1781e-02,  5.4708e-02],
         [ 9.9900e-02,  5.5190e-02],
         [ 7.8142e-02,  5.5286e-02],
         [ 8.1120e-02,  5.5262e-02],
         [ 7.9033e-02,  5.5242e-02],
         [ 6.4642e-02,  5.5228e-02],
         [ 7.2620e-02,  5.5201e-02],
         [ 6.1578e-02,  5.5180e-02],
         [ 5.8466e-02,  5.5216e-02],
         [ 6.9814e-02,  5.5211e-02],
         [ 1.0164e-01,  5.5204e-02],
         [ 9.2112e-02,  5.5218e-02],
         [ 6.2117e-02,  5.5218e-02],
         [ 1.0774e-01,  5.5213e-02],
         [ 1.0443e-01,  5.5222e-02],
         [ 7.0555e-02,  5.5228e-02],
         [ 9.5771e-02,  5.5229e-02],
         [ 9.3458e-02,  5.5233e-02],
         [ 1.0013e-01,  5.5235e-02],
         [ 6.5921e-02,  5.5235e-02],
         [ 6.6639e-02,  5.5232e-02],
         [ 5.6191e-02,  5.5231e-02],
         [ 6.7671e-02,  5.5231e-02],
         [ 6.3217e-02,  5.5231e-02],
         [ 5.9322e-02,  5.5231e-02],
         [ 7.2676e-02,  5.5231e-02],
         [ 6.6741e-02,  5.5231e-02],
         [ 7.8602e-02,  5.5231e-02],
         [ 8.5976e-02,  5.5231e-02],
         [ 9.0356e-02,  5.5231e-02],
         [ 9.2933e-02,  5.5231e-02],
         [ 7.4840e-02,  5.5231e-02],
         [ 9.9034e-02,  5.5231e-02],
         [ 8.1550e-02,  5.5231e-02],
         [ 6.7384e-02,  5.5231e-02],
         [ 8.9860e-02,  5.5231e-02],
         [ 1.0093e-01,  5.5231e-02],
         [ 9.4762e-02,  5.5231e-02],
         [ 1.0072e-01,  5.5231e-02],
         [ 1.0375e-01,  5.5231e-02],
         [ 1.0612e-01,  5.5231e-02],
         [ 6.9198e-02,  5.5231e-02],
         [ 9.3882e-02,  5.5231e-02],
         [ 1.0288e-01,  5.5231e-02],
         [ 8.3422e-02,  5.5231e-02],
         [ 7.4192e-02,  5.5231e-02],
         [ 1.0755e-01,  5.5231e-02],
         [ 1.2109e-01,  5.5231e-02],
         [ 9.8501e-02,  5.5231e-02],
         [ 1.0300e-01,  5.5231e-02],
         [ 1.1665e-01,  5.5231e-02],
         [ 8.9919e-02,  5.5231e-02],
         [ 9.9790e-02,  5.5231e-02],
         [ 1.0759e-01,  5.5231e-02],
         [ 9.5090e-02,  5.5231e-02],
         [ 8.8522e-02,  5.5231e-02],
         [ 9.7505e-02,  5.5231e-02],
         [ 5.9807e-02,  5.5231e-02],
         [ 7.9994e-02,  5.5231e-02],
         [ 6.3079e-02,  5.5231e-02],
         [ 7.7705e-02,  5.5231e-02],
         [ 1.1603e-01,  5.5231e-02],
         [ 7.0641e-02,  5.5231e-02],
         [ 1.5650e-02,  5.5231e-02]],

        [[ 9.6747e-02,  1.2426e-01],
         [ 1.0215e-01,  1.5801e-01],
         [ 1.1442e-01,  1.2682e-01],
         [ 8.2119e-02,  1.2726e-01],
         [ 8.2707e-02,  8.7220e-02],
         [ 1.1584e-01,  1.3367e-01],
         [ 1.0874e-01,  9.7875e-02],
         [ 1.2315e-01,  1.1942e-01],
         [ 1.1835e-01,  9.0905e-02],
         [ 1.1904e-01,  1.1491e-01],
         [ 1.1420e-01,  1.0072e-01],
         [ 1.1736e-01,  1.3873e-01],
         [ 1.0583e-01,  1.1776e-01],
         [ 1.2060e-01,  1.2997e-01],
         [ 8.3805e-02,  1.4370e-01],
         [ 7.3296e-02,  1.3940e-01],
         [ 5.4273e-02,  1.0659e-01],
         [ 7.7902e-02,  1.0038e-01],
         [ 6.9809e-02,  1.3009e-01],
         [ 8.3010e-02,  1.3965e-01],
         [ 7.4367e-02,  1.5497e-01],
         [ 1.0593e-01,  1.6081e-01],
         [ 7.2978e-02,  1.3526e-01],
         [ 8.6900e-02,  1.3413e-01],
         [ 1.0585e-01,  1.5358e-01],
         [ 1.2373e-01,  1.5064e-01],
         [ 9.0204e-02,  1.5856e-01],
         [ 9.4493e-02,  9.9870e-02],
         [ 1.2492e-01,  1.3461e-01],
         [ 1.1629e-01,  1.2680e-01],
         [ 9.7685e-02,  1.2818e-01],
         [ 1.1578e-01,  1.4086e-01],
         [ 9.6689e-02,  1.5074e-01],
         [ 1.2708e-01,  1.6178e-01],
         [ 1.2503e-01,  1.2040e-01],
         [ 1.3650e-01,  1.4475e-01],
         [ 1.2793e-01,  1.5639e-01],
         [ 7.9747e-02, -2.8422e-02],
         [ 1.1918e-01,  1.8166e-02],
         [ 1.3197e-01,  3.9698e-02],
         [ 9.4703e-02,  4.9178e-02],
         [ 1.0968e-01,  5.3146e-02],
         [ 1.1181e-01,  5.4703e-02],
         [ 1.1033e-01,  5.5232e-02],
         [ 9.3309e-02,  5.5341e-02],
         [ 6.3569e-02,  5.5344e-02],
         [ 1.2110e-01,  5.5305e-02],
         [ 9.7164e-02,  5.5242e-02],
         [ 7.1081e-02,  5.5213e-02],
         [ 6.3818e-02,  5.5219e-02],
         [ 9.7287e-02,  5.5202e-02],
         [ 8.8125e-02,  5.5225e-02],
         [ 6.2220e-02,  5.5209e-02],
         [ 7.2202e-02,  5.5220e-02],
         [ 1.1059e-01,  5.5213e-02],
         [ 7.2877e-02,  5.5206e-02],
         [ 5.8545e-02,  5.5220e-02],
         [ 9.6116e-02,  5.5227e-02],
         [ 6.9758e-02,  5.5232e-02],
         [ 1.0141e-01,  5.5230e-02],
         [ 8.3137e-02,  5.5230e-02],
         [ 1.0340e-01,  5.5231e-02],
         [ 8.1444e-02,  5.5236e-02],
         [ 9.7866e-02,  5.5235e-02],
         [ 1.0105e-01,  5.5232e-02],
         [ 6.8687e-02,  5.5232e-02],
         [ 6.9787e-02,  5.5231e-02],
         [ 9.7842e-02,  5.5231e-02],
         [ 1.0482e-01,  5.5231e-02],
         [ 7.1549e-02,  5.5231e-02],
         [ 1.0126e-01,  5.5231e-02],
         [ 1.1716e-01,  5.5231e-02],
         [ 1.3738e-01,  5.5231e-02],
         [ 1.1761e-01,  5.5231e-02],
         [ 1.2632e-01,  5.5231e-02],
         [ 1.4789e-01,  5.5231e-02],
         [ 1.5508e-01,  5.5231e-02],
         [ 1.5779e-01,  5.5231e-02],
         [ 1.5893e-01,  5.5231e-02],
         [ 1.2763e-01,  5.5231e-02],
         [ 1.0466e-01,  5.5231e-02],
         [ 1.0472e-01,  5.5231e-02],
         [ 1.2155e-01,  5.5231e-02],
         [ 1.1402e-01,  5.5231e-02],
         [ 1.1109e-01,  5.5231e-02],
         [ 1.2489e-01,  5.5231e-02],
         [ 1.5878e-01,  5.5231e-02],
         [ 1.2178e-01,  5.5231e-02],
         [ 1.0535e-01,  5.5231e-02],
         [ 1.0574e-01,  5.5231e-02],
         [ 8.1582e-02,  5.5231e-02],
         [ 8.9386e-02,  5.5231e-02],
         [ 9.8626e-02,  5.5231e-02],
         [ 1.0240e-01,  5.5231e-02],
         [ 1.2113e-01,  5.5231e-02],
         [ 1.3095e-01,  5.5231e-02],
         [ 8.7095e-02,  5.5231e-02],
         [ 6.6228e-02,  5.5231e-02],
         [ 1.0085e-01,  5.5231e-02],
         [ 1.2383e-01,  5.5231e-02],
         [ 1.3373e-01,  5.5231e-02],
         [ 1.0084e-01,  5.5231e-02],
         [ 1.1567e-01,  5.5231e-02],
         [ 1.2127e-01,  5.5231e-02],
         [ 1.0559e-01,  5.5231e-02],
         [ 9.5944e-02,  5.5231e-02],
         [ 9.2157e-02,  5.5231e-02],
         [ 5.6542e-02,  5.5231e-02],
         [ 7.0161e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.9679e-06, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.1398, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4656, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3906, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0559, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1366, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0305, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-532786.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1825, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.7447e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1454, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0967, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1454, device='cuda:0', grad_fn=<MinBackward1>)
t_env 10548
target_mac_out tensor([[[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3951e-02,  7.1240e-02,  ...,  3.0362e-02,
            1.3820e-01, -1.0000e+07],
          [-1.0000e+07, -3.0267e-02,  1.3089e-01,  ...,  1.8888e-02,
            1.4798e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.8630e-02,  1.0511e-01,  ...,  4.9468e-02,
            1.6136e-01, -1.0000e+07],
          [-1.0000e+07, -6.8084e-02,  1.5335e-01,  ...,  4.9501e-02,
            1.5601e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6454e-02,  9.8041e-02,  ...,  2.6212e-02,
            1.4254e-01, -1.0000e+07],
          [-1.0000e+07, -6.9791e-02,  1.1912e-01,  ...,  2.3814e-02,
            1.4958e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0073e-01,  1.1228e-01,  ...,  2.1527e-02,
            1.5677e-01, -1.0000e+07],
          [-1.0000e+07, -7.4430e-02,  1.2619e-01,  ...,  2.5142e-02,
            1.4711e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0575e-01,  1.1552e-01,  ...,  5.7407e-02,
            1.7511e-01, -3.2794e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1218e-01,  1.1068e-01,  ...,  5.6260e-02,
            1.7721e-01, -3.2753e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.7746e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.4778e-02,  1.0692e-01],
         [ 7.1240e-02,  1.3089e-01],
         [ 1.0511e-01,  1.5335e-01],
         [ 1.3332e-01,  1.2855e-01],
         [ 1.3819e-01,  1.1196e-01],
         [ 1.1195e-01,  1.1426e-01],
         [ 1.3299e-01,  1.5269e-01],
         [ 1.3302e-01,  1.2681e-01],
         [ 1.0285e-01,  1.6040e-01],
         [ 9.9576e-02,  1.3218e-01],
         [ 1.2164e-01,  1.0239e-01],
         [ 1.5219e-01,  6.6812e-02],
         [ 1.6463e-01,  1.1447e-01],
         [ 1.6839e-01,  1.5027e-01],
         [ 1.5302e-01,  1.1233e-01],
         [ 1.6824e-01,  1.2816e-01],
         [ 1.2923e-01,  1.3730e-01],
         [ 1.0998e-01,  1.4410e-01],
         [ 1.2916e-01,  1.6252e-01],
         [ 8.8662e-02,  1.1478e-01],
         [ 1.1692e-01,  1.4795e-01],
         [ 8.7348e-02,  1.5550e-01],
         [ 7.0627e-02,  1.5467e-01],
         [ 8.0124e-02, -7.8007e-03],
         [ 9.9953e-02,  2.5910e-02],
         [ 1.2424e-01,  4.2810e-02],
         [ 1.1809e-01,  5.0563e-02],
         [ 1.1295e-01,  5.3837e-02],
         [ 1.2893e-01,  5.5094e-02],
         [ 9.7302e-02,  5.5459e-02],
         [ 8.3531e-02,  5.5496e-02],
         [ 9.1005e-02,  5.5446e-02],
         [ 8.3274e-02,  5.5332e-02],
         [ 6.3260e-02,  5.5293e-02],
         [ 5.8966e-02,  5.5232e-02],
         [ 1.0675e-01,  5.5218e-02],
         [ 1.1500e-01,  5.5234e-02],
         [ 1.1732e-01,  5.5215e-02],
         [ 9.5412e-02,  5.5198e-02],
         [ 6.8970e-02,  5.5220e-02],
         [ 1.0370e-01,  5.5216e-02],
         [ 1.0700e-01,  5.5212e-02],
         [ 8.8503e-02,  5.5221e-02],
         [ 1.1593e-01,  5.5227e-02],
         [ 1.1585e-01,  5.5232e-02],
         [-1.4430e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 6.3473e-02,  1.3755e-01],
         [ 9.8041e-02,  1.1912e-01],
         [ 1.1228e-01,  1.2619e-01],
         [ 7.7923e-02,  7.4658e-02],
         [ 7.7149e-02,  5.5559e-02],
         [ 5.4094e-02,  7.2421e-02],
         [ 8.5183e-02,  9.9376e-02],
         [ 9.7684e-02,  5.2127e-02],
         [ 1.1953e-01,  9.4958e-02],
         [ 1.0656e-01,  8.9877e-02],
         [ 1.1094e-01,  1.2454e-01],
         [ 1.0315e-01,  1.3676e-01],
         [ 1.0846e-01,  1.1305e-01],
         [ 1.1109e-01,  9.9956e-02],
         [ 1.0954e-01,  1.3933e-01],
         [ 9.0369e-02,  1.5308e-01],
         [ 7.3179e-02,  1.4767e-01],
         [ 9.6741e-02,  1.2407e-01],
         [ 7.7493e-02,  1.0314e-01],
         [ 9.5068e-02,  1.2607e-01],
         [ 1.0269e-01,  1.4122e-01],
         [ 7.5418e-02,  1.5638e-01],
         [ 8.0872e-02,  1.3731e-01],
         [ 6.6191e-02,  1.5575e-01],
         [ 9.3772e-02,  1.6546e-01],
         [ 9.7946e-02,  1.3939e-01],
         [ 7.6336e-02,  1.6230e-01],
         [ 6.3684e-02,  1.8396e-01],
         [ 7.6300e-02,  1.5706e-01],
         [ 9.5914e-02,  1.5702e-01],
         [ 1.2101e-01,  1.5701e-01],
         [ 1.2505e-01,  1.3683e-01],
         [ 1.2304e-01,  1.2317e-01],
         [ 9.6598e-02,  9.9315e-02],
         [ 7.7836e-02,  1.1218e-01],
         [ 1.0260e-01,  1.3276e-01],
         [ 1.0127e-01, -2.0544e-02],
         [ 1.1849e-01,  2.3882e-02],
         [ 7.2919e-02,  4.3476e-02],
         [ 9.5254e-02,  5.1597e-02],
         [ 1.2028e-01,  5.4689e-02],
         [ 1.2592e-01,  5.5643e-02],
         [ 1.3374e-01,  5.5776e-02],
         [ 9.0594e-02,  5.5666e-02],
         [ 1.1648e-01,  5.5511e-02],
         [ 7.8731e-02,  5.5378e-02],
         [ 1.0117e-01,  5.5285e-02],
         [ 1.0704e-01,  5.5246e-02],
         [ 8.2376e-02,  5.5226e-02],
         [ 9.7130e-02,  5.5235e-02],
         [ 7.6244e-02,  5.5201e-02],
         [ 9.3174e-02,  5.5199e-02],
         [ 6.2377e-02,  5.5208e-02],
         [ 9.1474e-02,  5.5219e-02],
         [ 9.2364e-02,  5.5216e-02],
         [ 8.9643e-02,  5.5218e-02],
         [ 8.6858e-02,  5.5227e-02],
         [ 6.9857e-02,  5.5232e-02],
         [ 6.3970e-02,  5.5230e-02],
         [ 6.1443e-02,  5.5230e-02],
         [ 4.8444e-02,  5.5231e-02],
         [ 7.2942e-02,  5.5236e-02],
         [ 9.1229e-02,  5.5235e-02],
         [ 8.9584e-02,  5.5232e-02],
         [ 6.0772e-02,  5.5232e-02],
         [ 8.9402e-02,  5.5231e-02],
         [ 9.9461e-02,  5.5231e-02],
         [ 6.8537e-02,  5.5231e-02],
         [ 6.2977e-02,  5.5231e-02],
         [ 8.8782e-02,  5.5231e-02],
         [ 6.5308e-02,  5.5231e-02],
         [ 9.2461e-02,  5.5231e-02],
         [ 1.0406e-01,  5.5231e-02],
         [ 7.1540e-02,  5.5231e-02],
         [ 8.5043e-02,  5.5231e-02],
         [ 9.8500e-02,  5.5231e-02],
         [ 9.2749e-02,  5.5231e-02],
         [ 9.9265e-02,  5.5231e-02],
         [ 6.3926e-02,  5.5231e-02],
         [ 9.0556e-02,  5.5231e-02],
         [ 6.5736e-02,  5.5231e-02],
         [ 6.0849e-02,  5.5231e-02],
         [ 5.6114e-02,  5.5231e-02],
         [ 6.9895e-02,  5.5231e-02],
         [ 7.2831e-02,  5.5231e-02],
         [ 5.5793e-02,  5.5231e-02],
         [ 8.2136e-02,  5.5231e-02],
         [ 6.9541e-02,  5.5231e-02],
         [ 8.9740e-02,  5.5231e-02],
         [ 6.2894e-02,  5.5231e-02],
         [ 5.7363e-02,  5.5231e-02],
         [ 1.0146e-01,  5.5231e-02],
         [ 1.0104e-01,  5.5231e-02],
         [ 8.8364e-02,  5.5231e-02],
         [ 6.0549e-02,  5.5231e-02],
         [ 7.4225e-02,  5.5231e-02],
         [ 9.3707e-02,  5.5231e-02],
         [ 9.9956e-02,  5.5231e-02],
         [ 1.0379e-01,  5.5231e-02],
         [ 7.9271e-02,  5.5231e-02],
         [ 6.0355e-02,  5.5231e-02],
         [ 1.0572e-01,  5.5231e-02],
         [ 8.9798e-02,  5.5231e-02],
         [ 9.5759e-02,  5.5231e-02],
         [ 1.0050e-01,  5.5231e-02],
         [ 1.0505e-01,  5.5231e-02],
         [ 8.1462e-02,  5.5231e-02],
         [ 8.3229e-02,  5.5231e-02],
         [ 8.0398e-02,  5.5231e-02],
         [ 6.5591e-02,  5.5231e-02],
         [ 6.0918e-02,  5.5231e-02],
         [ 8.4611e-02,  5.5231e-02],
         [ 8.0456e-02,  5.5231e-02],
         [ 5.0773e-02,  5.5231e-02],
         [ 5.6766e-02,  5.5231e-02],
         [ 9.9550e-02,  5.5231e-02],
         [ 9.1475e-02,  5.5231e-02],
         [ 1.0048e-01,  5.5231e-02],
         [ 8.7420e-02,  5.5231e-02],
         [ 6.2511e-02,  5.5231e-02],
         [ 1.0133e-01,  5.5231e-02],
         [ 1.4431e-01,  5.5231e-02],
         [ 1.0248e-01,  5.5231e-02],
         [ 1.1519e-01,  5.5231e-02],
         [ 8.9742e-02,  5.5231e-02],
         [ 9.3886e-02,  5.5231e-02],
         [ 7.3783e-02,  5.5231e-02],
         [ 9.4135e-02,  5.5231e-02],
         [ 8.8269e-02,  5.5231e-02],
         [ 9.6672e-02,  5.5231e-02],
         [ 8.6924e-02,  5.5231e-02],
         [ 6.8966e-02,  5.5231e-02],
         [ 4.8707e-02,  5.5231e-02],
         [ 5.6911e-02,  5.5231e-02],
         [ 7.1796e-02,  5.5231e-02],
         [ 6.2337e-02,  5.5231e-02],
         [ 8.4931e-02,  5.5231e-02],
         [ 1.0877e-01,  5.5231e-02],
         [ 9.4757e-02,  5.5231e-02],
         [ 8.4959e-02,  5.5231e-02],
         [ 6.1410e-02,  5.5231e-02],
         [ 8.5630e-02,  5.5231e-02],
         [ 9.9114e-02,  5.5231e-02],
         [ 1.2684e-01,  5.5231e-02],
         [ 1.2884e-01,  5.5231e-02],
         [ 7.9658e-02,  5.5231e-02],
         [ 7.4630e-02,  5.5231e-02],
         [ 9.5625e-02,  5.5231e-02],
         [ 1.1897e-01,  5.5231e-02],
         [ 9.5412e-02,  5.5231e-02],
         [ 5.6750e-02,  5.5231e-02],
         [ 7.1843e-02,  5.5231e-02],
         [ 8.8743e-02,  5.5231e-02],
         [ 9.8603e-02,  5.5231e-02],
         [ 1.2415e-01,  5.5231e-02],
         [ 1.3547e-01,  5.5231e-02],
         [ 1.3105e-01,  5.5231e-02],
         [ 1.3519e-01,  5.5231e-02],
         [ 9.1210e-02,  5.5231e-02],
         [ 1.1483e-01,  5.5231e-02],
         [ 1.1990e-01,  5.5231e-02],
         [ 1.1759e-01,  5.5231e-02],
         [ 1.1518e-01,  5.5231e-02],
         [ 1.4205e-01,  5.5231e-02],
         [ 1.0749e-01,  5.5231e-02],
         [ 1.4153e-01,  5.5231e-02],
         [ 1.0763e-01,  5.5231e-02],
         [ 9.2709e-02,  5.5231e-02],
         [ 1.3073e-01,  5.5231e-02],
         [ 1.2880e-01,  5.5231e-02],
         [ 1.3816e-01,  5.5231e-02],
         [ 1.4230e-01,  5.5231e-02],
         [ 1.1640e-01,  5.5231e-02],
         [ 1.2042e-01,  5.5231e-02],
         [ 1.1552e-01,  5.5231e-02],
         [ 1.1068e-01,  5.5231e-02],
         [ 2.7746e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.4961e-06, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0007, device='cuda:0')
mixer_td_error tensor(0.9087, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4634, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3661, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0588, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1742, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0346, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3700564.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1840, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.0460e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1500, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1272, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1500, device='cuda:0', grad_fn=<MinBackward1>)
t_env 10593
target_mac_out tensor([[[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.6031e-02,  7.5137e-02,  ...,  2.7515e-02,
            1.3596e-01, -1.0000e+07],
          [-1.0000e+07, -4.3911e-02,  1.0394e-01,  ...,  3.5068e-02,
            1.5027e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.4866e-02,  8.8302e-02,  ...,  3.5130e-02,
            1.3277e-01, -1.0000e+07],
          [-1.0000e+07, -4.3761e-02,  1.3140e-01,  ...,  1.3962e-02,
            1.5562e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.3745e-02,  1.1397e-01,  ...,  6.2087e-02,
            1.3778e-01, -1.0000e+07],
          [-1.0000e+07, -2.4539e-02,  9.4233e-02,  ..., -1.0851e-02,
            1.2427e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2232e-01,  1.3189e-01,  ...,  7.2013e-02,
            1.5525e-01, -1.0000e+07],
          [-1.0000e+07, -4.5152e-02,  1.2327e-01,  ..., -6.8382e-03,
            1.4315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2396e-01,  1.1947e-01,  ...,  2.8636e-02,
            1.6461e-01, -1.0000e+07],
          [-1.0000e+07, -6.0687e-02,  1.0693e-01,  ..., -2.3348e-02,
            1.4270e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7654e-01,  8.2472e-02,  ...,  3.5804e-02,
            1.5005e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6999e-01,  7.5227e-02,  ...,  1.8420e-02,
            1.5184e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.3659e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.7167e-02,  1.3964e-01],
         [ 7.5137e-02,  1.0394e-01],
         [ 8.8302e-02,  1.3140e-01],
         [ 1.1239e-01,  1.4579e-01],
         [ 1.1840e-01,  1.3729e-01],
         [ 1.3276e-01,  1.4881e-01],
         [ 5.1646e-02,  1.1264e-01],
         [ 1.0109e-01,  1.2451e-01],
         [ 9.5371e-02,  1.0192e-01],
         [ 1.0039e-01,  1.0098e-01],
         [ 1.0865e-01,  1.2922e-01],
         [ 3.4358e-02,  1.2389e-01],
         [ 1.0154e-01,  1.4602e-01],
         [ 7.5231e-02,  7.1449e-02],
         [ 5.7194e-02,  1.0170e-01],
         [ 8.7647e-02,  1.3434e-01],
         [ 7.6449e-02,  1.2708e-01],
         [ 8.5113e-02,  1.4264e-01],
         [ 1.0620e-01,  1.2570e-01],
         [ 8.6090e-02,  1.2102e-01],
         [ 7.2443e-02,  1.4732e-01],
         [ 1.0933e-01,  1.5949e-01],
         [ 1.1490e-01,  1.7804e-01],
         [ 1.3510e-01,  1.7731e-01],
         [ 1.7573e-01,  8.1565e-02],
         [ 1.8020e-01,  6.8504e-02],
         [ 1.8398e-01,  5.9672e-02],
         [ 2.0380e-01,  3.9538e-02],
         [ 1.4851e-01,  4.7387e-02],
         [ 9.2194e-02,  7.1733e-02],
         [ 1.2022e-01,  4.0742e-02],
         [ 8.6182e-02,  5.3875e-02],
         [ 1.0783e-01,  2.8560e-02],
         [ 8.9981e-02,  6.0526e-02],
         [ 1.0457e-01,  7.4086e-02],
         [ 1.1966e-01,  9.0469e-02],
         [ 1.4132e-01,  9.7372e-02],
         [ 1.1771e-01,  1.4154e-01],
         [ 1.0731e-01,  1.7751e-01],
         [ 1.4035e-01,  1.8560e-01],
         [ 1.0787e-01,  1.8620e-01],
         [ 1.3678e-01,  1.8450e-01],
         [ 1.2717e-01,  1.5795e-01],
         [ 1.2491e-01,  1.7421e-01],
         [ 1.2703e-01,  1.3752e-01],
         [ 1.0166e-01,  1.5336e-01],
         [ 1.3426e-01,  1.5669e-01],
         [-2.9412e-02,  9.0471e-02],
         [ 1.3372e-02,  6.5726e-02],
         [ 3.4250e-02,  5.9558e-02],
         [ 4.3864e-02,  9.1031e-02],
         [ 4.8079e-02,  2.4716e-01],
         [ 4.9718e-02,  5.7981e-02],
         [ 5.0206e-02,  2.4483e-01],
         [ 5.0281e-02,  9.7269e-02],
         [ 5.0248e-02,  2.3173e-01],
         [ 5.0160e-02,  7.9968e-02],
         [ 5.0112e-02, -4.3443e-02],
         [ 5.0043e-02,  4.7139e-02],
         [ 5.0010e-02, -7.2066e-02],
         [ 5.0016e-02,  5.6531e-02],
         [ 5.0005e-02,  4.0934e-02],
         [ 5.0018e-02,  7.4332e-02],
         [ 5.0024e-02,  4.3830e-02],
         [ 5.0025e-02,  7.2076e-02],
         [ 5.0011e-02,  4.1141e-02],
         [ 5.0010e-02,  6.2545e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.1397e-01,  9.4233e-02],
         [ 1.3189e-01,  1.2327e-01],
         [ 1.1947e-01,  1.0693e-01],
         [ 1.2507e-01,  1.2961e-01],
         [ 1.1673e-01,  1.4456e-01],
         [ 1.2398e-01,  1.1467e-01],
         [ 1.3041e-01,  9.8747e-02],
         [ 1.2689e-01,  9.1242e-02],
         [ 1.4447e-01,  1.2095e-01],
         [ 1.3061e-01,  1.6205e-01],
         [ 1.6773e-01,  1.1532e-01],
         [ 1.5501e-01,  1.6393e-01],
         [ 1.4073e-01,  1.4610e-01],
         [ 1.3913e-01,  1.3979e-01],
         [ 1.1933e-01,  1.3528e-01],
         [ 1.2140e-01,  1.1316e-01],
         [ 1.5225e-01,  1.0555e-01],
         [ 1.3199e-01,  1.2911e-01],
         [ 1.3226e-01,  1.0719e-01],
         [ 1.3998e-01,  8.1501e-02],
         [ 1.3645e-01,  7.5495e-02],
         [ 1.6086e-01,  6.8457e-02],
         [ 1.8020e-01,  7.0355e-02],
         [ 1.5122e-01,  1.0623e-01],
         [ 1.5019e-01,  1.4682e-01],
         [ 1.5163e-01,  1.1139e-01],
         [ 1.5461e-01,  9.0842e-02],
         [ 1.5867e-01,  1.0740e-01],
         [ 1.5983e-01,  1.0005e-01],
         [ 1.3660e-01,  1.1364e-01],
         [ 1.0459e-01,  1.3109e-01],
         [ 1.2356e-01,  1.5389e-01],
         [ 1.3544e-01,  1.0107e-01],
         [ 9.8677e-02,  1.4273e-01],
         [ 1.0230e-01,  1.6088e-01],
         [ 1.3941e-01,  1.2369e-01],
         [ 1.2784e-01,  1.4338e-01],
         [ 1.3618e-01,  7.6413e-02],
         [ 1.4079e-01,  1.3332e-01],
         [ 1.3833e-01,  8.2010e-02],
         [ 1.0776e-01,  7.7012e-02],
         [ 1.2057e-01,  1.0747e-01],
         [ 1.4363e-01,  1.3990e-01],
         [ 1.2314e-01,  1.0310e-01],
         [ 1.1819e-01,  1.1812e-01],
         [ 1.1767e-01,  1.3656e-01],
         [ 1.1200e-01,  9.6637e-02],
         [ 9.5090e-02,  2.8968e-02],
         [ 6.2191e-02,  4.6114e-02],
         [ 5.8803e-02,  5.3328e-02],
         [ 8.6286e-02,  5.5734e-02],
         [ 7.3099e-02,  5.6205e-02],
         [ 8.2351e-02,  5.6032e-02],
         [ 9.3730e-02,  5.5741e-02],
         [ 6.4182e-02,  5.5504e-02],
         [ 9.5050e-02,  5.5342e-02],
         [ 1.0643e-01,  5.5255e-02],
         [ 1.1937e-01,  5.5204e-02],
         [ 1.4897e-01,  5.5209e-02],
         [ 1.6025e-01,  5.5189e-02],
         [ 1.6501e-01,  5.5182e-02],
         [ 1.2555e-01,  5.5204e-02],
         [ 1.1310e-01,  5.5199e-02],
         [ 1.2308e-01,  5.5215e-02],
         [ 1.5283e-01,  5.5221e-02],
         [ 1.6390e-01,  5.5205e-02],
         [ 1.7892e-01,  5.5215e-02],
         [ 1.7682e-01,  5.5225e-02],
         [ 1.4493e-01,  5.5232e-02],
         [ 1.7801e-01,  5.5230e-02],
         [ 1.2570e-01,  5.5230e-02],
         [ 7.5033e-02,  5.5231e-02],
         [ 1.1080e-01,  5.5236e-02],
         [ 9.3988e-02,  5.5235e-02],
         [ 1.0988e-01,  5.5232e-02],
         [ 1.5249e-01,  5.5232e-02],
         [ 1.1001e-01,  5.5231e-02],
         [ 9.0231e-02,  5.5231e-02],
         [ 9.8207e-02,  5.5231e-02],
         [ 1.0305e-01,  5.5231e-02],
         [ 1.0570e-01,  5.5231e-02],
         [ 9.0413e-02,  5.5231e-02],
         [ 9.7159e-02,  5.5231e-02],
         [ 5.7818e-02,  5.5231e-02],
         [ 9.5198e-02,  5.5231e-02],
         [ 7.0767e-02,  5.5231e-02],
         [ 9.8025e-02,  5.5231e-02],
         [ 7.5696e-02,  5.5231e-02],
         [ 8.3645e-02,  5.5231e-02],
         [ 1.0020e-01,  5.5231e-02],
         [ 8.9158e-02,  5.5231e-02],
         [ 9.9577e-02,  5.5231e-02],
         [ 1.0447e-01,  5.5231e-02],
         [ 1.0666e-01,  5.5231e-02],
         [ 1.0542e-01,  5.5231e-02],
         [ 1.0627e-01,  5.5231e-02],
         [ 1.0855e-01,  5.5231e-02],
         [ 1.2505e-01,  5.5231e-02],
         [ 7.9741e-02,  5.5231e-02],
         [ 7.4930e-02,  5.5231e-02],
         [ 5.6067e-02,  5.5231e-02],
         [ 6.2591e-02,  5.5231e-02],
         [ 5.4314e-02,  5.5231e-02],
         [ 8.9578e-02,  5.5231e-02],
         [ 9.9955e-02,  5.5231e-02],
         [ 1.0414e-01,  5.5231e-02],
         [ 1.0496e-01,  5.5231e-02],
         [ 9.1520e-02,  5.5231e-02],
         [ 9.7277e-02,  5.5231e-02],
         [ 8.6899e-02,  5.5231e-02],
         [ 6.8651e-02,  5.5231e-02],
         [ 8.8303e-02,  5.5231e-02],
         [ 9.5785e-02,  5.5231e-02],
         [ 7.3246e-02,  5.5231e-02],
         [ 9.0522e-02,  5.5231e-02],
         [ 7.1120e-02,  5.5231e-02],
         [ 6.3700e-02,  5.5231e-02],
         [ 8.5983e-02,  5.5231e-02],
         [ 8.1237e-02,  5.5231e-02],
         [ 5.6874e-02,  5.5231e-02],
         [ 8.8685e-02,  5.5231e-02],
         [ 9.8737e-02,  5.5231e-02],
         [ 8.9954e-02,  5.5231e-02],
         [ 9.9697e-02,  5.5231e-02],
         [ 6.4763e-02,  5.5231e-02],
         [ 9.1926e-02,  5.5231e-02],
         [ 7.5211e-02,  5.5231e-02],
         [ 9.5801e-02,  5.5231e-02],
         [ 1.2129e-01,  5.5231e-02],
         [ 1.3175e-01,  5.5231e-02],
         [ 1.0125e-01,  5.5231e-02],
         [ 1.1477e-01,  5.5231e-02],
         [ 9.0523e-02,  5.5231e-02],
         [ 1.1981e-01,  5.5231e-02],
         [ 1.1288e-01,  5.5231e-02],
         [ 1.4925e-01,  5.5231e-02],
         [ 1.6131e-01,  5.5231e-02],
         [ 1.7902e-01,  5.5231e-02],
         [ 1.7530e-01,  5.5231e-02],
         [ 1.7215e-01,  5.5231e-02],
         [ 1.2619e-01,  5.5231e-02],
         [ 1.1845e-01,  5.5231e-02],
         [ 1.2957e-01,  5.5231e-02],
         [ 1.1724e-01,  5.5231e-02],
         [ 1.1436e-01,  5.5231e-02],
         [ 1.4822e-01,  5.5231e-02],
         [ 1.2818e-01,  5.5231e-02],
         [ 1.6594e-01,  5.5231e-02],
         [ 1.8150e-01,  5.5231e-02],
         [ 1.7533e-01,  5.5231e-02],
         [ 1.3581e-01,  5.5231e-02],
         [ 1.6930e-01,  5.5231e-02],
         [ 1.3644e-01,  5.5231e-02],
         [ 1.7064e-01,  5.5231e-02],
         [ 1.7124e-01,  5.5231e-02],
         [ 1.6868e-01,  5.5231e-02],
         [ 1.6638e-01,  5.5231e-02],
         [ 1.2479e-01,  5.5231e-02],
         [ 1.2839e-01,  5.5231e-02],
         [ 1.4954e-01,  5.5231e-02],
         [ 1.1651e-01,  5.5231e-02],
         [ 1.0551e-01,  5.5231e-02],
         [ 6.7285e-02,  5.5231e-02],
         [ 5.6135e-02,  5.5231e-02],
         [ 9.2925e-02,  5.5231e-02],
         [ 1.0533e-01,  5.5231e-02],
         [ 1.0204e-01,  5.5231e-02],
         [ 1.0717e-01,  5.5231e-02],
         [ 8.5192e-02,  5.5231e-02],
         [ 9.3075e-02,  5.5231e-02],
         [ 1.0136e-01,  5.5231e-02],
         [ 1.0459e-01,  5.5231e-02],
         [ 8.0700e-02,  5.5231e-02],
         [ 9.6655e-02,  5.5231e-02],
         [ 7.7035e-02,  5.5231e-02],
         [ 8.6632e-02,  5.5231e-02],
         [ 1.1645e-01,  5.5231e-02],
         [ 1.0996e-01,  5.5231e-02],
         [ 1.1025e-01,  5.5231e-02],
         [ 1.2576e-01,  5.5231e-02],
         [ 9.8937e-02,  5.5231e-02],
         [ 1.0920e-01,  5.5231e-02],
         [ 1.3765e-01,  5.5231e-02],
         [ 1.0385e-01,  5.5231e-02],
         [ 9.0057e-02,  5.5231e-02],
         [ 6.7846e-02,  5.5231e-02],
         [ 5.9565e-02,  5.5231e-02],
         [ 9.0796e-02,  5.5231e-02],
         [ 8.2472e-02,  5.5231e-02],
         [ 7.5227e-02,  5.5231e-02],
         [ 1.3659e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.2005e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0004, device='cuda:0')
mixer_td_error tensor(0.8179, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4652, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3195, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0645, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2055, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0414, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3246073., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2472, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.6833e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1809, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1208, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1809, device='cuda:0', grad_fn=<MinBackward1>)
t_env 10641
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0799e-01,  1.0994e-01,  ...,  4.2512e-02,
            1.4205e-01, -1.0000e+07],
          [-1.0000e+07, -4.1562e-02,  1.2343e-01,  ...,  1.2672e-02,
            1.4219e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3438e-01,  9.7930e-02,  ...,  1.1659e-02,
            1.6183e-01, -1.0000e+07],
          [-1.0000e+07, -4.3874e-02,  1.2534e-01,  ...,  1.1010e-03,
            1.3669e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.3996e-02,  8.6686e-02,  ...,  2.0696e-02,
            1.2691e-01, -1.0000e+07],
          [-1.0000e+07, -1.5667e-02,  8.3441e-02,  ...,  2.3244e-02,
            1.3188e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.7880e-02,  6.8914e-02,  ...,  1.7262e-02,
            1.3115e-01, -1.0000e+07],
          [-1.0000e+07, -3.0958e-02,  1.1978e-01,  ...,  1.0462e-02,
            1.4134e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1150e-02,  1.0243e-01,  ...,  3.5271e-02,
            1.5666e-01, -1.0000e+07],
          [-1.0000e+07, -4.8116e-02,  1.3813e-01,  ...,  2.4639e-03,
            1.4978e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.1299e-01,  1.0318e-01,  ...,  2.1199e-02,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.3792e-01,  1.0063e-01,  ...,  2.6554e-02,
            1.5157e-01, -2.8972e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6264e-01,  1.0124e-01,  ...,  2.7180e-02,
            1.5305e-01, -3.0142e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 1.0994e-01,  1.2343e-01],
         [ 9.7930e-02,  1.2534e-01],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 8.6686e-02,  8.3441e-02],
         [ 6.8914e-02,  1.1978e-01],
         [ 1.0243e-01,  1.3813e-01],
         ...,
         [ 1.0318e-01,  5.5231e-02],
         [ 1.0063e-01,  5.5231e-02],
         [ 1.0124e-01,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-7.3755e-06, device='cuda:0') tensor(0.0003, device='cuda:0') tensor(-0.0004, device='cuda:0')
mixer_td_error tensor(0.8134, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4625, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3934, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0657, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1851, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0269, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3349999.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2152, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(9.3021e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0001, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1207, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1417, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1207, device='cuda:0', grad_fn=<MinBackward1>)
t_env 10713
target_mac_out tensor([[[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.1854e-02,  7.0055e-02,  ...,  1.2276e-02,
            1.5385e-01, -1.0000e+07],
          [-1.0000e+07, -3.4827e-02,  6.7545e-02,  ...,  7.2149e-03,
            1.6403e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.1132e-02,  8.8784e-02,  ...,  5.2829e-02,
            1.9024e-01, -1.0000e+07],
          [-1.0000e+07, -4.8099e-02,  3.2742e-02,  ...,  2.3593e-02,
            1.7144e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6766e-01,  9.6012e-02,  ...,  4.1860e-02,
            1.4847e-01, -3.1668e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6001e-01,  6.6722e-02,  ...,  4.3129e-02,
            1.4348e-01, -3.1470e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 6.7435e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.3919e-02,  9.6747e-02,  ...,  2.7699e-02,
            1.4092e-01, -1.0000e+07],
          [-1.0000e+07, -2.4705e-02,  1.2426e-01,  ...,  1.4439e-02,
            1.3627e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2173e-01,  1.2675e-01,  ...,  5.6218e-02,
            1.5563e-01, -1.0000e+07],
          [-1.0000e+07, -6.8433e-02,  1.6164e-01,  ...,  5.1074e-02,
            1.4848e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.4337e-02,  8.9698e-02,  ...,  4.1773e-02,
            1.4377e-01, -1.0000e+07],
          [-1.0000e+07, -8.9666e-02,  1.6666e-01,  ...,  4.2981e-02,
            1.5077e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.4778e-02,  1.0692e-01],
         [ 7.0055e-02,  6.7545e-02],
         [ 8.8784e-02,  3.2742e-02],
         [ 5.7636e-02,  7.2555e-02],
         [-5.8568e-02,  8.8207e-02],
         [-4.2377e-02,  9.7911e-02],
         [ 8.9596e-02,  1.0047e-01],
         [ 1.0298e-01,  1.1810e-01],
         [ 1.0710e-01,  1.2176e-01],
         [ 1.0824e-01,  1.2036e-01],
         [ 1.0849e-01,  7.7300e-02],
         [-4.6377e-02,  8.4597e-02],
         [ 1.0009e-01,  8.9025e-02],
         [ 1.0441e-01,  2.5231e-01],
         [ 1.0431e-01,  2.5063e-01],
         [ 9.2075e-02,  2.5481e-01],
         [-5.6658e-02,  3.9181e-02],
         [-3.9714e-02,  7.5184e-02],
         [ 9.5768e-02,  2.6591e-01],
         [ 1.0135e-01,  7.5729e-02],
         [ 1.0471e-01,  6.8144e-02],
         [ 1.0542e-01,  9.0297e-02],
         [ 7.9449e-02,  8.4584e-02],
         [ 9.7118e-02,  5.5526e-02],
         [ 1.0297e-01,  7.7756e-02],
         [ 1.0423e-01,  2.4161e-01],
         [ 1.0421e-01,  2.1725e-01],
         [ 1.2166e-01,  3.1106e-02],
         [ 1.2566e-01,  2.9337e-02],
         [ 1.2680e-01,  1.4768e-02],
         [ 1.2714e-01,  3.6358e-02],
         [ 1.2721e-01,  4.7548e-02],
         [ 1.2736e-01,  5.2692e-02],
         [ 1.3334e-01,  5.4831e-02],
         [ 1.1711e-01,  5.5533e-02],
         [ 8.0323e-02,  5.5678e-02],
         [ 1.1666e-01,  5.5605e-02],
         [ 1.4771e-01,  5.5473e-02],
         [ 1.1121e-01,  5.5379e-02],
         [ 1.2796e-01,  5.5305e-02],
         [ 1.4742e-01,  5.5271e-02],
         [ 1.5482e-01,  5.5242e-02],
         [ 1.5724e-01,  5.5227e-02],
         [ 1.1207e-01,  5.5237e-02],
         [ 1.3672e-01,  5.5225e-02],
         [ 1.4496e-01,  5.5199e-02],
         [ 1.0139e-01,  5.5218e-02],
         [ 8.9030e-02,  5.5219e-02],
         [ 7.3668e-02,  5.5223e-02],
         [ 8.0779e-02,  5.5231e-02],
         [ 9.6012e-02,  5.5230e-02],
         [ 6.6722e-02,  5.5230e-02],
         [ 6.7435e-03,  5.5230e-02]],

        [[ 9.6747e-02,  1.2426e-01],
         [ 1.2675e-01,  1.6164e-01],
         [ 8.9698e-02,  1.6666e-01],
         [ 1.2603e-01,  1.7099e-01],
         [ 1.3479e-01,  1.2788e-01],
         [ 1.2585e-01,  1.6298e-01],
         [ 1.2316e-01,  1.7025e-01],
         [ 1.0836e-01,  1.3074e-01],
         [ 1.4075e-01,  1.1070e-01],
         [ 1.6326e-01,  1.3303e-01],
         [ 1.6051e-01,  1.6175e-01],
         [ 1.5899e-01,  1.7727e-01],
         [ 1.4533e-01,  1.8175e-01],
         [ 1.2301e-01,  1.7932e-01],
         [ 1.4013e-01,  1.4871e-01],
         [ 1.1065e-01,  1.1272e-01],
         [ 1.3626e-01,  9.0124e-02],
         [ 1.1515e-01,  7.8353e-02],
         [ 9.4983e-02,  1.1033e-01],
         [ 1.2626e-01,  1.0822e-01],
         [ 7.4159e-02,  9.9798e-02],
         [ 1.2543e-01,  8.4233e-02],
         [ 1.4392e-01,  6.4416e-02],
         [ 1.6508e-01,  7.4158e-02],
         [ 1.7352e-01,  1.1632e-01],
         [ 1.8854e-01,  1.2058e-01],
         [ 1.9502e-01,  8.5832e-02],
         [ 1.9587e-01,  8.4670e-02],
         [ 1.4795e-01,  7.8565e-02],
         [ 1.7444e-01,  1.1174e-01],
         [ 1.8426e-01,  1.2455e-01],
         [ 1.5863e-01,  1.3562e-01],
         [ 1.6563e-01,  1.1498e-01],
         [ 1.7067e-01,  8.9733e-02],
         [ 1.4718e-01,  1.2560e-02],
         [ 1.4951e-01,  3.6383e-02],
         [ 1.5156e-01,  4.8145e-02],
         [ 1.5242e-01,  5.3222e-02],
         [ 1.1260e-01,  5.5104e-02],
         [ 1.1879e-01,  5.5611e-02],
         [ 8.5465e-02,  5.5626e-02],
         [ 7.9264e-02,  5.5467e-02],
         [ 8.7769e-02,  5.5373e-02],
         [ 1.0835e-01,  5.5270e-02],
         [ 2.1686e-01,  5.5225e-02],
         [-8.6134e-04,  5.5217e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.6014e-05, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0022, device='cuda:0')
mixer_td_error tensor(0.1901, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4620, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9363, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0793, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2276, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0508, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-660377.1875, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2659, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0021, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2626, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1284, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2626, device='cuda:0', grad_fn=<MinBackward1>)
t_env 10757
target_mac_out tensor([[[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3268e-01,  1.1815e-01,  ...,  6.9543e-02,
            1.6155e-01, -1.0000e+07],
          [-1.0000e+07, -2.7664e-02,  1.0133e-01,  ...,  1.0988e-02,
            1.3958e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6339e-01,  1.3025e-01,  ...,  7.9943e-02,
            1.7916e-01, -3.7833e-01],
          [-1.0000e+07, -5.6401e-02,  1.3878e-01,  ...,  3.7180e-02,
            1.4673e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2697e-02,  8.6043e-02,  ...,  3.6569e-04,
            1.4043e-01, -1.0000e+07],
          [-1.0000e+07, -3.0029e-02,  9.6760e-02,  ..., -1.6551e-02,
            1.3110e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4736e-02,  1.0545e-01,  ..., -4.9368e-04,
            1.6235e-01, -1.0000e+07],
          [-1.0000e+07, -4.2605e-02,  9.2510e-02,  ..., -3.6784e-02,
            1.3493e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7641e-01, -1.0000e+07,  ...,  4.8869e-02,
           -1.0000e+07, -2.5364e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6360e-01, -1.0000e+07,  ...,  4.3823e-02,
           -1.0000e+07, -2.4145e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.8764e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0827e-01,  1.0736e-01],
         [ 1.1815e-01,  1.0133e-01],
         [ 1.3025e-01,  1.3878e-01],
         [ 1.3240e-01,  1.1431e-01],
         [ 1.0448e-01,  1.4918e-01],
         [ 1.2436e-01,  1.7915e-01],
         [ 1.2844e-01,  1.8166e-01],
         [ 1.3229e-01,  1.9128e-01],
         [ 1.3505e-01,  1.8584e-01],
         [ 1.0547e-01,  1.4130e-01],
         [ 8.2169e-02,  1.3691e-01],
         [ 1.0412e-01,  1.3116e-01],
         [ 6.1420e-02,  8.4717e-02],
         [ 5.8766e-02, -1.6345e-01],
         [ 1.3083e-01,  9.9431e-02],
         [ 8.9016e-02,  7.0875e-02],
         [ 2.8278e-02,  4.8883e-02],
         [ 3.4007e-02,  1.0005e-01],
         [ 1.1510e-01,  1.1522e-01],
         [ 1.4223e-01,  1.1503e-01],
         [ 1.1554e-01,  8.1579e-02],
         [ 3.4286e-02,  8.9438e-02],
         [ 4.8491e-02,  6.6553e-02],
         [ 5.2648e-02,  5.6278e-02],
         [ 5.3158e-02,  8.9652e-02],
         [ 5.2547e-02,  1.0503e-01],
         [ 5.1760e-02,  9.2597e-02],
         [ 5.1121e-02,  5.7361e-02],
         [ 5.0658e-02,  5.1441e-02],
         [ 5.0389e-02,  9.0533e-02],
         [ 5.0232e-02,  6.7912e-02],
         [ 5.0121e-02,  9.5607e-02],
         [ 5.0043e-02,  6.7202e-02],
         [ 5.0036e-02,  9.4253e-02],
         [ 5.0026e-02,  5.6716e-02],
         [ 5.0025e-02,  8.9315e-02],
         [ 5.0005e-02, -1.9228e-01],
         [ 5.0005e-02,  4.0328e-02],
         [ 5.0012e-02,  4.2815e-02],
         [ 5.0015e-02,  3.6041e-02],
         [ 5.0016e-02,  5.3236e-02],
         [ 5.0014e-02, -1.8276e-01],
         [ 5.0008e-02, -1.9434e-01],
         [ 5.0007e-02,  2.7962e-02],
         [ 5.0007e-02,  1.3797e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 7.0205e-02,  9.0702e-02],
         [ 8.6043e-02,  9.6760e-02],
         [ 1.0545e-01,  9.2510e-02],
         [ 1.1684e-01,  1.1852e-01],
         [ 8.6330e-02,  1.1198e-01],
         [ 1.0207e-01,  1.3997e-01],
         [ 9.8591e-02,  1.2643e-01],
         [ 1.0087e-01,  1.4404e-01],
         [ 6.5937e-02,  9.4678e-02],
         [ 9.9763e-02,  4.1951e-02],
         [-5.2935e-02,  2.8135e-02],
         [ 9.7529e-02,  6.9178e-02],
         [ 1.1645e-01,  8.7885e-02],
         [-8.8876e-03,  6.8681e-02],
         [ 1.5746e-01,  1.0094e-01],
         [ 1.7028e-01,  1.0275e-01],
         [-1.4500e-02,  1.2239e-01],
         [-2.1032e-02,  1.1724e-01],
         [-5.2192e-02,  1.2663e-01],
         [ 1.3004e-01,  1.1875e-01],
         [-1.0766e-02,  8.1665e-02],
         [ 1.5515e-01,  9.9348e-02],
         [ 1.0939e-01,  7.6186e-02],
         [ 1.0205e-01, -1.4736e-01],
         [ 9.8908e-02, -1.1912e-01],
         [ 7.4470e-02, -1.0494e-01],
         [ 9.3168e-02, -1.0517e-01],
         [ 8.7312e-02,  1.1129e-01],
         [ 1.1217e-01,  1.2810e-01],
         [ 1.2174e-01, -9.1623e-02],
         [ 9.7153e-02, -8.8893e-02],
         [ 9.9713e-02,  1.5014e-02],
         [-5.2899e-02,  3.8661e-02],
         [-5.3683e-02,  5.0011e-02],
         [-1.7810e-02,  5.4585e-02],
         [-1.7715e-02,  5.6052e-02],
         [ 9.7084e-04,  5.6262e-02],
         [ 1.4634e-01,  5.6071e-02],
         [-3.3435e-02,  5.5783e-02],
         [ 9.7480e-02,  5.5577e-02],
         [ 8.4765e-02,  5.5432e-02],
         [-6.2284e-02,  5.5317e-02],
         [-5.1036e-02,  5.5260e-02],
         [ 8.6271e-02,  5.5217e-02],
         [-4.0350e-02,  5.5217e-02],
         [-6.4252e-02,  5.5210e-02],
         [ 9.9936e-02,  5.5211e-02],
         [ 1.0516e-01,  5.5226e-02],
         [ 1.0705e-01,  5.5208e-02],
         [ 1.0676e-01,  5.5218e-02],
         [ 1.2654e-01,  5.5221e-02],
         [ 1.3537e-01,  5.5223e-02],
         [-1.3124e-01,  5.5232e-02],
         [ 1.1663e-01,  5.5230e-02],
         [ 7.9174e-02,  5.5230e-02],
         [ 1.2274e-01,  5.5231e-02],
         [ 9.6635e-02,  5.5236e-02],
         [ 1.0700e-01,  5.5235e-02],
         [ 1.0815e-01,  5.5232e-02],
         [ 1.2503e-01,  5.5232e-02],
         [ 1.2374e-01,  5.5231e-02],
         [ 1.3389e-01,  5.5231e-02],
         [ 1.5225e-01,  5.5231e-02],
         [ 1.5867e-01,  5.5231e-02],
         [ 1.6042e-01,  5.5231e-02],
         [ 1.1433e-01,  5.5231e-02],
         [ 9.6289e-02,  5.5231e-02],
         [ 1.3500e-01,  5.5231e-02],
         [ 1.3141e-01,  5.5231e-02],
         [ 1.3824e-01,  5.5231e-02],
         [ 1.3149e-01,  5.5231e-02],
         [ 1.0908e-01,  5.5231e-02],
         [ 7.1149e-02,  5.5231e-02],
         [ 5.7339e-02,  5.5231e-02],
         [-1.0519e-01,  5.5231e-02],
         [ 4.3823e-02,  5.5231e-02],
         [ 1.8764e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.0358e-05, device='cuda:0') tensor(0.0014, device='cuda:0') tensor(-0.0017, device='cuda:0')
mixer_td_error tensor(0.5300, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.6017, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6665, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0700, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2266, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0334, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2077921.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1913, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.6067e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0980, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2506, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0980, device='cuda:0', grad_fn=<MinBackward1>)
t_env 10802
target_mac_out tensor([[[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2569e-02,  8.7906e-02,  ...,  2.3893e-02,
            1.1855e-01, -1.0000e+07],
          [-1.0000e+07, -8.0652e-02,  1.5325e-01,  ...,  7.7602e-02,
            1.6031e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.5652e-02,  1.0565e-01,  ...,  1.8007e-02,
            1.4507e-01, -1.0000e+07],
          [-1.0000e+07, -8.3956e-02,  1.4261e-01,  ...,  5.7116e-02,
            1.5566e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0027e-01,  8.7508e-02,  ...,  1.6592e-02,
            1.4820e-01, -1.0000e+07],
          [-1.0000e+07, -3.2708e-02,  1.3921e-01,  ..., -3.3578e-03,
            1.4695e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2632e-01,  1.0870e-01,  ...,  6.6274e-02,
            1.6961e-01, -1.0000e+07],
          [-1.0000e+07, -5.3215e-02,  6.7365e-02,  ...,  1.8223e-02,
            1.6311e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5986e-01,  3.4481e-02,  ...,  6.1996e-02,
            1.9639e-01, -3.1123e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4472e-01,  3.5980e-02,  ...,  3.7583e-02,
            1.9018e-01, -3.0634e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.6392e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.3473e-02,  1.3755e-01],
         [ 8.7906e-02,  1.5325e-01],
         [ 1.0565e-01,  1.4261e-01],
         [ 1.0351e-01,  1.1348e-01],
         [ 8.8090e-02, -1.0608e-01],
         [ 1.1882e-01,  1.2928e-01],
         [ 9.9561e-02,  1.3723e-01],
         [ 1.2363e-01,  1.4506e-01],
         [ 6.5318e-02, -1.2748e-01],
         [ 1.2208e-01,  1.4242e-01],
         [ 1.1800e-01, -1.3136e-01],
         [-8.6638e-02,  6.2815e-02],
         [ 1.1370e-01,  1.1390e-01],
         [ 1.2860e-01,  1.4418e-01],
         [ 1.0395e-01,  1.0332e-01],
         [-8.8521e-02,  1.2851e-01],
         [ 1.1170e-01,  1.1643e-01],
         [ 1.1241e-01,  1.4207e-01],
         [-8.3154e-02,  1.3113e-01],
         [-8.6990e-02,  1.3190e-01],
         [ 1.1162e-01,  1.4323e-01],
         [-7.3150e-02,  9.3496e-02],
         [-7.8750e-02,  1.3132e-01],
         [-8.2890e-02, -1.2005e-01],
         [ 8.9147e-02, -1.1529e-01],
         [-7.6824e-02, -9.0938e-02],
         [ 1.1448e-01, -1.0947e-01],
         [ 1.2038e-01, -9.6438e-02],
         [ 1.2577e-01, -1.0503e-01],
         [ 1.2521e-01, -1.2193e-01],
         [-1.0542e-01, -1.1585e-01],
         [ 1.1018e-01, -1.1358e-01],
         [ 1.1800e-01, -1.1627e-01],
         [ 1.2394e-01, -1.3227e-01],
         [ 1.2614e-01, -2.0583e-02],
         [ 1.2790e-01,  2.1121e-02],
         [ 1.4071e-01,  4.1139e-02],
         [ 1.4327e-01,  5.0013e-02],
         [-1.8372e-01,  5.3649e-02],
         [ 1.3219e-01,  5.4989e-02],
         [ 1.3399e-01,  5.5372e-02],
         [ 1.2358e-01,  5.5418e-02],
         [ 9.1060e-02,  5.5400e-02],
         [ 1.2915e-01,  5.5328e-02],
         [ 9.9660e-02,  5.5259e-02],
         [ 8.8715e-02,  5.5233e-02],
         [ 8.1559e-02,  5.5210e-02],
         [ 9.3809e-02,  5.5212e-02],
         [ 1.1579e-01,  5.5213e-02],
         [ 1.2067e-01,  5.5188e-02],
         [ 9.3831e-02,  5.5206e-02],
         [ 1.2541e-01,  5.5219e-02],
         [ 8.8645e-02,  5.5206e-02],
         [-1.7483e-01,  5.5216e-02],
         [ 8.6726e-02,  5.5223e-02],
         [ 1.1302e-01,  5.5232e-02],
         [ 1.1400e-01,  5.5230e-02],
         [-1.4477e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0827e-01,  1.0736e-01],
         [ 8.7508e-02,  1.3921e-01],
         [ 1.0870e-01,  6.7365e-02],
         [ 8.2676e-02,  8.8595e-02],
         [ 1.0342e-01, -5.8022e-02],
         [ 1.2524e-01, -3.7118e-02],
         [ 1.3379e-01, -1.4494e-02],
         [ 1.7991e-01, -1.3406e-02],
         [ 1.3890e-01, -6.8513e-04],
         [ 1.3879e-01, -1.7428e-02],
         [ 1.2241e-01,  8.3460e-02],
         [ 1.4056e-01,  9.0942e-02],
         [ 1.3664e-01, -2.4599e-02],
         [ 1.0328e-01,  7.9357e-02],
         [ 1.2316e-01, -1.1423e-02],
         [ 1.0840e-01, -4.0932e-02],
         [ 1.0077e-01, -5.9023e-02],
         [ 1.2692e-01,  9.8032e-02],
         [ 9.0400e-02, -6.7042e-02],
         [ 1.3365e-01, -5.7375e-02],
         [ 3.9513e-02,  8.0674e-02],
         [ 1.1883e-01, -6.6276e-02],
         [ 1.1402e-01,  8.3680e-02],
         [ 1.1104e-01, -7.2429e-02],
         [ 1.1588e-01,  6.9996e-02],
         [-1.8897e-02,  8.1780e-02],
         [ 1.8561e-02, -5.9249e-02],
         [ 3.6768e-02, -5.8306e-02],
         [ 4.5229e-02, -3.6783e-02],
         [ 4.8837e-02, -3.0812e-02],
         [ 5.0221e-02, -3.0102e-02],
         [ 5.0555e-02, -3.4016e-02],
         [ 5.0527e-02, -5.4318e-02],
         [ 5.0399e-02, -4.8614e-02],
         [ 5.0284e-02,  8.5507e-02],
         [ 5.0193e-02, -4.9002e-02],
         [ 5.0101e-02, -5.6941e-02],
         [ 5.0049e-02, -6.7333e-02],
         [ 5.0037e-02,  1.0242e-01],
         [ 5.0020e-02, -6.1953e-02],
         [ 5.0022e-02, -7.5035e-02],
         [ 5.0022e-02, -5.8295e-02],
         [ 5.0014e-02, -3.6121e-02],
         [ 5.0015e-02, -4.3320e-02],
         [ 5.0014e-02, -5.2644e-02],
         [ 5.0012e-02, -6.4957e-02],
         [ 5.0007e-02, -6.8843e-02],
         [ 5.0008e-02,  7.5652e-02],
         [ 5.0007e-02, -8.2457e-02],
         [ 5.0007e-02,  7.9812e-02],
         [ 5.0008e-02,  9.1310e-02],
         [ 5.0008e-02,  9.5323e-02],
         [ 5.0008e-02, -1.9900e-01],
         [ 5.0008e-02, -1.8328e-01],
         [ 5.0008e-02,  6.4772e-02],
         [ 5.0008e-02,  9.8709e-02],
         [ 5.0008e-02,  1.0575e-01],
         [ 5.0009e-02,  7.6806e-02],
         [ 5.0009e-02,  1.0344e-01],
         [ 5.0009e-02,  7.4231e-02],
         [ 5.0009e-02,  8.2473e-02],
         [ 5.0009e-02,  9.6072e-02],
         [ 5.0009e-02,  9.5517e-02],
         [ 5.0009e-02, -2.1723e-01],
         [ 5.0009e-02, -2.3575e-01],
         [ 5.0009e-02,  2.3484e-01],
         [ 5.0009e-02,  2.3829e-01],
         [ 5.0009e-02, -2.2867e-01],
         [ 5.0009e-02, -1.8407e-01],
         [ 5.0009e-02, -1.5986e-01],
         [ 5.0009e-02, -1.4472e-01],
         [ 5.0009e-02,  1.6392e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.4958e-06, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0017, device='cuda:0')
mixer_td_error tensor(0.2367, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4553, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5962, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0685, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1539, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0204, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-972222.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2383, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.3137e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1983, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.3190, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1983, device='cuda:0', grad_fn=<MinBackward1>)
t_env 10850
target_mac_out tensor([[[[-1.0000e+07, -5.5215e-02,  8.8677e-02,  ...,  2.3305e-02,
            1.2081e-01, -1.0000e+07],
          [-1.0000e+07, -5.3949e-02,  1.3771e-01,  ...,  6.3333e-02,
            1.3943e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.0181e-02,  8.6626e-02,  ..., -9.5708e-03,
            1.2989e-01, -1.0000e+07],
          [-1.0000e+07, -7.4152e-02,  1.2086e-01,  ...,  2.6294e-02,
            1.4673e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1307e-01,  1.1981e-01,  ...,  3.3674e-02,
            1.5241e-01, -1.0000e+07],
          [-1.0000e+07, -8.2276e-02,  1.2745e-01,  ...,  2.7538e-02,
            1.4106e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.4255e-02,  8.7945e-02,  ...,  2.1998e-02,
            1.2409e-01, -1.0000e+07],
          [-1.0000e+07, -2.5887e-02,  1.2012e-01,  ...,  1.5133e-02,
            1.3440e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1273e-01,  1.1124e-01,  ...,  5.0026e-02,
            1.5192e-01, -1.0000e+07],
          [-1.0000e+07, -2.8288e-02,  1.2078e-01,  ..., -1.6993e-03,
            1.3633e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3949e-01,  1.1778e-01,  ...,  6.2724e-02,
            1.6590e-01, -1.0000e+07],
          [-1.0000e+07, -4.1846e-02,  1.0417e-01,  ...,  5.9260e-03,
            1.4721e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3112e-01,  3.0487e-02,  ...,  3.3255e-02,
            1.7802e-01, -2.9995e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3179e-01,  4.9267e-02,  ...,  3.3886e-02,
            1.8237e-01, -3.0199e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.1532e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 8.8677e-02,  1.3771e-01],
         [ 8.6626e-02,  1.2086e-01],
         [ 1.1981e-01,  1.2745e-01],
         [ 8.6638e-02,  1.0232e-01],
         [-9.1882e-02,  1.0304e-01],
         [-1.0480e-01,  9.3885e-02],
         [-1.3044e-01,  1.0003e-01],
         [-1.3801e-01,  1.0173e-01],
         [ 1.4090e-01,  1.3144e-01],
         [-1.4133e-01,  1.1105e-01],
         [-1.1945e-01,  1.3522e-01],
         [ 1.1466e-01,  1.1080e-01],
         [ 1.3041e-01,  1.3074e-01],
         [ 1.1573e-01,  9.9906e-02],
         [ 1.2316e-01,  1.2942e-01],
         [ 1.2600e-01,  1.6450e-01],
         [-1.0501e-01,  1.2582e-01],
         [-8.9802e-02, -1.0158e-01],
         [-9.3077e-02,  1.1805e-01],
         [ 1.2244e-01,  1.6105e-01],
         [ 1.3036e-01,  1.1225e-01],
         [ 1.3482e-01,  1.2226e-01],
         [-9.8796e-02,  1.4886e-01],
         [ 1.1557e-01, -1.1134e-01],
         [ 1.2741e-01, -1.2025e-01],
         [ 1.3774e-01,  1.3669e-01],
         [ 1.3239e-01,  1.2383e-01],
         [ 1.3569e-01,  7.5305e-02],
         [ 1.2871e-01,  6.8583e-02],
         [ 1.3286e-01,  1.3564e-01],
         [ 1.3568e-01,  9.0244e-02],
         [ 1.5270e-01,  1.0562e-01],
         [ 1.6016e-01,  1.2983e-01],
         [ 1.2421e-01, -1.3737e-01],
         [ 1.4614e-01, -1.5087e-01],
         [ 1.5815e-01, -1.5356e-01],
         [ 1.2155e-01, -1.5320e-01],
         [ 1.1227e-01, -1.2429e-01],
         [-1.4277e-01, -1.0589e-01],
         [-1.2448e-01,  4.1684e-03],
         [-1.5062e-01,  3.4376e-02],
         [-1.3002e-01,  4.7756e-02],
         [-1.3171e-01,  5.3130e-02],
         [ 1.1413e-01,  5.5048e-02],
         [ 1.1961e-01,  5.5533e-02],
         [ 9.2008e-02,  5.5533e-02],
         [-1.3975e-01,  5.5434e-02],
         [ 9.4941e-02,  5.5329e-02],
         [ 1.2222e-01,  5.5255e-02],
         [-1.3822e-01,  5.5219e-02],
         [ 1.0778e-01,  5.5193e-02],
         [ 1.2786e-01,  5.5194e-02],
         [ 1.2301e-01,  5.5204e-02],
         [ 1.3079e-01,  5.5222e-02],
         [ 1.4861e-01,  5.5196e-02],
         [ 1.3925e-01,  5.5221e-02],
         [ 1.1287e-01,  5.5210e-02],
         [ 1.3083e-01,  5.5209e-02],
         [ 1.3546e-01,  5.5223e-02],
         [ 1.0637e-01,  5.5226e-02],
         [-1.3982e-01,  5.5232e-02],
         [ 1.0530e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 8.7945e-02,  1.2012e-01],
         [ 1.1124e-01,  1.2078e-01],
         [ 1.1778e-01,  1.0417e-01],
         [ 8.2115e-02, -4.4190e-02],
         [ 6.9994e-02, -6.1806e-02],
         [ 9.9942e-02,  1.0315e-01],
         [ 7.9481e-02, -7.6493e-02],
         [ 9.9399e-02, -6.5153e-02],
         [ 1.2096e-01, -6.0216e-02],
         [ 1.1423e-01, -4.2425e-02],
         [ 1.4026e-01, -5.5310e-02],
         [ 1.5458e-01,  1.2777e-01],
         [ 1.5514e-01,  1.6955e-01],
         [ 1.3585e-01,  1.8565e-01],
         [ 1.2806e-01,  1.6920e-01],
         [ 1.3182e-01,  1.5810e-01],
         [ 9.7056e-02, -1.2473e-01],
         [ 7.2768e-02, -1.3495e-01],
         [ 9.5892e-02, -1.0281e-01],
         [ 1.2980e-01, -8.3347e-02],
         [-1.0474e-01, -6.5724e-02],
         [-1.3156e-01, -5.4726e-02],
         [-1.4937e-01,  6.9679e-02],
         [-1.4966e-01,  7.7111e-02],
         [-1.5383e-01,  9.3472e-02],
         [-1.9779e-02,  9.2868e-02],
         [ 1.6939e-02, -7.3669e-02],
         [ 3.5607e-02, -8.5955e-02],
         [ 4.4467e-02, -6.9249e-02],
         [ 4.8327e-02, -4.5402e-02],
         [ 4.9870e-02, -2.5433e-02],
         [ 5.0344e-02, -4.5479e-02],
         [ 5.0395e-02, -3.2975e-02],
         [ 5.0311e-02, -3.1764e-02],
         [ 5.0196e-02, -1.2371e-02],
         [ 5.0133e-02, -4.1709e-02],
         [ 5.0086e-02, -5.9692e-02],
         [ 5.0052e-02, -5.2178e-02],
         [ 5.0039e-02, -5.0267e-02],
         [ 5.0028e-02, -5.0773e-02],
         [ 5.0032e-02, -4.6974e-02],
         [ 5.0018e-02,  7.5708e-02],
         [ 5.0015e-02, -5.3225e-02],
         [ 5.0019e-02, -3.2994e-02],
         [ 5.0013e-02, -3.3843e-02],
         [ 5.0013e-02, -3.6646e-02],
         [ 5.0019e-02, -1.6743e-02],
         [ 5.0005e-02, -2.7649e-02],
         [ 5.0007e-02, -3.3444e-02],
         [ 5.0008e-02, -1.5049e-02],
         [ 5.0008e-02, -2.4350e-02],
         [ 5.0008e-02, -4.3039e-02],
         [ 5.0008e-02, -4.6312e-02],
         [ 5.0008e-02, -4.8981e-02],
         [ 5.0008e-02, -4.5942e-02],
         [ 5.0008e-02, -5.4545e-02],
         [ 5.0008e-02, -4.0652e-02],
         [ 5.0008e-02, -2.4214e-02],
         [ 5.0009e-02, -4.5475e-02],
         [ 5.0009e-02, -6.1494e-02],
         [ 5.0009e-02, -5.8927e-02],
         [ 5.0009e-02,  9.9748e-02],
         [ 5.0009e-02, -1.0902e-01],
         [ 5.0009e-02, -1.2408e-01],
         [ 5.0009e-02, -1.1485e-01],
         [ 5.0009e-02, -1.0196e-01],
         [ 5.0009e-02,  9.2505e-02],
         [ 5.0009e-02,  1.0942e-01],
         [ 5.0009e-02,  1.2428e-01],
         [ 5.0009e-02,  6.9201e-02],
         [ 5.0009e-02,  5.4565e-02],
         [ 5.0009e-02,  7.6895e-02],
         [ 5.0009e-02, -1.6648e-01],
         [ 5.0009e-02,  8.8820e-02],
         [ 5.0009e-02,  8.9315e-02],
         [ 5.0009e-02,  1.1507e-01],
         [ 5.0009e-02, -1.7928e-01],
         [ 5.0009e-02, -1.6292e-01],
         [ 5.0009e-02,  9.7959e-02],
         [ 5.0009e-02,  9.7808e-02],
         [ 5.0009e-02, -1.6426e-01],
         [ 5.0009e-02, -1.3798e-01],
         [ 5.0009e-02, -1.3112e-01],
         [ 5.0009e-02, -1.3179e-01],
         [ 5.0009e-02,  1.1532e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.9513e-06, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0018, device='cuda:0')
mixer_td_error tensor(0.3289, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4583, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6514, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0628, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1846, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0207, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1352941.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1857, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.9289e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1157, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2467, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1157, device='cuda:0', grad_fn=<MinBackward1>)
t_env 11056
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1402e-02,  8.1983e-02,  ...,  3.9429e-02,
            1.3744e-01, -1.0000e+07],
          [-1.0000e+07, -3.2219e-02,  9.6327e-02,  ..., -1.4636e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2918e-02,  8.3033e-02,  ...,  1.5905e-03,
            1.3806e-01, -1.0000e+07],
          [-1.0000e+07, -4.3941e-02,  1.2828e-01,  ...,  1.4506e-02,
            1.4886e-01, -1.0000e+07]],

         ...,

         [[ 5.0062e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1756e-01,  6.2249e-02,  ...,  7.2620e-02,
            1.8534e-01, -1.0000e+07]],

         [[ 5.0040e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3118e-01,  7.9832e-02,  ...,  8.7176e-02,
            1.9510e-01, -1.0000e+07]],

         [[ 5.0049e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.4158e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5738e-02,  1.0228e-01,  ...,  3.4988e-02,
            1.5796e-01, -1.0000e+07],
          [-1.0000e+07, -8.0973e-02,  1.6355e-01,  ...,  7.3632e-02,
            1.5107e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9340e-02,  8.3458e-02,  ...,  3.0472e-03,
            1.5527e-01, -1.0000e+07],
          [-1.0000e+07, -8.6661e-02,  1.3718e-01,  ...,  5.7992e-02,
            1.4966e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.0687e-02,  8.9914e-02],
         [-7.1402e-02,  9.6327e-02],
         [-7.2918e-02,  1.2828e-01],
         [-8.7103e-02, -4.5109e-02],
         [-1.1015e-01,  1.0456e-01],
         [-1.1875e-01,  9.7676e-02],
         [-9.7095e-02,  9.3238e-02],
         [-7.6133e-02, -5.1762e-02],
         [-8.9235e-02, -5.1922e-02],
         [-6.7292e-02, -6.2554e-02],
         [-6.5269e-02,  1.1981e-01],
         [-9.1613e-02, -6.3487e-02],
         [-1.0219e-01,  1.2250e-01],
         [-8.5358e-02,  1.3508e-01],
         [-1.0168e-01,  1.3824e-01],
         [ 1.6550e-01, -7.3815e-02],
         [-2.1922e-02, -6.7031e-02],
         [-3.9386e-02, -6.8664e-02],
         [-6.4434e-02, -6.4707e-02],
         [-5.4748e-02, -2.6864e-02],
         [ 1.4503e-01, -2.1727e-02],
         [ 1.7699e-01, -2.0110e-02],
         [ 2.1308e-01, -2.8294e-03],
         [ 2.2450e-01, -2.0002e-02],
         [-6.0319e-02, -3.2747e-02],
         [-8.0236e-02, -5.0096e-02],
         [ 1.4927e-01, -6.6565e-02],
         [ 1.5257e-01, -9.4225e-02],
         [ 1.6329e-01, -8.7534e-02],
         [ 1.6940e-01, -1.2107e-01],
         [ 1.8631e-01, -1.3281e-01],
         [ 1.5079e-01, -1.4084e-01],
         [ 1.5646e-01, -1.2870e-01],
         [ 1.5936e-01, -1.4400e-01],
         [ 1.6924e-01,  1.3301e-01],
         [ 1.3913e-01, -1.5414e-01],
         [ 1.6944e-01, -1.2114e-01],
         [ 1.4515e-01, -9.8612e-02],
         [ 1.6190e-01, -9.0985e-02],
         [ 1.7382e-01, -8.7942e-02],
         [ 1.8228e-01,  1.5498e-01],
         [ 1.8840e-01,  1.2613e-01],
         [ 1.8909e-01,  1.5074e-01],
         [ 1.6448e-01,  1.2795e-01],
         [ 1.2279e-01, -8.4086e-02],
         [ 1.3814e-01, -5.1586e-02],
         [ 1.3328e-01, -8.0809e-02],
         [ 1.3287e-01, -5.4521e-02],
         [-2.1504e-01, -6.2789e-02],
         [-2.1057e-01, -9.1137e-02],
         [-2.0906e-01, -1.0182e-01],
         [-1.9690e-01,  6.9637e-02],
         [-1.9094e-01, -1.2219e-01],
         [-1.8092e-01,  7.9863e-02],
         [-1.5370e-01,  8.8000e-02],
         [ 5.3851e-03, -1.5797e-01],
         [ 3.0878e-02, -1.6128e-01],
         [ 4.3042e-02, -1.7397e-01],
         [ 4.8367e-02, -1.5752e-01],
         [ 5.0411e-02, -1.6190e-01],
         [ 5.0932e-02, -1.3685e-01],
         [ 5.0872e-02, -1.4828e-01],
         [ 5.0672e-02, -1.4777e-01],
         [ 5.0470e-02, -1.3951e-01],
         [ 5.0299e-02, -1.2128e-01],
         [ 5.0180e-02, -1.0585e-01],
         [ 5.0109e-02, -9.9846e-02],
         [ 5.0062e-02, -1.1756e-01],
         [ 5.0040e-02, -1.3118e-01],
         [ 5.0049e-02,  4.4158e-03]],

        [[ 7.4276e-02,  1.4162e-01],
         [ 1.0228e-01,  1.6355e-01],
         [-8.9340e-02, -8.6661e-02],
         [ 9.4873e-02,  1.6107e-01],
         [ 9.2995e-02, -1.1286e-01],
         [-7.5270e-02, -1.6305e-01],
         [-3.2274e-02, -1.6909e-01],
         [-5.6711e-02,  5.6596e-02],
         [-5.6835e-02, -1.5781e-01],
         [-8.4709e-02,  6.8284e-02],
         [-9.5924e-02,  9.9470e-02],
         [-6.0254e-02,  9.7842e-02],
         [-4.5000e-02,  9.4670e-02],
         [-6.4142e-02, -1.7048e-01],
         [-9.1050e-02, -1.5858e-01],
         [-1.1952e-01, -1.3573e-01],
         [-1.3677e-01, -1.3726e-01],
         [-1.5914e-01,  8.5068e-02],
         [-1.4223e-01, -1.2778e-01],
         [-1.0686e-01, -1.3749e-01],
         [ 1.6239e-01, -1.2130e-01],
         [ 1.3284e-01, -1.1298e-01],
         [ 1.3487e-01, -1.1455e-01],
         [ 1.3459e-01, -1.1997e-01],
         [ 1.3435e-01, -1.1649e-01],
         [ 9.9571e-02,  2.1531e-01],
         [ 1.3205e-01,  1.1499e-01],
         [ 9.7605e-02, -1.0372e-01],
         [ 1.3128e-01,  1.1256e-01],
         [ 9.8719e-02, -1.0853e-01],
         [ 9.5475e-02, -9.7033e-02],
         [-1.9423e-01,  8.6081e-02],
         [-1.8798e-01, -9.9405e-02],
         [-1.7706e-01, -8.5795e-02],
         [-1.5517e-01, -8.5698e-02],
         [-1.6065e-01,  8.0822e-02],
         [-1.1230e-02, -1.1529e-01],
         [ 1.7815e-02, -1.2824e-01],
         [ 3.4352e-02, -1.6022e-01],
         [ 4.2956e-02, -1.5952e-01],
         [ 4.7145e-02, -1.7761e-01],
         [ 4.8980e-02, -1.8667e-01],
         [ 4.9755e-02, -1.6906e-01],
         [ 5.0012e-02, -1.5415e-01],
         [ 5.0067e-02, -1.4049e-01],
         [ 5.0066e-02, -1.5667e-01],
         [ 5.0039e-02, -1.5141e-01],
         [ 5.0022e-02,  1.7288e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(0.0001, device='cuda:0') tensor(0.0012, device='cuda:0') tensor(-0.0010, device='cuda:0')
mixer_td_error tensor(0.4370, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5805, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3742, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0582, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1635, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0295, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1571428.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2245, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.8758e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1691, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3292, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1691, device='cuda:0', grad_fn=<MinBackward1>)
t_env 11153
target_mac_out tensor([[[[-1.0000e+07, -6.0082e-02,  8.4218e-02,  ...,  2.3512e-02,
            1.2572e-01, -1.0000e+07],
          [-1.0000e+07, -1.1235e-02,  1.0290e-01,  ...,  6.8675e-03,
            1.2423e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.2166e-02,  6.8892e-02,  ...,  2.0706e-02,
            1.2918e-01, -1.0000e+07],
          [-1.0000e+07, -2.6887e-02,  9.4779e-02,  ..., -3.0197e-02,
            1.3592e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.2329e-02,  8.4675e-02,  ...,  2.7623e-02,
            1.2800e-01, -1.0000e+07],
          [-1.0000e+07, -3.4005e-02,  1.1766e-01,  ..., -2.4395e-02,
            1.5136e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0502e-01,  1.0369e-01,  ...,  8.0920e-02,
            1.7069e-01, -3.3412e-01],
          [ 5.5245e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.9781e-01,  1.1003e-01,  ...,  6.6378e-02,
            1.6438e-01, -3.2739e-01],
          [ 5.5197e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.1414e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5197e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2489e-02,  1.2578e-01,  ...,  5.0639e-02,
            1.4352e-01, -1.0000e+07],
          [-1.0000e+07, -3.4800e-02,  8.5615e-02,  ..., -3.3144e-02,
            1.3339e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.6344e-02,  1.0249e-01,  ...,  3.1700e-02,
            1.3221e-01, -1.0000e+07],
          [-1.0000e+07, -7.1485e-02,  1.3421e-01,  ...,  3.2735e-02,
            1.5583e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-6.0082e-02, -1.1235e-02],
         [-5.2166e-02, -2.6887e-02],
         [-4.2329e-02, -3.4005e-02],
         [-5.0920e-02, -2.6934e-02],
         [-4.5314e-02, -3.3303e-02],
         [-6.9430e-02, -2.5442e-02],
         [-7.0328e-02, -4.0331e-02],
         [-9.2667e-02, -3.5873e-02],
         [-1.0220e-01, -5.3483e-02],
         [ 5.8534e-02, -6.4909e-02],
         [ 4.8979e-02, -6.7606e-02],
         [ 4.8830e-02, -7.2593e-02],
         [ 7.4715e-02, -8.2670e-02],
         [ 6.9918e-02, -7.8127e-02],
         [ 6.3506e-02, -8.0576e-02],
         [-1.2759e-01, -6.7412e-02],
         [ 8.1108e-02, -6.9904e-02],
         [ 7.5599e-02, -7.6303e-02],
         [ 5.7756e-02, -7.3913e-02],
         [ 8.3171e-02, -8.4037e-02],
         [ 7.8598e-02, -7.6820e-02],
         [ 4.9821e-02, -5.0779e-02],
         [ 5.7905e-02, -6.9682e-02],
         [ 6.3401e-02, -7.5276e-02],
         [ 6.7335e-02, -8.3085e-02],
         [ 4.7201e-02, -8.2818e-02],
         [-1.2022e-01, -7.9199e-02],
         [-9.4891e-02, -6.4612e-02],
         [-9.0553e-02, -6.5013e-02],
         [ 5.5593e-02, -6.8251e-02],
         [-1.0538e-01, -5.5407e-02],
         [-9.5512e-02, -6.7339e-02],
         [-1.0488e-01, -7.6380e-02],
         [-9.6228e-02, -8.4761e-02],
         [-8.7607e-02, -6.9856e-02],
         [-8.7589e-02, -3.9461e-02],
         [-9.4563e-02, -3.8446e-02],
         [-9.9237e-02, -5.2169e-02],
         [-8.9393e-02, -5.7640e-02],
         [-8.8533e-02, -6.2195e-02],
         [-9.7396e-02, -6.7250e-02],
         [-1.0762e-01, -1.1238e-01],
         [-1.0512e-01, -1.2903e-01],
         [-1.1138e-01, -1.1874e-01],
         [-1.2807e-01, -1.1190e-01],
         [-1.1605e-01, -1.4773e-01],
         [-1.1951e-01, -1.4122e-01],
         [ 1.4448e-01, -1.7805e-01],
         [-1.4099e-01, -1.6550e-01],
         [-1.4278e-01, -1.7661e-01],
         [-1.4231e-01, -1.7584e-01],
         [ 1.2901e-01, -1.7548e-01],
         [ 1.3669e-01, -1.7266e-01],
         [-1.4729e-01, -1.6616e-01],
         [-1.3887e-01, -1.4828e-01],
         [-1.3587e-01, -1.4651e-01],
         [ 1.2504e-01, -1.5099e-01],
         [ 1.2884e-01, -1.4856e-01],
         [ 1.4173e-01, -1.3897e-01],
         [ 1.4480e-01, -1.3261e-01],
         [ 1.4636e-01, -1.3391e-01],
         [-2.0157e-01, -1.5428e-01],
         [-2.0495e-01, -1.3408e-02],
         [-2.2562e-01,  2.3950e-02],
         [-1.9220e-01,  4.2304e-02],
         [-1.8752e-01,  5.0491e-02],
         [-1.9526e-01,  5.3827e-02],
         [-2.0306e-01,  5.5006e-02],
         [ 8.2808e-02,  5.5329e-02],
         [-2.0464e-01,  5.5364e-02],
         [-1.7740e-01,  5.5317e-02],
         [-2.0502e-01,  5.5245e-02],
         [-1.9781e-01,  5.5197e-02],
         [-1.1414e-02,  5.5197e-02]],

        [[-4.8078e-02, -2.1879e-02],
         [ 5.0639e-02, -3.4800e-02],
         [-6.6344e-02, -7.1485e-02],
         [ 5.9981e-02, -9.1662e-02],
         [-1.1719e-01, -8.7805e-02],
         [-1.4753e-01, -8.1989e-02],
         [-1.5531e-01, -8.5619e-02],
         [-1.6347e-01, -9.8079e-02],
         [-1.5766e-01, -1.0705e-01],
         [-1.5766e-01,  1.4933e-01],
         [-1.4296e-01, -1.4730e-01],
         [-1.3733e-01, -1.4459e-01],
         [ 3.7083e-02, -1.3934e-01],
         [ 4.6860e-02, -1.7457e-01],
         [ 1.6788e-01,  1.0997e-01],
         [ 1.8012e-01, -1.8757e-01],
         [ 1.8889e-01, -1.7359e-01],
         [ 1.9634e-01, -1.6268e-01],
         [-1.8097e-01, -1.7040e-01],
         [-1.7159e-01, -1.8742e-01],
         [ 2.0244e-01, -1.9846e-01],
         [ 2.0096e-01, -2.0000e-01],
         [ 1.9990e-01, -2.0236e-01],
         [ 7.7906e-02, -1.5885e-01],
         [-1.7623e-01, -1.7802e-01],
         [ 1.8139e-01, -1.9529e-01],
         [-3.6288e-02, -1.3267e-01],
         [ 6.6374e-03, -7.6399e-02],
         [ 2.9214e-02, -4.5148e-02],
         [ 4.0513e-02, -6.0116e-02],
         [ 4.5928e-02, -5.0529e-02],
         [ 4.8425e-02, -5.1336e-02],
         [ 4.9503e-02, -6.4086e-02],
         [ 4.9903e-02, -7.7002e-02],
         [ 5.0050e-02, -9.4385e-02],
         [ 5.0070e-02, -1.1258e-01],
         [ 5.0066e-02, -1.2940e-01],
         [ 5.0037e-02, -1.0250e-01],
         [ 5.0012e-02, -9.4391e-02],
         [ 5.0030e-02, -1.1642e-01],
         [ 5.0016e-02, -1.3894e-01],
         [ 5.0017e-02, -1.4884e-01],
         [ 5.0015e-02, -1.2738e-01],
         [ 5.0022e-02, -8.0331e-02],
         [ 5.0012e-02, -7.0755e-02],
         [ 5.0016e-02,  2.4475e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.4071e-05, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.4768, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4509, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3211, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0533, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1149, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0525, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1891891.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2024, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.3128e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1189, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2890, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1189, device='cuda:0', grad_fn=<MinBackward1>)
t_env 11299
target_mac_out tensor([[[[-1.0000e+07, -6.0082e-02,  8.4218e-02,  ...,  2.3512e-02,
            1.2572e-01, -1.0000e+07],
          [-1.0000e+07, -1.1235e-02,  1.0290e-01,  ...,  6.8675e-03,
            1.2423e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2186e-02,  7.5614e-02,  ..., -6.4896e-03,
            1.3925e-01, -1.0000e+07],
          [-1.0000e+07, -3.0528e-02,  1.3220e-01,  ..., -2.5162e-03,
            1.4641e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.1680e-02,  6.1318e-02,  ...,  5.7171e-03,
            1.3834e-01, -1.0000e+07],
          [-1.0000e+07, -3.8335e-02,  1.1561e-01,  ..., -3.7671e-02,
            1.4580e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3382e-02,  7.9674e-02,  ...,  2.9347e-03,
            1.4357e-01, -1.0000e+07],
          [-1.0000e+07, -1.6607e-02,  1.1113e-01,  ...,  2.2597e-03,
            1.2947e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.8440e-02,  5.7460e-02,  ..., -4.9726e-03,
            1.5747e-01, -1.0000e+07],
          [-1.0000e+07, -3.3268e-02,  6.1468e-02,  ...,  2.8033e-02,
            1.5274e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.2218e-01,  1.1603e-01,  ...,  8.8825e-02,
            1.9273e-01, -3.4327e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.9542e-01,  7.0641e-02,  ...,  8.0455e-02,
            1.5643e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.5650e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-6.0082e-02, -1.1235e-02],
         [-7.2186e-02, -3.0528e-02],
         [-6.1680e-02, -3.8335e-02],
         [-9.2401e-02, -3.0903e-02],
         [-1.1043e-01, -3.1528e-02],
         [-1.3871e-01, -5.6541e-02],
         [-1.5615e-01, -4.8233e-02],
         [-1.6683e-01, -4.2145e-02],
         [-1.7840e-01, -3.8560e-02],
         [-1.8941e-01, -5.2083e-02],
         [-2.0268e-01, -3.7361e-02],
         [-1.9903e-01, -4.7837e-02],
         [-1.8471e-01, -6.3470e-02],
         [-1.6282e-01, -4.7452e-02],
         [-1.8380e-01, -5.5321e-02],
         [ 5.4117e-02, -2.6922e-02],
         [ 5.4824e-02, -4.3624e-02],
         [ 6.5072e-02, -2.8668e-02],
         [ 5.8655e-02, -2.5490e-02],
         [ 5.1688e-02, -2.6401e-02],
         [ 7.9926e-02, -2.8122e-02],
         [-2.0623e-01, -4.1610e-02],
         [-1.8091e-01, -2.7499e-02],
         [-1.9674e-01, -2.5269e-02],
         [-1.7084e-01, -2.8528e-02],
         [-2.0061e-01, -5.7400e-02],
         [-1.7437e-01, -4.7410e-02],
         [-1.5443e-02, -4.1419e-02],
         [ 1.8301e-02, -2.3847e-02],
         [ 3.5826e-02, -4.5049e-02],
         [ 4.4242e-02, -6.1070e-02],
         [ 4.8009e-02, -5.3145e-02],
         [ 4.9535e-02, -5.3874e-02],
         [ 5.0047e-02, -7.1882e-02],
         [ 5.0158e-02, -6.4584e-02],
         [ 5.0142e-02, -7.6050e-02],
         [ 5.0089e-02, -7.0907e-02],
         [ 5.0048e-02, -8.1429e-02],
         [ 5.0041e-02, -6.8247e-02],
         [ 5.0009e-02, -5.7522e-02],
         [ 5.0008e-02, -7.6612e-02],
         [ 5.0024e-02, -4.6976e-02],
         [ 5.0012e-02, -4.9200e-02],
         [ 5.0024e-02, -6.3973e-02],
         [ 5.0013e-02, -7.2996e-02],
         [ 5.0016e-02, -1.1679e-01],
         [ 5.0015e-02, -9.3430e-02],
         [ 5.0010e-02, -9.5630e-02],
         [ 5.0006e-02, -1.3774e-01],
         [ 5.0007e-02, -1.6693e-01],
         [ 5.0007e-02, -1.7442e-01],
         [ 5.0007e-02, -1.9172e-01],
         [ 5.0008e-02, -2.0393e-01],
         [ 5.0008e-02, -1.9605e-01],
         [ 5.0009e-02, -1.9993e-01],
         [ 5.0008e-02, -1.9626e-01],
         [ 5.0008e-02, -1.8972e-01],
         [ 5.0008e-02, -1.8368e-01],
         [ 5.0008e-02, -1.9945e-01],
         [ 5.0009e-02, -1.8234e-01],
         [ 5.0009e-02, -1.9799e-01],
         [ 5.0009e-02, -1.9918e-01],
         [ 5.0009e-02, -1.7667e-01],
         [ 5.0009e-02, -1.8210e-01],
         [ 5.0009e-02, -1.6971e-01],
         [ 5.0009e-02, -1.5681e-01],
         [ 5.0009e-02, -1.5722e-01],
         [ 5.0009e-02, -1.8459e-01],
         [ 5.0009e-02, -1.6795e-01],
         [ 5.0009e-02,  7.7470e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.8559e-02, -1.1905e-02],
         [-7.3382e-02, -1.6607e-02],
         [-7.8440e-02, -3.3268e-02],
         [-7.7057e-02, -1.7950e-02],
         [-6.2874e-02, -4.4145e-02],
         [-2.6337e-02, -4.9233e-02],
         [-1.8291e-02, -3.6035e-02],
         [-1.7926e-02, -3.3940e-02],
         [-5.3006e-02, -1.7507e-02],
         [-7.1019e-02, -1.9767e-02],
         [-9.3507e-02, -3.5556e-02],
         [-8.9192e-02, -4.4422e-02],
         [-8.9463e-02, -3.9185e-02],
         [-9.1766e-02, -5.2304e-02],
         [-1.0264e-01, -5.9439e-02],
         [-8.4907e-02, -6.1938e-02],
         [-1.0109e-01, -8.7139e-02],
         [-1.0709e-01, -7.2584e-02],
         [-1.1104e-01, -6.1026e-02],
         [-7.5060e-02, -6.3328e-02],
         [-6.7096e-02, -6.3445e-02],
         [-5.2436e-02, -6.6464e-02],
         [-4.9275e-02, -9.2572e-02],
         [-7.8382e-02, -1.1157e-01],
         [-6.2066e-02, -1.1881e-01],
         [-3.4249e-02, -1.1118e-01],
         [-5.2585e-02, -1.2354e-01],
         [-6.5652e-02, -1.1601e-01],
         [-7.8815e-02, -1.2325e-01],
         [-5.9063e-02, -1.3557e-01],
         [-7.7051e-02, -1.2580e-01],
         [-8.7867e-02, -1.3228e-01],
         [-1.0167e-01, -1.2711e-01],
         [-7.5775e-02, -1.1856e-01],
         [-5.8579e-02, -1.2854e-01],
         [-8.3834e-02, -1.3671e-01],
         [-5.9741e-02, -1.6126e-01],
         [-2.4356e-02, -1.6725e-01],
         [ 6.1634e-03, -1.9277e-01],
         [-2.3146e-03, -1.7398e-01],
         [-5.4611e-02, -1.0783e-01],
         [-9.9930e-02, -7.5970e-02],
         [-1.2579e-01, -6.4081e-02],
         [-1.3730e-01, -6.0575e-02],
         [-1.0674e-01, -5.7380e-02],
         [-1.0268e-01, -6.9194e-02],
         [-1.0011e-01, -7.7837e-02],
         [-9.3815e-02, -6.6777e-02],
         [-7.5629e-02, -5.9705e-02],
         [-7.1071e-02, -5.1505e-02],
         [-7.2209e-02, -6.0972e-02],
         [-8.4775e-02, -8.4292e-02],
         [-7.9473e-02, -9.1475e-02],
         [-8.5807e-02, -2.2417e-02],
         [-8.9862e-02,  2.0640e-02],
         [-6.7975e-02,  4.0824e-02],
         [-7.1776e-02,  4.9666e-02],
         [-7.8815e-02,  5.3332e-02],
         [-9.8295e-02,  5.4708e-02],
         [-1.0285e-01,  5.5190e-02],
         [-9.1480e-02,  5.5286e-02],
         [-8.7008e-02,  5.5262e-02],
         [-8.8245e-02,  5.5242e-02],
         [-8.6290e-02,  5.5228e-02],
         [-8.5258e-02,  5.5201e-02],
         [-8.3805e-02,  5.5180e-02],
         [-7.9520e-02,  5.5216e-02],
         [-8.0483e-02,  5.5211e-02],
         [-1.2960e-01,  5.5204e-02],
         [-1.4782e-01,  5.5218e-02],
         [-1.2640e-01,  5.5218e-02],
         [-1.7056e-01,  5.5213e-02],
         [-1.8452e-01,  5.5222e-02],
         [-1.4745e-01,  5.5228e-02],
         [-1.4959e-01,  5.5229e-02],
         [-1.3625e-01,  5.5233e-02],
         [-1.4427e-01,  5.5235e-02],
         [-1.1442e-01,  5.5235e-02],
         [-1.0635e-01,  5.5232e-02],
         [-8.4019e-02,  5.5231e-02],
         [-7.9693e-02,  5.5231e-02],
         [-6.8065e-02,  5.5231e-02],
         [-6.1724e-02,  5.5231e-02],
         [-5.5030e-02,  5.5231e-02],
         [-6.4980e-02,  5.5231e-02],
         [-8.3106e-02,  5.5231e-02],
         [-9.1081e-02,  5.5231e-02],
         [-9.4989e-02,  5.5231e-02],
         [-9.6957e-02,  5.5231e-02],
         [-7.4885e-02,  5.5231e-02],
         [-8.0765e-02,  5.5231e-02],
         [-7.6966e-02,  5.5231e-02],
         [-6.5290e-02,  5.5231e-02],
         [-8.6022e-02,  5.5231e-02],
         [-1.0288e-01,  5.5231e-02],
         [-1.0324e-01,  5.5231e-02],
         [-1.2042e-01,  5.5231e-02],
         [-1.2631e-01,  5.5231e-02],
         [-1.3103e-01,  5.5231e-02],
         [-1.0203e-01,  5.5231e-02],
         [-1.1590e-01,  5.5231e-02],
         [-1.2185e-01,  5.5231e-02],
         [-1.1860e-01,  5.5231e-02],
         [-1.0434e-01,  5.5231e-02],
         [-1.5376e-01,  5.5231e-02],
         [-1.8852e-01,  5.5231e-02],
         [-1.9591e-01,  5.5231e-02],
         [-2.0495e-01,  5.5231e-02],
         [-2.3325e-01,  5.5231e-02],
         [-2.4461e-01,  5.5231e-02],
         [-2.6790e-01,  5.5231e-02],
         [-2.5402e-01,  5.5231e-02],
         [-2.5393e-01,  5.5231e-02],
         [-2.5995e-01,  5.5231e-02],
         [-2.7070e-01,  5.5231e-02],
         [-2.4188e-01,  5.5231e-02],
         [-2.2337e-01,  5.5231e-02],
         [-1.9155e-01,  5.5231e-02],
         [-1.8719e-01,  5.5231e-02],
         [-2.2218e-01,  5.5231e-02],
         [-1.9542e-01,  5.5231e-02],
         [ 1.5650e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.5581e-06, device='cuda:0') tensor(0.0014, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.5285, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5470, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7458, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0370, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1178, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0601, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2131147.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0799, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.4740e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0993, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3164, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0993, device='cuda:0', grad_fn=<MinBackward1>)
t_env 11506
target_mac_out tensor([[[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7229e-02,  1.0718e-01,  ...,  1.5798e-02,
            1.3791e-01, -1.0000e+07],
          [-1.0000e+07, -6.3204e-02,  1.3937e-01,  ...,  4.1475e-02,
            1.4929e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9425e-02,  1.1495e-01,  ...,  1.2519e-02,
            1.5796e-01, -1.0000e+07],
          [-1.0000e+07, -7.3710e-02,  1.2961e-01,  ...,  3.4332e-02,
            1.4764e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.1049e-01,  9.5954e-02,  ...,  4.3549e-02,
            1.9052e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.2270e-01,  1.0282e-01,  ...,  7.2312e-02,
            2.0724e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6719e-01,  1.2207e-01,  ...,  9.9992e-02,
            2.0307e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.9336e-02,  8.9318e-02,  ...,  1.5729e-02,
            1.2882e-01, -1.0000e+07],
          [-1.0000e+07, -2.5640e-02,  8.8110e-02,  ..., -1.8735e-02,
            1.3277e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1056e-02,  1.1443e-01,  ...,  3.4915e-02,
            1.5353e-01, -1.0000e+07],
          [-1.0000e+07, -4.0997e-02,  1.1804e-01,  ...,  1.4397e-02,
            1.5161e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-6.8669e-02, -2.0465e-02],
         [-6.7229e-02, -6.3204e-02],
         [-8.9425e-02, -7.3710e-02],
         ...,
         [-1.1049e-01,  5.5231e-02],
         [-1.2270e-01,  5.5231e-02],
         [-1.6719e-01,  5.5231e-02]],

        [[-4.2377e-02, -1.1096e-02],
         [-4.9336e-02, -2.5640e-02],
         [-7.1056e-02, -4.0997e-02],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.4823e-06, device='cuda:0') tensor(0.0004, device='cuda:0') tensor(-0.0003, device='cuda:0')
mixer_td_error tensor(1.0004, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4499, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3597, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0484, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1017, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1160, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-4066666.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0557, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.1088e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0848, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2975, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0848, device='cuda:0', grad_fn=<MinBackward1>)
t_env 11558
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2400e-02,  9.8029e-02,  ...,  3.1969e-02,
            1.6101e-01, -1.0000e+07],
          [-1.0000e+07, -4.6060e-02,  1.1430e-01,  ...,  3.6765e-02,
            1.4675e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2108e-01,  1.1981e-01,  ...,  5.4917e-02,
            1.6785e-01, -1.0000e+07],
          [-1.0000e+07, -8.3276e-02,  1.6010e-01,  ...,  6.2015e-02,
            1.4833e-01, -1.0000e+07]],

         ...,

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.7130e-01,  7.6967e-02,  ...,  8.8144e-02,
            2.1366e-01, -3.2696e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6059e-01,  8.2038e-02,  ...,  7.3630e-02,
            2.0875e-01, -3.1667e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 6.0608e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2685e-01,  1.2531e-01,  ...,  5.6976e-02,
            1.5537e-01, -1.0000e+07],
          [-1.0000e+07, -4.3705e-02,  1.3064e-01,  ...,  2.3492e-02,
            1.4040e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.5273e-01,  1.3203e-01,  ...,  6.9187e-02,
            1.6531e-01, -1.0000e+07],
          [-1.0000e+07, -5.7402e-02,  1.4496e-01,  ...,  6.9303e-03,
            1.5600e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.9256e-02, -4.8886e-02],
         [-8.2400e-02, -4.6060e-02],
         [-1.2108e-01, -8.3276e-02],
         [-1.3484e-01, -1.0196e-01],
         [-1.5372e-01, -9.0828e-02],
         [-1.4893e-01, -8.6599e-02],
         [-1.4919e-01, -7.1861e-02],
         [-1.4903e-01, -7.8003e-02],
         [-1.4964e-01, -6.6453e-02],
         [-1.5519e-01, -7.7668e-02],
         [-1.5528e-01, -1.1588e-01],
         [-1.6980e-01, -9.8940e-02],
         [-1.7308e-01, -8.9127e-02],
         [-1.6509e-01, -7.6534e-02],
         [ 2.0571e-01, -6.6767e-02],
         [ 2.0296e-01, -5.9092e-02],
         [ 1.9500e-01, -4.1350e-02],
         [ 1.8491e-01, -1.7261e-02],
         [ 8.9870e-02, -4.9241e-03],
         [-3.4143e-01,  1.8534e-03],
         [-3.3510e-01, -3.3053e-02],
         [-3.4803e-01, -5.4138e-02],
         [-3.3847e-01, -6.6199e-02],
         [-1.8317e-01, -7.4115e-02],
         [-1.6837e-01, -1.1407e-01],
         [-1.7189e-01, -1.3679e-01],
         [-1.4036e-01, -1.5018e-01],
         [ 1.5579e-03, -1.6963e-01],
         [ 2.6799e-02, -1.5923e-01],
         [ 3.9880e-02, -1.5105e-01],
         [ 4.6012e-02, -1.6418e-01],
         [ 4.8653e-02, -1.6997e-01],
         [ 4.9652e-02, -1.4242e-01],
         [ 4.9987e-02, -1.3383e-01],
         [ 5.0055e-02, -1.1386e-01],
         [ 5.0046e-02, -1.1578e-01],
         [ 5.0032e-02, -1.1900e-01],
         [ 5.0015e-02, -1.0157e-01],
         [ 5.0017e-02, -1.0617e-01],
         [ 4.9999e-02, -1.1051e-01],
         [ 5.0030e-02, -1.4999e-01],
         [ 5.0039e-02, -1.6106e-01],
         [ 5.0019e-02, -1.9057e-01],
         [ 5.0020e-02, -1.9624e-01],
         [ 5.0023e-02, -2.0098e-01],
         [ 5.0024e-02, -1.9275e-01],
         [ 5.0021e-02, -1.9697e-01],
         [ 5.0015e-02, -2.0195e-01],
         [ 5.0007e-02, -1.9430e-01],
         [ 5.0007e-02, -1.8665e-01],
         [ 5.0008e-02, -1.9642e-01],
         [ 5.0008e-02, -1.6907e-01],
         [ 5.0008e-02, -1.8519e-01],
         [ 5.0008e-02, -1.8718e-01],
         [ 5.0008e-02, -1.6434e-01],
         [ 5.0008e-02, -1.7130e-01],
         [ 5.0008e-02, -1.6059e-01],
         [ 5.0008e-02,  6.0608e-03]],

        [[-7.5802e-02, -5.1416e-02],
         [-1.2685e-01, -4.3705e-02],
         [-1.5273e-01, -5.7402e-02],
         [-1.6599e-01, -9.5074e-02],
         [-1.7740e-01, -1.2450e-01],
         [ 4.8600e-02, -1.3073e-01],
         [-2.0069e-01, -1.3874e-01],
         [-2.0185e-01, -1.5012e-01],
         [-1.8074e-01, -1.5138e-01],
         [-1.7465e-01, -1.5767e-01],
         [-1.8284e-01, -1.5145e-01],
         [-1.6259e-01, -1.4862e-01],
         [ 7.0909e-02, -1.3232e-01],
         [-1.5486e-01, -1.3595e-01],
         [ 3.5096e-02, -1.4284e-01],
         [ 5.0092e-02, -1.4631e-01],
         [ 7.5859e-02, -1.4353e-01],
         [ 9.0248e-02, -1.4859e-01],
         [ 1.0455e-01, -1.6063e-01],
         [ 9.5186e-02, -1.6786e-01],
         [ 1.0847e-01, -1.7228e-01],
         [-2.1766e-01, -1.7637e-01],
         [-1.8003e-01, -1.7957e-01],
         [-1.9144e-01, -1.8163e-01],
         [-2.1177e-01, -1.9274e-01],
         [-2.2068e-01, -1.7763e-01],
         [-2.0916e-01, -1.7411e-01],
         [-1.9928e-01, -1.5204e-01],
         [-2.0209e-01, -1.4597e-01],
         [ 8.1143e-02, -1.4954e-01],
         [-2.2375e-01, -1.3771e-01],
         [-2.2002e-01, -1.5842e-01],
         [-2.0828e-01, -1.5280e-01],
         [-2.3141e-01, -1.3991e-01],
         [-2.3379e-01, -8.3475e-03],
         [-2.2344e-01,  2.5676e-02],
         [ 1.1546e-01,  4.2396e-02],
         [ 1.2757e-01,  4.9955e-02],
         [ 1.2952e-01,  5.3175e-02],
         [ 1.0276e-01,  5.4463e-02],
         [-2.1008e-01,  5.4920e-02],
         [-2.2578e-01,  5.5067e-02],
         [-1.9166e-01,  5.5112e-02],
         [-1.6969e-01,  5.5138e-02],
         [-1.5569e-01,  5.5125e-02],
         [-5.4720e-03,  5.5144e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.9214e-05, device='cuda:0') tensor(0.0020, device='cuda:0') tensor(-0.0026, device='cuda:0')
mixer_td_error tensor(0.2518, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4474, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7094, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0006, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1028, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1383, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1034482.6875, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2057, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.3312e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0018, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3281, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3363, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3281, device='cuda:0', grad_fn=<MinBackward1>)
t_env 11707
target_mac_out tensor([[[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0732e-02,  9.6743e-02,  ...,  4.5088e-02,
            1.5322e-01, -1.0000e+07],
          [-1.0000e+07, -3.1440e-02,  1.2493e-01,  ...,  8.1411e-03,
            1.4332e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8013e-02,  1.0694e-01,  ...,  2.7520e-02,
            1.6673e-01, -1.0000e+07],
          [-1.0000e+07, -2.7733e-02,  1.1902e-01,  ...,  1.9500e-02,
            1.4357e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1885e-01,  2.6895e-02,  ...,  4.8737e-02,
            1.6856e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0831e-01,  2.0549e-02,  ...,  2.1854e-02,
            1.7732e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.1907e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0955e-02,  9.6376e-02,  ...,  2.6399e-02,
            1.4271e-01, -1.0000e+07],
          [-1.0000e+07, -7.2934e-02,  1.5417e-01,  ...,  4.7811e-02,
            1.4808e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9898e-02,  9.7346e-02,  ...,  3.7622e-02,
            1.3495e-01, -1.0000e+07],
          [-1.0000e+07, -9.4199e-02,  1.6448e-01,  ...,  6.6080e-02,
            1.6480e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.2377e-02, -1.1096e-02],
         [-7.0732e-02, -3.1440e-02],
         [-8.8013e-02, -2.7733e-02],
         [-7.3621e-02, -4.0715e-02],
         [-8.6701e-02, -5.1307e-02],
         [-6.8049e-02, -5.6282e-02],
         [-8.3750e-02, -5.0879e-02],
         [-9.4950e-02, -5.7014e-02],
         [-7.9577e-02, -5.7267e-02],
         [-6.5234e-02, -7.0836e-02],
         [-7.9943e-02, -3.5182e-02],
         [-6.9575e-02, -3.8452e-02],
         [-6.2884e-02, -4.9492e-02],
         [-7.7695e-02,  1.5930e-01],
         [-7.1688e-02, -5.8422e-02],
         [-6.4171e-02, -5.3404e-02],
         [-7.9917e-02, -7.0946e-02],
         [-5.8289e-02, -7.0987e-02],
         [-9.4847e-02,  1.6756e-01],
         [-1.0587e-01,  1.7446e-01],
         [-1.2191e-01,  1.8085e-01],
         [-1.3408e-01,  1.7492e-01],
         [-1.4052e-01,  1.7652e-01],
         [-1.3280e-01, -1.3002e-01],
         [-1.2389e-01, -1.0868e-01],
         [-1.1742e-01, -8.3386e-02],
         [ 6.6788e-02, -1.2103e-01],
         [ 8.7761e-02, -1.2392e-01],
         [ 7.4622e-02, -1.3620e-01],
         [-3.7282e-01, -1.4676e-01],
         [-3.8618e-01, -1.2174e-01],
         [-3.9662e-01, -1.4685e-01],
         [-3.7520e-01, -1.2041e-01],
         [-3.6906e-01, -1.4708e-01],
         [-3.7376e-01, -1.0905e-01],
         [-3.8956e-01, -1.3755e-01],
         [-3.7026e-01, -1.5188e-01],
         [-3.4263e-01, -1.1943e-01],
         [-3.4963e-01, -1.3567e-01],
         [-3.5404e-01, -1.0136e-01],
         [-4.0753e-03, -8.4690e-02],
         [ 2.4476e-02, -9.4195e-02],
         [ 3.8864e-02, -1.3441e-01],
         [ 4.5654e-02, -1.0390e-01],
         [ 4.8635e-02, -8.3950e-02],
         [ 4.9842e-02, -6.5356e-02],
         [ 5.0179e-02, -5.2514e-02],
         [ 5.0252e-02, -3.5539e-02],
         [ 5.0204e-02, -5.1254e-02],
         [ 5.0134e-02, -4.7312e-02],
         [ 5.0093e-02, -3.9972e-02],
         [ 5.0075e-02, -2.0768e-02],
         [ 5.0045e-02, -2.5244e-02],
         [ 5.0024e-02, -1.8463e-02],
         [ 5.0032e-02, -2.6015e-02],
         [ 5.0019e-02, -3.2269e-02],
         [ 5.0028e-02, -1.4234e-02],
         [ 5.0027e-02, -4.3039e-02],
         [ 5.0018e-02, -6.0445e-02],
         [ 5.0012e-02, -5.1102e-02],
         [ 5.0012e-02, -3.3670e-02],
         [ 5.0005e-02, -4.8593e-02],
         [ 5.0007e-02, -4.9886e-02],
         [ 5.0007e-02, -4.6348e-02],
         [ 5.0008e-02, -3.8859e-02],
         [ 5.0008e-02, -1.5121e-02],
         [ 5.0009e-02, -3.9888e-02],
         [ 5.0008e-02, -4.1190e-02],
         [ 5.0008e-02, -6.3069e-02],
         [ 5.0008e-02, -4.4425e-02],
         [ 5.0008e-02, -4.9497e-02],
         [ 5.0009e-02, -5.6273e-02],
         [ 5.0009e-02, -4.3913e-02],
         [ 5.0009e-02, -5.7376e-02],
         [ 5.0009e-02, -3.9203e-02],
         [ 5.0009e-02, -3.4118e-02],
         [ 5.0009e-02, -1.9078e-02],
         [ 5.0009e-02, -1.2495e-02],
         [ 5.0009e-02, -2.1930e-02],
         [ 5.0009e-02, -4.6529e-02],
         [ 5.0009e-02, -3.4994e-02],
         [ 5.0009e-02, -3.3273e-02],
         [ 5.0009e-02, -2.2715e-02],
         [ 5.0009e-02, -4.4885e-02],
         [ 5.0009e-02, -4.8626e-02],
         [ 5.0009e-02, -6.5905e-02],
         [ 5.0009e-02, -7.9769e-02],
         [ 5.0009e-02, -5.9079e-02],
         [ 5.0009e-02, -6.6339e-02],
         [ 5.0009e-02, -7.6499e-02],
         [ 5.0009e-02, -8.5673e-02],
         [ 5.0009e-02, -9.2573e-02],
         [ 5.0009e-02, -9.7207e-02],
         [ 5.0009e-02, -1.0008e-01],
         [ 5.0009e-02, -8.6552e-02],
         [ 5.0009e-02, -6.0036e-02],
         [ 5.0009e-02, -2.6244e-02],
         [ 5.0009e-02, -9.9563e-03],
         [ 5.0009e-02, -1.0655e-02],
         [ 5.0009e-02, -8.0548e-03],
         [ 5.0009e-02, -3.5697e-02],
         [ 5.0009e-02, -4.3026e-02],
         [ 5.0009e-02, -3.1828e-02],
         [ 5.0009e-02, -9.2054e-03],
         [ 5.0009e-02, -9.5065e-03],
         [ 5.0009e-02, -2.0507e-02],
         [ 5.0009e-02, -2.8984e-02],
         [ 5.0009e-02, -3.4644e-02],
         [ 5.0009e-02, -1.5697e-02],
         [ 5.0009e-02, -2.6869e-02],
         [ 5.0009e-02, -3.2822e-02],
         [ 5.0009e-02, -3.6234e-02],
         [ 5.0009e-02, -3.8219e-02],
         [ 5.0009e-02, -1.7075e-02],
         [ 5.0009e-02, -5.2683e-03],
         [ 5.0009e-02,  1.8134e-03],
         [ 5.0009e-02, -3.2823e-03],
         [ 5.0009e-02, -1.6064e-02],
         [ 5.0009e-02, -3.3037e-03],
         [ 5.0009e-02, -1.9179e-02],
         [ 5.0009e-02, -1.5770e-02],
         [ 5.0009e-02, -1.1189e-02],
         [ 5.0009e-02, -3.7527e-02],
         [ 5.0009e-02, -2.8296e-02],
         [ 5.0009e-02, -2.8872e-02],
         [ 5.0009e-02, -4.9521e-02],
         [ 5.0009e-02, -5.2009e-02],
         [ 5.0009e-02, -6.5604e-02],
         [ 5.0009e-02, -6.1368e-02],
         [ 5.0009e-02, -5.1903e-02],
         [ 5.0009e-02, -6.6614e-02],
         [ 5.0009e-02, -4.9392e-02],
         [ 5.0009e-02, -3.0629e-02],
         [ 5.0009e-02, -4.9738e-02],
         [ 5.0009e-02, -4.6343e-02],
         [ 5.0009e-02, -6.6694e-02],
         [ 5.0009e-02, -9.3935e-02],
         [ 5.0009e-02, -1.0844e-01],
         [ 5.0009e-02, -1.2205e-01],
         [ 5.0009e-02, -1.5346e-01],
         [ 5.0009e-02, -1.3898e-01],
         [ 5.0009e-02, -1.4932e-01],
         [ 5.0009e-02, -1.6745e-01],
         [ 5.0009e-02, -1.8363e-01],
         [ 5.0009e-02, -1.9322e-01],
         [ 5.0009e-02, -1.6745e-01],
         [ 5.0009e-02, -1.8061e-01],
         [ 5.0009e-02, -1.6982e-01],
         [ 5.0009e-02, -1.6862e-01],
         [ 5.0009e-02, -1.7602e-01],
         [ 5.0009e-02, -1.7021e-01],
         [ 5.0009e-02, -1.6868e-01],
         [ 5.0009e-02, -1.5915e-01],
         [ 5.0009e-02, -1.4388e-01],
         [ 5.0009e-02, -1.4997e-01],
         [ 5.0009e-02, -1.3224e-01],
         [ 5.0009e-02, -1.1885e-01],
         [ 5.0009e-02, -1.0831e-01],
         [ 5.0009e-02,  1.1907e-02]],

        [[-4.5201e-02, -4.8984e-02],
         [-8.0955e-02, -7.2934e-02],
         [-6.9898e-02, -9.4199e-02],
         [-6.2988e-02, -1.5611e-01],
         [-7.7435e-02, -1.7661e-01],
         [-1.0761e-01, -1.3528e-01],
         [-1.2876e-01, -1.2038e-01],
         [-1.1152e-01, -1.7615e-01],
         [-5.5358e-02, -1.9257e-01],
         [-3.7455e-02, -2.1321e-01],
         [-2.4242e-04, -1.9974e-01],
         [-7.3571e-03, -1.7927e-01],
         [-5.3387e-02, -1.4021e-01],
         [-8.5189e-02, -1.3395e-01],
         [-6.2503e-02, -3.1404e-01],
         [-6.8981e-02, -3.0533e-01],
         [-6.8524e-02, -3.0297e-01],
         [-6.6860e-02, -3.0099e-01],
         [-6.2946e-02, -2.9682e-01],
         [-6.6403e-02, -2.9976e-01],
         [-3.6021e-02, -2.9656e-01],
         [-4.8108e-02, -8.6802e-02],
         [-5.0429e-02,  1.2791e-02],
         [-1.0019e-02,  3.5265e-02],
         [-1.0523e-02,  4.6792e-02],
         [-1.1121e-02,  5.2026e-02],
         [-1.1464e-02,  5.4247e-02],
         [-1.4016e-02,  5.5083e-02],
         [-3.3205e-02,  5.5339e-02],
         [-3.3181e-02,  5.5368e-02],
         [-5.9682e-02,  5.5319e-02],
         [-8.9486e-02,  5.5268e-02],
         [-5.8368e-02,  5.5239e-02],
         [-5.7434e-02,  5.5226e-02],
         [-7.3063e-02,  5.5231e-02],
         [-9.4142e-02,  5.5218e-02],
         [-1.3749e-01,  5.5201e-02],
         [-1.0918e-01,  5.5207e-02],
         [-1.1718e-01,  5.5230e-02],
         [-1.0752e-01,  5.5228e-02],
         [-1.3868e-01,  5.5216e-02],
         [-1.5692e-01,  5.5223e-02],
         [-1.8426e-01,  5.5224e-02],
         [-1.9943e-01,  5.5232e-02],
         [-1.9498e-01,  5.5230e-02],
         [-1.8008e-01,  5.5230e-02],
         [-3.3652e-01,  5.5231e-02],
         [-3.3808e-01,  5.5236e-02],
         [-3.3582e-01,  5.5235e-02],
         [-3.3186e-01,  5.5232e-02],
         [-1.9388e-01,  5.5232e-02],
         [-2.1408e-01,  5.5231e-02],
         [-1.9116e-01,  5.5231e-02],
         [-2.0607e-01,  5.5231e-02],
         [-2.1264e-01,  5.5231e-02],
         [ 1.9043e-01,  5.5231e-02],
         [-2.2578e-01,  5.5231e-02],
         [-2.2691e-01,  5.5231e-02],
         [-2.0069e-01,  5.5231e-02],
         [-1.9745e-01,  5.5231e-02],
         [-1.8753e-01,  5.5231e-02],
         [ 1.6079e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.2975e-06, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.7395, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4492, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3741, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0237, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1065, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1409, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3050314., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1904, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.3205e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0007, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2643, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3393, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2643, device='cuda:0', grad_fn=<MinBackward1>)
t_env 11978
target_mac_out tensor([[[[-1.0000e+07, -3.8669e-02,  6.6123e-02,  ...,  3.1808e-02,
            1.1543e-01, -1.0000e+07],
          [-1.0000e+07, -1.7411e-02,  9.1207e-02,  ..., -1.4688e-02,
            1.2647e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.1289e-02,  9.2718e-02,  ...,  1.9208e-02,
            1.1967e-01, -1.0000e+07],
          [-1.0000e+07, -5.9044e-02,  1.3579e-01,  ...,  3.9523e-02,
            1.5288e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.4152e-02,  9.5388e-02,  ...,  2.5996e-02,
            1.2299e-01, -1.0000e+07],
          [-1.0000e+07, -7.9071e-02,  1.4334e-01,  ...,  3.7160e-02,
            1.5727e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.4868e-01, -1.0000e+07,  ..., -1.0000e+07,
            2.3140e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.4731e-01, -1.0000e+07,  ..., -1.0000e+07,
            2.2502e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-2.5833e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1792e-01,  1.2989e-01,  ...,  5.6814e-02,
            1.5398e-01, -1.0000e+07],
          [-1.0000e+07, -7.6477e-02,  1.2250e-01,  ...,  2.6030e-02,
            1.4386e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3470e-01,  1.4601e-01,  ...,  7.0606e-02,
            1.5992e-01, -1.0000e+07],
          [-1.0000e+07, -9.3509e-02,  1.1277e-01,  ...,  7.2643e-03,
            1.4689e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-3.8669e-02, -1.7411e-02],
         [-5.1289e-02, -5.9044e-02],
         [-4.4152e-02, -7.9071e-02],
         [ 1.2007e-01, -9.9926e-02],
         [ 1.1404e-01, -9.8563e-02],
         [ 1.1178e-01, -9.6404e-02],
         [ 1.1123e-01, -1.0607e-01],
         [ 1.3223e-01, -1.1874e-01],
         [ 1.4516e-01,  6.2067e-02],
         [-8.3688e-02,  5.7285e-02],
         [-7.5680e-02,  5.5964e-02],
         [-6.9883e-02,  1.9897e-01],
         [-7.2070e-02,  2.0266e-01],
         [ 5.9852e-02,  2.0590e-01],
         [-1.0510e-01, -1.5109e-01],
         [-9.8535e-02, -1.0699e-01],
         [ 1.3432e-01, -8.7208e-02],
         [-6.6960e-02, -8.0978e-02],
         [ 1.5072e-01,  1.8925e-01],
         [-9.9476e-02, -1.3398e-01],
         [-1.2488e-01, -1.1771e-01],
         [ 1.6954e-01, -9.4724e-02],
         [ 1.5546e-01,  8.6080e-03],
         [-8.6989e-02,  3.6199e-02],
         [-5.8515e-02,  4.8625e-02],
         [-5.7526e-02,  5.3620e-02],
         [-5.9290e-02,  5.5335e-02],
         [-7.3780e-02,  5.5706e-02],
         [-7.7208e-02,  5.5662e-02],
         [-8.2617e-02,  5.5490e-02],
         [ 1.8286e-01,  5.5360e-02],
         [ 1.6768e-01,  5.5278e-02],
         [-6.3281e-02,  5.5212e-02],
         [-7.4487e-02,  5.5206e-02],
         [-8.4789e-02,  5.5200e-02],
         [-6.6641e-02,  5.5187e-02],
         [-8.6981e-02,  5.5197e-02],
         [ 1.9859e-01,  5.5208e-02],
         [-7.4241e-02,  5.5214e-02],
         [-7.7804e-02,  5.5208e-02],
         [-9.1310e-02,  5.5203e-02],
         [-7.1752e-02,  5.5221e-02],
         [-7.6097e-02,  5.5228e-02],
         [-5.7198e-02,  5.5231e-02],
         [-4.0832e-02,  5.5230e-02],
         [-5.1518e-02,  5.5230e-02],
         [-6.9646e-02,  5.5231e-02],
         [-4.9671e-02,  5.5236e-02],
         [-4.2908e-02,  5.5235e-02],
         [-5.9292e-02,  5.5232e-02],
         [-4.4181e-02,  5.5232e-02],
         [-5.2230e-02,  5.5231e-02],
         [-3.8075e-02,  5.5231e-02],
         [-3.3059e-02,  5.5231e-02],
         [-4.2769e-02,  5.5231e-02],
         [-5.1346e-02,  5.5231e-02],
         [-6.9882e-02,  5.5231e-02],
         [-7.1413e-02,  5.5231e-02],
         [ 1.7898e-01,  5.5231e-02],
         [ 1.8881e-01,  5.5231e-02],
         [ 1.7603e-01,  5.5231e-02],
         [ 1.8934e-01,  5.5231e-02],
         [ 1.7673e-01,  5.5231e-02],
         [ 1.9960e-01,  5.5231e-02],
         [-9.8127e-02,  5.5231e-02],
         [-9.8093e-02,  5.5231e-02],
         [ 1.7605e-01,  5.5231e-02],
         [ 1.8117e-01,  5.5231e-02],
         [ 1.8392e-01,  5.5231e-02],
         [ 2.0635e-01,  5.5231e-02],
         [ 1.9412e-01,  5.5231e-02],
         [ 2.1077e-01,  5.5231e-02],
         [-7.6676e-02,  5.5231e-02],
         [-8.2960e-02,  5.5231e-02],
         [-1.0788e-01,  5.5231e-02],
         [-1.4928e-01,  5.5231e-02],
         [ 1.9666e-01,  5.5231e-02],
         [-2.1460e-01,  5.5231e-02],
         [ 2.1095e-01,  5.5231e-02],
         [ 2.0520e-01,  5.5231e-02],
         [ 2.0689e-01,  5.5231e-02],
         [ 2.2942e-01,  5.5231e-02],
         [ 2.2231e-01,  5.5231e-02],
         [ 2.0183e-01,  5.5231e-02],
         [-2.4266e-01,  5.5231e-02],
         [ 1.9306e-01,  5.5231e-02],
         [ 1.9124e-01,  5.5231e-02],
         [-2.0588e-01,  5.5231e-02],
         [-2.1027e-01,  5.5231e-02],
         [ 1.8548e-01,  5.5231e-02],
         [ 1.7565e-01,  5.5231e-02],
         [ 2.0323e-01,  5.5231e-02],
         [ 2.1758e-01,  5.5231e-02],
         [ 2.3140e-01,  5.5231e-02],
         [ 2.2502e-01,  5.5231e-02],
         [-2.5833e-03,  5.5231e-02]],

        [[ 1.3939e-01, -5.1416e-02],
         [ 1.5398e-01, -7.6477e-02],
         [ 7.0606e-02, -8.4015e-02],
         [-1.4636e-01, -8.7044e-02],
         [-1.4707e-01,  1.5205e-01],
         [-1.2341e-01,  1.6710e-01],
         [-1.2155e-01,  1.6975e-01],
         [-1.0916e-01,  1.9938e-01],
         [-1.2293e-01,  1.9549e-01],
         [-1.1171e-01,  2.0949e-01],
         [ 2.1228e-01,  2.1883e-01],
         [-1.0728e-01,  1.0772e-01],
         [-1.0229e-01,  1.1180e-01],
         [-1.1897e-01,  9.7915e-02],
         [ 2.0492e-01, -1.4393e-01],
         [ 2.0608e-01, -8.0592e-02],
         [-1.1906e-01, -9.8526e-02],
         [-1.1837e-01,  1.3753e-01],
         [-1.2121e-01, -1.0157e-01],
         [-1.2273e-01, -1.5782e-01],
         [-1.3262e-01, -1.4990e-01],
         [-1.2865e-01, -9.1335e-02],
         [-1.2282e-01, -8.7299e-02],
         [-1.1969e-01, -8.6042e-02],
         [-1.1822e-01, -1.0800e-01],
         [ 6.9391e-03, -1.1550e-01],
         [ 3.0540e-02, -1.5387e-01],
         [ 4.2557e-02, -1.6082e-01],
         [ 4.7953e-02,  9.4721e-02],
         [ 5.0085e-02,  1.9800e-01],
         [ 5.0708e-02,  2.0602e-01],
         [ 5.0775e-02,  2.0857e-01],
         [ 5.0606e-02,  2.1061e-01],
         [ 5.0433e-02,  2.2022e-01],
         [ 5.0307e-02,  7.6284e-02],
         [ 5.0174e-02,  1.0515e-01],
         [ 5.0109e-02,  1.1687e-01],
         [ 5.0065e-02,  9.0424e-02],
         [ 5.0046e-02,  1.0384e-01],
         [ 5.0032e-02,  2.2231e-01],
         [ 5.0024e-02,  8.8656e-02],
         [ 5.0011e-02,  2.1054e-01],
         [ 5.0014e-02, -8.8448e-02],
         [ 5.0016e-02, -8.9649e-02],
         [ 5.0022e-02,  2.8678e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-7.2144e-05, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.6128, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4517, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5215, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0161, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1081, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1572, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2656249.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2314, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.7646e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3503, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2057, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3503, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12029
target_mac_out tensor([[[[-1.0000e+07, -5.3297e-02,  7.5482e-02,  ...,  2.0656e-03,
            1.2204e-01, -1.0000e+07],
          [-1.0000e+07, -1.9084e-02,  9.7086e-02,  ..., -1.3971e-02,
            1.2488e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.5629e-02,  1.0205e-01,  ...,  2.9037e-02,
            1.5777e-01, -1.0000e+07],
          [-1.0000e+07, -3.6519e-02,  1.2831e-01,  ..., -1.0385e-02,
            1.4391e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3040e-02,  8.1237e-02,  ..., -2.4436e-03,
            1.5626e-01, -1.0000e+07],
          [-1.0000e+07, -3.2246e-02,  1.3290e-01,  ..., -1.7640e-02,
            1.4032e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0229e-01,  8.0819e-02,  ...,  7.7788e-02,
            1.7720e-01, -3.2441e-01],
          [ 5.5214e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.8111e-01,  6.6038e-02,  ...,  6.8716e-02,
            1.5676e-01, -3.1752e-01],
          [ 5.5195e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.0665e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5174e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3268e-01,  1.1815e-01,  ...,  6.9543e-02,
            1.6155e-01, -1.0000e+07],
          [-1.0000e+07, -2.7664e-02,  1.0133e-01,  ...,  1.0988e-02,
            1.3958e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6339e-01,  1.3025e-01,  ...,  7.9943e-02,
            1.7916e-01, -3.7833e-01],
          [-1.0000e+07, -5.6401e-02,  1.3878e-01,  ...,  3.7180e-02,
            1.4673e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.3297e-02, -1.9084e-02],
         [-7.5629e-02, -3.6519e-02],
         [-8.3040e-02, -3.2246e-02],
         [-1.0381e-01,  1.4997e-01],
         [-8.6266e-02,  1.2857e-01],
         [-8.0734e-02, -5.8677e-02],
         [-8.8302e-02,  9.4907e-02],
         [-6.8393e-02, -4.8210e-02],
         [-5.9200e-02, -8.0453e-02],
         [-8.0512e-02, -6.8161e-02],
         [-9.3673e-02,  1.2270e-01],
         [-8.2696e-02,  1.3282e-01],
         [-7.0736e-02, -5.8241e-02],
         [-1.1823e-01,  1.2715e-01],
         [-8.5227e-02,  1.3374e-01],
         [-1.2582e-01, -5.8298e-02],
         [-9.3707e-02,  1.3216e-01],
         [-8.8254e-02, -5.4182e-02],
         [-1.2706e-01,  9.8658e-02],
         [-1.2522e-01,  1.3812e-01],
         [ 1.3342e-01,  1.5478e-01],
         [ 1.4395e-01,  1.2879e-01],
         [-1.5782e-01, -6.7940e-02],
         [-1.6495e-01, -6.7976e-02],
         [ 1.5289e-01,  7.4302e-02],
         [ 1.7302e-01,  7.2810e-02],
         [ 1.7290e-01,  1.0323e-01],
         [ 1.7965e-01,  1.4466e-01],
         [ 1.8084e-01,  1.3841e-01],
         [ 1.8210e-01, -1.8663e-01],
         [-1.5256e-01,  1.2513e-01],
         [ 1.5311e-01, -1.9954e-01],
         [ 1.6139e-01, -1.9831e-01],
         [ 1.6916e-01, -1.9709e-01],
         [ 1.8088e-01, -2.0171e-01],
         [ 1.7674e-01, -1.9706e-01],
         [ 2.0159e-01,  1.2865e-01],
         [ 1.5364e-01,  1.4001e-01],
         [ 1.6169e-01, -2.1167e-01],
         [ 1.6789e-01,  1.0954e-01],
         [-2.3486e-01,  7.9808e-02],
         [-2.3163e-01,  1.2227e-01],
         [-2.3494e-01,  1.0546e-01],
         [-2.3480e-01,  8.4210e-02],
         [ 1.7022e-01,  8.8920e-02],
         [ 1.5888e-01,  1.1235e-01],
         [ 1.8015e-01,  8.5039e-02],
         [ 1.4203e-01, -1.9035e-01],
         [ 1.6808e-01, -1.6862e-01],
         [ 1.4943e-01, -1.6723e-01],
         [ 1.4648e-01, -1.6040e-01],
         [ 1.1724e-01, -1.1246e-02],
         [ 1.0427e-01,  2.4357e-02],
         [ 1.3045e-01,  4.2088e-02],
         [ 1.0962e-01,  5.0133e-02],
         [ 1.3148e-01,  5.3519e-02],
         [ 1.2924e-01,  5.4794e-02],
         [ 9.7159e-02,  5.5177e-02],
         [ 1.0851e-01,  5.5255e-02],
         [ 1.1863e-01,  5.5250e-02],
         [ 8.0819e-02,  5.5214e-02],
         [-1.8111e-01,  5.5195e-02],
         [ 1.0665e-02,  5.5174e-02]],

        [[-1.0334e-01, -1.1117e-02],
         [-1.3268e-01, -2.7664e-02],
         [-1.6339e-01,  1.3878e-01],
         [ 1.3240e-01,  1.1431e-01],
         [-1.7635e-01,  1.4918e-01],
         [-1.8472e-01,  1.7915e-01],
         [ 1.2844e-01,  1.8166e-01],
         [ 1.3229e-01,  1.9128e-01],
         [ 1.3505e-01,  1.8584e-01],
         [ 1.0547e-01,  1.4130e-01],
         [ 8.2169e-02, -1.9085e-01],
         [ 1.0412e-01, -1.9374e-01],
         [-1.5309e-01, -1.7703e-01],
         [ 5.8766e-02, -1.6345e-01],
         [ 1.3083e-01, -1.6952e-01],
         [ 8.9016e-02, -1.5186e-01],
         [-1.0635e-01, -1.3665e-01],
         [-1.2349e-01,  1.0005e-01],
         [ 1.1510e-01,  1.1522e-01],
         [ 1.4223e-01,  1.1503e-01],
         [-7.6913e-02,  8.1579e-02],
         [ 3.4286e-02,  8.9438e-02],
         [ 4.8491e-02,  6.6553e-02],
         [ 5.2648e-02,  5.6278e-02],
         [ 5.3158e-02,  8.9652e-02],
         [ 5.2547e-02,  1.0503e-01],
         [ 5.1760e-02,  9.2597e-02],
         [ 5.1121e-02, -1.6687e-01],
         [ 5.0658e-02, -1.6563e-01],
         [ 5.0389e-02,  9.0533e-02],
         [ 5.0232e-02,  6.7912e-02],
         [ 5.0121e-02,  9.5607e-02],
         [ 5.0043e-02,  6.7202e-02],
         [ 5.0036e-02,  9.4253e-02],
         [ 5.0026e-02, -1.7882e-01],
         [ 5.0025e-02,  8.9315e-02],
         [ 5.0005e-02, -1.9228e-01],
         [ 5.0005e-02, -1.7313e-01],
         [ 5.0012e-02, -1.6074e-01],
         [ 5.0015e-02, -1.5926e-01],
         [ 5.0016e-02, -1.4929e-01],
         [ 5.0014e-02,  2.3231e-01],
         [ 5.0008e-02,  2.2538e-01],
         [ 5.0007e-02, -1.6132e-01],
         [ 5.0007e-02,  1.3797e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-5.5792e-05, device='cuda:0') tensor(0.0020, device='cuda:0') tensor(-0.0019, device='cuda:0')
mixer_td_error tensor(0.3240, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5811, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6638, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0070, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1037, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1089, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1428571.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2323, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.6213e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3050, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2625, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3050, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12075
target_mac_out tensor([[[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7413e-02,  9.1951e-02,  ...,  4.7431e-02,
            1.5634e-01, -1.0000e+07],
          [-1.0000e+07, -1.9542e-02,  9.5194e-02,  ...,  4.5180e-03,
            1.4030e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4907e-02,  9.5719e-02,  ...,  2.4923e-02,
            1.5235e-01, -1.0000e+07],
          [-1.0000e+07, -3.7884e-02,  9.5978e-02,  ..., -2.8356e-02,
            1.3624e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7817e-01,  9.8537e-02,  ...,  4.7439e-02,
            1.8094e-01, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.8002e-01,  1.0101e-01,  ...,  3.9088e-02,
            1.7176e-01, -1.0000e+07],
          [ 5.5215e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.0315e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5217e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.4360e-02,  7.4236e-02,  ...,  6.2640e-03,
            1.2703e-01, -1.0000e+07],
          [-1.0000e+07, -7.0404e-02,  1.5810e-01,  ...,  4.6388e-02,
            1.4908e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0383e-01,  9.7922e-02,  ...,  1.2565e-02,
            1.4072e-01, -1.0000e+07],
          [-1.0000e+07, -9.8419e-02,  1.7124e-01,  ...,  6.4498e-02,
            1.6552e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.8313e-02, -6.8065e-03],
         [-7.7413e-02, -1.9542e-02],
         [-7.4907e-02,  9.5978e-02],
         [-6.1909e-02,  1.2112e-01],
         [ 1.0181e-01,  1.1712e-01],
         [ 1.2325e-01,  1.0181e-01],
         [ 1.1046e-01,  1.4455e-01],
         [ 1.1896e-01,  1.6088e-01],
         [ 1.2130e-01,  1.3627e-01],
         [ 1.2508e-01,  1.4786e-01],
         [ 1.3050e-01,  1.5513e-01],
         [ 1.3661e-01,  1.0765e-01],
         [ 1.4742e-01,  9.5794e-02],
         [ 1.5836e-01,  8.3527e-02],
         [ 1.5084e-01,  1.2005e-01],
         [ 1.6046e-01,  8.7728e-02],
         [ 1.2381e-01,  1.1064e-01],
         [ 1.4381e-01, -1.1944e-01],
         [ 1.2491e-01,  1.2143e-01],
         [ 1.3591e-01,  1.3413e-01],
         [ 1.5950e-01,  1.0017e-01],
         [ 1.6351e-01,  1.2531e-01],
         [ 1.7499e-01,  9.3300e-02],
         [ 1.7988e-01,  1.1284e-01],
         [ 1.4202e-01,  8.4452e-02],
         [ 1.6703e-01,  8.5429e-02],
         [ 1.1923e-01,  8.7483e-02],
         [ 1.5715e-01,  1.0990e-01],
         [ 1.6606e-01,  1.2561e-01],
         [ 1.4386e-01,  9.4504e-02],
         [ 1.5060e-01,  1.0239e-01],
         [ 1.6097e-01,  7.1379e-02],
         [ 1.2056e-01,  1.0856e-01],
         [ 1.0239e-01,  1.0566e-01],
         [ 1.0432e-01,  9.4478e-02],
         [ 1.2342e-01,  9.2592e-02],
         [ 1.3042e-01,  8.0792e-02],
         [ 9.9325e-02,  2.7572e-03],
         [ 1.0769e-01,  2.8626e-02],
         [ 8.8383e-02,  4.3828e-02],
         [ 7.9083e-02,  5.1240e-02],
         [ 9.5773e-02,  5.4425e-02],
         [ 7.9592e-02,  5.5534e-02],
         [ 1.0483e-01,  5.5772e-02],
         [ 7.1628e-02,  5.5706e-02],
         [ 5.0741e-02,  5.5571e-02],
         [ 7.9819e-02,  5.5459e-02],
         [ 8.7825e-02,  5.5338e-02],
         [ 7.8459e-02,  5.5317e-02],
         [ 8.3961e-02,  5.5260e-02],
         [ 8.4669e-02,  5.5226e-02],
         [ 9.8537e-02,  5.5230e-02],
         [ 1.0101e-01,  5.5215e-02],
         [ 1.0315e-02,  5.5217e-02]],

        [[-4.5201e-02, -4.8984e-02],
         [-6.4360e-02,  1.5810e-01],
         [ 9.7922e-02,  1.7124e-01],
         [-7.6672e-02,  1.5098e-01],
         [ 1.0214e-01,  7.9768e-02],
         [-5.7887e-02,  9.4059e-02],
         [ 1.1921e-01,  9.3205e-02],
         [ 1.5301e-01,  5.7789e-02],
         [-3.8140e-02,  9.6146e-02],
         [ 1.7710e-01,  6.0274e-02],
         [-4.5152e-02,  1.1000e-01],
         [-4.1867e-02,  1.4969e-01],
         [ 1.1970e-01,  1.6965e-01],
         [ 1.1135e-01,  1.6665e-01],
         [ 1.2149e-01,  1.6551e-01],
         [ 1.1117e-01,  9.9754e-02],
         [ 1.2073e-01,  1.3876e-01],
         [ 8.4568e-02,  1.0318e-01],
         [ 9.4919e-02,  6.7308e-02],
         [ 8.5131e-02,  2.6890e-02],
         [ 1.0608e-01,  8.6733e-02],
         [ 7.7939e-02,  5.9013e-02],
         [ 1.0957e-01,  1.9309e-02],
         [-7.0186e-02,  4.1537e-02],
         [-7.8832e-02,  5.1971e-02],
         [ 8.8339e-02,  5.5940e-02],
         [ 1.1391e-01,  5.6931e-02],
         [ 1.2687e-01,  5.6799e-02],
         [ 9.7271e-02,  5.6349e-02],
         [ 1.1140e-01,  5.5964e-02],
         [ 7.4655e-02,  5.5651e-02],
         [ 1.1591e-01,  5.5474e-02],
         [ 1.3126e-01,  5.5348e-02],
         [ 1.2722e-01,  5.5283e-02],
         [ 8.6774e-02,  5.5242e-02],
         [ 1.1623e-01,  5.5190e-02],
         [ 1.5374e-01,  5.5229e-02],
         [ 1.8613e-01,  5.5209e-02],
         [ 1.4649e-01,  5.5214e-02],
         [ 1.2912e-01,  5.5203e-02],
         [ 1.4835e-01,  5.5219e-02],
         [ 1.3968e-01,  5.5224e-02],
         [ 1.7577e-01,  5.5226e-02],
         [ 1.7443e-01,  5.5230e-02],
         [ 1.4300e-01,  5.5230e-02],
         [ 1.4270e-01,  5.5230e-02],
         [ 9.5536e-02,  5.5232e-02],
         [ 7.2049e-02,  5.5236e-02],
         [ 1.2583e-01,  5.5235e-02],
         [ 1.1949e-01,  5.5232e-02],
         [ 8.9068e-03,  5.5232e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0001, device='cuda:0') tensor(0.0020, device='cuda:0') tensor(-0.0022, device='cuda:0')
mixer_td_error tensor(0.0194, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4676, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8007, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0060, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1139, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-277777.6562, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1861, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.8232e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0015, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2014, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0943, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2014, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12120
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2205e-01,  1.1988e-01,  ...,  6.8454e-02,
            1.6031e-01, -1.0000e+07],
          [-1.0000e+07, -1.9420e-02,  1.0915e-01,  ...,  3.4743e-02,
            1.3353e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1937e-01,  9.4539e-02,  ...,  5.6656e-02,
            1.5891e-01, -1.0000e+07],
          [-1.0000e+07, -4.5652e-02,  1.3888e-01,  ...,  5.1154e-02,
            1.4027e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6527e-02,  7.9265e-02,  ...,  4.2534e-02,
            1.3764e-01, -1.0000e+07],
          [-1.0000e+07, -3.4160e-02,  1.2734e-01,  ...,  3.6650e-02,
            1.4514e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7552e-02,  6.9527e-02,  ...,  3.6922e-02,
            1.3246e-01, -1.0000e+07],
          [-1.0000e+07, -6.9459e-02,  1.5722e-01,  ...,  6.3242e-02,
            1.5510e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4887e-01,  4.9958e-02,  ...,  3.2413e-02,
            1.7518e-01, -3.0026e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6329e-01,  7.7314e-02,  ...,  6.4431e-02,
            1.9656e-01, -3.1323e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-8.6026e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.0687e-02,  8.9914e-02],
         [ 6.8454e-02,  1.0915e-01],
         [ 5.6656e-02,  1.3888e-01],
         [ 4.8391e-02,  1.4947e-01],
         [ 1.3585e-01,  1.2308e-01],
         [ 1.1487e-01,  1.2481e-01],
         [ 1.2275e-01,  1.0491e-01],
         [ 1.4212e-01,  1.9513e-01],
         [ 1.3474e-01,  5.1943e-02],
         [ 1.5200e-01,  1.0832e-01],
         [ 1.5458e-01,  1.2840e-01],
         [ 1.3206e-01,  1.6635e-01],
         [ 1.5653e-01,  1.3702e-01],
         [ 1.7039e-01,  1.1830e-01],
         [ 1.5652e-01,  8.7195e-02],
         [ 1.3996e-01,  5.1047e-02],
         [ 1.2597e-01,  9.5501e-02],
         [ 1.1951e-01,  1.0390e-01],
         [ 1.1933e-01,  8.6694e-02],
         [ 1.1578e-01,  1.0688e-01],
         [ 1.5850e-01,  1.5001e-01],
         [-1.6899e-02,  1.3430e-01],
         [ 1.5797e-02,  1.2504e-01],
         [ 3.3799e-02,  8.1255e-02],
         [ 4.2970e-02,  5.8857e-02],
         [ 4.7334e-02,  5.5341e-02],
         [ 4.9274e-02,  9.7146e-02],
         [ 5.0034e-02,  7.0917e-02],
         [ 5.0254e-02,  5.8782e-02],
         [ 5.0270e-02,  8.7550e-02],
         [ 5.0202e-02,  1.1000e-01],
         [ 5.0136e-02,  7.3112e-02],
         [ 5.0107e-02,  8.6480e-02],
         [ 5.0085e-02,  1.0361e-01],
         [ 5.0057e-02,  6.3217e-02],
         [ 5.0038e-02,  8.9962e-02],
         [ 5.0028e-02,  6.2150e-02],
         [ 5.0026e-02,  9.1180e-02],
         [ 5.0018e-02,  5.8613e-02],
         [ 5.0018e-02,  8.6638e-02],
         [ 5.0019e-02,  5.5606e-02],
         [ 5.0016e-02,  6.9119e-02],
         [ 5.0005e-02,  3.6899e-02],
         [ 5.0007e-02,  2.7276e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 6.0687e-02,  8.9914e-02],
         [ 4.2534e-02,  1.2734e-01],
         [ 3.6922e-02,  1.5722e-01],
         [ 8.8115e-02,  1.3407e-01],
         [ 9.2021e-02,  1.1965e-01],
         [ 1.1077e-01,  9.8505e-02],
         [ 1.0885e-01,  7.5371e-02],
         [ 1.1219e-01,  1.0466e-01],
         [ 1.2187e-01,  9.2092e-02],
         [ 1.2941e-01,  8.4600e-02],
         [ 1.2847e-01,  1.2769e-01],
         [ 1.3701e-01,  9.7878e-02],
         [ 1.1949e-01,  8.5881e-02],
         [ 9.6336e-02, -4.5435e-03],
         [ 1.0414e-01,  1.2171e-02],
         [ 8.9616e-02,  8.5009e-02],
         [ 9.5280e-02,  7.3843e-02],
         [ 1.2142e-01,  9.3602e-02],
         [ 1.0903e-01,  1.0871e-01],
         [ 1.2760e-01,  8.5809e-02],
         [ 1.3876e-01,  1.0593e-01],
         [ 1.3461e-01,  1.0264e-01],
         [ 1.3718e-01,  1.0112e-01],
         [ 1.4534e-01,  7.9505e-02],
         [ 1.3053e-01,  1.8761e-01],
         [ 1.5854e-01,  8.0270e-02],
         [ 1.6483e-01,  1.0052e-01],
         [ 1.8051e-01,  1.4853e-01],
         [ 1.4739e-01,  1.6411e-01],
         [ 1.6740e-01,  1.5900e-01],
         [ 1.7496e-01,  1.8515e-01],
         [ 1.8802e-01,  1.9385e-01],
         [ 1.8790e-01,  1.4945e-01],
         [ 1.8971e-01,  1.1596e-01],
         [ 1.5564e-01,  1.3987e-01],
         [ 1.7631e-01,  9.6963e-02],
         [ 1.6737e-01,  1.0210e-01],
         [ 1.7581e-01,  1.1055e-01],
         [ 1.9133e-01,  9.9574e-02],
         [ 2.0358e-01,  8.6684e-02],
         [ 1.6890e-01,  1.0010e-01],
         [ 1.9061e-01,  6.3768e-02],
         [ 1.9686e-01,  4.8977e-02],
         [ 1.5919e-01,  9.0457e-02],
         [ 1.3247e-01,  1.0169e-01],
         [ 1.3794e-01,  1.3351e-01],
         [-6.2971e-03,  6.7550e-02],
         [ 2.3971e-02,  8.9282e-02],
         [ 3.8744e-02,  9.3159e-02],
         [ 4.5555e-02,  1.3037e-01],
         [ 4.8516e-02,  1.4562e-01],
         [ 4.9665e-02,  9.2352e-02],
         [ 5.0048e-02,  8.9715e-02],
         [ 5.0141e-02,  1.3513e-01],
         [ 5.0132e-02,  1.6858e-01],
         [ 5.0067e-02,  1.0761e-01],
         [ 5.0055e-02,  8.1093e-02],
         [ 5.0023e-02,  5.2475e-02],
         [ 5.0024e-02,  3.9674e-02],
         [ 5.0018e-02,  5.9789e-02],
         [ 5.0000e-02,  4.5508e-02],
         [ 5.0017e-02,  3.2298e-02],
         [ 5.0013e-02,  3.0250e-02],
         [ 5.0027e-02,  5.5933e-02],
         [ 5.0017e-02,  7.7275e-02],
         [ 5.0017e-02,  8.6950e-02],
         [ 5.0012e-02,  5.0850e-02],
         [ 5.0009e-02,  4.8595e-02],
         [ 5.0006e-02,  7.8928e-02],
         [ 5.0008e-02,  4.8462e-02],
         [ 5.0007e-02,  8.0987e-02],
         [ 5.0008e-02,  7.5495e-02],
         [ 5.0008e-02,  1.0192e-01],
         [ 5.0008e-02,  1.1354e-01],
         [ 5.0008e-02,  9.5109e-02],
         [ 5.0008e-02,  7.5489e-02],
         [ 5.0008e-02,  4.3725e-02],
         [ 5.0008e-02,  3.4881e-02],
         [ 5.0008e-02,  7.4136e-02],
         [ 5.0009e-02,  5.7429e-02],
         [ 5.0009e-02,  4.9060e-02],
         [ 5.0009e-02,  7.7326e-02],
         [ 5.0009e-02,  8.7918e-02],
         [ 5.0009e-02,  9.2311e-02],
         [ 5.0009e-02,  7.7767e-02],
         [ 5.0009e-02,  1.0283e-01],
         [ 5.0009e-02,  9.8664e-02],
         [ 5.0009e-02,  8.7238e-02],
         [ 5.0009e-02,  5.9636e-02],
         [ 5.0009e-02,  9.6231e-02],
         [ 5.0009e-02,  9.6428e-02],
         [ 5.0009e-02,  1.0940e-01],
         [ 5.0009e-02,  9.9618e-02],
         [ 5.0009e-02,  6.0348e-02],
         [ 5.0009e-02,  8.1648e-02],
         [ 5.0009e-02,  7.3009e-02],
         [ 5.0009e-02,  4.2855e-02],
         [ 5.0009e-02,  4.3671e-02],
         [ 5.0009e-02,  6.8596e-02],
         [ 5.0009e-02,  6.1681e-02],
         [ 5.0009e-02,  4.2074e-02],
         [ 5.0009e-02,  4.6716e-02],
         [ 5.0009e-02,  3.3170e-02],
         [ 5.0009e-02,  4.1199e-02],
         [ 5.0009e-02,  1.5826e-02],
         [ 5.0009e-02,  1.9124e-01],
         [ 5.0009e-02,  3.8505e-02],
         [ 5.0009e-02,  5.4523e-02],
         [ 5.0009e-02,  1.9803e-01],
         [ 5.0009e-02,  2.0629e-01],
         [ 5.0009e-02,  6.4113e-02],
         [ 5.0009e-02,  1.9055e-01],
         [ 5.0009e-02,  2.0078e-01],
         [ 5.0009e-02,  6.7291e-02],
         [ 5.0009e-02,  7.5200e-02],
         [ 5.0009e-02,  1.9574e-01],
         [ 5.0009e-02,  5.8367e-02],
         [ 5.0009e-02,  6.2846e-02],
         [ 5.0009e-02,  1.8596e-01],
         [ 5.0009e-02,  6.5077e-02],
         [ 5.0009e-02,  1.0332e-01],
         [ 5.0009e-02,  1.8815e-01],
         [ 5.0009e-02,  6.8542e-02],
         [ 5.0009e-02,  5.6066e-02],
         [ 5.0009e-02,  1.9149e-01],
         [ 5.0009e-02,  5.5714e-02],
         [ 5.0009e-02,  6.9831e-02],
         [ 5.0009e-02,  5.9174e-02],
         [ 5.0009e-02,  3.9532e-02],
         [ 5.0009e-02,  6.1663e-02],
         [ 5.0009e-02,  8.6841e-02],
         [ 5.0009e-02,  9.6118e-02],
         [ 5.0009e-02,  1.0580e-01],
         [ 5.0009e-02,  9.8987e-02],
         [ 5.0009e-02,  8.3273e-02],
         [ 5.0009e-02,  7.3983e-02],
         [ 5.0009e-02,  8.0187e-02],
         [ 5.0009e-02,  8.2958e-02],
         [ 5.0009e-02,  4.9958e-02],
         [ 5.0009e-02,  7.7314e-02],
         [ 5.0009e-02, -8.6026e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.8557e-05, device='cuda:0') tensor(0.0008, device='cuda:0') tensor(-0.0013, device='cuda:0')
mixer_td_error tensor(0.8302, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4660, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8229, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0360, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1195, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0890, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3439715.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2063, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.2342e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2560, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.0318, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2560, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12188
target_mac_out tensor([[[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.6914e-02,  5.5395e-02,  ...,  1.2422e-02,
            1.3499e-01, -1.0000e+07],
          [-1.0000e+07, -2.7452e-02,  1.3144e-01,  ...,  7.4187e-03,
            1.4409e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2515e-02,  6.0388e-02,  ..., -1.1286e-02,
            1.4546e-01, -1.0000e+07],
          [-1.0000e+07, -2.0059e-02,  1.2605e-01,  ...,  1.5017e-02,
            1.4412e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0660e-01,  1.0891e-01,  ...,  4.0960e-02,
            1.4451e-01, -1.0000e+07],
          [-1.0000e+07, -1.8482e-02,  1.0351e-01,  ...,  3.3942e-02,
            1.3388e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8928e-02,  7.1365e-02,  ...,  2.7223e-02,
            1.4807e-01, -1.0000e+07],
          [-1.0000e+07, -6.4588e-03,  1.1091e-01,  ...,  1.4417e-02,
            1.1999e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -5.3589e-02,  1.3369e-01,  ...,  4.2509e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -6.3608e-02,  1.4634e-01,  ...,  5.5140e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.7686e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.0205e-02,  9.0702e-02],
         [ 5.5395e-02,  1.3144e-01],
         [ 6.0388e-02,  1.2605e-01],
         [ 9.1477e-02,  8.3289e-02],
         [ 1.4137e-01,  8.7654e-02],
         [ 1.2277e-01,  1.3537e-01],
         [ 1.0659e-01,  1.1034e-01],
         [ 1.1623e-01,  1.0261e-01],
         [ 1.0443e-01,  1.1844e-01],
         [ 1.0225e-01,  1.2200e-01],
         [ 1.0200e-01,  8.7869e-02],
         [ 1.1722e-01,  1.1370e-01],
         [ 1.5871e-01,  7.5558e-02],
         [ 1.1365e-01,  1.0914e-01],
         [ 1.0897e-01,  9.6196e-02],
         [ 1.2132e-01,  1.0912e-01],
         [ 1.0951e-01,  6.6277e-02],
         [ 1.0613e-01,  4.0938e-02],
         [ 1.0721e-01,  9.2418e-02],
         [ 1.0764e-01,  1.0986e-01],
         [ 1.0949e-01,  1.0630e-01],
         [ 1.0034e-01,  8.4399e-02],
         [ 1.1372e-01,  8.2886e-02],
         [ 1.3016e-01,  8.2902e-02],
         [ 1.3713e-01,  9.4682e-02],
         [ 9.5074e-02,  6.6553e-02],
         [ 1.0224e-01,  7.9282e-02],
         [ 1.1625e-01,  5.3343e-02],
         [ 1.1671e-01,  1.1568e-01],
         [ 1.4096e-01,  1.3369e-01],
         [ 8.6703e-02, -1.8209e-02],
         [ 9.1387e-02,  2.0841e-02],
         [ 1.0780e-01,  4.0368e-02],
         [ 1.3329e-01,  4.9344e-02],
         [ 8.5417e-02,  5.3258e-02],
         [ 7.0334e-02,  5.4784e-02],
         [ 1.1319e-01,  5.5265e-02],
         [ 1.4631e-01,  5.5402e-02],
         [ 1.1116e-01,  5.5367e-02],
         [ 1.4266e-01,  5.5328e-02],
         [ 1.4110e-01,  5.5265e-02],
         [ 1.5288e-01,  5.5228e-02],
         [ 1.1093e-01,  5.5235e-02],
         [ 1.2589e-01,  5.5203e-02],
         [ 9.8167e-02,  5.5221e-02],
         [ 1.1759e-01,  5.5204e-02],
         [ 1.3548e-01,  5.5217e-02],
         [ 1.4155e-01,  5.5201e-02],
         [ 1.4285e-01,  5.5222e-02],
         [ 1.3618e-01,  5.5223e-02],
         [ 9.3031e-02,  5.5232e-02],
         [ 1.1373e-01,  5.5231e-02],
         [-3.3966e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0780e-01,  8.9914e-02],
         [ 1.0891e-01,  1.0351e-01],
         [ 7.1365e-02,  1.1091e-01],
         [ 1.0232e-01,  1.3664e-01],
         [ 7.2960e-02,  1.4697e-01],
         [ 1.0329e-01,  1.3410e-01],
         [ 1.0722e-01,  1.1105e-01],
         [ 7.4140e-02,  1.0349e-01],
         [ 7.3321e-02,  1.0143e-01],
         [ 9.5557e-02,  9.7142e-02],
         [ 1.0693e-01,  1.2286e-01],
         [ 9.5909e-02,  1.0741e-01],
         [ 7.2147e-02,  1.3140e-01],
         [ 8.3277e-02,  1.4134e-01],
         [ 1.0789e-01,  1.6046e-01],
         [ 1.2220e-01,  1.3346e-01],
         [ 1.2203e-01,  9.5938e-02],
         [ 1.0645e-01,  1.2609e-01],
         [ 1.3163e-01,  1.2211e-01],
         [ 1.3612e-01,  1.0114e-01],
         [ 1.0972e-01,  8.5977e-02],
         [ 1.0088e-01,  8.8142e-02],
         [ 1.1610e-01,  1.3562e-01],
         [ 1.3325e-01,  1.5198e-01],
         [ 1.4066e-01,  1.4183e-01],
         [ 1.2262e-01,  9.1951e-02],
         [ 1.0962e-01,  9.7596e-02],
         [ 8.1806e-02,  6.2137e-02],
         [ 9.6653e-02,  7.2180e-02],
         [ 1.2296e-01,  8.2419e-02],
         [ 9.2967e-02,  4.5509e-02],
         [ 9.7192e-02,  2.1198e-02],
         [ 1.0872e-01,  9.1904e-02],
         [ 1.1913e-01,  9.4866e-02],
         [ 1.0491e-01,  9.7274e-02],
         [ 1.1757e-01,  1.0496e-01],
         [ 1.2348e-01,  1.2557e-01],
         [ 7.9301e-02,  1.2184e-01],
         [ 7.2027e-02,  8.3242e-02],
         [ 6.7933e-02,  8.3151e-02],
         [ 9.1154e-02,  2.3559e-01],
         [ 7.6238e-02,  2.1584e-01],
         [ 9.4505e-02,  7.0447e-02],
         [ 9.4086e-02,  6.0095e-02],
         [ 6.1796e-02,  9.9076e-02],
         [ 5.2681e-02,  5.6504e-02],
         [ 8.6235e-02,  8.5389e-02],
         [ 7.5013e-02,  9.1901e-02],
         [ 9.4536e-02,  1.0512e-01],
         [ 7.6552e-02,  9.8362e-02],
         [ 9.8397e-02,  9.4596e-02],
         [ 1.0604e-01,  6.4166e-02],
         [ 1.0807e-01,  9.8112e-02],
         [ 1.1879e-01,  1.0005e-01],
         [ 1.1360e-01,  8.3395e-02],
         [ 1.1549e-01,  1.0946e-01],
         [ 1.0928e-01,  1.2266e-01],
         [ 1.3305e-01,  1.0439e-01],
         [ 1.0559e-01,  8.5825e-02],
         [ 1.3164e-01,  1.1369e-01],
         [ 1.3856e-01,  9.5307e-02],
         [ 1.4407e-01,  1.1329e-01],
         [ 1.7035e-01,  1.2186e-01],
         [ 1.3371e-01,  8.8530e-02],
         [ 1.4009e-01,  7.1392e-02],
         [ 1.0089e-01,  7.2937e-02],
         [ 1.2762e-01,  8.9119e-02],
         [ 1.4125e-01,  9.5281e-02],
         [ 1.4634e-01,  1.0041e-01],
         [ 1.4501e-01,  9.6483e-02],
         [ 1.0114e-01,  7.5197e-02],
         [ 4.5363e-02,  2.4374e-02],
         [ 4.5874e-02,  2.0186e-02],
         [ 4.8161e-02,  4.7517e-02],
         [ 4.9559e-02,  2.9706e-02],
         [ 5.0116e-02,  5.2010e-02],
         [ 5.0224e-02,  6.0389e-02],
         [ 5.0164e-02,  4.6658e-02],
         [ 5.0077e-02,  1.3127e-02],
         [ 5.0000e-02,  4.4727e-02],
         [ 4.9980e-02,  1.6449e-02],
         [ 4.9969e-02,  2.9716e-02],
         [ 4.9963e-02,  2.0938e-02],
         [ 4.9972e-02,  1.6699e-02],
         [ 4.9979e-02,  1.4424e-02],
         [ 4.9996e-02,  4.1006e-02],
         [ 5.0000e-02,  3.3005e-02],
         [ 5.0017e-02,  4.6068e-02],
         [ 5.0009e-02,  3.6644e-02],
         [ 5.0016e-02,  2.1235e-02],
         [ 5.0019e-02,  4.7998e-02],
         [ 5.0012e-02,  6.0842e-02],
         [ 5.0012e-02,  3.5138e-02],
         [ 5.0006e-02,  5.3112e-02],
         [ 5.0008e-02,  9.6558e-02],
         [ 5.0008e-02,  5.5508e-02],
         [ 5.0008e-02,  5.3877e-02],
         [ 5.0008e-02,  9.2911e-02],
         [ 5.0008e-02,  7.2137e-02],
         [ 5.0008e-02,  7.1514e-02],
         [ 5.0008e-02,  7.2525e-02],
         [ 5.0008e-02,  7.3659e-02],
         [ 5.0008e-02,  5.1056e-02],
         [ 5.0008e-02,  6.2098e-02],
         [ 5.0009e-02,  6.7826e-02],
         [ 5.0009e-02,  7.0866e-02],
         [ 5.0009e-02,  7.2535e-02],
         [ 5.0009e-02,  4.0870e-02],
         [ 5.0009e-02,  5.4795e-02],
         [ 5.0009e-02,  6.4876e-02],
         [ 5.0009e-02,  4.2280e-02],
         [ 5.0009e-02,  5.4565e-02],
         [ 5.0009e-02,  1.0135e-01],
         [ 5.0009e-02,  1.2118e-01],
         [ 5.0009e-02,  8.6418e-02],
         [ 5.0009e-02,  7.8670e-02],
         [ 5.0009e-02,  1.1152e-01],
         [ 5.0009e-02,  1.2383e-01],
         [ 5.0009e-02,  1.2864e-01],
         [ 5.0009e-02,  1.3082e-01],
         [ 5.0009e-02,  1.7277e-01],
         [ 5.0009e-02,  6.1939e-02],
         [ 5.0009e-02,  1.0138e-01],
         [ 5.0009e-02,  1.2165e-01],
         [ 5.0009e-02,  1.3272e-01],
         [ 5.0009e-02,  1.3925e-01],
         [ 5.0009e-02,  7.2853e-02],
         [ 5.0009e-02,  6.9259e-02],
         [ 5.0009e-02,  8.2112e-02],
         [ 5.0009e-02,  3.0991e-02],
         [ 5.0009e-02,  7.1647e-02],
         [ 5.0009e-02,  5.1519e-02],
         [ 5.0009e-02,  5.9879e-02],
         [ 5.0009e-02,  3.0201e-02],
         [ 5.0009e-02,  9.7682e-03],
         [ 5.0009e-02,  4.7889e-02],
         [ 5.0009e-02,  1.0175e-01],
         [ 5.0009e-02,  1.2143e-01],
         [ 5.0009e-02,  1.3214e-01],
         [ 5.0009e-02,  1.4587e-01],
         [ 5.0009e-02,  1.0074e-01],
         [ 5.0009e-02,  1.2682e-01],
         [ 5.0009e-02,  1.3574e-01],
         [ 5.0009e-02,  1.4887e-01],
         [ 5.0009e-02,  1.4346e-01],
         [ 5.0009e-02,  1.5426e-01],
         [ 5.0009e-02,  1.0013e-01],
         [ 5.0009e-02,  1.3369e-01],
         [ 5.0009e-02,  1.4634e-01],
         [ 5.0009e-02,  2.7686e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.8610e-05, device='cuda:0') tensor(0.0008, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.8153, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4651, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3757, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0422, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1234, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0637, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3233333., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2356, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.9377e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2479, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1257, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2479, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12233
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2179e-02,  8.7653e-02,  ...,  1.1971e-02,
            1.4701e-01, -1.0000e+07],
          [-1.0000e+07, -3.7128e-02,  1.3220e-01,  ...,  9.6965e-03,
            1.4422e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2015e-01,  1.1093e-01,  ...,  4.2340e-02,
            1.6688e-01, -1.0000e+07],
          [-1.0000e+07, -5.8526e-02,  1.5231e-01,  ..., -4.5886e-04,
            1.5562e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1402e-02,  8.1983e-02,  ...,  3.9429e-02,
            1.3744e-01, -1.0000e+07],
          [-1.0000e+07, -3.2219e-02,  9.6327e-02,  ..., -1.4636e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2918e-02,  8.3033e-02,  ...,  1.5905e-03,
            1.3806e-01, -1.0000e+07],
          [-1.0000e+07, -4.3941e-02,  1.2828e-01,  ...,  1.4506e-02,
            1.4886e-01, -1.0000e+07]],

         ...,

         [[ 5.0062e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1756e-01,  6.2249e-02,  ...,  7.2620e-02,
            1.8534e-01, -1.0000e+07]],

         [[ 5.0040e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3118e-01,  7.9832e-02,  ...,  8.7176e-02,
            1.9510e-01, -1.0000e+07]],

         [[ 5.0049e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.4158e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 8.7653e-02,  1.3220e-01],
         [ 1.1093e-01,  1.5231e-01],
         [ 1.0750e-01,  9.3771e-02],
         [ 1.0878e-01,  6.5922e-02],
         [ 1.2077e-01,  3.8954e-02],
         [ 1.2014e-01,  5.8108e-02],
         [ 1.1751e-01,  6.9448e-02],
         [ 1.3833e-01, -4.9353e-02],
         [ 1.1793e-01,  9.2991e-02],
         [ 1.3786e-01,  5.8241e-02],
         [ 1.4762e-01,  7.3921e-02],
         [ 1.4024e-01,  8.3618e-02],
         [ 1.2198e-01,  9.4244e-02],
         [ 1.4740e-01,  9.5812e-02],
         [ 1.2848e-01,  8.9399e-02],
         [ 1.5353e-01,  1.4532e-01],
         [ 1.5919e-01,  1.0044e-01],
         [ 1.3963e-01,  8.7704e-02],
         [ 1.4097e-01,  1.4455e-01],
         [ 1.5976e-01,  1.1515e-01],
         [ 1.6824e-01,  9.4665e-02],
         [ 1.6872e-01,  9.4954e-02],
         [-1.5091e-02,  9.7279e-02],
         [ 1.5324e-02,  8.0485e-02],
         [ 3.3489e-02,  7.1996e-02],
         [ 4.2879e-02,  9.6978e-02],
         [ 4.7309e-02,  1.1732e-01],
         [ 4.9243e-02,  6.5660e-02],
         [ 4.9963e-02,  8.7944e-02],
         [ 5.0185e-02,  1.1835e-01],
         [ 5.0204e-02,  1.2511e-01],
         [ 5.0173e-02,  1.1752e-01],
         [ 5.0137e-02,  1.2380e-01],
         [ 5.0087e-02,  8.2290e-02],
         [ 5.0049e-02,  1.0003e-01],
         [ 5.0025e-02,  6.5808e-02],
         [ 5.0021e-02,  9.1969e-02],
         [ 5.0028e-02,  1.0535e-01],
         [ 5.0030e-02,  1.0558e-01],
         [ 5.0016e-02,  1.0190e-01],
         [ 5.0017e-02,  9.7267e-02],
         [ 5.0020e-02,  2.4523e-01],
         [ 5.0016e-02,  4.2793e-02],
         [ 5.0007e-02,  6.8271e-02],
         [ 5.0007e-02,  2.2990e-01],
         [ 5.0008e-02,  1.0281e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0780e-01,  8.9914e-02],
         [ 8.1983e-02,  9.6327e-02],
         [ 8.3033e-02,  1.2828e-01],
         [ 1.0533e-01,  1.0682e-01],
         [ 1.2478e-01,  1.0456e-01],
         [ 1.2572e-01,  9.7676e-02],
         [ 9.9773e-02,  9.3238e-02],
         [ 9.5603e-02,  8.2896e-02],
         [ 1.3167e-01,  7.8768e-02],
         [ 1.1572e-01,  1.0789e-01],
         [ 1.2173e-01,  1.1981e-01],
         [ 1.3246e-01,  1.0872e-01],
         [ 1.3294e-01,  1.2250e-01],
         [ 1.0211e-01,  1.3508e-01],
         [ 1.2021e-01,  1.3824e-01],
         [ 1.6550e-01,  1.0451e-01],
         [ 1.6955e-01,  1.2367e-01],
         [ 1.5445e-01,  8.8586e-02],
         [ 1.5267e-01,  6.7699e-02],
         [ 1.2238e-01,  9.6506e-02],
         [ 1.4503e-01,  1.5559e-01],
         [ 1.7699e-01,  1.8252e-01],
         [ 2.1308e-01,  1.5478e-01],
         [ 2.2450e-01,  1.1553e-01],
         [ 1.7363e-01,  9.4386e-02],
         [ 1.5799e-01,  6.8230e-02],
         [ 1.4927e-01,  9.1177e-02],
         [ 1.5257e-01,  1.2554e-01],
         [ 1.6329e-01,  1.0859e-01],
         [ 1.6940e-01,  1.4631e-01],
         [ 1.8631e-01,  1.4684e-01],
         [ 1.5079e-01,  1.6469e-01],
         [ 1.5646e-01,  1.4066e-01],
         [ 1.5936e-01,  1.0854e-01],
         [ 1.6924e-01,  1.3301e-01],
         [ 1.3913e-01,  1.0097e-01],
         [ 1.6944e-01,  1.0643e-01],
         [ 1.4515e-01,  1.1705e-01],
         [ 1.6190e-01,  1.2454e-01],
         [ 1.7382e-01,  1.3215e-01],
         [ 1.8228e-01,  1.5498e-01],
         [ 1.8840e-01,  1.2613e-01],
         [ 1.8909e-01,  1.5074e-01],
         [ 1.6448e-01,  1.2795e-01],
         [ 1.2279e-01,  9.6963e-02],
         [ 1.3814e-01,  9.5225e-02],
         [ 1.3328e-01,  7.6364e-02],
         [ 1.3287e-01,  8.2771e-02],
         [ 1.0036e-01,  1.1918e-01],
         [ 7.7271e-02,  8.5093e-02],
         [ 6.3611e-02,  4.1538e-02],
         [ 5.6425e-02,  6.9637e-02],
         [ 5.1042e-02,  6.7282e-02],
         [ 8.9698e-02,  7.9863e-02],
         [ 2.8518e-02,  8.8000e-02],
         [ 5.3851e-03,  1.0424e-01],
         [ 3.0878e-02,  9.4957e-02],
         [ 4.3042e-02,  1.0807e-01],
         [ 4.8367e-02,  6.9204e-02],
         [ 5.0411e-02,  9.3065e-02],
         [ 5.0932e-02,  4.8609e-02],
         [ 5.0872e-02,  8.3471e-02],
         [ 5.0672e-02,  8.2326e-02],
         [ 5.0470e-02,  7.9445e-02],
         [ 5.0299e-02,  3.7831e-02],
         [ 5.0180e-02,  5.1165e-02],
         [ 5.0109e-02,  1.3306e-02],
         [ 5.0062e-02,  6.2249e-02],
         [ 5.0040e-02,  7.9832e-02],
         [ 5.0049e-02,  4.4158e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.9342e-05, device='cuda:0') tensor(0.0037, device='cuda:0') tensor(-0.0023, device='cuda:0')
mixer_td_error tensor(0.3908, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4623, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7668, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0458, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1595, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0497, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1642856.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2452, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.4722e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0028, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1752, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.0983, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1752, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12282
target_mac_out tensor([[[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.8781e-02,  8.3533e-02,  ...,  3.1188e-03,
            1.3910e-01, -1.0000e+07],
          [-1.0000e+07, -3.1963e-02,  1.2771e-01,  ...,  3.4754e-02,
            1.4512e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7828e-02,  7.5853e-02,  ..., -1.6792e-02,
            1.4504e-01, -1.0000e+07],
          [-1.0000e+07, -6.8399e-02,  1.6150e-01,  ...,  6.0003e-02,
            1.5126e-01, -1.0000e+07]],

         ...,

         [[-1.0551e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5223e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9920e-02,  8.5710e-02,  ...,  5.5272e-03,
            1.3493e-01, -1.0000e+07],
          [-1.0000e+07, -6.5448e-02,  1.6176e-01,  ...,  5.0065e-02,
            1.5125e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2028e-01,  1.1613e-01,  ...,  4.0933e-02,
            1.5554e-01, -1.0000e+07],
          [-1.0000e+07, -9.1064e-02,  1.6748e-01,  ...,  4.2100e-02,
            1.5015e-01, -1.0000e+07]],

         ...,

         [[ 1.9568e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3438e-01,  7.1115e-02,  ...,  3.1848e-02,
            1.8339e-01, -3.1522e-01]],

         [[ 3.5800e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4049e-01,  5.9334e-02,  ...,  2.7220e-02,
            1.8798e-01, -3.0990e-01]],

         [[ 4.3969e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-7.6278e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.0205e-02,  9.0702e-02],
         [ 8.3533e-02,  1.2771e-01],
         [ 7.5853e-02,  1.6150e-01],
         [ 9.9898e-02,  1.7249e-01],
         [ 9.9566e-02,  1.5812e-01],
         [ 1.0577e-01,  1.1443e-01],
         [ 1.2470e-01,  1.5128e-01],
         [ 1.0907e-01,  1.6640e-01],
         [ 1.0872e-01,  1.4475e-01],
         [ 8.1496e-02,  1.3323e-01],
         [ 1.1118e-01,  8.4983e-02],
         [ 1.2528e-01,  6.7025e-02],
         [ 1.3493e-01,  9.3745e-02],
         [ 1.1732e-01,  1.1188e-01],
         [ 7.7186e-02,  1.1593e-01],
         [ 1.1287e-01,  2.2391e-01],
         [ 1.2121e-01,  2.3183e-01],
         [ 1.4660e-01,  1.1377e-01],
         [ 1.5152e-01,  1.5138e-01],
         [ 1.1426e-01,  2.0287e-01],
         [ 1.2219e-01,  4.2607e-02],
         [ 8.8925e-02,  2.4010e-01],
         [ 1.2533e-01,  5.4787e-02],
         [ 1.2896e-01,  7.5845e-02],
         [ 1.2515e-01,  2.1413e-01],
         [ 1.3481e-01,  1.0115e-01],
         [ 1.0283e-01, -1.8173e-01],
         [ 1.1932e-01,  2.0011e-01],
         [ 1.0016e-01,  9.4596e-03],
         [ 1.3372e-01,  3.2531e-02],
         [ 1.2238e-01,  4.5626e-02],
         [ 1.1556e-01,  5.1966e-02],
         [ 1.2357e-01,  5.4641e-02],
         [ 9.3593e-02,  5.5520e-02],
         [ 1.2782e-01,  5.5748e-02],
         [ 1.4098e-01,  5.5646e-02],
         [ 1.1103e-01,  5.5521e-02],
         [ 9.4097e-02,  5.5413e-02],
         [ 1.3229e-01,  5.5328e-02],
         [ 1.0022e-01,  5.5265e-02],
         [ 1.2672e-01,  5.5243e-02],
         [ 1.2943e-01,  5.5216e-02],
         [ 2.2807e-01,  5.5253e-02],
         [ 2.1708e-01,  5.5229e-02],
         [ 2.1215e-01,  5.5209e-02],
         [ 6.3675e-02,  5.5216e-02],
         [ 6.6784e-02,  5.5219e-02],
         [-1.0551e-03,  5.5223e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 7.2334e-02,  1.2843e-01],
         [ 8.5710e-02,  1.6176e-01],
         [ 1.1613e-01,  1.6748e-01],
         [ 1.1261e-01,  1.6754e-01],
         [ 1.2113e-01,  1.3596e-01],
         [ 1.0646e-01,  1.3916e-01],
         [ 1.1642e-01,  1.3257e-01],
         [ 9.0191e-02,  1.2075e-01],
         [ 9.8556e-02,  1.4124e-01],
         [ 7.3060e-02,  1.2028e-01],
         [ 7.0426e-02,  9.5578e-02],
         [ 9.4306e-02,  8.9750e-02],
         [ 1.0922e-01,  1.3123e-01],
         [ 1.2756e-01,  1.6361e-01],
         [ 1.3498e-01,  1.6083e-01],
         [ 1.4851e-01,  1.3542e-01],
         [ 1.5238e-01,  1.6099e-01],
         [ 1.2299e-01,  1.3060e-01],
         [ 1.4575e-01,  1.7087e-01],
         [ 1.2492e-01,  1.8210e-01],
         [ 1.5335e-01,  1.7426e-01],
         [ 1.1240e-01,  1.4211e-01],
         [ 1.3548e-01,  1.5413e-01],
         [ 1.1524e-01,  1.5787e-01],
         [ 1.4003e-01,  1.2534e-01],
         [ 1.4645e-01,  1.5322e-01],
         [ 1.5523e-01,  1.7413e-01],
         [ 1.3624e-01,  1.1893e-01],
         [ 1.0871e-01,  1.2114e-01],
         [ 1.1262e-01,  1.1956e-01],
         [ 2.3627e-02,  7.7516e-02],
         [ 8.1891e-02,  1.4476e-01],
         [ 6.6736e-02,  8.2861e-02],
         [ 6.0175e-02,  1.4753e-01],
         [ 5.0911e-02,  1.1083e-01],
         [ 7.1288e-02,  5.8887e-02],
         [ 7.1060e-02,  9.1759e-02],
         [ 5.8469e-02,  1.1455e-01],
         [ 1.2463e-01,  1.1473e-01],
         [ 1.2923e-01,  1.1347e-01],
         [ 9.2150e-03,  1.0999e-01],
         [ 1.2795e-01,  1.0533e-01],
         [ 8.9357e-02,  9.3429e-02],
         [ 1.1491e-01,  1.2707e-01],
         [ 1.1660e-01,  9.2066e-02],
         [ 1.3067e-01,  1.1900e-01],
         [-1.0161e-02,  9.7212e-02],
         [ 1.9568e-02,  7.1115e-02],
         [ 3.5800e-02,  5.9334e-02],
         [ 4.3969e-02, -7.6278e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.4600e-05, device='cuda:0') tensor(0.0023, device='cuda:0') tensor(-0.0059, device='cuda:0')
mixer_td_error tensor(0.0704, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4913, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.1174, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0489, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1830, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0401, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-199999.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2401, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0002, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0066, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2470, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1976, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2470, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12328
target_mac_out tensor([[[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7229e-02,  1.0718e-01,  ...,  1.5798e-02,
            1.3791e-01, -1.0000e+07],
          [-1.0000e+07, -6.3204e-02,  1.3937e-01,  ...,  4.1475e-02,
            1.4929e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9425e-02,  1.1495e-01,  ...,  1.2519e-02,
            1.5796e-01, -1.0000e+07],
          [-1.0000e+07, -7.3710e-02,  1.2961e-01,  ...,  3.4332e-02,
            1.4764e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.1049e-01,  9.5954e-02,  ...,  4.3549e-02,
            1.9052e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.2270e-01,  1.0282e-01,  ...,  7.2312e-02,
            2.0724e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6719e-01,  1.2207e-01,  ...,  9.9992e-02,
            2.0307e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1402e-02,  8.1983e-02,  ...,  3.9429e-02,
            1.3744e-01, -1.0000e+07],
          [-1.0000e+07, -3.2219e-02,  9.6327e-02,  ..., -1.4636e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2918e-02,  8.3033e-02,  ...,  1.5905e-03,
            1.3806e-01, -1.0000e+07],
          [-1.0000e+07, -4.3941e-02,  1.2828e-01,  ...,  1.4506e-02,
            1.4886e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.9115e-02,  9.3163e-02],
         [ 1.0718e-01,  1.3937e-01],
         [ 1.1495e-01,  1.2961e-01],
         ...,
         [ 9.5954e-02,  5.5231e-02],
         [ 1.0282e-01,  5.5231e-02],
         [ 1.2207e-01,  5.5231e-02]],

        [[ 1.0780e-01,  8.9914e-02],
         [ 8.1983e-02,  9.6327e-02],
         [ 8.3033e-02,  1.2828e-01],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(8.5002e-06, device='cuda:0') tensor(0.0003, device='cuda:0') tensor(-0.0003, device='cuda:0')
mixer_td_error tensor(0.9514, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4592, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4078, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0604, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1919, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0216, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3833333., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2561, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.0133e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0001, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1482, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0832, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1482, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12381
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0948e-02,  7.3316e-02,  ...,  4.2360e-02,
            1.4141e-01, -1.0000e+07],
          [-1.0000e+07, -1.8789e-02,  1.1070e-01,  ...,  4.1064e-03,
            1.2950e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0493e-01,  9.5342e-02,  ...,  2.8501e-02,
            1.6248e-01, -1.0000e+07],
          [-1.0000e+07, -2.5057e-02,  1.2023e-01,  ..., -1.0731e-02,
            1.3315e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3070e-01,  1.2391e-01,  ...,  7.1034e-02,
            1.5852e-01, -1.0000e+07],
          [-1.0000e+07, -3.6329e-02,  1.0540e-01,  ..., -2.3505e-02,
            1.3276e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4548e-01,  1.2388e-01,  ...,  5.2184e-02,
            1.5225e-01, -1.0000e+07],
          [-1.0000e+07, -7.9506e-02,  1.4849e-01,  ...,  2.9133e-02,
            1.4592e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5505e-01,  5.1068e-02,  ...,  3.8250e-02,
            2.0122e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5922e-01,  4.2900e-02,  ...,  2.9935e-02,
            1.9831e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.9150e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 7.3316e-02,  1.1070e-01],
         [ 9.5342e-02,  1.2023e-01],
         [ 6.4205e-02,  1.4156e-01],
         [ 8.1485e-02,  6.9997e-02],
         [ 5.5957e-02,  7.0123e-02],
         [ 9.7613e-02,  1.0066e-01],
         [ 7.2808e-02,  9.9181e-02],
         [ 9.0928e-02,  5.7842e-02],
         [ 9.8131e-02,  4.0632e-02],
         [ 7.5187e-02,  7.2927e-02],
         [ 7.8356e-02,  8.7967e-02],
         [ 5.0548e-02,  1.1220e-01],
         [-5.2229e-02,  6.0077e-02],
         [ 8.6117e-02,  1.0364e-01],
         [ 8.6468e-02,  1.1695e-01],
         [-5.6511e-02,  7.7338e-02],
         [ 7.6301e-02,  1.1185e-01],
         [ 9.5287e-02,  1.2157e-01],
         [ 1.0297e-01,  7.8122e-02],
         [ 8.9085e-02,  9.8220e-02],
         [ 9.8854e-02,  1.1613e-01],
         [ 1.0156e-01,  8.1639e-02],
         [-4.9075e-02,  9.6023e-02],
         [ 9.7458e-02,  1.0995e-01],
         [ 1.0464e-01,  9.8083e-02],
         [ 1.3189e-01,  9.2941e-02],
         [ 1.5355e-01,  9.8135e-02],
         [ 1.3319e-01,  1.2472e-01],
         [ 1.4755e-01,  1.3836e-01],
         [ 1.4394e-01,  1.0724e-01],
         [ 1.1068e-01,  1.3147e-01],
         [ 1.3933e-01,  1.3981e-01],
         [ 1.0936e-01,  1.2722e-01],
         [ 1.4213e-01,  1.3700e-01],
         [ 1.1816e-01, -6.4278e-03],
         [ 1.0565e-01,  2.5142e-02],
         [ 8.6109e-02,  4.2084e-02],
         [ 5.9356e-02,  5.0180e-02],
         [ 8.0208e-02,  5.3727e-02],
         [ 1.0120e-01,  5.5128e-02],
         [ 8.3156e-02,  5.5544e-02],
         [ 1.2780e-01,  5.5612e-02],
         [ 9.8728e-02,  5.5523e-02],
         [ 1.1408e-01,  5.5444e-02],
         [ 8.9938e-02,  5.5359e-02],
         [ 9.4646e-02,  5.5309e-02],
         [ 9.5243e-02,  5.5259e-02],
         [ 9.3598e-02,  5.5215e-02],
         [ 8.0578e-02,  5.5232e-02],
         [ 7.5030e-02,  5.5209e-02],
         [ 1.0299e-01,  5.5215e-02],
         [ 8.2706e-02,  5.5215e-02],
         [ 1.1988e-01,  5.5220e-02],
         [ 8.9034e-02,  5.5223e-02],
         [ 7.0128e-02,  5.5231e-02],
         [ 4.9474e-02,  5.5232e-02],
         [ 1.5547e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0827e-01,  1.0736e-01],
         [ 1.2391e-01,  1.0540e-01],
         [ 1.2388e-01,  1.4849e-01],
         [ 1.1120e-01,  1.1545e-01],
         [ 8.1763e-02,  1.0360e-01],
         [ 1.0384e-01,  1.6212e-01],
         [ 1.0730e-01,  1.3985e-01],
         [ 1.2105e-01,  1.2283e-01],
         [ 1.3210e-01,  1.4214e-01],
         [ 1.5162e-01,  1.6795e-01],
         [ 1.6399e-01,  1.8431e-01],
         [ 1.3424e-01,  1.5073e-01],
         [ 1.3556e-01,  1.3457e-01],
         [ 1.2130e-01,  1.1134e-01],
         [ 1.4275e-01,  1.3791e-01],
         [ 1.2264e-01,  1.6636e-01],
         [ 1.4533e-01,  1.3594e-01],
         [ 1.5384e-01,  1.1079e-01],
         [ 1.4967e-01,  1.2379e-01],
         [ 1.3395e-01,  8.9738e-02],
         [ 9.3326e-02,  4.7128e-02],
         [ 1.5065e-02,  3.7195e-02],
         [ 3.1087e-02,  3.1123e-02],
         [ 4.1229e-02,  4.1234e-02],
         [ 4.6494e-02,  2.3417e-02],
         [ 4.8929e-02,  3.2086e-02],
         [ 4.9845e-02,  7.2299e-02],
         [ 5.0161e-02,  4.9700e-02],
         [ 5.0198e-02,  7.7594e-02],
         [ 5.0164e-02,  6.4016e-02],
         [ 5.0127e-02,  8.3781e-02],
         [ 5.0076e-02,  1.1153e-01],
         [ 5.0043e-02,  7.9167e-02],
         [ 5.0052e-02,  7.6035e-02],
         [ 5.0029e-02,  8.8515e-02],
         [ 5.0036e-02,  6.7258e-02],
         [ 5.0027e-02,  8.0908e-02],
         [ 5.0019e-02,  4.5657e-02],
         [ 5.0025e-02,  7.9332e-02],
         [ 5.0026e-02,  9.3016e-02],
         [ 5.0010e-02,  9.7706e-02],
         [ 5.0020e-02,  5.7490e-02],
         [ 5.0005e-02,  8.6472e-02],
         [ 5.0007e-02,  9.7147e-02],
         [ 5.0008e-02,  6.3430e-02],
         [ 5.0008e-02,  8.5475e-02],
         [ 5.0008e-02,  5.6860e-02],
         [ 5.0009e-02,  4.3634e-02],
         [ 5.0008e-02,  3.0384e-02],
         [ 5.0008e-02,  3.7612e-02],
         [ 5.0008e-02,  7.4572e-02],
         [ 5.0008e-02,  6.8489e-02],
         [ 5.0008e-02,  6.1119e-02],
         [ 5.0009e-02,  5.5672e-02],
         [ 5.0009e-02,  3.7676e-02],
         [ 5.0009e-02,  4.6479e-02],
         [ 5.0009e-02,  6.9029e-02],
         [ 5.0009e-02,  8.4975e-02],
         [ 5.0009e-02,  9.1598e-02],
         [ 5.0009e-02,  7.4213e-02],
         [ 5.0009e-02,  4.1839e-02],
         [ 5.0009e-02,  3.8502e-02],
         [ 5.0009e-02,  7.1914e-02],
         [ 5.0009e-02,  1.0388e-01],
         [ 5.0009e-02,  8.5299e-02],
         [ 5.0009e-02,  9.0344e-02],
         [ 5.0009e-02,  4.6900e-02],
         [ 5.0009e-02,  4.2289e-02],
         [ 5.0009e-02,  6.6682e-02],
         [ 5.0009e-02,  7.9862e-02],
         [ 5.0009e-02,  3.3461e-02],
         [ 5.0009e-02,  3.2876e-02],
         [ 5.0009e-02,  4.5653e-02],
         [ 5.0009e-02,  8.0870e-02],
         [ 5.0009e-02,  6.0900e-02],
         [ 5.0009e-02,  7.1534e-02],
         [ 5.0009e-02,  7.7649e-02],
         [ 5.0009e-02,  8.1230e-02],
         [ 5.0009e-02,  6.0169e-02],
         [ 5.0009e-02,  5.0937e-02],
         [ 5.0009e-02,  5.6693e-02],
         [ 5.0009e-02,  7.6477e-02],
         [ 5.0009e-02,  6.0402e-02],
         [ 5.0009e-02,  5.0377e-02],
         [ 5.0009e-02,  4.3616e-02],
         [ 5.0009e-02,  3.8999e-02],
         [ 5.0009e-02,  2.8196e-02],
         [ 5.0009e-02,  6.9579e-02],
         [ 5.0009e-02,  8.6352e-02],
         [ 5.0009e-02,  5.8278e-02],
         [ 5.0009e-02,  4.5538e-02],
         [ 5.0009e-02,  7.5007e-02],
         [ 5.0009e-02,  8.7675e-02],
         [ 5.0009e-02,  9.3339e-02],
         [ 5.0009e-02,  1.1464e-01],
         [ 5.0009e-02,  6.3624e-02],
         [ 5.0009e-02,  6.6775e-02],
         [ 5.0009e-02,  4.7620e-02],
         [ 5.0009e-02,  3.9063e-02],
         [ 5.0009e-02,  7.1689e-02],
         [ 5.0009e-02,  1.0404e-01],
         [ 5.0009e-02,  1.0427e-01],
         [ 5.0009e-02,  5.8940e-02],
         [ 5.0009e-02,  4.2998e-02],
         [ 5.0009e-02,  4.3363e-02],
         [ 5.0009e-02,  7.5933e-02],
         [ 5.0009e-02,  8.5900e-02],
         [ 5.0009e-02,  1.3334e-01],
         [ 5.0009e-02,  8.9865e-02],
         [ 5.0009e-02,  7.3448e-02],
         [ 5.0009e-02,  9.6982e-02],
         [ 5.0009e-02,  5.9533e-02],
         [ 5.0009e-02,  8.2586e-02],
         [ 5.0009e-02,  7.9531e-02],
         [ 5.0009e-02,  8.8877e-02],
         [ 5.0009e-02,  6.3198e-02],
         [ 5.0009e-02,  5.1944e-02],
         [ 5.0009e-02,  6.4473e-02],
         [ 5.0009e-02,  9.1396e-02],
         [ 5.0009e-02,  8.8900e-02],
         [ 5.0009e-02,  8.9520e-02],
         [ 5.0009e-02,  8.9573e-02],
         [ 5.0009e-02,  5.0133e-02],
         [ 5.0009e-02,  7.2536e-02],
         [ 5.0009e-02,  8.1444e-02],
         [ 5.0009e-02,  7.2294e-02],
         [ 5.0009e-02,  9.0362e-02],
         [ 5.0009e-02,  6.5614e-02],
         [ 5.0009e-02,  5.1068e-02],
         [ 5.0009e-02,  4.2900e-02],
         [ 5.0009e-02,  1.9150e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.2967e-06, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0015, device='cuda:0')
mixer_td_error tensor(0.6813, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4679, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4844, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0567, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1955, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0175, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2786259., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1843, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.7906e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0007, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1248, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.0751, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1248, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12428
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6527e-02,  7.9265e-02,  ...,  4.2534e-02,
            1.3764e-01, -1.0000e+07],
          [-1.0000e+07, -3.4160e-02,  1.2734e-01,  ...,  3.6650e-02,
            1.4514e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7552e-02,  6.9527e-02,  ...,  3.6922e-02,
            1.3246e-01, -1.0000e+07],
          [-1.0000e+07, -6.9459e-02,  1.5722e-01,  ...,  6.3242e-02,
            1.5510e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4887e-01,  4.9958e-02,  ...,  3.2413e-02,
            1.7518e-01, -3.0026e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6329e-01,  7.7314e-02,  ...,  6.4431e-02,
            1.9656e-01, -3.1323e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-8.6026e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5820e-02,  1.1367e-01,  ...,  2.0960e-02,
            1.5981e-01, -1.0000e+07],
          [-1.0000e+07, -3.3890e-02,  1.2184e-01,  ..., -9.4792e-03,
            1.4216e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2951e-02,  1.0986e-01,  ...,  1.2096e-02,
            1.5207e-01, -1.0000e+07],
          [-1.0000e+07, -3.4173e-02,  1.1635e-01,  ..., -1.5886e-02,
            1.4133e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 7.9265e-02,  1.2734e-01],
         [ 6.9527e-02,  1.5722e-01],
         [ 8.8115e-02,  1.3407e-01],
         [ 9.2021e-02,  1.1965e-01],
         [ 1.1077e-01,  9.8505e-02],
         [ 1.0885e-01,  7.5371e-02],
         [ 1.1219e-01,  1.0466e-01],
         [ 1.2187e-01,  9.2092e-02],
         [ 1.2941e-01,  8.4600e-02],
         [ 1.2847e-01,  1.2769e-01],
         [ 1.3701e-01,  9.7878e-02],
         [ 1.1949e-01,  8.5881e-02],
         [ 9.6336e-02,  7.4866e-02],
         [ 1.0414e-01,  5.5366e-02],
         [ 8.9616e-02,  8.5009e-02],
         [ 9.5280e-02,  7.3843e-02],
         [ 1.2142e-01,  9.3602e-02],
         [ 1.0903e-01,  1.0871e-01],
         [ 1.2760e-01,  8.5809e-02],
         [ 1.3876e-01,  1.0593e-01],
         [ 1.3461e-01,  1.0264e-01],
         [ 1.3718e-01,  1.0112e-01],
         [ 1.4534e-01,  7.9505e-02],
         [ 1.3053e-01,  5.1870e-02],
         [ 1.5854e-01,  8.0270e-02],
         [ 1.6483e-01,  1.0052e-01],
         [ 1.8051e-01,  1.4853e-01],
         [ 1.4739e-01,  1.6411e-01],
         [ 1.6740e-01,  1.5900e-01],
         [ 1.7496e-01,  1.8515e-01],
         [ 1.8802e-01,  1.9385e-01],
         [ 1.8790e-01,  1.4945e-01],
         [ 1.8971e-01,  1.1596e-01],
         [ 1.5564e-01,  1.3987e-01],
         [ 1.7631e-01,  9.6963e-02],
         [ 1.6737e-01,  1.0210e-01],
         [ 1.7581e-01,  1.1055e-01],
         [ 1.9133e-01,  9.9574e-02],
         [ 2.0358e-01,  8.6684e-02],
         [ 1.6890e-01,  1.0010e-01],
         [ 1.9061e-01,  6.3768e-02],
         [ 1.9686e-01,  4.8977e-02],
         [ 1.5919e-01,  9.0457e-02],
         [ 1.3247e-01,  1.0169e-01],
         [ 1.3794e-01,  1.3351e-01],
         [-6.2971e-03,  6.7550e-02],
         [ 2.3971e-02,  8.9282e-02],
         [ 3.8744e-02,  9.3159e-02],
         [ 4.5555e-02,  1.3037e-01],
         [ 4.8516e-02,  1.4562e-01],
         [ 4.9665e-02,  9.2352e-02],
         [ 5.0048e-02,  8.9715e-02],
         [ 5.0141e-02,  1.3513e-01],
         [ 5.0132e-02,  1.6858e-01],
         [ 5.0067e-02,  1.0761e-01],
         [ 5.0055e-02,  8.1093e-02],
         [ 5.0023e-02,  5.2475e-02],
         [ 5.0024e-02,  3.9674e-02],
         [ 5.0018e-02,  5.9789e-02],
         [ 5.0000e-02,  4.5508e-02],
         [ 5.0017e-02,  3.2298e-02],
         [ 5.0013e-02,  3.0250e-02],
         [ 5.0027e-02,  5.5933e-02],
         [ 5.0017e-02,  7.7275e-02],
         [ 5.0017e-02,  8.6950e-02],
         [ 5.0012e-02,  5.0850e-02],
         [ 5.0009e-02,  4.8595e-02],
         [ 5.0006e-02,  7.8928e-02],
         [ 5.0008e-02,  4.8462e-02],
         [ 5.0007e-02,  8.0987e-02],
         [ 5.0008e-02,  7.5495e-02],
         [ 5.0008e-02,  1.0192e-01],
         [ 5.0008e-02,  1.1354e-01],
         [ 5.0008e-02,  6.5832e-02],
         [ 5.0008e-02,  7.5489e-02],
         [ 5.0008e-02,  4.3725e-02],
         [ 5.0008e-02,  3.4881e-02],
         [ 5.0008e-02,  7.4136e-02],
         [ 5.0009e-02,  5.7429e-02],
         [ 5.0009e-02,  4.9060e-02],
         [ 5.0009e-02,  7.7326e-02],
         [ 5.0009e-02,  8.7918e-02],
         [ 5.0009e-02,  9.2311e-02],
         [ 5.0009e-02,  7.7767e-02],
         [ 5.0009e-02,  1.0283e-01],
         [ 5.0009e-02,  9.8664e-02],
         [ 5.0009e-02,  8.7238e-02],
         [ 5.0009e-02,  5.9636e-02],
         [ 5.0009e-02,  9.6231e-02],
         [ 5.0009e-02,  9.6428e-02],
         [ 5.0009e-02,  1.0940e-01],
         [ 5.0009e-02,  9.9618e-02],
         [ 5.0009e-02,  6.0348e-02],
         [ 5.0009e-02,  4.4882e-02],
         [ 5.0009e-02,  7.3009e-02],
         [ 5.0009e-02,  4.2855e-02],
         [ 5.0009e-02,  4.3671e-02],
         [ 5.0009e-02,  6.8596e-02],
         [ 5.0009e-02,  6.1681e-02],
         [ 5.0009e-02,  4.2074e-02],
         [ 5.0009e-02,  4.6716e-02],
         [ 5.0009e-02,  3.3170e-02],
         [ 5.0009e-02,  4.1199e-02],
         [ 5.0009e-02,  1.5826e-02],
         [ 5.0009e-02,  1.7484e-02],
         [ 5.0009e-02,  3.8505e-02],
         [ 5.0009e-02,  5.4523e-02],
         [ 5.0009e-02,  3.1296e-02],
         [ 5.0009e-02,  5.1129e-02],
         [ 5.0009e-02,  6.4113e-02],
         [ 5.0009e-02,  5.2326e-02],
         [ 5.0009e-02,  5.7305e-02],
         [ 5.0009e-02,  6.7291e-02],
         [ 5.0009e-02,  7.5200e-02],
         [ 5.0009e-02,  3.7095e-02],
         [ 5.0009e-02,  5.8367e-02],
         [ 5.0009e-02,  6.2846e-02],
         [ 5.0009e-02,  5.5008e-02],
         [ 5.0009e-02,  6.5077e-02],
         [ 5.0009e-02,  1.0332e-01],
         [ 5.0009e-02,  6.6946e-02],
         [ 5.0009e-02,  6.8542e-02],
         [ 5.0009e-02,  5.6066e-02],
         [ 5.0009e-02,  3.2212e-02],
         [ 5.0009e-02,  5.5714e-02],
         [ 5.0009e-02,  6.9831e-02],
         [ 5.0009e-02,  5.9174e-02],
         [ 5.0009e-02,  3.9532e-02],
         [ 5.0009e-02,  6.1663e-02],
         [ 5.0009e-02,  8.6841e-02],
         [ 5.0009e-02,  9.6118e-02],
         [ 5.0009e-02,  1.0580e-01],
         [ 5.0009e-02,  9.8987e-02],
         [ 5.0009e-02,  8.3273e-02],
         [ 5.0009e-02,  7.3983e-02],
         [ 5.0009e-02,  8.0187e-02],
         [ 5.0009e-02,  8.2958e-02],
         [ 5.0009e-02,  4.9958e-02],
         [ 5.0009e-02,  7.7314e-02],
         [ 5.0009e-02, -8.6026e-03]],

        [[ 9.9115e-02,  9.3163e-02],
         [ 1.1367e-01,  1.2184e-01],
         [ 1.0986e-01,  1.1635e-01],
         [ 1.2572e-01,  1.2994e-01],
         [ 1.1040e-01,  1.1237e-01],
         [ 9.8393e-02,  1.3323e-01],
         [ 1.1013e-01,  1.6854e-01],
         [ 8.2260e-02,  1.7713e-01],
         [ 8.6709e-02,  1.7662e-01],
         [ 1.2132e-01,  1.8035e-01],
         [ 1.5972e-01,  1.4619e-01],
         [ 1.1861e-01,  1.1532e-01],
         [ 7.1357e-02,  1.6390e-01],
         [ 1.1657e-01,  1.4067e-01],
         [ 1.5095e-01,  1.5869e-01],
         [ 1.1786e-01,  1.6283e-01],
         [ 7.2939e-02,  1.6650e-01],
         [ 1.2161e-01,  1.7451e-01],
         [ 1.0635e-01,  1.8349e-01],
         [ 1.1253e-01,  1.4489e-01],
         [ 1.1633e-01,  1.7309e-01],
         [ 1.1908e-01,  1.7156e-01],
         [ 1.2060e-01,  1.3946e-01],
         [ 1.3075e-01,  1.5000e-01],
         [ 1.7965e-01,  1.2433e-01],
         [ 1.2112e-01,  1.0793e-01],
         [ 1.2127e-01,  9.2898e-02],
         [ 1.0644e-01,  7.1424e-02],
         [-3.4773e-02,  7.6801e-02],
         [ 1.1065e-01, -8.1307e-03],
         [ 1.1066e-01,  3.0301e-02],
         [ 1.2788e-01,  4.6659e-02],
         [ 1.5615e-01,  5.3149e-02],
         [ 1.6509e-01,  5.5403e-02],
         [ 1.8113e-01,  5.5950e-02],
         [-3.6660e-02,  5.5879e-02],
         [ 1.0926e-01,  5.5700e-02],
         [ 1.0510e-01,  5.5496e-02],
         [ 1.0378e-01,  5.5378e-02],
         [ 1.2044e-01,  5.5266e-02],
         [ 1.6404e-01,  5.5230e-02],
         [ 1.7177e-01,  5.5205e-02],
         [ 1.7303e-01,  5.5193e-02],
         [ 1.7294e-01,  5.5214e-02],
         [ 1.1729e-01,  5.5205e-02],
         [ 1.2595e-01,  5.5209e-02],
         [ 1.2344e-01,  5.5205e-02],
         [ 1.3285e-01,  5.5204e-02],
         [ 1.7870e-01,  5.5222e-02],
         [ 1.4163e-01,  5.5230e-02],
         [ 1.6352e-01,  5.5230e-02],
         [ 1.3141e-01,  5.5230e-02],
         [ 1.0986e-01,  5.5230e-02],
         [ 1.2335e-01,  5.5236e-02],
         [ 1.1266e-01,  5.5235e-02],
         [ 9.9817e-02,  5.5232e-02],
         [ 1.0257e-01,  5.5232e-02],
         [ 1.0530e-01,  5.5231e-02],
         [ 1.0134e-01,  5.5231e-02],
         [ 1.1083e-01,  5.5231e-02],
         [ 1.1685e-01,  5.5231e-02],
         [ 1.3112e-01,  5.5231e-02],
         [ 8.9315e-02,  5.5231e-02],
         [ 1.1086e-01,  5.5231e-02],
         [ 9.3633e-02,  5.5231e-02],
         [ 1.2335e-01,  5.5231e-02],
         [ 1.2024e-01,  5.5231e-02],
         [ 1.1680e-01,  5.5231e-02],
         [ 1.1516e-01,  5.5231e-02],
         [ 1.1632e-01,  5.5231e-02],
         [ 1.4057e-01,  5.5231e-02],
         [ 1.0411e-01,  5.5231e-02],
         [ 1.0704e-01,  5.5231e-02],
         [ 1.0730e-01,  5.5231e-02],
         [ 1.0718e-01,  5.5231e-02],
         [ 6.4000e-02,  5.5231e-02],
         [ 8.8669e-02,  5.5231e-02],
         [ 9.8137e-02,  5.5231e-02],
         [ 3.9293e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-8.4155e-06, device='cuda:0') tensor(0.0004, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.5314, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4579, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4061, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0645, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2025, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0145, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2198581.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2036, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.5281e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1159, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1059, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1159, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12473
target_mac_out tensor([[[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.9336e-02,  8.9318e-02,  ...,  1.5729e-02,
            1.2882e-01, -1.0000e+07],
          [-1.0000e+07, -2.5640e-02,  8.8110e-02,  ..., -1.8735e-02,
            1.3277e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1056e-02,  1.1443e-01,  ...,  3.4915e-02,
            1.5353e-01, -1.0000e+07],
          [-1.0000e+07, -4.0997e-02,  1.1804e-01,  ...,  1.4397e-02,
            1.5161e-01, -1.0000e+07]],

         ...,

         [[ 5.0018e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3078e-01,  6.4518e-02,  ...,  5.7182e-02,
            1.8752e-01, -3.1153e-01]],

         [[ 5.0012e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5229e-01,  8.0086e-02,  ...,  7.9997e-02,
            2.0084e-01, -3.1993e-01]],

         [[ 5.0006e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.6862e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.8799e-02,  1.1017e-01,  ...,  6.1516e-02,
            1.3971e-01, -1.0000e+07],
          [-1.0000e+07, -2.8322e-02,  1.2490e-01,  ...,  1.4773e-02,
            1.3610e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3357e-02,  7.6576e-02,  ...,  4.4627e-02,
            1.3934e-01, -1.0000e+07],
          [-1.0000e+07, -2.5884e-02,  1.2689e-01,  ..., -4.2544e-03,
            1.3727e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.9090e-02,  5.8755e-02,  ...,  3.9416e-02,
            1.3901e-01, -1.0000e+07],
          [-1.0000e+07, -2.5911e-02,  1.2652e-01,  ..., -1.9137e-02,
            1.3974e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.8508e-01,  1.0102e-01,  ...,  6.5255e-02,
            1.6698e-01, -1.0000e+07],
          [ 5.5543e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-3.4857e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5415e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.0670e-02,  8.4050e-02],
         [ 8.9318e-02,  8.8110e-02],
         [ 1.1443e-01,  1.1804e-01],
         [ 9.9871e-02,  1.5258e-01],
         [ 9.3312e-02,  1.2726e-01],
         [ 1.0249e-01,  1.5020e-01],
         [ 8.5627e-02,  1.2289e-01],
         [ 7.7340e-02,  1.1034e-01],
         [ 9.1141e-02,  8.6120e-02],
         [ 9.5139e-02,  1.0410e-01],
         [ 9.6406e-02,  1.0702e-01],
         [ 1.0284e-01,  1.1568e-01],
         [ 1.2928e-01,  1.4971e-01],
         [ 1.1487e-01,  1.0543e-01],
         [ 1.2525e-01,  9.0735e-02],
         [ 9.8526e-02,  1.2577e-01],
         [ 1.3629e-01,  1.3224e-01],
         [ 1.3674e-01,  1.2695e-01],
         [ 1.4387e-01,  9.7083e-02],
         [ 1.5810e-01,  1.1503e-01],
         [ 1.3498e-01,  8.7541e-02],
         [ 1.4848e-01,  1.4187e-01],
         [ 1.8579e-01,  1.0893e-01],
         [ 1.8370e-01,  1.1060e-01],
         [ 1.8259e-01,  1.2024e-01],
         [ 1.4778e-01,  1.4804e-01],
         [ 1.4604e-01,  1.3924e-01],
         [ 1.5511e-01,  1.0351e-01],
         [ 1.4339e-01,  1.5043e-01],
         [ 1.2689e-01,  1.4078e-01],
         [ 1.4425e-01,  9.3116e-02],
         [ 1.6291e-01,  7.0636e-02],
         [ 1.7610e-01,  7.7270e-02],
         [ 1.7684e-01,  9.7497e-02],
         [-2.3915e-02,  6.9492e-02],
         [ 1.3968e-02, -8.9654e-02],
         [ 3.3473e-02,  6.9898e-02],
         [ 4.3011e-02,  4.8498e-02],
         [ 4.7409e-02,  9.4322e-02],
         [ 4.9303e-02,  1.0161e-01],
         [ 5.0036e-02,  1.1318e-01],
         [ 5.0220e-02,  1.2739e-01],
         [ 5.0249e-02,  8.5531e-02],
         [ 5.0166e-02,  7.0895e-02],
         [ 5.0125e-02,  1.0482e-01],
         [ 5.0075e-02,  7.3267e-02],
         [ 5.0058e-02,  4.9759e-02],
         [ 5.0032e-02,  8.0909e-02],
         [ 5.0030e-02,  1.0022e-01],
         [ 5.0018e-02,  5.1128e-02],
         [ 5.0011e-02,  7.6678e-02],
         [ 5.0027e-02,  7.3465e-02],
         [ 5.0014e-02,  6.7983e-02],
         [ 5.0018e-02,  6.4518e-02],
         [ 5.0012e-02,  8.0086e-02],
         [ 5.0006e-02,  2.6862e-02]],

        [[ 1.1017e-01,  1.2490e-01],
         [ 7.6576e-02,  1.2689e-01],
         [ 5.8755e-02,  1.2652e-01],
         [ 7.7228e-02,  1.4016e-01],
         [ 9.7377e-02,  1.2443e-01],
         [ 9.1265e-02,  1.0546e-01],
         [ 9.0258e-02,  1.2260e-01],
         [ 6.7360e-02,  1.2862e-01],
         [ 1.0173e-01,  1.3239e-01],
         [ 1.1362e-01,  1.1837e-01],
         [ 1.1453e-01,  1.3216e-01],
         [ 9.0659e-02,  1.4369e-01],
         [ 1.1898e-01,  1.2355e-01],
         [ 1.0675e-01,  1.1615e-01],
         [ 1.0052e-01,  1.1174e-01],
         [ 9.6374e-02,  1.3320e-01],
         [ 1.2098e-01,  1.5047e-01],
         [ 1.1359e-01,  7.3127e-02],
         [ 1.3350e-01,  8.0978e-02],
         [ 1.4640e-01, -1.4455e-01],
         [ 1.1619e-01,  6.5704e-02],
         [ 9.2573e-02,  6.4320e-02],
         [ 1.1584e-01,  9.9201e-02],
         [ 1.0966e-01,  1.1802e-01],
         [ 8.6072e-02,  6.8494e-02],
         [ 1.0683e-01,  9.9457e-02],
         [ 1.0230e-01,  6.1851e-02],
         [ 8.0722e-02,  1.3665e-01],
         [ 6.0017e-02,  1.2979e-01],
         [ 6.6620e-02,  1.7145e-01],
         [ 1.0459e-01,  1.3897e-01],
         [ 1.3237e-01,  8.8752e-02],
         [ 1.1212e-01,  1.1611e-01],
         [ 1.1680e-01,  1.1592e-01],
         [ 1.5335e-01,  1.1074e-01],
         [ 1.2648e-01,  1.1028e-01],
         [ 7.2259e-02,  1.3994e-01],
         [ 1.0498e-01,  1.1687e-01],
         [ 1.2999e-01,  1.4187e-01],
         [ 1.6023e-01,  1.1625e-01],
         [ 1.7786e-01,  1.2838e-01],
         [ 1.3986e-01,  1.5269e-01],
         [ 1.2664e-01,  1.5076e-01],
         [ 1.2916e-01,  1.5014e-01],
         [ 1.0589e-01,  1.4901e-01],
         [ 1.3291e-01,  1.1274e-01],
         [ 1.4468e-01,  5.0993e-03],
         [ 1.0870e-01,  3.1411e-02],
         [ 1.0849e-01,  4.5714e-02],
         [ 6.7021e-02,  5.2212e-02],
         [ 9.6770e-02,  5.4775e-02],
         [ 6.1915e-02,  5.5544e-02],
         [ 8.3715e-02,  5.5643e-02],
         [ 1.0102e-01,  5.5543e-02],
         [-3.4857e-03,  5.5415e-02],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.8949e-06, device='cuda:0') tensor(0.0016, device='cuda:0') tensor(-0.0015, device='cuda:0')
mixer_td_error tensor(0.0192, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4302, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3519, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0770, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1726, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0243, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-89285.6172, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1858, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.7985e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1027, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1921, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1027, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12518
target_mac_out tensor([[[[-1.0000e+07, -9.8799e-02,  1.1017e-01,  ...,  6.1516e-02,
            1.3971e-01, -1.0000e+07],
          [-1.0000e+07, -2.8322e-02,  1.2490e-01,  ...,  1.4773e-02,
            1.3610e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1401e-01,  1.1279e-01,  ...,  4.5497e-02,
            1.3499e-01, -1.0000e+07],
          [-1.0000e+07, -7.3120e-02,  1.5994e-01,  ...,  5.3848e-02,
            1.4969e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.5766e-01,  1.2924e-01,  ...,  6.5292e-02,
            1.5826e-01, -1.0000e+07],
          [-1.0000e+07, -1.1366e-01,  1.7414e-01,  ...,  7.9402e-02,
            1.5472e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6040e-02,  8.9233e-02,  ...,  1.4820e-02,
            1.4572e-01, -1.0000e+07],
          [-1.0000e+07, -3.0885e-02,  1.0823e-01,  ..., -2.7428e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0028e-02,  6.5961e-02,  ...,  2.1182e-02,
            1.4292e-01, -1.0000e+07],
          [-1.0000e+07, -6.8480e-02,  1.4839e-01,  ...,  2.4421e-02,
            1.4843e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.9878e-01,  1.2526e-01,  ...,  6.3344e-02,
            2.0080e-01, -3.0504e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.9870e-01,  8.5135e-02,  ...,  5.9683e-02,
            1.9056e-01, -3.0818e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 9.4969e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1017e-01,  1.2490e-01],
         [ 1.1279e-01,  1.5994e-01],
         [ 1.2924e-01,  1.7414e-01],
         [ 1.3426e-01,  1.6582e-01],
         [ 1.3451e-01,  1.3784e-01],
         [ 1.3676e-01,  9.3892e-02],
         [ 1.2002e-01,  1.1716e-01],
         [ 1.3964e-01,  1.0734e-01],
         [ 1.2946e-01,  8.8768e-02],
         [ 1.4882e-01,  1.2612e-01],
         [ 1.5493e-01,  1.0270e-01],
         [ 1.5350e-01,  1.3138e-01],
         [ 1.5393e-01,  1.6828e-01],
         [ 1.3704e-01,  1.7819e-01],
         [ 1.4874e-01,  1.3310e-01],
         [ 1.3457e-01,  1.1092e-01],
         [ 1.4336e-01,  8.2713e-02],
         [ 1.4809e-01,  1.3669e-01],
         [ 1.5037e-01,  1.5515e-01],
         [ 2.0988e-01,  1.6981e-01],
         [ 1.3958e-01,  1.7091e-01],
         [-2.3231e-02,  1.0261e-01],
         [ 1.1216e-02,  9.0877e-02],
         [ 3.1161e-02,  4.9244e-02],
         [ 4.1545e-02,  3.8892e-02],
         [ 4.6590e-02,  7.6041e-02],
         [ 4.8906e-02,  5.8123e-02],
         [ 4.9831e-02,  1.0509e-01],
         [ 5.0154e-02,  1.1999e-01],
         [ 5.0238e-02,  1.2243e-01],
         [ 5.0205e-02,  7.4925e-02],
         [ 5.0154e-02,  8.4737e-02],
         [ 5.0098e-02,  9.3588e-02],
         [ 5.0072e-02,  4.9341e-02],
         [ 5.0046e-02,  9.5189e-02],
         [ 5.0045e-02,  1.1090e-01],
         [ 5.0037e-02,  6.4759e-02],
         [ 5.0038e-02,  9.1849e-02],
         [ 5.0022e-02,  9.7968e-02],
         [ 5.0018e-02,  9.6747e-02],
         [ 5.0013e-02,  9.1442e-02],
         [ 5.0017e-02,  5.1373e-02],
         [ 5.0007e-02, -1.9325e-01],
         [ 5.0007e-02,  3.4006e-02],
         [ 5.0008e-02,  1.3718e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0827e-01,  1.0736e-01],
         [ 8.9233e-02,  1.0823e-01],
         [ 6.5961e-02,  1.4839e-01],
         [ 9.4513e-02,  1.6198e-01],
         [ 7.0086e-02,  1.2632e-01],
         [ 7.8141e-02,  1.2975e-01],
         [ 5.9422e-02,  1.0267e-01],
         [ 5.4271e-02,  1.1196e-01],
         [ 7.8706e-02,  5.6785e-02],
         [ 9.1647e-02,  6.0255e-02],
         [ 1.1545e-01,  3.5410e-02],
         [ 9.2681e-02,  7.2036e-02],
         [ 9.7003e-02,  1.0514e-01],
         [ 1.2183e-01,  1.1466e-01],
         [-9.0097e-02,  7.5311e-02],
         [ 9.8567e-02,  5.9223e-02],
         [ 9.5998e-02,  8.8659e-02],
         [ 6.2254e-02,  6.5042e-02],
         [-7.5611e-02,  7.4072e-02],
         [ 7.4212e-02,  7.0794e-02],
         [ 6.6743e-02,  9.3797e-02],
         [ 9.1400e-02,  1.0816e-01],
         [ 1.2222e-01,  2.5850e-01],
         [-9.4819e-02,  6.6355e-02],
         [ 9.9055e-02,  2.5225e-01],
         [ 1.2717e-01,  5.2638e-02],
         [ 1.1060e-01, -2.0063e-01],
         [ 7.0037e-02, -1.9637e-01],
         [ 1.1379e-01, -2.0144e-01],
         [ 7.5720e-02,  2.2629e-01],
         [ 7.3870e-02, -1.4061e-02],
         [ 1.1742e-01,  2.4141e-02],
         [ 1.3373e-01,  4.2475e-02],
         [ 9.2115e-02,  5.0765e-02],
         [ 1.2674e-01,  5.4220e-02],
         [ 1.3725e-01,  5.5444e-02],
         [ 1.5272e-01,  5.5766e-02],
         [ 1.1420e-01,  5.5689e-02],
         [ 1.4002e-01,  5.5571e-02],
         [ 1.3603e-01,  5.5426e-02],
         [ 1.0328e-01,  5.5348e-02],
         [ 1.0050e-01,  5.5268e-02],
         [ 1.3295e-01,  5.5250e-02],
         [ 1.4547e-01,  5.5207e-02],
         [ 1.2092e-01,  5.5223e-02],
         [ 1.1278e-01,  5.5218e-02],
         [ 9.5180e-02,  5.5202e-02],
         [ 1.0294e-01,  5.5207e-02],
         [ 7.7280e-02,  5.5208e-02],
         [ 1.2786e-01,  5.5222e-02],
         [ 1.2230e-01,  5.5231e-02],
         [ 7.7287e-02,  5.5229e-02],
         [ 1.2526e-01,  5.5230e-02],
         [ 8.5135e-02,  5.5230e-02],
         [ 9.4969e-03,  5.5232e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.2726e-05, device='cuda:0') tensor(0.0014, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(0.2471, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4579, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3918, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0815, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2094, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0009, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-909090.6875, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2585, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.1795e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1908, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2783, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1908, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12579
target_mac_out tensor([[[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.6914e-02,  5.5395e-02,  ...,  1.2422e-02,
            1.3499e-01, -1.0000e+07],
          [-1.0000e+07, -2.7452e-02,  1.3144e-01,  ...,  7.4187e-03,
            1.4409e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2515e-02,  6.0388e-02,  ..., -1.1286e-02,
            1.4546e-01, -1.0000e+07],
          [-1.0000e+07, -2.0059e-02,  1.2605e-01,  ...,  1.5017e-02,
            1.4412e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9559e-02,  6.7393e-02,  ...,  6.3287e-03,
            1.3356e-01, -1.0000e+07],
          [-1.0000e+07, -2.3320e-02,  1.3756e-01,  ..., -5.8740e-03,
            1.4756e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8585e-02,  7.5213e-02,  ...,  9.0584e-03,
            1.4289e-01, -1.0000e+07],
          [-1.0000e+07, -2.4015e-02,  1.3443e-01,  ..., -2.0588e-02,
            1.4282e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.2357e-01,  1.3582e-01,  ...,  9.1124e-02,
            1.9843e-01, -3.3923e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.0477e-01, -1.0000e+07,  ...,  9.6835e-02,
           -1.0000e+07, -3.0772e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.8018e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.0205e-02,  9.0702e-02],
         [ 5.5395e-02,  1.3144e-01],
         [ 6.0388e-02,  1.2605e-01],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 5.8068e-02,  1.0699e-01],
         [ 6.7393e-02,  1.3756e-01],
         [ 7.5213e-02,  1.3443e-01],
         ...,
         [ 1.3582e-01,  5.5231e-02],
         [ 9.6835e-02,  5.5231e-02],
         [-1.8018e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.5890e-07, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0004, device='cuda:0')
mixer_td_error tensor(0.9846, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4512, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4413, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0703, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1842, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0194, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-4022139.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2307, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.2053e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1762, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2063, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1762, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12624
target_mac_out tensor([[[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1573e-01,  1.1465e-01,  ...,  4.6260e-02,
            1.3400e-01, -1.0000e+07],
          [-1.0000e+07, -8.4494e-02,  1.5393e-01,  ...,  5.1304e-02,
            1.4180e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.5712e-01,  1.2888e-01,  ...,  6.5788e-02,
            1.5922e-01, -1.0000e+07],
          [-1.0000e+07, -1.1309e-01,  1.6298e-01,  ...,  4.4973e-02,
            1.3720e-01, -1.0000e+07]],

         ...,

         [[ 5.0010e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5259e-01,  4.2070e-02,  ...,  4.6448e-02,
            2.0061e-01, -3.0921e-01]],

         [[ 5.0019e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4739e-01,  2.7277e-02,  ...,  3.7970e-02,
            1.9213e-01, -3.0470e-01]],

         [[ 5.0005e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-6.5526e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.4255e-02,  8.7945e-02,  ...,  2.1998e-02,
            1.2409e-01, -1.0000e+07],
          [-1.0000e+07, -2.5887e-02,  1.2012e-01,  ...,  1.5133e-02,
            1.3440e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0284e-02,  1.0513e-01,  ...,  1.6011e-02,
            1.5158e-01, -1.0000e+07],
          [-1.0000e+07, -6.7958e-02,  1.5619e-01,  ...,  5.3953e-02,
            1.5138e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3012e-02,  1.1455e-01,  ...,  1.2849e-02,
            1.6561e-01, -1.0000e+07],
          [-1.0000e+07, -5.9266e-02,  1.1137e-01,  ...,  3.2373e-02,
            1.5613e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1386e-01,  1.4136e-01],
         [ 1.1465e-01,  1.5393e-01],
         [ 1.2888e-01,  1.6298e-01],
         [ 1.1473e-01,  1.7173e-01],
         [ 1.2231e-01,  1.2383e-01],
         [ 1.2611e-01,  1.3502e-01],
         [ 1.3756e-01,  1.3699e-01],
         [ 1.4789e-01,  1.6764e-01],
         [ 1.5483e-01,  1.0690e-01],
         [ 1.6171e-01,  7.5229e-02],
         [ 1.3137e-01,  6.9615e-02],
         [ 1.3735e-01, -8.9593e-02],
         [ 1.0524e-01, -8.8361e-02],
         [ 1.8221e-01,  5.6095e-02],
         [ 1.4552e-01,  1.0199e-01],
         [ 1.3054e-01,  1.1839e-01],
         [ 1.5517e-01,  1.2622e-01],
         [ 1.6271e-01,  1.2965e-01],
         [ 1.6643e-01,  1.3116e-01],
         [ 1.6984e-01,  9.9086e-02],
         [ 1.5822e-01,  1.1981e-01],
         [ 1.7152e-01,  1.2423e-01],
         [ 1.3993e-01,  1.2766e-01],
         [ 1.5759e-01,  6.4070e-02],
         [ 1.6715e-01, -6.4276e-02],
         [ 1.6860e-01,  1.2594e-01],
         [ 1.5307e-01,  1.2881e-01],
         [ 1.6926e-01, -6.1866e-02],
         [ 1.7331e-01,  1.0758e-01],
         [ 1.7444e-01,  1.1578e-01],
         [ 1.7447e-01,  1.2047e-01],
         [ 1.5910e-01, -8.5079e-02],
         [ 1.4687e-01,  1.0737e-01],
         [ 1.4418e-01,  1.1469e-01],
         [ 1.5385e-01,  9.2935e-02],
         [ 1.2890e-01,  1.0834e-01],
         [ 1.1441e-01,  8.1266e-02],
         [ 1.4597e-01,  6.2028e-02],
         [ 1.5583e-01,  6.6273e-02],
         [ 1.1195e-01,  9.4350e-02],
         [ 1.5459e-01, -1.1843e-01],
         [ 1.5414e-01,  9.0652e-02],
         [ 1.5131e-01, -7.9173e-02],
         [ 1.4536e-01,  1.0637e-01],
         [ 1.2951e-01, -6.1972e-02],
         [ 1.4180e-01,  7.6235e-02],
         [ 1.4379e-01, -6.1448e-02],
         [ 1.5147e-01,  1.0677e-01],
         [ 1.5647e-01,  1.2387e-01],
         [ 1.5623e-01,  6.0520e-02],
         [ 1.5792e-01,  1.2151e-01],
         [ 1.2824e-01,  1.2693e-01],
         [ 1.3204e-01,  1.3683e-01],
         [ 1.4425e-01, -7.4734e-02],
         [ 1.5058e-01,  7.8115e-02],
         [ 1.3831e-01,  1.0190e-01],
         [ 1.7953e-01,  7.1324e-02],
         [ 1.4337e-01,  5.5319e-02],
         [ 1.4712e-01,  8.9378e-02],
         [ 1.5379e-01,  6.2149e-02],
         [ 1.5971e-01,  9.4938e-02],
         [ 1.6775e-01,  1.1045e-01],
         [ 1.7310e-01,  8.7125e-02],
         [ 1.7035e-01,  1.1218e-01],
         [ 1.6679e-01,  1.2036e-01],
         [ 1.6617e-01,  9.5386e-02],
         [ 1.6780e-01,  1.1275e-01],
         [ 1.6743e-01,  1.2275e-01],
         [ 1.6757e-01,  8.7439e-02],
         [-1.7652e-01,  7.3761e-02],
         [-1.7096e-01,  9.5198e-02],
         [-1.7592e-01,  8.3524e-02],
         [ 1.5901e-01,  7.5263e-02],
         [ 1.6397e-01,  1.2286e-01],
         [-8.8931e-03,  1.2035e-01],
         [ 1.8226e-02,  1.2887e-01],
         [ 3.4727e-02,  8.5579e-02],
         [ 4.3385e-02,  8.5527e-02],
         [ 4.7496e-02,  6.9333e-02],
         [ 4.9258e-02,  8.0703e-02],
         [ 4.9944e-02,  1.0762e-01],
         [ 5.0146e-02,  1.0697e-01],
         [ 5.0176e-02,  7.0366e-02],
         [ 5.0147e-02,  6.3753e-02],
         [ 5.0104e-02,  5.3180e-02],
         [ 5.0068e-02,  6.6835e-02],
         [ 5.0059e-02,  7.7493e-02],
         [ 5.0023e-02,  7.2101e-02],
         [ 5.0034e-02,  9.4831e-02],
         [ 5.0038e-02,  1.0395e-01],
         [ 5.0017e-02, -2.2966e-01],
         [ 5.0045e-02,  2.2698e-01],
         [ 5.0032e-02, -2.0814e-01],
         [ 5.0006e-02, -1.7017e-01],
         [ 5.0010e-02, -1.5259e-01],
         [ 5.0019e-02, -1.4739e-01],
         [ 5.0005e-02, -6.5526e-03]],

        [[ 8.7945e-02,  1.2012e-01],
         [ 1.0513e-01,  1.5619e-01],
         [ 1.1455e-01,  1.1137e-01],
         [ 1.0928e-01,  1.1238e-01],
         [ 1.1759e-01,  9.6155e-02],
         [ 1.3224e-01,  1.1690e-01],
         [ 1.3065e-01,  1.2557e-01],
         [ 2.4148e-02,  1.0217e-01],
         [ 1.1392e-01,  8.9683e-02],
         [ 1.2750e-01,  7.2983e-02],
         [ 1.3665e-01,  1.0123e-01],
         [ 1.4261e-01,  1.2320e-01],
         [ 1.4933e-01,  8.9549e-02],
         [ 1.5880e-01,  1.0469e-01],
         [ 1.6065e-01,  1.1061e-01],
         [ 1.6042e-01,  9.2430e-02],
         [ 1.2911e-01,  6.4146e-02],
         [ 1.3222e-01,  9.4316e-02],
         [ 1.2754e-01,  1.3333e-01],
         [ 1.4183e-01,  5.5685e-02],
         [ 1.1698e-01,  4.9208e-02],
         [ 1.2470e-01,  9.6655e-02],
         [ 1.2065e-01,  1.1872e-01],
         [ 1.3198e-01,  1.2560e-01],
         [ 1.3806e-01,  1.3035e-01],
         [ 1.3778e-01,  1.1220e-01],
         [ 1.3465e-01,  1.4000e-01],
         [ 1.4665e-01,  1.0256e-01],
         [ 1.2749e-01,  8.4837e-02],
         [ 1.3382e-01,  1.2564e-01],
         [ 1.5784e-01,  1.4967e-01],
         [ 1.6183e-01,  1.0705e-01],
         [ 1.7430e-01,  1.1443e-01],
         [ 1.3928e-01,  1.0711e-01],
         [ 1.7016e-01,  8.7665e-02],
         [ 1.9278e-01,  7.0130e-02],
         [ 1.6844e-01,  6.8611e-02],
         [ 1.8056e-01,  2.2259e-02],
         [ 1.5534e-01,  4.5035e-02],
         [ 1.7739e-01,  1.0313e-01],
         [ 1.5478e-01,  1.0023e-01],
         [ 1.7269e-01,  9.4496e-02],
         [ 1.4926e-01,  1.0114e-01],
         [ 1.7416e-01,  1.0650e-01],
         [ 1.5945e-01,  1.1422e-01],
         [ 1.2073e-01,  7.0474e-02],
         [ 1.4797e-01,  7.7788e-02],
         [ 1.6177e-01,  1.1929e-01],
         [ 1.7230e-01,  8.9434e-02],
         [ 1.7709e-01,  1.1898e-01],
         [ 1.8869e-01,  8.0960e-02],
         [ 1.3571e-01,  9.8804e-02],
         [ 1.6773e-01,  1.0597e-01],
         [ 1.7600e-01,  1.0320e-01],
         [-2.7555e-02,  9.3065e-02],
         [ 9.0467e-03, -1.2606e-01],
         [ 2.9682e-02, -9.2335e-02],
         [ 4.0425e-02, -1.0817e-01],
         [ 4.5691e-02,  9.4147e-02],
         [ 4.8184e-02,  9.7959e-02],
         [ 4.9306e-02,  7.7919e-02],
         [ 4.9735e-02,  1.0526e-01],
         [ 4.9928e-02, -1.0293e-01],
         [ 4.9976e-02,  1.2385e-01],
         [ 5.0007e-02,  1.3466e-01],
         [ 4.9994e-02, -8.1255e-02],
         [ 5.0000e-02, -1.0069e-01],
         [ 5.0020e-02,  1.4983e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.7698e-05, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0013, device='cuda:0')
mixer_td_error tensor(0.3801, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4543, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6153, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0859, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2069, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0102, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1494845.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2270, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.4986e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2137, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3411, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2137, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12690
target_mac_out tensor([[[[-1.0000e+07, -9.3745e-02,  1.1397e-01,  ...,  6.2087e-02,
            1.3778e-01, -1.0000e+07],
          [-1.0000e+07, -2.4539e-02,  9.4233e-02,  ..., -1.0851e-02,
            1.2427e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.6842e-02,  9.2673e-02,  ...,  3.9973e-02,
            1.3230e-01, -1.0000e+07],
          [-1.0000e+07, -3.3041e-02,  9.0873e-02,  ..., -3.5459e-02,
            1.3338e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2516e-02,  1.1566e-01,  ...,  2.8046e-02,
            1.5267e-01, -1.0000e+07],
          [-1.0000e+07, -6.8894e-02,  1.3834e-01,  ...,  2.9285e-02,
            1.5445e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.8284e-01,  1.0583e-01,  ...,  5.6234e-02,
            1.7008e-01, -3.1229e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6511e-01,  7.4844e-02,  ...,  5.1287e-02,
            1.4631e-01, -3.0909e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 9.6567e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0858e-01,  1.1896e-01,  ...,  4.6389e-02,
            1.3416e-01, -1.0000e+07],
          [-1.0000e+07, -7.9194e-02,  1.2034e-01,  ...,  2.6982e-02,
            1.4530e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3949e-01,  1.3629e-01,  ...,  6.6028e-02,
            1.5368e-01, -1.0000e+07],
          [-1.0000e+07, -1.0564e-01,  1.4944e-01,  ...,  6.4292e-02,
            1.5741e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1397e-01,  9.4233e-02],
         [ 9.2673e-02,  9.0873e-02],
         [ 1.1566e-01,  1.3834e-01],
         [ 1.2599e-01,  1.5543e-01],
         [ 1.2628e-01,  6.0337e-02],
         [ 1.2609e-01,  1.4068e-01],
         [ 1.2796e-01,  1.2066e-01],
         [-1.0527e-01,  1.2908e-01],
         [ 1.1155e-01,  9.5456e-02],
         [ 1.1914e-01,  1.2120e-01],
         [ 1.1983e-01,  1.6012e-01],
         [-1.2207e-01,  1.6517e-01],
         [-9.7186e-02,  1.7071e-01],
         [-6.7942e-02,  1.7337e-01],
         [-8.6843e-02,  1.7404e-01],
         [-3.2367e-02,  1.1284e-01],
         [-2.2687e-02,  7.4869e-02],
         [-2.1019e-02,  7.4090e-02],
         [-3.7614e-02,  8.5483e-02],
         [-6.2847e-02,  8.8479e-02],
         [-4.5005e-02,  8.4416e-02],
         [-6.4106e-02, -1.6297e-01],
         [-9.5745e-02, -1.2831e-01],
         [ 8.2537e-02,  1.3737e-01],
         [ 8.8421e-02, -1.2744e-02],
         [ 9.2946e-02,  2.4992e-02],
         [-9.0553e-02,  4.2975e-02],
         [-1.0192e-01,  5.0799e-02],
         [-1.1082e-01,  5.3942e-02],
         [-1.1054e-01,  5.5076e-02],
         [-1.1471e-01,  5.5362e-02],
         [-1.0396e-01,  5.5377e-02],
         [-8.2232e-02,  5.5320e-02],
         [-9.7377e-02,  5.5282e-02],
         [-1.0817e-01,  5.5221e-02],
         [-1.1540e-01,  5.5213e-02],
         [-1.1993e-01,  5.5203e-02],
         [-8.3365e-02,  5.5221e-02],
         [-7.4443e-02,  5.5214e-02],
         [-5.2184e-02,  5.5212e-02],
         [-5.8272e-02,  5.5217e-02],
         [-6.0766e-02,  5.5211e-02],
         [-6.1951e-02,  5.5213e-02],
         [-4.4768e-02,  5.5221e-02],
         [-6.5926e-02,  5.5227e-02],
         [-6.8066e-02,  5.5232e-02],
         [-4.7268e-02,  5.5230e-02],
         [-3.3269e-02,  5.5230e-02],
         [-3.5496e-02,  5.5231e-02],
         [-5.8198e-02,  5.5236e-02],
         [-6.3471e-02,  5.5235e-02],
         [-4.5243e-02,  5.5232e-02],
         [-5.0905e-02,  5.5232e-02],
         [-5.6414e-02,  5.5231e-02],
         [-6.0263e-02,  5.5231e-02],
         [-7.5047e-02,  5.5231e-02],
         [-5.3115e-02,  5.5231e-02],
         [-5.5205e-02,  5.5231e-02],
         [-5.8269e-02,  5.5231e-02],
         [-6.0741e-02,  5.5231e-02],
         [-7.4789e-02,  5.5231e-02],
         [-9.1960e-02,  5.5231e-02],
         [-9.0186e-02,  5.5231e-02],
         [-9.8908e-02,  5.5231e-02],
         [-8.9071e-02,  5.5231e-02],
         [-1.2598e-01,  5.5231e-02],
         [ 1.2210e-01,  5.5231e-02],
         [ 1.0907e-01,  5.5231e-02],
         [ 8.9137e-02,  5.5231e-02],
         [ 1.1011e-01,  5.5231e-02],
         [ 1.2501e-01,  5.5231e-02],
         [ 1.4853e-01,  5.5231e-02],
         [ 9.3539e-02,  5.5231e-02],
         [ 1.3836e-01,  5.5231e-02],
         [ 1.3899e-01,  5.5231e-02],
         [ 1.5387e-01,  5.5231e-02],
         [ 1.5918e-01,  5.5231e-02],
         [ 1.5966e-01,  5.5231e-02],
         [ 1.4760e-01,  5.5231e-02],
         [ 1.4069e-01,  5.5231e-02],
         [ 1.0353e-01,  5.5231e-02],
         [ 1.0005e-01,  5.5231e-02],
         [ 1.1581e-01,  5.5231e-02],
         [ 8.3139e-02,  5.5231e-02],
         [ 1.0583e-01,  5.5231e-02],
         [-1.6511e-01,  5.5231e-02],
         [ 9.6567e-03,  5.5231e-02]],

        [[ 1.1386e-01,  1.4136e-01],
         [ 1.1896e-01,  1.2034e-01],
         [ 1.3629e-01,  1.4944e-01],
         [ 1.1585e-01,  1.7011e-01],
         [ 1.4309e-01,  1.7439e-01],
         [ 1.1692e-01,  1.4167e-01],
         [ 1.2880e-01,  1.3947e-01],
         [ 1.3739e-01,  1.4560e-01],
         [ 1.5884e-01,  1.5005e-01],
         [ 1.3115e-01,  1.2626e-01],
         [ 1.5158e-01,  1.5178e-01],
         [ 1.4150e-01,  1.1730e-01],
         [ 1.2319e-01,  1.4165e-01],
         [ 1.5078e-01,  1.1004e-01],
         [ 1.7175e-01,  1.3489e-01],
         [ 1.4250e-01, -1.4092e-01],
         [ 1.3075e-01, -1.2813e-01],
         [ 1.6945e-01, -1.2203e-01],
         [ 1.4200e-01, -1.2681e-01],
         [ 1.2607e-01,  8.9189e-02],
         [ 1.5633e-01,  9.8337e-02],
         [ 1.6940e-01,  6.9199e-02],
         [ 1.5189e-01,  6.5639e-02],
         [ 1.4346e-01,  6.2023e-02],
         [ 1.2868e-01,  1.1561e-01],
         [ 1.5917e-01,  8.5765e-02],
         [ 1.7896e-01, -1.7108e-01],
         [ 1.9090e-01, -1.7158e-01],
         [ 1.4601e-01, -1.7714e-01],
         [ 1.7812e-01, -1.8698e-01],
         [ 1.8826e-01, -1.9349e-01],
         [ 1.6254e-01,  9.9032e-02],
         [ 1.8121e-01,  1.5286e-01],
         [ 1.5725e-01,  1.7030e-01],
         [ 1.7104e-01,  1.7753e-01],
         [ 1.7387e-01, -1.3865e-01],
         [ 1.5019e-01,  1.1812e-01],
         [-3.3130e-02, -1.5091e-01],
         [ 4.6533e-03, -1.3573e-01],
         [ 2.6647e-02, -1.2818e-01],
         [ 3.8434e-02, -1.2299e-01],
         [ 4.4499e-02, -1.0340e-01],
         [ 4.7480e-02, -9.8513e-02],
         [ 4.8902e-02, -9.6907e-02],
         [ 4.9559e-02, -9.9070e-02],
         [ 4.9846e-02,  2.5202e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(9.5846e-05, device='cuda:0') tensor(0.0022, device='cuda:0') tensor(-0.0023, device='cuda:0')
mixer_td_error tensor(0.6111, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4532, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8092, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0768, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1767, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0126, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2356321.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1909, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.9042e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0019, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0929, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3089, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0929, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12739
target_mac_out tensor([[[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9559e-02,  6.7393e-02,  ...,  6.3287e-03,
            1.3356e-01, -1.0000e+07],
          [-1.0000e+07, -2.3320e-02,  1.3756e-01,  ..., -5.8740e-03,
            1.4756e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8585e-02,  7.5213e-02,  ...,  9.0584e-03,
            1.4289e-01, -1.0000e+07],
          [-1.0000e+07, -2.4015e-02,  1.3443e-01,  ..., -2.0588e-02,
            1.4282e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.2357e-01,  1.3582e-01,  ...,  9.1124e-02,
            1.9843e-01, -3.3923e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.0477e-01, -1.0000e+07,  ...,  9.6835e-02,
           -1.0000e+07, -3.0772e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.8018e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0695e-02,  8.8884e-02,  ...,  1.4652e-02,
            1.4204e-01, -1.0000e+07],
          [-1.0000e+07, -3.4872e-02,  9.9288e-02,  ..., -3.2764e-02,
            1.3673e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 3.4876e-02,  1.0699e-01],
         [ 6.7393e-02,  1.3756e-01],
         [ 7.5213e-02,  1.3443e-01],
         ...,
         [ 1.3582e-01,  5.5231e-02],
         [ 9.6835e-02,  5.5231e-02],
         [-1.8018e-02,  5.5231e-02]],

        [[ 9.6186e-02,  8.7099e-02],
         [ 2.5948e-02,  1.0899e-01],
         [ 8.8884e-02,  9.9288e-02],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.6903e-05, device='cuda:0') tensor(0.0003, device='cuda:0') tensor(-0.0005, device='cuda:0')
mixer_td_error tensor(0.1726, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4496, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5116, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0702, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1609, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0186, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-867158.5625, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2307, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(9.4697e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1805, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2030, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1805, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12792
target_mac_out tensor([[[[-1.0000e+07, -9.8799e-02,  1.1017e-01,  ...,  6.1516e-02,
            1.3971e-01, -1.0000e+07],
          [-1.0000e+07, -2.8322e-02,  1.2490e-01,  ...,  1.4773e-02,
            1.3610e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3343e-01,  1.1844e-01,  ...,  4.7984e-02,
            1.3981e-01, -1.0000e+07],
          [-1.0000e+07, -2.8237e-02,  1.2745e-01,  ..., -2.7338e-03,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6363e-01,  1.2422e-01,  ...,  4.4419e-02,
            1.5108e-01, -1.0000e+07],
          [-1.0000e+07, -5.3177e-02,  1.4268e-01,  ..., -5.0646e-03,
            1.5281e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -6.8708e-02,  1.0552e-01,  ...,  2.2667e-03,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -9.4268e-02,  6.3827e-02,  ...,  2.2878e-03,
            1.8517e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.2013e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5929e-02,  7.6370e-02,  ...,  4.6347e-02,
            1.3784e-01, -1.0000e+07],
          [-1.0000e+07, -3.3003e-02,  1.3273e-01,  ...,  2.2040e-02,
            1.4681e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3194e-02,  4.8036e-02,  ...,  5.3399e-02,
            1.4822e-01, -1.0000e+07],
          [-1.0000e+07, -4.8579e-02,  8.0030e-02,  ...,  1.6162e-02,
            1.7295e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1017e-01,  1.2490e-01],
         [ 4.7984e-02,  1.2745e-01],
         [ 4.4419e-02,  1.4268e-01],
         [ 4.4411e-02,  1.1298e-01],
         [ 4.4645e-02,  1.3179e-01],
         [ 4.1332e-02,  1.0301e-01],
         [ 4.0187e-02, -5.8872e-02],
         [ 3.8581e-02, -5.9574e-02],
         [ 1.2727e-01,  1.1415e-01],
         [ 1.3672e-01,  8.8522e-02],
         [-7.0255e-02,  1.1600e-01],
         [-7.8474e-02,  1.2202e-01],
         [-6.5204e-02, -6.8041e-02],
         [-8.1784e-02, -5.8653e-02],
         [-8.0411e-02,  1.1996e-01],
         [-6.4931e-02, -4.2145e-02],
         [-5.9809e-02, -4.0853e-02],
         [ 1.4972e-01, -4.3319e-02],
         [ 1.4126e-01, -4.2638e-02],
         [ 1.4989e-01, -5.7245e-02],
         [ 1.5719e-01,  1.1572e-01],
         [ 1.5880e-01,  1.1447e-01],
         [ 1.6780e-01,  1.2375e-01],
         [ 1.7128e-01,  8.0380e-02],
         [ 1.7823e-01,  1.2402e-01],
         [ 1.8855e-01,  6.8178e-02],
         [ 1.7320e-01,  8.2250e-02],
         [ 1.8480e-01, -1.2238e-01],
         [ 1.4294e-01, -1.1544e-01],
         [ 1.2077e-01, -9.0418e-02],
         [ 6.3492e-02, -6.9405e-02],
         [ 6.8554e-02, -7.7630e-02],
         [ 6.3194e-02, -8.7154e-02],
         [ 1.0471e-01,  1.0084e-01],
         [ 1.8257e-01, -9.9112e-02],
         [-1.2028e-01, -1.0166e-01],
         [ 1.1790e-01, -1.0440e-01],
         [ 1.1371e-01, -4.4184e-02],
         [ 1.1304e-01, -2.8421e-02],
         [ 1.2600e-01, -2.9089e-02],
         [ 1.5394e-01, -6.4495e-02],
         [ 1.8339e-01,  9.4833e-02],
         [ 1.9041e-01,  7.4146e-02],
         [ 1.9214e-01, -1.1690e-01],
         [ 1.7646e-01, -1.0185e-01],
         [ 4.1617e-02, -9.2077e-02],
         [ 1.9295e-01, -9.8178e-02],
         [ 1.3692e-01, -9.3145e-02],
         [ 1.1150e-01, -7.3685e-02],
         [-1.1246e-02, -5.6203e-02],
         [ 2.2054e-02, -4.7014e-02],
         [ 3.8509e-02, -6.0521e-02],
         [ 4.6143e-02, -7.3359e-02],
         [ 4.9355e-02, -8.3762e-02],
         [ 5.0477e-02, -9.1271e-02],
         [ 5.0722e-02, -9.6302e-02],
         [ 5.0638e-02, -7.8619e-02],
         [ 5.0462e-02, -7.5453e-02],
         [ 5.0316e-02, -6.3359e-02],
         [ 5.0182e-02, -6.4955e-02],
         [ 5.0093e-02, -6.2102e-02],
         [ 5.0047e-02,  6.8113e-02],
         [ 5.0025e-02, -8.2540e-02],
         [ 5.0042e-02, -6.6779e-02],
         [ 5.0020e-02, -7.5943e-02],
         [ 5.0010e-02, -8.2630e-02],
         [ 5.0015e-02, -1.0249e-01],
         [ 5.0012e-02, -1.1340e-01],
         [ 5.0010e-02,  1.1883e-01],
         [ 5.0019e-02, -1.2437e-01],
         [ 5.0005e-02, -1.3013e-01],
         [ 5.0007e-02,  1.0285e-01],
         [ 5.0007e-02,  6.8261e-02],
         [ 5.0007e-02,  1.0817e-01],
         [ 5.0008e-02,  1.2059e-01],
         [ 5.0008e-02, -1.5638e-01],
         [ 5.0008e-02, -1.4706e-01],
         [ 5.0008e-02,  7.2471e-02],
         [ 5.0008e-02, -1.1478e-01],
         [ 5.0008e-02, -8.4307e-02],
         [ 5.0008e-02, -7.1453e-02],
         [ 5.0009e-02, -7.9510e-02],
         [ 5.0009e-02, -6.9215e-02],
         [ 5.0009e-02,  1.3685e-01],
         [ 5.0009e-02, -1.0644e-01],
         [ 5.0009e-02,  1.0332e-01],
         [ 5.0009e-02, -1.0264e-01],
         [ 5.0009e-02, -1.1688e-01],
         [ 5.0009e-02, -8.9931e-02],
         [ 5.0009e-02, -1.1239e-01],
         [ 5.0009e-02, -7.9518e-02],
         [ 5.0009e-02, -6.8708e-02],
         [ 5.0009e-02, -9.4268e-02],
         [ 5.0009e-02,  2.2013e-02]],

        [[ 1.0827e-01,  1.0736e-01],
         [ 4.6347e-02,  1.3273e-01],
         [-7.3194e-02, -4.8579e-02],
         [-9.1991e-02,  9.5644e-02],
         [ 1.1139e-01,  1.3787e-01],
         [ 6.4585e-02, -5.9346e-02],
         [ 5.0547e-02,  1.4755e-01],
         [ 7.0888e-02, -7.2050e-02],
         [ 5.5466e-02,  1.2687e-01],
         [ 1.1409e-01,  1.0862e-01],
         [ 5.8287e-02,  1.4086e-01],
         [ 1.1520e-01,  1.5220e-01],
         [ 1.2773e-01,  1.6152e-01],
         [ 1.3723e-01,  8.6934e-02],
         [ 1.5139e-01,  1.4418e-01],
         [ 1.5679e-01,  1.2470e-01],
         [ 1.0157e-01,  1.3980e-01],
         [ 1.0024e-01,  1.4563e-01],
         [ 1.1369e-01, -1.5789e-01],
         [ 1.4206e-01,  1.1067e-01],
         [ 1.4996e-01,  1.4486e-01],
         [ 1.5277e-01,  1.4971e-01],
         [ 1.3828e-01, -1.6268e-01],
         [ 1.3717e-01, -1.4644e-01],
         [ 1.4453e-01,  1.2715e-01],
         [ 1.4843e-01, -1.6324e-01],
         [ 1.6300e-01, -1.8011e-01],
         [ 1.6745e-01, -1.7542e-01],
         [ 1.0199e-01, -1.6572e-01],
         [ 9.4560e-02,  1.2699e-01],
         [-2.6898e-02, -1.6439e-01],
         [ 1.0757e-02, -1.6653e-01],
         [ 3.1095e-02,  6.3026e-02],
         [ 4.1351e-02, -1.7069e-01],
         [ 4.6265e-02,  7.5771e-02],
         [ 4.8485e-02,  1.0535e-01],
         [ 4.9465e-02,  1.1502e-01],
         [ 4.9847e-02,  2.6466e-01],
         [ 4.9989e-02, -2.0959e-01],
         [ 5.0013e-02,  8.7986e-02],
         [ 5.0002e-02,  6.9791e-02],
         [ 5.0017e-02,  7.7501e-02],
         [ 4.9989e-02,  8.4865e-02],
         [ 5.0027e-02,  2.4964e-01],
         [ 5.0016e-02, -2.2597e-01],
         [ 5.0012e-02, -1.8880e-01],
         [ 5.0015e-02, -2.0592e-01],
         [ 5.0027e-02, -1.7575e-01],
         [ 5.0024e-02, -7.5916e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.8012e-05, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.6069, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4529, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3859, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0676, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1660, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0050, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2393616.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2647, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.6179e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1738, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2761, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1738, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12838
target_mac_out tensor([[[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.1908e-02,  7.1628e-02,  ...,  3.0978e-03,
            1.2913e-01, -1.0000e+07],
          [-1.0000e+07, -3.1400e-02,  1.4762e-01,  ...,  2.0198e-03,
            1.5187e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7357e-02,  7.2546e-02,  ..., -1.2115e-02,
            1.4121e-01, -1.0000e+07],
          [-1.0000e+07, -3.8792e-02,  1.6292e-01,  ..., -7.4744e-03,
            1.6052e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6666e-01,  6.7277e-02,  ...,  4.2074e-02,
            1.2994e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.5088e-01,  4.7743e-02,  ...,  4.6411e-02,
            1.1840e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.2708e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.3996e-02,  8.6686e-02,  ...,  2.0696e-02,
            1.2691e-01, -1.0000e+07],
          [-1.0000e+07, -1.5667e-02,  8.3441e-02,  ...,  2.3244e-02,
            1.3188e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.1255e-02,  1.0085e-01,  ...,  1.3889e-02,
            1.5595e-01, -1.0000e+07],
          [-1.0000e+07, -1.9335e-02,  1.0315e-01,  ...,  4.0021e-03,
            1.3038e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5118e-02,  8.3231e-02,  ..., -1.3387e-02,
            1.5458e-01, -1.0000e+07],
          [-1.0000e+07, -4.0083e-02,  1.3304e-01,  ..., -4.8781e-03,
            1.4860e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 3.3330e-02,  1.2351e-01],
         [ 7.1628e-02,  1.4762e-01],
         [ 7.2546e-02,  1.6292e-01],
         [ 1.0148e-01, -5.8105e-02],
         [-7.3077e-02, -5.3262e-02],
         [-4.9715e-02, -5.8941e-02],
         [ 1.3922e-01, -6.1788e-02],
         [-5.6794e-02, -7.6118e-02],
         [-6.0736e-02, -5.6495e-02],
         [-5.0518e-02, -6.4970e-02],
         [-2.1181e-02, -5.5164e-02],
         [ 6.8323e-03, -7.3987e-02],
         [-8.4277e-03, -5.5711e-02],
         [-1.8376e-02, -6.0434e-02],
         [-3.2191e-02, -3.0044e-02],
         [-6.3426e-02, -2.5155e-02],
         [ 1.1279e-01, -3.1515e-02],
         [ 1.1430e-01, -3.2455e-02],
         [ 1.1755e-01,  1.6139e-01],
         [ 1.0673e-01, -4.5578e-02],
         [ 9.2436e-02,  1.5743e-01],
         [ 2.1280e-02,  1.6295e-01],
         [ 2.9546e-02,  1.2947e-01],
         [ 8.6210e-02,  1.4200e-01],
         [ 1.1339e-01, -7.2475e-02],
         [ 1.2281e-01,  1.2325e-01],
         [ 1.2728e-01,  1.5667e-01],
         [-8.6150e-02,  1.5379e-01],
         [ 1.2422e-01, -1.0024e-01],
         [ 1.4286e-01, -8.8900e-02],
         [-6.8981e-02, -7.6478e-02],
         [ 1.4590e-01, -7.5209e-02],
         [ 1.5875e-01, -6.2893e-02],
         [-6.4067e-02, -5.5314e-02],
         [-4.7229e-02, -3.4155e-02],
         [ 1.5344e-01, -2.1217e-02],
         [ 1.5482e-01, -9.2338e-03],
         [ 1.5599e-01, -2.2705e-02],
         [ 1.5403e-01, -2.2168e-02],
         [ 1.5243e-01,  1.1265e-01],
         [ 1.4938e-01, -5.4618e-02],
         [-9.4151e-02,  1.1020e-01],
         [-1.0459e-01,  1.3384e-01],
         [-1.1221e-01,  1.3438e-01],
         [ 1.4334e-01,  1.0204e-01],
         [-1.0200e-01, -7.7549e-02],
         [ 1.5214e-01, -7.5736e-02],
         [-1.1096e-01, -5.2704e-02],
         [ 1.3035e-01, -4.6195e-02],
         [ 1.2618e-01, -5.8270e-02],
         [ 1.4117e-01, -5.1359e-02],
         [ 1.3474e-01, -5.8309e-02],
         [ 5.1911e-02,  1.3047e-01],
         [ 7.0589e-02,  1.3829e-01],
         [ 5.9810e-02, -7.5399e-02],
         [ 5.9259e-02, -5.6075e-02],
         [ 7.0568e-02, -6.8827e-02],
         [ 3.7927e-02, -6.4713e-02],
         [ 7.3537e-02, -6.8092e-02],
         [ 7.3337e-02, -7.1879e-02],
         [ 6.6307e-02, -5.2687e-02],
         [ 5.5593e-02, -5.5074e-02],
         [ 1.3627e-01, -6.6767e-02],
         [ 1.5640e-01, -7.1163e-02],
         [ 1.5776e-01, -6.4783e-02],
         [ 1.5448e-01, -8.0132e-02],
         [ 7.0983e-02,  1.2394e-01],
         [ 7.3819e-02,  1.3002e-01],
         [-1.4361e-01, -8.2819e-02],
         [ 8.9521e-02, -7.4158e-02],
         [ 1.6727e-01, -7.1632e-02],
         [ 1.7752e-01, -7.2757e-02],
         [ 1.8903e-01,  9.7067e-02],
         [ 1.8810e-01,  1.0800e-01],
         [ 1.8029e-01, -1.1501e-01],
         [ 1.7282e-01, -1.1809e-01],
         [ 1.6848e-01,  7.6969e-02],
         [ 1.3929e-01, -1.1290e-01],
         [ 1.7132e-01,  9.5625e-02],
         [ 1.6232e-01,  1.1023e-01],
         [ 1.7734e-01,  1.1688e-01],
         [ 1.3139e-01, -6.3942e-02],
         [ 1.1768e-01, -6.5658e-02],
         [ 1.2347e-01, -7.3397e-02],
         [ 1.0153e-01, -8.2369e-02],
         [-1.6522e-01, -8.6819e-02],
         [-1.3915e-01, -7.5248e-02],
         [-1.1579e-01, -6.1299e-02],
         [ 9.2789e-02, -5.6447e-02],
         [-1.1900e-01, -7.0391e-02],
         [-1.1132e-01, -6.7150e-02],
         [-9.2779e-02, -1.6950e-02],
         [ 1.2247e-01, -3.2856e-02],
         [ 1.1558e-01, -2.6543e-03],
         [-1.0070e-01, -3.4410e-02],
         [ 1.2031e-01, -2.2195e-02],
         [ 1.3138e-01, -5.9894e-02],
         [ 1.3206e-01, -5.7370e-02],
         [ 1.5497e-01,  4.9755e-02],
         [ 1.6355e-01,  7.5160e-02],
         [ 1.2585e-01,  7.7119e-02],
         [ 1.4998e-01,  8.5199e-02],
         [ 1.5832e-01, -1.0361e-01],
         [ 1.4427e-01, -9.9337e-02],
         [ 1.6025e-01, -9.5831e-02],
         [ 1.4561e-01,  6.1700e-02],
         [ 1.5942e-01, -9.1430e-02],
         [ 1.6564e-01,  8.1041e-02],
         [ 1.4706e-01,  9.5415e-02],
         [ 1.6831e-01,  1.2742e-01],
         [ 1.4852e-01, -9.4637e-02],
         [-1.1186e-01, -8.9556e-02],
         [ 1.2630e-01,  9.8754e-02],
         [ 1.5329e-01,  1.3765e-01],
         [ 1.2278e-01,  1.1733e-01],
         [-1.3002e-01,  1.4003e-01],
         [ 1.3007e-01,  1.6316e-01],
         [ 1.8052e-01,  1.3186e-01],
         [ 1.9230e-01,  1.0123e-01],
         [ 2.0304e-01,  1.1761e-01],
         [ 2.2267e-01,  1.0482e-01],
         [-8.6238e-02,  9.4810e-02],
         [-6.4402e-02,  5.7123e-02],
         [-5.1294e-02,  6.4940e-02],
         [ 1.7760e-01,  8.4614e-02],
         [ 1.9990e-01,  7.7624e-02],
         [-5.4693e-02,  6.1885e-02],
         [-7.2631e-02,  8.0965e-02],
         [ 1.9061e-01,  9.0403e-02],
         [-6.1649e-02, -1.2851e-01],
         [-8.6076e-02, -1.1161e-01],
         [-5.3733e-02, -9.5706e-02],
         [-5.5057e-02, -6.5637e-03],
         [-3.0857e-02,  3.0356e-02],
         [-2.5816e-02,  4.6682e-02],
         [-6.3654e-02,  5.3259e-02],
         [-2.0505e-02,  5.5532e-02],
         [-5.8999e-02,  5.6072e-02],
         [-8.3611e-02,  5.5997e-02],
         [-9.7164e-02,  5.5767e-02],
         [-7.6884e-02,  5.5556e-02],
         [-9.0684e-02,  5.5411e-02],
         [-1.1674e-01,  5.5299e-02],
         [-1.3473e-01,  5.5256e-02],
         [-1.2687e-01,  5.5219e-02],
         [-1.0905e-01,  5.5217e-02],
         [ 1.0030e-01,  5.5210e-02],
         [ 1.2360e-01,  5.5206e-02],
         [-5.4478e-02,  5.5215e-02],
         [-6.1476e-02,  5.5219e-02],
         [-6.6968e-02,  5.5211e-02],
         [-1.0327e-01,  5.5217e-02],
         [-1.0147e-01,  5.5223e-02],
         [-1.4142e-01,  5.5232e-02],
         [ 1.3384e-01,  5.5230e-02],
         [ 1.5766e-01,  5.5230e-02],
         [-9.1639e-02,  5.5231e-02],
         [-1.0614e-01,  5.5236e-02],
         [ 1.4085e-01,  5.5235e-02],
         [ 1.3668e-01,  5.5232e-02],
         [ 7.5993e-02,  5.5232e-02],
         [ 1.0725e-01,  5.5231e-02],
         [ 6.5402e-02,  5.5231e-02],
         [ 1.0312e-01,  5.5231e-02],
         [ 8.6308e-02,  5.5231e-02],
         [ 1.0921e-01,  5.5231e-02],
         [ 1.0841e-01,  5.5231e-02],
         [ 1.1240e-01,  5.5231e-02],
         [ 1.1658e-01,  5.5231e-02],
         [ 1.1827e-01,  5.5231e-02],
         [ 1.1759e-01,  5.5231e-02],
         [-1.6666e-01,  5.5231e-02],
         [-1.5088e-01,  5.5231e-02],
         [ 3.2708e-02,  5.5231e-02]],

        [[ 8.6686e-02,  8.3441e-02],
         [ 1.0085e-01,  1.0315e-01],
         [ 8.3231e-02,  1.3304e-01],
         [-8.9038e-02,  1.5401e-01],
         [ 8.2169e-02, -5.6758e-02],
         [-9.3955e-02, -5.4028e-02],
         [-5.7934e-02, -5.1318e-02],
         [-1.1905e-02, -4.8780e-02],
         [-1.1350e-02, -3.4111e-02],
         [-4.2037e-02, -1.6236e-02],
         [-7.6479e-02,  1.2896e-01],
         [ 1.1549e-01,  1.1582e-01],
         [ 1.2162e-01,  1.0359e-01],
         [-8.0244e-02,  1.2643e-01],
         [ 1.2880e-01,  1.3915e-01],
         [-6.4436e-02,  1.0946e-01],
         [ 1.5182e-01,  9.4778e-02],
         [ 1.3131e-01, -2.4644e-02],
         [ 1.3657e-01,  1.1828e-01],
         [ 1.4294e-01,  1.3174e-01],
         [ 1.5047e-01,  1.0445e-01],
         [ 1.5419e-01,  1.2028e-01],
         [ 1.7147e-01,  9.8298e-02],
         [ 1.6930e-01,  1.2321e-01],
         [ 1.6958e-01,  1.3129e-01],
         [ 1.7044e-01,  1.3242e-01],
         [ 4.7152e-02,  1.2376e-01],
         [ 1.6755e-01,  1.2512e-01],
         [ 1.6020e-01, -9.0403e-02],
         [-1.0978e-01, -7.9509e-02],
         [-8.8515e-02, -8.3031e-02],
         [-9.6841e-02, -6.8240e-02],
         [ 1.6471e-01, -7.7244e-02],
         [ 1.6677e-01,  1.2493e-01],
         [ 1.6642e-01,  1.3311e-01],
         [ 1.7384e-01, -9.1202e-02],
         [ 5.1047e-02,  1.1451e-01],
         [ 4.7608e-02, -1.0380e-01],
         [ 1.7809e-01,  1.0987e-01],
         [ 1.9126e-01,  1.1483e-01],
         [ 5.7074e-02,  1.1689e-01],
         [ 1.8472e-01, -1.2556e-01],
         [ 1.3878e-01, -1.2391e-01],
         [ 1.6584e-01, -1.0907e-01],
         [ 1.7289e-01, -9.0014e-02],
         [ 1.7895e-01, -8.7899e-02],
         [ 1.8266e-01, -1.0889e-01],
         [ 1.3320e-01, -1.1458e-01],
         [ 1.5810e-01,  1.1346e-01],
         [ 1.5062e-01, -1.2033e-01],
         [ 1.1531e-01, -1.2978e-01],
         [ 1.3845e-01, -1.3115e-01],
         [ 1.5141e-01,  1.0708e-01],
         [ 1.6832e-01,  1.1912e-01],
         [ 1.2114e-01,  1.2683e-01],
         [ 1.4228e-01,  1.2747e-01],
         [ 1.4817e-01,  1.2499e-01],
         [ 1.5489e-01,  1.2427e-01],
         [ 1.6142e-01, -1.9732e-01],
         [ 1.7293e-01, -2.0197e-01],
         [ 1.7877e-01,  1.0302e-01],
         [ 1.8237e-01,  1.0571e-01],
         [ 1.7879e-01, -2.0172e-01],
         [ 1.5722e-01, -1.7720e-01],
         [ 1.7246e-01, -1.6046e-01],
         [ 1.7440e-01,  6.6252e-02],
         [ 1.5098e-01,  1.0012e-01],
         [ 1.5373e-01,  9.2786e-02],
         [-1.6169e-01, -1.3989e-01],
         [ 1.5479e-01, -1.2645e-01],
         [-1.8752e-03,  7.8884e-02],
         [ 2.5372e-02,  7.5384e-02],
         [ 3.9416e-02, -1.6765e-01],
         [ 4.6116e-02,  6.9743e-02],
         [ 4.9011e-02, -1.6467e-01],
         [ 5.0094e-02, -1.5933e-01],
         [ 5.0416e-02,  5.7762e-02],
         [ 5.0393e-02,  4.1795e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.6588e-06, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0005, device='cuda:0')
mixer_td_error tensor(0.6788, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4510, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3742, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0669, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1678, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0301, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2758620.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2227, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.4917e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1038, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2859, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1038, device='cuda:0', grad_fn=<MinBackward1>)
t_env 12884
target_mac_out tensor([[[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7413e-02,  9.1951e-02,  ...,  4.7431e-02,
            1.5634e-01, -1.0000e+07],
          [-1.0000e+07, -1.9542e-02,  9.5194e-02,  ...,  4.5180e-03,
            1.4030e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4907e-02,  9.5719e-02,  ...,  2.4923e-02,
            1.5235e-01, -1.0000e+07],
          [-1.0000e+07, -3.7884e-02,  9.5978e-02,  ..., -2.8356e-02,
            1.3624e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7229e-02,  1.0718e-01,  ...,  1.5798e-02,
            1.3791e-01, -1.0000e+07],
          [-1.0000e+07, -6.3204e-02,  1.3937e-01,  ...,  4.1475e-02,
            1.4929e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9425e-02,  1.1495e-01,  ...,  1.2519e-02,
            1.5796e-01, -1.0000e+07],
          [-1.0000e+07, -7.3710e-02,  1.2961e-01,  ...,  3.4332e-02,
            1.4764e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.1049e-01,  9.5954e-02,  ...,  4.3549e-02,
            1.9052e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.2270e-01,  1.0282e-01,  ...,  7.2312e-02,
            2.0724e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6719e-01,  1.2207e-01,  ...,  9.9992e-02,
            2.0307e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.8313e-02,  1.0699e-01],
         [-7.7413e-02, -1.9542e-02],
         [-7.4907e-02,  9.5978e-02],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.9115e-02,  9.3163e-02],
         [ 1.0718e-01,  1.3937e-01],
         [ 1.1495e-01,  1.2961e-01],
         ...,
         [-1.1049e-01,  5.5231e-02],
         [-1.2270e-01,  5.5231e-02],
         [-1.6719e-01,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.8927e-06, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(1.0046, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4504, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7808, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0598, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1878, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0382, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-4099999.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1799, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.1019e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1052, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3128, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1052, device='cuda:0', grad_fn=<MinBackward1>)
t_env 13184
target_mac_out tensor([[[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2628e-02,  8.9469e-02,  ...,  3.0102e-03,
            1.4021e-01, -1.0000e+07],
          [-1.0000e+07, -7.9562e-02,  1.6132e-01,  ...,  7.4399e-02,
            1.5410e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0256e-01,  1.1214e-01,  ...,  3.4351e-02,
            1.6494e-01, -1.0000e+07],
          [-1.0000e+07, -9.7809e-02,  1.7927e-01,  ...,  8.2650e-02,
            1.6908e-01, -3.2015e-01]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.6031e-02,  7.5137e-02,  ...,  2.7515e-02,
            1.3596e-01, -1.0000e+07],
          [-1.0000e+07, -4.3911e-02,  1.0394e-01,  ...,  3.5068e-02,
            1.5027e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.4866e-02,  8.8302e-02,  ...,  3.5130e-02,
            1.3277e-01, -1.0000e+07],
          [-1.0000e+07, -4.3761e-02,  1.3140e-01,  ...,  1.3962e-02,
            1.5562e-01, -1.0000e+07]],

         ...,

         [[ 5.0025e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4500e-01,  7.2076e-02,  ...,  8.5823e-02,
            1.9917e-01, -3.1873e-01]],

         [[ 5.0011e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3058e-01,  4.1141e-02,  ...,  6.9851e-02,
            1.8198e-01, -3.0862e-01]],

         [[ 5.0010e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 6.2545e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.7167e-02,  1.3964e-01],
         [-8.2628e-02,  1.6132e-01],
         [-1.0256e-01,  1.7927e-01],
         [ 1.3568e-01,  1.8377e-01],
         [-1.3697e-01, -1.4881e-01],
         [-1.0329e-01, -1.7074e-01],
         [-7.9663e-02, -1.8923e-01],
         [-8.9605e-02,  4.2591e-02],
         [-8.8231e-02,  4.9723e-02],
         [-1.3378e-01,  1.2914e-01],
         [-1.1779e-01,  1.1741e-01],
         [-8.7886e-02,  1.0588e-01],
         [-8.0885e-02,  1.0983e-01],
         [-8.8984e-02, -2.3378e-01],
         [-1.0071e-01, -1.9954e-01],
         [-1.2090e-01, -1.8462e-01],
         [-1.3335e-01, -2.0105e-01],
         [-1.3955e-01, -1.8135e-01],
         [-1.1587e-01, -1.9415e-01],
         [-1.0080e-01, -2.0269e-01],
         [-1.1080e-01, -2.1017e-01],
         [-1.2757e-01,  1.7090e-02],
         [-1.4308e-01,  3.8451e-02],
         [ 9.1768e-02,  4.9105e-02],
         [ 7.7574e-02,  5.3764e-02],
         [-1.4580e-01,  5.5471e-02],
         [ 1.0171e-01,  5.5921e-02],
         [ 8.7365e-02,  5.5832e-02],
         [ 1.1783e-01,  5.5660e-02],
         [ 1.4600e-01,  5.5494e-02],
         [ 1.5633e-01,  5.5367e-02],
         [ 1.4541e-01,  5.5300e-02],
         [ 1.5398e-01,  5.5233e-02],
         [ 1.5737e-01,  5.5233e-02],
         [ 1.1474e-01,  5.5204e-02],
         [ 1.2909e-01,  5.5206e-02],
         [ 9.9993e-02,  5.5213e-02],
         [ 1.3045e-01,  5.5209e-02],
         [ 1.3995e-01,  5.5209e-02],
         [ 1.4193e-01,  5.5204e-02],
         [ 1.4157e-01,  5.5220e-02],
         [-1.9836e-01,  5.5223e-02],
         [-1.7180e-01,  5.5232e-02],
         [-1.7259e-01,  5.5230e-02],
         [ 2.3507e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.7167e-02,  1.3964e-01],
         [-6.6031e-02, -4.3911e-02],
         [-5.4866e-02, -4.3761e-02],
         [-7.8504e-02, -4.9676e-02],
         [-9.6718e-02, -4.2930e-02],
         [-1.3760e-01, -5.8500e-02],
         [-1.0600e-01, -5.0519e-02],
         [-1.2163e-01, -3.8413e-02],
         [-1.1336e-01, -4.3535e-02],
         [-1.1855e-01, -4.2940e-02],
         [-1.4861e-01, -4.6997e-02],
         [-1.0763e-01, -3.7470e-02],
         [-1.3561e-01, -4.0042e-02],
         [-1.3843e-01, -2.9640e-02],
         [-1.0493e-01, -2.1097e-02],
         [-1.1318e-01, -2.3066e-02],
         [-1.0380e-01, -2.3494e-02],
         [-9.5722e-02, -3.9419e-02],
         [-1.2751e-01, -3.4216e-02],
         [-1.0745e-01, -3.4357e-02],
         [-9.7812e-02, -4.5835e-02],
         [-1.2322e-01, -5.8536e-02],
         [-1.3918e-01,  1.7804e-01],
         [-9.3882e-02,  1.7731e-01],
         [-7.7410e-02, -1.1004e-01],
         [-8.4540e-02, -1.0237e-01],
         [-9.1202e-02, -9.8715e-02],
         [-8.5228e-02, -9.7553e-02],
         [-1.2570e-01, -9.0236e-02],
         [-1.3281e-01, -1.0484e-01],
         [-1.6017e-01, -9.3322e-02],
         [-1.4545e-01, -8.5528e-02],
         [ 1.0783e-01, -7.6485e-02],
         [ 8.9981e-02, -7.1182e-02],
         [ 1.0457e-01, -6.7933e-02],
         [ 1.1966e-01, -7.7883e-02],
         [ 1.4132e-01, -8.9968e-02],
         [ 1.1771e-01,  1.4154e-01],
         [ 1.0731e-01,  1.7751e-01],
         [ 1.4035e-01,  1.8560e-01],
         [ 1.0787e-01, -1.5728e-01],
         [ 1.3678e-01, -1.5980e-01],
         [ 1.2717e-01, -1.5514e-01],
         [ 1.2491e-01, -1.5224e-01],
         [ 1.2703e-01, -1.4937e-01],
         [ 1.0166e-01, -1.4875e-01],
         [ 1.3426e-01, -1.4891e-01],
         [-2.9412e-02, -1.6143e-01],
         [ 1.3372e-02, -1.6042e-01],
         [ 3.4250e-02, -1.5603e-01],
         [ 4.3864e-02, -1.6787e-01],
         [ 4.8079e-02, -1.8860e-01],
         [ 4.9718e-02, -1.7867e-01],
         [ 5.0206e-02, -1.9128e-01],
         [ 5.0281e-02, -1.9071e-01],
         [ 5.0248e-02, -2.0328e-01],
         [ 5.0160e-02, -2.0454e-01],
         [ 5.0112e-02, -1.7537e-01],
         [ 5.0043e-02, -1.6115e-01],
         [ 5.0010e-02, -1.5116e-01],
         [ 5.0016e-02, -1.5088e-01],
         [ 5.0005e-02, -1.4430e-01],
         [ 5.0018e-02, -1.5082e-01],
         [ 5.0024e-02, -1.3429e-01],
         [ 5.0025e-02, -1.4500e-01],
         [ 5.0011e-02, -1.3058e-01],
         [ 5.0010e-02,  6.2545e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(9.0702e-05, device='cuda:0') tensor(0.0016, device='cuda:0') tensor(-0.0015, device='cuda:0')
mixer_td_error tensor(0.4466, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4516, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4817, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0456, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1447, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0447, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1641790.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1856, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.9847e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1509, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.3020, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1509, device='cuda:0', grad_fn=<MinBackward1>)
t_env 13344
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2552e-02,  8.9544e-02,  ...,  1.4273e-02,
            1.4569e-01, -1.0000e+07],
          [-1.0000e+07, -3.4856e-02,  1.3379e-01,  ...,  3.7416e-02,
            1.4363e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2691e-01,  1.1895e-01,  ...,  4.6424e-02,
            1.6270e-01, -1.0000e+07],
          [-1.0000e+07, -7.7356e-02,  1.6797e-01,  ...,  6.1876e-02,
            1.4804e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0955e-02,  9.6376e-02,  ...,  2.6399e-02,
            1.4271e-01, -1.0000e+07],
          [-1.0000e+07, -7.2934e-02,  1.5417e-01,  ...,  4.7811e-02,
            1.4808e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0311e-01,  1.1141e-01,  ...,  2.1621e-02,
            1.5754e-01, -1.0000e+07],
          [-1.0000e+07, -8.9617e-02,  1.6336e-01,  ...,  4.0046e-02,
            1.5230e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -8.8669e-02,  6.0189e-02,  ...,  2.4557e-02,
            1.7880e-01, -2.7444e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -6.5033e-02,  6.6963e-02,  ..., -2.4444e-03,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5396e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-9.5620e-02, -1.6811e-02],
         [-9.2552e-02, -3.4856e-02],
         [-1.2691e-01, -7.7356e-02],
         [-9.9680e-02, -1.0074e-01],
         [-1.3711e-01, -1.1449e-01],
         [-1.6707e-01, -1.1760e-01],
         [-1.5190e-01, -1.2780e-01],
         [-1.5746e-01, -1.2513e-01],
         [-1.2991e-01, -1.1775e-01],
         [-8.2614e-02, -1.4678e-01],
         [-5.8501e-02, -1.7820e-01],
         [-2.4575e-02, -2.0465e-01],
         [-4.6276e-03, -2.2124e-01],
         [-1.6884e-02, -2.2756e-01],
         [-2.4935e-02, -2.2901e-01],
         [-3.7555e-02, -1.9938e-01],
         [-7.7839e-02, -1.5062e-01],
         [-8.9306e-02, -1.3030e-01],
         [-6.5489e-02, -1.1564e-01],
         [-1.1016e-01, -1.1368e-01],
         [-1.4057e-01, -1.3122e-01],
         [-1.4556e-01, -1.1937e-01],
         [-1.7560e-01, -1.1740e-01],
         [-1.6357e-01, -1.0866e-01],
         [-1.3734e-01, -2.1007e-02],
         [-1.3791e-01,  1.9507e-02],
         [-1.1209e-01,  3.9588e-02],
         [-1.4136e-01,  4.8810e-02],
         [-1.6004e-01,  5.2801e-02],
         [-1.8725e-01,  5.4429e-02],
         [-1.6485e-01,  5.5027e-02],
         [-1.8792e-01,  5.5209e-02],
         [-1.9212e-01,  5.5262e-02],
         [-2.0774e-01,  5.5235e-02],
         [-2.2059e-01,  5.5219e-02],
         [-2.3483e-01,  5.5213e-02],
         [-2.0680e-01,  5.5218e-02],
         [-2.1190e-01,  5.5192e-02],
         [-1.8157e-01,  5.5217e-02],
         [-1.9858e-01,  5.5206e-02],
         [-1.7352e-01,  5.5222e-02],
         [-2.0001e-01,  5.5209e-02],
         [-1.9872e-01,  5.5214e-02],
         [-2.0463e-01,  5.5221e-02],
         [-1.7538e-01,  5.5227e-02],
         [-1.9714e-01,  5.5232e-02],
         [-2.1462e-01,  5.5230e-02],
         [-2.2470e-01,  5.5230e-02],
         [-1.2585e-02,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-4.5201e-02, -4.8984e-02],
         [-8.0955e-02, -7.2934e-02],
         [-1.0311e-01, -8.9617e-02],
         [-8.9801e-02, -1.0620e-01],
         [-7.3362e-02, -1.6103e-01],
         [-9.9132e-02, -1.2958e-01],
         [-8.6352e-02, -1.1940e-01],
         [-4.0292e-02, -1.3008e-01],
         [-3.1657e-02, -1.3052e-01],
         [-4.6874e-02, -1.2778e-01],
         [-5.4948e-02, -1.1566e-01],
         [-5.9344e-02, -1.2343e-01],
         [-9.6241e-02, -9.2707e-02],
         [-8.4752e-02, -7.9717e-02],
         [-8.0186e-02, -7.0822e-02],
         [-8.5503e-02, -7.9447e-02],
         [-9.1664e-02, -8.5559e-02],
         [-7.9822e-02, -8.3901e-02],
         [-7.7020e-02, -8.1515e-02],
         [-4.7250e-02, -7.9856e-02],
         [-4.1615e-02, -7.3980e-02],
         [-3.8851e-02, -7.3446e-02],
         [-5.4559e-02, -5.6861e-02],
         [-4.2897e-02, -6.2289e-02],
         [-5.0209e-02, -7.6442e-02],
         [-6.8733e-02, -8.6023e-02],
         [-5.2377e-02, -8.5245e-02],
         [-8.8006e-02, -8.3794e-02],
         [-9.0182e-02, -7.7043e-02],
         [-1.0662e-01, -7.6793e-02],
         [-1.1724e-01, -6.2220e-02],
         [-1.4261e-01, -7.4541e-02],
         [-1.4767e-01, -8.1974e-02],
         [-1.2710e-01, -8.2736e-02],
         [-1.4258e-01, -1.0008e-01],
         [-9.8645e-02, -1.0608e-01],
         [-7.8047e-02, -1.1198e-01],
         [-8.2763e-02, -1.1188e-01],
         [-1.0084e-01, -1.1192e-01],
         [-1.3170e-01, -1.2294e-01],
         [-1.5629e-01, -1.2472e-01],
         [-1.6500e-01, -1.1437e-01],
         [-1.3229e-01, -1.1595e-01],
         [-9.9465e-02, -1.1931e-01],
         [-7.2232e-02, -1.1175e-01],
         [-8.8991e-02, -8.1085e-02],
         [-9.3185e-02, -6.3373e-02],
         [-8.8833e-02, -9.3663e-02],
         [-9.0793e-02, -6.0957e-02],
         [-8.9553e-02, -4.8562e-02],
         [-1.1771e-01, -5.1514e-02],
         [-1.0645e-01, -7.7902e-02],
         [-1.0969e-01, -6.3430e-02],
         [-1.0558e-01, -9.0950e-02],
         [-9.6599e-02, -9.7564e-02],
         [-1.0824e-01, -1.0451e-01],
         [-1.0571e-01, -1.0400e-01],
         [-1.1356e-01, -1.0461e-01],
         [-1.1122e-01, -9.0635e-02],
         [-1.2771e-01, -9.4453e-02],
         [-1.3161e-01, -1.0296e-01],
         [-1.1634e-01, -1.2402e-01],
         [-1.0327e-01, -1.2780e-01],
         [-1.0967e-01, -1.3295e-01],
         [-1.1707e-01, -1.2927e-01],
         [-1.4776e-01, -1.3224e-01],
         [-1.5884e-01, -1.3867e-01],
         [-1.3361e-01, -1.3116e-01],
         [-1.3682e-01, -1.4519e-01],
         [-1.3877e-01, -1.3564e-01],
         [-1.4446e-01, -1.1634e-01],
         [-1.4470e-01, -1.2278e-01],
         [-1.1853e-01, -1.2497e-01],
         [-1.0965e-01, -1.3184e-01],
         [-9.6796e-02, -1.2503e-01],
         [-1.2322e-01, -1.2140e-01],
         [-1.2669e-01, -1.1929e-01],
         [-1.3281e-01, -1.1464e-01],
         [-1.3838e-01, -9.4881e-02],
         [-1.1269e-01, -8.2500e-02],
         [-1.2535e-01, -8.6208e-02],
         [-1.3052e-01, -1.0734e-01],
         [-1.2055e-01, -9.7280e-02],
         [-1.3018e-01, -7.8633e-02],
         [-1.4728e-01, -6.6499e-02],
         [-1.5841e-01, -2.8713e-02],
         [-1.9075e-01, -2.6350e-02],
         [-2.1493e-01, -2.8654e-02],
         [-2.0730e-01, -7.2274e-02],
         [-2.7231e-01, -9.8508e-02],
         [-2.5845e-01, -9.9599e-02],
         [-2.4254e-01, -8.9593e-02],
         [-2.3255e-01, -4.0795e-02],
         [-1.8284e-01, -3.1081e-02],
         [-1.8042e-01, -2.8685e-02],
         [-1.7097e-01, -2.8838e-02],
         [-1.6311e-01, -2.9290e-02],
         [-1.7856e-01, -2.9426e-02],
         [ 1.6806e-02, -3.1557e-02],
         [ 3.1785e-02, -5.3545e-02],
         [ 4.1312e-02, -2.2993e-02],
         [ 4.6415e-02, -1.9302e-02],
         [ 4.8869e-02, -5.9812e-02],
         [ 4.9890e-02, -6.9647e-02],
         [ 5.0227e-02, -9.4105e-02],
         [ 5.0287e-02, -9.1443e-02],
         [ 5.0260e-02, -1.0704e-01],
         [ 5.0191e-02, -9.8271e-02],
         [ 5.0118e-02, -9.3926e-02],
         [ 5.0090e-02, -1.0715e-01],
         [ 5.0058e-02, -9.8414e-02],
         [ 5.0048e-02, -1.0529e-01],
         [ 5.0029e-02, -1.0977e-01],
         [ 5.0017e-02, -1.3116e-01],
         [ 5.0030e-02, -1.4159e-01],
         [ 5.0016e-02, -1.5741e-01],
         [ 5.0017e-02, -1.6938e-01],
         [ 5.0018e-02, -1.6133e-01],
         [ 5.0005e-02, -1.4244e-01],
         [ 5.0006e-02, -1.3932e-01],
         [ 5.0007e-02, -1.3995e-01],
         [ 5.0008e-02, -1.4594e-01],
         [ 5.0008e-02, -1.3866e-01],
         [ 5.0008e-02, -1.4469e-01],
         [ 5.0008e-02, -1.3508e-01],
         [ 5.0008e-02, -9.5437e-02],
         [ 5.0008e-02, -9.1755e-02],
         [ 5.0008e-02, -9.2725e-02],
         [ 5.0008e-02, -9.5026e-02],
         [ 5.0009e-02, -9.7104e-02],
         [ 5.0009e-02, -9.8620e-02],
         [ 5.0009e-02, -9.9487e-02],
         [ 5.0009e-02, -9.8694e-02],
         [ 5.0009e-02, -9.6575e-02],
         [ 5.0009e-02, -9.5229e-02],
         [ 5.0009e-02, -9.4981e-02],
         [ 5.0009e-02, -1.1622e-01],
         [ 5.0009e-02, -1.2541e-01],
         [ 5.0009e-02, -1.4775e-01],
         [ 5.0009e-02, -1.6364e-01],
         [ 5.0009e-02, -1.7367e-01],
         [ 5.0009e-02, -1.5190e-01],
         [ 5.0009e-02, -1.4308e-01],
         [ 5.0009e-02, -1.5344e-01],
         [ 5.0009e-02, -1.2662e-01],
         [ 5.0009e-02, -7.4172e-02],
         [ 5.0009e-02, -8.8669e-02],
         [ 5.0009e-02, -6.5033e-02],
         [ 5.0009e-02,  5.5396e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.9197e-05, device='cuda:0') tensor(0.0016, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.8330, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4430, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4043, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0438, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1233, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0780, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3355704.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0554, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.2079e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0819, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.3217, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0819, device='cuda:0', grad_fn=<MinBackward1>)
t_env 13426
target_mac_out tensor([[[[-1.0000e+07, -5.3297e-02,  7.5482e-02,  ...,  2.0656e-03,
            1.2204e-01, -1.0000e+07],
          [-1.0000e+07, -1.9084e-02,  9.7086e-02,  ..., -1.3971e-02,
            1.2488e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.6224e-02,  7.6464e-02,  ..., -1.4487e-02,
            1.3461e-01, -1.0000e+07],
          [-1.0000e+07, -5.5813e-02,  1.4715e-01,  ...,  3.3710e-02,
            1.4543e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3246e-02,  8.6054e-02,  ..., -6.5115e-03,
            1.4346e-01, -1.0000e+07],
          [-1.0000e+07, -5.1092e-02,  1.0838e-01,  ...,  2.1315e-02,
            1.5286e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.9656e-01,  7.6700e-02,  ...,  6.4948e-02,
            1.7999e-01, -3.1433e-01],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.9186e-01,  6.6767e-02,  ...,  6.1765e-02,
            1.7582e-01, -3.1218e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.4237e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3068e-01,  1.2738e-01,  ...,  7.1811e-02,
            1.5717e-01, -1.0000e+07],
          [-1.0000e+07, -5.3311e-02,  1.1351e-01,  ...,  4.1523e-02,
            1.4602e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6243e-01,  1.4171e-01,  ...,  8.2421e-02,
            1.7519e-01, -3.7482e-01],
          [-1.0000e+07, -1.0206e-01,  1.6286e-01,  ...,  7.1494e-02,
            1.4458e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.3297e-02, -1.9084e-02],
         [-6.6224e-02, -5.5813e-02],
         [-7.3246e-02, -5.1092e-02],
         [-8.0400e-02, -4.4237e-02],
         [-9.6620e-02, -3.2390e-02],
         [-1.0500e-01, -4.7609e-02],
         [-1.1335e-01, -5.8931e-02],
         [-1.1988e-01, -6.3952e-02],
         [-9.8349e-02, -8.9316e-02],
         [-1.1279e-01, -9.1870e-02],
         [-1.4250e-01, -1.1694e-01],
         [-1.0514e-01, -1.5213e-01],
         [-6.4245e-02, -1.7296e-01],
         [-2.4756e-02, -1.9104e-01],
         [-2.6441e-02, -2.0536e-01],
         [-4.2311e-02, -2.0251e-01],
         [-3.9539e-02, -2.0585e-01],
         [-5.0373e-02, -1.9791e-01],
         [-5.2361e-02, -2.1300e-01],
         [-2.9025e-02, -2.2119e-01],
         [-4.7272e-02, -2.2492e-01],
         [-5.2514e-02, -2.0646e-01],
         [-5.9225e-02, -2.0334e-01],
         [-6.4046e-02, -2.0174e-01],
         [-7.6672e-02, -2.1005e-01],
         [-4.8879e-02, -1.8292e-01],
         [-9.8303e-02, -1.2620e-01],
         [-1.5120e-01, -1.0627e-01],
         [-1.5892e-01, -9.6288e-02],
         [-1.0198e-01, -1.2434e-01],
         [-9.0374e-02,  2.4681e-02],
         [-1.0120e-01,  4.2728e-02],
         [-1.1048e-01,  5.0999e-02],
         [-1.4405e-01,  5.4315e-02],
         [-1.5133e-01,  5.5401e-02],
         [-1.6540e-01,  5.5631e-02],
         [-2.4265e-01,  5.5575e-02],
         [-1.7632e-01,  5.5463e-02],
         [ 8.8367e-02,  5.5388e-02],
         [-1.9621e-01,  5.5282e-02],
         [ 9.6183e-02,  5.5257e-02],
         [-2.7448e-01,  5.5223e-02],
         [ 2.1496e-01,  5.5200e-02],
         [-2.8631e-01,  5.5206e-02],
         [-2.6332e-01,  5.5227e-02],
         [-2.9634e-01,  5.5212e-02],
         [-3.0795e-01,  5.5212e-02],
         [ 7.5822e-02,  5.5211e-02],
         [-3.0814e-01,  5.5222e-02],
         [ 8.5191e-02,  5.5223e-02],
         [-1.9656e-01,  5.5232e-02],
         [-1.9186e-01,  5.5231e-02],
         [-1.4237e-02,  5.5230e-02]],

        [[ 6.2561e-02, -5.4216e-02],
         [ 7.1811e-02, -5.3311e-02],
         [ 8.2421e-02, -1.0206e-01],
         [-1.4670e-01, -1.2888e-01],
         [-1.5940e-01, -1.2246e-01],
         [-1.7303e-01, -1.1318e-01],
         [-1.7331e-01, -1.3130e-01],
         [-1.6486e-01, -1.4177e-01],
         [ 7.9679e-02, -1.5074e-01],
         [ 7.1671e-02, -1.4167e-01],
         [ 6.6467e-02, -1.5306e-01],
         [ 6.0495e-02, -1.6105e-01],
         [ 5.8768e-02, -1.7487e-01],
         [ 8.8676e-02, -1.7457e-01],
         [ 8.4748e-02, -1.7834e-01],
         [ 1.0295e-01, -1.8304e-01],
         [-2.1924e-01, -1.8290e-01],
         [ 7.9296e-02, -1.8767e-01],
         [-2.2817e-01, -1.8207e-01],
         [-2.2692e-01, -1.7570e-01],
         [-2.2510e-01, -1.7676e-01],
         [-2.4116e-01, -1.7126e-01],
         [-2.5867e-01, -1.6493e-01],
         [-2.3424e-01, -1.5972e-01],
         [-2.5017e-01, -1.5877e-01],
         [-2.5729e-01, -1.3750e-01],
         [ 1.5147e-01, -1.2694e-01],
         [ 1.5470e-01, -1.4640e-01],
         [ 1.1084e-01, -1.2975e-01],
         [-2.4037e-01, -8.4421e-03],
         [-2.1008e-01,  2.5825e-02],
         [-1.8614e-01,  4.2677e-02],
         [-2.0894e-01,  5.0398e-02],
         [-2.1679e-01,  5.3661e-02],
         [-2.2346e-01,  5.4913e-02],
         [-2.2701e-01,  5.5314e-02],
         [-2.0326e-01,  5.5408e-02],
         [-2.1068e-01,  5.5381e-02],
         [-2.1638e-01,  5.5321e-02],
         [-2.2187e-01,  5.5292e-02],
         [-2.1755e-01,  5.5244e-02],
         [-2.2937e-01,  5.5216e-02],
         [-2.1913e-01,  5.5235e-02],
         [-2.3627e-01,  5.5230e-02],
         [-3.0787e-02,  5.5219e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(8.9981e-05, device='cuda:0') tensor(0.0032, device='cuda:0') tensor(-0.0022, device='cuda:0')
mixer_td_error tensor(0.2127, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4412, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7315, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0152, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0959, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0869, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-754717., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2150, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0020, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2038, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3188, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2038, device='cuda:0', grad_fn=<MinBackward1>)
t_env 13509
target_mac_out tensor([[[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0050e-01,  1.2417e-01,  ...,  5.1053e-02,
            1.4436e-01, -1.0000e+07],
          [-1.0000e+07, -6.5475e-02,  1.3938e-01,  ...,  4.1959e-02,
            1.4651e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2394e-01,  1.4184e-01,  ...,  6.6640e-02,
            1.5370e-01, -1.0000e+07],
          [-1.0000e+07, -8.6927e-02,  1.1924e-01,  ...,  1.6201e-02,
            1.5117e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.7422e-02,  8.6498e-02,  ...,  2.0309e-02,
            1.2644e-01, -1.0000e+07],
          [-1.0000e+07, -3.4692e-02,  1.3810e-01,  ...,  3.4424e-03,
            1.4959e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.5588e-02,  1.1308e-01,  ...,  3.7493e-02,
            1.5276e-01, -1.0000e+07],
          [-1.0000e+07, -4.4682e-02,  1.1460e-01,  ..., -3.0351e-02,
            1.4642e-01, -1.0000e+07]],

         ...,

         [[ 4.9268e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3213e-01,  7.4714e-02,  ...,  7.7072e-02,
            2.0661e-01, -1.0000e+07]],

         [[ 5.0123e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4517e-01,  8.0839e-02,  ...,  8.8541e-02,
            2.0606e-01, -1.0000e+07]],

         [[ 5.0325e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-5.0453e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.8078e-02, -2.1879e-02],
         [-1.0050e-01, -6.5475e-02],
         [-1.2394e-01, -8.6927e-02],
         [-1.4002e-01, -1.1065e-01],
         [-1.3704e-01, -1.2262e-01],
         [-1.4901e-01, -1.4545e-01],
         [-1.5540e-01,  7.6801e-02],
         [-1.6258e-01,  7.0848e-02],
         [-1.7808e-01,  6.6924e-02],
         [-1.6920e-01,  9.3821e-02],
         [-1.8230e-01,  1.0785e-01],
         [-1.7486e-01,  1.1295e-01],
         [-1.6734e-01,  8.8412e-02],
         [-1.4919e-01, -1.4541e-01],
         [-1.6325e-01, -1.3501e-01],
         [-1.7879e-01, -1.2973e-01],
         [-1.6137e-01, -1.4171e-01],
         [-1.8116e-01, -1.3765e-01],
         [-1.8243e-01, -1.4058e-01],
         [-1.9872e-01, -1.2844e-01],
         [-1.9305e-01, -1.2456e-01],
         [-1.9294e-01, -1.3811e-01],
         [-1.8762e-01, -8.8737e-03],
         [-1.7700e-01,  2.6311e-02],
         [-1.7371e-01,  4.2843e-02],
         [-1.7497e-01,  5.0245e-02],
         [-1.9836e-01,  5.3422e-02],
         [-1.8481e-01,  5.4696e-02],
         [ 2.1479e-01,  5.5140e-02],
         [ 2.0639e-01,  5.5298e-02],
         [ 2.0744e-01,  5.5285e-02],
         [ 2.3561e-01,  5.5224e-02],
         [ 2.2521e-01,  5.5249e-02],
         [-1.9458e-01,  5.5238e-02],
         [ 2.2096e-01,  5.5209e-02],
         [ 2.1739e-01,  5.5215e-02],
         [ 2.2978e-01,  5.5226e-02],
         [ 2.2193e-01,  5.5223e-02],
         [ 2.2664e-01,  5.5227e-02],
         [ 2.2469e-01,  5.5208e-02],
         [-6.4370e-02,  5.5212e-02],
         [-1.6290e-01,  5.5220e-02],
         [-1.7775e-01,  5.5228e-02],
         [-1.9269e-01,  5.5232e-02],
         [-3.1378e-01,  5.5230e-02],
         [-7.3148e-03,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-4.3449e-02, -2.1358e-02],
         [-5.7422e-02, -3.4692e-02],
         [-7.5588e-02, -4.4682e-02],
         [-6.2272e-02, -4.7636e-02],
         [-4.7290e-02, -5.0358e-02],
         [-6.9826e-02, -8.2665e-02],
         [-6.5345e-02, -1.0036e-01],
         [-7.8601e-02, -1.0296e-01],
         [-9.5162e-02, -9.2660e-02],
         [-1.0723e-01, -1.1495e-01],
         [-1.1611e-01, -1.1121e-01],
         [-1.0263e-01, -1.3000e-01],
         [-8.6485e-02, -1.3629e-01],
         [-8.8273e-02, -1.3684e-01],
         [-1.0302e-01, -1.0747e-01],
         [-1.0131e-01, -9.2446e-02],
         [-1.2041e-01, -7.3572e-02],
         [-1.3303e-01, -7.7295e-02],
         [-1.1667e-01, -7.7865e-02],
         [-1.0488e-01, -7.2421e-02],
         [-1.1118e-01, -7.2946e-02],
         [-8.7912e-02, -1.0033e-01],
         [-7.1285e-02, -1.1458e-01],
         [-7.8355e-02, -1.2779e-01],
         [-8.1692e-02, -1.2991e-01],
         [-1.0269e-01, -1.3602e-01],
         [-1.0709e-01, -1.3221e-01],
         [-1.1031e-01, -1.1114e-01],
         [-1.1739e-01, -1.3002e-01],
         [-9.7434e-02, -1.3407e-01],
         [-1.0832e-01, -1.3055e-01],
         [-1.1300e-01, -1.1891e-01],
         [-1.1797e-01, -1.2371e-01],
         [-1.2167e-01, -1.2448e-01],
         [-1.2038e-01, -1.1930e-01],
         [-8.7208e-02, -9.5712e-02],
         [-1.1892e-01, -8.4030e-02],
         [-1.3435e-01,  4.5351e-02],
         [-1.5875e-01,  6.1028e-02],
         [-1.6657e-01,  1.7920e-01],
         [-1.7152e-01,  1.8909e-01],
         [-1.5601e-01, -1.0971e-01],
         [-1.8052e-01, -1.1768e-01],
         [-1.7501e-01,  1.8856e-01],
         [-1.7698e-01, -1.2532e-01],
         [-1.7500e-01, -1.2101e-01],
         [-1.8059e-01, -1.2170e-01],
         [-1.8400e-01, -1.1929e-01],
         [-1.8019e-01, -1.3071e-01],
         [-1.8207e-01, -1.3523e-01],
         [-1.7908e-01, -1.4366e-01],
         [-1.7034e-01, -1.5178e-01],
         [-1.7384e-01,  2.0468e-01],
         [-1.6078e-01,  2.0678e-01],
         [-1.4189e-01, -1.3810e-01],
         [-1.3954e-01, -1.2427e-01],
         [-1.4826e-01, -1.2073e-01],
         [ 2.6120e-03, -1.2622e-01],
         [ 2.8130e-02, -1.0230e-01],
         [ 4.0915e-02, -9.7566e-02],
         [ 4.6766e-02, -1.1446e-01],
         [ 4.9268e-02, -1.3213e-01],
         [ 5.0123e-02, -1.4517e-01],
         [ 5.0325e-02, -5.0453e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-6.6299e-05, device='cuda:0') tensor(0.0017, device='cuda:0') tensor(-0.0034, device='cuda:0')
mixer_td_error tensor(0.3094, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4391, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.2056, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0087, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1074, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1406249.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2356, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(9.2730e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0041, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3222, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2497, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3222, device='cuda:0', grad_fn=<MinBackward1>)
t_env 13589
target_mac_out tensor([[[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.6031e-02,  7.5137e-02,  ...,  2.7515e-02,
            1.3596e-01, -1.0000e+07],
          [-1.0000e+07, -4.3911e-02,  1.0394e-01,  ...,  3.5068e-02,
            1.5027e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.4866e-02,  8.8302e-02,  ...,  3.5130e-02,
            1.3277e-01, -1.0000e+07],
          [-1.0000e+07, -4.3761e-02,  1.3140e-01,  ...,  1.3962e-02,
            1.5562e-01, -1.0000e+07]],

         ...,

         [[ 5.0025e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4500e-01,  7.2076e-02,  ...,  8.5823e-02,
            1.9917e-01, -3.1873e-01]],

         [[ 5.0011e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3058e-01,  4.1141e-02,  ...,  6.9851e-02,
            1.8198e-01, -3.0862e-01]],

         [[ 5.0010e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 6.2545e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9920e-02,  8.5710e-02,  ...,  5.5272e-03,
            1.3493e-01, -1.0000e+07],
          [-1.0000e+07, -6.5448e-02,  1.6176e-01,  ...,  5.0065e-02,
            1.5125e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2028e-01,  1.1613e-01,  ...,  4.0933e-02,
            1.5554e-01, -1.0000e+07],
          [-1.0000e+07, -9.1064e-02,  1.6748e-01,  ...,  4.2100e-02,
            1.5015e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.3939e-01, -5.1416e-02],
         [-6.6031e-02, -4.3911e-02],
         [-5.4866e-02, -4.3761e-02],
         [-7.8504e-02, -4.9676e-02],
         [ 1.6944e-01, -4.2930e-02],
         [ 1.6648e-01, -5.8500e-02],
         [-1.0600e-01, -5.0519e-02],
         [ 1.6604e-01, -3.8413e-02],
         [ 1.6419e-01, -4.3535e-02],
         [ 1.7861e-01,  1.4812e-01],
         [ 1.8222e-01,  1.4080e-01],
         [-9.0189e-02, -3.7470e-02],
         [ 1.6909e-01,  1.4596e-01],
         [ 1.6270e-01, -2.9640e-02],
         [-8.6097e-02, -2.1097e-02],
         [ 1.6854e-01, -2.3066e-02],
         [-8.8475e-02, -2.3494e-02],
         [-8.2203e-02, -3.9419e-02],
         [ 1.7130e-01, -3.4216e-02],
         [-9.1169e-02, -3.4357e-02],
         [-8.4879e-02, -4.5835e-02],
         [ 1.7209e-01, -5.8536e-02],
         [ 1.5556e-01, -8.9897e-02],
         [-1.2951e-01, -1.0164e-01],
         [-7.7410e-02, -1.1004e-01],
         [-8.4540e-02, -1.0237e-01],
         [-9.1202e-02,  2.0474e-01],
         [-8.5228e-02,  2.0557e-01],
         [-1.2570e-01,  2.0881e-01],
         [-1.3281e-01,  2.1724e-01],
         [ 1.7513e-01, -9.3322e-02],
         [-1.4545e-01, -8.5528e-02],
         [ 1.5945e-01, -7.6485e-02],
         [ 1.7570e-01,  1.8630e-01],
         [ 1.7352e-01,  1.8411e-01],
         [-3.3181e-01, -7.7883e-02],
         [ 2.0154e-01, -8.9968e-02],
         [-3.6734e-01, -9.4086e-02],
         [-3.7504e-01, -1.3205e-01],
         [-3.9392e-01, -1.5147e-01],
         [-3.9149e-01, -1.5728e-01],
         [ 1.7607e-01, -1.5980e-01],
         [-4.0368e-01, -1.5514e-01],
         [-1.9848e-01, -1.5224e-01],
         [-1.9052e-01, -1.4937e-01],
         [-1.7789e-01, -1.4875e-01],
         [ 1.3426e-01, -1.4891e-01],
         [-2.9412e-02, -1.6143e-01],
         [ 1.3372e-02, -1.6042e-01],
         [ 3.4250e-02, -1.5603e-01],
         [ 4.3864e-02, -1.6787e-01],
         [ 4.8079e-02,  2.4716e-01],
         [ 4.9718e-02, -1.7867e-01],
         [ 5.0206e-02,  2.4483e-01],
         [ 5.0281e-02,  2.4484e-01],
         [ 5.0248e-02,  2.3173e-01],
         [ 5.0160e-02,  2.4599e-01],
         [ 5.0112e-02, -4.3443e-02],
         [ 5.0043e-02, -6.9130e-02],
         [ 5.0010e-02, -7.2066e-02],
         [ 5.0016e-02, -8.9137e-02],
         [ 5.0005e-02, -1.4430e-01],
         [ 5.0018e-02, -1.5082e-01],
         [ 5.0024e-02, -1.3429e-01],
         [ 5.0025e-02, -1.4500e-01],
         [ 5.0011e-02, -1.3058e-01],
         [ 5.0010e-02,  6.2545e-03]],

        [[-5.8723e-02, -2.2603e-02],
         [-6.9920e-02, -6.5448e-02],
         [ 1.5554e-01, -9.1064e-02],
         [ 1.4321e-01, -1.0974e-01],
         [ 1.3550e-01, -1.2308e-01],
         [ 1.4182e-01, -1.1715e-01],
         [-1.7783e-01,  1.5817e-01],
         [-1.5089e-01,  1.5979e-01],
         [-1.5242e-01, -7.8829e-02],
         [-1.1951e-01, -7.6119e-02],
         [-1.1569e-01,  1.6881e-01],
         [-1.2524e-01,  1.6475e-01],
         [ 1.7168e-01,  1.6966e-01],
         [ 1.6444e-01, -1.3233e-01],
         [-1.7580e-01, -1.3449e-01],
         [-1.8482e-01,  1.6990e-01],
         [-1.9138e-01,  1.7703e-01],
         [-1.7649e-01,  1.7876e-01],
         [-1.7814e-01,  1.8369e-01],
         [-3.7097e-01,  1.8605e-01],
         [-1.9327e-01,  1.7380e-01],
         [-3.4859e-01,  1.7587e-01],
         [-3.6206e-01, -1.9207e-01],
         [-3.6949e-01, -1.9395e-01],
         [-3.7638e-01, -1.9421e-01],
         [-3.7075e-01, -1.9761e-01],
         [-3.8943e-01,  1.7413e-01],
         [-3.5857e-01, -2.0433e-01],
         [-3.6167e-01, -1.9868e-01],
         [-1.0153e-01, -1.8925e-01],
         [-8.3759e-02, -1.8346e-01],
         [-3.3677e-01, -1.7044e-01],
         [-1.1921e-01, -1.6758e-01],
         [-2.9694e-01, -1.6453e-01],
         [-2.6377e-01, -1.7755e-01],
         [ 1.6705e-01, -1.7654e-01],
         [ 7.1060e-02, -2.0064e-01],
         [-2.7711e-01, -1.7474e-01],
         [-3.1154e-01, -1.5647e-01],
         [-3.2002e-01, -1.4486e-01],
         [-1.0570e-01, -1.3722e-01],
         [-9.5968e-02, -1.3570e-01],
         [-8.1036e-02, -1.2046e-01],
         [-3.1719e-01, -1.3131e-01],
         [-7.0639e-02, -1.2134e-01],
         [-8.0167e-02, -1.2254e-01],
         [-1.0161e-02, -1.3216e-01],
         [ 1.9568e-02, -1.3438e-01],
         [ 3.5800e-02, -1.4049e-01],
         [ 4.3969e-02, -7.6278e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-7.8645e-05, device='cuda:0') tensor(0.0020, device='cuda:0') tensor(-0.0047, device='cuda:0')
mixer_td_error tensor(0.2686, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4457, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.0450, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0198, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0824, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1278, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1268656.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2472, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0049, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3639, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3604, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3639, device='cuda:0', grad_fn=<MinBackward1>)
t_env 13816
target_mac_out tensor([[[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1573e-01,  1.1465e-01,  ...,  4.6260e-02,
            1.3400e-01, -1.0000e+07],
          [-1.0000e+07, -8.4494e-02,  1.5393e-01,  ...,  5.1304e-02,
            1.4180e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3487e-01,  1.0452e-01,  ...,  1.5408e-02,
            1.4625e-01, -1.0000e+07],
          [-1.0000e+07, -6.5965e-02,  1.3821e-01,  ...,  1.7464e-02,
            1.4414e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6040e-02,  8.9233e-02,  ...,  1.4820e-02,
            1.4572e-01, -1.0000e+07],
          [-1.0000e+07, -3.0885e-02,  1.0823e-01,  ..., -2.7428e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0028e-02,  6.5961e-02,  ...,  2.1182e-02,
            1.4292e-01, -1.0000e+07],
          [-1.0000e+07, -6.8480e-02,  1.4839e-01,  ...,  2.4421e-02,
            1.4843e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.9878e-01,  1.2526e-01,  ...,  6.3344e-02,
            2.0080e-01, -3.0504e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.9870e-01,  8.5135e-02,  ...,  5.9683e-02,
            1.9056e-01, -3.0818e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 9.4969e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.3737e-01, -5.4216e-02],
         [ 1.3400e-01, -8.4494e-02],
         [ 1.4625e-01, -6.5965e-02],
         [ 1.4684e-01, -9.5346e-02],
         [ 1.5905e-01, -1.2193e-01],
         [ 1.6625e-01, -1.3449e-01],
         [ 1.6921e-01, -1.2878e-01],
         [ 1.5859e-01, -1.2196e-01],
         [ 1.4779e-01,  1.6448e-01],
         [ 1.6115e-01,  1.7032e-01],
         [ 1.5387e-01, -1.3626e-01],
         [ 1.7397e-01,  1.8528e-01],
         [ 1.7490e-01,  2.1720e-01],
         [ 1.9846e-01,  2.1722e-01],
         [ 1.6209e-01,  1.9369e-01],
         [ 1.8615e-01,  2.0113e-01],
         [ 1.7404e-01,  2.1765e-01],
         [-1.6856e-01,  2.0943e-01],
         [-2.0509e-01, -1.6422e-01],
         [ 1.2818e-01, -1.4930e-01],
         [ 1.0980e-01, -1.5284e-01],
         [ 1.5904e-01,  1.7811e-01],
         [ 1.4793e-01, -1.4467e-01],
         [ 1.6641e-01,  1.7142e-01],
         [ 1.3439e-01,  1.6635e-01],
         [-3.6841e-01,  1.7842e-01],
         [ 1.2031e-01,  1.8485e-01],
         [ 1.3740e-01,  1.7825e-01],
         [ 1.1413e-01, -1.8445e-01],
         [ 9.4111e-02, -1.8579e-01],
         [ 1.4518e-01, -1.7103e-01],
         [ 1.3156e-01, -1.7053e-01],
         [ 1.5144e-01, -1.6829e-01],
         [ 1.2895e-01, -1.6594e-01],
         [ 1.4324e-01, -1.6669e-01],
         [ 1.3772e-01, -1.6355e-01],
         [ 9.5378e-02, -1.6762e-01],
         [ 1.2147e-01, -1.5105e-01],
         [ 1.1460e-01, -1.3680e-01],
         [ 1.3957e-02, -1.4068e-01],
         [ 2.9957e-02, -1.4370e-01],
         [ 4.0564e-02, -1.4292e-01],
         [ 4.6118e-02, -1.3906e-01],
         [ 4.8698e-02, -1.3943e-01],
         [ 4.9705e-02, -1.4897e-01],
         [ 5.0018e-02, -1.5775e-01],
         [ 5.0105e-02, -4.3502e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.4019e-01, -1.1117e-02],
         [ 1.4572e-01,  1.3284e-01],
         [-8.0028e-02, -6.8480e-02],
         [ 1.5713e-01, -9.3499e-02],
         [ 1.4681e-01, -9.2967e-02],
         [ 1.3516e-01, -7.7038e-02],
         [ 1.5529e-01,  1.9233e-01],
         [ 1.6075e-01,  2.0819e-01],
         [ 1.8418e-01,  2.0160e-01],
         [ 2.0397e-01,  2.0615e-01],
         [-6.4468e-02,  1.9655e-01],
         [-7.2806e-02,  2.1117e-01],
         [ 1.9875e-01, -1.4648e-01],
         [-1.1530e-01,  2.2575e-01],
         [-9.0097e-02, -1.7978e-01],
         [ 1.8109e-01,  2.1156e-01],
         [-1.0914e-01,  2.3062e-01],
         [-9.3204e-02,  2.1832e-01],
         [-7.5611e-02,  2.4608e-01],
         [-8.0584e-02,  2.3408e-01],
         [-8.2229e-02,  2.3522e-01],
         [ 1.8947e-01,  2.5055e-01],
         [-1.2211e-01,  2.5850e-01],
         [-9.4819e-02,  2.3710e-01],
         [ 1.8185e-01,  2.5225e-01],
         [-1.3269e-01,  2.3634e-01],
         [-1.3579e-01,  2.4663e-01],
         [-1.0993e-01,  2.1937e-01],
         [-1.3805e-01,  2.2128e-01],
         [-1.0577e-01,  2.2629e-01],
         [-9.4655e-02, -1.4061e-02],
         [-1.2243e-01,  2.4141e-02],
         [-1.4231e-01,  4.2475e-02],
         [-1.2413e-01,  5.0765e-02],
         [-1.4395e-01,  5.4220e-02],
         [-1.5569e-01,  5.5444e-02],
         [ 1.9222e-01,  5.5766e-02],
         [ 1.7685e-01,  5.5689e-02],
         [ 1.9497e-01,  5.5571e-02],
         [ 1.7936e-01,  5.5426e-02],
         [ 1.8528e-01,  5.5348e-02],
         [ 1.7943e-01,  5.5268e-02],
         [ 2.0845e-01,  5.5250e-02],
         [ 2.2078e-01,  5.5207e-02],
         [ 1.2092e-01,  5.5223e-02],
         [ 2.0180e-01,  5.5218e-02],
         [ 1.9404e-01,  5.5202e-02],
         [ 1.0294e-01,  5.5207e-02],
         [ 7.7280e-02,  5.5208e-02],
         [ 2.0007e-01,  5.5222e-02],
         [ 1.9383e-01,  5.5231e-02],
         [ 7.7287e-02,  5.5229e-02],
         [ 2.0080e-01,  5.5230e-02],
         [ 1.9056e-01,  5.5230e-02],
         [ 9.4969e-03,  5.5232e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0002, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0031, device='cuda:0')
mixer_td_error tensor(0.0898, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4513, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6349, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0172, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1023, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1022, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-727272.5625, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2585, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0018, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3495, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2976, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3495, device='cuda:0', grad_fn=<MinBackward1>)
t_env 13924
target_mac_out tensor([[[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1792e-01,  1.2989e-01,  ...,  5.6814e-02,
            1.5398e-01, -1.0000e+07],
          [-1.0000e+07, -7.6477e-02,  1.2250e-01,  ...,  2.6030e-02,
            1.4386e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3470e-01,  1.4601e-01,  ...,  7.0606e-02,
            1.5992e-01, -1.0000e+07],
          [-1.0000e+07, -9.3509e-02,  1.1277e-01,  ...,  7.2643e-03,
            1.4689e-01, -1.0000e+07]],

         ...,

         [[ 5.0014e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4930e-01,  7.8315e-02,  ...,  5.5850e-02,
            2.0188e-01, -3.1472e-01]],

         [[ 5.0016e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4101e-01,  4.2575e-02,  ...,  5.0297e-02,
            1.8592e-01, -3.0779e-01]],

         [[ 5.0022e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.8678e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3800e-01,  1.2388e-01,  ...,  7.1672e-02,
            1.5794e-01, -1.0000e+07],
          [-1.0000e+07, -3.6944e-02,  1.3613e-01,  ...,  2.6084e-02,
            1.4526e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4059e-01,  1.1527e-01,  ...,  5.1771e-02,
            1.4916e-01, -1.0000e+07],
          [-1.0000e+07, -5.2102e-02,  1.4520e-01,  ...,  1.0361e-02,
            1.5391e-01, -1.0000e+07]],

         ...,

         [[ 5.0019e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4330e-01,  6.4623e-02,  ...,  5.7835e-02,
            1.9229e-01, -3.0572e-01]],

         [[ 5.0006e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6476e-01,  7.6416e-02,  ...,  7.9166e-02,
            2.1597e-01, -3.2371e-01]],

         [[ 5.0007e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.3816e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 0.1394,  0.1381],
         [ 0.1540,  0.1439],
         [ 0.1599,  0.1128],
         [ 0.1628,  0.1564],
         [ 0.1435,  0.1521],
         [ 0.1578,  0.1671],
         [ 0.1678,  0.1697],
         [ 0.1129,  0.1994],
         [ 0.1287,  0.1955],
         [ 0.1216,  0.2095],
         [ 0.1357,  0.2188],
         [ 0.1977,  0.1526],
         [ 0.1954,  0.1724],
         [ 0.1319,  0.1853],
         [ 0.1302,  0.1880],
         [ 0.1308,  0.1970],
         [ 0.1997,  0.0914],
         [ 0.1780,  0.1375],
         [ 0.1603,  0.1090],
         [ 0.1734,  0.1172],
         [ 0.1700,  0.1209],
         [ 0.1340,  0.1028],
         [ 0.1849,  0.1013],
         [ 0.1894,  0.1564],
         [ 0.1543,  0.1365],
         [ 0.0069,  0.1884],
         [ 0.0305,  0.1935],
         [ 0.0426,  0.2090],
         [ 0.0480,  0.1989],
         [ 0.0501,  0.1980],
         [ 0.0507,  0.2060],
         [ 0.0508,  0.2086],
         [ 0.0506,  0.2106],
         [ 0.0504,  0.2202],
         [ 0.0503,  0.2077],
         [ 0.0502,  0.2139],
         [ 0.0501,  0.1102],
         [ 0.0501,  0.0907],
         [ 0.0500,  0.0987],
         [ 0.0500,  0.2223],
         [ 0.0500,  0.0933],
         [ 0.0500,  0.0901],
         [ 0.0500,  0.0783],
         [ 0.0500,  0.1859],
         [ 0.0500,  0.0029]],

        [[ 0.1402,  0.1232],
         [ 0.1579,  0.1453],
         [ 0.1492,  0.1539],
         [ 0.1633,  0.1543],
         [ 0.1641,  0.1752],
         [ 0.1707,  0.1619],
         [ 0.1668,  0.1578],
         [ 0.1781,  0.1758],
         [ 0.1969,  0.1801],
         [ 0.1926,  0.1219],
         [ 0.2081,  0.1738],
         [ 0.1967,  0.1012],
         [ 0.1894,  0.1072],
         [ 0.1863,  0.1131],
         [ 0.1889,  0.1169],
         [ 0.1485,  0.1563],
         [ 0.1792,  0.1268],
         [ 0.1345,  0.1640],
         [ 0.1830,  0.1848],
         [ 0.1332,  0.1887],
         [ 0.1394,  0.1543],
         [ 0.0398,  0.1699],
         [ 0.0018, -0.1462],
         [ 0.0298,  0.2232],
         [ 0.0429,  0.2053],
         [ 0.0484,  0.0793],
         [ 0.0503,  0.2016],
         [ 0.0507,  0.0547],
         [ 0.0507,  0.0920],
         [ 0.0505,  0.2193],
         [ 0.0503,  0.0808],
         [ 0.0502,  0.2446],
         [ 0.0501,  0.2238],
         [ 0.0501,  0.0844],
         [ 0.0500,  0.0661],
         [ 0.0500,  0.0784],
         [ 0.0500,  0.2485],
         [ 0.0500,  0.0633],
         [ 0.0500,  0.2399],
         [ 0.0500,  0.2200],
         [ 0.0500,  0.1994],
         [ 0.0500,  0.1825],
         [ 0.0500,  0.0646],
         [ 0.0500,  0.2160],
         [ 0.0500, -0.0138]]], device='cuda:0', grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-8.4084e-05, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0026, device='cuda:0')
mixer_td_error tensor(-0.0293, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.3318, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4468, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0046, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0775, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0830, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(0.1279, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2485, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1462, device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.9855e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(3.6526e-09, device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(0.1051, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2933, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1051, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2933, device='cuda:0', grad_fn=<MinBackward1>)
t_env 13972
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9711e-02,  8.6010e-02,  ...,  5.5065e-03,
            1.3727e-01, -1.0000e+07],
          [-1.0000e+07, -4.5321e-02,  1.0753e-01,  ...,  3.5616e-02,
            1.4810e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3339e-02,  9.1828e-02,  ...,  2.0462e-03,
            1.4069e-01, -1.0000e+07],
          [-1.0000e+07, -7.9815e-02,  1.4915e-01,  ...,  6.6216e-02,
            1.5396e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.5231e-01, -1.0000e+07,  ...,  5.0563e-02,
           -1.0000e+07, -2.4795e-01],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.5209e-01, -1.0000e+07,  ...,  4.3539e-02,
           -1.0000e+07, -2.3541e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.6921e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3011e-02,  8.5302e-02,  ...,  4.7299e-02,
            1.3351e-01, -1.0000e+07],
          [-1.0000e+07, -8.3580e-02,  1.5949e-01,  ...,  7.7397e-02,
            1.5469e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0035e-02,  7.8002e-02,  ...,  4.0203e-02,
            1.2817e-01, -1.0000e+07],
          [-1.0000e+07, -9.1473e-02,  1.2838e-01,  ...,  3.2495e-02,
            1.6125e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.4276e-02,  1.4162e-01],
         [ 8.6010e-02,  1.0753e-01],
         [ 9.1828e-02,  1.4915e-01],
         [ 1.0444e-01,  1.6115e-01],
         [ 8.1765e-02,  1.7010e-01],
         [ 9.0029e-02,  1.4649e-01],
         [ 1.1421e-01,  1.0467e-01],
         [ 8.0933e-02,  1.2112e-01],
         [ 9.2055e-02,  1.3186e-01],
         [ 8.4177e-02,  1.1291e-01],
         [ 9.5572e-02,  1.2795e-01],
         [ 6.3941e-02,  1.0724e-01],
         [ 1.4329e-01,  9.9236e-02],
         [ 1.7788e-01,  7.2083e-02],
         [ 1.9528e-01,  5.9652e-02],
         [ 1.9432e-01,  7.4247e-02],
         [ 1.9608e-01,  3.9824e-02],
         [ 1.9773e-01,  7.4032e-02],
         [ 1.2350e-01,  8.4755e-02],
         [ 1.3306e-01,  4.3521e-02],
         [ 1.3041e-01,  7.4428e-02],
         [ 1.4218e-01,  8.5723e-02],
         [ 1.4388e-01,  2.6814e-01],
         [ 1.4179e-01,  2.6601e-01],
         [ 1.3621e-01,  2.3489e-01],
         [ 1.3474e-01,  2.5791e-01],
         [ 1.0183e-01,  1.1306e-01],
         [ 1.1285e-01,  1.5033e-01],
         [ 9.4342e-02,  1.4517e-01],
         [ 8.4264e-02, -2.3395e-02],
         [ 7.1114e-02,  1.9335e-02],
         [ 6.7057e-02,  4.0051e-02],
         [ 1.0769e-01,  4.9306e-02],
         [ 7.4508e-02,  5.3164e-02],
         [ 1.0000e-01,  5.4641e-02],
         [ 1.1326e-01,  5.5132e-02],
         [ 8.5007e-02,  5.5265e-02],
         [ 1.2458e-01,  5.5261e-02],
         [ 1.2883e-01,  5.5249e-02],
         [ 8.6796e-02,  5.5220e-02],
         [ 1.0732e-01,  5.5210e-02],
         [ 1.3785e-01,  5.5211e-02],
         [ 5.9416e-02,  5.5218e-02],
         [ 5.6236e-02,  5.5214e-02],
         [ 1.3241e-01,  5.5193e-02],
         [ 9.0256e-02,  5.5215e-02],
         [ 1.1013e-01,  5.5212e-02],
         [ 5.3809e-02,  5.5203e-02],
         [ 1.2611e-01,  5.5221e-02],
         [ 6.4353e-02,  5.5227e-02],
         [-2.4795e-01,  5.5232e-02],
         [-2.3541e-01,  5.5230e-02],
         [ 3.6921e-03,  5.5230e-02]],

        [[ 1.1386e-01,  1.4136e-01],
         [ 8.5302e-02,  1.5949e-01],
         [ 7.8002e-02,  1.2838e-01],
         [ 1.1232e-01,  1.3565e-01],
         [ 1.0642e-01,  1.5668e-01],
         [ 1.3544e-01,  1.6352e-01],
         [ 1.3959e-01,  1.3349e-01],
         [ 1.3447e-01,  1.0802e-01],
         [ 1.5084e-01,  1.3931e-01],
         [ 1.2846e-01,  1.2154e-01],
         [ 1.3975e-01,  1.3081e-01],
         [ 1.3557e-01,  1.0657e-01],
         [ 1.3442e-01,  9.3321e-02],
         [ 1.4762e-01,  8.7857e-02],
         [ 1.6755e-01,  9.0569e-02],
         [ 1.3888e-01,  1.0355e-01],
         [ 1.0996e-01,  1.2434e-01],
         [ 1.5552e-01,  1.3217e-01],
         [ 1.2878e-01,  1.3385e-01],
         [ 1.4660e-01,  1.2502e-01],
         [ 1.2377e-01,  9.5403e-02],
         [ 1.1216e-01,  1.0181e-01],
         [ 1.3138e-01,  8.4058e-02],
         [ 9.2004e-02,  7.3707e-02],
         [ 1.1616e-01,  9.5058e-02],
         [ 1.0192e-01, -1.1101e-02],
         [ 1.0965e-01,  2.6444e-02],
         [ 1.3307e-01,  4.3606e-02],
         [ 8.3517e-02,  5.1050e-02],
         [ 1.0754e-01,  5.4063e-02],
         [ 7.6421e-02,  5.5156e-02],
         [ 6.2273e-02,  5.5470e-02],
         [ 7.1631e-02,  5.5476e-02],
         [ 9.1042e-02,  5.5380e-02],
         [ 1.0280e-01,  5.5320e-02],
         [ 1.2244e-01,  5.5268e-02],
         [ 1.3275e-01,  5.5237e-02],
         [ 8.8606e-02,  5.5215e-02],
         [ 1.2092e-01,  5.5205e-02],
         [ 1.2078e-01,  5.5220e-02],
         [ 1.4391e-01,  5.5217e-02],
         [ 1.5036e-01,  5.5221e-02],
         [ 1.1015e-01,  5.5202e-02],
         [ 8.5368e-02,  5.5219e-02],
         [ 1.2297e-01,  5.5223e-02],
         [ 9.4978e-02,  5.5231e-02],
         [ 9.0813e-02,  5.5231e-02],
         [ 1.0092e-01,  5.5230e-02],
         [-9.2490e-04,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.0637e-05, device='cuda:0') tensor(0.0020, device='cuda:0') tensor(-0.0017, device='cuda:0')
mixer_td_error tensor(0.1187, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4786, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4857, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0399, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1468, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0707, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-377358.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2681, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(9.0131e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3017, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2504, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3017, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14019
target_mac_out tensor([[[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7175e-02,  8.1043e-02,  ...,  2.3772e-02,
            1.2601e-01, -1.0000e+07],
          [-1.0000e+07, -3.0851e-02,  1.2640e-01,  ...,  1.8911e-02,
            1.4901e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.1041e-02,  8.0018e-02,  ..., -7.0601e-04,
            1.3470e-01, -1.0000e+07],
          [-1.0000e+07, -6.5586e-02,  1.4954e-01,  ...,  4.8926e-02,
            1.5883e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0168e-01,  1.0701e-01,  ...,  2.1245e-02,
            1.6130e-01, -1.0000e+07],
          [-1.0000e+07, -3.0121e-02,  1.3401e-01,  ..., -3.1575e-03,
            1.4619e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.8083e-02,  1.0329e-01,  ...,  1.5112e-02,
            1.5348e-01, -1.0000e+07],
          [-1.0000e+07, -4.6897e-02,  1.4437e-01,  ...,  1.5678e-02,
            1.5861e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.9187e-01,  1.2048e-01,  ...,  5.4317e-02,
            1.6687e-01, -3.1466e-01],
          [ 5.5236e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.0672e-01,  1.2540e-01,  ...,  7.5335e-02,
            1.8208e-01, -3.2970e-01],
          [ 5.5236e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.1773e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 5.8068e-02,  1.0699e-01],
         [ 8.1043e-02,  1.2640e-01],
         [ 8.0018e-02,  1.4954e-01],
         [ 8.7481e-02,  1.5612e-01],
         [ 8.6669e-02,  1.0094e-01],
         [ 9.0491e-02,  1.0211e-01],
         [ 1.0580e-01,  8.6786e-02],
         [ 1.0376e-01,  6.9760e-02],
         [ 1.1349e-01,  1.2109e-01],
         [ 1.2588e-01,  1.2497e-01],
         [ 1.3629e-01,  8.9665e-02],
         [ 1.3259e-01,  9.7514e-02],
         [ 1.1578e-01,  1.1740e-01],
         [ 1.2220e-01,  1.3861e-01],
         [ 1.3780e-01,  1.2534e-01],
         [ 1.3741e-01,  1.1364e-01],
         [ 1.1221e-01,  1.2282e-01],
         [ 1.3569e-01,  1.0029e-01],
         [ 1.5210e-01,  1.4274e-01],
         [ 1.3708e-01,  1.1761e-01],
         [ 1.6772e-01,  1.4365e-01],
         [ 1.4498e-01,  1.1379e-01],
         [ 1.6518e-01,  1.3629e-01],
         [ 1.7584e-01,  1.2137e-01],
         [ 1.7664e-01,  8.6736e-02],
         [ 1.7651e-01,  6.6371e-02],
         [ 1.5181e-01,  5.1097e-02],
         [ 1.7872e-01,  9.3367e-02],
         [ 1.8170e-01,  5.8612e-02],
         [ 1.4479e-01,  4.8069e-02],
         [ 1.5535e-01,  5.2758e-02],
         [-7.9528e-03,  3.8704e-02],
         [ 1.8652e-02,  5.5716e-02],
         [ 3.4414e-02,  4.5286e-02],
         [ 4.2669e-02,  7.6256e-02],
         [ 4.6747e-02,  5.2870e-02],
         [ 4.8666e-02,  4.3256e-02],
         [ 4.9528e-02,  7.1479e-02],
         [ 4.9877e-02,  9.8945e-02],
         [ 5.0008e-02,  5.6274e-02],
         [ 5.0032e-02,  9.3015e-02],
         [ 5.0043e-02,  6.3838e-02],
         [ 5.0025e-02,  7.9048e-02],
         [ 5.0034e-02,  1.3122e-01],
         [ 5.0048e-02,  8.6191e-02],
         [ 5.0029e-02,  8.3652e-02],
         [ 5.0028e-02,  5.7999e-02],
         [ 5.0022e-02,  7.9044e-02],
         [ 5.0021e-02,  6.4470e-02],
         [ 5.0014e-02,  3.6441e-02],
         [ 5.0012e-02,  3.0082e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.4778e-02,  1.0692e-01],
         [ 1.0701e-01,  1.3401e-01],
         [ 1.0329e-01,  1.4437e-01],
         [ 1.0908e-01,  1.0850e-01],
         [ 8.8958e-02,  1.3872e-01],
         [ 7.8842e-02,  1.2641e-01],
         [ 9.7559e-02,  1.1327e-01],
         [ 7.3277e-02,  1.4921e-01],
         [ 8.5547e-02,  1.0212e-01],
         [ 1.0861e-01,  1.1428e-01],
         [ 1.0135e-01,  1.0059e-01],
         [ 1.1634e-01,  8.4385e-02],
         [ 1.1733e-01,  1.2015e-01],
         [ 1.2534e-01,  1.0827e-01],
         [ 9.4644e-02,  1.1622e-01],
         [ 1.0607e-01,  1.3830e-01],
         [ 1.0770e-01,  1.6438e-01],
         [ 1.3016e-01,  1.6786e-01],
         [ 1.1887e-01,  1.6851e-01],
         [ 1.0104e-01,  1.7971e-01],
         [ 1.2868e-01,  1.9276e-01],
         [ 1.2743e-01,  1.5821e-01],
         [ 1.4490e-01,  1.2841e-01],
         [ 1.4664e-01,  1.6958e-01],
         [ 1.4899e-01,  1.3396e-01],
         [ 1.7412e-01,  1.7461e-01],
         [ 1.6197e-01,  1.8496e-01],
         [ 1.3326e-01,  1.8420e-01],
         [ 1.2878e-01,  1.8324e-01],
         [ 9.6378e-02,  1.3822e-01],
         [ 8.7475e-02,  1.5817e-01],
         [ 1.2536e-01,  1.7240e-01],
         [ 1.6790e-01,  1.5582e-01],
         [ 1.3074e-01,  1.3008e-01],
         [ 8.4087e-02,  1.5481e-01],
         [ 1.0324e-01,  1.1347e-01],
         [ 1.0847e-01,  1.2327e-01],
         [ 1.3394e-01,  1.2670e-01],
         [ 9.4271e-02, -1.1012e-03],
         [ 7.7382e-02,  3.0963e-02],
         [ 1.1069e-01,  4.5538e-02],
         [ 1.4921e-01,  5.1784e-02],
         [ 1.0974e-01,  5.4247e-02],
         [ 1.1139e-01,  5.5128e-02],
         [ 1.0373e-01,  5.5349e-02],
         [ 7.1114e-02,  5.5386e-02],
         [ 7.1325e-02,  5.5324e-02],
         [ 8.9880e-02,  5.5279e-02],
         [ 9.4628e-02,  5.5260e-02],
         [ 1.0651e-01,  5.5237e-02],
         [ 1.2546e-01,  5.5204e-02],
         [ 1.4884e-01,  5.5228e-02],
         [ 1.0731e-01,  5.5226e-02],
         [ 8.7933e-02,  5.5212e-02],
         [ 1.1500e-01,  5.5221e-02],
         [ 1.1564e-01,  5.5214e-02],
         [ 1.2283e-01,  5.5220e-02],
         [ 1.6551e-01,  5.5221e-02],
         [ 1.3584e-01,  5.5230e-02],
         [ 1.1851e-01,  5.5231e-02],
         [ 1.1183e-01,  5.5230e-02],
         [ 1.1045e-01,  5.5230e-02],
         [ 1.2282e-01,  5.5232e-02],
         [ 1.2048e-01,  5.5236e-02],
         [ 1.2540e-01,  5.5236e-02],
         [ 1.1773e-02,  5.5232e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.6420e-05, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0015, device='cuda:0')
mixer_td_error tensor(0.2686, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5541, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3763, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0518, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1739, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0504, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1136363.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1928, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.5266e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1885, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0428, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1885, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14064
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1402e-02,  8.1983e-02,  ...,  3.9429e-02,
            1.3744e-01, -1.0000e+07],
          [-1.0000e+07, -3.2219e-02,  9.6327e-02,  ..., -1.4636e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2918e-02,  8.3033e-02,  ...,  1.5905e-03,
            1.3806e-01, -1.0000e+07],
          [-1.0000e+07, -4.3941e-02,  1.2828e-01,  ...,  1.4506e-02,
            1.4886e-01, -1.0000e+07]],

         ...,

         [[ 5.0062e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1756e-01,  6.2249e-02,  ...,  7.2620e-02,
            1.8534e-01, -1.0000e+07]],

         [[ 5.0040e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3118e-01,  7.9832e-02,  ...,  8.7176e-02,
            1.9510e-01, -1.0000e+07]],

         [[ 5.0049e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.4158e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2714e-01,  1.2420e-01,  ...,  7.0546e-02,
            1.5857e-01, -1.0000e+07],
          [-1.0000e+07, -3.8311e-02,  1.3382e-01,  ...,  4.0568e-02,
            1.4396e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4124e-01,  1.2148e-01,  ...,  5.2743e-02,
            1.5640e-01, -1.0000e+07],
          [-1.0000e+07, -4.4101e-02,  1.1387e-01,  ...,  3.1959e-02,
            1.4699e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 8.1983e-02,  9.6327e-02],
         [ 8.3033e-02,  1.2828e-01],
         [ 1.0533e-01,  1.0682e-01],
         [ 1.2478e-01,  1.0456e-01],
         [ 1.2572e-01,  9.7676e-02],
         [ 9.9773e-02,  9.3238e-02],
         [ 9.5603e-02,  8.2896e-02],
         [ 1.3167e-01,  7.8768e-02],
         [ 1.1572e-01,  1.0789e-01],
         [ 1.2173e-01,  1.1981e-01],
         [ 1.3246e-01,  1.0872e-01],
         [ 1.3294e-01,  1.2250e-01],
         [ 1.0211e-01,  1.3508e-01],
         [ 1.2021e-01,  1.3824e-01],
         [ 1.6550e-01,  1.0451e-01],
         [ 1.6955e-01,  1.2367e-01],
         [ 1.5445e-01,  8.8586e-02],
         [ 1.5267e-01,  6.7699e-02],
         [ 1.2238e-01,  9.6506e-02],
         [ 1.4503e-01,  1.5559e-01],
         [ 1.7699e-01,  1.8252e-01],
         [ 2.1308e-01,  1.5478e-01],
         [ 2.2450e-01,  1.1553e-01],
         [ 1.7363e-01,  9.4386e-02],
         [ 1.5799e-01,  6.8230e-02],
         [ 1.4927e-01,  9.1177e-02],
         [ 1.5257e-01,  1.2554e-01],
         [ 1.6329e-01,  1.0859e-01],
         [ 1.6940e-01,  1.4631e-01],
         [ 1.8631e-01,  1.4684e-01],
         [ 1.5079e-01,  1.6469e-01],
         [ 1.5646e-01,  1.4066e-01],
         [ 1.5936e-01,  1.0854e-01],
         [ 1.6924e-01,  1.3301e-01],
         [ 1.3913e-01,  1.0097e-01],
         [ 1.6944e-01,  1.0643e-01],
         [ 1.4515e-01,  1.1705e-01],
         [ 1.6190e-01,  1.2454e-01],
         [ 1.7382e-01,  1.3215e-01],
         [ 1.8228e-01,  1.5498e-01],
         [ 1.8840e-01,  1.2613e-01],
         [ 1.8909e-01,  1.5074e-01],
         [ 1.6448e-01,  1.2795e-01],
         [ 1.2279e-01,  9.6963e-02],
         [ 1.3814e-01,  9.5225e-02],
         [ 1.3328e-01,  7.6364e-02],
         [ 1.3287e-01,  8.2771e-02],
         [ 1.0036e-01,  1.1918e-01],
         [-2.8213e-01,  8.5093e-02],
         [-2.6737e-01,  4.1538e-02],
         [-2.5323e-01,  6.9637e-02],
         [-2.4693e-01,  6.7282e-02],
         [ 8.9698e-02,  7.9863e-02],
         [ 2.8518e-02,  8.8000e-02],
         [ 5.3851e-03,  1.0424e-01],
         [ 3.0878e-02,  9.4957e-02],
         [ 4.3042e-02,  1.0807e-01],
         [ 4.8367e-02,  6.9204e-02],
         [ 5.0411e-02,  9.3065e-02],
         [ 5.0932e-02,  4.8609e-02],
         [ 5.0872e-02,  8.3471e-02],
         [ 5.0672e-02,  8.2326e-02],
         [ 5.0470e-02,  7.9445e-02],
         [ 5.0299e-02,  3.7831e-02],
         [ 5.0180e-02,  1.9140e-02],
         [ 5.0109e-02,  1.3306e-02],
         [ 5.0062e-02,  6.2249e-02],
         [ 5.0040e-02,  7.9832e-02],
         [ 5.0049e-02,  4.4158e-03]],

        [[ 1.0780e-01,  8.9914e-02],
         [ 1.2420e-01,  1.3382e-01],
         [ 1.2148e-01,  1.1387e-01],
         [ 1.0986e-01,  1.4507e-01],
         [ 1.0952e-01,  8.9419e-02],
         [ 1.2025e-01,  6.3407e-02],
         [ 1.4318e-01,  3.2814e-02],
         [ 1.5263e-01,  7.3579e-02],
         [ 1.0886e-01,  4.0443e-02],
         [ 1.2477e-01,  6.7225e-02],
         [ 9.5833e-02,  8.9611e-02],
         [ 1.3488e-01,  9.8538e-02],
         [ 1.1366e-01,  1.0190e-01],
         [ 1.2369e-01,  6.3696e-02],
         [ 1.1317e-01,  1.0651e-01],
         [ 1.3141e-01,  1.1024e-01],
         [ 1.3784e-01,  1.1873e-01],
         [ 1.3961e-01,  1.1539e-01],
         [ 9.0794e-02,  1.1476e-01],
         [ 1.1373e-01,  7.9695e-02],
         [ 1.1599e-01,  5.7161e-02],
         [ 7.8411e-02,  9.2768e-02],
         [ 3.3602e-03,  1.0712e-01],
         [ 2.9334e-02,  1.1335e-01],
         [ 4.1687e-02,  1.1630e-01],
         [ 4.7262e-02,  8.2573e-02],
         [ 4.9526e-02,  6.1770e-02],
         [ 5.0302e-02,  9.7265e-02],
         [ 5.0450e-02,  8.3062e-02],
         [ 5.0377e-02,  7.4437e-02],
         [ 5.0258e-02,  4.3653e-02],
         [ 5.0170e-02,  7.3025e-02],
         [ 5.0082e-02,  5.5007e-02],
         [ 5.0056e-02,  6.7122e-02],
         [ 5.0041e-02,  3.3955e-02],
         [ 5.0034e-02,  6.6691e-02],
         [ 5.0018e-02,  6.6342e-02],
         [ 5.0013e-02,  9.2782e-02],
         [ 5.0012e-02,  9.0262e-02],
         [ 5.0011e-02,  4.7279e-02],
         [ 5.0013e-02,  7.4254e-02],
         [ 5.0014e-02,  4.3679e-02],
         [ 5.0016e-02,  7.3899e-02],
         [ 5.0008e-02,  8.8205e-02],
         [ 5.0008e-02,  1.0803e-01],
         [ 5.0007e-02,  8.4232e-02],
         [ 5.0007e-02,  9.7753e-02],
         [ 5.0008e-02,  4.9929e-02],
         [ 5.0008e-02,  3.3907e-02],
         [ 5.0008e-02,  6.9812e-02],
         [ 5.0008e-02,  5.4742e-02],
         [ 5.0008e-02,  9.2425e-02],
         [ 5.0008e-02,  1.0459e-01],
         [ 5.0008e-02,  9.5812e-02],
         [ 5.0009e-02,  9.2397e-02],
         [ 5.0009e-02,  8.9915e-02],
         [ 5.0009e-02,  1.0857e-01],
         [ 5.0009e-02,  7.4058e-02],
         [ 5.0009e-02,  6.0570e-02],
         [ 5.0009e-02,  8.1104e-02],
         [ 5.0009e-02,  3.3983e-02],
         [ 5.0009e-02, -7.5836e-04],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.5782e-06, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.1449, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4639, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3817, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0527, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1685, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0314, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-571428.4375, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2245, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.6278e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1711, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2807, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1711, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14115
target_mac_out tensor([[[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1602e-01,  1.2451e-01,  ...,  5.5062e-02,
            1.5739e-01, -1.0000e+07],
          [-1.0000e+07, -2.2142e-02,  1.0521e-01,  ..., -1.6439e-02,
            1.3103e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2511e-01,  1.1978e-01,  ...,  4.1841e-02,
            1.4302e-01, -1.0000e+07],
          [-1.0000e+07, -7.2935e-02,  1.4289e-01,  ...,  3.5126e-02,
            1.4887e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7566e-01,  1.0558e-01,  ...,  3.4459e-02,
            1.6396e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6179e-01,  8.1262e-02,  ...,  1.3646e-02,
            1.6276e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.5577e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -6.0082e-02,  8.4218e-02,  ...,  2.3512e-02,
            1.2572e-01, -1.0000e+07],
          [-1.0000e+07, -1.1235e-02,  1.0290e-01,  ...,  6.8675e-03,
            1.2423e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.2166e-02,  6.8892e-02,  ...,  2.0706e-02,
            1.2918e-01, -1.0000e+07],
          [-1.0000e+07, -2.6887e-02,  9.4779e-02,  ..., -3.0197e-02,
            1.3592e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.2329e-02,  8.4675e-02,  ...,  2.7623e-02,
            1.2800e-01, -1.0000e+07],
          [-1.0000e+07, -3.4005e-02,  1.1766e-01,  ..., -2.4395e-02,
            1.5136e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.9115e-02,  9.3163e-02],
         [ 1.2451e-01,  1.0521e-01],
         [ 1.1978e-01,  1.4289e-01],
         [ 1.0806e-01,  1.5458e-01],
         [ 9.6630e-02,  1.3135e-01],
         [ 7.6036e-02,  1.6002e-01],
         [ 1.0073e-01,  1.2031e-01],
         [ 1.3101e-01,  1.0784e-01],
         [ 1.3622e-01,  1.2781e-01],
         [ 1.3834e-01,  1.3917e-01],
         [ 1.5062e-01,  1.6447e-01],
         [ 1.4993e-01,  1.7619e-01],
         [ 1.2736e-01,  1.6920e-01],
         [ 1.1176e-01,  1.2649e-01],
         [ 1.2183e-01,  1.3498e-01],
         [ 1.0557e-01,  1.1807e-01],
         [ 1.1940e-01,  1.0169e-01],
         [ 1.0358e-01,  1.0161e-01],
         [ 9.0301e-02,  1.3174e-01],
         [ 8.1454e-02,  1.2271e-01],
         [ 1.0558e-01,  1.0864e-01],
         [ 1.2039e-01,  1.2814e-01],
         [ 9.0299e-02,  1.0850e-01],
         [ 1.1490e-01,  1.0123e-01],
         [ 1.4178e-01,  1.3083e-01],
         [ 1.4809e-01,  1.0440e-01],
         [ 1.6010e-01,  1.2605e-01],
         [ 9.9089e-02, -1.3901e-02],
         [ 8.7960e-02,  2.5299e-02],
         [ 6.5567e-02,  4.3360e-02],
         [ 5.7446e-02,  5.1111e-02],
         [ 5.4620e-02,  5.4140e-02],
         [ 1.0208e-01,  5.5164e-02],
         [ 1.5184e-01,  5.5437e-02],
         [ 1.6766e-01,  5.5404e-02],
         [ 1.2873e-01,  5.5342e-02],
         [ 1.2765e-01,  5.5261e-02],
         [ 1.6128e-01,  5.5225e-02],
         [ 1.2833e-01,  5.5190e-02],
         [ 1.3164e-01,  5.5221e-02],
         [ 1.5882e-01,  5.5172e-02],
         [ 1.7778e-01,  5.5198e-02],
         [ 1.8907e-01,  5.5197e-02],
         [ 1.8427e-01,  5.5220e-02],
         [ 1.4075e-01,  5.5220e-02],
         [ 1.6479e-01,  5.5226e-02],
         [ 1.4248e-01,  5.5217e-02],
         [ 1.6834e-01,  5.5224e-02],
         [ 1.8388e-01,  5.5232e-02],
         [ 1.5290e-01,  5.5233e-02],
         [ 1.7397e-01,  5.5233e-02],
         [ 1.1935e-01,  5.5235e-02],
         [ 1.2578e-01,  5.5232e-02],
         [ 1.5595e-01,  5.5231e-02],
         [ 1.0719e-01,  5.5231e-02],
         [ 1.1831e-01,  5.5231e-02],
         [ 1.5859e-01,  5.5231e-02],
         [ 1.1124e-01,  5.5231e-02],
         [ 1.0583e-01,  5.5231e-02],
         [ 9.5931e-02,  5.5231e-02],
         [ 6.1259e-02,  5.5231e-02],
         [ 1.1193e-01,  5.5231e-02],
         [ 8.9306e-02,  5.5231e-02],
         [ 6.2379e-02,  5.5231e-02],
         [ 1.0916e-01,  5.5231e-02],
         [ 1.2097e-01,  5.5231e-02],
         [ 1.5927e-01,  5.5231e-02],
         [ 1.7884e-01,  5.5231e-02],
         [ 1.2167e-01,  5.5231e-02],
         [ 1.2695e-01,  5.5231e-02],
         [ 1.5664e-01,  5.5231e-02],
         [ 1.7611e-01,  5.5231e-02],
         [ 1.7821e-01,  5.5231e-02],
         [ 1.7777e-01,  5.5231e-02],
         [ 1.1850e-01,  5.5231e-02],
         [ 6.6605e-02,  5.5231e-02],
         [ 8.9907e-02,  5.5231e-02],
         [ 1.1582e-01,  5.5231e-02],
         [ 1.6168e-01,  5.5231e-02],
         [ 1.1438e-01,  5.5231e-02],
         [ 9.6318e-02,  5.5231e-02],
         [ 1.1644e-01,  5.5231e-02],
         [ 9.0746e-02,  5.5231e-02],
         [ 1.2031e-01,  5.5231e-02],
         [ 1.0703e-01,  5.5231e-02],
         [ 1.1077e-01,  5.5231e-02],
         [ 1.2549e-01,  5.5231e-02],
         [ 1.2887e-01,  5.5231e-02],
         [ 1.2096e-01,  5.5231e-02],
         [ 1.5273e-01,  5.5231e-02],
         [ 1.6204e-01,  5.5231e-02],
         [ 1.2753e-01,  5.5231e-02],
         [ 1.3217e-01,  5.5231e-02],
         [ 1.5248e-01,  5.5231e-02],
         [ 1.8023e-01,  5.5231e-02],
         [ 1.3995e-01,  5.5231e-02],
         [ 1.3602e-01,  5.5231e-02],
         [ 8.9270e-02,  5.5231e-02],
         [ 1.1489e-01,  5.5231e-02],
         [ 1.1457e-01,  5.5231e-02],
         [ 1.6539e-01,  5.5231e-02],
         [ 1.6868e-01,  5.5231e-02],
         [ 1.2959e-01,  5.5231e-02],
         [ 1.1589e-01,  5.5231e-02],
         [ 1.1230e-01,  5.5231e-02],
         [ 1.0558e-01,  5.5231e-02],
         [ 8.1262e-02,  5.5231e-02],
         [ 2.5577e-02,  5.5231e-02]],

        [[ 8.4218e-02,  1.0290e-01],
         [ 6.8892e-02,  9.4779e-02],
         [ 8.4675e-02,  1.1766e-01],
         [ 9.9942e-02,  1.2061e-01],
         [ 1.0897e-01,  8.9598e-02],
         [ 1.1413e-01,  9.5709e-02],
         [ 1.0581e-01,  1.2441e-01],
         [ 1.0875e-01,  1.2027e-01],
         [ 1.1562e-01,  1.3542e-01],
         [ 1.2118e-01,  1.4887e-01],
         [ 1.2193e-01,  1.2096e-01],
         [ 1.2811e-01,  1.3343e-01],
         [ 1.3946e-01,  1.4144e-01],
         [ 1.1078e-01,  1.1015e-01],
         [ 1.2726e-01,  9.8112e-02],
         [ 1.0850e-01,  9.1015e-02],
         [ 1.3936e-01,  1.2217e-01],
         [ 1.4814e-01,  1.3389e-01],
         [ 1.1933e-01,  1.3680e-01],
         [ 1.4447e-01,  1.4006e-01],
         [ 1.5365e-01,  1.0699e-01],
         [ 1.4006e-01,  1.0244e-01],
         [ 1.4243e-01,  1.2374e-01],
         [ 1.4930e-01,  9.1899e-02],
         [ 1.5397e-01,  1.1679e-01],
         [ 1.4874e-01,  8.4685e-02],
         [ 1.1912e-01,  1.1293e-01],
         [ 1.0501e-01,  8.1114e-02],
         [ 1.3399e-01,  1.1210e-01],
         [ 1.4718e-01,  8.0533e-02],
         [ 1.4681e-01,  8.4336e-02],
         [ 1.3591e-01,  1.1075e-01],
         [ 1.3928e-01,  1.2474e-01],
         [ 1.4555e-01,  1.3052e-01],
         [ 1.5084e-01,  9.6430e-02],
         [ 1.3492e-01,  9.8105e-02],
         [ 1.4148e-01,  7.7683e-02],
         [ 1.4376e-01,  1.0754e-01],
         [ 1.0958e-01,  1.2083e-01],
         [ 1.3650e-01,  1.2550e-01],
         [ 1.4141e-01,  1.2844e-01],
         [ 1.4385e-01,  1.5404e-01],
         [ 1.5028e-01,  1.4776e-01],
         [ 1.5094e-01,  8.9196e-02],
         [ 1.5692e-01,  6.8010e-02],
         [ 1.1317e-01,  1.1998e-01],
         [ 1.3576e-01,  1.0365e-01],
         [ 1.4448e-01,  1.2883e-01],
         [ 1.2306e-01,  1.1822e-01],
         [ 1.0775e-01,  1.4080e-01],
         [ 1.1718e-01,  1.4171e-01],
         [ 1.2901e-01,  1.1729e-01],
         [ 1.3669e-01,  9.8225e-02],
         [ 1.1476e-01,  9.2806e-02],
         [ 7.8258e-02,  9.0676e-02],
         [ 1.0514e-01,  1.1480e-01],
         [ 1.2504e-01,  1.2341e-01],
         [ 1.2884e-01,  1.1486e-01],
         [ 1.4173e-01,  9.6586e-02],
         [ 1.4480e-01,  9.2936e-02],
         [ 1.4636e-01,  7.0689e-02],
         [ 1.4845e-01,  1.0006e-01],
         [ 1.0533e-01, -1.3408e-02],
         [ 1.1104e-01,  2.3950e-02],
         [ 7.0917e-02,  4.2304e-02],
         [ 7.4906e-02,  5.0491e-02],
         [ 9.6772e-02,  5.3827e-02],
         [ 1.0213e-01,  5.5006e-02],
         [ 1.0989e-01,  5.5329e-02],
         [ 9.9587e-02,  5.5364e-02],
         [ 6.3231e-02,  5.5317e-02],
         [ 1.0369e-01,  5.5245e-02],
         [ 1.1003e-01,  5.5197e-02],
         [-1.1414e-02,  5.5197e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.2293e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.3712, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4609, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3703, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0654, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1684, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0076, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1574073.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1891, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.1539e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1424, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1369, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1424, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14161
target_mac_out tensor([[[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.9336e-02,  8.9318e-02,  ...,  1.5729e-02,
            1.2882e-01, -1.0000e+07],
          [-1.0000e+07, -2.5640e-02,  8.8110e-02,  ..., -1.8735e-02,
            1.3277e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9456e-02,  1.1227e-01,  ...,  3.1463e-02,
            1.5607e-01, -1.0000e+07],
          [-1.0000e+07, -2.2524e-02,  9.4101e-02,  ...,  7.9979e-03,
            1.3867e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6657e-01,  1.0046e-01,  ...,  4.7687e-02,
            1.7939e-01, -1.0000e+07],
          [ 5.5843e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.4884e-01,  5.8879e-02,  ...,  4.4561e-02,
            1.4981e-01, -1.0000e+07],
          [ 5.5821e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.2406e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5655e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.5215e-02,  8.8677e-02,  ...,  2.3305e-02,
            1.2081e-01, -1.0000e+07],
          [-1.0000e+07, -5.3949e-02,  1.3771e-01,  ...,  6.3333e-02,
            1.3943e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1528e-01,  1.1518e-01,  ...,  5.1719e-02,
            1.4870e-01, -1.0000e+07],
          [-1.0000e+07, -4.6759e-02,  1.2594e-01,  ...,  2.6035e-02,
            1.4146e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4828e-01,  1.2714e-01,  ...,  6.6744e-02,
            1.6089e-01, -1.0000e+07],
          [-1.0000e+07, -8.7643e-02,  1.5163e-01,  ...,  5.6911e-02,
            1.5296e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.0670e-02,  8.4050e-02],
         [ 8.9318e-02,  8.8110e-02],
         [ 1.1227e-01,  9.4101e-02],
         [ 1.1534e-01,  1.0178e-01],
         [ 1.2798e-01,  1.2910e-01],
         [ 1.2945e-01,  1.2066e-01],
         [ 1.4306e-01,  1.1132e-01],
         [ 1.1782e-01,  1.3847e-01],
         [ 1.1269e-01,  1.4997e-01],
         [ 1.1838e-01,  1.3027e-01],
         [ 9.4060e-02,  1.6714e-01],
         [ 1.1096e-01,  1.8065e-01],
         [ 1.0014e-01,  1.8987e-01],
         [ 1.3013e-01,  1.4082e-01],
         [ 1.2723e-01,  1.4025e-01],
         [ 1.4533e-01,  1.1933e-01],
         [ 1.4194e-01,  1.1061e-01],
         [ 1.3404e-01,  1.5552e-01],
         [ 1.4938e-01,  1.7272e-01],
         [ 1.6462e-01,  1.7705e-01],
         [ 1.1987e-01,  1.7237e-01],
         [ 8.0474e-02,  1.3535e-01],
         [ 7.4149e-02,  1.1902e-01],
         [ 7.0239e-02,  1.0975e-01],
         [ 8.2356e-02,  7.2272e-02],
         [ 7.7224e-02,  6.0638e-02],
         [ 8.8906e-02,  9.5736e-02],
         [ 7.7904e-02,  6.7670e-02],
         [ 8.9825e-02,  5.2560e-02],
         [ 5.3801e-02,  8.4048e-02],
         [ 8.6674e-02,  6.1225e-02],
         [ 9.2280e-02,  8.5336e-02],
         [ 9.6262e-02, -7.5407e-02],
         [ 1.0805e-01,  6.3850e-02],
         [ 6.5211e-02,  4.2550e-02],
         [ 7.4150e-02,  7.5480e-02],
         [ 5.0358e-02,  8.0061e-02],
         [ 8.3061e-02, -8.8618e-02],
         [ 1.0496e-01,  5.1787e-02],
         [ 1.1401e-01,  6.6511e-02],
         [ 1.0886e-01,  4.0604e-03],
         [ 1.1547e-01,  3.4270e-02],
         [ 1.1593e-01,  4.7829e-02],
         [ 8.4795e-02,  5.3385e-02],
         [ 9.8770e-02,  5.5357e-02],
         [ 1.0046e-01,  5.5843e-02],
         [ 5.8879e-02,  5.5821e-02],
         [ 1.2406e-02,  5.5655e-02]],

        [[ 8.8677e-02,  1.3771e-01],
         [ 1.1518e-01,  1.2594e-01],
         [ 1.2714e-01,  1.5163e-01],
         [ 1.4233e-01,  1.6560e-01],
         [ 1.3414e-01,  1.6098e-01],
         [ 1.3234e-01,  1.7625e-01],
         [ 1.4401e-01,  1.7745e-01],
         [ 1.5285e-01,  1.7892e-01],
         [ 1.2138e-01,  1.7662e-01],
         [ 1.3265e-01, -1.5374e-01],
         [ 1.2906e-01,  1.2422e-01],
         [ 1.2901e-01,  1.6897e-01],
         [ 8.9129e-02,  1.8743e-01],
         [ 7.5981e-02,  6.7096e-02],
         [ 5.7856e-02,  5.6490e-02],
         [ 8.6227e-02,  8.6990e-02],
         [ 6.2829e-02,  9.8592e-02],
         [ 1.0053e-01,  6.7586e-02],
         [ 1.2689e-01,  7.2098e-02],
         [ 1.6138e-01, -3.0668e-01],
         [ 9.5635e-02,  6.2659e-02],
         [ 7.4953e-02,  8.6484e-02],
         [ 1.9615e-02,  6.2754e-02],
         [ 3.5011e-02,  8.7553e-02],
         [ 4.3864e-02,  6.1580e-02],
         [ 4.8044e-02,  9.3367e-02],
         [ 4.9731e-02,  6.6098e-02],
         [ 5.0221e-02,  9.6294e-02],
         [ 5.0288e-02,  6.7144e-02],
         [ 5.0193e-02, -8.2083e-02],
         [ 5.0112e-02, -8.0176e-02],
         [ 5.0039e-02,  1.0343e-01],
         [ 5.0010e-02,  6.3673e-02],
         [ 5.0012e-02,  5.3023e-02],
         [ 4.9996e-02,  9.1930e-02],
         [ 5.0007e-02,  2.5279e-01],
         [ 5.0010e-02, -7.0455e-02],
         [ 5.0019e-02,  8.1319e-02],
         [ 5.0010e-02, -4.6084e-02],
         [ 5.0018e-02, -4.9030e-02],
         [ 5.0018e-02, -5.3909e-02],
         [ 5.0016e-02, -5.7747e-02],
         [ 5.0017e-02, -6.0613e-02],
         [ 5.0004e-02, -6.4306e-02],
         [ 5.0006e-02,  2.3543e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(0.0001, device='cuda:0') tensor(0.0038, device='cuda:0') tensor(-0.0021, device='cuda:0')
mixer_td_error tensor(0.1288, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4647, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7427, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0648, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1836, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0255, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-312499.9062, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2528, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0024, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1496, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2886, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1496, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14207
target_mac_out tensor([[[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3613e-01,  1.3267e-01,  ...,  7.3786e-02,
            1.5385e-01, -1.0000e+07],
          [-1.0000e+07, -8.8486e-02,  1.6307e-01,  ...,  7.7780e-02,
            1.4979e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.7284e-01,  1.4864e-01,  ...,  8.4640e-02,
            1.6924e-01, -3.7715e-01],
          [-1.0000e+07, -1.1832e-01,  1.8232e-01,  ...,  9.0361e-02,
            1.6364e-01, -3.3293e-01]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.2377e-02,  6.0670e-02,  ...,  3.1469e-02,
            1.1910e-01, -1.0000e+07],
          [-1.0000e+07, -1.1096e-02,  8.4050e-02,  ...,  2.0013e-02,
            1.3284e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.5027e-02,  7.1936e-02,  ..., -3.0500e-03,
            1.2911e-01, -1.0000e+07],
          [-1.0000e+07, -2.2961e-02,  9.6708e-02,  ..., -2.0494e-02,
            1.3243e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.1139e-02,  8.5369e-02,  ...,  1.4716e-02,
            1.3164e-01, -1.0000e+07],
          [-1.0000e+07, -3.0575e-02,  9.4245e-02,  ..., -4.3856e-02,
            1.3745e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.9938e-01,  1.0586e-01,  ...,  4.4793e-02,
            1.6853e-01, -3.1699e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.8366e-01,  7.2695e-02,  ...,  4.2428e-02,
            1.5227e-01, -3.1359e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.6262e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1386e-01,  1.4136e-01],
         [ 1.3267e-01,  1.6307e-01],
         [ 1.4864e-01,  1.8232e-01],
         [ 1.5058e-01,  1.8241e-01],
         [ 1.3972e-01,  1.3679e-01],
         [ 1.1440e-01,  1.1597e-01],
         [ 1.3320e-01,  1.0790e-01],
         [ 1.5725e-01,  1.0726e-01],
         [ 1.5598e-01,  1.1967e-01],
         [ 1.3513e-01,  9.2465e-02],
         [ 1.2322e-01,  9.7425e-02],
         [ 1.1839e-01,  1.5058e-01],
         [ 1.4132e-01,  1.2632e-01],
         [ 1.4166e-01,  1.0538e-01],
         [ 1.4031e-01,  7.1283e-02],
         [ 1.1300e-01, -7.7824e-02],
         [ 1.2704e-01,  7.2532e-02],
         [ 1.2356e-01,  9.0696e-02],
         [ 1.1931e-01,  1.1284e-01],
         [ 9.9388e-02,  7.8506e-02],
         [-9.4431e-02,  9.8235e-02],
         [ 7.7636e-03,  1.0611e-01],
         [ 3.0837e-02,  1.1470e-01],
         [ 4.2450e-02,  1.1353e-01],
         [ 4.7713e-02,  1.2708e-01],
         [ 4.9792e-02,  8.5120e-02],
         [ 5.0435e-02,  6.3875e-02],
         [ 5.0521e-02,  4.4536e-02],
         [ 5.0415e-02,  4.5447e-02],
         [ 5.0289e-02,  9.6476e-02],
         [ 5.0177e-02,  5.5105e-02],
         [ 5.0106e-02,  1.0262e-01],
         [ 5.0056e-02,  1.0504e-01],
         [ 5.0036e-02,  5.7357e-02],
         [ 5.0034e-02,  3.9480e-02],
         [ 4.9996e-02,  6.9194e-02],
         [ 5.0011e-02,  9.1686e-02],
         [ 5.0009e-02,  1.0957e-01],
         [ 5.0012e-02,  9.2195e-02],
         [ 5.0017e-02,  4.2747e-02],
         [ 5.0010e-02,  3.3468e-02],
         [ 5.0013e-02,  5.6869e-02],
         [ 5.0007e-02,  2.5264e-02],
         [ 5.0007e-02,  6.0105e-02],
         [ 5.0008e-02,  2.2340e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 6.0670e-02,  8.4050e-02],
         [ 7.1936e-02,  9.6708e-02],
         [ 8.5369e-02,  9.4245e-02],
         [ 1.0957e-01,  1.1600e-01],
         [ 1.0896e-01,  1.1381e-01],
         [ 1.4632e-01,  1.3353e-01],
         [ 1.2837e-01,  1.0659e-01],
         [ 1.1660e-01,  1.0882e-01],
         [ 1.3067e-01,  1.3858e-01],
         [ 1.5041e-01,  8.6393e-02],
         [ 1.6852e-01, -1.5386e-02],
         [-2.0264e-02, -8.4988e-03],
         [-2.5192e-02,  6.5463e-02],
         [-6.2545e-03,  4.2642e-02],
         [ 1.5086e-02,  3.6278e-02],
         [ 1.2737e-01,  8.6319e-02],
         [ 1.2065e-01,  1.0241e-01],
         [ 1.0288e-01,  1.0723e-01],
         [ 1.4248e-01,  1.3861e-01],
         [ 1.2420e-01,  1.1778e-01],
         [ 1.1322e-01,  1.1742e-01],
         [ 1.0830e-01,  1.1024e-01],
         [ 7.0876e-02,  8.0633e-02],
         [ 9.3324e-02,  1.0793e-01],
         [ 1.0936e-01, -1.1027e-02],
         [ 1.0331e-01, -1.1783e-02],
         [ 1.5426e-01,  6.8686e-02],
         [ 1.7741e-01,  5.0227e-02],
         [ 1.7950e-01,  7.9972e-02],
         [ 1.7848e-01,  9.5407e-02],
         [-2.2659e-02,  7.3367e-02],
         [ 1.6343e-01,  3.7436e-02],
         [ 1.8144e-01,  3.8128e-02],
         [ 1.3893e-01,  9.2127e-02],
         [ 8.5617e-02,  1.3353e-01],
         [ 1.0307e-01,  1.4873e-01],
         [ 7.3886e-02,  1.1367e-01],
         [ 9.7996e-02,  1.3962e-01],
         [ 9.6801e-02,  1.5129e-01],
         [ 1.2020e-01,  1.1250e-01],
         [ 1.3091e-01,  1.2301e-01],
         [ 1.2777e-01,  1.0402e-01],
         [ 1.5403e-01,  9.7388e-02],
         [ 1.6515e-01,  9.9281e-02],
         [ 1.7729e-01,  1.1371e-01],
         [ 1.7978e-01,  1.0285e-01],
         [ 1.2463e-01,  1.1852e-01],
         [ 1.1360e-01,  1.0884e-01],
         [ 1.2853e-01,  1.3620e-01],
         [ 1.4989e-01,  8.0995e-02],
         [ 1.6592e-01,  9.8872e-02],
         [ 1.2034e-01,  1.4419e-01],
         [ 1.2796e-01,  1.6298e-01],
         [ 1.5526e-01,  1.6761e-01],
         [ 1.6354e-01,  1.3651e-01],
         [ 1.2214e-01,  1.6277e-01],
         [ 1.3145e-01,  1.8230e-01],
         [ 1.2651e-01,  1.8624e-01],
         [ 1.4976e-01,  1.8383e-01],
         [ 1.3096e-01,  1.5660e-01],
         [ 1.5719e-01,  1.1360e-01],
         [ 1.2639e-01,  9.2760e-02],
         [ 9.8559e-02,  7.1618e-02],
         [ 1.2064e-01,  4.6336e-02],
         [ 1.0465e-01,  5.9508e-02],
         [ 1.3051e-01,  1.1030e-01],
         [ 1.0501e-01,  1.3248e-01],
         [ 1.1574e-01,  1.0984e-01],
         [ 1.2416e-01,  1.3082e-01],
         [ 1.4123e-01,  1.3335e-01],
         [ 1.0080e-01,  1.5099e-01],
         [ 1.2277e-01,  1.1573e-01],
         [ 1.3046e-01,  4.7317e-03],
         [ 1.2593e-01,  3.5153e-02],
         [ 1.3922e-01,  4.7874e-02],
         [ 1.8498e-01,  5.2807e-02],
         [ 1.5769e-01,  5.4573e-02],
         [ 1.3009e-01,  5.5107e-02],
         [ 1.2383e-01,  5.5214e-02],
         [ 1.3862e-01,  5.5201e-02],
         [ 1.3305e-01,  5.5187e-02],
         [ 1.4448e-01,  5.5161e-02],
         [ 1.0565e-01,  5.5155e-02],
         [ 1.2594e-01,  5.5158e-02],
         [ 1.3153e-01,  5.5200e-02],
         [ 1.4550e-01,  5.5186e-02],
         [ 1.2056e-01,  5.5187e-02],
         [ 1.2911e-01,  5.5204e-02],
         [ 1.3020e-01,  5.5219e-02],
         [ 1.0828e-01,  5.5208e-02],
         [ 1.1543e-01,  5.5215e-02],
         [ 8.3100e-02,  5.5218e-02],
         [ 1.0123e-01,  5.5227e-02],
         [ 1.0586e-01,  5.5231e-02],
         [ 7.2695e-02,  5.5230e-02],
         [ 2.6262e-03,  5.5230e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.9806e-05, device='cuda:0') tensor(0.0023, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.6330, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4558, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5089, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0633, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1728, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0209, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2656249.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1862, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.1152e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0014, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1201, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1958, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1201, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14256
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9711e-02,  8.6010e-02,  ...,  5.5065e-03,
            1.3727e-01, -1.0000e+07],
          [-1.0000e+07, -4.5321e-02,  1.0753e-01,  ...,  3.5616e-02,
            1.4810e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3339e-02,  9.1828e-02,  ...,  2.0462e-03,
            1.4069e-01, -1.0000e+07],
          [-1.0000e+07, -7.9815e-02,  1.4915e-01,  ...,  6.6216e-02,
            1.5396e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9290e-02,  1.0181e-01,  ...,  4.7758e-02,
            1.4846e-01, -1.0000e+07],
          [-1.0000e+07, -3.3519e-02,  1.1222e-01,  ..., -2.3922e-02,
            1.3929e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1333e-01,  1.3127e-01,  ...,  6.5502e-02,
            1.5589e-01, -1.0000e+07],
          [-1.0000e+07, -7.3291e-02,  1.5280e-01,  ...,  3.2253e-02,
            1.5267e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0905e-01,  1.0129e-01,  ...,  6.8682e-02,
            1.7894e-01, -3.2784e-01],
          [ 5.5831e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.0900e-01,  1.0655e-01,  ...,  5.8541e-02,
            1.8107e-01, -3.2474e-01],
          [ 5.5708e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.0339e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5505e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.4276e-02,  1.4162e-01],
         [ 8.6010e-02,  1.0753e-01],
         [ 9.1828e-02,  1.4915e-01],
         [ 1.0444e-01,  1.6115e-01],
         [ 8.1765e-02,  1.7010e-01],
         [ 9.0029e-02,  1.4649e-01],
         [ 1.1421e-01,  1.0467e-01],
         [ 8.0933e-02,  1.2112e-01],
         [ 9.2055e-02,  1.3186e-01],
         [ 8.4177e-02,  1.1291e-01],
         [ 9.5572e-02,  1.2795e-01],
         [ 6.3941e-02,  1.0724e-01],
         [ 5.0269e-02,  9.9236e-02],
         [ 7.7802e-02,  7.2083e-02],
         [ 9.3212e-02,  5.9652e-02],
         [ 9.9830e-02,  7.4247e-02],
         [ 1.0216e-01,  3.9824e-02],
         [ 1.0291e-01,  7.4032e-02],
         [ 1.2350e-01,  8.4755e-02],
         [ 1.3306e-01,  4.3521e-02],
         [ 1.3041e-01,  7.4428e-02],
         [ 1.4218e-01,  8.5723e-02],
         [ 1.4388e-01,  2.6814e-01],
         [ 1.4179e-01,  2.6601e-01],
         [ 1.3621e-01,  3.1014e-02],
         [ 1.3474e-01,  2.5791e-01],
         [ 1.0183e-01,  1.1306e-01],
         [ 1.1285e-01,  1.5033e-01],
         [ 9.4342e-02,  1.4517e-01],
         [ 8.4264e-02, -2.3395e-02],
         [ 7.1114e-02,  1.9335e-02],
         [ 6.7057e-02,  4.0051e-02],
         [ 1.0769e-01,  4.9306e-02],
         [ 7.4508e-02,  5.3164e-02],
         [ 1.0000e-01,  5.4641e-02],
         [ 1.1326e-01,  5.5132e-02],
         [ 8.5007e-02,  5.5265e-02],
         [ 1.2458e-01,  5.5261e-02],
         [ 1.2883e-01,  5.5249e-02],
         [ 8.6796e-02,  5.5220e-02],
         [ 1.0732e-01,  5.5210e-02],
         [ 1.3785e-01,  5.5211e-02],
         [ 5.9416e-02,  5.5218e-02],
         [ 5.6236e-02,  5.5214e-02],
         [ 1.3241e-01,  5.5193e-02],
         [ 9.0256e-02,  5.5215e-02],
         [ 1.1013e-01,  5.5212e-02],
         [ 5.3809e-02,  5.5203e-02],
         [ 1.2611e-01,  5.5221e-02],
         [ 6.4353e-02,  5.5227e-02],
         [ 5.0563e-02,  5.5232e-02],
         [ 4.3539e-02,  5.5230e-02],
         [ 3.6921e-03,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 6.2098e-02,  1.2351e-01],
         [ 1.0181e-01,  1.1222e-01],
         [ 1.3127e-01,  1.5280e-01],
         [ 1.2837e-01,  1.6291e-01],
         [ 9.5852e-02,  1.2428e-01],
         [ 1.3859e-01,  1.5452e-01],
         [ 1.4572e-01,  1.1588e-01],
         [ 1.0700e-01,  1.2083e-01],
         [ 8.6114e-02,  9.4543e-02],
         [ 1.1489e-01,  9.3817e-02],
         [ 1.1854e-01,  1.1548e-01],
         [ 1.2877e-01,  1.0008e-01],
         [ 1.2365e-01,  1.1167e-01],
         [ 1.2197e-01,  1.1521e-01],
         [ 1.2565e-01,  9.1372e-02],
         [ 1.3823e-01,  5.9090e-02],
         [ 1.4876e-01,  8.2787e-02],
         [ 1.6783e-01,  7.9772e-02],
         [ 1.2127e-01,  7.7370e-02],
         [ 1.3090e-01,  9.3493e-02],
         [ 1.4102e-01,  5.1346e-02],
         [ 1.2932e-01,  4.9428e-02],
         [-6.6372e-02,  3.0096e-02],
         [ 1.0320e-01,  4.4489e-02],
         [ 1.2871e-01,  6.2670e-02],
         [ 1.0037e-01,  8.4708e-02],
         [ 1.0146e-01,  7.7035e-02],
         [-4.4160e-02,  6.9510e-02],
         [-5.0704e-02,  2.0251e-01],
         [ 7.9031e-02,  2.0903e-01],
         [ 8.4491e-02,  2.1069e-01],
         [ 1.1526e-01,  6.2689e-02],
         [ 1.0764e-01,  6.1126e-02],
         [ 1.0887e-01,  5.7355e-02],
         [ 1.0773e-01,  6.1010e-02],
         [ 1.0714e-01,  6.6354e-02],
         [ 1.0010e-01,  9.4367e-02],
         [ 9.2642e-02,  1.0019e-01],
         [ 8.5963e-02,  9.1463e-02],
         [ 1.1174e-01,  8.8744e-02],
         [ 1.2427e-01,  7.1726e-02],
         [ 1.1730e-01,  8.2398e-02],
         [ 1.2678e-01,  4.5400e-02],
         [ 1.3248e-01,  7.1729e-02],
         [ 1.2420e-01,  8.2116e-02],
         [ 1.0057e-01,  2.0178e-01],
         [ 1.1199e-01,  9.0181e-02],
         [ 1.2558e-01,  9.1028e-02],
         [ 1.3972e-01,  8.4169e-02],
         [ 1.0323e-01,  7.2301e-02],
         [ 1.0841e-01,  1.2391e-01],
         [ 9.0816e-02,  1.0897e-01],
         [ 1.2142e-01,  1.0291e-01],
         [ 1.4098e-01,  9.9261e-02],
         [ 1.5538e-01,  1.0258e-01],
         [ 1.1230e-01,  7.7386e-02],
         [ 1.0532e-01,  7.2365e-02],
         [-8.5911e-02,  7.3872e-02],
         [ 1.2308e-01,  7.4342e-02],
         [ 1.4949e-01,  8.7137e-02],
         [ 1.5854e-01,  8.3594e-02],
         [ 1.1955e-01,  6.6225e-02],
         [ 9.9441e-02,  7.0303e-02],
         [ 1.1166e-01,  2.0699e-01],
         [-7.0498e-02,  1.9592e-01],
         [ 1.0680e-01,  4.0733e-02],
         [ 1.0553e-01,  5.0641e-02],
         [ 1.0462e-01,  6.0025e-02],
         [ 1.1588e-01,  6.3588e-02],
         [ 1.4457e-01,  8.8946e-02],
         [ 1.2923e-01,  8.8887e-02],
         [ 1.0556e-01,  7.0199e-02],
         [ 9.4784e-02,  8.7342e-02],
         [ 9.5266e-02,  6.9133e-02],
         [ 1.1126e-01,  8.4431e-02],
         [ 1.3064e-01,  6.9992e-02],
         [ 1.3462e-01,  7.7782e-02],
         [ 1.1952e-01,  5.8504e-02],
         [ 1.4010e-01,  5.8632e-02],
         [ 1.2437e-01,  8.8969e-02],
         [ 1.3582e-01,  7.8072e-02],
         [ 1.5712e-01,  9.2437e-02],
         [ 1.5892e-01,  7.5126e-02],
         [ 1.7540e-01,  7.1766e-02],
         [ 1.7305e-01,  8.8803e-02],
         [ 1.3542e-01,  8.4649e-02],
         [ 1.6459e-01,  8.5476e-02],
         [ 1.8001e-01,  8.3920e-02],
         [ 1.8920e-01,  8.3836e-02],
         [ 1.3805e-01,  7.5273e-02],
         [ 1.2125e-01,  1.1110e-01],
         [ 9.4732e-02,  9.5379e-02],
         [ 2.2122e-01,  1.2610e-01],
         [ 1.0430e-01,  9.5639e-02],
         [ 1.9567e-01,  8.6069e-02],
         [ 9.6552e-02,  1.2411e-01],
         [ 5.9230e-02,  1.4164e-01],
         [ 8.9584e-02,  1.6417e-01],
         [ 1.0493e-01,  1.7310e-01],
         [ 1.1298e-01, -1.0579e-01],
         [ 1.1493e-01,  1.5034e-01],
         [ 7.5395e-02,  9.3793e-02],
         [ 1.0367e-01,  6.7430e-02],
         [ 1.1369e-01,  5.5854e-02],
         [ 1.1659e-01,  7.3041e-02],
         [ 1.5662e-01,  9.9545e-02],
         [ 1.8715e-01,  1.2717e-01],
         [ 1.7667e-01,  9.0710e-02],
         [ 1.7780e-01,  6.5056e-02],
         [ 1.5233e-01,  6.0279e-02],
         [ 1.5316e-01,  1.0233e-01],
         [ 1.7230e-01,  7.2476e-02],
         [ 1.2769e-01,  7.3174e-02],
         [ 1.6294e-01,  1.0039e-01],
         [ 1.2044e-01,  1.1008e-01],
         [ 1.5258e-01,  7.6368e-02],
         [ 1.2445e-01,  9.2721e-02],
         [ 1.3184e-01,  9.5908e-02],
         [ 1.5656e-01,  5.3166e-02],
         [ 1.7400e-01,  6.7876e-02],
         [ 1.6731e-01,  8.4690e-02],
         [ 1.5053e-01,  2.2583e-02],
         [ 1.1620e-01,  4.1458e-02],
         [ 1.1952e-01,  5.0637e-02],
         [ 1.1866e-01,  5.4424e-02],
         [ 9.0341e-02,  5.5681e-02],
         [ 1.0129e-01,  5.5831e-02],
         [ 1.0655e-01,  5.5708e-02],
         [ 2.0339e-03,  5.5505e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-8.6887e-08, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0010, device='cuda:0')
mixer_td_error tensor(0.7239, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4581, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4107, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0668, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1789, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0177, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2945736., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2681, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.9281e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2212, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1829, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2212, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14309
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3285e-02,  8.7210e-02,  ..., -7.6795e-03,
            1.4393e-01, -1.0000e+07],
          [-1.0000e+07, -2.8180e-02,  9.9658e-02,  ..., -1.6816e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5860e-02,  1.0411e-01,  ...,  2.0191e-02,
            1.7078e-01, -1.0000e+07],
          [-1.0000e+07, -2.5520e-02,  1.0800e-01,  ...,  9.6872e-03,
            1.3684e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.8475e-02,  8.3930e-02,  ...,  2.9168e-03,
            1.4114e-01, -1.0000e+07],
          [-1.0000e+07, -2.8572e-02,  1.0818e-01,  ...,  1.1152e-02,
            1.4585e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1306e-02,  8.6921e-02,  ..., -3.6412e-03,
            1.5129e-01, -1.0000e+07],
          [-1.0000e+07, -2.5687e-02,  1.0845e-01,  ...,  2.2908e-02,
            1.4218e-01, -1.0000e+07]],

         ...,

         [[ 4.9997e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -2.0695e-01, -1.0000e+07,  ..., -1.0000e+07,
            2.1777e-01, -3.2562e-01]],

         [[ 5.0192e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6841e-01,  2.9879e-02,  ...,  8.3961e-02,
            2.0065e-01, -3.1573e-01]],

         [[ 5.0199e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.3414e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02,  8.7099e-02],
         [ 8.7210e-02,  9.9658e-02],
         [ 1.0411e-01,  1.0800e-01],
         [ 8.4719e-02,  1.1353e-01],
         [ 1.1527e-01,  1.1500e-01],
         [ 1.3986e-01,  1.3945e-01],
         [ 1.5921e-01,  1.2947e-01],
         [ 1.8385e-01,  1.5109e-01],
         [ 1.9812e-01,  1.6420e-01],
         [ 2.0879e-01,  1.3194e-01],
         [ 2.1005e-01,  1.7221e-01],
         [ 6.9272e-02,  1.1014e-01],
         [ 1.7339e-01,  1.4619e-01],
         [ 1.6457e-01,  1.7519e-01],
         [ 1.6330e-01,  1.9288e-01],
         [ 1.4416e-01,  1.9414e-01],
         [ 1.3343e-01,  1.8718e-01],
         [ 1.1781e-01,  1.0292e-01],
         [ 1.5939e-01,  1.1416e-01],
         [-6.3937e-02,  7.5181e-02],
         [ 1.7852e-01,  1.0041e-01],
         [ 1.3769e-01,  7.2487e-02],
         [ 1.5594e-01,  1.0584e-01],
         [ 1.2068e-01,  1.1093e-01],
         [ 1.0612e-01,  1.1869e-01],
         [ 6.7176e-02,  8.0068e-02],
         [ 9.5707e-02,  1.0542e-01],
         [ 6.7872e-02,  1.1147e-01],
         [ 9.8581e-02,  9.3722e-02],
         [ 7.0509e-02,  2.4951e-01],
         [ 7.4457e-02,  2.3845e-01],
         [ 1.0869e-01,  2.3487e-01],
         [ 1.3879e-01,  2.1938e-01],
         [ 1.6416e-01,  3.5174e-02],
         [ 1.7761e-01,  2.9981e-02],
         [ 1.7199e-01, -3.1680e-03],
         [ 1.8096e-01,  3.0600e-02],
         [ 1.9578e-01,  4.5776e-02],
         [ 1.8672e-01,  5.2215e-02],
         [ 2.0169e-01,  5.4716e-02],
         [ 2.0767e-01,  5.5529e-02],
         [ 1.6171e-01,  5.5666e-02],
         [ 1.9383e-01,  5.5585e-02],
         [ 1.8742e-01,  5.5473e-02],
         [ 1.4716e-01,  5.5392e-02],
         [ 1.3056e-01,  5.5314e-02],
         [ 1.5688e-01,  5.5237e-02],
         [ 1.7954e-01,  5.5227e-02],
         [ 1.3839e-01,  5.5213e-02],
         [ 1.7126e-01,  5.5235e-02],
         [ 1.2922e-01,  5.5220e-02],
         [ 1.3455e-02,  5.5202e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 7.2334e-02,  1.2843e-01],
         [ 8.3930e-02,  1.0818e-01],
         [ 8.6921e-02,  1.0845e-01],
         [ 6.3760e-02,  1.3467e-01],
         [ 7.7897e-02,  1.4503e-01],
         [ 1.0447e-01,  1.4866e-01],
         [ 1.1596e-01,  1.2756e-01],
         [ 1.2122e-01,  1.3965e-01],
         [ 1.2336e-01,  1.4910e-01],
         [ 1.1455e-01,  1.2084e-01],
         [ 1.0457e-01,  1.0404e-01],
         [ 1.1905e-01,  9.2736e-02],
         [ 1.2676e-01,  9.5823e-02],
         [ 1.2947e-01,  8.8226e-02],
         [ 1.4037e-01,  1.1663e-01],
         [ 1.2073e-01,  1.4169e-01],
         [ 6.0602e-02,  1.1530e-01],
         [ 1.0118e-01,  1.0774e-01],
         [ 1.0176e-01, -3.2668e-02],
         [ 1.0365e-01, -5.2921e-02],
         [ 1.2059e-01, -3.9493e-02],
         [ 8.7165e-02,  7.8808e-02],
         [ 1.1784e-01, -9.9973e-03],
         [ 1.3148e-01,  1.1179e-01],
         [ 9.2479e-02,  1.0458e-01],
         [ 7.4687e-02,  6.3215e-02],
         [ 6.1389e-02,  1.1612e-01],
         [ 8.6666e-02,  8.0882e-02],
         [ 5.2790e-02,  8.5783e-02],
         [ 6.4680e-02,  9.4266e-02],
         [ 9.6260e-02,  9.8277e-02],
         [ 8.5407e-02,  1.0104e-01],
         [ 1.2424e-01,  1.2004e-01],
         [ 1.3649e-01,  1.2468e-01],
         [-4.8570e-02,  1.2215e-01],
         [ 1.2145e-01,  1.1222e-01],
         [ 1.3870e-01,  8.2000e-02],
         [ 1.0532e-01,  7.5387e-02],
         [ 9.5750e-02,  6.8666e-02],
         [ 1.0113e-01,  8.4208e-02],
         [ 9.3375e-02,  5.9565e-02],
         [ 5.6848e-02,  7.1971e-02],
         [ 9.2008e-02,  6.8996e-02],
         [ 1.0534e-01,  5.9581e-02],
         [ 1.3942e-01,  1.3646e-01],
         [ 9.2233e-02,  8.0797e-02],
         [ 1.0784e-01,  2.7996e-02],
         [ 7.7165e-02,  5.4345e-02],
         [ 6.5217e-02,  2.1527e-02],
         [ 6.3901e-02,  3.7742e-02],
         [ 1.4504e-02,  8.1158e-02],
         [ 3.2923e-02,  9.2443e-02],
         [ 4.2669e-02,  9.1257e-02],
         [ 4.7293e-02,  2.4872e-01],
         [ 4.9259e-02,  2.3509e-01],
         [ 4.9997e-02,  2.1777e-01],
         [ 5.0192e-02,  2.9879e-02],
         [ 5.0199e-02,  1.3414e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.6336e-05, device='cuda:0') tensor(0.0027, device='cuda:0') tensor(-0.0023, device='cuda:0')
mixer_td_error tensor(0.1153, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4592, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8923, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0766, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1971, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0102, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-517241.2188, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2495, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0020, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2141, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1246, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2141, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14355
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6527e-02,  7.9265e-02,  ...,  4.2534e-02,
            1.3764e-01, -1.0000e+07],
          [-1.0000e+07, -3.4160e-02,  1.2734e-01,  ...,  3.6650e-02,
            1.4514e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7552e-02,  6.9527e-02,  ...,  3.6922e-02,
            1.3246e-01, -1.0000e+07],
          [-1.0000e+07, -6.9459e-02,  1.5722e-01,  ...,  6.3242e-02,
            1.5510e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4887e-01,  4.9958e-02,  ...,  3.2413e-02,
            1.7518e-01, -3.0026e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6329e-01,  7.7314e-02,  ...,  6.4431e-02,
            1.9656e-01, -3.1323e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-8.6026e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.8475e-02,  8.3930e-02,  ...,  2.9168e-03,
            1.4114e-01, -1.0000e+07],
          [-1.0000e+07, -2.8572e-02,  1.0818e-01,  ...,  1.1152e-02,
            1.4585e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1306e-02,  8.6921e-02,  ..., -3.6412e-03,
            1.5129e-01, -1.0000e+07],
          [-1.0000e+07, -2.5687e-02,  1.0845e-01,  ...,  2.2908e-02,
            1.4218e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 7.9265e-02,  1.2734e-01],
         [ 6.9527e-02,  1.5722e-01],
         [ 8.8115e-02,  1.3407e-01],
         [ 9.2021e-02,  1.1965e-01],
         [ 1.1077e-01,  9.8505e-02],
         [ 1.0885e-01,  7.5371e-02],
         [ 1.1219e-01,  1.0466e-01],
         [ 1.2187e-01,  9.2092e-02],
         [ 1.2941e-01,  8.4600e-02],
         [ 1.2847e-01,  1.2769e-01],
         [ 1.3701e-01,  9.7878e-02],
         [ 1.1949e-01,  8.5881e-02],
         [ 9.6336e-02,  7.4866e-02],
         [ 1.0414e-01,  5.5366e-02],
         [ 8.9616e-02,  8.5009e-02],
         [ 9.5280e-02,  7.3843e-02],
         [ 1.2142e-01,  9.3602e-02],
         [ 1.0903e-01,  1.0871e-01],
         [ 1.2760e-01,  8.5809e-02],
         [ 1.3876e-01,  1.0593e-01],
         [ 1.3461e-01,  1.0264e-01],
         [ 1.3718e-01,  1.0112e-01],
         [ 1.4534e-01,  7.9505e-02],
         [ 1.3053e-01,  5.1870e-02],
         [ 1.5854e-01,  8.0270e-02],
         [ 1.6483e-01,  1.0052e-01],
         [ 1.8051e-01,  1.4853e-01],
         [ 1.4739e-01,  1.6411e-01],
         [ 1.6740e-01,  1.5900e-01],
         [ 1.7496e-01,  1.8515e-01],
         [ 1.8802e-01,  1.9385e-01],
         [ 1.8790e-01,  1.4945e-01],
         [ 1.8971e-01,  1.1596e-01],
         [ 1.5564e-01,  1.3987e-01],
         [ 1.7631e-01,  9.6963e-02],
         [ 1.6737e-01,  1.0210e-01],
         [ 1.7581e-01,  1.1055e-01],
         [ 1.9133e-01,  9.9574e-02],
         [ 2.0358e-01,  8.6684e-02],
         [ 1.6890e-01,  1.0010e-01],
         [ 1.9061e-01,  6.3768e-02],
         [ 1.9686e-01,  4.8977e-02],
         [ 1.5919e-01,  9.0457e-02],
         [ 1.3247e-01,  1.0169e-01],
         [ 1.3794e-01,  1.3351e-01],
         [-6.2971e-03,  6.7550e-02],
         [ 2.3971e-02,  8.9282e-02],
         [ 3.8744e-02,  9.3159e-02],
         [ 4.5555e-02,  1.3037e-01],
         [ 4.8516e-02,  1.4562e-01],
         [ 4.9665e-02,  9.2352e-02],
         [ 5.0048e-02,  8.9715e-02],
         [ 5.0141e-02,  1.3513e-01],
         [ 5.0132e-02,  1.6858e-01],
         [ 5.0067e-02,  1.0761e-01],
         [ 5.0055e-02,  8.1093e-02],
         [ 5.0023e-02,  5.2475e-02],
         [ 5.0024e-02,  3.9674e-02],
         [ 5.0018e-02,  5.9789e-02],
         [ 5.0000e-02,  4.5508e-02],
         [ 5.0017e-02,  3.2298e-02],
         [ 5.0013e-02,  3.0250e-02],
         [ 5.0027e-02,  5.5933e-02],
         [ 5.0017e-02,  7.7275e-02],
         [ 5.0017e-02,  8.6950e-02],
         [ 5.0012e-02,  5.0850e-02],
         [ 5.0009e-02,  4.8595e-02],
         [ 5.0006e-02,  7.8928e-02],
         [ 5.0008e-02,  4.8462e-02],
         [ 5.0007e-02,  8.0987e-02],
         [ 5.0008e-02,  7.5495e-02],
         [ 5.0008e-02,  1.0192e-01],
         [ 5.0008e-02,  1.1354e-01],
         [ 5.0008e-02,  6.5832e-02],
         [ 5.0008e-02,  7.5489e-02],
         [ 5.0008e-02,  4.3725e-02],
         [ 5.0008e-02,  3.4881e-02],
         [ 5.0008e-02,  7.4136e-02],
         [ 5.0009e-02,  5.7429e-02],
         [ 5.0009e-02,  4.9060e-02],
         [ 5.0009e-02,  7.7326e-02],
         [ 5.0009e-02,  8.7918e-02],
         [ 5.0009e-02,  9.2311e-02],
         [ 5.0009e-02,  7.7767e-02],
         [ 5.0009e-02,  1.0283e-01],
         [ 5.0009e-02,  9.8664e-02],
         [ 5.0009e-02,  8.7238e-02],
         [ 5.0009e-02,  5.9636e-02],
         [ 5.0009e-02,  9.6231e-02],
         [ 5.0009e-02,  9.6428e-02],
         [ 5.0009e-02,  1.0940e-01],
         [ 5.0009e-02,  9.9618e-02],
         [ 5.0009e-02,  6.0348e-02],
         [ 5.0009e-02,  4.4882e-02],
         [ 5.0009e-02,  7.3009e-02],
         [ 5.0009e-02,  4.2855e-02],
         [ 5.0009e-02,  4.3671e-02],
         [ 5.0009e-02,  6.8596e-02],
         [ 5.0009e-02,  6.1681e-02],
         [ 5.0009e-02,  4.2074e-02],
         [ 5.0009e-02,  4.6716e-02],
         [ 5.0009e-02,  3.3170e-02],
         [ 5.0009e-02,  4.1199e-02],
         [ 5.0009e-02,  1.5826e-02],
         [ 5.0009e-02,  1.7484e-02],
         [ 5.0009e-02,  3.8505e-02],
         [ 5.0009e-02,  5.4523e-02],
         [ 5.0009e-02,  3.1296e-02],
         [ 5.0009e-02,  5.1129e-02],
         [ 5.0009e-02,  6.4113e-02],
         [ 5.0009e-02,  5.2326e-02],
         [ 5.0009e-02,  5.7305e-02],
         [ 5.0009e-02,  6.7291e-02],
         [ 5.0009e-02,  7.5200e-02],
         [ 5.0009e-02,  3.7095e-02],
         [ 5.0009e-02,  3.0522e-02],
         [ 5.0009e-02,  6.2846e-02],
         [ 5.0009e-02,  5.5008e-02],
         [ 5.0009e-02,  6.5077e-02],
         [ 5.0009e-02,  1.0332e-01],
         [ 5.0009e-02,  6.6946e-02],
         [ 5.0009e-02,  6.8542e-02],
         [ 5.0009e-02,  5.6066e-02],
         [ 5.0009e-02,  3.2212e-02],
         [ 5.0009e-02,  5.5714e-02],
         [ 5.0009e-02,  6.9831e-02],
         [ 5.0009e-02,  5.9174e-02],
         [ 5.0009e-02,  3.9532e-02],
         [ 5.0009e-02,  6.1663e-02],
         [ 5.0009e-02,  8.6841e-02],
         [ 5.0009e-02,  9.6118e-02],
         [ 5.0009e-02,  1.0580e-01],
         [ 5.0009e-02,  9.8987e-02],
         [ 5.0009e-02,  8.3273e-02],
         [ 5.0009e-02,  7.3983e-02],
         [ 5.0009e-02,  8.0187e-02],
         [ 5.0009e-02,  8.2958e-02],
         [ 5.0009e-02,  4.9958e-02],
         [ 5.0009e-02,  7.7314e-02],
         [ 5.0009e-02, -8.6026e-03]],

        [[ 7.2334e-02,  1.2843e-01],
         [ 8.3930e-02,  1.0818e-01],
         [ 8.6921e-02,  1.0845e-01],
         [ 6.3760e-02,  1.3467e-01],
         [ 7.7897e-02,  1.4503e-01],
         [ 1.0447e-01,  1.4866e-01],
         [ 1.1596e-01,  1.2756e-01],
         [ 1.2122e-01,  1.3965e-01],
         [ 1.2336e-01,  1.4910e-01],
         [ 1.1455e-01,  1.2084e-01],
         [ 1.0457e-01,  1.0404e-01],
         [ 1.1905e-01,  9.2736e-02],
         [ 1.2676e-01,  9.5823e-02],
         [ 1.2947e-01,  8.8226e-02],
         [ 1.4037e-01,  1.1663e-01],
         [ 1.2073e-01,  1.4169e-01],
         [ 9.9266e-02,  1.1530e-01],
         [ 1.0118e-01,  1.0774e-01],
         [ 1.0176e-01, -3.2668e-02],
         [ 1.0365e-01, -5.2921e-02],
         [ 1.2059e-01, -3.9493e-02],
         [ 1.0160e-01,  7.8808e-02],
         [ 1.1784e-01, -9.9973e-03],
         [ 1.3148e-01,  1.1179e-01],
         [ 9.2479e-02,  1.0458e-01],
         [ 7.4687e-02,  6.3215e-02],
         [ 6.1389e-02,  1.1612e-01],
         [ 8.6666e-02,  8.0882e-02],
         [ 6.2866e-02,  8.5783e-02],
         [ 6.4680e-02,  9.4266e-02],
         [ 9.6260e-02,  9.8277e-02],
         [ 8.5407e-02,  1.0104e-01],
         [ 1.2424e-01,  1.2004e-01],
         [ 1.3649e-01,  1.2468e-01],
         [-4.8570e-02,  1.2215e-01],
         [ 1.2145e-01,  1.1222e-01],
         [ 1.3870e-01,  8.2000e-02],
         [ 1.0532e-01,  7.5387e-02],
         [ 9.5750e-02,  6.8666e-02],
         [ 1.0113e-01,  8.4208e-02],
         [ 9.3375e-02,  5.9565e-02],
         [ 5.6848e-02,  7.1971e-02],
         [ 9.2008e-02,  6.8996e-02],
         [ 1.0534e-01,  5.9581e-02],
         [ 1.3942e-01,  1.3646e-01],
         [ 9.2233e-02,  8.0797e-02],
         [ 1.0784e-01,  2.7996e-02],
         [ 7.7165e-02,  5.4345e-02],
         [ 6.5217e-02,  2.1527e-02],
         [ 6.3901e-02,  3.7742e-02],
         [ 1.4504e-02,  8.1158e-02],
         [ 3.2923e-02,  9.2443e-02],
         [ 4.2669e-02,  9.1257e-02],
         [ 4.7293e-02,  2.4872e-01],
         [ 4.9259e-02,  2.3509e-01],
         [ 4.9997e-02,  2.1777e-01],
         [ 5.0192e-02,  2.9879e-02],
         [ 5.0199e-02,  1.3414e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-9.7465e-06, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0010, device='cuda:0')
mixer_td_error tensor(0.7164, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4625, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4563, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0668, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2101, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0035, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2943261.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2487, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.7192e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1923, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1170, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1923, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14400
target_mac_out tensor([[[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9290e-02,  1.0181e-01,  ...,  4.7758e-02,
            1.4846e-01, -1.0000e+07],
          [-1.0000e+07, -3.3519e-02,  1.1222e-01,  ..., -2.3922e-02,
            1.3929e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1333e-01,  1.3127e-01,  ...,  6.5502e-02,
            1.5589e-01, -1.0000e+07],
          [-1.0000e+07, -7.3291e-02,  1.5280e-01,  ...,  3.2253e-02,
            1.5267e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.0905e-01,  1.0129e-01,  ...,  6.8682e-02,
            1.7894e-01, -3.2784e-01],
          [ 5.5831e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.0900e-01,  1.0655e-01,  ...,  5.8541e-02,
            1.8107e-01, -3.2474e-01],
          [ 5.5708e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.0339e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5505e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.3996e-02,  8.6686e-02,  ...,  2.0696e-02,
            1.2691e-01, -1.0000e+07],
          [-1.0000e+07, -1.5667e-02,  8.3441e-02,  ...,  2.3244e-02,
            1.3188e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.1255e-02,  1.0085e-01,  ...,  1.3889e-02,
            1.5595e-01, -1.0000e+07],
          [-1.0000e+07, -1.9335e-02,  1.0315e-01,  ...,  4.0021e-03,
            1.3038e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5118e-02,  8.3231e-02,  ..., -1.3387e-02,
            1.5458e-01, -1.0000e+07],
          [-1.0000e+07, -4.0083e-02,  1.3304e-01,  ..., -4.8781e-03,
            1.4860e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.2098e-02,  1.2351e-01],
         [ 1.0181e-01,  1.1222e-01],
         [ 1.3127e-01,  1.5280e-01],
         [ 1.2837e-01,  1.6291e-01],
         [ 9.5852e-02,  1.2428e-01],
         [ 1.3859e-01,  1.5452e-01],
         [ 1.4572e-01,  1.1588e-01],
         [ 1.0700e-01,  1.2083e-01],
         [ 8.6114e-02,  9.4543e-02],
         [ 1.1489e-01,  9.3817e-02],
         [ 1.1854e-01,  1.1548e-01],
         [ 1.2877e-01,  1.0008e-01],
         [ 1.2365e-01,  1.1167e-01],
         [ 1.2197e-01,  1.1521e-01],
         [ 1.2565e-01,  9.1372e-02],
         [ 1.3823e-01,  5.9090e-02],
         [ 1.4876e-01,  8.2787e-02],
         [ 1.6783e-01,  7.9772e-02],
         [ 1.2127e-01,  7.7370e-02],
         [ 1.3090e-01,  9.3493e-02],
         [ 1.4102e-01,  5.1346e-02],
         [-7.4618e-02,  4.9428e-02],
         [-6.6372e-02,  3.0096e-02],
         [-5.7156e-02,  4.4489e-02],
         [ 1.2871e-01,  6.2670e-02],
         [-6.4381e-02,  8.4708e-02],
         [-6.1008e-02,  7.7035e-02],
         [-4.4160e-02,  6.9510e-02],
         [-5.0704e-02,  2.0251e-01],
         [-6.3816e-02,  2.0903e-01],
         [-6.6780e-02,  2.1069e-01],
         [-5.4584e-02,  6.2689e-02],
         [-3.6894e-02,  6.1126e-02],
         [-5.1891e-02,  5.7355e-02],
         [-5.8338e-02,  6.1010e-02],
         [-6.1214e-02,  6.6354e-02],
         [-4.0993e-02,  9.4367e-02],
         [ 9.2642e-02,  1.0019e-01],
         [ 8.5963e-02,  9.1463e-02],
         [ 1.1174e-01,  8.8744e-02],
         [ 1.2427e-01,  7.1726e-02],
         [ 1.1730e-01,  8.2398e-02],
         [ 1.2678e-01,  4.5400e-02],
         [ 1.3248e-01,  7.1729e-02],
         [ 1.2420e-01,  8.2116e-02],
         [-3.8247e-02,  6.7396e-02],
         [-1.9659e-02,  9.0181e-02],
         [ 1.2558e-01,  9.1028e-02],
         [ 1.3972e-01,  8.4169e-02],
         [ 1.0323e-01,  7.2301e-02],
         [ 1.0841e-01,  1.2391e-01],
         [-4.1767e-02,  1.0897e-01],
         [ 1.2142e-01,  1.0291e-01],
         [ 1.4098e-01,  9.9261e-02],
         [ 1.5538e-01,  1.0258e-01],
         [ 1.1230e-01,  7.7386e-02],
         [ 1.0532e-01,  7.2365e-02],
         [-8.5911e-02,  7.3872e-02],
         [ 1.2308e-01,  7.4342e-02],
         [ 1.4949e-01,  8.7137e-02],
         [ 1.5854e-01,  8.3594e-02],
         [ 1.1955e-01,  6.6225e-02],
         [-4.6644e-02,  7.0303e-02],
         [-3.5332e-02,  5.4024e-02],
         [-7.0498e-02,  1.9592e-01],
         [-9.3109e-02,  4.0733e-02],
         [ 1.0553e-01,  5.0641e-02],
         [ 1.0462e-01,  6.0025e-02],
         [ 1.1588e-01,  6.3588e-02],
         [ 1.4457e-01,  8.8946e-02],
         [ 1.2923e-01,  8.8887e-02],
         [-4.6981e-02,  7.0199e-02],
         [-3.0055e-02,  8.7342e-02],
         [-2.8761e-02,  6.9133e-02],
         [-1.3666e-02,  8.4431e-02],
         [ 1.3064e-01,  6.9992e-02],
         [ 1.3462e-01,  7.7782e-02],
         [ 1.1952e-01,  5.8504e-02],
         [ 1.4010e-01,  5.8632e-02],
         [ 1.2437e-01,  8.8969e-02],
         [ 1.3582e-01,  7.8072e-02],
         [ 1.5712e-01,  9.2437e-02],
         [ 1.5892e-01,  7.5126e-02],
         [ 1.7540e-01,  7.1766e-02],
         [ 1.7305e-01,  8.8803e-02],
         [ 1.3542e-01,  8.4649e-02],
         [ 1.6459e-01,  8.5476e-02],
         [ 1.8001e-01,  8.3920e-02],
         [ 1.8920e-01,  8.3836e-02],
         [ 1.3805e-01,  7.5273e-02],
         [ 1.2125e-01,  1.1110e-01],
         [ 9.4732e-02,  9.5379e-02],
         [ 9.2762e-02,  1.2610e-01],
         [ 1.0430e-01,  9.5639e-02],
         [-1.7622e-01,  8.6069e-02],
         [ 9.6552e-02,  1.2411e-01],
         [-1.7206e-01,  1.4164e-01],
         [ 8.9584e-02,  1.6417e-01],
         [ 1.0493e-01,  1.7310e-01],
         [ 1.1298e-01, -1.1580e-02],
         [ 1.1493e-01,  1.5034e-01],
         [ 7.5395e-02,  9.3793e-02],
         [ 1.0367e-01,  6.7430e-02],
         [ 1.1369e-01,  5.5854e-02],
         [ 1.1659e-01,  7.3041e-02],
         [ 1.5662e-01,  9.9545e-02],
         [ 1.8715e-01,  1.2717e-01],
         [ 1.7667e-01,  9.0710e-02],
         [ 1.7780e-01,  6.5056e-02],
         [ 1.5233e-01,  6.0279e-02],
         [ 1.5316e-01,  1.0233e-01],
         [ 1.7230e-01,  7.2476e-02],
         [ 1.2769e-01,  7.3174e-02],
         [ 1.6294e-01,  1.0039e-01],
         [ 1.2044e-01,  1.1008e-01],
         [ 1.5258e-01,  7.6368e-02],
         [ 1.2445e-01,  9.2721e-02],
         [ 1.3184e-01,  9.5908e-02],
         [ 1.5656e-01,  5.3166e-02],
         [ 1.7400e-01,  6.7876e-02],
         [ 1.6731e-01,  8.4690e-02],
         [ 1.5053e-01,  2.2583e-02],
         [ 1.1620e-01,  4.1458e-02],
         [ 1.1952e-01,  5.0637e-02],
         [ 1.1866e-01,  5.4424e-02],
         [ 9.0341e-02,  5.5681e-02],
         [ 1.0129e-01,  5.5831e-02],
         [ 1.0655e-01,  5.5708e-02],
         [ 2.0339e-03,  5.5505e-02]],

        [[ 8.6686e-02,  8.3441e-02],
         [ 1.0085e-01,  1.0315e-01],
         [ 8.3231e-02,  1.3304e-01],
         [ 7.2291e-02,  1.5401e-01],
         [ 8.2169e-02, -5.6758e-02],
         [ 6.2866e-02,  9.4685e-02],
         [ 1.0027e-01,  9.7550e-02],
         [-1.1905e-02,  9.8454e-02],
         [-1.1350e-02, -3.4111e-02],
         [ 1.1924e-01,  9.3700e-02],
         [ 1.1284e-01,  1.2896e-01],
         [ 1.1549e-01,  1.1582e-01],
         [ 1.2162e-01,  1.0359e-01],
         [ 1.2041e-01,  1.2643e-01],
         [ 1.2880e-01,  1.3915e-01],
         [ 1.3106e-01,  1.0946e-01],
         [ 1.5182e-01,  9.4778e-02],
         [ 1.3131e-01,  9.6209e-02],
         [ 1.3657e-01,  1.1828e-01],
         [ 1.4294e-01,  1.3174e-01],
         [ 1.5047e-01,  1.0445e-01],
         [ 1.5419e-01,  1.2028e-01],
         [ 1.7147e-01,  9.8298e-02],
         [ 1.6930e-01,  1.2321e-01],
         [ 1.6958e-01,  1.3129e-01],
         [ 1.7044e-01,  1.3242e-01],
         [ 1.5269e-01,  1.2376e-01],
         [ 1.6755e-01,  1.2512e-01],
         [ 1.6020e-01,  8.7030e-02],
         [ 1.3966e-01,  7.2037e-02],
         [ 1.2975e-01,  1.1015e-01],
         [ 1.5371e-01,  9.3378e-02],
         [ 1.6471e-01,  1.1895e-01],
         [ 1.6677e-01,  1.2493e-01],
         [ 1.6642e-01,  1.3311e-01],
         [ 1.7384e-01,  9.4592e-02],
         [ 1.6792e-01,  1.1451e-01],
         [ 1.7471e-01,  8.3381e-02],
         [ 1.7809e-01,  1.0987e-01],
         [ 1.9126e-01,  1.1483e-01],
         [ 1.6161e-01,  1.1689e-01],
         [ 1.8472e-01,  1.0916e-01],
         [ 1.3878e-01,  1.0439e-01],
         [ 1.6584e-01,  5.1354e-02],
         [ 1.7289e-01,  5.2353e-02],
         [ 1.7895e-01,  3.0770e-02],
         [ 1.8266e-01,  6.9193e-02],
         [ 1.3320e-01,  8.2746e-02],
         [ 1.5810e-01,  1.1346e-01],
         [ 1.5062e-01,  8.7434e-02],
         [ 1.1531e-01,  1.0223e-01],
         [ 1.3845e-01,  9.0026e-02],
         [ 1.5141e-01,  1.0708e-01],
         [ 1.6832e-01,  1.1912e-01],
         [ 1.2114e-01,  1.2683e-01],
         [ 1.4228e-01,  1.2747e-01],
         [ 1.4817e-01,  1.2499e-01],
         [ 1.5489e-01,  1.2427e-01],
         [ 1.6142e-01,  8.6829e-02],
         [ 1.7293e-01,  9.7558e-02],
         [ 1.7877e-01,  1.0302e-01],
         [ 1.8237e-01,  1.0571e-01],
         [ 1.7879e-01,  9.7231e-02],
         [ 1.5722e-01,  5.8121e-02],
         [ 1.7246e-01,  5.7692e-02],
         [ 1.7440e-01,  6.6252e-02],
         [ 1.5098e-01,  1.0012e-01],
         [ 1.5373e-01,  9.2786e-02],
         [ 1.5530e-01,  5.1948e-02],
         [ 1.5479e-01,  6.6802e-02],
         [-1.8752e-03,  7.8884e-02],
         [ 2.5372e-02,  7.5384e-02],
         [ 3.9416e-02,  6.3526e-02],
         [ 4.6116e-02,  6.9743e-02],
         [ 4.9011e-02,  4.4465e-02],
         [ 5.0094e-02,  4.2886e-02],
         [ 5.0416e-02,  5.7762e-02],
         [ 5.0393e-02,  4.1795e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.0411e-05, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.5074, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4638, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3723, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0819, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1969, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0118, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1976743.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2107, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.4475e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1598, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2197, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1598, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14446
target_mac_out tensor([[[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.3231e-02,  8.0496e-02,  ...,  2.7923e-02,
            1.3305e-01, -1.0000e+07],
          [-1.0000e+07, -7.1417e-02,  1.2004e-01,  ...,  2.4416e-02,
            1.4860e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9630e-02,  1.0726e-01,  ...,  2.2145e-02,
            1.4804e-01, -1.0000e+07],
          [-1.0000e+07, -9.3495e-02,  1.4606e-01,  ...,  5.7287e-02,
            1.6459e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.8741e-01,  1.1766e-01,  ...,  4.9425e-02,
            1.8134e-01, -2.9931e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.5737e-01, -1.0000e+07,  ...,  2.5143e-02,
           -1.0000e+07, -2.7119e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-6.0612e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.5201e-02,  6.3473e-02,  ...,  3.5195e-02,
            1.1623e-01, -1.0000e+07],
          [-1.0000e+07, -4.8984e-02,  1.3755e-01,  ...,  6.0357e-02,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.5211e-02,  9.1279e-02,  ...,  2.1207e-02,
            1.2060e-01, -1.0000e+07],
          [-1.0000e+07, -7.1292e-02,  1.1515e-01,  ...,  2.4048e-02,
            1.5225e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.4053e-02,  1.0093e-01,  ...,  1.1269e-02,
            1.2562e-01, -1.0000e+07],
          [-1.0000e+07, -7.7890e-02,  1.1214e-01,  ...,  2.4477e-02,
            1.5387e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.7167e-02,  1.3964e-01],
         [ 8.0496e-02,  1.2004e-01],
         [ 1.0726e-01,  1.4606e-01],
         [ 9.3523e-02,  1.4349e-01],
         [ 1.0879e-01,  1.1393e-01],
         [ 1.2672e-01,  1.2974e-01],
         [ 9.2752e-02,  1.4217e-01],
         [ 1.2148e-01,  1.1962e-01],
         [ 9.6389e-02,  1.5645e-01],
         [ 8.3230e-02,  1.3436e-01],
         [ 9.6210e-02,  1.3968e-01],
         [ 7.8657e-02,  1.6108e-01],
         [ 1.0866e-01,  1.5757e-01],
         [ 8.3794e-02,  1.3765e-01],
         [ 1.0546e-01,  1.2855e-01],
         [ 1.1844e-01,  1.3918e-01],
         [ 1.2047e-01,  1.4636e-01],
         [ 1.3820e-01,  1.2464e-01],
         [ 1.1557e-01,  1.2115e-01],
         [ 1.1945e-01,  9.6703e-02],
         [ 1.4377e-01,  1.1040e-01],
         [-9.9327e-02, -3.3899e-03],
         [-1.0456e-01,  3.2344e-02],
         [-8.9938e-02,  4.7872e-02],
         [ 8.8209e-02,  5.3895e-02],
         [ 1.2080e-01,  5.5818e-02],
         [ 9.1326e-02,  5.6140e-02],
         [ 1.0207e-01,  5.5988e-02],
         [ 1.2134e-01,  5.5728e-02],
         [ 9.6242e-02,  5.5511e-02],
         [ 8.7585e-02,  5.5376e-02],
         [ 1.0415e-01,  5.5264e-02],
         [ 7.8302e-02,  5.5241e-02],
         [ 1.1127e-01,  5.5227e-02],
         [ 1.5893e-01,  5.5225e-02],
         [-5.2042e-02,  5.5210e-02],
         [ 1.9383e-01,  5.5204e-02],
         [ 2.0543e-01,  5.5207e-02],
         [ 2.1276e-01,  5.5214e-02],
         [-1.0647e-01,  5.5221e-02],
         [ 1.6496e-01,  5.5218e-02],
         [ 1.4782e-01,  5.5221e-02],
         [ 3.5972e-02,  5.5232e-02],
         [ 4.0702e-02,  5.5230e-02],
         [ 1.4059e-01,  5.5230e-02],
         [ 1.3764e-01,  5.5234e-02],
         [ 1.4770e-01,  5.5235e-02],
         [ 1.4024e-01,  5.5235e-02],
         [ 9.6687e-02,  5.5232e-02],
         [ 1.0963e-01,  5.5232e-02],
         [ 8.4861e-02,  5.5231e-02],
         [ 9.0213e-02,  5.5231e-02],
         [ 6.9967e-02,  5.5231e-02],
         [ 1.2361e-01,  5.5231e-02],
         [ 1.1766e-01,  5.5231e-02],
         [-2.7119e-01,  5.5231e-02],
         [-6.0612e-04,  5.5231e-02]],

        [[ 6.3473e-02,  1.3755e-01],
         [ 9.1279e-02,  1.1515e-01],
         [ 1.0093e-01,  1.1214e-01],
         [ 8.3408e-02,  1.3576e-01],
         [ 7.9209e-02,  1.0206e-01],
         [ 1.0057e-01,  1.2732e-01],
         [ 1.1892e-01,  1.2457e-01],
         [ 1.2724e-01,  9.1945e-02],
         [ 1.4134e-01,  9.1062e-02],
         [ 1.4794e-01,  1.4033e-01],
         [ 1.6056e-01,  1.4674e-01],
         [ 1.6301e-01,  1.6753e-01],
         [ 1.2843e-01,  1.5944e-01],
         [ 1.1449e-01,  1.7691e-01],
         [ 1.5097e-01,  1.4170e-01],
         [ 1.2594e-01,  1.1627e-01],
         [ 1.4474e-01,  1.5823e-01],
         [ 1.1371e-01,  1.2541e-01],
         [ 1.4724e-01,  1.0012e-01],
         [ 1.5252e-01,  1.2846e-01],
         [ 1.3304e-01,  1.1557e-01],
         [ 1.6473e-01,  1.5219e-01],
         [ 1.6653e-01,  1.6103e-01],
         [ 1.7472e-01,  1.6198e-01],
         [ 1.6883e-01,  1.6077e-01],
         [ 1.3070e-01,  1.5367e-01],
         [ 1.0355e-01,  1.4945e-01],
         [ 1.4977e-01,  1.4820e-01],
         [ 1.3066e-01,  1.1720e-01],
         [ 1.4161e-01,  1.2849e-01],
         [ 1.5576e-01,  1.3416e-01],
         [ 1.6159e-01,  1.3788e-01],
         [ 1.5110e-01, -2.4261e-02],
         [ 1.0446e-01,  2.0037e-02],
         [ 9.9204e-02,  4.0845e-02],
         [ 8.6867e-02,  5.0098e-02],
         [ 1.2751e-01,  5.3921e-02],
         [ 1.2922e-01,  5.5303e-02],
         [ 1.3052e-01,  5.5682e-02],
         [ 9.7611e-02,  5.5640e-02],
         [ 1.2889e-01,  5.5540e-02],
         [ 9.4108e-02,  5.5443e-02],
         [ 7.9089e-02,  5.5330e-02],
         [ 8.5821e-02,  5.5257e-02],
         [ 8.3409e-02,  5.5233e-02],
         [ 6.6807e-02,  5.5241e-02],
         [ 6.0362e-02,  5.5225e-02],
         [ 3.3302e-02,  5.5206e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.8735e-05, device='cuda:0') tensor(0.0014, device='cuda:0') tensor(-0.0027, device='cuda:0')
mixer_td_error tensor(0.1844, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4605, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6235, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0900, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2053, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0133, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-789473.5625, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2128, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.3849e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0017, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0817, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3243, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0817, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14492
target_mac_out tensor([[[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3268e-01,  1.1815e-01,  ...,  6.9543e-02,
            1.6155e-01, -1.0000e+07],
          [-1.0000e+07, -2.7664e-02,  1.0133e-01,  ...,  1.0988e-02,
            1.3958e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6339e-01,  1.3025e-01,  ...,  7.9943e-02,
            1.7916e-01, -3.7833e-01],
          [-1.0000e+07, -5.6401e-02,  1.3878e-01,  ...,  3.7180e-02,
            1.4673e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.4217e-02,  9.7490e-02,  ...,  1.8749e-02,
            1.4294e-01, -1.0000e+07],
          [-1.0000e+07, -3.3300e-02,  1.2803e-01,  ...,  2.2223e-02,
            1.4786e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3230e-01,  1.1854e-01,  ...,  4.8828e-02,
            1.5984e-01, -1.0000e+07],
          [-1.0000e+07, -4.5349e-02,  1.4071e-01,  ...,  7.4099e-03,
            1.5504e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -6.9411e-02,  1.3614e-01,  ...,  4.1688e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -6.4620e-02,  1.3644e-01,  ...,  3.4212e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.5757e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0827e-01,  1.0736e-01],
         [ 1.1815e-01,  1.0133e-01],
         [ 1.3025e-01,  1.3878e-01],
         [ 1.3240e-01,  1.1431e-01],
         [ 1.0448e-01,  1.4918e-01],
         [ 1.2436e-01,  1.7915e-01],
         [ 1.2844e-01,  1.8166e-01],
         [ 1.3229e-01,  1.9128e-01],
         [ 1.3505e-01,  1.8584e-01],
         [ 1.0547e-01,  1.4130e-01],
         [ 8.2169e-02, -1.9085e-01],
         [ 1.0412e-01, -1.9374e-01],
         [ 6.1420e-02, -1.7703e-01],
         [ 5.8766e-02, -1.6345e-01],
         [ 1.3083e-01,  9.9431e-02],
         [ 8.9016e-02,  7.0875e-02],
         [ 2.8278e-02, -1.3665e-01],
         [ 3.4007e-02,  1.0005e-01],
         [ 1.1510e-01,  1.1522e-01],
         [ 1.4223e-01,  1.1503e-01],
         [-7.6913e-02,  8.1579e-02],
         [ 3.4286e-02,  8.9438e-02],
         [ 4.8491e-02,  6.6553e-02],
         [ 5.2648e-02,  5.6278e-02],
         [ 5.3158e-02,  8.9652e-02],
         [ 5.2547e-02,  1.0503e-01],
         [ 5.1760e-02,  9.2597e-02],
         [ 5.1121e-02,  5.7361e-02],
         [ 5.0658e-02,  5.1441e-02],
         [ 5.0389e-02,  9.0533e-02],
         [ 5.0232e-02,  6.7912e-02],
         [ 5.0121e-02,  9.5607e-02],
         [ 5.0043e-02,  6.7202e-02],
         [ 5.0036e-02,  9.4253e-02],
         [ 5.0026e-02,  5.6716e-02],
         [ 5.0025e-02,  8.9315e-02],
         [ 5.0005e-02, -1.9228e-01],
         [ 5.0005e-02,  4.0328e-02],
         [ 5.0012e-02,  4.2815e-02],
         [ 5.0015e-02,  3.6041e-02],
         [ 5.0016e-02,  5.3236e-02],
         [ 5.0014e-02, -1.8276e-01],
         [ 5.0008e-02, -1.9434e-01],
         [ 5.0007e-02,  2.7962e-02],
         [ 5.0007e-02,  1.3797e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.4778e-02,  1.0692e-01],
         [ 9.7490e-02,  1.2803e-01],
         [ 1.1854e-01,  1.4071e-01],
         [ 1.0259e-01,  1.1499e-01],
         [ 8.4293e-02,  1.1561e-01],
         [-9.6182e-02,  1.2476e-01],
         [ 8.6316e-02,  1.4469e-01],
         [-9.6711e-02, -6.8270e-02],
         [-7.9520e-02,  1.0224e-01],
         [ 7.9288e-02,  1.3993e-01],
         [ 8.6331e-02, -5.7388e-02],
         [ 1.1815e-01,  1.1046e-01],
         [ 1.4876e-01,  1.4088e-01],
         [ 1.5805e-01, -2.4078e-02],
         [ 1.6790e-01,  1.0731e-01],
         [-2.5970e-02,  1.0834e-01],
         [-2.0731e-02,  1.3156e-01],
         [-2.8481e-02,  1.4691e-01],
         [ 1.8290e-01,  1.5255e-01],
         [ 1.8902e-01,  1.2484e-01],
         [ 1.8604e-01,  1.2053e-01],
         [ 1.8226e-01,  1.3660e-01],
         [-5.8118e-02,  1.7132e-01],
         [ 2.0330e-01,  1.7045e-01],
         [ 2.0560e-01,  1.3024e-01],
         [ 1.5839e-01,  1.6974e-01],
         [ 1.4874e-01,  1.2769e-01],
         [ 3.5740e-02,  1.0989e-01],
         [ 3.8058e-02,  9.4936e-02],
         [ 1.4914e-01,  8.2643e-02],
         [ 1.6866e-01,  7.6248e-02],
         [ 1.8473e-01,  8.1264e-02],
         [ 2.0071e-01,  7.7982e-02],
         [ 4.6965e-02,  1.2010e-01],
         [ 5.1253e-02, -3.5816e-02],
         [ 1.5096e-01, -3.7423e-02],
         [ 3.5237e-02, -6.5523e-02],
         [ 1.6263e-01,  1.3408e-01],
         [ 5.4250e-02, -5.0720e-02],
         [ 5.1162e-02, -1.8975e-02],
         [ 1.3027e-01, -2.8438e-02],
         [ 1.8568e-02,  7.9970e-02],
         [ 1.5250e-01,  1.6247e-01],
         [ 1.7021e-01,  1.9629e-01],
         [ 1.9954e-03, -4.2088e-02],
         [ 2.8970e-02, -4.8359e-02],
         [ 4.1878e-02, -6.4488e-02],
         [ 4.7580e-02, -7.3957e-02],
         [ 4.9869e-02,  1.0036e-01],
         [ 5.0584e-02,  1.0056e-01],
         [ 5.0700e-02,  1.3644e-01],
         [ 5.0574e-02, -4.5883e-02],
         [ 5.0422e-02, -5.1350e-02],
         [ 5.0282e-02, -4.9044e-02],
         [ 5.0175e-02,  7.9118e-02],
         [ 5.0106e-02,  5.0344e-02],
         [ 5.0084e-02,  7.6408e-02],
         [ 5.0046e-02,  1.2392e-01],
         [ 5.0043e-02,  1.4399e-01],
         [ 5.0017e-02,  8.9796e-02],
         [ 5.0005e-02,  8.9708e-02],
         [ 5.0016e-02,  2.5425e-04],
         [ 5.0018e-02,  1.4471e-01],
         [ 5.0012e-02,  1.6119e-01],
         [ 5.0013e-02, -1.7514e-02],
         [ 5.0005e-02,  9.5694e-02],
         [ 5.0007e-02,  9.9850e-02],
         [ 5.0008e-02,  1.4352e-01],
         [ 5.0007e-02,  1.6075e-01],
         [ 5.0008e-02, -7.7200e-03],
         [ 5.0008e-02,  1.4335e-02],
         [ 5.0008e-02,  2.9275e-03],
         [ 5.0008e-02, -2.0975e-02],
         [ 5.0008e-02, -3.6214e-02],
         [ 5.0008e-02,  8.5325e-02],
         [ 5.0008e-02,  9.8755e-02],
         [ 5.0009e-02,  7.3100e-02],
         [ 5.0009e-02,  5.8293e-02],
         [ 5.0009e-02,  7.9742e-02],
         [ 5.0009e-02,  6.3366e-02],
         [ 5.0009e-02,  4.0312e-02],
         [ 5.0009e-02,  3.1575e-02],
         [ 5.0009e-02,  4.1601e-02],
         [ 5.0009e-02, -4.4892e-02],
         [ 5.0009e-02,  7.2323e-02],
         [ 5.0009e-02,  8.7829e-02],
         [ 5.0009e-02,  9.5387e-02],
         [ 5.0009e-02,  1.4090e-01],
         [ 5.0009e-02, -3.3234e-02],
         [ 5.0009e-02,  1.0727e-01],
         [ 5.0009e-02, -7.4353e-02],
         [ 5.0009e-02,  1.0245e-01],
         [ 5.0009e-02,  1.3744e-01],
         [ 5.0009e-02,  1.5157e-01],
         [ 5.0009e-02,  1.5762e-01],
         [ 5.0009e-02, -4.9031e-02],
         [ 5.0009e-02, -5.5781e-02],
         [ 5.0009e-02,  8.4281e-02],
         [ 5.0009e-02,  5.1636e-02],
         [ 5.0009e-02,  8.0487e-02],
         [ 5.0009e-02, -6.9534e-02],
         [ 5.0009e-02,  8.2849e-02],
         [ 5.0009e-02,  9.7779e-02],
         [ 5.0009e-02, -3.6765e-02],
         [ 5.0009e-02, -4.4740e-02],
         [ 5.0009e-02,  7.9294e-02],
         [ 5.0009e-02,  6.3002e-02],
         [ 5.0009e-02,  4.0017e-02],
         [ 5.0009e-02,  7.0956e-02],
         [ 5.0009e-02,  6.0099e-02],
         [ 5.0009e-02,  8.1523e-02],
         [ 5.0009e-02,  9.3236e-02],
         [ 5.0009e-02,  7.1318e-02],
         [ 5.0009e-02,  4.4789e-02],
         [ 5.0009e-02, -6.0355e-02],
         [ 5.0009e-02,  7.1347e-02],
         [ 5.0009e-02, -5.6993e-02],
         [ 5.0009e-02, -4.8906e-02],
         [ 5.0009e-02, -5.0532e-02],
         [ 5.0009e-02,  7.8030e-02],
         [ 5.0009e-02,  9.1682e-02],
         [ 5.0009e-02,  9.9031e-02],
         [ 5.0009e-02,  7.4756e-02],
         [ 5.0009e-02,  8.6609e-02],
         [ 5.0009e-02,  9.6531e-02],
         [ 5.0009e-02,  5.9409e-02],
         [ 5.0009e-02, -6.3228e-02],
         [ 5.0009e-02, -5.8140e-02],
         [ 5.0009e-02,  7.2478e-02],
         [ 5.0009e-02,  9.0525e-02],
         [ 5.0009e-02,  9.8736e-02],
         [ 5.0009e-02,  1.0279e-01],
         [ 5.0009e-02,  6.2689e-02],
         [ 5.0009e-02,  4.4229e-02],
         [ 5.0009e-02,  3.4935e-02],
         [ 5.0009e-02,  6.8574e-02],
         [ 5.0009e-02,  2.1499e-03],
         [ 5.0009e-02, -3.5826e-03],
         [ 5.0009e-02,  1.5339e-01],
         [ 5.0009e-02, -3.5541e-02],
         [ 5.0009e-02, -4.6587e-02],
         [ 5.0009e-02,  8.2010e-02],
         [ 5.0009e-02,  9.4065e-02],
         [ 5.0009e-02, -6.5794e-02],
         [ 5.0009e-02, -1.3147e-02],
         [ 5.0009e-02,  1.4786e-01],
         [ 5.0009e-02,  1.6544e-01],
         [ 5.0009e-02,  1.7134e-01],
         [ 5.0009e-02,  3.8423e-03],
         [ 5.0009e-02, -1.8788e-02],
         [ 5.0009e-02,  4.3528e-03],
         [ 5.0009e-02,  1.4196e-01],
         [ 5.0009e-02,  8.3280e-03],
         [ 5.0009e-02,  1.9480e-02],
         [ 5.0009e-02,  1.6052e-02],
         [ 5.0009e-02,  1.2279e-02],
         [ 5.0009e-02,  8.4813e-04],
         [ 5.0009e-02, -3.2182e-02],
         [ 5.0009e-02,  8.2809e-02],
         [ 5.0009e-02,  5.3017e-02],
         [ 5.0009e-02,  7.7851e-02],
         [ 5.0009e-02,  1.2456e-01],
         [ 5.0009e-02,  2.5839e-03],
         [ 5.0009e-02, -4.9291e-03],
         [ 5.0009e-02, -2.6017e-02],
         [ 5.0009e-02,  9.7825e-02],
         [ 5.0009e-02,  1.0099e-01],
         [ 5.0009e-02, -6.9396e-02],
         [ 5.0009e-02, -1.7315e-02],
         [ 5.0009e-02, -4.5440e-03],
         [ 5.0009e-02,  8.9454e-02],
         [ 5.0009e-02, -4.8214e-02],
         [ 5.0009e-02, -3.6485e-02],
         [ 5.0009e-02, -1.1976e-02],
         [ 5.0009e-02, -2.3122e-02],
         [ 5.0009e-02,  9.1900e-02],
         [ 5.0009e-02, -1.2851e-02],
         [ 5.0009e-02, -2.5008e-02],
         [ 5.0009e-02, -4.8236e-02],
         [ 5.0009e-02, -6.3153e-02],
         [ 5.0009e-02,  1.0144e-01],
         [ 5.0009e-02,  1.2333e-01],
         [ 5.0009e-02,  1.2920e-01],
         [ 5.0009e-02,  9.8839e-02],
         [ 5.0009e-02,  6.5620e-02],
         [ 5.0009e-02,  5.1518e-02],
         [ 5.0009e-02,  4.4211e-02],
         [ 5.0009e-02,  4.0415e-02],
         [ 5.0009e-02,  6.8205e-02],
         [ 5.0009e-02,  8.0529e-02],
         [ 5.0009e-02,  7.2608e-02],
         [ 5.0009e-02,  4.1207e-02],
         [ 5.0009e-02,  3.3094e-02],
         [ 5.0009e-02,  7.3504e-02],
         [ 5.0009e-02,  8.4648e-02],
         [ 5.0009e-02,  1.2947e-01],
         [ 5.0009e-02,  9.2343e-02],
         [ 5.0009e-02,  1.0551e-01],
         [ 5.0009e-02,  9.7162e-02],
         [ 5.0009e-02,  8.9866e-02],
         [ 5.0009e-02,  1.2590e-01],
         [ 5.0009e-02,  8.9671e-02],
         [ 5.0009e-02,  8.5952e-02],
         [ 5.0009e-02,  1.2022e-01],
         [ 5.0009e-02,  9.8033e-02],
         [ 5.0009e-02,  1.2872e-01],
         [ 5.0009e-02,  1.4031e-01],
         [ 5.0009e-02,  9.5702e-02],
         [ 5.0009e-02,  8.8656e-02],
         [ 5.0009e-02,  1.2188e-01],
         [ 5.0009e-02,  1.4376e-01],
         [ 5.0009e-02,  1.4799e-01],
         [ 5.0009e-02,  1.5732e-01],
         [ 5.0009e-02, -9.9731e-02],
         [ 5.0009e-02,  1.1251e-01],
         [ 5.0009e-02,  1.1375e-01],
         [ 5.0009e-02,  1.0145e-01],
         [ 5.0009e-02,  6.1650e-02],
         [ 5.0009e-02,  6.6409e-02],
         [ 5.0009e-02,  7.6731e-02],
         [ 5.0009e-02,  4.3948e-02],
         [ 5.0009e-02,  3.7209e-02],
         [ 5.0009e-02,  6.8612e-02],
         [ 5.0009e-02,  1.1141e-01],
         [ 5.0009e-02,  1.3614e-01],
         [ 5.0009e-02,  1.3644e-01],
         [ 5.0009e-02,  2.5757e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.2490e-06, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0007, device='cuda:0')
mixer_td_error tensor(0.9926, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5628, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6653, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0629, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2009, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0048, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-4008809.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2056, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(9.3633e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0931, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.3373, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0931, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14536
target_mac_out tensor([[[[-1.0000e+07, -9.8799e-02,  1.1017e-01,  ...,  6.1516e-02,
            1.3971e-01, -1.0000e+07],
          [-1.0000e+07, -2.8322e-02,  1.2490e-01,  ...,  1.4773e-02,
            1.3610e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3343e-01,  1.1844e-01,  ...,  4.7984e-02,
            1.3981e-01, -1.0000e+07],
          [-1.0000e+07, -2.8237e-02,  1.2745e-01,  ..., -2.7338e-03,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6363e-01,  1.2422e-01,  ...,  4.4419e-02,
            1.5108e-01, -1.0000e+07],
          [-1.0000e+07, -5.3177e-02,  1.4268e-01,  ..., -5.0646e-03,
            1.5281e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -6.8708e-02,  1.0552e-01,  ...,  2.2667e-03,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -9.4268e-02,  6.3827e-02,  ...,  2.2878e-03,
            1.8517e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.2013e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5738e-02,  1.0228e-01,  ...,  3.4988e-02,
            1.5796e-01, -1.0000e+07],
          [-1.0000e+07, -8.0973e-02,  1.6355e-01,  ...,  7.3632e-02,
            1.5107e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2805e-01,  1.2984e-01,  ...,  5.9490e-02,
            1.6077e-01, -1.0000e+07],
          [-1.0000e+07, -1.0194e-01,  1.8205e-01,  ...,  8.2841e-02,
            1.6697e-01, -3.2238e-01]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1017e-01,  1.2490e-01],
         [ 1.1844e-01,  1.2745e-01],
         [ 1.2422e-01,  1.4268e-01],
         [ 1.3051e-01,  1.1298e-01],
         [ 1.3147e-01,  1.3179e-01],
         [ 4.1332e-02, -7.4159e-02],
         [ 1.2090e-01, -5.8872e-02],
         [ 1.2612e-01, -5.9574e-02],
         [ 1.2727e-01, -6.6804e-02],
         [ 1.3672e-01, -7.4026e-02],
         [-7.0255e-02, -8.0024e-02],
         [-7.8474e-02, -8.0428e-02],
         [-6.5204e-02, -6.8041e-02],
         [-8.1784e-02, -5.8653e-02],
         [-8.0411e-02, -5.2505e-02],
         [-6.4931e-02, -4.2145e-02],
         [-5.9809e-02, -4.0853e-02],
         [ 1.4972e-01, -4.3319e-02],
         [-6.7696e-02, -4.2638e-02],
         [ 1.4989e-01, -5.7245e-02],
         [ 1.5719e-01, -6.9798e-02],
         [ 1.5880e-01,  1.1447e-01],
         [ 1.6780e-01,  1.2375e-01],
         [ 1.7128e-01,  8.0380e-02],
         [ 1.7823e-01,  1.2402e-01],
         [ 1.8855e-01,  6.8178e-02],
         [ 1.7320e-01,  8.2250e-02],
         [ 1.8480e-01,  4.9093e-02],
         [ 1.4294e-01, -1.1544e-01],
         [ 1.2077e-01, -9.0418e-02],
         [-1.6970e-01, -6.9405e-02],
         [-1.4355e-01, -7.7630e-02],
         [-1.4655e-01, -8.7154e-02],
         [ 1.0471e-01, -9.4437e-02],
         [ 1.8257e-01, -9.9112e-02],
         [-1.2028e-01, -1.0166e-01],
         [ 1.1790e-01, -1.0440e-01],
         [ 1.1371e-01, -4.4184e-02],
         [ 1.1304e-01, -2.8421e-02],
         [ 1.2600e-01, -2.9089e-02],
         [ 1.5394e-01, -6.4495e-02],
         [ 1.8339e-01,  9.4833e-02],
         [ 1.9041e-01,  7.4146e-02],
         [ 1.9214e-01,  4.1163e-02],
         [ 1.7646e-01,  5.2779e-02],
         [ 1.8058e-01, -9.2077e-02],
         [ 1.9295e-01, -9.8178e-02],
         [ 1.3692e-01, -9.3145e-02],
         [ 1.1150e-01, -7.3685e-02],
         [-1.1246e-02, -5.6203e-02],
         [ 2.2054e-02, -4.7014e-02],
         [ 3.8509e-02, -6.0521e-02],
         [ 4.6143e-02, -7.3359e-02],
         [ 4.9355e-02, -8.3762e-02],
         [ 5.0477e-02, -9.1271e-02],
         [ 5.0722e-02, -9.6302e-02],
         [ 5.0638e-02, -7.8619e-02],
         [ 5.0462e-02, -7.5453e-02],
         [ 5.0316e-02, -6.3359e-02],
         [ 5.0182e-02, -6.4955e-02],
         [ 5.0093e-02, -6.2102e-02],
         [ 5.0047e-02,  6.8113e-02],
         [ 5.0025e-02, -8.2540e-02],
         [ 5.0042e-02, -6.6779e-02],
         [ 5.0020e-02, -7.5943e-02],
         [ 5.0010e-02, -8.2630e-02],
         [ 5.0015e-02, -1.0249e-01],
         [ 5.0012e-02, -1.1340e-01],
         [ 5.0010e-02,  1.1883e-01],
         [ 5.0019e-02, -1.2437e-01],
         [ 5.0005e-02,  8.3566e-02],
         [ 5.0007e-02,  1.0285e-01],
         [ 5.0007e-02,  6.8261e-02],
         [ 5.0007e-02,  1.0817e-01],
         [ 5.0008e-02,  1.2059e-01],
         [ 5.0008e-02,  7.9393e-02],
         [ 5.0008e-02,  5.2956e-02],
         [ 5.0008e-02,  7.2471e-02],
         [ 5.0008e-02, -1.1478e-01],
         [ 5.0008e-02, -8.4307e-02],
         [ 5.0008e-02, -7.1453e-02],
         [ 5.0009e-02, -7.9510e-02],
         [ 5.0009e-02, -6.9215e-02],
         [ 5.0009e-02,  1.3685e-01],
         [ 5.0009e-02, -1.0644e-01],
         [ 5.0009e-02,  1.0332e-01],
         [ 5.0009e-02, -1.0264e-01],
         [ 5.0009e-02, -1.1688e-01],
         [ 5.0009e-02, -8.9931e-02],
         [ 5.0009e-02, -1.1239e-01],
         [ 5.0009e-02, -7.9518e-02],
         [ 5.0009e-02,  1.0552e-01],
         [ 5.0009e-02, -9.4268e-02],
         [ 5.0009e-02,  2.2013e-02]],

        [[ 7.4276e-02,  1.4162e-01],
         [ 1.0228e-01,  1.6355e-01],
         [ 1.2984e-01,  1.8205e-01],
         [ 1.1608e-01,  1.7242e-01],
         [ 1.0586e-01,  1.8131e-01],
         [ 1.2123e-01,  1.8342e-01],
         [ 1.4362e-01, -1.2364e-01],
         [ 1.2410e-01, -1.5820e-01],
         [ 1.1639e-01,  1.4319e-01],
         [ 1.3190e-01,  1.6549e-01],
         [ 1.3475e-01,  1.6871e-01],
         [ 1.3023e-01,  1.6358e-01],
         [ 9.3521e-02, -1.6489e-01],
         [ 1.0718e-01, -1.7209e-01],
         [ 1.1700e-01, -1.4678e-01],
         [ 8.8294e-02, -1.7339e-01],
         [ 7.9741e-02, -1.7766e-01],
         [-1.4074e-01, -1.9077e-01],
         [-9.5303e-02, -1.8903e-01],
         [-1.1072e-01, -1.7979e-01],
         [-1.1026e-01, -1.8439e-01],
         [ 1.0655e-01, -1.6739e-01],
         [ 1.2970e-01, -1.8444e-01],
         [ 1.0045e-01, -1.8400e-01],
         [-1.4948e-01, -2.0291e-01],
         [ 1.1361e-01, -2.1274e-01],
         [ 1.2413e-01, -1.7512e-01],
         [-9.8656e-02, -1.5384e-01],
         [-8.0225e-02, -1.5120e-01],
         [ 1.5795e-01,  6.0806e-02],
         [-9.0828e-02,  4.5966e-02],
         [ 1.5687e-01,  3.6365e-02],
         [-1.1539e-01,  6.0733e-02],
         [ 1.4961e-01,  9.1932e-02],
         [ 1.3780e-01, -9.8082e-03],
         [ 1.2532e-01,  2.4600e-02],
         [ 1.4481e-01,  4.1741e-02],
         [ 1.3734e-01,  4.9681e-02],
         [ 1.4299e-01,  5.3104e-02],
         [ 9.4608e-02,  5.4500e-02],
         [-1.5543e-01,  5.5018e-02],
         [ 9.0299e-02,  5.5161e-02],
         [ 9.8227e-02,  5.5194e-02],
         [ 1.0681e-01,  5.5195e-02],
         [ 1.1623e-01,  5.5178e-02],
         [-2.2579e-02,  5.5179e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.6509e-05, device='cuda:0') tensor(0.0023, device='cuda:0') tensor(-0.0017, device='cuda:0')
mixer_td_error tensor(0.6632, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4588, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9889, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0739, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1812, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0014, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2553191., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1930, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.8550e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0017, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1427, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3150, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1427, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14619
target_mac_out tensor([[[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1402e-02,  8.1983e-02,  ...,  3.9429e-02,
            1.3744e-01, -1.0000e+07],
          [-1.0000e+07, -3.2219e-02,  9.6327e-02,  ..., -1.4636e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2918e-02,  8.3033e-02,  ...,  1.5905e-03,
            1.3806e-01, -1.0000e+07],
          [-1.0000e+07, -4.3941e-02,  1.2828e-01,  ...,  1.4506e-02,
            1.4886e-01, -1.0000e+07]],

         ...,

         [[ 5.0062e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1756e-01,  6.2249e-02,  ...,  7.2620e-02,
            1.8534e-01, -1.0000e+07]],

         [[ 5.0040e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3118e-01,  7.9832e-02,  ...,  8.7176e-02,
            1.9510e-01, -1.0000e+07]],

         [[ 5.0049e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.4158e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2179e-02,  8.7653e-02,  ...,  1.1971e-02,
            1.4701e-01, -1.0000e+07],
          [-1.0000e+07, -3.7128e-02,  1.3220e-01,  ...,  9.6965e-03,
            1.4422e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2015e-01,  1.1093e-01,  ...,  4.2340e-02,
            1.6688e-01, -1.0000e+07],
          [-1.0000e+07, -5.8526e-02,  1.5231e-01,  ..., -4.5886e-04,
            1.5562e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0780e-01,  8.9914e-02],
         [ 3.9429e-02,  9.6327e-02],
         [-7.2918e-02, -4.3941e-02],
         [-8.7103e-02, -4.5109e-02],
         [-1.1015e-01, -5.8668e-02],
         [ 4.0030e-02,  9.7676e-02],
         [-9.7095e-02, -6.0145e-02],
         [-7.6133e-02, -5.1762e-02],
         [-8.9235e-02, -5.1922e-02],
         [-6.7292e-02, -6.2554e-02],
         [-6.5269e-02, -6.6925e-02],
         [-9.1613e-02, -6.3487e-02],
         [-1.0219e-01, -7.7137e-02],
         [-8.5358e-02, -8.0348e-02],
         [-1.0168e-01, -7.5786e-02],
         [-6.0172e-02, -7.3815e-02],
         [-2.1922e-02, -6.7031e-02],
         [-3.9386e-02, -6.8664e-02],
         [-6.4434e-02, -6.4707e-02],
         [-5.4748e-02, -2.6864e-02],
         [-7.6566e-02, -2.1727e-02],
         [-3.4783e-02, -2.0110e-02],
         [-3.3058e-02, -2.8294e-03],
         [-4.1090e-02, -2.0002e-02],
         [-6.0319e-02, -3.2747e-02],
         [-8.0236e-02, -5.0096e-02],
         [-7.9405e-02, -6.6565e-02],
         [ 1.5257e-01, -9.4225e-02],
         [ 1.6329e-01, -8.7534e-02],
         [ 1.6940e-01,  1.4631e-01],
         [ 1.8631e-01,  1.4684e-01],
         [ 1.5079e-01,  1.6469e-01],
         [ 1.5646e-01,  1.4066e-01],
         [ 1.5936e-01,  1.0854e-01],
         [ 1.6924e-01,  1.3301e-01],
         [ 1.3913e-01,  1.0097e-01],
         [ 1.6944e-01,  1.0643e-01],
         [ 1.4515e-01,  1.1705e-01],
         [ 1.6190e-01, -9.0985e-02],
         [ 1.7382e-01, -8.7942e-02],
         [ 1.8228e-01,  1.5498e-01],
         [ 1.8840e-01,  1.2613e-01],
         [ 1.8909e-01,  1.5074e-01],
         [ 1.6448e-01,  1.2795e-01],
         [ 1.2279e-01, -8.4086e-02],
         [ 1.3814e-01, -5.1586e-02],
         [ 1.3328e-01, -8.0809e-02],
         [ 1.3287e-01, -5.4521e-02],
         [-2.1504e-01, -6.2789e-02],
         [-2.8213e-01, -9.1137e-02],
         [-2.6737e-01, -1.0182e-01],
         [-2.5323e-01, -1.1956e-01],
         [-2.4693e-01, -1.2219e-01],
         [-1.8092e-01, -1.4022e-01],
         [-1.5370e-01, -1.4611e-01],
         [ 5.3851e-03, -1.5797e-01],
         [ 3.0878e-02, -1.6128e-01],
         [ 4.3042e-02, -1.7397e-01],
         [ 4.8367e-02, -1.5752e-01],
         [ 5.0411e-02, -1.6190e-01],
         [ 5.0932e-02, -1.3685e-01],
         [ 5.0872e-02, -1.4828e-01],
         [ 5.0672e-02, -1.4777e-01],
         [ 5.0470e-02, -1.3951e-01],
         [ 5.0299e-02, -1.2128e-01],
         [ 5.0180e-02, -1.0585e-01],
         [ 5.0109e-02, -9.9846e-02],
         [ 5.0062e-02, -1.1756e-01],
         [ 5.0040e-02, -1.3118e-01],
         [ 5.0049e-02,  4.4158e-03]],

        [[ 1.0780e-01,  8.9914e-02],
         [ 8.7653e-02,  1.3220e-01],
         [ 1.1093e-01,  1.5231e-01],
         [ 1.0750e-01, -6.7599e-02],
         [ 1.0878e-01, -6.9425e-02],
         [ 1.2077e-01, -4.7316e-02],
         [ 1.2014e-01, -4.6827e-02],
         [ 1.1751e-01, -4.1586e-02],
         [ 1.3833e-01, -4.9353e-02],
         [ 1.1793e-01, -5.0095e-02],
         [ 1.3786e-01, -5.0569e-02],
         [ 1.4762e-01, -7.0791e-02],
         [ 1.4024e-01, -8.0475e-02],
         [ 1.2198e-01,  9.4244e-02],
         [ 1.4740e-01,  9.5812e-02],
         [ 1.2848e-01,  8.9399e-02],
         [ 1.5353e-01,  1.4532e-01],
         [ 1.5919e-01, -1.2366e-01],
         [ 5.1771e-02, -1.1940e-01],
         [ 1.4097e-01,  1.4455e-01],
         [ 1.5976e-01,  1.1515e-01],
         [ 1.6824e-01, -1.6698e-01],
         [ 1.6872e-01, -1.6571e-01],
         [-1.5091e-02, -1.5991e-01],
         [ 1.5324e-02, -1.4625e-01],
         [ 3.3489e-02, -1.4509e-01],
         [ 4.2879e-02, -1.6873e-01],
         [ 4.7309e-02,  1.1732e-01],
         [ 4.9243e-02, -1.6561e-01],
         [ 4.9963e-02,  8.7944e-02],
         [ 5.0185e-02,  1.1835e-01],
         [ 5.0204e-02,  1.2511e-01],
         [ 5.0173e-02,  1.1752e-01],
         [ 5.0137e-02,  1.2380e-01],
         [ 5.0087e-02, -1.9576e-01],
         [ 5.0049e-02, -1.9460e-01],
         [ 5.0025e-02, -1.7806e-01],
         [ 5.0021e-02,  9.1969e-02],
         [ 5.0028e-02,  1.0535e-01],
         [ 5.0030e-02,  1.0558e-01],
         [ 5.0016e-02, -2.0247e-01],
         [ 5.0017e-02, -1.9910e-01],
         [ 5.0020e-02, -2.0062e-01],
         [ 5.0016e-02, -1.6392e-01],
         [ 5.0007e-02, -1.5541e-01],
         [ 5.0007e-02, -1.8117e-01],
         [ 5.0008e-02,  1.0281e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.9873e-05, device='cuda:0') tensor(0.0033, device='cuda:0') tensor(-0.0020, device='cuda:0')
mixer_td_error tensor(0.4164, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4532, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7119, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0685, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1549, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0197, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1642856.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1891, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.9922e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0023, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1166, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3754, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1166, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14685
target_mac_out tensor([[[[-1.0000e+07, -6.0082e-02,  8.4218e-02,  ...,  2.3512e-02,
            1.2572e-01, -1.0000e+07],
          [-1.0000e+07, -1.1235e-02,  1.0290e-01,  ...,  6.8675e-03,
            1.2423e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1299e-01,  1.0630e-01,  ...,  4.9849e-02,
            1.5407e-01, -1.0000e+07],
          [-1.0000e+07, -2.5937e-02,  9.2902e-02,  ...,  9.4568e-03,
            1.3997e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4198e-01,  1.1674e-01,  ...,  6.3282e-02,
            1.6605e-01, -1.0000e+07],
          [-1.0000e+07, -4.6047e-02,  1.3281e-01,  ...,  3.0010e-02,
            1.4909e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5684e-01,  3.5330e-02,  ...,  6.6197e-02,
            1.9314e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3756e-01,  1.5916e-02,  ...,  5.9803e-02,
            1.7929e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 3.1956e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2179e-02,  8.7653e-02,  ...,  1.1971e-02,
            1.4701e-01, -1.0000e+07],
          [-1.0000e+07, -3.7128e-02,  1.3220e-01,  ...,  9.6965e-03,
            1.4422e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2015e-01,  1.1093e-01,  ...,  4.2340e-02,
            1.6688e-01, -1.0000e+07],
          [-1.0000e+07, -5.8526e-02,  1.5231e-01,  ..., -4.5886e-04,
            1.5562e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 8.4218e-02, -1.1235e-02],
         [ 4.9849e-02, -2.5937e-02],
         [ 6.3282e-02, -4.6047e-02],
         [ 5.8587e-02, -6.1028e-02],
         [ 5.3262e-02, -6.0320e-02],
         [ 5.3102e-02, -6.7341e-02],
         [ 5.5082e-02, -6.2556e-02],
         [ 4.0219e-02, -6.9191e-02],
         [ 3.2840e-02, -6.9900e-02],
         [ 2.6169e-02, -7.8768e-02],
         [-1.0935e-01, -7.1277e-02],
         [-1.0689e-01, -7.6666e-02],
         [ 6.1195e-02, -8.5899e-02],
         [-1.4084e-01, -8.1644e-02],
         [-1.7266e-01, -9.5420e-02],
         [-1.3904e-01, -1.0041e-01],
         [-1.6664e-01, -9.7432e-02],
         [-1.5496e-01, -1.0146e-01],
         [ 4.6510e-02, -1.0900e-01],
         [-1.4181e-01, -1.0170e-01],
         [-1.3470e-01, -8.3257e-02],
         [-1.1676e-01, -9.3203e-02],
         [ 8.6758e-02, -1.0314e-01],
         [ 8.3176e-02, -8.6700e-02],
         [ 6.0403e-02, -8.0355e-02],
         [ 7.4161e-02, -7.9139e-02],
         [-1.0840e-01, -8.4114e-02],
         [-1.3591e-01, -9.3852e-02],
         [ 6.7342e-02, -1.0238e-01],
         [-1.4697e-01, -1.1497e-01],
         [ 8.7390e-02, -1.5229e-01],
         [ 7.5819e-02, -1.5692e-01],
         [-1.2648e-01, -1.3104e-01],
         [-1.3278e-02, -9.2963e-02],
         [ 1.9372e-02, -8.8840e-02],
         [ 3.6028e-02, -8.9049e-02],
         [ 4.4075e-02, -6.9694e-02],
         [ 4.7737e-02, -7.4131e-02],
         [ 4.9312e-02, -5.9232e-02],
         [ 4.9929e-02, -4.9760e-02],
         [ 5.0116e-02, -5.0662e-02],
         [ 5.0144e-02, -7.0724e-02],
         [ 5.0119e-02, -6.5983e-02],
         [ 5.0081e-02, -1.0842e-01],
         [ 5.0050e-02, -8.6267e-02],
         [ 5.0020e-02, -6.6412e-02],
         [ 5.0030e-02, -7.2625e-02],
         [ 5.0020e-02, -6.5547e-02],
         [ 5.0019e-02, -1.0468e-01],
         [ 5.0017e-02, -1.3335e-01],
         [ 5.0023e-02, -1.4165e-01],
         [ 5.0012e-02, -1.4397e-01],
         [ 5.0008e-02, -1.5300e-01],
         [ 5.0013e-02, -1.5267e-01],
         [ 5.0009e-02,  9.9567e-02],
         [ 5.0006e-02, -1.7948e-01],
         [ 5.0008e-02, -1.6224e-01],
         [ 5.0008e-02, -1.8474e-01],
         [ 5.0008e-02, -1.6944e-01],
         [ 5.0008e-02, -1.8786e-01],
         [ 5.0008e-02, -1.7658e-01],
         [ 5.0008e-02, -1.6077e-01],
         [ 5.0008e-02, -1.4354e-01],
         [ 5.0008e-02, -1.6670e-01],
         [ 5.0008e-02, -1.6908e-01],
         [ 5.0008e-02, -1.5693e-01],
         [ 5.0009e-02, -1.7709e-01],
         [ 5.0009e-02, -1.5684e-01],
         [ 5.0009e-02, -1.3756e-01],
         [ 5.0009e-02,  3.1956e-02]],

        [[ 6.0687e-02, -1.6811e-02],
         [-9.2179e-02, -3.7128e-02],
         [ 4.2340e-02, -5.8526e-02],
         [ 4.6676e-02, -6.7599e-02],
         [ 4.9033e-02, -6.9425e-02],
         [ 8.6240e-02, -4.7316e-02],
         [-1.8406e-01, -4.6827e-02],
         [ 1.1751e-01, -4.1586e-02],
         [ 1.3833e-01, -4.9353e-02],
         [ 7.2588e-02, -5.0095e-02],
         [ 1.3786e-01, -5.0569e-02],
         [ 1.4762e-01, -7.0791e-02],
         [ 1.4024e-01, -8.0475e-02],
         [ 7.7485e-02, -8.1164e-02],
         [ 8.6274e-02, -9.2157e-02],
         [ 6.7800e-02, -9.7434e-02],
         [ 7.7440e-02,  1.4532e-01],
         [ 6.5452e-02, -1.2366e-01],
         [ 5.1771e-02, -1.1940e-01],
         [ 2.4513e-02, -1.4938e-01],
         [-1.2193e-01, -1.5942e-01],
         [ 1.6824e-01, -1.6698e-01],
         [ 1.6872e-01, -1.6571e-01],
         [-1.5091e-02, -1.5991e-01],
         [ 1.5324e-02, -1.4625e-01],
         [ 3.3489e-02, -1.4509e-01],
         [ 4.2879e-02, -1.6873e-01],
         [ 4.7309e-02, -1.8823e-01],
         [ 4.9243e-02, -1.6561e-01],
         [ 4.9963e-02, -1.7248e-01],
         [ 5.0185e-02, -1.8790e-01],
         [ 5.0204e-02, -2.0530e-01],
         [ 5.0173e-02, -2.0327e-01],
         [ 5.0137e-02, -2.1284e-01],
         [ 5.0087e-02, -1.9576e-01],
         [ 5.0049e-02, -1.9460e-01],
         [ 5.0025e-02, -1.7806e-01],
         [ 5.0021e-02, -1.8597e-01],
         [ 5.0028e-02, -1.9731e-01],
         [ 5.0030e-02, -2.0245e-01],
         [ 5.0016e-02, -2.0247e-01],
         [ 5.0017e-02, -1.9910e-01],
         [ 5.0020e-02, -2.0062e-01],
         [ 5.0016e-02, -1.6392e-01],
         [ 5.0007e-02, -1.5541e-01],
         [ 5.0007e-02, -1.8117e-01],
         [ 5.0008e-02,  1.0281e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.0968e-05, device='cuda:0') tensor(0.0034, device='cuda:0') tensor(-0.0020, device='cuda:0')
mixer_td_error tensor(0.4041, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4504, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7278, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0522, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1353, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0298, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1642856.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1687, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.0330e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0025, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0963, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2790, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0963, device='cuda:0', grad_fn=<MinBackward1>)
t_env 14971
target_mac_out tensor([[[[-1.0000e+07, -5.4255e-02,  8.7945e-02,  ...,  2.1998e-02,
            1.2409e-01, -1.0000e+07],
          [-1.0000e+07, -2.5887e-02,  1.2012e-01,  ...,  1.5133e-02,
            1.3440e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0159e-01,  1.1950e-01,  ...,  5.1083e-02,
            1.4701e-01, -1.0000e+07],
          [-1.0000e+07, -4.0845e-02,  1.0690e-01,  ..., -1.9599e-02,
            1.3754e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.9555e-02,  1.2774e-01,  ...,  3.8789e-02,
            1.4068e-01, -1.0000e+07],
          [-1.0000e+07, -5.0626e-02,  9.0328e-02,  ..., -3.6395e-02,
            1.4205e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.3996e-02,  8.6686e-02,  ...,  2.0696e-02,
            1.2691e-01, -1.0000e+07],
          [-1.0000e+07, -1.5667e-02,  8.3441e-02,  ...,  2.3244e-02,
            1.3188e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.1255e-02,  1.0085e-01,  ...,  1.3889e-02,
            1.5595e-01, -1.0000e+07],
          [-1.0000e+07, -1.9335e-02,  1.0315e-01,  ...,  4.0021e-03,
            1.3038e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2984e-01,  1.1306e-01,  ...,  4.4549e-02,
            1.6956e-01, -1.0000e+07],
          [-1.0000e+07, -2.9019e-02,  1.1227e-01,  ..., -9.0084e-03,
            1.3362e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.4822e-01,  5.1591e-02,  ...,  3.3976e-02,
            1.3626e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7536e-01,  8.8443e-02,  ...,  5.7649e-02,
            1.5296e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-5.7354e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.4255e-02, -2.5887e-02],
         [-1.0159e-01, -4.0845e-02],
         [-9.9555e-02, -5.0626e-02],
         [-1.1167e-01, -6.2274e-02],
         [-1.2454e-01, -5.9239e-02],
         [-1.5029e-01, -8.0355e-02],
         [-1.5487e-01, -8.9137e-02],
         [-1.7430e-01, -9.6029e-02],
         [-1.8051e-01, -1.0350e-01],
         [-1.6452e-01, -9.8587e-02],
         [-1.4278e-01, -1.4069e-01],
         [-1.3920e-01, -1.5121e-01],
         [-1.5860e-01, -1.3743e-01],
         [-1.7499e-01, -1.6828e-01],
         [-1.5248e-01, -1.7846e-01],
         [-1.6051e-01, -1.6649e-01],
         [-1.3959e-01, -1.7291e-01],
         [-1.3071e-01, -1.8315e-01],
         [-1.3995e-01, -1.6626e-01],
         [-1.6544e-01, -1.1997e-01],
         [-1.3076e-01, -1.4140e-01],
         [-1.3336e-01, -1.4386e-01],
         [-3.0346e-02, -1.1320e-01],
         [ 8.8269e-03, -1.2878e-01],
         [ 3.0066e-02, -1.3545e-01],
         [ 4.0884e-02, -1.5898e-01],
         [ 4.6140e-02, -1.6607e-01],
         [ 4.8527e-02, -1.5987e-01],
         [ 4.9567e-02, -1.8276e-01],
         [ 4.9956e-02, -1.7747e-01],
         [ 5.0057e-02, -1.8188e-01],
         [ 5.0077e-02, -1.9765e-01],
         [ 5.0082e-02, -1.8174e-01],
         [ 5.0060e-02, -1.6019e-01],
         [ 5.0057e-02, -1.7840e-01],
         [ 5.0031e-02, -1.7193e-01],
         [ 5.0018e-02, -1.9691e-01],
         [ 5.0040e-02, -1.7654e-01],
         [ 5.0026e-02, -1.6394e-01],
         [ 5.0014e-02, -1.5844e-01],
         [ 5.0020e-02, -1.5692e-01],
         [ 5.0020e-02, -1.4634e-01],
         [ 5.0011e-02, -1.5245e-01],
         [ 5.0009e-02, -1.4188e-01],
         [ 5.0006e-02, -1.6155e-01],
         [ 5.0008e-02,  5.5938e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.3996e-02, -1.5667e-02],
         [-8.1255e-02, -1.9335e-02],
         [-1.2984e-01, -2.9019e-02],
         [-1.3980e-01, -3.3227e-02],
         [-1.5316e-01, -5.0264e-02],
         [-1.7365e-01, -5.5435e-02],
         [-1.6554e-01, -5.6355e-02],
         [-1.5526e-01, -6.1340e-02],
         [-1.2905e-01, -7.0317e-02],
         [-1.3209e-01, -7.7612e-02],
         [-1.1180e-01, -7.7270e-02],
         [-1.2393e-01, -6.4252e-02],
         [-1.1595e-01, -7.0170e-02],
         [-1.2148e-01, -5.6061e-02],
         [-1.3191e-01, -5.6258e-02],
         [-1.0432e-01, -5.3836e-02],
         [-1.1357e-01, -6.4073e-02],
         [-9.5697e-02, -6.4567e-02],
         [-1.0999e-01, -6.8341e-02],
         [-1.1626e-01, -7.3311e-02],
         [-1.2208e-01, -7.0436e-02],
         [-1.2088e-01, -7.1934e-02],
         [-1.0433e-01, -1.0768e-01],
         [-9.6931e-02, -1.1292e-01],
         [-9.2447e-02, -1.3317e-01],
         [-8.8296e-02, -1.5013e-01],
         [-8.4195e-02, -1.6515e-01],
         [-1.1270e-01, -1.5815e-01],
         [-1.3245e-01, -1.6417e-01],
         [-1.4957e-01, -1.4313e-01],
         [-1.4434e-01, -1.4998e-01],
         [-1.6057e-01, -1.7113e-01],
         [-1.5841e-01, -1.6532e-01],
         [-1.4721e-01, -1.7838e-01],
         [-1.3934e-01, -1.6267e-01],
         [-1.5040e-01, -1.7007e-01],
         [-1.5436e-01, -1.6049e-01],
         [-1.5570e-01, -1.5614e-01],
         [-1.5937e-01, -1.4433e-01],
         [-1.5635e-01, -1.3976e-01],
         [-1.3112e-01, -1.3133e-01],
         [-1.3291e-01, -1.4430e-01],
         [-1.3369e-01, -1.3230e-01],
         [-1.2792e-01, -1.2715e-01],
         [-1.0155e-01,  9.9197e-03],
         [-8.9129e-02,  3.5311e-02],
         [-1.0661e-01,  4.7854e-02],
         [-8.5354e-02,  5.3260e-02],
         [-7.2566e-02,  5.5237e-02],
         [-6.8108e-02,  5.5798e-02],
         [-8.6637e-02,  5.5771e-02],
         [-1.0601e-01,  5.5608e-02],
         [-1.1954e-01,  5.5471e-02],
         [-1.1621e-01,  5.5352e-02],
         [-1.3185e-01,  5.5259e-02],
         [-1.4014e-01,  5.5247e-02],
         [-1.4497e-01,  5.5208e-02],
         [-1.2679e-01,  5.5209e-02],
         [-1.3479e-01,  5.5209e-02],
         [-1.3730e-01,  5.5202e-02],
         [-1.4025e-01,  5.5222e-02],
         [-1.7843e-01,  5.5205e-02],
         [-1.8052e-01,  5.5213e-02],
         [-1.6860e-01,  5.5223e-02],
         [-1.4009e-01,  5.5229e-02],
         [-1.8673e-01,  5.5233e-02],
         [-2.1102e-01,  5.5230e-02],
         [-1.9352e-01,  5.5231e-02],
         [-1.6079e-01,  5.5231e-02],
         [-1.4916e-01,  5.5236e-02],
         [-1.6223e-01,  5.5235e-02],
         [-1.3905e-01,  5.5232e-02],
         [-1.4471e-01,  5.5232e-02],
         [-1.5151e-01,  5.5231e-02],
         [-1.6877e-01,  5.5231e-02],
         [-1.8062e-01,  5.5231e-02],
         [-1.6026e-01,  5.5231e-02],
         [-1.5540e-01,  5.5231e-02],
         [-1.4881e-01,  5.5231e-02],
         [-1.6254e-01,  5.5231e-02],
         [-1.7217e-01,  5.5231e-02],
         [-1.7862e-01,  5.5231e-02],
         [-1.5027e-01,  5.5231e-02],
         [-1.5162e-01,  5.5231e-02],
         [-1.6805e-01,  5.5231e-02],
         [-1.5119e-01,  5.5231e-02],
         [-1.5720e-01,  5.5231e-02],
         [-1.3665e-01,  5.5231e-02],
         [-1.4527e-01,  5.5231e-02],
         [-1.2775e-01,  5.5231e-02],
         [-1.3896e-01,  5.5231e-02],
         [-1.5276e-01,  5.5231e-02],
         [-1.6000e-01,  5.5231e-02],
         [-1.3399e-01,  5.5231e-02],
         [-1.3136e-01,  5.5231e-02],
         [-1.4091e-01,  5.5231e-02],
         [-1.4226e-01,  5.5231e-02],
         [-1.4905e-01,  5.5231e-02],
         [-1.2909e-01,  5.5231e-02],
         [-1.2244e-01,  5.5231e-02],
         [-1.0848e-01,  5.5231e-02],
         [-1.3570e-01,  5.5231e-02],
         [-1.8667e-01,  5.5231e-02],
         [-1.9524e-01,  5.5231e-02],
         [-1.5938e-01,  5.5231e-02],
         [-1.6470e-01,  5.5231e-02],
         [-1.5101e-01,  5.5231e-02],
         [-1.4179e-01,  5.5231e-02],
         [-1.5457e-01,  5.5231e-02],
         [-1.9509e-01,  5.5231e-02],
         [-2.0485e-01,  5.5231e-02],
         [-1.6767e-01,  5.5231e-02],
         [-1.5757e-01,  5.5231e-02],
         [-1.4094e-01,  5.5231e-02],
         [-1.4438e-01,  5.5231e-02],
         [-1.4877e-01,  5.5231e-02],
         [-1.3821e-01,  5.5231e-02],
         [-1.2982e-01,  5.5231e-02],
         [-1.7292e-01,  5.5231e-02],
         [-1.6489e-01,  5.5231e-02],
         [-1.4054e-01,  5.5231e-02],
         [-1.3073e-01,  5.5231e-02],
         [-1.5157e-01,  5.5231e-02],
         [-1.5526e-01,  5.5231e-02],
         [-1.7048e-01,  5.5231e-02],
         [-1.9752e-01,  5.5231e-02],
         [-1.8227e-01,  5.5231e-02],
         [-1.6351e-01,  5.5231e-02],
         [-1.4822e-01,  5.5231e-02],
         [-1.7536e-01,  5.5231e-02],
         [-5.7354e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.3938e-05, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0013, device='cuda:0')
mixer_td_error tensor(0.8419, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5155, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7023, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0517, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1118, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0548, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3244274.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0558, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.8132e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0009, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0225, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3046, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0225, device='cuda:0', grad_fn=<MinBackward1>)
t_env 15271
target_mac_out tensor([[[[-1.0000e+07, -5.5215e-02,  8.8677e-02,  ...,  2.3305e-02,
            1.2081e-01, -1.0000e+07],
          [-1.0000e+07, -5.3949e-02,  1.3771e-01,  ...,  6.3333e-02,
            1.3943e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2031e-02,  9.8493e-02,  ...,  1.2418e-02,
            1.2582e-01, -1.0000e+07],
          [-1.0000e+07, -8.7006e-02,  1.5338e-01,  ...,  8.2628e-02,
            1.5837e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1073e-01,  1.2744e-01,  ...,  4.6674e-02,
            1.4320e-01, -1.0000e+07],
          [-1.0000e+07, -9.6923e-02,  1.2041e-01,  ...,  3.5965e-02,
            1.6227e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6739e-02,  1.0895e-01,  ...,  2.1326e-02,
            1.6105e-01, -1.0000e+07],
          [-1.0000e+07, -2.8247e-02,  1.0240e-01,  ..., -3.0290e-02,
            1.3408e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.9200e-02,  8.0248e-02,  ...,  2.3150e-02,
            1.4703e-01, -1.0000e+07],
          [-1.0000e+07, -3.7535e-02,  1.2663e-01,  ..., -2.2626e-02,
            1.4993e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3495e-01,  6.0546e-02,  ...,  4.8298e-02,
            2.0770e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4608e-01,  6.8347e-02,  ...,  4.3198e-02,
            2.0438e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-2.3447e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.5215e-02, -5.3949e-02],
         [-6.2031e-02, -8.7006e-02],
         [-1.1073e-01, -9.6923e-02],
         [-1.3164e-01, -1.1532e-01],
         [-1.3519e-01, -1.1942e-01],
         [-1.6127e-01, -1.3071e-01],
         [-1.5714e-01, -1.2226e-01],
         [-1.8843e-01, -1.4546e-01],
         [-2.0485e-01, -1.5994e-01],
         [-2.1055e-01, -1.6942e-01],
         [-2.1101e-01, -1.5690e-01],
         [-2.1011e-01, -1.6833e-01],
         [-1.8185e-01,  8.0038e-02],
         [-1.7723e-01, -1.5320e-01],
         [-1.9442e-01, -1.5505e-01],
         [-1.8351e-01, -1.3437e-01],
         [-1.6238e-01, -1.2347e-01],
         [-1.7161e-01, -1.1495e-01],
         [-1.7232e-01, -1.1609e-01],
         [-1.8287e-01, -1.1312e-01],
         [-1.6599e-01, -1.1586e-01],
         [-1.4723e-01, -1.3049e-01],
         [-1.5655e-01,  1.6157e-02],
         [-1.8380e-01,  3.9077e-02],
         [-1.7560e-01,  5.0190e-02],
         [-1.8565e-01,  5.4843e-02],
         [-1.9122e-01,  5.6431e-02],
         [-2.0044e-01,  5.6679e-02],
         [-2.2439e-01,  5.6455e-02],
         [-2.2649e-01,  5.6108e-02],
         [-2.2593e-01,  5.5813e-02],
         [-2.2852e-01,  5.5599e-02],
         [-2.4824e-01,  5.5436e-02],
         [-2.6540e-01,  5.5340e-02],
         [-2.3270e-01,  5.5271e-02],
         [-2.5423e-01,  5.5236e-02],
         [-2.5611e-01,  5.5255e-02],
         [-2.6483e-01,  5.5212e-02],
         [-2.2743e-01,  5.5209e-02],
         [-2.2357e-01,  5.5216e-02],
         [-2.2311e-01,  5.5223e-02],
         [-1.9656e-01,  5.5224e-02],
         [-2.2398e-01,  5.5233e-02],
         [-2.1769e-01,  5.5231e-02],
         [ 2.1115e-01,  5.5230e-02],
         [-2.6729e-02,  5.5232e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-7.8849e-02, -8.8067e-03],
         [-9.6739e-02, -2.8247e-02],
         [-7.9200e-02, -3.7535e-02],
         [-9.4547e-02, -4.3055e-02],
         [-6.5900e-02, -4.3409e-02],
         [-4.1387e-02, -4.6629e-02],
         [-4.3441e-02, -5.0919e-02],
         [-2.7382e-02, -5.9826e-02],
         [-1.9746e-02, -7.3588e-02],
         [-3.0872e-02, -6.5878e-02],
         [-5.0989e-02, -5.8578e-02],
         [-3.9891e-02, -9.1755e-02],
         [-4.3992e-02, -1.0397e-01],
         [-4.1079e-02, -1.2717e-01],
         [-5.6277e-02, -1.2369e-01],
         [-6.2738e-02, -1.3761e-01],
         [-5.1831e-02, -1.3316e-01],
         [-6.1744e-02, -1.1075e-01],
         [-6.3498e-02, -1.2130e-01],
         [-6.6388e-02, -9.6399e-02],
         [-6.4961e-02, -1.1772e-01],
         [-5.8328e-02, -1.1610e-01],
         [-6.7159e-02, -1.3365e-01],
         [-8.7476e-02, -1.4712e-01],
         [-9.9048e-02, -1.4260e-01],
         [-1.1083e-01, -1.6919e-01],
         [-1.0471e-01, -1.3545e-01],
         [-9.3000e-02, -1.0915e-01],
         [-1.0150e-01, -1.0648e-01],
         [-1.0742e-01, -8.8868e-02],
         [-1.0037e-01, -9.5196e-02],
         [-1.1304e-01, -9.8903e-02],
         [-1.1658e-01, -1.1125e-01],
         [-1.1770e-01, -9.8556e-02],
         [-1.2297e-01, -1.0335e-01],
         [-1.2096e-01, -1.0779e-01],
         [-1.1955e-01, -1.1091e-01],
         [-1.1912e-01, -1.1341e-01],
         [-1.1918e-01, -1.1523e-01],
         [-1.1897e-01, -9.9938e-02],
         [-1.1803e-01, -1.0432e-01],
         [-9.0545e-02, -9.1218e-02],
         [-9.6670e-02, -9.1222e-02],
         [-9.6700e-02, -1.0967e-01],
         [-9.4432e-02, -1.0138e-01],
         [-1.3858e-01, -1.0839e-01],
         [-1.1564e-01, -1.3185e-01],
         [-9.8143e-02, -1.1958e-01],
         [-8.0234e-02, -1.1518e-01],
         [-1.1056e-01, -1.0995e-01],
         [-9.2426e-02, -1.0864e-01],
         [-9.4861e-02, -1.0394e-01],
         [-1.1075e-01, -1.0108e-01],
         [-1.0341e-01, -1.0299e-01],
         [-9.3511e-02, -1.0155e-01],
         [-1.1037e-01, -1.0291e-01],
         [-9.4486e-02, -1.0129e-01],
         [-1.0392e-01, -8.4314e-02],
         [-1.0712e-01, -1.0207e-01],
         [-1.0558e-01, -8.6302e-02],
         [-9.1757e-02, -7.8540e-02],
         [-9.2573e-02, -7.1352e-02],
         [-9.2799e-02, -8.4700e-02],
         [-7.5835e-02, -8.1703e-02],
         [-7.1507e-02, -8.6811e-02],
         [-5.1784e-02, -8.7640e-02],
         [-5.4887e-02, -7.4948e-02],
         [-4.9998e-02, -7.3959e-02],
         [-7.3046e-02, -1.0612e-01],
         [-8.8615e-02, -1.2241e-01],
         [-1.4053e-01, -1.4262e-01],
         [-1.4917e-01, -1.2179e-01],
         [-1.4490e-01, -1.1314e-01],
         [-1.6073e-01, -1.0476e-01],
         [-1.7330e-01, -1.4305e-01],
         [-1.7607e-01, -1.6575e-01],
         [-1.7868e-01, -1.5376e-01],
         [-1.8765e-01, -1.5036e-01],
         [-2.0388e-01, -1.5380e-01],
         [-2.1465e-01, -1.3824e-01],
         [-1.7955e-01, -1.5121e-01],
         [-1.7727e-01, -1.3576e-01],
         [-1.7332e-01, -1.2242e-01],
         [-1.6278e-01, -1.0572e-01],
         [-1.7383e-01, -8.1468e-02],
         [-1.6410e-01, -9.3566e-02],
         [-2.0984e-01, -1.0477e-01],
         [-2.1491e-01, -1.1117e-01],
         [-2.2168e-01, -1.2298e-01],
         [-2.2628e-01, -1.2509e-01],
         [-2.2904e-01, -1.2970e-01],
         [-2.3045e-01, -1.3393e-01],
         [-2.3771e-01, -1.3101e-01],
         [-2.2321e-01, -1.3103e-01],
         [-1.8311e-01, -1.1353e-01],
         [-2.1920e-01, -9.8655e-02],
         [-2.0850e-01, -9.4663e-02],
         [-2.1845e-01, -8.3404e-02],
         [-2.2619e-01, -9.9325e-02],
         [-2.3120e-01, -1.0672e-01],
         [-2.2593e-01, -1.0778e-01],
         [-2.1230e-01, -1.0510e-01],
         [-1.7673e-01, -1.0928e-01],
         [-2.0903e-01, -1.2026e-01],
         [-2.0387e-01, -1.2518e-01],
         [-2.0399e-01, -1.3221e-01],
         [-1.9846e-01, -1.2358e-01],
         [-1.9614e-01, -1.1948e-01],
         [-1.9505e-01, -1.1976e-01],
         [-1.8846e-01, -1.2010e-01],
         [-2.0748e-01, -1.2622e-01],
         [-2.2063e-01, -1.1863e-01],
         [-2.0816e-01, -1.3801e-01],
         [-1.9478e-01, -1.2545e-01],
         [-2.1633e-01, -1.2268e-01],
         [-2.2142e-01, -1.2335e-01],
         [-2.1529e-01, -1.1328e-01],
         [-2.3103e-01, -1.2399e-01],
         [-2.1409e-01, -1.2922e-01],
         [-2.0069e-01, -1.3243e-01],
         [-1.6871e-01, -1.2348e-01],
         [-1.6474e-01, -1.1257e-01],
         [-1.5875e-01, -1.0421e-01],
         [-1.8035e-01, -1.3982e-01],
         [-3.7953e-03, -1.5849e-01],
         [ 2.4756e-02, -1.7183e-01],
         [ 3.9172e-02, -1.8044e-01],
         [ 4.5851e-02, -1.8544e-01],
         [ 4.8637e-02, -1.9701e-01],
         [ 4.9704e-02, -1.6249e-01],
         [ 5.0025e-02, -1.7929e-01],
         [ 5.0067e-02, -1.7624e-01],
         [ 5.0033e-02, -1.9735e-01],
         [ 5.0023e-02, -2.0616e-01],
         [ 4.9977e-02, -2.1044e-01],
         [ 4.9986e-02, -2.0403e-01],
         [ 5.0007e-02, -2.1926e-01],
         [ 4.9997e-02, -2.0940e-01],
         [ 5.0012e-02, -2.0340e-01],
         [ 5.0003e-02, -2.0045e-01],
         [ 5.0008e-02, -1.8639e-01],
         [ 5.0023e-02, -1.6698e-01],
         [ 5.0016e-02, -1.4312e-01],
         [ 5.0012e-02, -1.3519e-01],
         [ 5.0012e-02, -1.3818e-01],
         [ 5.0007e-02, -1.2818e-01],
         [ 5.0006e-02, -1.3847e-01],
         [ 5.0008e-02, -1.2937e-01],
         [ 5.0008e-02, -1.7309e-01],
         [ 5.0008e-02, -1.8573e-01],
         [ 5.0008e-02, -1.4914e-01],
         [ 5.0008e-02, -1.3433e-01],
         [ 5.0008e-02, -1.1308e-01],
         [ 5.0008e-02, -1.1795e-01],
         [ 5.0008e-02, -1.0028e-01],
         [ 5.0008e-02, -8.6160e-02],
         [ 5.0009e-02, -8.4403e-02],
         [ 5.0009e-02, -1.3495e-01],
         [ 5.0009e-02, -1.4608e-01],
         [ 5.0009e-02, -2.3447e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.9712e-05, device='cuda:0') tensor(0.0017, device='cuda:0') tensor(-0.0010, device='cuda:0')
mixer_td_error tensor(0.8991, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4409, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6949, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0382, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0958, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0988, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3562499.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2111, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.5028e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0014, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2513, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.3031, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2513, device='cuda:0', grad_fn=<MinBackward1>)
t_env 15525
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5738e-02,  1.0228e-01,  ...,  3.4988e-02,
            1.5796e-01, -1.0000e+07],
          [-1.0000e+07, -8.0973e-02,  1.6355e-01,  ...,  7.3632e-02,
            1.5107e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9340e-02,  8.3458e-02,  ...,  3.0472e-03,
            1.5527e-01, -1.0000e+07],
          [-1.0000e+07, -8.6661e-02,  1.3718e-01,  ...,  5.7992e-02,
            1.4966e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3683e-01,  1.1833e-01,  ...,  4.7582e-02,
            1.3756e-01, -1.0000e+07],
          [-1.0000e+07, -3.4730e-02,  1.3410e-01,  ...,  2.4027e-02,
            1.4590e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6866e-01,  1.2708e-01,  ...,  4.4227e-02,
            1.4453e-01, -1.0000e+07],
          [-1.0000e+07, -8.3233e-02,  1.6206e-01,  ...,  5.7360e-02,
            1.5029e-01, -1.0000e+07]],

         ...,

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.8235e-01,  5.2666e-02,  ...,  6.0530e-02,
            2.0026e-01, -3.2120e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6370e-01,  4.7353e-02,  ...,  4.0777e-02,
            1.9378e-01, -3.1128e-01]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.4074e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.9256e-02, -4.8886e-02],
         [-8.5738e-02, -8.0973e-02],
         [-8.9340e-02, -8.6661e-02],
         [ 1.6110e-01, -1.0537e-01],
         [ 1.8831e-01, -1.1286e-01],
         [-7.5270e-02, -1.6305e-01],
         [-3.2274e-02, -1.6909e-01],
         [-5.6711e-02,  2.0863e-01],
         [-5.6835e-02,  2.0545e-01],
         [-8.4709e-02,  2.1919e-01],
         [-9.5924e-02, -1.8090e-01],
         [-6.0254e-02,  2.2461e-01],
         [-4.5000e-02,  2.2892e-01],
         [-6.4142e-02, -1.7048e-01],
         [-9.1050e-02,  2.2829e-01],
         [-1.1952e-01, -1.3573e-01],
         [-1.3677e-01,  2.2330e-01],
         [-1.5914e-01,  2.3177e-01],
         [-1.4223e-01,  2.1259e-01],
         [-1.0686e-01,  2.2271e-01],
         [-1.1202e-01, -1.2130e-01],
         [ 1.6712e-01, -1.1298e-01],
         [ 1.8966e-01,  2.0951e-01],
         [ 1.7443e-01,  2.1338e-01],
         [-3.3230e-01,  2.0865e-01],
         [-3.3276e-01,  2.1531e-01],
         [-3.5187e-01,  1.9207e-01],
         [-3.4725e-01,  1.9698e-01],
         [-3.4909e-01,  1.8342e-01],
         [-3.4332e-01,  1.9193e-01],
         [-3.3409e-01, -9.7033e-02],
         [-3.3976e-01, -1.0148e-01],
         [-3.3088e-01,  1.9200e-01],
         [-3.2123e-01,  1.9215e-01],
         [-1.5517e-01, -8.5698e-02],
         [-1.6065e-01, -9.2395e-02],
         [-1.1230e-02, -1.1529e-01],
         [ 1.7815e-02, -1.2824e-01],
         [ 3.4352e-02, -1.6022e-01],
         [ 4.2956e-02, -1.5952e-01],
         [ 4.7145e-02, -1.7761e-01],
         [ 4.8980e-02, -1.8667e-01],
         [ 4.9755e-02, -1.6906e-01],
         [ 5.0012e-02, -1.5415e-01],
         [ 5.0067e-02, -1.4049e-01],
         [ 5.0066e-02, -1.5667e-01],
         [ 5.0039e-02, -1.5141e-01],
         [ 5.0022e-02,  1.7288e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.4019e-01, -1.1117e-02],
         [ 4.7582e-02, -3.4730e-02],
         [ 1.4453e-01, -8.3233e-02],
         [ 1.6112e-01, -1.3926e-01],
         [ 1.4967e-01, -1.2347e-01],
         [ 1.6965e-01, -1.2503e-01],
         [ 1.7566e-01, -1.3088e-01],
         [ 1.6080e-01, -1.2248e-01],
         [ 1.6311e-01, -1.1367e-01],
         [-1.2555e-01, -1.0019e-01],
         [ 1.8309e-01, -9.8439e-02],
         [ 1.7823e-01, -1.0621e-01],
         [ 1.7920e-01, -1.1500e-01],
         [ 1.9738e-01, -1.1480e-01],
         [ 1.8784e-01,  1.6932e-01],
         [-3.8452e-01, -1.0748e-01],
         [ 1.8201e-01, -9.2158e-02],
         [ 2.0366e-01, -8.1139e-02],
         [ 2.0877e-01, -5.6543e-02],
         [ 2.1326e-01, -3.7470e-02],
         [ 7.6418e-02, -5.1725e-02],
         [-3.3113e-01, -6.9305e-02],
         [-3.2255e-01, -8.6173e-02],
         [-3.3615e-01, -7.4994e-02],
         [-3.2138e-01, -5.1529e-02],
         [ 1.4892e-02, -5.4228e-02],
         [ 3.4795e-02, -7.4881e-02],
         [ 4.4278e-02, -6.2192e-02],
         [ 4.8302e-02, -7.5179e-02],
         [ 4.9798e-02, -7.3235e-02],
         [ 5.0185e-02, -7.2950e-02],
         [ 5.0223e-02, -8.8260e-02],
         [ 5.0138e-02,  2.1391e-01],
         [ 5.0070e-02, -1.0781e-01],
         [ 5.0027e-02, -9.2876e-02],
         [ 4.9980e-02, -8.6023e-02],
         [ 4.9995e-02, -8.2210e-02],
         [ 5.0003e-02, -8.2764e-02],
         [ 4.9998e-02, -1.2581e-01],
         [ 5.0002e-02, -1.5538e-01],
         [ 4.9991e-02, -1.7279e-01],
         [ 5.0001e-02, -1.7363e-01],
         [ 5.0012e-02,  2.1373e-01],
         [ 5.0016e-02,  2.1966e-01],
         [ 5.0020e-02,  2.2201e-01],
         [ 5.0017e-02, -1.8457e-01],
         [ 5.0005e-02, -2.0427e-01],
         [ 5.0007e-02,  2.2423e-01],
         [ 5.0008e-02,  2.1898e-01],
         [ 5.0008e-02,  2.2648e-01],
         [ 5.0008e-02,  2.2850e-01],
         [ 5.0008e-02,  2.3879e-01],
         [ 5.0008e-02, -2.1061e-01],
         [ 5.0008e-02, -1.8823e-01],
         [ 5.0008e-02, -1.8235e-01],
         [ 5.0008e-02, -1.6370e-01],
         [ 5.0008e-02,  1.4074e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0001, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0014, device='cuda:0')
mixer_td_error tensor(0.1247, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4833, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5275, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0005, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0880, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1235, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-789473.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2388, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.6820e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0007, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3226, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.3854, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3226, device='cuda:0', grad_fn=<MinBackward1>)
t_env 15587
target_mac_out tensor([[[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1573e-01,  1.1465e-01,  ...,  4.6260e-02,
            1.3400e-01, -1.0000e+07],
          [-1.0000e+07, -8.4494e-02,  1.5393e-01,  ...,  5.1304e-02,
            1.4180e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.5712e-01,  1.2888e-01,  ...,  6.5788e-02,
            1.5922e-01, -1.0000e+07],
          [-1.0000e+07, -1.1309e-01,  1.6298e-01,  ...,  4.4973e-02,
            1.3720e-01, -1.0000e+07]],

         ...,

         [[ 5.0010e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5259e-01,  4.2070e-02,  ...,  4.6448e-02,
            2.0061e-01, -3.0921e-01]],

         [[ 5.0019e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4739e-01,  2.7277e-02,  ...,  3.7970e-02,
            1.9213e-01, -3.0470e-01]],

         [[ 5.0005e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-6.5526e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6739e-02,  1.0895e-01,  ...,  2.1326e-02,
            1.6105e-01, -1.0000e+07],
          [-1.0000e+07, -2.8247e-02,  1.0240e-01,  ..., -3.0290e-02,
            1.3408e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.4101e-02,  9.1158e-02,  ..., -5.5751e-03,
            1.5495e-01, -1.0000e+07],
          [-1.0000e+07, -3.8868e-02,  1.3156e-01,  ..., -2.3385e-02,
            1.5056e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.2561e-02, -5.4216e-02],
         [ 4.6260e-02, -8.4494e-02],
         [ 6.5788e-02, -1.1309e-01],
         [ 2.8739e-02, -1.2931e-01],
         [ 3.5600e-02, -1.1125e-01],
         [ 4.0726e-02, -1.0599e-01],
         [ 4.9952e-02, -1.0913e-01],
         [ 5.8587e-02, -1.5074e-01],
         [ 6.3546e-02, -1.3349e-01],
         [ 6.5198e-02, -1.2486e-01],
         [ 4.3494e-02, -1.0300e-01],
         [ 1.6498e-01, -8.9593e-02],
         [ 1.6382e-01, -8.8361e-02],
         [ 1.8221e-01, -7.4815e-02],
         [-9.5111e-02, -7.8447e-02],
         [-7.8341e-02, -8.1285e-02],
         [-1.0281e-01, -9.3276e-02],
         [-1.0414e-01, -1.0248e-01],
         [-1.0709e-01, -1.0868e-01],
         [ 1.8664e-01, -9.3442e-02],
         [ 1.8211e-01, -9.2504e-02],
         [ 1.7152e-01, -9.7635e-02],
         [-8.9416e-02, -9.2712e-02],
         [-9.3968e-02, -7.6120e-02],
         [ 1.6715e-01, -6.4276e-02],
         [ 1.6860e-01, -5.9815e-02],
         [-1.0053e-01, -6.3683e-02],
         [-9.7063e-02, -6.1866e-02],
         [-1.0154e-01, -7.7913e-02],
         [-1.0596e-01, -8.7308e-02],
         [ 1.7746e-01, -9.6276e-02],
         [ 1.7297e-01, -8.5079e-02],
         [ 1.7464e-01, -9.9124e-02],
         [ 1.8681e-01, -1.0121e-01],
         [-1.0415e-01, -8.1228e-02],
         [-9.0708e-02, -8.6227e-02],
         [-8.8072e-02, -1.0804e-01],
         [-1.0529e-01, -1.2425e-01],
         [ 1.6577e-01, -1.2388e-01],
         [ 1.5443e-01, -1.4175e-01],
         [ 1.5459e-01, -1.1843e-01],
         [ 1.5414e-01, -1.0397e-01],
         [ 1.5824e-01, -7.9173e-02],
         [-9.9704e-02, -7.5484e-02],
         [-1.0175e-01, -6.1972e-02],
         [-1.2020e-01, -6.4452e-02],
         [ 1.8489e-01, -6.1448e-02],
         [-1.0346e-01, -6.9724e-02],
         [-9.2502e-02, -8.3385e-02],
         [ 1.7755e-01, -7.0677e-02],
         [ 1.7568e-01, -7.8895e-02],
         [-8.5048e-02, -8.0125e-02],
         [-7.7121e-02, -8.4056e-02],
         [-7.7342e-02, -7.4734e-02],
         [-8.5915e-02, -7.2845e-02],
         [ 1.6889e-01, -8.1013e-02],
         [ 1.7953e-01, -8.5896e-02],
         [ 1.6908e-01, -9.3686e-02],
         [ 1.7529e-01, -1.0412e-01],
         [ 1.6795e-01, -1.0164e-01],
         [-1.4512e-01, -1.1745e-01],
         [ 1.7759e-01, -1.3062e-01],
         [ 1.8839e-01, -1.2646e-01],
         [ 1.9232e-01, -1.3913e-01],
         [-2.0131e-01, -1.4540e-01],
         [ 2.0912e-01, -1.3525e-01],
         [ 2.0983e-01, -1.4011e-01],
         [ 2.0990e-01, -1.4318e-01],
         [ 2.1144e-01, -1.3010e-01],
         [-1.7652e-01, -1.2040e-01],
         [-1.7096e-01, -1.2425e-01],
         [-1.7592e-01, -1.1212e-01],
         [-1.6508e-01, -1.0911e-01],
         [-1.6132e-01, -1.5399e-01],
         [-8.8931e-03, -1.6574e-01],
         [ 1.8226e-02, -1.7290e-01],
         [ 3.4727e-02, -1.5832e-01],
         [ 4.3385e-02, -1.5662e-01],
         [ 4.7496e-02, -1.6757e-01],
         [ 4.9258e-02, -1.9113e-01],
         [ 4.9944e-02, -2.0968e-01],
         [ 5.0146e-02, -2.1501e-01],
         [ 5.0176e-02, -2.1564e-01],
         [ 5.0147e-02, -2.1135e-01],
         [ 5.0104e-02, -2.1244e-01],
         [ 5.0068e-02, -2.3293e-01],
         [ 5.0059e-02,  2.4443e-01],
         [ 5.0023e-02, -2.1914e-01],
         [ 5.0034e-02, -2.1830e-01],
         [ 5.0038e-02, -2.2056e-01],
         [ 5.0017e-02,  2.5539e-01],
         [ 5.0045e-02,  2.2698e-01],
         [ 5.0032e-02,  2.1221e-01],
         [ 5.0006e-02, -1.7017e-01],
         [ 5.0010e-02, -1.5259e-01],
         [ 5.0019e-02, -1.4739e-01],
         [ 5.0005e-02, -6.5526e-03]],

        [[ 1.4118e-01, -8.8067e-03],
         [ 1.6105e-01, -2.8247e-02],
         [-9.4101e-02, -3.8868e-02],
         [-9.5894e-02, -3.5693e-02],
         [-8.3465e-02, -4.7100e-02],
         [-8.7595e-02, -5.8125e-02],
         [-8.1640e-02, -8.0826e-02],
         [ 2.1008e-02, -1.0053e-01],
         [-7.5557e-02, -1.0832e-01],
         [-7.1742e-02, -1.2160e-01],
         [-8.2705e-02, -1.2007e-01],
         [-7.1495e-02, -1.6293e-01],
         [-7.4993e-02, -1.4309e-01],
         [-1.0720e-01, -1.3157e-01],
         [-1.2287e-01, -1.2128e-01],
         [-1.0729e-01, -1.2213e-01],
         [-1.2985e-01, -1.3999e-01],
         [-1.3659e-01, -1.4472e-01],
         [-1.2674e-01, -1.5449e-01],
         [-8.9477e-02,  2.1129e-01],
         [-7.7505e-02,  2.2860e-01],
         [-6.0633e-02,  2.3694e-01],
         [-4.1742e-02, -1.7201e-01],
         [-6.4108e-02, -1.8146e-01],
         [-8.5326e-02, -1.7726e-01],
         [-9.3713e-02, -1.6542e-01],
         [-1.0386e-01, -1.5849e-01],
         [-9.7086e-02, -7.5037e-03],
         [-1.0899e-01,  2.9282e-02],
         [-9.7198e-02,  4.5612e-02],
         [-1.3380e-01,  5.2416e-02],
         [-1.0252e-01,  5.4929e-02],
         [-1.3779e-01,  5.5725e-02],
         [-1.6380e-01,  5.5815e-02],
         [-1.2219e-01,  5.5679e-02],
         [-9.1249e-02,  5.5502e-02],
         [-1.0333e-01,  5.5372e-02],
         [-1.1232e-01,  5.5285e-02],
         [-9.9859e-02,  5.5264e-02],
         [-1.0199e-01,  5.5225e-02],
         [-9.0518e-02,  5.5217e-02],
         [-1.2205e-01,  5.5225e-02],
         [-1.4849e-01,  5.5206e-02],
         [-1.7522e-01,  5.5205e-02],
         [-1.9210e-01,  5.5210e-02],
         [-1.6412e-01,  5.5217e-02],
         [-1.8341e-01,  5.5223e-02],
         [ 8.1962e-02,  5.5230e-02],
         [ 2.0271e-01,  5.5229e-02],
         [ 2.1268e-01,  5.5230e-02],
         [ 2.1954e-01,  5.5230e-02],
         [ 1.3517e-01,  5.5232e-02],
         [ 1.1180e-01,  5.5236e-02],
         [ 9.5628e-02,  5.5236e-02],
         [ 6.0960e-02,  5.5232e-02],
         [ 8.7223e-02,  5.5232e-02],
         [ 7.3458e-02,  5.5231e-02],
         [ 2.0681e-01,  5.5231e-02],
         [ 5.5583e-02,  5.5231e-02],
         [ 7.7715e-02,  5.5231e-02],
         [ 6.5998e-02,  5.5231e-02],
         [ 6.1343e-02,  5.5231e-02],
         [ 5.6711e-02,  5.5231e-02],
         [-9.3098e-03,  5.5231e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.4644e-06, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0013, device='cuda:0')
mixer_td_error tensor(0.4131, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4463, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6342, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0162, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0979, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1216, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1701030.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2554, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.6188e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3394, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2088, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3394, device='cuda:0', grad_fn=<MinBackward1>)
t_env 15706
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5738e-02,  1.0228e-01,  ...,  3.4988e-02,
            1.5796e-01, -1.0000e+07],
          [-1.0000e+07, -8.0973e-02,  1.6355e-01,  ...,  7.3632e-02,
            1.5107e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9340e-02,  8.3458e-02,  ...,  3.0472e-03,
            1.5527e-01, -1.0000e+07],
          [-1.0000e+07, -8.6661e-02,  1.3718e-01,  ...,  5.7992e-02,
            1.4966e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -6.3466e-02,  7.0474e-02,  ...,  7.2381e-03,
            1.2779e-01, -1.0000e+07],
          [-1.0000e+07, -6.3055e-03,  1.1210e-01,  ...,  5.1485e-03,
            1.2331e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2587e-02,  7.6481e-02,  ...,  7.7070e-03,
            1.4308e-01, -1.0000e+07],
          [-1.0000e+07, -1.4318e-02,  1.1976e-01,  ..., -1.1387e-02,
            1.3100e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.9504e-02,  8.1150e-02,  ...,  1.8671e-02,
            1.7899e-01, -1.0000e+07],
          [-1.0000e+07, -4.5628e-02,  5.5136e-02,  ..., -1.0000e+07,
            1.5721e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5656e-01,  4.5832e-02,  ...,  8.5851e-02,
            1.9715e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4955e-01,  6.4268e-02,  ...,  6.7706e-02,
            1.9920e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 3.3283e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.9256e-02, -4.8886e-02],
         [-8.5738e-02, -8.0973e-02],
         [-8.9340e-02, -8.6661e-02],
         [-1.1559e-01, -1.0537e-01],
         [ 1.8831e-01, -1.1286e-01],
         [-7.5270e-02, -1.6305e-01],
         [-3.2274e-02, -1.6909e-01],
         [-5.6711e-02, -1.8980e-01],
         [-5.6835e-02, -1.5781e-01],
         [-8.4709e-02, -1.4914e-01],
         [-9.5924e-02, -1.8090e-01],
         [-6.0254e-02, -1.9602e-01],
         [-4.5000e-02, -2.0668e-01],
         [-6.4142e-02, -1.7048e-01],
         [-9.1050e-02, -1.5858e-01],
         [-1.1952e-01, -1.3573e-01],
         [-1.3677e-01, -1.3726e-01],
         [-1.5914e-01, -1.4143e-01],
         [-1.4223e-01, -1.2778e-01],
         [-1.0686e-01, -1.3749e-01],
         [-1.1202e-01, -1.2130e-01],
         [ 4.7266e-02, -1.1298e-01],
         [ 1.8966e-01, -1.1455e-01],
         [ 7.1242e-02, -1.1997e-01],
         [-3.3230e-01,  2.0865e-01],
         [ 7.0282e-02,  2.1531e-01],
         [-3.5187e-01, -1.1951e-01],
         [-3.4725e-01,  1.9698e-01],
         [-3.4909e-01, -1.1362e-01],
         [-3.4332e-01, -1.0853e-01],
         [-3.3409e-01, -9.7033e-02],
         [-3.3976e-01, -1.0148e-01],
         [-3.3088e-01, -9.9405e-02],
         [-3.2123e-01, -8.5795e-02],
         [-1.5517e-01, -8.5698e-02],
         [ 5.6623e-02, -9.2395e-02],
         [-1.1230e-02, -1.1529e-01],
         [ 1.7815e-02, -1.2824e-01],
         [ 3.4352e-02, -1.6022e-01],
         [ 4.2956e-02, -1.5952e-01],
         [ 4.7145e-02, -1.7761e-01],
         [ 4.8980e-02, -1.8667e-01],
         [ 4.9755e-02, -1.6906e-01],
         [ 5.0012e-02, -1.5415e-01],
         [ 5.0067e-02, -1.4049e-01],
         [ 5.0066e-02, -1.5667e-01],
         [ 5.0039e-02, -1.5141e-01],
         [ 5.0022e-02,  1.7288e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-6.3466e-02, -6.3055e-03],
         [-8.2587e-02, -1.4318e-02],
         [ 1.7899e-01, -4.5628e-02],
         [-1.3181e-01, -6.9397e-02],
         [-1.0245e-01, -7.4063e-02],
         [-9.2599e-02, -1.2359e-01],
         [-1.0316e-01, -9.1078e-02],
         [-9.3504e-02, -6.3859e-02],
         [-7.2996e-02, -4.5735e-02],
         [-4.4862e-02, -5.8827e-02],
         [-4.8809e-02, -5.5739e-02],
         [-5.4593e-02, -5.6773e-02],
         [-5.9378e-02, -5.2619e-02],
         [-6.2549e-02, -5.9742e-02],
         [-6.4361e-02, -5.3868e-02],
         [-5.2452e-02, -6.9123e-02],
         [-2.2001e-02, -6.1622e-02],
         [-6.1581e-02, -4.7781e-02],
         [-4.3620e-02, -4.5035e-02],
         [-3.6820e-02, -2.1849e-02],
         [-4.6735e-02, -4.5441e-02],
         [-1.8808e-02, -4.9481e-02],
         [-2.4943e-02, -6.6779e-02],
         [-6.2645e-03, -5.9893e-02],
         [-4.4496e-02, -4.9209e-02],
         [-8.2403e-02, -4.1496e-02],
         [-9.5203e-02, -2.7179e-02],
         [-8.9045e-02, -3.1248e-02],
         [-8.3395e-02, -3.5355e-02],
         [ 1.7440e-01, -4.6445e-02],
         [-9.3701e-02, -4.1431e-02],
         [ 1.8688e-01, -4.4177e-02],
         [ 2.0507e-01, -6.2144e-02],
         [-6.6012e-02, -4.5875e-02],
         [-2.5606e-02, -5.7432e-02],
         [-3.9404e-02, -6.7887e-02],
         [-1.4710e-02, -5.6851e-02],
         [-4.9686e-02, -5.3262e-02],
         [-1.2891e-02, -6.8040e-02],
         [-2.2707e-02, -4.4232e-02],
         [-1.9693e-02, -5.1010e-02],
         [-3.3683e-02, -4.3107e-02],
         [-3.4625e-02, -2.5966e-02],
         [-3.0873e-02, -3.6572e-02],
         [ 1.2111e-01, -4.2810e-02],
         [ 1.2512e-01, -4.8748e-02],
         [-4.0578e-02, -4.3770e-02],
         [-2.8547e-02, -4.6307e-02],
         [ 1.2425e-01, -3.8647e-02],
         [-5.5965e-02, -3.8143e-02],
         [-3.8812e-02, -4.1054e-02],
         [-2.2402e-02, -3.8060e-02],
         [-1.4681e-02, -3.1228e-02],
         [-2.6668e-02, -3.5992e-02],
         [-3.2691e-02, -3.9544e-02],
         [-2.7605e-02, -4.6074e-02],
         [-4.6550e-02, -4.1160e-02],
         [-5.9922e-02, -2.9571e-02],
         [-5.6824e-02, -2.1169e-02],
         [-4.8564e-02, -2.6566e-02],
         [-4.6831e-02, -2.4300e-02],
         [-4.1931e-02, -2.6179e-02],
         [-5.3777e-02, -3.2627e-02],
         [-4.8551e-02, -3.3850e-02],
         [-9.3350e-02, -5.1229e-02],
         [-1.2013e-01, -5.0156e-02],
         [ 6.7264e-02, -6.8200e-02],
         [ 5.4104e-02, -5.1903e-02],
         [ 5.3465e-02, -7.4711e-02],
         [ 7.1848e-02,  6.2034e-02],
         [ 5.4014e-02, -6.2366e-02],
         [-3.5387e-01, -7.9897e-02],
         [-3.5797e-01, -7.4381e-02],
         [-3.6062e-01, -7.7196e-02],
         [ 4.9256e-02, -9.2433e-02],
         [ 2.1066e-01, -6.4949e-02],
         [ 8.9514e-02, -2.8528e-02],
         [ 8.2105e-02, -3.0319e-02],
         [ 2.0797e-01, -4.6054e-02],
         [-3.5297e-01, -7.4360e-02],
         [-3.4985e-01, -9.1629e-02],
         [-3.5772e-01, -9.6442e-02],
         [-3.4640e-01, -8.7100e-02],
         [-1.2054e-01, -9.1256e-02],
         [ 3.2330e-02, -9.1864e-02],
         [ 4.1395e-03, -7.4268e-02],
         [ 2.4914e-02, -4.9438e-02],
         [ 3.8011e-02, -1.9060e-02],
         [ 4.4862e-02, -4.5016e-02],
         [ 4.8084e-02, -3.3645e-02],
         [ 4.9444e-02, -4.9131e-02],
         [ 4.9938e-02, -4.4776e-02],
         [ 5.0105e-02, -6.7411e-02],
         [ 5.0106e-02, -8.1361e-02],
         [ 5.0078e-02, -8.7389e-02],
         [ 5.0066e-02, -7.2115e-02],
         [ 5.0044e-02, -8.2188e-02],
         [ 5.0022e-02, -6.2816e-02],
         [ 5.0014e-02, -3.8875e-02],
         [ 5.0027e-02, -3.2374e-02],
         [ 5.0027e-02, -1.7437e-02],
         [ 5.0028e-02, -2.4289e-02],
         [ 5.0025e-02, -1.8385e-02],
         [ 5.0022e-02, -2.6237e-02],
         [ 5.0012e-02, -3.2407e-02],
         [ 5.0016e-02, -1.4291e-02],
         [ 5.0006e-02, -2.6134e-02],
         [ 5.0006e-02, -3.2509e-02],
         [ 5.0008e-02, -1.4410e-02],
         [ 5.0008e-02, -2.3967e-02],
         [ 5.0008e-02, -2.6994e-02],
         [ 5.0008e-02, -1.4559e-02],
         [ 5.0008e-02, -8.7757e-03],
         [ 5.0008e-02,  3.4148e-03],
         [ 5.0008e-02, -1.4649e-02],
         [ 5.0008e-02, -1.3247e-02],
         [ 5.0008e-02, -2.2889e-02],
         [ 5.0009e-02, -7.9812e-03],
         [ 5.0009e-02, -9.8564e-03],
         [ 5.0009e-02, -7.7386e-03],
         [ 5.0009e-02, -1.8594e-02],
         [ 5.0009e-02, -1.4729e-02],
         [ 5.0009e-02, -1.3824e-03],
         [ 5.0009e-02, -1.7990e-02],
         [ 5.0009e-02, -5.8055e-03],
         [ 5.0009e-02, -8.7558e-03],
         [ 5.0009e-02, -1.9916e-02],
         [ 5.0009e-02, -5.9844e-03],
         [ 5.0009e-02, -2.0930e-02],
         [ 5.0009e-02, -2.9485e-02],
         [ 5.0009e-02, -5.0967e-02],
         [ 5.0009e-02, -3.7029e-02],
         [ 5.0009e-02, -1.1482e-02],
         [ 5.0009e-02, -3.9467e-02],
         [ 5.0009e-02, -2.9501e-02],
         [ 5.0009e-02, -1.6185e-02],
         [ 5.0009e-02, -3.4284e-04],
         [ 5.0009e-02, -1.6675e-02],
         [ 5.0009e-02, -5.3459e-03],
         [ 5.0009e-02, -3.4890e-02],
         [ 5.0009e-02, -3.8347e-02],
         [ 5.0009e-02, -6.1225e-02],
         [ 5.0009e-02, -6.7744e-02],
         [ 5.0009e-02, -7.5033e-02],
         [ 5.0009e-02, -5.7513e-02],
         [ 5.0009e-02, -6.6751e-02],
         [ 5.0009e-02, -7.0021e-02],
         [ 5.0009e-02, -5.3922e-02],
         [ 5.0009e-02, -5.8485e-02],
         [ 5.0009e-02, -6.8504e-02],
         [ 5.0009e-02, -7.1091e-02],
         [ 5.0009e-02, -6.1768e-02],
         [ 5.0009e-02, -7.3610e-02],
         [ 5.0009e-02, -8.4406e-02],
         [ 5.0009e-02, -9.2311e-02],
         [ 5.0009e-02, -1.1600e-01],
         [ 5.0009e-02, -1.4516e-01],
         [ 5.0009e-02, -1.6711e-01],
         [ 5.0009e-02, -1.8007e-01],
         [ 5.0009e-02, -1.7758e-01],
         [ 5.0009e-02, -1.8071e-01],
         [ 5.0009e-02, -1.9261e-01],
         [ 5.0009e-02, -1.9883e-01],
         [ 5.0009e-02, -1.8810e-01],
         [ 5.0009e-02, -1.7017e-01],
         [ 5.0009e-02, -1.4549e-01],
         [ 5.0009e-02, -1.2567e-01],
         [ 5.0009e-02, -1.2051e-01],
         [ 5.0009e-02, -1.3677e-01],
         [ 5.0009e-02, -1.2171e-01],
         [ 5.0009e-02,  7.1011e-02],
         [ 5.0009e-02, -7.7833e-02],
         [ 5.0009e-02, -7.4423e-02],
         [ 5.0009e-02,  2.0769e-01],
         [ 5.0009e-02, -1.0676e-01],
         [ 5.0009e-02, -1.1804e-01],
         [ 5.0009e-02, -1.2088e-01],
         [ 5.0009e-02, -1.1808e-01],
         [ 5.0009e-02, -1.1572e-01],
         [ 5.0009e-02, -1.1421e-01],
         [ 5.0009e-02,  2.2799e-01],
         [ 5.0009e-02, -1.4080e-01],
         [ 5.0009e-02,  2.2219e-01],
         [ 5.0009e-02, -1.7444e-01],
         [ 5.0009e-02, -1.7442e-01],
         [ 5.0009e-02, -1.7396e-01],
         [ 5.0009e-02, -1.4512e-01],
         [ 5.0009e-02, -1.6805e-01],
         [ 5.0009e-02, -1.3911e-01],
         [ 5.0009e-02, -1.6323e-01],
         [ 5.0009e-02, -1.8131e-01],
         [ 5.0009e-02, -1.8222e-01],
         [ 5.0009e-02, -1.5656e-01],
         [ 5.0009e-02, -1.4955e-01],
         [ 5.0009e-02,  3.3283e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.6926e-06, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0007, device='cuda:0')
mixer_td_error tensor(0.9230, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5164, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4022, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0216, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0886, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1217, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3769230.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2280, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.4685e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2682, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.3439, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2682, device='cuda:0', grad_fn=<MinBackward1>)
t_env 15879
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.2225e-02,  6.2394e-02,  ...,  2.0084e-02,
            1.2912e-01, -1.0000e+07],
          [-1.0000e+07, -7.7190e-02,  1.6041e-01,  ...,  7.2365e-02,
            1.5573e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.0171e-02,  4.6061e-02,  ...,  4.1223e-02,
            1.3816e-01, -1.0000e+07],
          [-1.0000e+07, -1.2417e-01,  1.0542e-01,  ...,  6.0142e-02,
            1.7534e-01, -1.0000e+07]],

         ...,

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3740e-01,  4.1005e-02,  ...,  3.3463e-02,
            2.0037e-01, -1.0000e+07]],

         [[ 5.0008e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.2245e-01,  2.2864e-02,  ...,  1.2143e-02,
            1.9666e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.2287e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3951e-02,  7.1240e-02,  ...,  3.0362e-02,
            1.3820e-01, -1.0000e+07],
          [-1.0000e+07, -3.0267e-02,  1.3089e-01,  ...,  1.8888e-02,
            1.4798e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.8630e-02,  1.0511e-01,  ...,  4.9468e-02,
            1.6136e-01, -1.0000e+07],
          [-1.0000e+07, -6.8084e-02,  1.5335e-01,  ...,  4.9501e-02,
            1.5601e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.9256e-02, -4.8886e-02],
         [-6.2225e-02, -7.7190e-02],
         [-5.0171e-02, -1.2417e-01],
         [-5.5750e-02, -1.6707e-01],
         [-6.0333e-02, -1.8800e-01],
         [-4.5322e-02, -2.0530e-01],
         [-5.4950e-02,  2.2101e-01],
         [-7.1698e-02, -1.9488e-01],
         [-8.9908e-02, -1.6529e-01],
         [-8.8833e-02, -2.0003e-01],
         [-8.6353e-02, -1.5952e-01],
         [-9.3121e-02, -1.5221e-01],
         [-1.0690e-01, -1.0543e-01],
         [-1.1034e-01, -8.6728e-02],
         [-1.2086e-01, -7.3845e-02],
         [-1.2914e-01, -8.3828e-02],
         [-1.1353e-01, -8.6107e-02],
         [ 5.8379e-02, -1.1008e-01],
         [-1.3116e-01, -9.6470e-02],
         [-1.1104e-01, -1.1788e-01],
         [ 6.2794e-02, -9.7966e-02],
         [-8.1049e-02, -6.3586e-02],
         [-6.6191e-02, -6.4895e-02],
         [-8.5934e-02,  4.9209e-03],
         [ 5.2698e-02, -8.2171e-02],
         [-9.1293e-02,  9.5856e-03],
         [-8.4688e-02, -8.6714e-02],
         [-8.0745e-02, -1.2155e-01],
         [-8.2549e-02, -1.0604e-01],
         [-9.7385e-02,  2.3363e-02],
         [-9.3445e-02,  1.6236e-02],
         [-7.9059e-02,  2.8381e-02],
         [-6.8257e-02,  3.0723e-02],
         [-6.2877e-02,  7.3160e-02],
         [-7.9941e-02,  5.9419e-02],
         [-6.9004e-02,  4.8567e-02],
         [-6.1038e-02,  4.6604e-02],
         [-4.6700e-02,  5.4354e-02],
         [-4.0838e-02,  6.8370e-02],
         [-4.2937e-02,  6.3954e-02],
         [-6.2249e-02,  4.8331e-02],
         [-6.9709e-02,  1.7088e-02],
         [-7.7115e-02,  2.2578e-02],
         [-6.8878e-02,  4.9603e-02],
         [-8.1623e-02,  3.3666e-02],
         [-6.1602e-02,  4.2514e-02],
         [-7.2736e-02,  5.9601e-02],
         [-6.3625e-02,  3.7906e-02],
         [-5.7862e-02, -8.0513e-02],
         [-6.1121e-02, -8.8742e-02],
         [-4.8498e-02, -6.8978e-02],
         [-5.2068e-02, -6.6220e-02],
         [-4.6674e-02, -8.0622e-02],
         [-5.3021e-02, -6.9637e-02],
         [-7.4812e-02, -1.0627e-01],
         [-8.4894e-02,  2.2893e-02],
         [-7.6806e-02,  3.6328e-02],
         [-9.3026e-02,  4.7200e-02],
         [-7.6624e-02,  4.4918e-02],
         [-8.6545e-02,  2.2302e-02],
         [-8.4799e-02,  3.5528e-02],
         [-8.5123e-02,  2.0805e-02],
         [-8.9595e-02,  5.3408e-02],
         [-1.3623e-01,  8.7252e-02],
         [-1.5106e-01,  7.2509e-02],
         [-1.6078e-01,  1.0166e-01],
         [ 5.7204e-02,  5.7620e-02],
         [ 8.0507e-02,  9.2923e-02],
         [ 7.1110e-02,  8.0516e-02],
         [ 3.9321e-02,  8.0021e-02],
         [ 5.4316e-02,  6.3894e-02],
         [ 5.8428e-02,  5.4282e-02],
         [ 5.3481e-02,  7.7400e-02],
         [ 5.4316e-02,  6.3734e-02],
         [ 7.3894e-02,  1.9479e-01],
         [ 4.4873e-02,  1.8661e-01],
         [ 5.9921e-02,  5.1503e-02],
         [ 7.5914e-02,  2.9608e-02],
         [ 7.4345e-02,  5.0042e-02],
         [ 8.1455e-02, -1.4066e-01],
         [ 7.0939e-02, -1.0875e-01],
         [ 5.7140e-02, -1.0966e-01],
         [ 6.5398e-02, -1.1232e-01],
         [ 6.1426e-02, -1.1422e-01],
         [ 3.7360e-03, -9.2348e-02],
         [ 2.4588e-02, -8.3617e-02],
         [ 3.7796e-02, -8.0970e-02],
         [ 4.4747e-02, -7.6880e-02],
         [ 4.8003e-02, -5.4810e-02],
         [ 4.9379e-02, -5.7033e-02],
         [ 4.9888e-02, -6.3651e-02],
         [ 5.0033e-02, -6.4875e-02],
         [ 5.0053e-02, -5.2941e-02],
         [ 5.0057e-02, -3.8881e-02],
         [ 5.0038e-02, -5.1325e-02],
         [ 5.0012e-02, -5.7482e-02],
         [ 5.0025e-02, -4.1979e-02],
         [ 5.0015e-02, -5.2161e-02],
         [ 5.0025e-02, -6.0476e-02],
         [ 5.0020e-02, -6.2452e-02],
         [ 5.0021e-02, -6.1486e-02],
         [ 5.0018e-02, -9.2120e-02],
         [ 5.0025e-02, -1.3383e-01],
         [ 5.0018e-02,  2.0951e-01],
         [ 5.0009e-02,  2.0433e-01],
         [ 5.0019e-02,  6.0785e-02],
         [ 5.0005e-02,  6.4068e-02],
         [ 5.0007e-02,  5.5569e-02],
         [ 5.0008e-02,  8.6675e-02],
         [ 5.0008e-02, -1.5611e-01],
         [ 5.0008e-02, -1.3327e-01],
         [ 5.0009e-02, -1.4981e-01],
         [ 5.0008e-02, -1.4467e-01],
         [ 5.0008e-02,  8.4479e-02],
         [ 5.0008e-02,  6.6674e-02],
         [ 5.0008e-02, -1.3740e-01],
         [ 5.0008e-02, -1.2245e-01],
         [ 5.0009e-02,  1.2287e-02]],

        [[ 2.7572e-02, -8.8067e-03],
         [-7.3951e-02, -3.0267e-02],
         [-9.8630e-02, -6.8084e-02],
         [ 6.8518e-02, -8.9249e-02],
         [ 8.1545e-02, -1.0121e-01],
         [ 3.4235e-02, -1.1553e-01],
         [ 6.7601e-02, -1.3421e-01],
         [ 5.2312e-02,  3.4027e-02],
         [ 6.0671e-02,  7.2060e-02],
         [ 6.9439e-02,  4.2764e-02],
         [ 5.8211e-02,  5.6760e-02],
         [ 8.3397e-02,  6.6812e-02],
         [ 9.7806e-02,  6.5217e-02],
         [ 1.0582e-01,  8.8390e-02],
         [ 8.0543e-02,  8.0610e-02],
         [ 9.8752e-02,  7.4566e-02],
         [-1.7905e-01,  6.9034e-02],
         [-1.7096e-01,  6.3011e-02],
         [-1.7896e-01,  7.6490e-02],
         [-1.5405e-01, -1.2461e-01],
         [-1.6776e-01, -1.3058e-01],
         [-1.5319e-01, -1.3152e-01],
         [-1.4446e-01, -1.1910e-01],
         [-1.4160e-01, -7.8007e-03],
         [ 6.0326e-02,  2.5910e-02],
         [-1.7993e-01,  4.2810e-02],
         [-3.3665e-01,  5.0563e-02],
         [-3.3374e-01,  5.3837e-02],
         [ 1.9958e-01,  5.5094e-02],
         [ 1.8972e-01,  5.5459e-02],
         [ 8.6173e-02,  5.5496e-02],
         [-3.3808e-01,  5.5446e-02],
         [-3.3969e-01,  5.5332e-02],
         [-1.7965e-01,  5.5293e-02],
         [-1.6722e-01,  5.5232e-02],
         [ 9.9631e-02,  5.5218e-02],
         [ 7.9543e-02,  5.5234e-02],
         [ 6.9353e-02,  5.5215e-02],
         [ 4.3170e-02,  5.5198e-02],
         [ 5.7036e-02,  5.5220e-02],
         [ 8.0293e-02,  5.5216e-02],
         [ 6.6087e-02,  5.5212e-02],
         [ 3.6491e-02,  5.5221e-02],
         [ 6.8510e-02,  5.5227e-02],
         [ 5.6782e-02,  5.5232e-02],
         [-1.4430e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.7448e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0011, device='cuda:0')
mixer_td_error tensor(0.7289, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4465, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4014, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0158, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0990, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1061, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3050847., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2210, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.6979e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2549, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3222, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2549, device='cuda:0', grad_fn=<MinBackward1>)
t_env 15929
target_mac_out tensor([[[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.7917e-02,  5.6894e-02,  ...,  1.4246e-02,
            1.3320e-01, -1.0000e+07],
          [-1.0000e+07, -2.8716e-02,  1.3079e-01,  ...,  3.1594e-02,
            1.4516e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.5003e-02,  8.7594e-02,  ...,  1.3130e-02,
            1.5415e-01, -1.0000e+07],
          [-1.0000e+07, -2.3731e-02,  1.3239e-01,  ...,  4.4457e-03,
            1.3966e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4468e-01,  6.7090e-02,  ...,  4.1082e-02,
            2.1067e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4501e-01,  6.8656e-02,  ...,  4.1647e-02,
            2.1103e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.8011e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3068e-01,  1.2738e-01,  ...,  7.1811e-02,
            1.5717e-01, -1.0000e+07],
          [-1.0000e+07, -5.3311e-02,  1.1351e-01,  ...,  4.1523e-02,
            1.4602e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6243e-01,  1.4171e-01,  ...,  8.2421e-02,
            1.7519e-01, -3.7482e-01],
          [-1.0000e+07, -1.0206e-01,  1.6286e-01,  ...,  7.1494e-02,
            1.4458e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.8559e-02, -1.1905e-02],
         [-5.7917e-02, -2.8716e-02],
         [ 1.5415e-01, -2.3731e-02],
         [ 1.6687e-01, -3.7017e-02],
         [ 1.5513e-01, -7.0370e-02],
         [ 2.5283e-02, -3.3081e-02],
         [ 4.5468e-02, -7.4930e-02],
         [-9.6702e-02, -7.0723e-02],
         [-6.8127e-02, -6.6759e-02],
         [-8.7963e-02, -4.0186e-02],
         [-9.0926e-02, -6.1752e-02],
         [ 1.6536e-01, -6.2848e-02],
         [ 1.7788e-01, -7.1370e-02],
         [-7.9980e-02, -6.6090e-02],
         [-7.5547e-02, -7.0622e-02],
         [-7.0592e-02, -6.4430e-02],
         [-4.7961e-02, -7.3694e-02],
         [-3.3701e-02, -3.9773e-02],
         [-3.5824e-02, -4.4556e-02],
         [-5.9471e-02, -3.2453e-02],
         [-8.8121e-02, -4.0927e-02],
         [-8.7587e-02, -4.6444e-02],
         [-7.9990e-02, -8.0964e-02],
         [ 1.2559e-02, -4.1623e-02],
         [-4.7337e-02, -7.7678e-02],
         [ 1.3349e-01, -8.2034e-02],
         [ 1.4791e-01, -7.3955e-02],
         [-7.9837e-02, -8.1260e-02],
         [-8.3610e-02, -5.2692e-02],
         [-4.6494e-02, -4.0375e-02],
         [-5.2962e-02, -3.1153e-02],
         [-3.8823e-02, -4.3006e-02],
         [ 1.2786e-01, -4.8161e-02],
         [-6.4878e-02, -8.9287e-02],
         [-9.3997e-02, -4.5570e-02],
         [-1.0024e-01, -7.1360e-02],
         [-8.8802e-02, -3.7441e-02],
         [-6.2473e-02, -2.8564e-02],
         [-6.3083e-02, -7.9244e-03],
         [-7.7743e-04, -2.8669e-02],
         [ 1.3573e-01, -3.7452e-02],
         [-1.0003e-01, -4.8081e-02],
         [ 4.0487e-02, -5.2222e-02],
         [ 2.4001e-02, -7.9312e-02],
         [ 1.3549e-01, -5.4999e-02],
         [-9.4432e-02, -6.0178e-02],
         [ 1.6294e-01, -6.3932e-02],
         [ 3.6235e-02, -6.3072e-02],
         [ 2.4531e-02, -4.6780e-02],
         [ 1.3452e-01, -5.1403e-02],
         [-7.9720e-02, -5.3779e-02],
         [-9.1405e-02, -4.4832e-02],
         [ 6.3045e-02, -4.5419e-02],
         [ 4.4845e-02, -8.2723e-02],
         [-1.2301e-01, -7.6822e-02],
         [ 2.2913e-02, -6.0175e-02],
         [-9.7851e-02, -5.0787e-02],
         [-8.2665e-02, -4.5652e-02],
         [ 3.3072e-02, -4.4587e-02],
         [-8.1894e-02, -5.7455e-02],
         [ 3.3912e-02, -5.9085e-02],
         [ 8.4228e-03, -4.8547e-02],
         [ 4.1560e-02, -6.0033e-02],
         [ 4.7147e-02, -6.6878e-02],
         [ 3.7587e-02, -6.0006e-02],
         [ 7.3910e-03, -3.9698e-02],
         [ 1.3869e-01, -3.4019e-02],
         [ 1.3684e-01, -1.3726e-02],
         [ 1.3502e-01, -2.3338e-02],
         [ 1.3034e-01, -4.2999e-02],
         [ 1.4051e-01, -5.0156e-02],
         [-3.8285e-02, -7.2504e-02],
         [ 1.3543e-01, -5.0346e-02],
         [ 1.2203e-01, -6.4172e-02],
         [-3.5493e-02, -6.1976e-02],
         [-5.6746e-02, -7.4671e-02],
         [-4.3677e-02, -6.6637e-02],
         [-6.0466e-02, -6.5863e-02],
         [-7.2923e-02,  1.7021e-01],
         [-7.8629e-02, -4.7529e-02],
         [-8.5384e-02,  1.6920e-01],
         [-7.7050e-02,  1.8394e-01],
         [-7.4076e-02, -8.3172e-02],
         [ 1.3324e-01,  4.9766e-02],
         [-7.3000e-02,  3.5755e-02],
         [-5.8875e-02, -3.3334e-02],
         [-7.2006e-02,  1.5036e-01],
         [-6.3161e-02, -5.5713e-02],
         [-4.7155e-02, -6.3122e-02],
         [-6.6784e-02, -5.6602e-02],
         [-7.8988e-02, -7.8180e-02],
         [-8.3335e-02, -5.5142e-02],
         [ 1.7324e-01, -4.3147e-02],
         [ 1.7990e-01, -5.0624e-02],
         [ 1.7337e-01, -6.0272e-02],
         [ 5.3350e-02, -8.1656e-02],
         [-9.1245e-02, -8.4007e-02],
         [-8.0711e-02, -7.1452e-02],
         [ 3.6670e-02, -6.4714e-02],
         [ 5.1419e-02, -5.9702e-02],
         [ 5.7175e-02, -6.2756e-02],
         [-8.5844e-02, -7.4594e-02],
         [-7.2162e-02, -7.8305e-02],
         [-7.2313e-02,  4.8680e-02],
         [-5.6262e-02, -6.1692e-02],
         [-4.8185e-02, -6.6535e-02],
         [-4.9035e-02, -6.1635e-02],
         [-5.3916e-02, -4.9212e-02],
         [-5.1839e-02, -5.4433e-02],
         [-4.5923e-02, -4.8782e-02],
         [-5.5801e-02, -5.7808e-02],
         [-5.0990e-02, -5.8946e-02],
         [-4.0317e-02, -6.5449e-02],
         [-4.8024e-02, -6.9720e-02],
         [ 1.3949e-01, -7.8004e-02],
         [ 1.2208e-01, -8.5215e-02],
         [ 1.2804e-01, -7.5086e-02],
         [-6.4592e-02, -7.3325e-02],
         [ 1.1950e-01, -5.6604e-02],
         [-7.9993e-02, -5.8082e-02],
         [-7.7717e-02, -4.8397e-02],
         [-9.6276e-02, -6.5068e-02],
         [-8.3477e-02, -7.6330e-02],
         [-8.1069e-02, -7.7321e-02],
         [-8.1880e-02, -6.4687e-02],
         [-6.6575e-02, -5.2988e-02],
         [-8.8851e-02, -5.6613e-02],
         [ 6.5842e-02, -6.2479e-02],
         [-8.3291e-02, -7.0778e-02],
         [-7.3068e-02, -7.3384e-02],
         [-7.1615e-02, -5.4946e-02],
         [ 3.0137e-02, -5.2287e-02],
         [ 4.6061e-02, -5.5163e-02],
         [-7.5774e-02, -5.7959e-02],
         [-8.1478e-02, -4.5044e-02],
         [-7.6971e-02, -5.3754e-02],
         [-6.9387e-02, -4.9702e-02],
         [-6.7878e-02, -3.9856e-02],
         [ 1.4424e-01,  1.4663e-01],
         [ 1.3921e-01, -3.7147e-02],
         [-6.3329e-02, -5.0338e-02],
         [-7.4682e-02, -4.7819e-02],
         [-8.1372e-02,  3.1968e-02],
         [ 1.7518e-01, -7.1904e-02],
         [-6.6370e-02, -7.8606e-02],
         [-6.7923e-02, -8.7451e-02],
         [-5.2632e-02,  2.6693e-02],
         [-4.3047e-02,  1.6360e-01],
         [-5.7809e-02,  1.6482e-01],
         [-4.5289e-02,  1.6543e-01],
         [-5.2234e-02,  1.6386e-01],
         [-9.7562e-02,  1.8258e-01],
         [-9.6429e-02,  1.9234e-01],
         [-9.4478e-02,  1.7938e-01],
         [-1.1170e-01, -8.7352e-02],
         [ 5.3073e-02, -8.7301e-02],
         [ 6.1601e-02, -5.6506e-02],
         [ 1.7052e-01, -8.5427e-03],
         [ 7.4118e-02, -9.7593e-03],
         [ 5.2654e-02,  1.3449e-02],
         [ 3.9127e-02,  1.2439e-02],
         [ 2.2927e-02, -6.2306e-02],
         [ 3.0898e-02,  1.7089e-01],
         [ 1.6644e-02, -8.6679e-02],
         [ 2.8164e-02, -6.2272e-02],
         [ 5.2517e-02, -7.4279e-02],
         [ 2.5942e-02, -7.6456e-02],
         [ 5.0968e-02, -8.8610e-02],
         [ 2.1353e-02, -7.4985e-02],
         [ 3.9518e-02, -5.0273e-02],
         [-1.2764e-01, -2.5927e-02],
         [-1.2641e-01, -2.5149e-02],
         [ 1.7220e-02, -3.6052e-02],
         [-1.9947e-02, -3.2077e-02],
         [ 1.5737e-02, -3.3678e-02],
         [ 3.4325e-02, -3.6564e-02],
         [ 4.3325e-02, -4.7048e-02],
         [ 4.7501e-02, -3.0904e-02],
         [ 4.9270e-02, -3.3159e-02],
         [ 4.9924e-02, -1.1420e-02],
         [ 5.0131e-02, -2.2271e-02],
         [ 5.0164e-02, -3.1492e-02],
         [ 5.0119e-02, -3.8436e-03],
         [ 5.0091e-02,  1.8103e-04],
         [ 5.0037e-02, -3.8974e-02],
         [ 5.0028e-02, -2.5999e-03],
         [ 5.0044e-02, -3.6162e-02],
         [ 5.0032e-02, -5.8370e-02],
         [ 5.0043e-02, -2.9889e-02],
         [ 5.0017e-02, -2.4813e-02],
         [ 5.0003e-02, -3.6004e-02],
         [ 5.0021e-02, -2.1968e-02],
         [ 5.0021e-02, -2.6965e-02],
         [ 5.0020e-02, -3.2630e-02],
         [ 5.0016e-02, -4.5006e-02],
         [ 5.0006e-02, -7.3487e-02],
         [ 5.0007e-02, -9.7056e-02],
         [ 5.0008e-02, -1.1022e-01],
         [ 5.0007e-02, -1.3629e-01],
         [ 5.0008e-02,  6.9701e-02],
         [ 5.0008e-02, -9.6063e-02],
         [ 5.0008e-02, -1.2293e-01],
         [ 5.0008e-02,  2.1530e-01],
         [ 5.0008e-02, -1.0007e-01],
         [ 5.0008e-02,  2.0346e-01],
         [ 5.0008e-02,  2.0947e-01],
         [ 5.0009e-02,  2.2652e-01],
         [ 5.0009e-02,  2.2337e-01],
         [ 5.0009e-02,  2.1775e-01],
         [ 5.0009e-02,  2.1562e-01],
         [ 5.0009e-02,  6.1940e-02],
         [ 5.0009e-02, -1.4728e-01],
         [ 5.0009e-02,  3.3708e-02],
         [ 5.0009e-02,  3.8616e-02],
         [ 5.0009e-02, -7.7391e-02],
         [ 5.0009e-02, -7.7249e-02],
         [ 5.0009e-02, -7.7820e-02],
         [ 5.0009e-02,  2.8011e-02]],

        [[ 6.2561e-02, -5.4216e-02],
         [ 7.1811e-02, -5.3311e-02],
         [ 8.2421e-02, -1.0206e-01],
         [ 6.5713e-02, -1.2888e-01],
         [ 3.2943e-02, -1.2246e-01],
         [ 7.9017e-02, -1.1318e-01],
         [ 4.5252e-02, -1.3130e-01],
         [ 5.8063e-02, -1.4177e-01],
         [ 7.9679e-02, -1.5074e-01],
         [ 7.1671e-02, -1.4167e-01],
         [ 6.6467e-02, -1.5306e-01],
         [ 6.0495e-02, -1.6105e-01],
         [ 1.3653e-01, -1.7487e-01],
         [ 1.4914e-01, -1.7457e-01],
         [ 8.4748e-02, -1.7834e-01],
         [ 1.3976e-01, -1.8304e-01],
         [ 9.2883e-02, -1.8290e-01],
         [ 7.9296e-02, -1.8767e-01],
         [ 7.2473e-02, -1.8207e-01],
         [ 6.9770e-02, -1.7570e-01],
         [ 1.2513e-01, -1.7676e-01],
         [ 1.3430e-01, -1.7126e-01],
         [ 1.5261e-01, -1.6493e-01],
         [ 1.1913e-01, -1.5972e-01],
         [ 1.3172e-01, -1.5877e-01],
         [ 1.3755e-01, -1.3750e-01],
         [ 1.5147e-01, -1.2694e-01],
         [ 1.5470e-01, -7.4746e-02],
         [ 1.5806e-01, -5.4487e-02],
         [ 1.3402e-01, -8.4421e-03],
         [ 9.6242e-02,  2.5825e-02],
         [ 9.4636e-02,  4.2677e-02],
         [ 1.1452e-01,  5.0398e-02],
         [ 9.0876e-02,  5.3661e-02],
         [ 1.9631e-01,  5.4913e-02],
         [-3.3731e-01,  5.5314e-02],
         [ 7.8688e-02,  5.5408e-02],
         [-3.2936e-01,  5.5381e-02],
         [ 1.0514e-01,  5.5321e-02],
         [ 1.0174e-01,  5.5292e-02],
         [ 1.8728e-01,  5.5244e-02],
         [ 8.2941e-02,  5.5216e-02],
         [-2.1913e-01,  5.5235e-02],
         [-3.4046e-01,  5.5230e-02],
         [-3.0787e-02,  5.5219e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-7.0752e-06, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.9597, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4486, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8133, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0221, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0990, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0870, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3967889.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2265, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.4906e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0007, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2852, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3227, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2852, device='cuda:0', grad_fn=<MinBackward1>)
t_env 16229
target_mac_out tensor([[[[-1.0000e+07, -5.5215e-02,  8.8677e-02,  ...,  2.3305e-02,
            1.2081e-01, -1.0000e+07],
          [-1.0000e+07, -5.3949e-02,  1.3771e-01,  ...,  6.3333e-02,
            1.3943e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1528e-01,  1.1518e-01,  ...,  5.1719e-02,
            1.4870e-01, -1.0000e+07],
          [-1.0000e+07, -4.6759e-02,  1.2594e-01,  ...,  2.6035e-02,
            1.4146e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4828e-01,  1.2714e-01,  ...,  6.6744e-02,
            1.6089e-01, -1.0000e+07],
          [-1.0000e+07, -8.7643e-02,  1.5163e-01,  ...,  5.6911e-02,
            1.5296e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7175e-02,  8.1043e-02,  ...,  2.3772e-02,
            1.2601e-01, -1.0000e+07],
          [-1.0000e+07, -3.0851e-02,  1.2640e-01,  ...,  1.8911e-02,
            1.4901e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3968e-02,  1.0288e-01,  ...,  4.2058e-02,
            1.5994e-01, -1.0000e+07],
          [-1.0000e+07, -2.7312e-02,  1.2249e-01,  ..., -4.1138e-03,
            1.4328e-01, -1.0000e+07]],

         ...,

         [[ 5.0006e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4190e-01,  7.7815e-02,  ...,  4.5801e-02,
            1.9438e-01, -3.0147e-01]],

         [[ 5.0007e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4717e-01,  8.1833e-02,  ...,  4.5655e-02,
            1.9854e-01, -3.0290e-01]],

         [[ 5.0007e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.5325e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.5215e-02, -5.3949e-02],
         [ 5.1719e-02, -4.6759e-02],
         [ 6.6744e-02, -8.7643e-02],
         [ 8.0545e-02, -1.2264e-01],
         [ 6.1925e-02, -1.3291e-01],
         [ 1.3234e-01, -1.4411e-01],
         [ 1.4401e-01, -1.5065e-01],
         [ 1.5285e-01, -1.6186e-01],
         [ 7.7695e-02, -1.6270e-01],
         [ 7.2652e-02, -1.5374e-01],
         [ 4.8912e-02, -1.4927e-01],
         [ 1.2901e-01, -1.4872e-01],
         [ 6.3924e-02, -1.8541e-01],
         [ 7.8620e-02, -1.7505e-01],
         [ 7.5608e-02, -1.6190e-01],
         [ 6.2291e-02, -1.6467e-01],
         [ 6.7364e-02, -1.6673e-01],
         [ 8.6369e-02, -1.5414e-01],
         [ 1.0210e-01, -1.4052e-01],
         [ 1.6138e-01, -1.2128e-01],
         [ 7.8783e-02, -5.0407e-02],
         [ 6.6463e-02, -6.9712e-02],
         [ 1.9615e-02, -6.1717e-02],
         [ 3.5011e-02, -1.5410e-01],
         [ 4.3864e-02, -1.4004e-01],
         [ 4.8044e-02, -1.4703e-01],
         [ 4.9731e-02, -1.4398e-01],
         [ 5.0221e-02, -1.5523e-01],
         [ 5.0288e-02, -1.4595e-01],
         [ 5.0193e-02, -8.2083e-02],
         [ 5.0112e-02, -8.0176e-02],
         [ 5.0039e-02,  2.4125e-01],
         [ 5.0010e-02,  2.2683e-01],
         [ 5.0012e-02,  2.2118e-01],
         [ 4.9996e-02, -1.8503e-01],
         [ 5.0007e-02,  2.5279e-01],
         [ 5.0010e-02, -7.0455e-02],
         [ 5.0019e-02, -3.0609e-01],
         [ 5.0010e-02, -4.6084e-02],
         [ 5.0018e-02, -4.9030e-02],
         [ 5.0018e-02, -5.3909e-02],
         [ 5.0016e-02, -5.7747e-02],
         [ 5.0017e-02, -6.0613e-02],
         [ 5.0004e-02, -6.4306e-02],
         [ 5.0006e-02,  2.3543e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-4.8313e-02, -6.8065e-03],
         [-6.7175e-02, -3.0851e-02],
         [-9.3968e-02, -2.7312e-02],
         [ 6.0344e-02, -3.4960e-02],
         [ 7.0756e-02, -4.9262e-02],
         [ 5.2922e-02, -6.3606e-02],
         [ 4.9486e-02, -7.6720e-02],
         [ 2.1398e-02, -6.6795e-02],
         [ 7.5626e-03, -7.6195e-02],
         [ 3.9113e-02, -7.8108e-02],
         [ 4.7633e-02, -1.2014e-01],
         [ 6.1014e-02, -1.4574e-01],
         [ 8.6329e-02, -1.4480e-01],
         [ 1.0378e-01, -1.4128e-01],
         [ 9.2758e-02, -6.4931e-02],
         [ 9.0394e-02, -5.9972e-02],
         [ 1.0401e-01, -1.5977e-01],
         [ 9.4000e-02, -1.7623e-01],
         [ 6.0652e-02, -1.6436e-01],
         [ 3.8716e-02, -5.9818e-02],
         [ 2.6253e-02, -1.5570e-01],
         [ 2.0444e-02, -1.5345e-01],
         [ 3.7162e-02, -1.3383e-01],
         [ 6.2367e-02, -1.3633e-01],
         [-6.9574e-03, -1.6501e-01],
         [ 2.2558e-02, -1.5839e-01],
         [ 3.8409e-02, -1.6121e-01],
         [ 4.5885e-02,  2.2601e-01],
         [ 4.9005e-02, -1.8248e-01],
         [ 5.0101e-02, -1.6663e-01],
         [ 5.0365e-02, -1.6435e-01],
         [ 5.0330e-02, -1.7304e-01],
         [ 5.0222e-02, -3.3129e-01],
         [ 5.0149e-02,  2.4572e-01],
         [ 5.0067e-02, -2.0659e-01],
         [ 5.0044e-02,  2.3611e-01],
         [ 5.0028e-02, -1.9070e-01],
         [ 5.0015e-02, -1.8371e-01],
         [ 5.0018e-02, -1.9112e-01],
         [ 5.0030e-02,  2.3661e-01],
         [ 5.0021e-02, -1.8256e-01],
         [ 5.0014e-02, -1.6891e-01],
         [ 5.0015e-02, -1.5390e-01],
         [ 5.0013e-02, -1.3433e-01],
         [ 5.0018e-02, -1.3609e-01],
         [ 5.0006e-02, -1.4190e-01],
         [ 5.0007e-02, -1.4717e-01],
         [ 5.0007e-02,  1.5325e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.7317e-05, device='cuda:0') tensor(0.0027, device='cuda:0') tensor(-0.0028, device='cuda:0')
mixer_td_error tensor(0.0964, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4527, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8119, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0064, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0885, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1084, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-312500., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2528, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0018, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3206, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2865, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3206, device='cuda:0', grad_fn=<MinBackward1>)
t_env 16319
target_mac_out tensor([[[[-1.0000e+07, -5.3297e-02,  7.5482e-02,  ...,  2.0656e-03,
            1.2204e-01, -1.0000e+07],
          [-1.0000e+07, -1.9084e-02,  9.7086e-02,  ..., -1.3971e-02,
            1.2488e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.9376e-02,  6.2572e-02,  ...,  1.0603e-02,
            1.3047e-01, -1.0000e+07],
          [-1.0000e+07, -2.0197e-02,  8.7256e-02,  ..., -4.7699e-03,
            1.4069e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.0652e-02,  9.3472e-02,  ...,  1.1340e-02,
            1.5230e-01, -1.0000e+07],
          [-1.0000e+07, -3.5509e-02,  1.2358e-01,  ...,  1.7736e-02,
            1.5126e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.9274e-01,  8.5465e-02,  ...,  7.5590e-02,
            1.7347e-01, -3.2022e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.9750e-01,  1.0903e-01,  ...,  8.9321e-02,
            1.8810e-01, -3.2881e-01],
          [ 5.5233e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-2.1791e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5233e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2179e-02,  8.7653e-02,  ...,  1.1971e-02,
            1.4701e-01, -1.0000e+07],
          [-1.0000e+07, -3.7128e-02,  1.3220e-01,  ...,  9.6965e-03,
            1.4422e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2015e-01,  1.1093e-01,  ...,  4.2340e-02,
            1.6688e-01, -1.0000e+07],
          [-1.0000e+07, -5.8526e-02,  1.5231e-01,  ..., -4.5886e-04,
            1.5562e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.3297e-02, -1.9084e-02],
         [-4.9376e-02, -2.0197e-02],
         [-8.0652e-02, -3.5509e-02],
         [-1.0289e-01, -6.9216e-02],
         [-1.1144e-01, -1.0212e-01],
         [-1.0344e-01, -8.7480e-02],
         [-1.1140e-01, -5.4819e-02],
         [-9.4157e-02, -8.6740e-02],
         [-7.6723e-02, -9.6796e-02],
         [-9.4028e-02, -9.4201e-02],
         [-1.0262e-01, -9.5484e-02],
         [-1.0781e-01, -1.1317e-01],
         [-4.2669e-02, -1.5473e-01],
         [-8.3976e-02, -1.3036e-01],
         [ 1.2979e-01, -1.2781e-01],
         [ 1.3419e-01, -1.3190e-01],
         [ 1.4265e-01, -1.2375e-01],
         [ 1.1218e-01, -1.3441e-01],
         [-1.1117e-01, -1.2500e-01],
         [ 9.6031e-02, -1.1837e-01],
         [ 1.1457e-01, -8.9372e-02],
         [ 1.3285e-01, -1.1666e-01],
         [-1.6964e-01, -1.1154e-01],
         [-1.5567e-01, -1.3911e-01],
         [-1.5461e-01, -1.5363e-01],
         [-3.3692e-01, -1.3370e-01],
         [-3.4667e-01, -1.4471e-01],
         [-8.3706e-02, -1.3535e-01],
         [-1.2553e-01, -1.6707e-02],
         [ 1.0551e-01,  2.4713e-02],
         [ 1.0484e-01,  4.3323e-02],
         [ 8.5337e-02,  5.1013e-02],
         [ 1.0787e-01,  5.3948e-02],
         [ 1.1707e-01,  5.4925e-02],
         [ 1.3081e-01,  5.5185e-02],
         [ 1.0242e-01,  5.5231e-02],
         [ 1.1496e-01,  5.5187e-02],
         [ 8.7802e-02,  5.5177e-02],
         [ 9.0199e-02,  5.5157e-02],
         [ 6.5364e-02,  5.5186e-02],
         [ 1.2171e-01,  5.5153e-02],
         [ 8.2027e-02,  5.5192e-02],
         [ 1.1086e-01,  5.5187e-02],
         [ 1.3322e-01,  5.5192e-02],
         [ 9.7490e-02,  5.5214e-02],
         [-3.2134e-01,  5.5213e-02],
         [ 1.0894e-01,  5.5218e-02],
         [ 1.2309e-01,  5.5223e-02],
         [ 1.2606e-01,  5.5225e-02],
         [ 7.5590e-02,  5.5231e-02],
         [ 8.9321e-02,  5.5233e-02],
         [-2.1791e-02,  5.5233e-02]],

        [[ 6.0687e-02, -1.6811e-02],
         [-9.2179e-02, -3.7128e-02],
         [-1.2015e-01, -5.8526e-02],
         [ 1.0750e-01, -6.7599e-02],
         [ 1.0878e-01, -6.9425e-02],
         [ 8.6240e-02, -4.7316e-02],
         [ 1.2014e-01, -4.6827e-02],
         [ 1.1751e-01, -4.1586e-02],
         [ 1.3833e-01, -4.9353e-02],
         [-3.6220e-01, -5.0095e-02],
         [ 1.3786e-01, -5.0569e-02],
         [ 1.4762e-01, -7.0791e-02],
         [ 1.4024e-01, -8.0475e-02],
         [-3.6512e-01, -8.1164e-02],
         [ 1.4740e-01, -9.2157e-02],
         [-3.6888e-01, -9.7434e-02],
         [ 1.5353e-01,  1.4532e-01],
         [ 1.5919e-01, -1.2366e-01],
         [-3.5006e-01, -1.1940e-01],
         [-3.4952e-01, -1.4938e-01],
         [ 1.5976e-01, -1.5942e-01],
         [ 1.6824e-01, -1.6698e-01],
         [ 1.6872e-01, -1.6571e-01],
         [-1.5091e-02, -1.5991e-01],
         [ 1.5324e-02, -1.4625e-01],
         [ 3.3489e-02, -1.4509e-01],
         [ 4.2879e-02, -1.6873e-01],
         [ 4.7309e-02, -1.8823e-01],
         [ 4.9243e-02, -1.6561e-01],
         [ 4.9963e-02, -1.7248e-01],
         [ 5.0185e-02, -1.8790e-01],
         [ 5.0204e-02, -2.0530e-01],
         [ 5.0173e-02,  1.1752e-01],
         [ 5.0137e-02, -2.1284e-01],
         [ 5.0087e-02, -1.9576e-01],
         [ 5.0049e-02, -1.9460e-01],
         [ 5.0025e-02, -1.7806e-01],
         [ 5.0021e-02, -1.8597e-01],
         [ 5.0028e-02, -1.9731e-01],
         [ 5.0030e-02, -2.0245e-01],
         [ 5.0016e-02, -2.0247e-01],
         [ 5.0017e-02, -1.9910e-01],
         [ 5.0020e-02,  2.4523e-01],
         [ 5.0016e-02, -1.6392e-01],
         [ 5.0007e-02, -1.5541e-01],
         [ 5.0007e-02, -1.8117e-01],
         [ 5.0008e-02,  1.0281e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.3330e-05, device='cuda:0') tensor(0.0037, device='cuda:0') tensor(-0.0023, device='cuda:0')
mixer_td_error tensor(0.1309, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4488, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7069, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0999, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0783, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-480769.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2452, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0029, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3041, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3426, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3041, device='cuda:0', grad_fn=<MinBackward1>)
t_env 16419
target_mac_out tensor([[[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1792e-01,  1.2989e-01,  ...,  5.6814e-02,
            1.5398e-01, -1.0000e+07],
          [-1.0000e+07, -7.6477e-02,  1.2250e-01,  ...,  2.6030e-02,
            1.4386e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.4485e-01,  1.3815e-01,  ...,  6.9524e-02,
            1.6395e-01, -1.0000e+07],
          [-1.0000e+07, -8.6760e-02,  1.2859e-01,  ...,  2.7653e-02,
            1.3688e-01, -1.0000e+07]],

         ...,

         [[ 5.0015e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -2.1468e-01, -1.0000e+07,  ..., -1.0000e+07,
            2.5587e-01, -1.0000e+07]],

         [[ 5.0019e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -2.1631e-01, -1.0000e+07,  ..., -1.0000e+07,
            2.5657e-01, -1.0000e+07]],

         [[ 5.0021e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 7.2266e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3268e-01,  1.1815e-01,  ...,  6.9543e-02,
            1.6155e-01, -1.0000e+07],
          [-1.0000e+07, -2.7664e-02,  1.0133e-01,  ...,  1.0988e-02,
            1.3958e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6339e-01,  1.3025e-01,  ...,  7.9943e-02,
            1.7916e-01, -3.7833e-01],
          [-1.0000e+07, -5.6401e-02,  1.3878e-01,  ...,  3.7180e-02,
            1.4673e-01, -1.0000e+07]],

         ...,

         [[ 5.0007e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.3797e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 2.8398e-02, -5.1416e-02],
         [ 5.6814e-02, -7.6477e-02],
         [ 6.9524e-02, -8.6760e-02],
         [ 6.4402e-02, -8.3978e-02],
         [ 5.2876e-02, -8.9133e-02],
         [ 5.5161e-02, -8.5896e-02],
         [ 7.8994e-02, -8.0899e-02],
         [ 9.0474e-02, -8.9149e-02],
         [ 6.6951e-02, -9.1671e-02],
         [ 3.1018e-02, -1.1889e-01],
         [ 1.1598e-01, -1.4629e-01],
         [ 1.4271e-01, -1.4985e-01],
         [ 1.5470e-01, -1.5387e-01],
         [ 1.4993e-01, -1.7866e-01],
         [ 1.5456e-01, -1.8808e-01],
         [ 1.4806e-01, -1.7474e-01],
         [ 1.6081e-01, -1.9076e-01],
         [ 1.4369e-01, -1.8986e-01],
         [ 1.5432e-01, -1.7805e-01],
         [ 1.3593e-01, -1.6720e-01],
         [ 6.4608e-02, -1.7058e-01],
         [ 9.4749e-02, -1.9386e-01],
         [ 8.5512e-02, -1.8455e-01],
         [ 9.5470e-02, -1.8497e-01],
         [ 1.0209e-01, -1.8533e-01],
         [ 7.7887e-02, -1.6781e-01],
         [ 9.9816e-02, -1.6457e-01],
         [ 1.2581e-01, -1.7703e-01],
         [-2.5460e-02, -1.6860e-01],
         [ 1.1860e-02, -1.7013e-01],
         [ 3.2107e-02, -1.9929e-01],
         [ 4.2246e-02, -1.9544e-01],
         [ 4.7048e-02, -1.8862e-01],
         [ 4.9149e-02, -1.9165e-01],
         [ 4.9941e-02, -2.1671e-01],
         [ 5.0204e-02, -2.3088e-01],
         [ 5.0228e-02, -2.1269e-01],
         [ 5.0190e-02, -2.2293e-01],
         [ 5.0117e-02, -2.0097e-01],
         [ 5.0096e-02, -2.0721e-01],
         [ 5.0077e-02, -2.0976e-01],
         [ 5.0045e-02,  2.4906e-01],
         [ 5.0038e-02, -2.1279e-01],
         [ 5.0033e-02, -2.0531e-01],
         [ 5.0015e-02, -2.1468e-01],
         [ 5.0019e-02,  2.5657e-01],
         [ 5.0021e-02,  7.2266e-04]],

        [[ 6.1307e-02, -1.1117e-02],
         [ 6.9543e-02, -2.7664e-02],
         [ 7.9943e-02, -5.6401e-02],
         [ 1.0116e-01, -8.2999e-02],
         [ 6.9495e-02, -8.6803e-02],
         [ 8.2984e-02, -1.2210e-01],
         [ 6.7797e-02, -1.4395e-01],
         [ 1.3229e-01, -1.6379e-01],
         [ 1.3505e-01, -1.6342e-01],
         [ 1.0547e-01, -1.7975e-01],
         [ 8.2169e-02, -1.9085e-01],
         [ 1.0412e-01, -1.9374e-01],
         [ 6.1420e-02, -1.7703e-01],
         [ 5.8766e-02, -1.6345e-01],
         [ 5.3459e-02, -1.6952e-01],
         [ 5.2052e-02, -1.5186e-01],
         [ 2.8278e-02, -1.3665e-01],
         [ 3.4007e-02, -1.5597e-01],
         [ 2.8453e-02, -1.6972e-01],
         [ 2.6649e-02, -1.7456e-01],
         [-7.6913e-02, -1.6121e-01],
         [ 3.4286e-02, -1.7593e-01],
         [ 4.8491e-02, -1.6885e-01],
         [ 5.2648e-02, -1.5661e-01],
         [ 5.3158e-02, -1.6252e-01],
         [ 5.2547e-02, -1.8105e-01],
         [ 5.1760e-02, -1.7251e-01],
         [ 5.1121e-02, -1.6687e-01],
         [ 5.0658e-02, -1.6563e-01],
         [ 5.0389e-02, -1.9074e-01],
         [ 5.0232e-02, -1.8594e-01],
         [ 5.0121e-02, -1.9814e-01],
         [ 5.0043e-02, -1.8678e-01],
         [ 5.0036e-02, -1.9603e-01],
         [ 5.0026e-02, -1.7882e-01],
         [ 5.0025e-02, -1.9104e-01],
         [ 5.0005e-02, -1.9228e-01],
         [ 5.0005e-02, -1.7313e-01],
         [ 5.0012e-02, -1.6074e-01],
         [ 5.0015e-02, -1.5926e-01],
         [ 5.0016e-02, -1.4929e-01],
         [ 5.0014e-02,  2.3231e-01],
         [ 5.0008e-02,  2.2538e-01],
         [ 5.0007e-02, -1.6132e-01],
         [ 5.0007e-02,  1.3797e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.0657e-05, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0024, device='cuda:0')
mixer_td_error tensor(0.0537, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4816, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6714, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0105, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0866, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1045, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-212765.9688, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2566, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.6737e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0013, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3107, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1995, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3107, device='cuda:0', grad_fn=<MinBackward1>)
t_env 16637
target_mac_out tensor([[[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2489e-02,  1.2578e-01,  ...,  5.0639e-02,
            1.4352e-01, -1.0000e+07],
          [-1.0000e+07, -3.4800e-02,  8.5615e-02,  ..., -3.3144e-02,
            1.3339e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.6344e-02,  1.0249e-01,  ...,  3.1700e-02,
            1.3221e-01, -1.0000e+07],
          [-1.0000e+07, -7.1485e-02,  1.3421e-01,  ...,  3.2735e-02,
            1.5583e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.2707e-02,  8.4580e-02,  ..., -1.5876e-03,
            1.4548e-01, -1.0000e+07],
          [-1.0000e+07, -2.6524e-02,  1.0689e-01,  ..., -3.0931e-02,
            1.3391e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.4452e-02,  1.0088e-01,  ...,  2.5699e-02,
            1.7334e-01, -1.0000e+07],
          [-1.0000e+07, -3.2522e-02,  9.8135e-02,  ..., -1.2687e-02,
            1.4405e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.3231e-01,  1.2048e-01,  ...,  9.8392e-02,
            2.1710e-01, -3.4056e-01],
          [ 5.5229e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1107e-01,  8.6853e-02,  ...,  8.4553e-02,
            1.9610e-01, -3.2675e-01],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0382e-04, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.8078e-02, -2.1879e-02],
         [-9.2489e-02, -3.4800e-02],
         [-6.6344e-02, -7.1485e-02],
         [-1.0548e-01, -9.1662e-02],
         [-1.1719e-01, -8.7805e-02],
         [-1.4753e-01, -8.1989e-02],
         [ 4.7977e-02, -8.5619e-02],
         [-1.6347e-01, -9.8079e-02],
         [ 1.4917e-01, -1.0705e-01],
         [ 1.4935e-01, -1.4653e-01],
         [ 4.7667e-02, -1.4730e-01],
         [ 2.0494e-02, -1.4459e-01],
         [ 3.7083e-02, -1.3934e-01],
         [ 1.6308e-01,  8.9094e-02],
         [ 4.2846e-02,  1.0997e-01],
         [ 5.4270e-02,  1.0663e-01],
         [ 4.6632e-02, -1.7359e-01],
         [ 6.5586e-02, -1.6268e-01],
         [-1.8097e-01,  9.1937e-02],
         [-1.7159e-01,  1.0782e-01],
         [ 6.6077e-02,  1.1709e-01],
         [ 7.7844e-02, -2.0000e-01],
         [ 8.4519e-02, -2.0236e-01],
         [ 7.7906e-02, -1.5885e-01],
         [-1.7623e-01, -1.7802e-01],
         [ 7.2618e-02, -1.9529e-01],
         [-3.6288e-02, -1.3267e-01],
         [ 6.6374e-03, -7.6399e-02],
         [ 2.9214e-02, -4.5148e-02],
         [ 4.0513e-02, -6.0116e-02],
         [ 4.5928e-02, -5.0529e-02],
         [ 4.8425e-02, -5.1336e-02],
         [ 4.9503e-02, -6.4086e-02],
         [ 4.9903e-02, -7.7002e-02],
         [ 5.0050e-02, -9.4385e-02],
         [ 5.0070e-02, -1.1258e-01],
         [ 5.0066e-02,  7.6874e-02],
         [ 5.0037e-02, -1.0250e-01],
         [ 5.0012e-02, -9.4391e-02],
         [ 5.0030e-02, -1.1642e-01],
         [ 5.0016e-02, -1.3894e-01],
         [ 5.0017e-02, -1.4884e-01],
         [ 5.0015e-02, -1.2738e-01],
         [ 5.0022e-02, -8.0331e-02],
         [ 5.0012e-02, -7.0755e-02],
         [ 5.0016e-02,  2.4475e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 2.7572e-02, -8.8067e-03],
         [-8.2707e-02, -2.6524e-02],
         [-9.4452e-02, -3.2522e-02],
         [-1.0440e-01, -4.9924e-02],
         [-8.6131e-02, -4.0075e-02],
         [-8.5475e-02, -5.0969e-02],
         [-9.8038e-02, -3.7381e-02],
         [-1.0169e-01, -3.4804e-02],
         [-1.1532e-01, -4.0342e-02],
         [-1.3655e-01, -2.7439e-02],
         [ 4.4126e-02, -3.1532e-02],
         [-1.4174e-01, -4.8465e-02],
         [-1.1333e-01, -5.9935e-02],
         [-7.8628e-02, -7.2656e-02],
         [-9.7462e-02, -7.3884e-02],
         [-8.9808e-02, -7.7936e-02],
         [ 2.1717e-02, -1.0612e-01],
         [ 3.0207e-02, -9.4897e-02],
         [ 3.3126e-02, -1.0524e-01],
         [ 1.0693e-01, -1.0479e-01],
         [ 1.1281e-01, -9.4547e-02],
         [ 1.1854e-01, -9.3868e-02],
         [-9.9721e-02, -7.5711e-02],
         [-9.7103e-02, -6.5970e-02],
         [-8.1989e-02, -5.9235e-02],
         [-7.2402e-02, -4.1034e-02],
         [-8.1663e-02, -2.9444e-02],
         [ 1.1497e-01, -4.1719e-02],
         [ 1.2510e-01, -6.2412e-02],
         [ 1.2012e-01, -5.8940e-02],
         [ 1.0804e-01, -7.5428e-02],
         [ 1.2327e-01, -7.5354e-02],
         [ 1.3105e-01, -7.7454e-02],
         [ 1.2915e-01, -7.8358e-02],
         [ 1.0961e-01, -8.4423e-02],
         [ 1.0338e-01, -9.1334e-02],
         [ 1.1375e-01, -8.2011e-02],
         [-1.0561e-01, -7.1449e-02],
         [-1.1739e-01, -8.3065e-02],
         [-9.1050e-02, -8.0909e-02],
         [-1.0015e-01, -8.1734e-02],
         [-1.3205e-01, -7.4957e-02],
         [-9.9421e-02, -8.3578e-02],
         [-9.4292e-02, -7.2173e-02],
         [-8.7124e-02, -8.3784e-02],
         [-9.7273e-02, -7.3484e-02],
         [-8.4362e-02, -8.2960e-02],
         [-6.8048e-02, -8.8925e-02],
         [-6.1558e-02, -9.0591e-02],
         [-1.1030e-01, -9.5428e-02],
         [-8.2255e-02, -9.4739e-02],
         [-7.1273e-02, -7.9962e-02],
         [-6.2643e-02, -9.0318e-02],
         [-1.1027e-01, -9.1374e-02],
         [-8.9953e-02, -1.2776e-01],
         [-7.8804e-02, -1.5365e-01],
         [-1.3827e-01,  9.5479e-02],
         [-1.1602e-01,  6.7963e-02],
         [-1.5906e-01,  8.5995e-02],
         [-1.4606e-01,  9.6316e-02],
         [-1.8693e-01,  7.9782e-02],
         [-1.4944e-01,  4.6530e-02],
         [-1.8759e-01, -1.6261e-01],
         [-1.8143e-01, -1.4431e-01],
         [-1.9603e-01, -1.4994e-01],
         [-2.0895e-01, -1.5747e-01],
         [-2.1663e-01, -1.5466e-01],
         [-2.3089e-01, -1.5483e-01],
         [-1.8278e-01, -1.5095e-01],
         [-1.5708e-01,  9.4147e-02],
         [-1.5435e-01,  5.4061e-02],
         [-1.3191e-01,  9.4904e-02],
         [-1.1921e-01,  1.1185e-01],
         [-1.2024e-01,  1.1808e-01],
         [-1.4102e-01,  5.8401e-02],
         [-1.4892e-01, -3.2357e-03],
         [-1.5825e-01,  2.9352e-02],
         [-1.6409e-01,  4.5215e-02],
         [-1.5633e-01,  5.2154e-02],
         [-1.6280e-01,  5.4819e-02],
         [-1.7979e-01,  5.5629e-02],
         [ 1.0345e-01,  5.5731e-02],
         [ 1.2860e-01,  5.5633e-02],
         [ 1.2270e-01,  5.5472e-02],
         [-3.3551e-01,  5.5380e-02],
         [ 1.1736e-01,  5.5284e-02],
         [ 1.2694e-01,  5.5247e-02],
         [-3.3683e-01,  5.5221e-02],
         [ 9.8147e-02,  5.5219e-02],
         [ 1.1330e-01,  5.5250e-02],
         [ 1.1960e-01,  5.5221e-02],
         [-3.4150e-01,  5.5218e-02],
         [-3.3232e-01,  5.5210e-02],
         [ 1.1704e-01,  5.5211e-02],
         [ 8.2635e-02,  5.5223e-02],
         [ 9.8392e-02,  5.5229e-02],
         [ 8.4553e-02,  5.5232e-02],
         [-1.0382e-04,  5.5230e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.4248e-06, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0013, device='cuda:0')
mixer_td_error tensor(0.6462, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4464, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5293, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0074, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1011, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1147, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2653060.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1631, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.4626e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0007, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1718, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.3211, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1718, device='cuda:0', grad_fn=<MinBackward1>)
t_env 16765
target_mac_out tensor([[[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7175e-02,  8.1043e-02,  ...,  2.3772e-02,
            1.2601e-01, -1.0000e+07],
          [-1.0000e+07, -3.0851e-02,  1.2640e-01,  ...,  1.8911e-02,
            1.4901e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.1041e-02,  8.0018e-02,  ..., -7.0601e-04,
            1.3470e-01, -1.0000e+07],
          [-1.0000e+07, -6.5586e-02,  1.4954e-01,  ...,  4.8926e-02,
            1.5883e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.3297e-02,  7.5482e-02,  ...,  2.0656e-03,
            1.2204e-01, -1.0000e+07],
          [-1.0000e+07, -1.9084e-02,  9.7086e-02,  ..., -1.3971e-02,
            1.2488e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.0134e-02,  8.9171e-02,  ...,  1.5380e-04,
            1.3788e-01, -1.0000e+07],
          [-1.0000e+07, -2.4728e-02,  8.6706e-02,  ..., -1.6041e-03,
            1.3979e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.9489e-02,  1.0306e-01,  ...,  1.6705e-03,
            1.6271e-01, -1.0000e+07],
          [-1.0000e+07, -4.1634e-02,  1.1997e-01,  ..., -3.3451e-03,
            1.4593e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  7.5734e-03,  6.1346e-02,  ..., -3.6668e-02,
            1.5688e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  8.8780e-03,  3.7090e-02,  ..., -4.4346e-02,
            1.5357e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -2.5139e-03,  1.1379e-02,  ..., -6.2356e-02,
            1.5361e-01, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-4.8313e-02, -6.8065e-03],
         [-6.7175e-02, -3.0851e-02],
         [-8.1041e-02, -6.5586e-02],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-5.3297e-02, -1.9084e-02],
         [-6.0134e-02, -2.4728e-02],
         [-7.9489e-02, -4.1634e-02],
         ...,
         [ 5.0009e-02,  7.5734e-03],
         [ 5.0009e-02,  8.8780e-03],
         [ 5.0009e-02, -2.5139e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-5.2441e-06, device='cuda:0') tensor(0.0004, device='cuda:0') tensor(-0.0005, device='cuda:0')
mixer_td_error tensor(1.0032, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4889, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4102, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0245, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0964, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1345, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-4150000., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2143, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.9069e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2414, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2592, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2414, device='cuda:0', grad_fn=<MinBackward1>)
t_env 16834
target_mac_out tensor([[[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.8475e-02,  8.3930e-02,  ...,  2.9168e-03,
            1.4114e-01, -1.0000e+07],
          [-1.0000e+07, -2.8572e-02,  1.0818e-01,  ...,  1.1152e-02,
            1.4585e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1306e-02,  8.6921e-02,  ..., -3.6412e-03,
            1.5129e-01, -1.0000e+07],
          [-1.0000e+07, -2.5687e-02,  1.0845e-01,  ...,  2.2908e-02,
            1.4218e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5278e-02,  9.0873e-02,  ...,  2.5301e-02,
            1.4665e-01, -1.0000e+07],
          [-1.0000e+07, -2.5623e-02,  1.3376e-01,  ..., -4.3574e-03,
            1.4677e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1539e-02,  9.2270e-02,  ...,  3.6193e-02,
            1.4195e-01, -1.0000e+07],
          [-1.0000e+07, -3.4843e-02,  1.4889e-01,  ..., -1.2452e-02,
            1.5781e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.1414e-01,  1.2412e-01,  ...,  8.7058e-02,
            1.9353e-01, -3.3818e-01],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7946e-01,  9.8643e-02,  ...,  4.9281e-02,
            1.6479e-01, -3.2595e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.7422e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.8723e-02, -2.2603e-02],
         [-6.8475e-02, -2.8572e-02],
         [-7.1306e-02, -2.5687e-02],
         [-5.9246e-02, -2.6092e-02],
         [-4.4252e-02, -2.4443e-02],
         [-3.1243e-02, -2.4662e-02],
         [-5.9564e-02, -1.0531e-02],
         [-7.7253e-02, -2.4002e-02],
         [ 5.9566e-02, -3.5305e-02],
         [ 4.5224e-02, -3.4533e-02],
         [ 1.6853e-02, -3.7655e-02],
         [ 2.8068e-02, -3.9152e-02],
         [ 3.7339e-02, -2.3581e-02],
         [ 4.4949e-02, -2.6467e-02],
         [ 7.3711e-02, -5.3058e-02],
         [ 4.4114e-02, -6.5972e-02],
         [ 6.0602e-02, -7.0993e-02],
         [ 3.6869e-02, -5.6819e-02],
         [ 4.5540e-02, -3.2668e-02],
         [ 5.2344e-02, -5.2921e-02],
         [ 8.9246e-02, -3.9493e-02],
         [ 8.7165e-02, -2.6359e-02],
         [ 9.9394e-02, -9.9973e-03],
         [ 8.5136e-02, -3.4250e-02],
         [ 4.5542e-02, -6.0072e-02],
         [ 2.4626e-02, -5.9977e-02],
         [ 4.1600e-02, -5.5113e-02],
         [ 4.2789e-02, -5.8082e-02],
         [ 5.2790e-02, -4.7433e-02],
         [ 2.9505e-02, -7.4025e-02],
         [-8.0289e-02, -8.7967e-02],
         [-5.3507e-02, -9.5626e-02],
         [-6.3456e-02, -1.3600e-01],
         [-6.5639e-02, -1.6223e-01],
         [-4.8570e-02, -1.8707e-01],
         [-4.2619e-02, -1.9457e-01],
         [-5.8962e-02, -1.8533e-01],
         [ 2.8524e-02, -1.7629e-01],
         [ 4.3143e-02, -1.9043e-01],
         [ 5.9296e-02, -2.1644e-01],
         [ 4.2341e-02, -2.1679e-01],
         [ 4.2782e-02, -2.3257e-01],
         [ 6.1111e-02, -2.1469e-01],
         [ 7.2665e-02, -2.0462e-01],
         [ 7.9798e-02, -1.7661e-01],
         [ 6.6431e-02, -2.0172e-01],
         [ 5.7659e-02, -2.0388e-01],
         [ 5.5229e-02, -2.1442e-01],
         [ 5.4297e-02, -2.0046e-01],
         [ 2.7012e-02, -1.7924e-01],
         [ 1.4504e-02, -1.9652e-01],
         [ 3.2923e-02, -2.0624e-01],
         [ 4.2669e-02, -1.9803e-01],
         [ 4.7293e-02, -2.1157e-01],
         [ 4.9259e-02, -2.1419e-01],
         [ 4.9997e-02, -2.0695e-01],
         [ 5.0192e-02, -1.6841e-01],
         [ 5.0199e-02,  1.3414e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[-4.8313e-02, -6.8065e-03],
         [ 2.5301e-02, -2.5623e-02],
         [ 3.6193e-02, -3.4843e-02],
         [ 2.2073e-02, -4.7116e-02],
         [-7.0329e-02, -6.0932e-02],
         [-2.8623e-02, -7.5610e-02],
         [-5.5461e-02, -8.5062e-02],
         [-8.1191e-02, -7.0759e-02],
         [-2.7127e-02, -7.9715e-02],
         [-2.0203e-02, -7.3175e-02],
         [-1.6799e-02, -1.1706e-01],
         [-5.1448e-02, -1.4747e-01],
         [-7.3581e-02, -1.7795e-01],
         [-8.7893e-02, -1.3743e-01],
         [-9.8712e-02, -1.1263e-01],
         [-7.8309e-02, -1.5412e-01],
         [-2.1855e-02, -1.8706e-01],
         [-1.5672e-02, -1.8358e-01],
         [-2.0174e-02, -1.8638e-01],
         [-2.5972e-03, -2.0282e-01],
         [-4.1549e-02, -1.8541e-01],
         [-7.3431e-02, -2.0039e-01],
         [-8.0342e-02, -2.0964e-01],
         [-9.4085e-02, -1.8892e-01],
         [-8.7005e-02, -1.7328e-01],
         [-8.4667e-02, -1.5700e-01],
         [-8.3060e-02, -1.4621e-01],
         [-6.6150e-02, -1.6810e-01],
         [-1.4789e-02, -1.5670e-01],
         [-1.2323e-02, -1.7368e-01],
         [-4.9126e-02, -1.6606e-01],
         [-6.5314e-02, -1.6372e-02],
         [-5.2439e-02,  2.3109e-02],
         [-1.7582e-02,  4.2014e-02],
         [-4.9077e-02,  5.0433e-02],
         [-7.0830e-02,  5.3902e-02],
         [-9.0521e-02,  5.5151e-02],
         [-9.7372e-02,  5.5480e-02],
         [-1.1349e-01,  5.5476e-02],
         [-1.2456e-01,  5.5379e-02],
         [-1.2087e-01,  5.5323e-02],
         [ 3.6291e-02,  5.5253e-02],
         [ 5.3030e-02,  5.5212e-02],
         [ 4.7580e-02,  5.5212e-02],
         [ 7.8132e-02,  5.5197e-02],
         [ 6.7283e-02,  5.5236e-02],
         [ 9.4953e-02,  5.5209e-02],
         [ 1.3439e-01,  5.5210e-02],
         [ 8.0451e-02,  5.5211e-02],
         [ 1.0000e-01,  5.5212e-02],
         [ 1.1350e-01,  5.5223e-02],
         [ 1.2377e-01,  5.5231e-02],
         [ 1.0145e-01,  5.5230e-02],
         [ 6.1367e-02,  5.5230e-02],
         [ 5.9829e-02,  5.5230e-02],
         [ 5.4726e-02,  5.5236e-02],
         [ 5.0307e-02,  5.5235e-02],
         [ 7.3468e-02,  5.5232e-02],
         [ 8.7058e-02,  5.5232e-02],
         [ 4.9281e-02,  5.5231e-02],
         [ 1.7422e-02,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.4233e-05, device='cuda:0') tensor(0.0014, device='cuda:0') tensor(-0.0015, device='cuda:0')
mixer_td_error tensor(0.0591, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4484, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4198, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0261, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1015, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1359, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-245901.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1344, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.1806e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1716, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1640, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1716, device='cuda:0', grad_fn=<MinBackward1>)
t_env 16925
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.8175e-02,  6.0608e-02,  ...,  6.8331e-04,
            1.4616e-01, -1.0000e+07],
          [-1.0000e+07, -1.1502e-01,  1.2954e-01,  ...,  8.8609e-02,
            1.7602e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.0079e-02,  9.4705e-02,  ...,  3.0990e-02,
            1.7060e-01, -1.0000e+07],
          [-1.0000e+07, -9.9149e-02,  1.2542e-01,  ...,  6.7573e-02,
            1.6409e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.5732e-01,  8.6066e-02,  ..., -1.0000e+07,
            1.9592e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6119e-01,  8.8520e-02,  ..., -1.0000e+07,
            2.0066e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.2945e-01,  7.6149e-02,  ...,  3.0170e-02,
            1.8013e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.7755e-02,  7.7509e-02,  ...,  4.1604e-02,
            1.2601e-01, -1.0000e+07],
          [-1.0000e+07, -2.2537e-02,  1.3322e-01,  ..., -6.0230e-03,
            1.4747e-01, -1.0000e+07]],

         [[-1.0000e+07, -4.7720e-02,  5.6971e-02,  ...,  1.4788e-02,
            1.3892e-01, -1.0000e+07],
          [-1.0000e+07, -6.4935e-02,  1.1210e-01,  ...,  9.2430e-03,
            1.8205e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.7442e-01,  4.2732e-02,  ...,  7.6916e-02,
            2.0005e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4601e-01,  3.1929e-02,  ...,  7.3583e-02,
            1.9928e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4322e-01,  7.1877e-02,  ...,  6.6113e-02,
            2.1709e-01, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-0.0593, -0.0489],
         [-0.0682, -0.1150],
         [-0.0901, -0.0991],
         ...,
         [ 0.1959,  0.0552],
         [ 0.2007,  0.0552],
         [-0.1294,  0.0552]],

        [[-0.0483, -0.0068],
         [ 0.0416, -0.0225],
         [-0.0477, -0.0649],
         ...,
         [ 0.0500, -0.1744],
         [ 0.0500, -0.1460],
         [ 0.0500,  0.0661]]], device='cuda:0', grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.0134e-06, device='cuda:0') tensor(0.0002, device='cuda:0') tensor(-0.0002, device='cuda:0')
mixer_td_error tensor(0.0023, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.4782, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4566, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0098, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1022, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1325, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(0.0060, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2251, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3365, device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.3351e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0001, device='cuda:0', grad_fn=<MaxBackward1>) tensor(2.5369e-11, device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(0.2744, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2907, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2744, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2907, device='cuda:0', grad_fn=<MinBackward1>)
t_env 16992
target_mac_out tensor([[[[-1.0000e+07, -6.0082e-02,  8.4218e-02,  ...,  2.3512e-02,
            1.2572e-01, -1.0000e+07],
          [-1.0000e+07, -1.1235e-02,  1.0290e-01,  ...,  6.8675e-03,
            1.2423e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1757e-01,  1.1219e-01,  ...,  5.1484e-02,
            1.5138e-01, -1.0000e+07],
          [-1.0000e+07, -3.5360e-02,  1.2757e-01,  ...,  2.4923e-02,
            1.4726e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3672e-01,  1.2043e-01,  ...,  4.1151e-02,
            1.4412e-01, -1.0000e+07],
          [-1.0000e+07, -6.8604e-02,  1.1442e-01,  ...,  4.9726e-03,
            1.4592e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4114e-01,  8.8582e-02,  ...,  5.3660e-02,
            1.9314e-01, -2.9966e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.2702e-01,  5.0314e-02,  ...,  4.9760e-02,
            1.7671e-01, -2.9878e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.3852e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3613e-01,  1.3267e-01,  ...,  7.3786e-02,
            1.5385e-01, -1.0000e+07],
          [-1.0000e+07, -8.8486e-02,  1.6307e-01,  ...,  7.7780e-02,
            1.4979e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3307e-01,  1.0813e-01,  ...,  6.4733e-02,
            1.5062e-01, -1.0000e+07],
          [-1.0000e+07, -1.0671e-01,  1.6590e-01,  ...,  6.0222e-02,
            1.4802e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-6.0082e-02, -1.1235e-02],
         [ 5.1484e-02, -3.5360e-02],
         [ 4.1151e-02, -6.8604e-02],
         [-1.0076e-01, -8.9002e-02],
         [ 3.1433e-02, -1.0942e-01],
         [ 3.1071e-02, -1.2307e-01],
         [-1.1987e-01, -1.2924e-01],
         [-1.2615e-01, -1.1093e-01],
         [-1.1750e-01, -9.9825e-02],
         [ 3.4835e-02, -9.2790e-02],
         [ 5.9307e-02, -9.3625e-02],
         [ 7.8984e-02, -9.3925e-02],
         [ 8.9824e-02, -9.9920e-02],
         [ 9.9098e-02, -1.0740e-01],
         [ 7.7682e-02, -1.2401e-01],
         [ 9.2215e-02, -1.3971e-01],
         [ 1.4347e-01, -1.4681e-01],
         [ 1.3025e-01, -1.1888e-01],
         [ 1.4184e-01, -7.5005e-02],
         [ 1.3422e-01, -5.9976e-02],
         [ 1.1321e-01, -6.0648e-02],
         [ 9.4199e-02, -6.2677e-02],
         [ 1.1710e-01, -6.4642e-02],
         [ 6.9445e-02, -5.3180e-02],
         [ 1.1013e-01, -5.7028e-02],
         [ 1.1256e-01, -6.0729e-02],
         [ 1.2045e-01, -6.3594e-02],
         [-3.2458e-01, -5.2350e-02],
         [ 1.0453e-01, -3.3730e-02],
         [ 3.6151e-03, -2.4510e-02],
         [ 2.9652e-02, -4.1356e-02],
         [ 4.1969e-02, -5.0604e-02],
         [ 4.7321e-02, -5.5834e-02],
         [ 4.9385e-02, -7.4660e-02],
         [ 5.0091e-02, -7.1295e-02],
         [ 5.0193e-02, -7.2728e-02],
         [ 5.0176e-02, -7.4430e-02],
         [ 5.0090e-02, -7.8337e-02],
         [ 5.0021e-02, -8.9575e-02],
         [ 5.0009e-02, -7.8151e-02],
         [ 5.0002e-02, -9.2173e-02],
         [ 5.0002e-02, -7.9772e-02],
         [ 5.0000e-02, -8.7506e-02],
         [ 4.9995e-02, -9.3839e-02],
         [ 4.9995e-02, -9.9870e-02],
         [ 5.0025e-02, -8.3178e-02],
         [ 5.0014e-02, -4.9898e-02],
         [ 5.0014e-02, -5.1095e-02],
         [ 5.0015e-02, -4.9789e-02],
         [ 5.0016e-02, -6.7869e-02],
         [ 5.0007e-02, -6.7946e-02],
         [ 5.0007e-02, -5.1088e-02],
         [ 5.0007e-02, -6.2779e-02],
         [ 5.0008e-02, -7.5283e-02],
         [ 5.0008e-02, -8.5906e-02],
         [ 5.0008e-02, -7.8216e-02],
         [ 5.0008e-02, -8.6112e-02],
         [ 5.0008e-02, -9.2516e-02],
         [ 5.0008e-02, -9.7173e-02],
         [ 5.0008e-02, -9.7193e-02],
         [ 5.0009e-02, -1.2746e-01],
         [ 5.0009e-02, -1.3291e-01],
         [ 5.0009e-02, -1.4324e-01],
         [ 5.0009e-02, -1.6775e-01],
         [ 5.0009e-02, -1.6230e-01],
         [ 5.0009e-02, -1.4292e-01],
         [ 5.0009e-02, -1.6820e-01],
         [ 5.0009e-02, -1.8497e-01],
         [ 5.0009e-02, -1.6440e-01],
         [ 5.0009e-02, -1.7343e-01],
         [ 5.0009e-02,  6.8579e-02],
         [ 5.0009e-02, -1.7223e-01],
         [ 5.0009e-02, -1.8510e-01],
         [ 5.0009e-02, -1.7095e-01],
         [ 5.0009e-02, -1.5820e-01],
         [ 5.0009e-02, -1.6789e-01],
         [ 5.0009e-02, -1.6172e-01],
         [ 5.0009e-02, -1.4860e-01],
         [ 5.0009e-02, -1.4310e-01],
         [ 5.0009e-02, -1.4114e-01],
         [ 5.0009e-02, -1.2702e-01],
         [ 5.0009e-02,  1.3852e-02]],

        [[ 6.2561e-02, -5.4216e-02],
         [ 7.3786e-02, -8.8486e-02],
         [ 6.4733e-02, -1.0671e-01],
         [ 7.8684e-02, -1.2107e-01],
         [ 9.1547e-02, -1.2823e-01],
         [ 6.6406e-02, -1.4649e-01],
         [ 8.5892e-02, -1.4675e-01],
         [ 6.7677e-02, -1.6103e-01],
         [ 8.6553e-02, -1.5755e-01],
         [ 1.0356e-01, -1.6629e-01],
         [ 5.6632e-02, -1.7888e-01],
         [ 6.3137e-02, -1.5881e-01],
         [ 1.2327e-01, -1.7054e-01],
         [ 1.4403e-01, -1.6913e-01],
         [ 1.3339e-01, -1.7128e-01],
         [ 1.4150e-01, -1.6777e-01],
         [ 7.3470e-02, -1.6583e-01],
         [ 1.7261e-01, -1.6997e-01],
         [ 7.0235e-02, -1.4589e-01],
         [ 5.5418e-02, -1.5737e-01],
         [ 4.5478e-02, -1.6299e-01],
         [-1.5210e-02, -1.4154e-01],
         [ 1.8146e-02, -1.3877e-01],
         [ 3.5536e-02, -1.3740e-01],
         [ 4.4106e-02, -1.3811e-01],
         [ 4.8071e-02, -1.5163e-01],
         [ 4.9742e-02, -1.4670e-01],
         [ 5.0330e-02, -1.3897e-01],
         [ 5.0431e-02, -1.5752e-01],
         [ 5.0371e-02, -1.7108e-01],
         [ 5.0272e-02, -1.7518e-01],
         [ 5.0214e-02,  2.4987e-01],
         [ 5.0148e-02,  2.4508e-01],
         [ 5.0102e-02,  8.0945e-02],
         [ 5.0072e-02, -1.8938e-01],
         [ 5.0047e-02,  1.0981e-01],
         [ 5.0015e-02, -1.5378e-01],
         [ 5.0028e-02, -2.9592e-01],
         [ 5.0017e-02, -2.9617e-01],
         [ 5.0012e-02, -4.3697e-02],
         [ 5.0015e-02, -2.8039e-01],
         [ 5.0006e-02, -1.4735e-01],
         [ 5.0007e-02, -1.4462e-01],
         [ 5.0007e-02, -1.4898e-01],
         [ 5.0007e-02,  1.4816e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.6758e-06, device='cuda:0') tensor(0.0009, device='cuda:0') tensor(-0.0021, device='cuda:0')
mixer_td_error tensor(0.5558, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4484, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6396, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0065, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0902, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1229, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2256097.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2499, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.9931e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3443, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2492, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3443, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17056
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.4725e-02,  7.3826e-02,  ..., -9.5147e-03,
            1.3830e-01, -1.0000e+07],
          [-1.0000e+07, -7.1175e-02,  1.6464e-01,  ...,  4.4025e-02,
            1.4698e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3461e-02,  8.0768e-02,  ..., -2.7243e-03,
            1.4735e-01, -1.0000e+07],
          [-1.0000e+07, -6.1149e-02,  1.2258e-01,  ...,  2.5322e-02,
            1.5353e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0027e-01,  8.7508e-02,  ...,  1.6592e-02,
            1.4820e-01, -1.0000e+07],
          [-1.0000e+07, -3.2708e-02,  1.3921e-01,  ..., -3.3578e-03,
            1.4695e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2632e-01,  1.0870e-01,  ...,  6.6274e-02,
            1.6961e-01, -1.0000e+07],
          [-1.0000e+07, -5.3215e-02,  6.7365e-02,  ...,  1.8223e-02,
            1.6311e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5986e-01,  3.4481e-02,  ...,  6.1996e-02,
            1.9639e-01, -3.1123e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4472e-01,  3.5980e-02,  ...,  3.7583e-02,
            1.9018e-01, -3.0634e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 1.6392e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[-5.9256e-02, -4.8886e-02],
         [-7.4725e-02, -7.1175e-02],
         [-8.3461e-02, -6.1149e-02],
         [ 9.2700e-02, -5.2159e-02],
         [ 1.0345e-01, -6.0352e-02],
         [-1.3225e-01, -6.5661e-02],
         [ 1.0902e-01, -5.7941e-02],
         [ 4.7493e-02, -6.7401e-02],
         [ 4.3964e-02, -6.3240e-02],
         [ 1.1846e-01, -5.4766e-02],
         [ 6.9553e-02, -4.2412e-02],
         [ 6.1497e-02, -2.8899e-02],
         [ 1.1352e-01, -3.8615e-02],
         [ 1.3282e-01, -5.4143e-02],
         [ 9.1764e-02, -5.4675e-02],
         [ 4.5791e-02, -5.5527e-02],
         [ 5.1822e-02, -6.4569e-02],
         [ 3.0963e-02, -7.8266e-02],
         [ 6.3666e-02, -8.7360e-02],
         [ 1.6441e-01, -9.0368e-02],
         [ 1.3668e-01, -8.8054e-02],
         [ 1.8324e-01, -1.2238e-01],
         [ 2.0316e-01, -1.4310e-01],
         [ 1.8622e-01, -1.3943e-01],
         [ 9.0166e-02, -1.4556e-01],
         [ 7.0744e-02, -1.6281e-01],
         [ 6.1150e-02, -1.6457e-01],
         [ 5.5932e-02, -1.9997e-01],
         [ 1.1006e-01, -2.1554e-01],
         [ 5.6523e-02, -1.9753e-01],
         [ 1.4423e-01, -1.8573e-01],
         [ 1.7695e-01, -1.7044e-01],
         [ 1.6176e-01, -1.5788e-01],
         [ 3.6935e-02, -1.5100e-01],
         [ 1.5369e-01, -1.5342e-01],
         [ 1.5921e-02, -1.4664e-01],
         [ 3.2868e-02, -1.4572e-01],
         [ 4.3130e-02, -1.4496e-01],
         [ 4.8107e-02, -1.5244e-01],
         [ 5.0149e-02, -1.4855e-01],
         [ 5.0761e-02, -1.4298e-01],
         [ 5.0763e-02,  3.0605e-02],
         [ 5.0591e-02, -1.1181e-01],
         [ 5.0435e-02, -9.8561e-02],
         [ 5.0262e-02, -6.6831e-02],
         [ 5.0157e-02, -7.3476e-02],
         [ 5.0111e-02, -5.3675e-02],
         [ 5.0069e-02, -4.6106e-02],
         [ 5.0051e-02, -6.8094e-02],
         [ 5.0043e-02, -9.2832e-02],
         [ 5.0026e-02, -6.9352e-02],
         [ 5.0009e-02,  3.4693e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 6.1307e-02, -1.1117e-02],
         [-1.0027e-01, -3.2708e-02],
         [-1.2632e-01, -5.3215e-02],
         [-1.2459e-01, -7.4620e-02],
         [ 4.5310e-02, -5.8022e-02],
         [ 8.6641e-02, -3.7118e-02],
         [-1.1579e-01, -1.4494e-02],
         [-1.0707e-01, -1.3406e-02],
         [ 6.5551e-02, -6.8513e-04],
         [ 1.3879e-01, -1.7428e-02],
         [ 1.2241e-01, -2.7562e-02],
         [ 1.4056e-01, -3.3688e-02],
         [ 1.3664e-01, -2.4599e-02],
         [ 1.0328e-01, -2.9416e-02],
         [ 1.2316e-01, -1.1423e-02],
         [ 1.0840e-01, -4.0932e-02],
         [ 1.0077e-01, -5.9023e-02],
         [ 1.2692e-01, -7.1964e-02],
         [ 9.0400e-02, -6.7042e-02],
         [ 1.3365e-01, -5.7375e-02],
         [ 3.9513e-02, -7.5817e-02],
         [ 1.1883e-01, -6.6276e-02],
         [ 1.1402e-01, -8.2498e-02],
         [ 1.1104e-01, -7.2429e-02],
         [ 1.1588e-01, -8.4135e-02],
         [-1.8897e-02, -8.7850e-02],
         [ 1.8561e-02, -5.9249e-02],
         [ 3.6768e-02, -5.8306e-02],
         [ 4.5229e-02, -3.6783e-02],
         [ 4.8837e-02, -3.0812e-02],
         [ 5.0221e-02, -3.0102e-02],
         [ 5.0555e-02, -3.4016e-02],
         [ 5.0527e-02, -5.4318e-02],
         [ 5.0399e-02, -4.8614e-02],
         [ 5.0284e-02, -6.5049e-02],
         [ 5.0193e-02, -4.9002e-02],
         [ 5.0101e-02, -5.6941e-02],
         [ 5.0049e-02, -6.7333e-02],
         [ 5.0037e-02, -7.4436e-02],
         [ 5.0020e-02, -6.1953e-02],
         [ 5.0022e-02, -7.5035e-02],
         [ 5.0022e-02, -5.8295e-02],
         [ 5.0014e-02, -3.6121e-02],
         [ 5.0015e-02, -4.3320e-02],
         [ 5.0014e-02, -5.2644e-02],
         [ 5.0012e-02, -6.4957e-02],
         [ 5.0007e-02, -6.8843e-02],
         [ 5.0008e-02, -9.9132e-02],
         [ 5.0007e-02, -8.2457e-02],
         [ 5.0007e-02, -1.3505e-01],
         [ 5.0008e-02, -1.6584e-01],
         [ 5.0008e-02, -1.8246e-01],
         [ 5.0008e-02, -1.9900e-01],
         [ 5.0008e-02, -1.8328e-01],
         [ 5.0008e-02, -1.7622e-01],
         [ 5.0008e-02, -1.8580e-01],
         [ 5.0008e-02, -2.0134e-01],
         [ 5.0009e-02, -1.9984e-01],
         [ 5.0009e-02, -2.1471e-01],
         [ 5.0009e-02, -2.0207e-01],
         [ 5.0009e-02, -3.3989e-01],
         [ 5.0009e-02, -2.1643e-01],
         [ 5.0009e-02, -3.4335e-01],
         [ 5.0009e-02, -3.3163e-01],
         [ 5.0009e-02, -3.2825e-01],
         [ 5.0009e-02,  2.3484e-01],
         [ 5.0009e-02,  2.3829e-01],
         [ 5.0009e-02,  2.2411e-01],
         [ 5.0009e-02, -1.8407e-01],
         [ 5.0009e-02, -1.5986e-01],
         [ 5.0009e-02, -1.4472e-01],
         [ 5.0009e-02,  1.6392e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.1301e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0020, device='cuda:0')
mixer_td_error tensor(0.3197, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4495, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6919, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(-0.0076, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0990, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1308, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1388888.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2383, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.4710e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0014, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3235, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.2788, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3235, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17116
target_mac_out tensor([[[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.6739e-02,  1.0895e-01,  ...,  2.1326e-02,
            1.6105e-01, -1.0000e+07],
          [-1.0000e+07, -2.8247e-02,  1.0240e-01,  ..., -3.0290e-02,
            1.3408e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.4101e-02,  9.1158e-02,  ..., -5.5751e-03,
            1.5495e-01, -1.0000e+07],
          [-1.0000e+07, -3.8868e-02,  1.3156e-01,  ..., -2.3385e-02,
            1.5056e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.8576e-01,  7.9568e-02,  ...,  6.1343e-02,
            1.7430e-01, -3.1649e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7557e-01,  1.0202e-01,  ...,  5.6711e-02,
            1.7393e-01, -3.0989e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-9.3098e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2685e-01,  1.2531e-01,  ...,  5.6976e-02,
            1.5537e-01, -1.0000e+07],
          [-1.0000e+07, -4.3705e-02,  1.3064e-01,  ...,  2.3492e-02,
            1.4040e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.5463e-01,  1.3585e-01,  ...,  7.0689e-02,
            1.6255e-01, -1.0000e+07],
          [-1.0000e+07, -8.5135e-02,  1.5617e-01,  ...,  5.3103e-02,
            1.5209e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.4778e-02, -8.8067e-03],
         [ 1.0895e-01, -2.8247e-02],
         [ 9.1158e-02, -3.8868e-02],
         [ 9.0562e-02, -3.5693e-02],
         [-8.3465e-02, -4.7100e-02],
         [ 7.9762e-02, -5.8125e-02],
         [ 9.2470e-02, -8.1886e-02],
         [ 9.0990e-02, -1.0053e-01],
         [ 1.2401e-01, -1.0832e-01],
         [ 1.2021e-01, -3.2186e-01],
         [ 1.3265e-01, -3.2016e-01],
         [ 7.9243e-02, -1.6293e-01],
         [ 9.7937e-02, -3.3054e-01],
         [ 1.2173e-01, -3.2220e-01],
         [ 1.3270e-01, -3.2216e-01],
         [ 5.5728e-02, -3.1759e-01],
         [ 1.2351e-01, -3.3440e-01],
         [ 1.3099e-01,  1.3476e-01],
         [ 6.5619e-02,  1.4807e-01],
         [ 7.0533e-02,  8.5760e-02],
         [-7.7505e-02,  8.5494e-02],
         [-6.0633e-02,  1.0496e-01],
         [-4.1742e-02,  8.7471e-02],
         [-6.4108e-02,  1.0421e-01],
         [-8.5326e-02,  1.0991e-01],
         [-9.3713e-02, -3.3190e-01],
         [-1.0386e-01, -3.1819e-01],
         [-9.7086e-02, -7.5037e-03],
         [-1.0899e-01,  2.9282e-02],
         [-9.7198e-02,  4.5612e-02],
         [-1.3380e-01,  5.2416e-02],
         [-1.0252e-01,  5.4929e-02],
         [-1.3779e-01,  5.5725e-02],
         [ 1.2333e-01,  5.5815e-02],
         [-1.2219e-01,  5.5679e-02],
         [-9.1249e-02,  5.5502e-02],
         [-1.0333e-01,  5.5372e-02],
         [-1.1232e-01,  5.5285e-02],
         [-9.9859e-02,  5.5264e-02],
         [-1.0199e-01,  5.5225e-02],
         [-9.0518e-02,  5.5217e-02],
         [-1.2205e-01,  5.5225e-02],
         [ 1.2026e-01,  5.5206e-02],
         [ 1.2277e-01,  5.5205e-02],
         [ 1.3047e-01,  5.5210e-02],
         [ 9.1061e-02,  5.5217e-02],
         [ 1.0766e-01,  5.5223e-02],
         [ 8.1962e-02,  5.5230e-02],
         [ 1.4901e-01,  5.5229e-02],
         [ 1.5744e-01,  5.5230e-02],
         [ 1.5928e-01,  5.5230e-02],
         [ 1.6021e-01,  5.5232e-02],
         [ 1.1180e-01,  5.5236e-02],
         [ 1.2821e-01,  5.5236e-02],
         [ 1.1147e-01,  5.5232e-02],
         [ 1.3214e-01,  5.5232e-02],
         [ 1.2624e-01,  5.5231e-02],
         [ 1.3281e-01,  5.5231e-02],
         [ 1.0754e-01,  5.5231e-02],
         [ 1.1915e-01,  5.5231e-02],
         [ 1.1789e-01,  5.5231e-02],
         [ 6.1343e-02,  5.5231e-02],
         [ 5.6711e-02,  5.5231e-02],
         [-9.3098e-03,  5.5231e-02]],

        [[ 9.7167e-02, -5.1416e-02],
         [ 5.6976e-02, -4.3705e-02],
         [ 1.3585e-01, -8.5135e-02],
         [ 1.4580e-01, -1.2032e-01],
         [ 1.3632e-01, -1.2978e-01],
         [ 1.3662e-01, -1.2868e-01],
         [ 1.3661e-01, -1.4927e-01],
         [ 1.4130e-01, -1.6802e-01],
         [ 1.1799e-01, -1.5882e-01],
         [ 1.2761e-01, -1.6008e-01],
         [ 1.1282e-01, -1.4677e-01],
         [ 1.3685e-01, -1.4285e-01],
         [ 1.3286e-01, -1.3181e-01],
         [ 1.1488e-01, -1.2986e-01],
         [ 7.0884e-02, -1.2534e-01],
         [ 1.0235e-01, -1.2037e-01],
         [ 6.8427e-02, -1.1427e-01],
         [ 6.4927e-02, -1.5022e-01],
         [ 9.6804e-02, -1.6858e-01],
         [ 1.4285e-01, -1.4788e-01],
         [ 1.6648e-01, -3.3292e-01],
         [ 1.6023e-01, -3.2197e-01],
         [ 1.5217e-01, -3.2779e-01],
         [ 1.5230e-01, -3.2804e-01],
         [ 1.6182e-01, -3.2724e-01],
         [ 1.5781e-01, -3.2375e-01],
         [ 1.6353e-01,  8.3092e-02],
         [ 1.6279e-01, -1.5445e-01],
         [ 1.5599e-01, -1.5099e-01],
         [ 1.6104e-01, -1.6590e-01],
         [ 1.5923e-01, -1.4195e-01],
         [ 1.6002e-01, -1.2644e-01],
         [ 1.2029e-01, -1.2798e-01],
         [ 1.2252e-01, -1.1272e-01],
         [ 6.9638e-02, -1.3308e-02],
         [ 1.2708e-01,  2.1902e-02],
         [ 1.1035e-01,  4.0348e-02],
         [ 8.7062e-02,  4.9158e-02],
         [ 7.6388e-02,  5.3070e-02],
         [ 1.0741e-01,  5.4615e-02],
         [ 9.7949e-02,  5.5193e-02],
         [ 7.8689e-02,  5.5320e-02],
         [ 1.0795e-01,  5.5331e-02],
         [ 6.2341e-02,  5.5302e-02],
         [ 5.7675e-02,  5.5270e-02],
         [ 1.5999e-04,  5.5242e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.5465e-06, device='cuda:0') tensor(0.0024, device='cuda:0') tensor(-0.0019, device='cuda:0')
mixer_td_error tensor(0.3418, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4719, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8723, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0039, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1017, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1109, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1406249.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1665, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0017, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1988, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2914, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1988, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17167
target_mac_out tensor([[[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1573e-01,  1.1465e-01,  ...,  4.6260e-02,
            1.3400e-01, -1.0000e+07],
          [-1.0000e+07, -8.4494e-02,  1.5393e-01,  ...,  5.1304e-02,
            1.4180e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.5712e-01,  1.2888e-01,  ...,  6.5788e-02,
            1.5922e-01, -1.0000e+07],
          [-1.0000e+07, -1.1309e-01,  1.6298e-01,  ...,  4.4973e-02,
            1.3720e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.0695e-02,  8.8884e-02,  ...,  1.4652e-02,
            1.4204e-01, -1.0000e+07],
          [-1.0000e+07, -3.4872e-02,  9.9288e-02,  ..., -3.2764e-02,
            1.3673e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3586e-01,  4.0597e-02,  ...,  4.7742e-02,
            1.9922e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1941e-01,  1.6392e-02,  ...,  4.5058e-02,
            1.8264e-01, -1.0000e+07]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.1394e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1386e-01, -5.4216e-02],
         [ 1.1465e-01,  5.1304e-02],
         [ 1.2888e-01, -9.0765e-02],
         [ 1.1473e-01, -8.5946e-02],
         [ 1.2231e-01, -7.9441e-02],
         [ 1.2611e-01, -8.4590e-02],
         [ 1.3756e-01, -8.8421e-02],
         [ 1.4789e-01,  7.6840e-02],
         [ 1.5483e-01,  7.2652e-02],
         [ 1.6171e-01,  3.4011e-02],
         [ 4.3494e-02,  6.9615e-02],
         [ 1.3735e-01,  6.4674e-02],
         [ 1.0524e-01, -5.8368e-02],
         [ 1.8221e-01,  5.6095e-02],
         [ 1.4552e-01,  7.2371e-02],
         [ 1.7993e-02,  5.1794e-02],
         [ 1.5517e-01,  1.2622e-01],
         [ 1.6271e-01,  1.2965e-01],
         [ 1.6643e-01,  1.3116e-01],
         [ 1.6984e-01,  5.5952e-02],
         [ 1.5822e-01,  4.4044e-02],
         [ 1.7152e-01,  6.6635e-02],
         [ 1.3993e-01,  4.9378e-02],
         [ 1.5759e-01,  6.4070e-02],
         [ 1.6715e-01,  4.4483e-02],
         [ 1.6860e-01,  3.3441e-02],
         [ 1.5307e-01,  2.8628e-02],
         [ 1.6926e-01,  3.5629e-03],
         [ 1.7331e-01,  4.3182e-02],
         [ 1.7444e-01,  3.5138e-02],
         [ 1.7447e-01,  1.2047e-01],
         [ 1.5910e-01,  9.1222e-02],
         [ 1.4687e-01,  1.0737e-01],
         [ 1.8681e-01,  1.1469e-01],
         [ 1.5385e-01,  9.2935e-02],
         [ 2.0388e-02, -7.6202e-02],
         [ 2.9173e-02, -6.9827e-02],
         [ 1.4597e-01, -6.5975e-02],
         [ 1.5583e-01,  6.6273e-02],
         [ 1.1195e-01,  9.4350e-02],
         [ 1.5459e-01, -5.9198e-02],
         [ 1.5414e-01, -7.0085e-02],
         [ 1.5131e-01, -5.8003e-02],
         [ 1.4536e-01, -6.4425e-02],
         [ 1.2951e-01, -6.1972e-02],
         [ 1.4180e-01, -5.8307e-02],
         [ 1.4379e-01, -6.1238e-02],
         [ 1.5147e-01, -7.5256e-02],
         [ 1.5647e-01, -8.6445e-02],
         [ 1.5623e-01,  6.0520e-02],
         [ 1.5792e-01,  7.3873e-02],
         [ 2.7078e-02,  5.1883e-02],
         [ 1.3204e-01,  6.6268e-02],
         [ 1.4425e-01, -7.4734e-02],
         [ 1.5058e-01, -6.8487e-02],
         [ 1.3831e-01,  1.0190e-01],
         [ 1.7953e-01,  7.1324e-02],
         [ 1.4337e-01,  5.5319e-02],
         [ 1.7529e-01,  8.9378e-02],
         [ 1.5379e-01,  4.4477e-02],
         [-1.4512e-01,  9.4938e-02],
         [ 1.7759e-01,  1.1045e-01],
         [ 1.8839e-01,  8.7125e-02],
         [ 1.7035e-01,  1.1218e-01],
         [ 1.9823e-01,  1.2036e-01],
         [ 2.0912e-01,  9.5386e-02],
         [ 2.0983e-01,  1.1275e-01],
         [ 1.6743e-01,  1.2275e-01],
         [ 2.1144e-01,  5.5756e-02],
         [-1.7652e-01,  7.3761e-02],
         [-1.7096e-01, -1.2425e-01],
         [-1.7592e-01, -1.1212e-01],
         [ 1.5901e-01, -1.0911e-01],
         [ 1.6397e-01,  1.2286e-01],
         [-8.8931e-03, -1.6574e-01],
         [ 1.8226e-02, -1.7290e-01],
         [ 3.4727e-02, -1.5832e-01],
         [ 4.3385e-02, -1.5662e-01],
         [ 4.7496e-02,  6.9333e-02],
         [ 4.9258e-02,  8.0703e-02],
         [ 4.9944e-02,  1.0762e-01],
         [ 5.0146e-02,  1.0697e-01],
         [ 5.0176e-02,  2.1690e-01],
         [ 5.0147e-02,  6.3753e-02],
         [ 5.0104e-02,  5.3180e-02],
         [ 5.0068e-02,  2.4349e-01],
         [ 5.0059e-02,  2.4443e-01],
         [ 5.0023e-02, -2.1914e-01],
         [ 5.0034e-02,  9.4831e-02],
         [ 5.0038e-02,  2.4687e-01],
         [ 5.0017e-02,  2.5539e-01],
         [ 5.0045e-02,  2.2698e-01],
         [ 5.0032e-02,  2.1221e-01],
         [ 5.0006e-02, -1.7017e-01],
         [ 5.0010e-02, -1.5259e-01],
         [ 5.0019e-02, -5.3188e-02],
         [ 5.0005e-02, -6.5526e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.6186e-02, -1.3772e-02],
         [ 2.5948e-02, -1.4399e-02],
         [ 8.8884e-02, -7.5292e-02],
         [ 9.1497e-02, -6.8217e-02],
         [ 1.1814e-01, -7.7068e-02],
         [ 3.7528e-02, -7.0575e-02],
         [ 1.0986e-01, -6.4571e-02],
         [ 1.2487e-01, -7.5042e-02],
         [ 1.1758e-01, -7.0105e-02],
         [ 1.5183e-01, -8.0087e-02],
         [ 1.7336e-01,  1.5541e-01],
         [ 1.8323e-01,  1.4444e-01],
         [ 1.5019e-01, -8.6600e-02],
         [ 1.6608e-01, -9.0638e-02],
         [ 1.4368e-01, -8.2052e-02],
         [ 1.3013e-01, -8.6430e-02],
         [ 1.5058e-01,  2.1292e-02],
         [ 1.7461e-01,  3.9413e-02],
         [ 1.8083e-01,  4.3223e-02],
         [ 1.3143e-01,  2.9673e-02],
         [ 1.4003e-01,  2.0623e-02],
         [ 1.6183e-01,  1.5992e-01],
         [ 1.1678e-01,  6.9771e-03],
         [ 1.3169e-01,  1.2089e-01],
         [ 1.5533e-01,  1.4156e-01],
         [ 1.6582e-01,  1.5210e-01],
         [ 1.8747e-01,  1.3380e-01],
         [-4.8678e-02,  2.6766e-03],
         [ 1.9964e-01,  1.6613e-01],
         [ 1.5332e-01, -5.1397e-02],
         [ 1.0850e-01, -4.7618e-02],
         [ 1.1844e-01, -4.9616e-02],
         [ 1.2093e-01,  7.1316e-02],
         [ 1.1190e-01,  8.2845e-02],
         [ 1.5083e-01,  1.2766e-01],
         [ 1.5953e-01,  1.1280e-01],
         [ 1.6312e-01,  1.3203e-01],
         [ 1.5568e-01, -8.7847e-02],
         [ 1.5366e-01, -6.6765e-02],
         [ 1.1933e-01, -7.8308e-02],
         [ 1.2067e-01, -6.1851e-02],
         [ 1.2170e-01, -7.1838e-02],
         [ 1.2081e-01, -6.7306e-02],
         [ 1.2439e-01,  3.4172e-02],
         [ 1.0154e-01, -5.8890e-02],
         [ 7.2165e-02,  4.6825e-02],
         [ 5.1810e-02,  5.3674e-02],
         [-6.7529e-03,  1.7694e-01],
         [ 2.1785e-02,  1.7336e-01],
         [ 3.6720e-02, -3.5356e-03],
         [ 4.4121e-02,  1.7518e-01],
         [ 4.7585e-02,  1.7146e-01],
         [ 4.9116e-02,  1.6976e-01],
         [ 4.9755e-02,  1.0193e-03],
         [ 4.9969e-02, -3.3511e-02],
         [ 5.0025e-02, -4.2697e-02],
         [ 5.0041e-02,  1.9751e-01],
         [ 5.0028e-02,  1.9479e-01],
         [ 5.0030e-02, -1.4365e-02],
         [ 5.0032e-02, -2.7605e-03],
         [ 5.0026e-02,  1.7534e-01],
         [ 5.0025e-02,  3.7915e-03],
         [ 5.0002e-02,  7.3887e-03],
         [ 5.0023e-02,  7.5001e-03],
         [ 5.0015e-02, -3.1327e-02],
         [ 5.0015e-02, -5.4273e-02],
         [ 5.0017e-02, -8.4716e-02],
         [ 5.0010e-02, -1.0978e-01],
         [ 5.0006e-02,  8.8559e-02],
         [ 5.0007e-02,  7.9211e-02],
         [ 5.0007e-02,  6.2226e-02],
         [ 5.0008e-02,  5.5094e-02],
         [ 5.0008e-02,  5.7482e-02],
         [ 5.0008e-02,  4.5009e-02],
         [ 5.0009e-02,  2.0327e-01],
         [ 5.0008e-02,  3.2277e-02],
         [ 5.0008e-02,  6.2999e-02],
         [ 5.0008e-02,  2.0246e-01],
         [ 5.0008e-02,  7.9627e-02],
         [ 5.0009e-02,  4.2705e-02],
         [ 5.0009e-02,  4.2306e-02],
         [ 5.0009e-02,  5.5415e-02],
         [ 5.0009e-02, -3.3128e-02],
         [ 5.0009e-02, -6.3181e-02],
         [ 5.0009e-02,  4.6919e-02],
         [ 5.0009e-02, -5.5682e-02],
         [ 5.0009e-02,  1.2971e-01],
         [ 5.0009e-02,  1.4388e-01],
         [ 5.0009e-02,  2.1024e-01],
         [ 5.0009e-02,  2.1535e-01],
         [ 5.0009e-02, -7.1446e-02],
         [ 5.0009e-02,  1.2746e-01],
         [ 5.0009e-02,  2.0975e-01],
         [ 5.0009e-02, -3.4269e-02],
         [ 5.0009e-02, -6.5660e-02],
         [ 5.0009e-02,  4.5778e-02],
         [ 5.0009e-02,  2.0626e-01],
         [ 5.0009e-02,  2.0324e-01],
         [ 5.0009e-02,  2.1591e-01],
         [ 5.0009e-02,  2.1595e-01],
         [ 5.0009e-02, -7.4546e-02],
         [ 5.0009e-02,  1.2950e-01],
         [ 5.0009e-02,  1.4499e-01],
         [ 5.0009e-02,  1.5198e-01],
         [ 5.0009e-02, -8.3293e-02],
         [ 5.0009e-02, -3.9633e-02],
         [ 5.0009e-02,  1.5428e-01],
         [ 5.0009e-02, -1.5543e-02],
         [ 5.0009e-02, -1.2618e-02],
         [ 5.0009e-02,  3.3931e-03],
         [ 5.0009e-02, -6.3612e-03],
         [ 5.0009e-02, -2.0794e-02],
         [ 5.0009e-02, -2.6692e-02],
         [ 5.0009e-02, -9.8019e-03],
         [ 5.0009e-02, -1.7422e-02],
         [ 5.0009e-02, -2.8153e-02],
         [ 5.0009e-02, -4.3286e-02],
         [ 5.0009e-02, -8.0738e-02],
         [ 5.0009e-02,  1.9417e-01],
         [ 5.0009e-02,  4.0725e-02],
         [ 5.0009e-02,  3.1772e-02],
         [ 5.0009e-02,  2.0740e-02],
         [ 5.0009e-02,  1.7053e-01],
         [ 5.0009e-02,  1.7558e-01],
         [ 5.0009e-02,  1.1272e-02],
         [ 5.0009e-02,  9.4636e-03],
         [ 5.0009e-02,  1.2656e-02],
         [ 5.0009e-02, -9.9668e-03],
         [ 5.0009e-02,  1.6724e-01],
         [ 5.0009e-02,  1.7294e-01],
         [ 5.0009e-02, -6.1543e-03],
         [ 5.0009e-02,  1.6682e-01],
         [ 5.0009e-02,  2.5393e-03],
         [ 5.0009e-02,  6.7060e-03],
         [ 5.0009e-02,  8.4499e-03],
         [ 5.0009e-02,  1.6318e-01],
         [ 5.0009e-02,  7.4983e-03],
         [ 5.0009e-02,  1.6993e-01],
         [ 5.0009e-02, -4.1027e-02],
         [ 5.0009e-02,  3.1139e-02],
         [ 5.0009e-02,  2.0434e-01],
         [ 5.0009e-02,  4.3724e-02],
         [ 5.0009e-02,  1.7738e-01],
         [ 5.0009e-02,  1.4213e-02],
         [ 5.0009e-02,  1.7444e-01],
         [ 5.0009e-02,  1.7816e-01],
         [ 5.0009e-02,  1.3661e-02],
         [ 5.0009e-02,  1.8512e-02],
         [ 5.0009e-02, -5.5701e-02],
         [ 5.0009e-02,  4.2556e-02],
         [ 5.0009e-02,  5.1089e-02],
         [ 5.0009e-02, -3.0790e-02],
         [ 5.0009e-02,  1.6584e-02],
         [ 5.0009e-02, -1.2692e-02],
         [ 5.0009e-02, -4.1902e-02],
         [ 5.0009e-02,  5.1127e-02],
         [ 5.0009e-02,  3.7338e-02],
         [ 5.0009e-02, -2.0897e-02],
         [ 5.0009e-02,  1.1526e-02],
         [ 5.0009e-02,  1.7218e-01],
         [ 5.0009e-02,  3.9627e-03],
         [ 5.0009e-02,  1.2633e-02],
         [ 5.0009e-02,  1.7803e-02],
         [ 5.0009e-02, -4.2529e-03],
         [ 5.0009e-02, -1.7457e-02],
         [ 5.0009e-02,  1.9800e-03],
         [ 5.0009e-02, -1.6050e-02],
         [ 5.0009e-02,  1.9465e-01],
         [ 5.0009e-02,  2.0232e-01],
         [ 5.0009e-02,  3.1295e-02],
         [ 5.0009e-02, -1.3798e-02],
         [ 5.0009e-02,  1.4091e-01],
         [ 5.0009e-02, -5.6068e-03],
         [ 5.0009e-02, -1.8152e-02],
         [ 5.0009e-02, -3.5386e-02],
         [ 5.0009e-02, -6.4978e-02],
         [ 5.0009e-02, -7.5696e-02],
         [ 5.0009e-02, -6.7391e-02],
         [ 5.0009e-02, -2.5406e-02],
         [ 5.0009e-02, -6.0106e-02],
         [ 5.0009e-02,  1.2638e-01],
         [ 5.0009e-02, -2.7098e-02],
         [ 5.0009e-02, -2.8141e-02],
         [ 5.0009e-02, -8.0687e-03],
         [ 5.0009e-02,  6.1416e-03],
         [ 5.0009e-02, -1.1549e-02],
         [ 5.0009e-02, -2.0182e-02],
         [ 5.0009e-02, -3.7727e-02],
         [ 5.0009e-02,  2.0340e-01],
         [ 5.0009e-02,  2.1384e-01],
         [ 5.0009e-02, -1.1685e-01],
         [ 5.0009e-02,  5.8875e-02],
         [ 5.0009e-02,  1.1388e-01],
         [ 5.0009e-02,  4.2634e-02],
         [ 5.0009e-02, -9.1819e-02],
         [ 5.0009e-02,  5.4090e-02],
         [ 5.0009e-02,  7.0247e-02],
         [ 5.0009e-02, -5.0242e-02],
         [ 5.0009e-02,  1.2139e-01],
         [ 5.0009e-02,  2.0411e-01],
         [ 5.0009e-02,  2.0884e-01],
         [ 5.0009e-02,  6.8613e-02],
         [ 5.0009e-02,  2.0721e-01],
         [ 5.0009e-02,  2.0946e-01],
         [ 5.0009e-02,  7.7576e-02],
         [ 5.0009e-02,  5.0551e-02],
         [ 5.0009e-02,  4.4813e-02],
         [ 5.0009e-02,  4.7885e-02],
         [ 5.0009e-02,  4.9932e-02],
         [ 5.0009e-02,  3.1168e-02],
         [ 5.0009e-02,  2.1819e-01],
         [ 5.0009e-02,  3.9224e-02],
         [ 5.0009e-02,  2.2175e-01],
         [ 5.0009e-02,  2.1719e-01],
         [ 5.0009e-02,  6.2421e-02],
         [ 5.0009e-02,  3.5235e-02],
         [ 5.0009e-02,  3.8207e-02],
         [ 5.0009e-02,  3.4894e-02],
         [ 5.0009e-02,  7.1387e-02],
         [ 5.0009e-02,  6.7753e-02],
         [ 5.0009e-02,  8.7918e-02],
         [ 5.0009e-02,  4.7742e-02],
         [ 5.0009e-02,  4.5058e-02],
         [ 5.0009e-02,  5.1394e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.0807e-05, device='cuda:0') tensor(0.0003, device='cuda:0') tensor(-0.0007, device='cuda:0')
mixer_td_error tensor(0.6587, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4527, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6284, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0177, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0797, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1084, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2834821.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2554, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.0353e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3217, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1710, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3217, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17234
target_mac_out tensor([[[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7175e-02,  8.1043e-02,  ...,  2.3772e-02,
            1.2601e-01, -1.0000e+07],
          [-1.0000e+07, -3.0851e-02,  1.2640e-01,  ...,  1.8911e-02,
            1.4901e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.3968e-02,  1.0288e-01,  ...,  4.2058e-02,
            1.5994e-01, -1.0000e+07],
          [-1.0000e+07, -2.7312e-02,  1.2249e-01,  ..., -4.1138e-03,
            1.4328e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.4255e-02,  8.7945e-02,  ...,  2.1998e-02,
            1.2409e-01, -1.0000e+07],
          [-1.0000e+07, -2.5887e-02,  1.2012e-01,  ...,  1.5133e-02,
            1.3440e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.6146e-02,  1.0400e-01,  ...,  1.4496e-02,
            1.5501e-01, -1.0000e+07],
          [-1.0000e+07, -3.0432e-02,  1.0090e-01,  ...,  1.3464e-02,
            1.4478e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.8188e-02,  1.1303e-01,  ...,  9.0906e-03,
            1.6877e-01, -1.0000e+07],
          [-1.0000e+07, -2.5036e-02,  1.0531e-01,  ...,  2.4155e-02,
            1.4166e-01, -1.0000e+07]],

         ...,

         [[ 3.8200e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.4484e-01,  2.2206e-02,  ...,  4.2660e-02,
            1.8271e-01, -3.1262e-01]],

         [[ 4.4540e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.5804e-01,  5.4212e-02,  ...,  7.2130e-02,
            2.0927e-01, -3.2281e-01]],

         [[ 4.7823e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.5829e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 3.4876e-02, -6.8065e-03],
         [ 8.1043e-02, -3.0851e-02],
         [ 1.0288e-01, -2.7312e-02],
         [ 1.1553e-01, -3.4960e-02],
         [ 1.2095e-01, -4.9262e-02],
         [ 1.1608e-01,  1.2480e-01],
         [ 1.2499e-01,  9.8743e-02],
         [ 1.1031e-01,  1.0269e-01],
         [ 1.0219e-01,  1.2862e-01],
         [ 3.9113e-02,  1.3757e-01],
         [ 1.1250e-01,  6.0251e-02],
         [ 1.3120e-01,  8.7060e-02],
         [ 1.4537e-01, -1.4480e-01],
         [ 1.6311e-01,  1.2787e-01],
         [ 1.6226e-01,  7.2140e-02],
         [ 1.6515e-01,  4.2895e-02],
         [ 1.6869e-01,  1.0476e-01],
         [ 9.4000e-02,  1.3519e-01],
         [ 1.4076e-01,  1.1437e-01],
         [ 1.3608e-01,  7.0406e-02],
         [ 1.3141e-01, -1.5570e-01],
         [ 1.2793e-01, -1.5345e-01],
         [ 1.0072e-01, -1.3383e-01],
         [ 1.2581e-01, -1.3633e-01],
         [-6.9574e-03, -1.6501e-01],
         [ 2.2558e-02, -1.5839e-01],
         [ 3.8409e-02, -1.6121e-01],
         [ 4.5885e-02, -1.8422e-01],
         [ 4.9005e-02, -1.8248e-01],
         [ 5.0101e-02, -1.6663e-01],
         [ 5.0365e-02,  5.2045e-02],
         [ 5.0330e-02,  7.1487e-02],
         [ 5.0222e-02,  8.6209e-02],
         [ 5.0149e-02,  1.0217e-01],
         [ 5.0067e-02,  7.1009e-02],
         [ 5.0044e-02,  8.7310e-02],
         [ 5.0028e-02,  5.3849e-02],
         [ 5.0015e-02,  5.3954e-02],
         [ 5.0018e-02,  8.2849e-02],
         [ 5.0030e-02,  9.6745e-02],
         [ 5.0021e-02,  6.9572e-02],
         [ 5.0014e-02,  5.9719e-02],
         [ 5.0015e-02,  4.8597e-02],
         [ 5.0013e-02, -1.3433e-01],
         [ 5.0018e-02,  6.6798e-02],
         [ 5.0006e-02,  7.7815e-02],
         [ 5.0007e-02,  8.1833e-02],
         [ 5.0007e-02,  1.5325e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 8.7945e-02, -2.5887e-02],
         [ 1.0400e-01, -3.0432e-02],
         [ 1.1303e-01,  2.4155e-02],
         [ 1.1809e-01,  1.5377e-02],
         [ 1.0015e-02,  9.2863e-03],
         [ 2.3734e-02, -1.0888e-02],
         [ 1.1486e-01, -4.8696e-03],
         [ 1.2613e-01, -5.4168e-03],
         [ 1.2670e-01, -4.6118e-03],
         [ 9.6086e-02, -4.9732e-03],
         [ 8.9678e-02, -5.9889e-03],
         [ 1.1245e-01, -6.5392e-03],
         [ 1.2315e-01, -2.5720e-02],
         [ 1.2953e-01, -2.4390e-02],
         [ 1.2819e-01, -6.2889e-03],
         [ 1.2285e-01, -1.3502e-02],
         [ 1.2118e-01, -8.0704e-03],
         [ 9.2590e-02, -7.7955e-03],
         [ 9.4926e-02, -1.3761e-02],
         [ 8.4465e-02,  1.4973e-01],
         [ 8.9873e-02, -3.0579e-02],
         [ 6.1997e-02, -3.5141e-02],
         [ 9.1685e-02,  1.5986e-01],
         [ 6.3482e-02, -5.2831e-02],
         [ 7.6730e-02, -5.4439e-02],
         [ 1.0962e-01, -5.4496e-02],
         [ 1.0868e-01, -3.4752e-02],
         [ 1.1183e-01, -2.7978e-02],
         [ 1.1516e-01, -2.6562e-03],
         [ 1.1644e-01, -2.1203e-02],
         [ 1.1956e-01, -1.4059e-02],
         [ 1.0829e-01, -3.7350e-02],
         [ 1.2242e-01,  1.0598e-01],
         [ 1.0516e-01,  1.2314e-02],
         [ 1.1667e-01,  1.3440e-02],
         [ 1.0698e-01,  1.3767e-02],
         [ 1.1683e-01,  1.3800e-02],
         [ 1.1955e-01, -3.9346e-02],
         [ 1.2178e-01, -4.2076e-02],
         [ 1.2564e-01, -4.4806e-02],
         [ 4.7429e-02, -3.9051e-02],
         [ 4.9777e-02, -5.1145e-02],
         [ 1.2885e-01, -5.7717e-02],
         [ 1.4151e-01,  4.6944e-02],
         [ 1.5342e-01, -7.4602e-02],
         [ 1.5710e-01,  1.0801e-01],
         [ 1.7019e-01,  7.5425e-02],
         [ 1.5892e-01,  1.0132e-01],
         [ 1.7380e-01,  1.1211e-01],
         [ 1.8050e-01,  1.1384e-01],
         [ 3.0879e-02,  3.9459e-02],
         [ 1.6517e-01,  6.5140e-02],
         [ 2.1510e-02,  4.9033e-02],
         [ 1.6007e-01,  9.5380e-02],
         [ 1.7140e-01,  1.0948e-01],
         [ 1.7609e-01,  1.1268e-01],
         [ 6.6388e-02,  1.1957e-01],
         [ 1.6984e-01,  1.3994e-01],
         [ 1.6514e-01,  1.4934e-01],
         [ 1.7174e-01,  1.3334e-01],
         [ 1.5973e-01,  1.0360e-01],
         [ 1.5506e-01,  1.3262e-01],
         [ 1.4982e-01,  1.3690e-01],
         [ 1.5607e-01,  1.4158e-01],
         [ 1.7011e-01,  9.8020e-02],
         [ 1.6465e-01,  7.8354e-02],
         [ 1.5400e-01,  1.1615e-01],
         [ 1.6402e-01,  1.2765e-01],
         [ 1.2891e-01,  9.9509e-02],
         [ 1.5759e-01,  7.6827e-02],
         [ 1.8345e-01,  1.0166e-01],
         [ 1.9221e-01,  8.8821e-02],
         [ 1.9333e-01,  1.1528e-01],
         [ 1.9221e-01,  1.2398e-01],
         [ 1.9291e-01,  1.0885e-01],
         [ 1.8917e-01,  1.0103e-01],
         [ 1.8853e-01,  1.9039e-01],
         [ 1.9272e-01, -1.7854e-01],
         [ 8.1693e-02,  9.0565e-02],
         [ 1.5522e-01,  8.0402e-02],
         [ 1.6433e-01,  1.0445e-01],
         [ 2.0122e-01,  7.8502e-02],
         [ 1.9148e-01,  9.6760e-02],
         [ 1.8679e-01,  1.0279e-01],
         [ 1.8577e-01,  1.0790e-01],
         [ 1.5015e-02,  7.3774e-02],
         [ 2.7627e-02, -1.4887e-01],
         [ 3.8200e-02,  4.2660e-02],
         [ 4.4540e-02, -1.5804e-01],
         [ 4.7823e-02,  8.5829e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.4217e-05, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0018, device='cuda:0')
mixer_td_error tensor(0.5605, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5372, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8711, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0181, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1085, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1067, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2333333., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.9714e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2395, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1368, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2395, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17279
target_mac_out tensor([[[[-1.0000e+07, -5.8723e-02,  7.2334e-02,  ...,  5.1240e-03,
            1.2497e-01, -1.0000e+07],
          [-1.0000e+07, -2.2603e-02,  1.2843e-01,  ...,  1.3084e-02,
            1.3755e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.9665e-02,  5.9675e-02,  ...,  1.7156e-02,
            1.3094e-01, -1.0000e+07],
          [-1.0000e+07, -6.0440e-02,  1.6172e-01,  ...,  4.7207e-02,
            1.5243e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.3029e-02,  9.6897e-02,  ...,  4.0310e-02,
            1.5748e-01, -1.0000e+07],
          [-1.0000e+07, -8.1469e-02,  1.3480e-01,  ...,  1.5844e-02,
            1.5054e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.8873e-01,  8.8306e-02,  ...,  8.2151e-02,
            1.6087e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.1272e-01,  1.1381e-01,  ...,  9.6378e-02,
            1.8654e-01, -3.3632e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-2.6373e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.3745e-02,  1.1397e-01,  ...,  6.2087e-02,
            1.3778e-01, -1.0000e+07],
          [-1.0000e+07, -2.4539e-02,  9.4233e-02,  ..., -1.0851e-02,
            1.2427e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.7459e-02,  9.8722e-02,  ...,  1.3931e-02,
            1.3959e-01, -1.0000e+07],
          [-1.0000e+07, -6.3419e-02,  1.4570e-01,  ...,  3.8138e-02,
            1.4407e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0222e-01,  1.1143e-01,  ...,  1.4510e-02,
            1.5951e-01, -1.0000e+07],
          [-1.0000e+07, -9.0719e-02,  1.6389e-01,  ...,  6.4728e-02,
            1.5741e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.2334e-02,  1.2843e-01],
         [ 5.9675e-02, -6.0440e-02],
         [ 9.6897e-02,  1.3480e-01],
         [ 7.4420e-02,  1.5194e-01],
         [ 7.3940e-02,  1.7054e-01],
         [ 1.0044e-01,  1.4912e-01],
         [-6.1731e-02,  7.0821e-02],
         [ 1.2557e-01, -1.2402e-01],
         [ 6.6760e-02,  1.0149e-01],
         [ 9.2906e-02,  7.0386e-02],
         [ 9.9664e-02,  1.0498e-01],
         [ 8.8624e-02,  9.4359e-02],
         [ 9.5423e-02,  1.0496e-01],
         [ 8.5647e-02,  6.9244e-02],
         [ 9.3601e-02,  6.8772e-02],
         [ 5.1092e-02,  5.7586e-02],
         [ 7.6517e-02,  7.8163e-02],
         [ 9.5002e-02,  4.4981e-02],
         [ 6.7439e-02,  4.1338e-02],
         [ 7.3709e-02,  4.4297e-02],
         [ 8.9399e-02,  7.1824e-02],
         [ 5.5471e-02,  6.1879e-02],
         [ 5.8778e-02,  4.1924e-02],
         [-5.8748e-02, -9.0589e-03],
         [ 8.5596e-02,  2.9268e-02],
         [ 7.0009e-02,  4.6055e-02],
         [ 7.6230e-02,  5.2924e-02],
         [ 9.1832e-02,  5.5413e-02],
         [ 9.9197e-02,  5.6087e-02],
         [ 1.1872e-01,  5.6049e-02],
         [ 9.2737e-02,  5.5828e-02],
         [-9.9554e-02,  5.5592e-02],
         [ 1.1064e-01,  5.5430e-02],
         [ 1.2251e-01,  5.5317e-02],
         [ 1.1057e-01,  5.5267e-02],
         [ 7.2101e-02,  5.5215e-02],
         [ 9.6490e-02,  5.5211e-02],
         [ 1.0416e-01,  5.5222e-02],
         [ 6.1716e-02,  5.5202e-02],
         [ 6.9164e-02,  5.5201e-02],
         [ 5.2652e-02,  5.5205e-02],
         [ 5.9625e-02,  5.5216e-02],
         [ 9.1839e-02,  5.5229e-02],
         [ 8.6465e-02,  5.5229e-02],
         [ 9.9588e-02,  5.5230e-02],
         [ 1.0109e-01,  5.5229e-02],
         [ 9.3778e-02,  5.5232e-02],
         [ 9.9818e-02,  5.5236e-02],
         [ 5.5308e-02,  5.5235e-02],
         [ 8.0658e-02,  5.5232e-02],
         [ 9.4920e-02,  5.5232e-02],
         [ 7.7611e-02,  5.5231e-02],
         [ 5.0046e-02,  5.5231e-02],
         [ 6.0000e-02,  5.5231e-02],
         [ 7.4526e-02,  5.5231e-02],
         [ 7.7165e-02,  5.5231e-02],
         [ 7.6995e-02,  5.5231e-02],
         [ 7.6491e-02,  5.5231e-02],
         [ 7.6112e-02,  5.5231e-02],
         [ 8.8834e-02,  5.5231e-02],
         [ 7.3308e-02,  5.5231e-02],
         [ 6.7160e-02,  5.5231e-02],
         [ 8.8993e-02,  5.5231e-02],
         [ 8.5596e-02,  5.5231e-02],
         [ 8.2517e-02,  5.5231e-02],
         [ 4.6307e-02,  5.5231e-02],
         [ 6.4755e-02,  5.5231e-02],
         [ 5.9737e-02,  5.5231e-02],
         [ 8.9929e-02,  5.5231e-02],
         [ 6.6973e-02,  5.5231e-02],
         [ 5.6515e-02,  5.5231e-02],
         [ 8.2658e-02,  5.5231e-02],
         [ 6.9881e-02,  5.5231e-02],
         [ 6.4551e-02,  5.5231e-02],
         [ 6.1728e-02,  5.5231e-02],
         [ 8.5135e-02,  5.5231e-02],
         [ 6.8518e-02,  5.5231e-02],
         [ 7.5309e-02,  5.5231e-02],
         [ 9.0421e-02,  5.5231e-02],
         [ 1.1627e-01,  5.5231e-02],
         [ 1.2792e-01,  5.5231e-02],
         [ 1.1097e-01,  5.5231e-02],
         [ 7.7176e-02,  5.5231e-02],
         [ 1.0765e-01,  5.5231e-02],
         [ 1.1919e-01,  5.5231e-02],
         [ 1.0911e-01,  5.5231e-02],
         [ 1.2506e-01,  5.5231e-02],
         [ 1.4812e-01,  5.5231e-02],
         [ 1.3746e-01,  5.5231e-02],
         [ 1.0251e-01,  5.5231e-02],
         [ 8.8769e-02,  5.5231e-02],
         [ 1.1512e-01,  5.5231e-02],
         [ 9.2493e-02,  5.5231e-02],
         [ 8.4513e-02,  5.5231e-02],
         [ 1.0516e-01,  5.5231e-02],
         [ 8.3673e-02,  5.5231e-02],
         [ 5.7949e-02,  5.5231e-02],
         [ 4.8616e-02,  5.5231e-02],
         [ 8.8306e-02,  5.5231e-02],
         [ 1.1381e-01,  5.5231e-02],
         [-2.6373e-02,  5.5231e-02]],

        [[ 1.1397e-01,  9.4233e-02],
         [ 9.8722e-02,  1.4570e-01],
         [ 1.1143e-01,  6.4728e-02],
         [ 1.3586e-01,  1.7871e-01],
         [ 1.4687e-01,  1.8179e-01],
         [ 1.5585e-01,  1.4926e-01],
         [ 1.4400e-01,  1.3019e-01],
         [ 1.3895e-01,  1.3914e-01],
         [ 1.1510e-01,  1.5959e-01],
         [ 1.4274e-01,  1.6537e-01],
         [ 1.4816e-01,  1.5004e-01],
         [ 1.1324e-01,  1.5712e-01],
         [ 9.8118e-02,  1.5338e-01],
         [ 1.2477e-01,  1.4664e-01],
         [ 1.3309e-01,  1.5508e-01],
         [ 1.3092e-01,  1.2094e-01],
         [ 9.1389e-02,  1.3626e-01],
         [ 6.8309e-02,  9.6291e-02],
         [ 8.8464e-02,  1.2488e-01],
         [ 7.6859e-02,  1.1966e-01],
         [ 1.1995e-01,  1.1632e-01],
         [ 1.3344e-01,  9.7680e-02],
         [ 1.4191e-01,  1.3203e-01],
         [ 1.0639e-01,  1.0285e-01],
         [ 1.4119e-01,  1.0939e-01],
         [ 1.1021e-01,  1.3258e-01],
         [ 1.3964e-01,  1.4360e-01],
         [ 1.5788e-01,  1.1475e-01],
         [ 1.3786e-01,  1.2930e-01],
         [ 1.4924e-01,  1.4228e-01],
         [ 1.5448e-01,  1.2233e-01],
         [ 1.5518e-01,  1.0699e-01],
         [ 1.3310e-01,  1.3047e-01],
         [ 1.5171e-01,  1.0209e-01],
         [ 1.3595e-01,  3.4605e-03],
         [ 9.9990e-02,  3.3985e-02],
         [ 1.2957e-01,  4.7351e-02],
         [ 1.0111e-01,  5.2776e-02],
         [ 1.1923e-01,  5.4770e-02],
         [ 1.3168e-01,  5.5340e-02],
         [ 1.2891e-01,  5.5415e-02],
         [ 9.9288e-02,  5.5387e-02],
         [ 9.6720e-02,  5.5311e-02],
         [ 8.9051e-02,  5.5234e-02],
         [ 6.7090e-02,  5.5215e-02],
         [-7.9893e-03,  5.5204e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.9896e-05, device='cuda:0') tensor(0.0014, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(0.6468, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4575, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8307, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0390, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1181, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0798, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2722772., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1818, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.5222e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0009, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1831, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1113, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1831, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17325
target_mac_out tensor([[[[-1.0000e+07, -4.3449e-02,  6.2098e-02,  ...,  3.3330e-02,
            1.1733e-01, -1.0000e+07],
          [-1.0000e+07, -2.1358e-02,  1.2351e-01,  ...,  1.3661e-02,
            1.3698e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.1908e-02,  7.1628e-02,  ...,  3.0978e-03,
            1.2913e-01, -1.0000e+07],
          [-1.0000e+07, -3.1400e-02,  1.4762e-01,  ...,  2.0198e-03,
            1.5187e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.7357e-02,  7.2546e-02,  ..., -1.2115e-02,
            1.4121e-01, -1.0000e+07],
          [-1.0000e+07, -3.8792e-02,  1.6292e-01,  ..., -7.4744e-03,
            1.6052e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.6666e-01,  6.7277e-02,  ...,  4.2074e-02,
            1.2994e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.5088e-01,  4.7743e-02,  ...,  4.6411e-02,
            1.1840e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.2708e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.8849e-02,  9.4778e-02,  ...,  2.7572e-02,
            1.4118e-01, -1.0000e+07],
          [-1.0000e+07, -8.8067e-03,  1.0692e-01,  ...,  5.6487e-03,
            1.2377e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0168e-01,  1.0701e-01,  ...,  2.1245e-02,
            1.6130e-01, -1.0000e+07],
          [-1.0000e+07, -3.0121e-02,  1.3401e-01,  ..., -3.1575e-03,
            1.4619e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.8083e-02,  1.0329e-01,  ...,  1.5112e-02,
            1.5348e-01, -1.0000e+07],
          [-1.0000e+07, -4.6897e-02,  1.4437e-01,  ...,  1.5678e-02,
            1.5861e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 6.2098e-02,  1.2351e-01],
         [ 7.1628e-02,  1.4762e-01],
         [ 7.2546e-02,  1.6292e-01],
         [ 1.0148e-01, -5.8105e-02],
         [ 9.0296e-02,  1.3629e-01],
         [ 1.0358e-01,  8.7815e-02],
         [ 1.3922e-01,  3.2099e-02],
         [ 1.5520e-01,  8.0131e-02],
         [ 1.6333e-01,  4.5404e-02],
         [ 1.7725e-01,  6.6576e-02],
         [-2.1181e-02,  6.9594e-02],
         [ 6.8323e-03,  8.7540e-02],
         [ 1.0676e-01, -5.5711e-02],
         [ 9.0998e-02,  6.7243e-02],
         [ 1.0499e-01, -3.0044e-02],
         [ 1.1099e-01,  1.3375e-01],
         [ 1.1279e-01,  1.5824e-01],
         [ 1.1430e-01,  1.3294e-01],
         [ 1.1755e-01,  1.6139e-01],
         [ 1.0673e-01,  1.3278e-01],
         [ 9.2436e-02,  1.5743e-01],
         [ 6.2343e-02,  1.6295e-01],
         [ 5.5895e-02,  1.2947e-01],
         [ 8.6210e-02,  1.4200e-01],
         [ 1.1339e-01,  1.0826e-01],
         [ 1.2281e-01,  1.2325e-01],
         [ 1.2728e-01,  1.5667e-01],
         [ 9.9314e-02,  1.5379e-01],
         [ 1.2422e-01,  4.5165e-02],
         [ 1.4286e-01,  7.7782e-02],
         [ 1.2072e-01,  2.3411e-02],
         [ 1.4590e-01,  5.5886e-02],
         [ 1.5875e-01,  6.3887e-02],
         [ 1.2778e-01,  9.9482e-02],
         [ 1.4217e-01,  8.3467e-02],
         [ 1.5344e-01,  7.3941e-02],
         [ 1.5482e-01,  7.1162e-02],
         [ 1.5599e-01,  9.9465e-02],
         [ 1.5403e-01,  8.0141e-02],
         [ 1.5243e-01,  1.1265e-01],
         [ 1.4938e-01,  8.6938e-02],
         [ 1.2706e-01,  1.1020e-01],
         [ 1.2503e-01,  1.3384e-01],
         [ 1.2814e-01,  1.3438e-01],
         [ 1.4334e-01,  1.0204e-01],
         [ 1.2434e-01,  9.0019e-02],
         [ 1.5214e-01,  8.3208e-02],
         [ 1.2740e-01,  8.0371e-02],
         [ 1.3035e-01,  6.8419e-02],
         [ 1.2618e-01,  1.0385e-01],
         [ 1.4117e-01,  8.6160e-02],
         [ 1.3474e-01,  1.1467e-01],
         [ 1.4109e-01,  1.3047e-01],
         [ 1.5707e-01,  1.3829e-01],
         [ 1.2882e-01,  6.5886e-02],
         [ 5.9259e-02,  9.7162e-02],
         [ 1.3704e-01,  1.1798e-01],
         [ 1.2698e-01,  9.7955e-02],
         [ 1.4222e-01,  8.5284e-02],
         [ 1.4209e-01,  1.2096e-01],
         [ 1.1797e-01,  9.5788e-02],
         [ 1.4616e-01,  1.1879e-01],
         [ 1.3627e-01,  1.3409e-01],
         [ 1.5640e-01,  9.3052e-02],
         [ 1.5776e-01,  8.9948e-02],
         [ 1.5448e-01,  1.1217e-01],
         [ 1.5636e-01,  1.2394e-01],
         [ 1.5875e-01,  1.3002e-01],
         [ 1.3190e-01,  4.7554e-02],
         [ 1.5792e-01,  8.3048e-02],
         [ 1.6727e-01,  7.1049e-02],
         [ 1.7752e-01,  6.2917e-02],
         [ 1.8903e-01,  9.7067e-02],
         [ 1.8810e-01,  1.0800e-01],
         [ 1.8029e-01,  6.4629e-02],
         [ 1.7282e-01,  4.5136e-02],
         [ 1.6848e-01,  7.6969e-02],
         [ 1.3929e-01,  6.2918e-02],
         [ 1.7132e-01,  9.5625e-02],
         [ 1.6232e-01,  1.1023e-01],
         [ 1.7734e-01,  1.1688e-01],
         [ 1.3139e-01,  6.0743e-02],
         [ 1.1768e-01,  4.5517e-02],
         [ 1.2347e-01,  4.1033e-02],
         [ 1.0153e-01,  3.8645e-02],
         [ 5.2038e-02,  6.4199e-02],
         [ 6.8662e-02,  2.3411e-02],
         [ 6.2434e-02,  5.6632e-02],
         [ 9.2789e-02,  2.8729e-02],
         [ 6.4020e-02,  7.4602e-02],
         [ 4.1622e-02,  5.0010e-02],
         [ 5.9600e-02,  8.9831e-02],
         [ 1.2247e-01,  7.6247e-02],
         [ 1.1558e-01,  8.3153e-02],
         [ 5.9788e-02,  8.4992e-02],
         [ 1.2031e-01,  1.0666e-01],
         [ 1.3138e-01,  1.0542e-01],
         [ 1.3206e-01,  7.9696e-02],
         [ 1.5497e-01,  4.9755e-02],
         [ 1.6355e-01,  7.5160e-02],
         [ 1.2585e-01,  7.7119e-02],
         [ 1.4998e-01,  8.5199e-02],
         [ 1.5832e-01,  6.4501e-02],
         [ 1.4427e-01,  3.5653e-02],
         [ 1.6025e-01,  2.7479e-02],
         [ 1.4561e-01,  6.1700e-02],
         [ 1.5942e-01,  4.2482e-02],
         [ 1.6564e-01,  8.1041e-02],
         [ 1.4706e-01,  9.5415e-02],
         [ 1.6831e-01,  1.2742e-01],
         [ 1.4852e-01,  1.0659e-01],
         [ 1.1419e-01,  9.6575e-02],
         [ 1.2630e-01,  9.8754e-02],
         [ 1.5329e-01,  1.3765e-01],
         [ 1.2278e-01,  1.1733e-01],
         [ 9.2013e-02,  1.4003e-01],
         [ 1.3007e-01,  1.6316e-01],
         [ 1.8052e-01,  1.3186e-01],
         [ 1.9230e-01,  1.0123e-01],
         [ 2.0304e-01,  1.1761e-01],
         [ 2.2267e-01,  1.0482e-01],
         [ 1.7576e-01,  9.4810e-02],
         [ 1.5637e-01,  5.7123e-02],
         [ 1.4828e-01,  6.4940e-02],
         [ 1.7760e-01,  8.4614e-02],
         [ 1.9990e-01,  7.7624e-02],
         [ 1.6392e-01,  6.1885e-02],
         [ 1.8377e-01,  8.0965e-02],
         [ 1.9061e-01,  9.0403e-02],
         [ 1.6260e-01,  1.6860e-01],
         [ 1.3200e-01,  6.6642e-02],
         [ 1.4028e-01,  2.7133e-02],
         [ 1.0372e-01, -6.5637e-03],
         [ 1.1430e-01,  3.0356e-02],
         [ 1.4587e-01,  4.6682e-02],
         [ 1.1518e-01,  5.3259e-02],
         [ 1.1905e-01,  5.5532e-02],
         [ 1.1289e-01,  5.6072e-02],
         [ 1.1163e-01,  5.5997e-02],
         [ 1.1215e-01,  5.5767e-02],
         [ 7.4662e-02,  5.5556e-02],
         [ 9.8693e-02,  5.5411e-02],
         [ 1.2663e-01,  5.5299e-02],
         [ 1.3750e-01,  5.5256e-02],
         [ 9.3967e-02,  5.5219e-02],
         [ 8.1147e-02,  5.5217e-02],
         [ 1.0030e-01,  5.5210e-02],
         [ 1.2360e-01,  5.5206e-02],
         [ 1.1400e-01,  5.5215e-02],
         [ 1.6166e-01,  5.5219e-02],
         [ 1.8111e-01,  5.5211e-02],
         [ 1.3334e-01,  5.5217e-02],
         [ 6.0905e-02,  5.5223e-02],
         [ 1.1653e-01,  5.5232e-02],
         [ 1.3384e-01,  5.5230e-02],
         [ 1.5766e-01,  5.5230e-02],
         [ 1.8700e-01,  5.5231e-02],
         [ 1.8438e-01,  5.5236e-02],
         [ 1.4085e-01,  5.5235e-02],
         [ 1.3668e-01,  5.5232e-02],
         [ 7.5993e-02,  5.5232e-02],
         [ 1.0725e-01,  5.5231e-02],
         [ 6.5402e-02,  5.5231e-02],
         [ 1.0312e-01,  5.5231e-02],
         [ 8.6308e-02,  5.5231e-02],
         [ 1.0921e-01,  5.5231e-02],
         [ 1.0841e-01,  5.5231e-02],
         [ 1.1240e-01,  5.5231e-02],
         [ 1.1658e-01,  5.5231e-02],
         [ 1.1827e-01,  5.5231e-02],
         [ 1.1759e-01,  5.5231e-02],
         [ 6.7277e-02,  5.5231e-02],
         [ 4.7743e-02,  5.5231e-02],
         [ 3.2708e-02,  5.5231e-02]],

        [[ 9.4778e-02,  1.0692e-01],
         [ 1.0701e-01,  1.3401e-01],
         [ 1.0329e-01,  1.4437e-01],
         [ 1.0908e-01,  9.6058e-03],
         [ 8.8958e-02,  1.3872e-01],
         [ 7.8842e-02,  1.2641e-01],
         [ 9.7559e-02,  1.1327e-01],
         [ 7.3277e-02,  1.4921e-01],
         [ 8.5547e-02,  1.1327e-02],
         [ 1.0861e-01,  1.1428e-01],
         [ 1.0135e-01,  1.0059e-01],
         [ 1.1634e-01,  8.4385e-02],
         [ 1.1733e-01,  1.2015e-01],
         [ 1.2534e-01,  1.0827e-01],
         [ 9.4644e-02,  1.1622e-01],
         [ 1.0607e-01,  1.3830e-01],
         [ 1.0770e-01,  1.6438e-01],
         [ 1.3016e-01,  1.6786e-01],
         [ 1.1887e-01,  1.6851e-01],
         [ 1.0104e-01,  1.7971e-01],
         [ 1.2868e-01,  1.9276e-01],
         [ 1.2743e-01,  1.5821e-01],
         [ 1.4490e-01,  1.2841e-01],
         [ 1.4664e-01,  1.6958e-01],
         [ 1.4899e-01,  1.3396e-01],
         [ 1.7412e-01,  1.7461e-01],
         [ 1.6197e-01,  1.8496e-01],
         [ 1.3326e-01,  1.8420e-01],
         [ 1.2878e-01,  1.8324e-01],
         [ 9.6378e-02,  1.3822e-01],
         [ 8.7475e-02,  1.5817e-01],
         [ 1.2536e-01,  1.7240e-01],
         [ 1.6790e-01,  1.5582e-01],
         [ 1.3074e-01,  1.3008e-01],
         [ 8.4087e-02,  1.5481e-01],
         [ 1.0324e-01,  1.1347e-01],
         [ 1.0847e-01,  1.2327e-01],
         [ 1.3394e-01,  1.2670e-01],
         [ 9.4271e-02, -1.1012e-03],
         [ 7.7382e-02,  3.0963e-02],
         [ 1.1069e-01,  4.5538e-02],
         [ 1.4921e-01,  5.1784e-02],
         [ 1.0974e-01,  5.4247e-02],
         [ 1.1139e-01,  5.5128e-02],
         [ 1.0373e-01,  5.5349e-02],
         [ 7.1114e-02,  5.5386e-02],
         [ 7.1325e-02,  5.5324e-02],
         [ 8.9880e-02,  5.5279e-02],
         [ 9.4628e-02,  5.5260e-02],
         [ 1.0651e-01,  5.5237e-02],
         [ 1.2546e-01,  5.5204e-02],
         [ 1.4884e-01,  5.5228e-02],
         [ 1.0731e-01,  5.5226e-02],
         [ 8.7933e-02,  5.5212e-02],
         [ 1.1500e-01,  5.5221e-02],
         [ 1.1564e-01,  5.5214e-02],
         [ 1.2283e-01,  5.5220e-02],
         [ 1.6551e-01,  5.5221e-02],
         [ 1.3584e-01,  5.5230e-02],
         [ 1.1851e-01,  5.5231e-02],
         [ 1.1183e-01,  5.5230e-02],
         [ 1.1045e-01,  5.5230e-02],
         [ 1.2282e-01,  5.5232e-02],
         [ 1.2048e-01,  5.5236e-02],
         [ 1.2540e-01,  5.5236e-02],
         [ 1.1773e-02,  5.5232e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.3088e-06, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.7716, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4631, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3749, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0447, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1499, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0563, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3103448., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2227, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.6100e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1856, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0726, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1856, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17370
target_mac_out tensor([[[[-1.0000e+07, -1.0334e-01,  1.0827e-01,  ...,  6.1307e-02,
            1.4019e-01, -1.0000e+07],
          [-1.0000e+07, -1.1117e-02,  1.0736e-01,  ...,  7.1576e-03,
            1.2315e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3268e-01,  1.1815e-01,  ...,  6.9543e-02,
            1.6155e-01, -1.0000e+07],
          [-1.0000e+07, -2.7664e-02,  1.0133e-01,  ...,  1.0988e-02,
            1.3958e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.6339e-01,  1.3025e-01,  ...,  7.9943e-02,
            1.7916e-01, -3.7833e-01],
          [-1.0000e+07, -5.6401e-02,  1.3878e-01,  ...,  3.7180e-02,
            1.4673e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7229e-02,  1.0718e-01,  ...,  1.5798e-02,
            1.3791e-01, -1.0000e+07],
          [-1.0000e+07, -6.3204e-02,  1.3937e-01,  ...,  4.1475e-02,
            1.4929e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.9425e-02,  1.1495e-01,  ...,  1.2519e-02,
            1.5796e-01, -1.0000e+07],
          [-1.0000e+07, -7.3710e-02,  1.2961e-01,  ...,  3.4332e-02,
            1.4764e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.1049e-01,  9.5954e-02,  ...,  4.3549e-02,
            1.9052e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.2270e-01,  1.0282e-01,  ...,  7.2312e-02,
            2.0724e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.6719e-01,  1.2207e-01,  ...,  9.9992e-02,
            2.0307e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0827e-01,  1.0736e-01],
         [ 1.1815e-01,  1.0133e-01],
         [ 1.3025e-01,  1.3878e-01],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.9115e-02,  9.3163e-02],
         [ 1.0718e-01,  1.3937e-01],
         [ 1.1495e-01,  1.2961e-01],
         ...,
         [ 9.5954e-02,  5.5231e-02],
         [ 1.0282e-01,  5.5231e-02],
         [ 1.2207e-01,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(8.1431e-06, device='cuda:0') tensor(0.0004, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(1.0560, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5246, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6562, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0557, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1746, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0714, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-4249999.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2561, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(9.6555e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2717, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2698, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2717, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17414
target_mac_out tensor([[[[-1.0000e+07, -6.8669e-02,  9.9115e-02,  ...,  2.7489e-02,
            1.4130e-01, -1.0000e+07],
          [-1.0000e+07, -2.0465e-02,  9.3163e-02,  ..., -1.3050e-02,
            1.2501e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5820e-02,  1.1367e-01,  ...,  2.0960e-02,
            1.5981e-01, -1.0000e+07],
          [-1.0000e+07, -3.3890e-02,  1.2184e-01,  ..., -9.4792e-03,
            1.4216e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.4115e-02,  9.7616e-02,  ..., -6.1246e-03,
            1.4831e-01, -1.0000e+07],
          [-1.0000e+07, -6.9657e-02,  1.5870e-01,  ...,  3.7472e-02,
            1.5523e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.2547e-01,  9.7470e-02,  ...,  7.7522e-02,
            2.0352e-01, -3.4222e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.3601e-01, -1.0000e+07,  ..., -1.0000e+07,
            2.0440e-01, -3.3757e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.7775e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.5215e-02,  8.8677e-02,  ...,  2.3305e-02,
            1.2081e-01, -1.0000e+07],
          [-1.0000e+07, -5.3949e-02,  1.3771e-01,  ...,  6.3333e-02,
            1.3943e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.0181e-02,  8.6626e-02,  ..., -9.5708e-03,
            1.2989e-01, -1.0000e+07],
          [-1.0000e+07, -7.4152e-02,  1.2086e-01,  ...,  2.6294e-02,
            1.4673e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1307e-01,  1.1981e-01,  ...,  3.3674e-02,
            1.5241e-01, -1.0000e+07],
          [-1.0000e+07, -8.2276e-02,  1.2745e-01,  ...,  2.7538e-02,
            1.4106e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.9115e-02,  9.3163e-02],
         [ 1.1367e-01,  1.2184e-01],
         [ 9.7616e-02,  1.5870e-01],
         [ 7.4691e-02,  1.1204e-01],
         [ 9.9145e-02,  9.5579e-02],
         [ 1.0825e-01,  1.1353e-01],
         [ 1.1432e-01,  1.0466e-01],
         [ 1.1531e-01,  1.1179e-01],
         [ 1.0013e-01,  1.0092e-01],
         [ 1.1854e-01,  9.9454e-02],
         [ 1.4993e-01,  1.3044e-01],
         [ 1.3028e-01,  1.1707e-01],
         [ 1.0804e-01,  1.3764e-01],
         [ 1.1123e-01,  1.5076e-01],
         [ 1.1422e-01,  1.5680e-01],
         [ 1.0470e-01,  1.3466e-01],
         [ 1.1470e-01,  1.4277e-01],
         [ 8.5755e-02,  1.3010e-01],
         [ 1.0248e-01,  1.0345e-01],
         [ 7.1450e-02,  1.3035e-01],
         [ 9.5087e-02,  1.2621e-01],
         [ 8.3603e-02,  1.4499e-01],
         [ 8.7788e-02,  1.1782e-01],
         [ 5.7037e-02,  1.3423e-01],
         [ 7.1697e-02,  1.1480e-01],
         [ 9.9106e-02, -2.6994e-02],
         [ 9.8745e-02,  1.2220e-01],
         [ 8.9323e-02,  1.3104e-01],
         [ 9.9027e-02,  1.5172e-01],
         [ 1.1520e-01,  1.2282e-01],
         [ 1.1881e-01,  1.0352e-01],
         [ 1.0138e-01,  1.2990e-01],
         [ 1.0687e-01,  1.3974e-01],
         [ 1.0578e-01,  1.2334e-01],
         [ 1.1077e-01,  1.0337e-01],
         [ 1.1489e-01,  1.2670e-01],
         [ 1.2544e-01,  1.3426e-01],
         [ 8.8977e-02,  1.2113e-01],
         [ 8.5832e-02,  1.0603e-01],
         [ 1.0470e-01,  1.1970e-01],
         [ 1.1488e-01,  1.0503e-01],
         [ 1.2000e-01,  1.2856e-01],
         [ 1.2396e-01,  1.4082e-01],
         [ 1.2762e-01,  1.1588e-01],
         [ 1.2811e-01,  9.3412e-02],
         [ 1.3129e-01,  7.9963e-02],
         [ 1.3142e-01,  8.9347e-02],
         [ 1.3869e-01,  1.1042e-01],
         [ 1.1127e-01,  1.1562e-01],
         [ 1.1921e-01,  1.3161e-01],
         [ 1.1471e-01,  1.4803e-01],
         [ 1.2024e-01,  1.5306e-01],
         [ 8.3258e-02,  1.4979e-01],
         [ 1.0480e-01,  1.2445e-01],
         [ 8.1029e-02,  1.4316e-01],
         [ 6.1700e-02,  1.2264e-01],
         [ 1.0963e-01,  1.3374e-01],
         [ 1.2999e-01,  1.3883e-01],
         [ 1.4923e-01,  1.3973e-01],
         [ 8.5239e-02,  1.0748e-01],
         [ 1.1993e-01,  1.0645e-01],
         [ 7.2403e-02,  6.1076e-02],
         [ 7.1561e-02,  3.3777e-02],
         [ 5.7871e-02,  2.3636e-02],
         [ 8.8770e-02,  3.7400e-02],
         [ 9.9864e-02,  5.0553e-02],
         [ 6.8915e-02,  5.5630e-02],
         [ 8.9004e-02,  5.6944e-02],
         [ 9.7946e-02,  5.6847e-02],
         [ 8.7889e-02,  5.6394e-02],
         [ 9.5333e-02,  5.5925e-02],
         [ 7.3290e-02,  5.5592e-02],
         [ 6.5113e-02,  5.5389e-02],
         [ 7.3948e-02,  5.5279e-02],
         [ 9.0383e-02,  5.5237e-02],
         [ 1.1543e-01,  5.5217e-02],
         [ 7.3556e-02,  5.5189e-02],
         [ 6.9974e-02,  5.5200e-02],
         [ 7.7252e-02,  5.5220e-02],
         [ 8.0366e-02,  5.5215e-02],
         [ 5.8235e-02,  5.5214e-02],
         [ 9.0370e-02,  5.5204e-02],
         [ 1.0201e-01,  5.5216e-02],
         [ 1.0394e-01,  5.5224e-02],
         [ 9.2042e-02,  5.5230e-02],
         [ 1.0063e-01,  5.5230e-02],
         [ 6.5217e-02,  5.5230e-02],
         [ 9.2250e-02,  5.5230e-02],
         [ 8.7811e-02,  5.5236e-02],
         [ 7.0684e-02,  5.5235e-02],
         [ 8.9995e-02,  5.5232e-02],
         [ 7.1203e-02,  5.5232e-02],
         [ 7.6451e-02,  5.5231e-02],
         [ 6.3604e-02,  5.5231e-02],
         [ 8.5244e-02,  5.5231e-02],
         [ 5.9839e-02,  5.5231e-02],
         [ 5.5067e-02,  5.5231e-02],
         [ 8.5025e-02,  5.5231e-02],
         [ 9.9543e-02,  5.5231e-02],
         [ 7.9434e-02,  5.5231e-02],
         [ 8.2168e-02,  5.5231e-02],
         [ 9.3324e-02,  5.5231e-02],
         [ 5.8365e-02,  5.5231e-02],
         [ 8.7159e-02,  5.5231e-02],
         [ 5.5370e-02,  5.5231e-02],
         [ 9.2696e-02,  5.5231e-02],
         [ 7.2147e-02,  5.5231e-02],
         [ 9.6755e-02,  5.5231e-02],
         [ 7.6792e-02,  5.5231e-02],
         [ 6.4501e-02,  5.5231e-02],
         [ 7.6140e-02,  5.5231e-02],
         [ 7.7045e-02,  5.5231e-02],
         [ 5.8211e-02,  5.5231e-02],
         [ 8.5810e-02,  5.5231e-02],
         [ 9.5276e-02,  5.5231e-02],
         [ 1.0332e-01,  5.5231e-02],
         [ 8.1184e-02,  5.5231e-02],
         [ 7.1071e-02,  5.5231e-02],
         [ 6.5515e-02,  5.5231e-02],
         [ 4.7780e-02,  5.5231e-02],
         [ 4.8978e-02,  5.5231e-02],
         [ 7.0626e-02,  5.5231e-02],
         [ 5.7657e-02,  5.5231e-02],
         [ 6.9537e-02,  5.5231e-02],
         [ 8.7584e-02,  5.5231e-02],
         [ 5.5273e-02,  5.5231e-02],
         [ 9.2259e-02,  5.5231e-02],
         [ 1.0555e-01,  5.5231e-02],
         [ 1.0912e-01,  5.5231e-02],
         [ 6.9183e-02,  5.5231e-02],
         [ 9.4184e-02,  5.5231e-02],
         [ 6.0593e-02,  5.5231e-02],
         [ 9.6756e-02,  5.5231e-02],
         [ 1.0418e-01,  5.5231e-02],
         [ 7.0197e-02,  5.5231e-02],
         [ 6.4023e-02,  5.5231e-02],
         [ 9.1017e-02,  5.5231e-02],
         [ 6.4179e-02,  5.5231e-02],
         [ 9.5938e-02,  5.5231e-02],
         [ 8.8785e-02,  5.5231e-02],
         [ 8.2829e-02,  5.5231e-02],
         [ 9.6233e-02,  5.5231e-02],
         [ 8.5531e-02,  5.5231e-02],
         [ 9.5055e-02,  5.5231e-02],
         [ 5.6590e-02,  5.5231e-02],
         [ 9.4768e-02,  5.5231e-02],
         [ 1.0456e-01,  5.5231e-02],
         [ 1.0920e-01,  5.5231e-02],
         [ 1.2599e-01,  5.5231e-02],
         [ 1.3224e-01,  5.5231e-02],
         [ 1.4959e-01,  5.5231e-02],
         [ 1.1336e-01,  5.5231e-02],
         [ 1.3785e-01,  5.5231e-02],
         [ 1.3675e-01,  5.5231e-02],
         [ 1.4788e-01,  5.5231e-02],
         [ 1.3624e-01,  5.5231e-02],
         [ 1.2812e-01,  5.5231e-02],
         [ 1.4165e-01,  5.5231e-02],
         [ 1.4923e-01,  5.5231e-02],
         [ 1.4210e-01,  5.5231e-02],
         [ 1.3550e-01,  5.5231e-02],
         [ 2.2885e-01,  5.5231e-02],
         [ 2.2300e-01,  5.5231e-02],
         [ 1.0112e-01,  5.5231e-02],
         [ 2.3165e-01,  5.5231e-02],
         [ 2.2259e-01,  5.5231e-02],
         [ 9.7470e-02,  5.5231e-02],
         [ 2.0440e-01,  5.5231e-02],
         [ 1.7775e-02,  5.5231e-02]],

        [[ 8.8677e-02,  1.3771e-01],
         [ 8.6626e-02,  1.2086e-01],
         [ 1.1981e-01,  1.2745e-01],
         [ 8.6638e-02,  1.0232e-01],
         [ 6.3253e-02,  1.0304e-01],
         [ 9.5753e-02,  9.3885e-02],
         [ 1.2220e-01,  1.0003e-01],
         [ 1.2124e-01,  1.0173e-01],
         [ 1.4090e-01,  1.3144e-01],
         [ 1.0847e-01,  1.1105e-01],
         [ 8.6861e-02,  1.3522e-01],
         [ 1.1466e-01,  1.1080e-01],
         [ 1.3041e-01,  1.3074e-01],
         [ 1.1573e-01,  9.9906e-02],
         [ 1.2316e-01,  1.2942e-01],
         [ 1.2600e-01,  1.6450e-01],
         [ 9.9306e-02,  1.2582e-01],
         [ 8.9511e-02,  4.4644e-02],
         [ 9.4875e-02,  1.1805e-01],
         [ 1.2244e-01,  1.6105e-01],
         [ 1.3036e-01,  1.1225e-01],
         [ 1.3482e-01,  1.2226e-01],
         [ 1.0018e-01,  1.4886e-01],
         [ 1.1557e-01,  1.2387e-01],
         [ 1.2741e-01,  5.8043e-02],
         [ 1.3774e-01,  1.3669e-01],
         [ 1.3239e-01,  1.2383e-01],
         [ 1.3569e-01,  7.5305e-02],
         [ 1.2871e-01,  1.0927e-01],
         [ 1.3286e-01,  1.3564e-01],
         [ 1.3568e-01,  9.0244e-02],
         [ 1.5270e-01,  1.3479e-01],
         [ 1.6016e-01,  1.2983e-01],
         [ 1.2421e-01,  1.0424e-01],
         [ 1.4614e-01,  1.3653e-01],
         [ 1.5815e-01,  1.4401e-01],
         [ 1.2155e-01,  1.4202e-01],
         [ 1.1227e-01,  9.9387e-02],
         [ 8.4441e-02,  9.6679e-02],
         [ 7.2137e-02,  4.1684e-03],
         [ 1.1128e-01,  3.4376e-02],
         [ 8.5570e-02,  4.7756e-02],
         [ 9.0993e-02,  5.3130e-02],
         [ 1.1413e-01,  5.5048e-02],
         [ 1.1961e-01,  5.5533e-02],
         [ 9.2008e-02,  5.5533e-02],
         [ 6.5838e-02,  5.5434e-02],
         [ 9.4941e-02,  5.5329e-02],
         [ 1.2222e-01,  5.5255e-02],
         [ 8.1804e-02,  5.5219e-02],
         [ 1.0778e-01,  5.5193e-02],
         [ 1.2786e-01,  5.5194e-02],
         [ 1.2301e-01,  5.5204e-02],
         [ 1.3079e-01,  5.5222e-02],
         [ 1.4861e-01,  5.5196e-02],
         [ 1.3925e-01,  5.5221e-02],
         [ 1.1287e-01,  5.5210e-02],
         [ 1.3083e-01,  5.5209e-02],
         [ 1.3546e-01,  5.5223e-02],
         [ 1.0637e-01,  5.5226e-02],
         [ 3.1129e-02,  5.5232e-02],
         [ 1.0530e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.2508e-05, device='cuda:0') tensor(0.0004, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.7601, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4757, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4759, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0609, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1591, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0502, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3165680.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2317, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.8392e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2223, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0637, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2223, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17460
target_mac_out tensor([[[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.2489e-02,  1.2578e-01,  ...,  5.0639e-02,
            1.4352e-01, -1.0000e+07],
          [-1.0000e+07, -3.4800e-02,  8.5615e-02,  ..., -3.3144e-02,
            1.3339e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.6344e-02,  1.0249e-01,  ...,  3.1700e-02,
            1.3221e-01, -1.0000e+07],
          [-1.0000e+07, -7.1485e-02,  1.3421e-01,  ...,  3.2735e-02,
            1.5583e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -1.0152e-01,  1.1386e-01,  ...,  6.2561e-02,
            1.3737e-01, -1.0000e+07],
          [-1.0000e+07, -5.4216e-02,  1.4136e-01,  ...,  6.0947e-02,
            1.3571e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1316e-01,  1.1405e-01,  ...,  4.5165e-02,
            1.3762e-01, -1.0000e+07],
          [-1.0000e+07, -5.2137e-02,  1.0687e-01,  ...,  4.0303e-02,
            1.4691e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.3535e-01,  1.0750e-01,  ...,  1.7220e-02,
            1.5392e-01, -1.0000e+07],
          [-1.0000e+07, -9.3427e-02,  1.5680e-01,  ...,  7.1136e-02,
            1.4742e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.7497e-01,  8.7737e-02,  ...,  5.8484e-02,
            1.4736e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.0489e-01,  1.0439e-01,  ...,  7.7469e-02,
            1.6904e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-8.7360e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.2300e-02,  8.8635e-02],
         [ 1.2578e-01,  8.5615e-02],
         [ 1.0249e-01,  1.3421e-01],
         [ 1.3909e-01,  1.4278e-01],
         [ 1.2274e-01,  1.0410e-01],
         [ 1.3877e-01,  1.1590e-01],
         [ 1.3292e-01,  9.7531e-02],
         [ 1.4626e-01,  1.3448e-01],
         [ 1.4917e-01,  1.0685e-01],
         [ 1.4935e-01,  1.4933e-01],
         [ 1.1939e-01,  1.1460e-01],
         [ 1.2269e-01,  9.8573e-02],
         [ 1.5021e-01,  7.0951e-02],
         [ 1.6308e-01,  1.2499e-01],
         [ 1.6788e-01,  1.4335e-01],
         [ 1.8012e-01,  9.3357e-02],
         [ 1.8889e-01,  6.3783e-02],
         [ 1.9634e-01,  4.6880e-02],
         [ 1.8585e-01,  8.7998e-02],
         [ 1.9607e-01,  1.2256e-01],
         [ 2.0244e-01,  1.3617e-01],
         [ 2.0096e-01,  1.4833e-01],
         [ 1.9990e-01,  1.4954e-01],
         [ 1.5068e-01,  7.4392e-02],
         [ 1.5001e-01,  8.7343e-02],
         [ 1.8139e-01,  1.1427e-01],
         [-3.6288e-02,  5.7909e-02],
         [ 6.6374e-03,  9.9850e-02],
         [ 2.9214e-02, -4.5148e-02],
         [ 4.0513e-02,  1.4446e-01],
         [ 4.5928e-02, -5.0529e-02],
         [ 4.8425e-02,  1.0529e-01],
         [ 4.9503e-02,  1.5986e-01],
         [ 4.9903e-02,  1.7980e-01],
         [ 5.0050e-02,  1.8257e-01],
         [ 5.0070e-02,  1.0579e-01],
         [ 5.0066e-02,  7.6874e-02],
         [ 5.0037e-02,  1.2044e-01],
         [ 5.0012e-02,  1.4367e-01],
         [ 5.0030e-02,  1.0656e-01],
         [ 5.0016e-02,  1.0415e-01],
         [ 5.0017e-02,  1.0735e-01],
         [ 5.0015e-02,  5.9588e-02],
         [ 5.0022e-02,  7.5293e-02],
         [ 5.0012e-02,  1.1097e-01],
         [ 5.0016e-02,  2.4475e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.1386e-01,  1.4136e-01],
         [ 1.1405e-01,  1.0687e-01],
         [ 1.0750e-01,  1.5680e-01],
         [ 1.1718e-01,  1.1287e-01],
         [ 1.0475e-01,  1.0235e-01],
         [ 9.5130e-02,  1.0276e-01],
         [ 7.5802e-02,  9.5403e-02],
         [ 8.1544e-02,  9.8256e-02],
         [ 5.9236e-02,  1.0912e-01],
         [ 1.0893e-01,  1.2852e-01],
         [ 1.2457e-01,  1.4457e-01],
         [ 1.5972e-01,  1.5174e-01],
         [ 1.7168e-01,  1.2656e-01],
         [ 1.2822e-01,  1.4573e-01],
         [ 1.1219e-01,  1.4921e-01],
         [ 9.1059e-02,  1.1279e-01],
         [ 1.3050e-01,  1.0559e-01],
         [ 1.0893e-01,  1.1180e-01],
         [ 1.0651e-01,  1.0079e-01],
         [ 1.1001e-01,  1.1031e-01],
         [ 1.0097e-01,  1.3151e-01],
         [ 1.0438e-01,  1.1283e-01],
         [ 7.3218e-02,  1.3779e-01],
         [ 9.6939e-02,  5.2255e-02],
         [ 1.0960e-01,  9.9436e-02],
         [ 9.9344e-02,  8.5119e-02],
         [ 1.2071e-01,  1.1294e-01],
         [ 1.1182e-01,  1.0650e-01],
         [ 1.2235e-01,  1.2246e-01],
         [ 1.2825e-01,  1.2933e-01],
         [ 1.3540e-01,  1.3417e-01],
         [ 1.2550e-01,  1.1616e-01],
         [ 1.3151e-01,  8.8897e-02],
         [ 1.1660e-01,  1.1416e-01],
         [ 1.0615e-01,  1.0969e-01],
         [ 1.1131e-01,  1.2584e-01],
         [ 1.3091e-01,  1.1950e-01],
         [ 8.0762e-02,  5.5102e-02],
         [ 1.0281e-01,  8.0624e-02],
         [ 1.0906e-01,  8.9651e-02],
         [ 1.2118e-01,  1.1091e-01],
         [ 1.2719e-01,  1.0718e-01],
         [ 1.1393e-01,  9.6624e-02],
         [ 9.4687e-02,  1.1824e-01],
         [ 8.6466e-02,  1.1831e-01],
         [ 7.0360e-02,  1.1063e-01],
         [ 9.7655e-02,  9.9630e-02],
         [ 9.8608e-02,  1.3535e-01],
         [ 1.1027e-01,  1.4325e-01],
         [ 1.1687e-01,  1.4936e-01],
         [ 8.8444e-02,  1.2981e-01],
         [ 9.5480e-02,  1.4036e-01],
         [ 7.8910e-02,  1.1168e-01],
         [ 1.0198e-01,  1.0762e-01],
         [ 1.1338e-01,  8.4493e-02],
         [ 1.1903e-01,  1.1782e-01],
         [ 1.2493e-01,  1.3311e-01],
         [ 1.2457e-01,  1.3930e-01],
         [ 1.1092e-01,  1.3686e-01],
         [ 8.2217e-02,  1.1550e-01],
         [ 6.9963e-02,  1.0355e-01],
         [ 1.0951e-01,  1.1759e-01],
         [ 9.5126e-02,  1.4113e-01],
         [ 1.0214e-01,  1.4775e-01],
         [ 1.2009e-01,  1.6022e-01],
         [ 1.2843e-01,  1.6139e-01],
         [ 1.2783e-01,  1.5004e-01],
         [ 1.3372e-01,  1.5108e-01],
         [ 1.1717e-01,  1.3917e-01],
         [ 6.6029e-02,  9.7992e-02],
         [ 1.1056e-01,  1.2266e-01],
         [ 1.0994e-01,  8.0383e-02],
         [ 1.1866e-01,  2.1005e-02],
         [ 9.2700e-02,  4.1413e-02],
         [ 1.1245e-01,  5.0752e-02],
         [ 9.9266e-02,  5.4425e-02],
         [ 7.0981e-02,  5.5606e-02],
         [ 8.9015e-02,  5.5785e-02],
         [ 9.0283e-02,  5.5652e-02],
         [ 8.1918e-02,  5.5501e-02],
         [ 1.0532e-01,  5.5357e-02],
         [ 1.1507e-01,  5.5283e-02],
         [ 7.3645e-02,  5.5240e-02],
         [ 9.6077e-02,  5.5211e-02],
         [ 1.0314e-01,  5.5201e-02],
         [ 1.0504e-01,  5.5186e-02],
         [ 1.0541e-01,  5.5224e-02],
         [ 1.2062e-01,  5.5188e-02],
         [ 1.2864e-01,  5.5218e-02],
         [ 8.9784e-02,  5.5211e-02],
         [ 1.1386e-01,  5.5213e-02],
         [ 9.8002e-02,  5.5221e-02],
         [ 1.1383e-01,  5.5229e-02],
         [ 9.5636e-02,  5.5232e-02],
         [ 1.0852e-01,  5.5230e-02],
         [ 1.2335e-01,  5.5231e-02],
         [ 1.2061e-01,  5.5231e-02],
         [ 1.0021e-01,  5.5236e-02],
         [ 1.0882e-01,  5.5235e-02],
         [ 9.1663e-02,  5.5232e-02],
         [ 1.2479e-01,  5.5232e-02],
         [ 7.6210e-02,  5.5231e-02],
         [ 5.6913e-02,  5.5231e-02],
         [ 8.7737e-02,  5.5231e-02],
         [ 1.0439e-01,  5.5231e-02],
         [-8.7360e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(6.5715e-06, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0010, device='cuda:0')
mixer_td_error tensor(0.6991, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4608, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4343, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0650, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1942, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0186, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2830188.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2024, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.6842e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1320, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0873, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1320, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17506
target_mac_out tensor([[[[-1.0000e+07, -5.8559e-02,  7.0205e-02,  ...,  3.3037e-03,
            1.2681e-01, -1.0000e+07],
          [-1.0000e+07, -1.1905e-02,  9.0702e-02,  ...,  2.1295e-02,
            1.3136e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3382e-02,  7.9674e-02,  ...,  2.9347e-03,
            1.4357e-01, -1.0000e+07],
          [-1.0000e+07, -1.6607e-02,  1.1113e-01,  ...,  2.2597e-03,
            1.2947e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.8440e-02,  5.7460e-02,  ..., -4.9726e-03,
            1.5747e-01, -1.0000e+07],
          [-1.0000e+07, -3.3268e-02,  6.1468e-02,  ...,  2.8033e-02,
            1.5274e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.2218e-01,  1.1603e-01,  ...,  8.8825e-02,
            1.9273e-01, -3.4327e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.9542e-01,  7.0641e-02,  ...,  8.0455e-02,
            1.5643e-01, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.5650e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.7838e-02,  6.9213e-02,  ...,  2.5948e-02,
            1.4096e-01, -1.0000e+07],
          [-1.0000e+07, -1.4399e-02,  1.0899e-01,  ...,  1.2967e-03,
            1.3024e-01, -1.0000e+07]],

         [[-1.0000e+07, -5.7245e-02,  7.9477e-02,  ...,  3.3060e-02,
            1.4031e-01, -1.0000e+07],
          [-1.0000e+07, -1.3393e-02,  1.0346e-01,  ...,  1.0057e-02,
            1.4004e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.0205e-02,  9.0702e-02],
         [ 7.9674e-02,  1.1113e-01],
         [ 5.7460e-02,  2.8033e-02],
         [ 5.2195e-02, -1.7950e-02],
         [ 3.7389e-02, -4.4145e-02],
         [ 9.2285e-02,  4.8128e-02],
         [ 1.4096e-01,  3.3656e-02],
         [ 1.6714e-01,  7.7641e-02],
         [ 1.2319e-01,  1.1045e-01],
         [ 1.0087e-01,  1.3892e-01],
         [ 1.0282e-01,  1.5236e-01],
         [ 8.4418e-02,  1.2944e-01],
         [ 8.6654e-02,  1.2305e-01],
         [ 7.0944e-02,  1.4173e-01],
         [ 8.9887e-02,  1.2287e-01],
         [ 6.5322e-02,  1.3889e-01],
         [ 9.8309e-02,  1.6250e-01],
         [ 1.0943e-01,  1.1874e-01],
         [ 1.0969e-01,  1.0469e-01],
         [ 1.2822e-01,  1.4224e-01],
         [ 1.5813e-01,  1.2451e-01],
         [ 1.7510e-01,  1.1136e-01],
         [ 1.8255e-01,  1.5612e-01],
         [ 1.4230e-01,  1.6958e-01],
         [ 1.4571e-01,  1.6495e-01],
         [ 1.2951e-01,  1.3509e-01],
         [ 1.6287e-01,  1.6685e-01],
         [ 1.7633e-01,  1.6216e-01],
         [ 1.7510e-01,  1.2900e-01],
         [ 1.3645e-01,  1.6227e-01],
         [ 1.6178e-01,  1.2986e-01],
         [ 1.7149e-01,  1.5448e-01],
         [ 1.7263e-01,  1.6642e-01],
         [ 1.2707e-01,  1.2379e-01],
         [ 1.2787e-01,  1.6267e-01],
         [ 1.6779e-01,  1.7743e-01],
         [ 1.8064e-01,  1.0716e-01],
         [-2.4356e-02,  7.1372e-02],
         [ 6.1634e-03,  7.6674e-02],
         [ 1.6477e-01,  8.9389e-02],
         [ 1.1265e-01,  7.3313e-02],
         [ 1.1163e-01,  1.0128e-01],
         [ 1.1182e-01,  1.3546e-01],
         [ 1.1236e-01,  1.0747e-01],
         [ 6.0105e-02,  9.8160e-02],
         [ 7.4719e-02,  1.2087e-01],
         [ 8.1573e-02,  1.2477e-01],
         [ 8.5105e-02,  1.3221e-01],
         [ 6.3845e-02,  1.2586e-01],
         [ 7.0164e-02,  8.6331e-02],
         [ 7.4526e-02,  1.1606e-01],
         [ 1.0302e-01,  1.3563e-01],
         [ 1.0192e-01,  1.4440e-01],
         [ 9.6997e-02, -2.2417e-02],
         [ 1.0086e-01,  2.0640e-02],
         [-6.7975e-02,  4.0824e-02],
         [ 7.7575e-02,  4.9666e-02],
         [ 7.9310e-02,  5.3332e-02],
         [ 9.1781e-02,  5.4708e-02],
         [ 9.9900e-02,  5.5190e-02],
         [ 7.8142e-02,  5.5286e-02],
         [ 8.1120e-02,  5.5262e-02],
         [ 7.9033e-02,  5.5242e-02],
         [ 6.4642e-02,  5.5228e-02],
         [ 7.2620e-02,  5.5201e-02],
         [ 6.1578e-02,  5.5180e-02],
         [ 5.8466e-02,  5.5216e-02],
         [ 6.9814e-02,  5.5211e-02],
         [ 1.0164e-01,  5.5204e-02],
         [ 9.2112e-02,  5.5218e-02],
         [ 6.2117e-02,  5.5218e-02],
         [ 1.0774e-01,  5.5213e-02],
         [ 1.0443e-01,  5.5222e-02],
         [ 7.0555e-02,  5.5228e-02],
         [ 9.5771e-02,  5.5229e-02],
         [ 9.3458e-02,  5.5233e-02],
         [ 1.0013e-01,  5.5235e-02],
         [ 6.5921e-02,  5.5235e-02],
         [ 6.6639e-02,  5.5232e-02],
         [ 5.6191e-02,  5.5231e-02],
         [ 6.7671e-02,  5.5231e-02],
         [ 6.3217e-02,  5.5231e-02],
         [ 5.9322e-02,  5.5231e-02],
         [ 7.2676e-02,  5.5231e-02],
         [ 6.6741e-02,  5.5231e-02],
         [ 7.8602e-02,  5.5231e-02],
         [ 8.5976e-02,  5.5231e-02],
         [ 9.0356e-02,  5.5231e-02],
         [ 9.2933e-02,  5.5231e-02],
         [ 7.4840e-02,  5.5231e-02],
         [ 9.9034e-02,  5.5231e-02],
         [ 8.1550e-02,  5.5231e-02],
         [ 6.7384e-02,  5.5231e-02],
         [ 8.9860e-02,  5.5231e-02],
         [ 1.0093e-01,  5.5231e-02],
         [ 9.4762e-02,  5.5231e-02],
         [ 1.0072e-01,  5.5231e-02],
         [ 1.0375e-01,  5.5231e-02],
         [ 1.0612e-01,  5.5231e-02],
         [ 6.9198e-02,  5.5231e-02],
         [ 9.3882e-02,  5.5231e-02],
         [ 1.0288e-01,  5.5231e-02],
         [ 8.3422e-02,  5.5231e-02],
         [ 7.4192e-02,  5.5231e-02],
         [ 1.0755e-01,  5.5231e-02],
         [ 1.2109e-01,  5.5231e-02],
         [ 9.8501e-02,  5.5231e-02],
         [ 1.0300e-01,  5.5231e-02],
         [ 1.1665e-01,  5.5231e-02],
         [ 8.9919e-02,  5.5231e-02],
         [ 9.9790e-02,  5.5231e-02],
         [ 1.0759e-01,  5.5231e-02],
         [ 9.5090e-02,  5.5231e-02],
         [ 8.8522e-02,  5.5231e-02],
         [ 9.7505e-02,  5.5231e-02],
         [ 5.9807e-02,  5.5231e-02],
         [ 7.9994e-02,  5.5231e-02],
         [ 6.3079e-02,  5.5231e-02],
         [ 7.7705e-02,  5.5231e-02],
         [ 1.1603e-01,  5.5231e-02],
         [ 7.0641e-02,  5.5231e-02],
         [ 1.5650e-02,  5.5231e-02]],

        [[ 9.6186e-02,  8.7099e-02],
         [ 6.9213e-02,  1.0899e-01],
         [ 7.9477e-02,  1.0346e-01],
         [ 9.4588e-02,  1.3402e-01],
         [ 1.0047e-01,  1.2302e-01],
         [ 6.1462e-02, -4.9519e-02],
         [ 1.0250e-01,  1.1286e-01],
         [ 1.1912e-01,  1.1130e-01],
         [ 1.1392e-01,  1.3568e-01],
         [ 6.7499e-02, -1.5380e-02],
         [ 8.5747e-02,  1.5352e-01],
         [ 1.0806e-01, -3.4293e-02],
         [ 1.0113e-01, -3.4341e-02],
         [ 1.0316e-01, -4.9212e-02],
         [ 1.0721e-01,  1.0173e-01],
         [ 1.2588e-01,  1.0544e-01],
         [ 1.5854e-01,  1.0491e-01],
         [ 1.6941e-01,  6.4716e-02],
         [ 1.8220e-01,  8.7938e-02],
         [-1.7373e-02,  5.5530e-02],
         [ 1.6643e-01,  1.0031e-01],
         [ 1.2860e-01,  1.1410e-01],
         [ 1.3917e-01,  1.5399e-01],
         [ 1.2308e-01,  1.7211e-01],
         [ 1.1492e-01,  1.5424e-01],
         [ 9.4194e-02,  1.4319e-01],
         [ 7.5796e-02,  8.8144e-02],
         [ 8.9076e-02,  1.2815e-01],
         [ 1.0228e-01,  1.1005e-01],
         [ 1.2923e-01,  1.4497e-01],
         [ 1.4316e-01,  1.3877e-01],
         [ 1.3791e-01,  1.0917e-01],
         [ 1.0510e-01,  1.0033e-01],
         [ 8.6649e-02,  1.4105e-01],
         [ 7.0371e-02,  1.0673e-01],
         [ 1.0227e-01,  8.0218e-02],
         [ 1.2822e-01,  5.1538e-02],
         [ 1.0580e-01,  6.6828e-02],
         [ 1.2761e-01,  4.4473e-02],
         [ 1.6213e-01,  7.8023e-02],
         [ 1.9279e-01,  5.0455e-02],
         [ 9.8371e-02,  4.4637e-02],
         [ 1.5320e-01,  2.9010e-02],
         [ 1.1527e-01,  4.6689e-02],
         [ 1.1486e-01,  5.3856e-02],
         [ 9.8972e-02,  5.6210e-02],
         [ 9.4310e-03,  5.6568e-02],
         [ 1.1824e-01,  5.6340e-02],
         [ 1.2858e-01,  5.5960e-02],
         [ 3.3153e-02,  5.5660e-02],
         [ 1.2935e-01,  5.5416e-02],
         [ 7.7635e-02,  5.5306e-02],
         [ 5.7271e-02,  5.5236e-02],
         [ 1.3882e-01,  5.5216e-02],
         [ 9.8298e-02,  5.5202e-02],
         [ 9.5547e-02,  5.5176e-02],
         [ 1.1643e-01,  5.5217e-02],
         [ 1.1111e-01,  5.5210e-02],
         [ 1.0847e-01,  5.5201e-02],
         [ 1.4190e-01,  5.5195e-02],
         [ 1.5536e-01,  5.5203e-02],
         [ 1.1657e-01,  5.5221e-02],
         [ 6.3624e-02,  5.5229e-02],
         [ 8.6051e-02,  5.5231e-02],
         [ 1.2040e-02,  5.5230e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-8.1405e-06, device='cuda:0') tensor(0.0008, device='cuda:0') tensor(-0.0015, device='cuda:0')
mixer_td_error tensor(0.5763, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4584, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4969, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0642, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1984, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0318, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2336065.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1928, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.4549e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0008, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1229, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1336, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1229, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17552
target_mac_out tensor([[[[-1.0000e+07, -6.0082e-02,  8.4218e-02,  ...,  2.3512e-02,
            1.2572e-01, -1.0000e+07],
          [-1.0000e+07, -1.1235e-02,  1.0290e-01,  ...,  6.8675e-03,
            1.2423e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2186e-02,  7.5614e-02,  ..., -6.4896e-03,
            1.3925e-01, -1.0000e+07],
          [-1.0000e+07, -3.0528e-02,  1.3220e-01,  ..., -2.5162e-03,
            1.4641e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.1680e-02,  6.1318e-02,  ...,  5.7171e-03,
            1.3834e-01, -1.0000e+07],
          [-1.0000e+07, -3.8335e-02,  1.1561e-01,  ..., -3.7671e-02,
            1.4580e-01, -1.0000e+07]],

         ...,

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.8459e-01, -1.0000e+07,  ..., -1.0000e+07,
            2.3061e-01, -3.2610e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.6795e-01, -1.0000e+07,  ...,  6.2288e-02,
            2.1905e-01, -3.0672e-01]],

         [[ 5.0009e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 7.7470e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -7.5802e-02,  9.7167e-02,  ...,  2.8398e-02,
            1.3939e-01, -1.0000e+07],
          [-1.0000e+07, -5.1416e-02,  1.3964e-01,  ...,  6.0821e-02,
            1.3809e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1286e-02,  1.0614e-01,  ...,  1.6455e-02,
            1.3793e-01, -1.0000e+07],
          [-1.0000e+07, -7.4754e-02,  1.1807e-01,  ...,  2.5651e-02,
            1.4845e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2690e-01,  1.3171e-01,  ...,  5.1203e-02,
            1.4700e-01, -1.0000e+07],
          [-1.0000e+07, -1.0865e-01,  1.4638e-01,  ...,  6.3063e-02,
            1.6674e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 8.4218e-02,  1.0290e-01],
         [ 7.5614e-02,  1.3220e-01],
         [ 6.1318e-02,  1.1561e-01],
         [ 9.0288e-02,  1.1854e-01],
         [ 1.0589e-01,  1.2057e-01],
         [ 1.1571e-01, -6.2254e-02],
         [ 1.2393e-01, -4.8233e-02],
         [ 1.3731e-01, -4.2145e-02],
         [ 1.0357e-01,  7.1333e-02],
         [ 1.3475e-01,  6.0568e-02],
         [ 1.3355e-01, -3.7361e-02],
         [ 1.1020e-01, -4.7837e-02],
         [ 8.5822e-02,  1.0021e-01],
         [ 6.3921e-02, -4.7452e-02],
         [ 9.4012e-02, -5.5321e-02],
         [ 1.0645e-01, -2.6922e-02],
         [ 1.1206e-01, -4.3624e-02],
         [ 7.7325e-02, -2.8668e-02],
         [ 1.0274e-01, -2.5490e-02],
         [ 1.1183e-01, -2.6401e-02],
         [ 1.3467e-01, -2.8122e-02],
         [ 1.1133e-01, -4.1610e-02],
         [ 7.3602e-02, -2.7499e-02],
         [ 1.1514e-01, -2.5269e-02],
         [ 1.2919e-01,  9.2943e-02],
         [ 1.2503e-01,  1.0297e-01],
         [ 9.7167e-02, -4.7410e-02],
         [-1.5443e-02, -4.1419e-02],
         [ 1.8301e-02, -2.3847e-02],
         [ 3.5826e-02, -4.5049e-02],
         [ 4.4242e-02,  9.3067e-02],
         [ 4.8009e-02,  7.2052e-02],
         [ 4.9535e-02,  4.4620e-02],
         [ 5.0047e-02,  6.6528e-02],
         [ 5.0158e-02,  4.9998e-02],
         [ 5.0142e-02,  8.3152e-02],
         [ 5.0089e-02,  5.4268e-02],
         [ 5.0048e-02,  8.2765e-02],
         [ 5.0041e-02,  4.8447e-02],
         [ 5.0009e-02,  5.5372e-02],
         [ 5.0008e-02,  8.1630e-02],
         [ 5.0024e-02,  5.2350e-02],
         [ 5.0012e-02,  3.9359e-02],
         [ 5.0024e-02,  7.2941e-02],
         [ 5.0013e-02,  8.8419e-02],
         [ 5.0016e-02,  1.1234e-01],
         [ 5.0015e-02,  6.4578e-02],
         [ 5.0010e-02,  7.6542e-02],
         [ 5.0006e-02,  9.2320e-02],
         [ 5.0007e-02,  9.8535e-02],
         [ 5.0007e-02,  7.4386e-02],
         [ 5.0007e-02,  1.0060e-01],
         [ 5.0008e-02,  1.2008e-01],
         [ 5.0008e-02,  7.4618e-02],
         [ 5.0009e-02,  6.5466e-02],
         [ 5.0008e-02,  5.9879e-02],
         [ 5.0008e-02,  5.6385e-02],
         [ 5.0008e-02,  5.0268e-02],
         [ 5.0008e-02,  9.0650e-02],
         [ 5.0009e-02,  5.8117e-02],
         [ 5.0009e-02,  9.4006e-02],
         [ 5.0009e-02,  9.9937e-02],
         [ 5.0009e-02,  6.6133e-02],
         [ 5.0009e-02,  8.1864e-02],
         [ 5.0009e-02,  4.7732e-02],
         [ 5.0009e-02,  5.8812e-02],
         [ 5.0009e-02,  7.1442e-02],
         [ 5.0009e-02,  2.3061e-01],
         [ 5.0009e-02,  6.2288e-02],
         [ 5.0009e-02,  7.7470e-03]],

        [[ 9.7167e-02,  1.3964e-01],
         [ 1.0614e-01,  1.1807e-01],
         [ 1.3171e-01,  1.4638e-01],
         [ 1.4077e-01,  1.3885e-01],
         [ 1.3399e-01,  1.4236e-01],
         [ 1.4106e-01,  1.3536e-01],
         [ 1.3648e-01,  1.3286e-01],
         [ 9.7291e-02,  1.2066e-01],
         [ 8.6512e-02,  9.6733e-02],
         [ 7.4627e-02,  1.1045e-01],
         [ 1.1000e-01,  6.2720e-02],
         [ 1.1607e-01,  1.9595e-01],
         [ 9.3101e-02,  8.0065e-02],
         [ 1.2072e-01,  5.5170e-02],
         [ 1.3794e-01,  4.5477e-02],
         [ 1.0265e-01,  3.8140e-02],
         [ 1.3278e-01,  3.7748e-02],
         [ 1.3374e-01,  4.4801e-02],
         [ 1.4599e-01,  7.5280e-02],
         [ 1.4032e-01,  8.9685e-02],
         [ 1.0616e-01,  7.7439e-02],
         [ 1.2427e-01,  8.6828e-02],
         [ 1.2524e-01,  5.9067e-02],
         [ 1.4370e-01,  8.1439e-02],
         [ 1.3809e-01,  5.5436e-02],
         [ 1.2904e-01,  2.0060e-01],
         [ 1.2677e-01, -1.1758e-01],
         [ 1.2428e-01,  7.5873e-02],
         [ 1.0498e-01,  2.3203e-01],
         [ 4.7730e-04,  8.8629e-02],
         [ 2.5485e-02,  9.7880e-02],
         [ 3.9696e-02,  7.7548e-02],
         [ 4.6562e-02,  5.4337e-02],
         [ 4.9447e-02,  8.9221e-02],
         [ 5.0429e-02,  6.6573e-02],
         [ 5.0588e-02,  7.4304e-02],
         [ 5.0490e-02,  8.3573e-02],
         [ 5.0356e-02,  8.4941e-02],
         [ 5.0216e-02, -2.1360e-01],
         [ 5.0162e-02,  6.7392e-02],
         [ 5.0074e-02, -2.1566e-01],
         [ 5.0055e-02, -1.9543e-01],
         [ 5.0041e-02, -2.0157e-01],
         [ 5.0034e-02,  6.4339e-02],
         [ 5.0024e-02,  8.6536e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.8707e-05, device='cuda:0') tensor(0.0020, device='cuda:0') tensor(-0.0017, device='cuda:0')
mixer_td_error tensor(0.4513, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4582, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7228, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0528, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2007, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0309, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1785714.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2320, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.5238e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2151, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2455, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2151, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17600
target_mac_out tensor([[[[-1.0000e+07, -5.9256e-02,  7.4276e-02,  ...,  6.9633e-03,
            1.2304e-01, -1.0000e+07],
          [-1.0000e+07, -4.8886e-02,  1.4162e-01,  ...,  5.8303e-02,
            1.3678e-01, -1.0000e+07]],

         [[-1.0000e+07, -6.9711e-02,  8.6010e-02,  ...,  5.5065e-03,
            1.3727e-01, -1.0000e+07],
          [-1.0000e+07, -4.5321e-02,  1.0753e-01,  ...,  3.5616e-02,
            1.4810e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3339e-02,  9.1828e-02,  ...,  2.0462e-03,
            1.4069e-01, -1.0000e+07],
          [-1.0000e+07, -7.9815e-02,  1.4915e-01,  ...,  6.6216e-02,
            1.5396e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.5231e-01, -1.0000e+07,  ...,  5.0563e-02,
           -1.0000e+07, -2.4795e-01],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.5209e-01, -1.0000e+07,  ...,  4.3539e-02,
           -1.0000e+07, -2.3541e-01],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.6921e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2205e-01,  1.1988e-01,  ...,  6.8454e-02,
            1.6031e-01, -1.0000e+07],
          [-1.0000e+07, -1.9420e-02,  1.0915e-01,  ...,  3.4743e-02,
            1.3353e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.1937e-01,  9.4539e-02,  ...,  5.6656e-02,
            1.5891e-01, -1.0000e+07],
          [-1.0000e+07, -4.5652e-02,  1.3888e-01,  ...,  5.1154e-02,
            1.4027e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 7.4276e-02,  1.4162e-01],
         [ 8.6010e-02,  1.0753e-01],
         [ 9.1828e-02,  1.4915e-01],
         [ 1.0444e-01,  1.6115e-01],
         [ 8.1765e-02,  1.7010e-01],
         [ 9.0029e-02,  1.4649e-01],
         [ 1.1421e-01,  1.0467e-01],
         [ 8.0933e-02,  1.2112e-01],
         [ 9.2055e-02,  1.3186e-01],
         [ 8.4177e-02,  1.1291e-01],
         [ 9.5572e-02,  1.2795e-01],
         [ 6.3941e-02,  1.0724e-01],
         [ 5.0269e-02,  9.9236e-02],
         [ 7.7802e-02,  7.2083e-02],
         [ 7.2157e-02,  5.9652e-02],
         [ 9.9830e-02,  7.4247e-02],
         [ 1.0216e-01, -2.1373e-01],
         [ 1.0291e-01, -2.2152e-01],
         [ 1.2350e-01,  8.4755e-02],
         [ 1.3306e-01, -2.2101e-01],
         [ 1.3041e-01, -2.2803e-01],
         [ 1.4218e-01,  8.5723e-02],
         [ 1.4388e-01,  2.6814e-01],
         [ 1.4179e-01,  2.6601e-01],
         [ 1.3621e-01, -2.1679e-01],
         [ 1.3474e-01,  2.5791e-01],
         [ 1.0183e-01,  1.1306e-01],
         [ 1.1285e-01,  1.5033e-01],
         [ 9.4342e-02,  1.4517e-01],
         [ 8.4264e-02, -2.3395e-02],
         [ 7.1114e-02,  1.9335e-02],
         [ 6.7057e-02,  4.0051e-02],
         [ 1.0769e-01,  4.9306e-02],
         [ 7.4508e-02,  5.3164e-02],
         [ 1.0000e-01,  5.4641e-02],
         [ 1.1326e-01,  5.5132e-02],
         [ 8.5007e-02,  5.5265e-02],
         [ 1.2458e-01,  5.5261e-02],
         [ 1.2883e-01,  5.5249e-02],
         [ 8.6796e-02,  5.5220e-02],
         [ 1.0732e-01,  5.5210e-02],
         [ 1.3785e-01,  5.5211e-02],
         [ 5.9416e-02,  5.5218e-02],
         [ 5.6236e-02,  5.5214e-02],
         [ 1.3241e-01,  5.5193e-02],
         [ 9.0256e-02,  5.5215e-02],
         [ 1.1013e-01,  5.5212e-02],
         [ 5.3809e-02,  5.5203e-02],
         [ 1.2611e-01,  5.5221e-02],
         [ 6.4353e-02,  5.5227e-02],
         [ 5.0563e-02,  5.5232e-02],
         [ 4.3539e-02,  5.5230e-02],
         [ 3.6921e-03,  5.5230e-02]],

        [[ 1.0780e-01,  8.9914e-02],
         [ 1.1988e-01,  1.0915e-01],
         [ 9.4539e-02,  1.3888e-01],
         [ 1.1262e-01,  1.4947e-01],
         [ 1.3585e-01,  1.2308e-01],
         [ 1.1487e-01,  1.2481e-01],
         [ 1.2275e-01,  1.0491e-01],
         [ 1.4212e-01,  1.9513e-01],
         [ 1.3474e-01,  5.1943e-02],
         [ 1.5200e-01,  1.0832e-01],
         [ 1.5458e-01,  1.2840e-01],
         [ 1.3206e-01,  1.6635e-01],
         [ 1.5653e-01,  1.3702e-01],
         [ 1.7039e-01,  1.1830e-01],
         [ 1.5652e-01,  8.7195e-02],
         [ 1.3996e-01, -1.1168e-01],
         [ 1.2597e-01, -1.2576e-01],
         [ 1.1951e-01,  1.0390e-01],
         [ 1.1933e-01,  8.6694e-02],
         [ 1.1578e-01,  1.0688e-01],
         [ 1.5850e-01,  1.5001e-01],
         [-1.6899e-02,  1.3430e-01],
         [ 1.5797e-02,  1.2504e-01],
         [ 3.3799e-02,  8.1255e-02],
         [ 4.2970e-02,  5.8857e-02],
         [ 4.7334e-02,  5.5341e-02],
         [ 4.9274e-02,  9.7146e-02],
         [ 5.0034e-02,  7.0917e-02],
         [ 5.0254e-02,  5.8782e-02],
         [ 5.0270e-02,  8.7550e-02],
         [ 5.0202e-02,  1.1000e-01],
         [ 5.0136e-02,  7.3112e-02],
         [ 5.0107e-02,  8.6480e-02],
         [ 5.0085e-02,  1.0361e-01],
         [ 5.0057e-02,  6.3217e-02],
         [ 5.0038e-02,  8.9962e-02],
         [ 5.0028e-02,  6.2150e-02],
         [ 5.0026e-02,  9.1180e-02],
         [ 5.0018e-02,  5.8613e-02],
         [ 5.0018e-02,  8.6638e-02],
         [ 5.0019e-02,  5.5606e-02],
         [ 5.0016e-02,  6.9119e-02],
         [ 5.0005e-02,  3.6899e-02],
         [ 5.0007e-02,  2.7276e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.7499e-05, device='cuda:0') tensor(0.0022, device='cuda:0') tensor(-0.0027, device='cuda:0')
mixer_td_error tensor(0.2280, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4560, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8416, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0667, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2053, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0374, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-849056.4375, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2681, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0021, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2668, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2344, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2668, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17646
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3285e-02,  8.7210e-02,  ..., -7.6795e-03,
            1.4393e-01, -1.0000e+07],
          [-1.0000e+07, -2.8180e-02,  9.9658e-02,  ..., -1.6816e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5860e-02,  1.0411e-01,  ...,  2.0191e-02,
            1.7078e-01, -1.0000e+07],
          [-1.0000e+07, -2.5520e-02,  1.0800e-01,  ...,  9.6872e-03,
            1.3684e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -4.8078e-02,  9.2300e-02,  ...,  1.9919e-02,
            1.2230e-01, -1.0000e+07],
          [-1.0000e+07, -2.1879e-02,  8.8635e-02,  ..., -1.2299e-02,
            1.2527e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.8397e-02,  1.2205e-01,  ...,  5.0119e-02,
            1.4587e-01, -1.0000e+07],
          [-1.0000e+07, -3.9020e-02,  1.1618e-01,  ..., -7.4191e-03,
            1.4128e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.2644e-01,  1.3415e-01,  ...,  6.4702e-02,
            1.5760e-01, -1.0000e+07],
          [-1.0000e+07, -5.7588e-02,  1.3139e-01,  ..., -5.2821e-03,
            1.5137e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.4399e-01, -1.0000e+07,  ..., -1.0000e+07,
            2.0449e-01, -3.4176e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -2.0824e-01,  6.8108e-02,  ...,  8.9337e-02,
            1.7825e-01, -3.2950e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.8971e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02,  8.7099e-02],
         [ 8.7210e-02,  9.9658e-02],
         [ 1.0411e-01,  1.0800e-01],
         [ 8.4719e-02,  1.1353e-01],
         [ 1.1527e-01,  1.1500e-01],
         [ 1.3986e-01,  1.3945e-01],
         [ 1.5921e-01,  1.2947e-01],
         [ 1.8385e-01,  1.5109e-01],
         [ 1.9812e-01,  1.6420e-01],
         [ 2.0879e-01,  1.3194e-01],
         [ 2.1005e-01,  1.7221e-01],
         [ 6.9272e-02,  1.1014e-01],
         [ 1.7339e-01,  1.4619e-01],
         [ 1.6457e-01,  1.7519e-01],
         [ 1.6330e-01,  1.9288e-01],
         [ 1.4416e-01,  1.9414e-01],
         [ 1.3343e-01,  1.8718e-01],
         [ 1.1781e-01,  1.0292e-01],
         [ 1.5939e-01,  1.1416e-01],
         [-6.3937e-02,  7.5181e-02],
         [ 1.7852e-01,  1.0041e-01],
         [ 1.3769e-01,  7.2487e-02],
         [ 1.5594e-01,  1.0584e-01],
         [ 1.2068e-01,  1.1093e-01],
         [ 1.0612e-01,  1.1869e-01],
         [ 6.7176e-02,  8.0068e-02],
         [ 9.5707e-02,  1.0542e-01],
         [ 7.1136e-02,  1.1147e-01],
         [ 9.8581e-02,  9.3722e-02],
         [ 7.8331e-02,  2.4951e-01],
         [ 7.4457e-02,  2.3845e-01],
         [ 1.0869e-01,  2.3487e-01],
         [ 1.3879e-01,  2.1938e-01],
         [ 1.6416e-01,  3.5174e-02],
         [ 1.7761e-01,  2.9981e-02],
         [ 1.7199e-01, -3.1680e-03],
         [ 1.8096e-01,  3.0600e-02],
         [ 1.9578e-01,  4.5776e-02],
         [ 1.8672e-01,  5.2215e-02],
         [ 2.0169e-01,  5.4716e-02],
         [ 2.0767e-01,  5.5529e-02],
         [ 1.6171e-01,  5.5666e-02],
         [ 1.9383e-01,  5.5585e-02],
         [ 1.8742e-01,  5.5473e-02],
         [ 1.4716e-01,  5.5392e-02],
         [ 6.0349e-02,  5.5314e-02],
         [ 1.5688e-01,  5.5237e-02],
         [ 1.7954e-01,  5.5227e-02],
         [ 1.3839e-01,  5.5213e-02],
         [ 1.7126e-01,  5.5235e-02],
         [ 1.2922e-01,  5.5220e-02],
         [ 1.3455e-02,  5.5202e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 9.2300e-02,  8.8635e-02],
         [ 1.2205e-01,  1.1618e-01],
         [ 1.3415e-01,  1.3139e-01],
         [ 1.1418e-01,  1.3807e-01],
         [ 1.3666e-01,  1.0119e-01],
         [ 1.2979e-01,  1.5132e-01],
         [ 1.3766e-01,  1.0511e-01],
         [ 1.2405e-01,  8.3593e-02],
         [ 1.2914e-01,  1.1481e-01],
         [ 1.4678e-01,  8.7823e-02],
         [ 1.5151e-01,  5.5693e-02],
         [ 1.5354e-01,  1.1682e-01],
         [ 1.3256e-01,  8.6187e-02],
         [ 1.2411e-01,  6.7693e-02],
         [ 1.5870e-01,  8.8196e-02],
         [ 1.7231e-01,  9.9541e-02],
         [ 1.7973e-01,  9.4636e-02],
         [ 1.3946e-01,  9.2744e-02],
         [ 1.2066e-01,  9.2341e-02],
         [ 1.5598e-01,  9.4241e-02],
         [ 1.7545e-01,  1.0253e-01],
         [ 1.2910e-01,  1.3738e-01],
         [ 1.6552e-01,  8.0361e-02],
         [ 1.2646e-01,  8.2456e-02],
         [ 1.0931e-01,  8.6499e-02],
         [ 5.2923e-02,  7.4514e-02],
         [ 7.8707e-02,  6.8053e-02],
         [ 8.8756e-02,  5.1197e-02],
         [ 9.3734e-02,  7.7662e-02],
         [ 8.1232e-02,  9.2387e-02],
         [ 1.3933e-01,  1.0792e-01],
         [ 1.2248e-01,  1.1865e-01],
         [ 1.2687e-01,  1.3253e-01],
         [ 7.6212e-02,  1.0564e-01],
         [ 8.9694e-02,  9.7030e-02],
         [ 1.0013e-01,  1.0374e-01],
         [ 1.0498e-01,  1.0780e-01],
         [ 1.2727e-01,  7.6419e-02],
         [ 1.4401e-01,  7.3354e-02],
         [ 1.2110e-01,  4.1203e-02],
         [ 1.1116e-01,  2.3632e-02],
         [ 1.0742e-01,  5.4660e-02],
         [ 1.0907e-01,  7.2335e-02],
         [ 9.8528e-02,  3.7120e-02],
         [ 5.0165e-02,  3.1320e-02],
         [ 8.9971e-02,  4.5189e-02],
         [ 1.0281e-01,  7.9072e-02],
         [ 1.3528e-01,  9.1966e-02],
         [ 1.4874e-01,  1.0657e-01],
         [ 1.2211e-01,  8.6875e-02],
         [ 1.1152e-01,  1.7306e-02],
         [ 1.0598e-01,  4.2123e-02],
         [ 1.0402e-01,  5.2850e-02],
         [ 7.8172e-02,  5.6614e-02],
         [ 9.3742e-02,  5.7340e-02],
         [ 7.3944e-02,  5.7046e-02],
         [ 9.1650e-02,  5.6502e-02],
         [ 7.2594e-02,  5.6007e-02],
         [ 1.1061e-01,  5.5699e-02],
         [ 7.4002e-02,  5.5461e-02],
         [ 9.7123e-02,  5.5315e-02],
         [-1.0580e-01,  5.5253e-02],
         [ 9.3767e-02,  5.5218e-02],
         [ 6.5077e-02,  5.5219e-02],
         [ 8.1593e-02,  5.5207e-02],
         [ 9.9401e-02,  5.5211e-02],
         [ 8.9478e-02,  5.5220e-02],
         [ 6.6104e-02,  5.5217e-02],
         [ 9.0731e-02,  5.5211e-02],
         [ 9.6611e-02,  5.5219e-02],
         [ 8.9737e-02,  5.5227e-02],
         [ 8.5004e-02,  5.5232e-02],
         [ 9.3975e-02,  5.5230e-02],
         [ 8.6543e-02,  5.5230e-02],
         [ 9.5601e-02,  5.5231e-02],
         [ 7.5986e-02,  5.5236e-02],
         [ 8.0965e-02,  5.5235e-02],
         [-8.0739e-02,  5.5232e-02],
         [ 8.4879e-02,  5.5232e-02],
         [ 8.3835e-02,  5.5231e-02],
         [-7.7986e-02,  5.5231e-02],
         [-8.2642e-02,  5.5231e-02],
         [ 9.9517e-02,  5.5231e-02],
         [ 7.8650e-02,  5.5231e-02],
         [ 9.4857e-02,  5.5231e-02],
         [ 9.9875e-02,  5.5231e-02],
         [ 8.8410e-02,  5.5231e-02],
         [ 9.5159e-02,  5.5231e-02],
         [ 7.2861e-02,  5.5231e-02],
         [ 9.0453e-02,  5.5231e-02],
         [ 9.6923e-02,  5.5231e-02],
         [ 9.9650e-02,  5.5231e-02],
         [ 7.5209e-02,  5.5231e-02],
         [ 9.1729e-02,  5.5231e-02],
         [ 1.0025e-01,  5.5231e-02],
         [ 1.0349e-01,  5.5231e-02],
         [ 1.0418e-01,  5.5231e-02],
         [ 1.0404e-01,  5.5231e-02],
         [ 9.0750e-02,  5.5231e-02],
         [ 9.6639e-02,  5.5231e-02],
         [ 1.1559e-01,  5.5231e-02],
         [ 1.2433e-01,  5.5231e-02],
         [ 1.2772e-01,  5.5231e-02],
         [ 9.8680e-02,  5.5231e-02],
         [ 1.1596e-01,  5.5231e-02],
         [ 7.4328e-02,  5.5231e-02],
         [ 7.1010e-02,  5.5231e-02],
         [-1.0230e-01,  5.5231e-02],
         [ 7.8761e-02,  5.5231e-02],
         [ 9.4261e-02,  5.5231e-02],
         [ 1.0021e-01,  5.5231e-02],
         [ 7.7070e-02,  5.5231e-02],
         [ 9.3515e-02,  5.5231e-02],
         [ 8.9277e-02,  5.5231e-02],
         [ 8.6102e-02,  5.5231e-02],
         [ 6.8942e-02,  5.5231e-02],
         [ 8.9622e-02,  5.5231e-02],
         [ 9.8996e-02,  5.5231e-02],
         [ 6.5669e-02,  5.5231e-02],
         [ 8.2001e-02,  5.5231e-02],
         [ 9.5689e-02,  5.5231e-02],
         [ 1.0208e-01,  5.5231e-02],
         [-1.0667e-01,  5.5231e-02],
         [ 6.9913e-02,  5.5231e-02],
         [ 6.2250e-02,  5.5231e-02],
         [ 9.0043e-02,  5.5231e-02],
         [ 9.0342e-02,  5.5231e-02],
         [ 8.7564e-02,  5.5231e-02],
         [ 9.5889e-02,  5.5231e-02],
         [ 8.0277e-02,  5.5231e-02],
         [ 6.9664e-02,  5.5231e-02],
         [ 9.1117e-02,  5.5231e-02],
         [ 9.8632e-02,  5.5231e-02],
         [ 1.0245e-01,  5.5231e-02],
         [ 8.2296e-02,  5.5231e-02],
         [ 8.6912e-02,  5.5231e-02],
         [ 8.6497e-02,  5.5231e-02],
         [-9.8753e-02,  5.5231e-02],
         [-6.9422e-02,  5.5231e-02],
         [-7.3750e-02,  5.5231e-02],
         [-8.6237e-02,  5.5231e-02],
         [-7.7537e-02,  5.5231e-02],
         [-9.2011e-02,  5.5231e-02],
         [-7.4328e-02,  5.5231e-02],
         [-7.5996e-02,  5.5231e-02],
         [ 6.7252e-02,  5.5231e-02],
         [ 8.9558e-02,  5.5231e-02],
         [ 9.6935e-02,  5.5231e-02],
         [ 9.9741e-02,  5.5231e-02],
         [ 1.1775e-01,  5.5231e-02],
         [-1.2027e-01,  5.5231e-02],
         [ 1.1362e-01,  5.5231e-02],
         [ 1.2588e-01,  5.5231e-02],
         [ 1.0010e-01,  5.5231e-02],
         [ 1.1599e-01,  5.5231e-02],
         [ 1.0652e-01,  5.5231e-02],
         [ 1.0021e-01,  5.5231e-02],
         [ 1.1810e-01,  5.5231e-02],
         [ 1.2794e-01,  5.5231e-02],
         [ 1.1377e-01,  5.5231e-02],
         [ 1.1767e-01,  5.5231e-02],
         [ 1.4092e-01,  5.5231e-02],
         [ 1.3700e-01,  5.5231e-02],
         [ 1.4805e-01,  5.5231e-02],
         [ 1.2226e-01,  5.5231e-02],
         [ 1.3731e-01,  5.5231e-02],
         [ 1.2890e-01,  5.5231e-02],
         [ 9.6165e-02,  5.5231e-02],
         [ 1.0737e-01,  5.5231e-02],
         [ 8.3679e-02,  5.5231e-02],
         [ 2.0449e-01,  5.5231e-02],
         [ 6.8108e-02,  5.5231e-02],
         [ 2.8971e-03,  5.5231e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.0998e-06, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0013, device='cuda:0')
mixer_td_error tensor(0.8526, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4551, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9216, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0695, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1925, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0411, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3497109.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2495, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.2697e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2263, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1604, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2263, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17692
target_mac_out tensor([[[[-1.0000e+07, -4.8313e-02,  5.8068e-02,  ...,  3.4876e-02,
            1.1931e-01, -1.0000e+07],
          [-1.0000e+07, -6.8065e-03,  1.0699e-01,  ...,  4.3941e-03,
            1.2446e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5278e-02,  9.0873e-02,  ...,  2.5301e-02,
            1.4665e-01, -1.0000e+07],
          [-1.0000e+07, -2.5623e-02,  1.3376e-01,  ..., -4.3574e-03,
            1.4677e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1539e-02,  9.2270e-02,  ...,  3.6193e-02,
            1.4195e-01, -1.0000e+07],
          [-1.0000e+07, -3.4843e-02,  1.4889e-01,  ..., -1.2452e-02,
            1.5781e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -2.1414e-01,  1.2412e-01,  ...,  8.7058e-02,
            1.9353e-01, -3.3818e-01],
          [ 5.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.7946e-01,  9.8643e-02,  ...,  4.9281e-02,
            1.6479e-01, -3.2595e-01],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.7422e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.5231e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -5.4255e-02,  8.7945e-02,  ...,  2.1998e-02,
            1.2409e-01, -1.0000e+07],
          [-1.0000e+07, -2.5887e-02,  1.2012e-01,  ...,  1.5133e-02,
            1.3440e-01, -1.0000e+07]],

         [[-1.0000e+07, -1.0159e-01,  1.1950e-01,  ...,  5.1083e-02,
            1.4701e-01, -1.0000e+07],
          [-1.0000e+07, -4.0845e-02,  1.0690e-01,  ..., -1.9599e-02,
            1.3754e-01, -1.0000e+07]],

         [[-1.0000e+07, -9.9555e-02,  1.2774e-01,  ...,  3.8789e-02,
            1.4068e-01, -1.0000e+07],
          [-1.0000e+07, -5.0626e-02,  9.0328e-02,  ..., -3.6395e-02,
            1.4205e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 5.8068e-02,  1.0699e-01],
         [ 9.0873e-02,  1.3376e-01],
         [ 9.2270e-02,  1.4889e-01],
         [ 1.2320e-01,  1.5491e-01],
         [ 7.6660e-02, -6.0932e-02],
         [ 1.0569e-01, -7.5610e-02],
         [-5.5461e-02,  9.8456e-02],
         [ 1.0001e-01, -7.0759e-02],
         [-2.7127e-02,  8.7244e-02],
         [ 1.5717e-01, -7.3175e-02],
         [ 1.7142e-01,  1.0277e-01],
         [-5.1448e-02,  1.1809e-01],
         [-7.3581e-02,  1.3108e-01],
         [ 1.1054e-01,  1.3146e-01],
         [ 9.2545e-02,  1.2623e-01],
         [ 5.6812e-02,  1.2569e-01],
         [-2.1855e-02,  1.2255e-01],
         [ 1.5086e-01,  1.0308e-01],
         [-2.0174e-02,  6.9213e-02],
         [-2.5972e-03,  1.0072e-01],
         [-4.1549e-02,  6.1627e-02],
         [ 1.0490e-01,  9.5330e-02],
         [ 9.0425e-02,  1.0658e-01],
         [ 9.8593e-02,  6.2834e-02],
         [ 7.7521e-02,  5.2021e-02],
         [ 8.0921e-02,  5.1342e-02],
         [ 6.6889e-02,  3.7854e-02],
         [-6.6150e-02,  7.5099e-02],
         [-1.4789e-02,  6.8702e-02],
         [ 1.5062e-01,  7.5300e-02],
         [-4.9126e-02,  6.2751e-02],
         [ 1.0015e-01, -1.6372e-02],
         [-5.2439e-02,  2.3109e-02],
         [ 1.0826e-01,  4.2014e-02],
         [-4.9077e-02,  5.0433e-02],
         [-7.0830e-02,  5.3902e-02],
         [ 1.0819e-01,  5.5151e-02],
         [-9.7372e-02,  5.5480e-02],
         [ 1.3150e-01,  5.5476e-02],
         [ 1.4110e-01,  5.5379e-02],
         [ 1.1814e-01,  5.5323e-02],
         [ 8.9889e-02,  5.5253e-02],
         [ 6.7027e-02,  5.5212e-02],
         [ 9.1891e-02,  5.5212e-02],
         [ 1.1649e-01,  5.5197e-02],
         [ 1.2372e-01,  5.5236e-02],
         [ 1.4322e-01,  5.5209e-02],
         [ 1.3439e-01,  5.5210e-02],
         [ 9.7942e-02,  5.5211e-02],
         [ 1.3565e-01,  5.5212e-02],
         [ 1.4976e-01,  5.5223e-02],
         [ 1.5438e-01,  5.5231e-02],
         [ 1.4253e-01,  5.5230e-02],
         [ 1.1536e-01,  5.5230e-02],
         [ 8.6948e-02,  5.5230e-02],
         [ 1.0966e-01,  5.5236e-02],
         [ 1.1573e-01,  5.5235e-02],
         [ 1.2263e-01,  5.5232e-02],
         [ 1.2412e-01,  5.5232e-02],
         [ 9.8643e-02,  5.5231e-02],
         [ 1.7422e-02,  5.5231e-02]],

        [[ 8.7945e-02,  1.2012e-01],
         [ 1.1950e-01,  1.0690e-01],
         [ 1.2774e-01,  9.0328e-02],
         [ 1.3805e-01,  7.0355e-02],
         [ 1.2800e-01,  8.3134e-02],
         [ 1.4374e-01,  1.0650e-01],
         [ 1.4223e-01,  1.2825e-01],
         [ 1.7047e-01,  9.6369e-02],
         [ 1.8422e-01,  8.1832e-02],
         [ 1.5585e-01,  8.3019e-02],
         [ 1.4266e-01,  1.3378e-01],
         [ 1.4211e-01,  1.0558e-01],
         [ 1.7454e-01,  7.5837e-02],
         [ 1.8657e-01,  1.3739e-01],
         [ 1.6218e-01,  1.5535e-01],
         [ 1.7919e-01,  1.1648e-01],
         [ 1.6667e-01,  1.3811e-01],
         [ 1.4661e-01,  1.6153e-01],
         [ 1.6433e-01,  1.2665e-01],
         [ 1.2829e-01, -1.1997e-01],
         [ 1.1487e-01,  1.4319e-01],
         [ 1.4341e-01,  1.3462e-01],
         [-3.0346e-02, -1.1320e-01],
         [ 8.8269e-03, -1.2878e-01],
         [ 3.0066e-02,  1.1098e-01],
         [ 4.0884e-02,  1.1823e-01],
         [ 4.6140e-02,  1.1002e-01],
         [ 4.8527e-02,  9.0091e-02],
         [ 4.9567e-02,  1.1547e-01],
         [ 4.9956e-02,  7.8638e-02],
         [ 5.0057e-02,  1.0052e-01],
         [ 5.0077e-02,  1.1825e-01],
         [ 5.0082e-02,  8.2909e-02],
         [ 5.0060e-02,  5.6745e-02],
         [ 5.0057e-02,  9.4845e-02],
         [ 5.0031e-02,  9.0750e-02],
         [ 5.0018e-02,  1.0276e-01],
         [ 5.0040e-02,  6.5184e-02],
         [ 5.0026e-02,  7.2967e-02],
         [ 5.0014e-02,  5.4483e-02],
         [ 5.0020e-02,  4.0536e-02],
         [ 5.0020e-02,  5.4346e-02],
         [ 5.0011e-02,  7.1787e-02],
         [ 5.0009e-02,  4.8346e-02],
         [ 5.0006e-02,  6.8167e-02],
         [ 5.0008e-02,  5.5938e-03],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.5480e-05, device='cuda:0') tensor(0.0025, device='cuda:0') tensor(-0.0024, device='cuda:0')
mixer_td_error tensor(0.3180, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.5025, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.6971, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0715, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2154, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0271, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1229508., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1866, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.3642e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0017, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1117, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.2042, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1117, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17738
target_mac_out tensor([[[[-1.0000e+07, -7.2275e-02,  9.6186e-02,  ...,  2.6799e-02,
            1.4226e-01, -1.0000e+07],
          [-1.0000e+07, -1.3772e-02,  8.7099e-02,  ...,  2.2297e-02,
            1.3160e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.3285e-02,  8.7210e-02,  ..., -7.6795e-03,
            1.4393e-01, -1.0000e+07],
          [-1.0000e+07, -2.8180e-02,  9.9658e-02,  ..., -1.6816e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -8.5860e-02,  1.0411e-01,  ...,  2.0191e-02,
            1.7078e-01, -1.0000e+07],
          [-1.0000e+07, -2.5520e-02,  1.0800e-01,  ...,  9.6872e-03,
            1.3684e-01, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07, -9.5620e-02,  1.0780e-01,  ...,  6.0687e-02,
            1.4067e-01, -1.0000e+07],
          [-1.0000e+07, -1.6811e-02,  8.9914e-02,  ...,  2.4640e-02,
            1.3085e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.1402e-02,  8.1983e-02,  ...,  3.9429e-02,
            1.3744e-01, -1.0000e+07],
          [-1.0000e+07, -3.2219e-02,  9.6327e-02,  ..., -1.4636e-02,
            1.3112e-01, -1.0000e+07]],

         [[-1.0000e+07, -7.2918e-02,  8.3033e-02,  ...,  1.5905e-03,
            1.3806e-01, -1.0000e+07],
          [-1.0000e+07, -4.3941e-02,  1.2828e-01,  ...,  1.4506e-02,
            1.4886e-01, -1.0000e+07]],

         ...,

         [[ 5.0062e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.1756e-01,  6.2249e-02,  ...,  7.2620e-02,
            1.8534e-01, -1.0000e+07]],

         [[ 5.0040e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.3118e-01,  7.9832e-02,  ...,  8.7176e-02,
            1.9510e-01, -1.0000e+07]],

         [[ 5.0049e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.4158e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 9.6186e-02,  8.7099e-02],
         [ 8.7210e-02,  9.9658e-02],
         [ 1.0411e-01,  1.0800e-01],
         [ 8.4719e-02,  1.1353e-01],
         [ 1.1527e-01,  1.1500e-01],
         [ 1.3986e-01,  1.3945e-01],
         [ 1.5921e-01,  1.2947e-01],
         [ 1.8385e-01,  1.5109e-01],
         [ 1.9812e-01,  1.6420e-01],
         [ 2.0879e-01,  1.3194e-01],
         [ 2.1005e-01,  1.7221e-01],
         [ 6.9272e-02, -1.2606e-01],
         [ 1.7339e-01,  1.4619e-01],
         [ 1.6457e-01,  1.7519e-01],
         [ 1.6330e-01,  1.9288e-01],
         [ 1.4416e-01,  1.9414e-01],
         [ 1.3343e-01,  1.8718e-01],
         [-6.2158e-02, -1.4994e-01],
         [-8.2077e-02, -1.6515e-01],
         [-6.3937e-02, -1.5671e-01],
         [ 1.7852e-01, -1.2116e-01],
         [-7.3046e-02,  7.2487e-02],
         [ 1.5594e-01,  1.0584e-01],
         [ 1.2068e-01,  1.1093e-01],
         [ 1.0612e-01,  1.1869e-01],
         [ 5.4027e-02,  8.0068e-02],
         [ 9.5707e-02,  1.0542e-01],
         [-1.2032e-01,  1.1147e-01],
         [ 9.8581e-02,  9.3722e-02],
         [-1.1727e-01,  2.4951e-01],
         [-1.1607e-01,  2.3845e-01],
         [ 1.0869e-01,  2.3487e-01],
         [ 1.3879e-01,  2.1938e-01],
         [-7.3752e-02, -1.6333e-01],
         [-8.1569e-02, -1.4853e-01],
         [-9.1650e-02, -3.1680e-03],
         [-9.2521e-02,  3.0600e-02],
         [-9.4778e-02,  4.5776e-02],
         [ 1.8672e-01,  5.2215e-02],
         [-1.1026e-01,  5.4716e-02],
         [ 2.0767e-01,  5.5529e-02],
         [-1.0226e-01,  5.5666e-02],
         [ 1.9383e-01,  5.5585e-02],
         [ 1.8742e-01,  5.5473e-02],
         [-1.0258e-01,  5.5392e-02],
         [-8.2368e-02,  5.5314e-02],
         [ 1.5688e-01,  5.5237e-02],
         [ 1.7954e-01,  5.5227e-02],
         [-8.2444e-02,  5.5213e-02],
         [ 1.7126e-01,  5.5235e-02],
         [ 1.2922e-01,  5.5220e-02],
         [ 1.3455e-02,  5.5202e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0780e-01,  8.9914e-02],
         [ 8.1983e-02,  9.6327e-02],
         [ 8.3033e-02,  1.2828e-01],
         [ 1.0533e-01, -4.5109e-02],
         [ 1.2478e-01,  1.0456e-01],
         [ 1.2572e-01,  9.7676e-02],
         [ 2.8350e-02,  9.3238e-02],
         [ 2.2248e-02,  8.2896e-02],
         [ 1.3167e-01,  7.8768e-02],
         [-6.7292e-02,  1.0789e-01],
         [ 1.2173e-01,  1.1981e-01],
         [ 1.3246e-01,  1.0872e-01],
         [ 1.3294e-01,  1.2250e-01],
         [ 2.9582e-02,  1.3508e-01],
         [ 1.2021e-01,  1.3824e-01],
         [ 1.6550e-01,  1.0451e-01],
         [-2.1922e-02,  1.2367e-01],
         [ 1.5445e-01,  8.8586e-02],
         [ 1.5267e-01, -6.4707e-02],
         [ 1.1792e-02, -2.6864e-02],
         [ 1.4503e-01,  1.5559e-01],
         [ 1.7699e-01, -2.0110e-02],
         [ 2.1308e-01, -2.8294e-03],
         [ 2.2450e-01, -2.0002e-02],
         [ 1.7363e-01,  9.4386e-02],
         [ 1.5799e-01,  6.8230e-02],
         [ 1.4927e-01,  9.1177e-02],
         [ 1.5257e-01,  1.2554e-01],
         [ 1.6329e-01,  1.0859e-01],
         [ 1.6940e-01,  1.4631e-01],
         [ 1.8631e-01,  1.4684e-01],
         [ 1.5079e-01,  1.6469e-01],
         [ 1.5646e-01,  1.4066e-01],
         [ 1.5936e-01,  1.0854e-01],
         [ 1.6924e-01,  1.3301e-01],
         [ 1.3913e-01,  1.0097e-01],
         [ 1.6944e-01,  1.0643e-01],
         [ 1.4515e-01,  1.1705e-01],
         [ 1.6190e-01,  1.2454e-01],
         [ 1.7382e-01,  1.3215e-01],
         [ 1.8228e-01,  1.5498e-01],
         [ 1.8840e-01,  1.2613e-01],
         [ 1.8909e-01,  1.5074e-01],
         [ 1.6448e-01,  1.2795e-01],
         [ 1.2279e-01, -8.4086e-02],
         [ 1.3814e-01, -5.1586e-02],
         [ 1.3328e-01, -8.0809e-02],
         [ 1.3287e-01, -5.4521e-02],
         [ 1.0036e-01, -6.2789e-02],
         [ 7.7271e-02,  8.5093e-02],
         [ 6.3611e-02,  4.3893e-02],
         [ 5.6425e-02,  6.9637e-02],
         [ 5.1042e-02,  6.7282e-02],
         [ 8.9698e-02,  7.9863e-02],
         [ 2.8518e-02,  8.7401e-02],
         [ 5.3851e-03,  1.0424e-01],
         [ 3.0878e-02,  9.4957e-02],
         [ 4.3042e-02,  1.0807e-01],
         [ 4.8367e-02,  5.9887e-02],
         [ 5.0411e-02,  8.6699e-02],
         [ 5.0932e-02,  7.6379e-02],
         [ 5.0872e-02,  9.6631e-02],
         [ 5.0672e-02,  7.8103e-02],
         [ 5.0470e-02,  6.5365e-02],
         [ 5.0299e-02,  5.4941e-02],
         [ 5.0180e-02,  5.1165e-02],
         [ 5.0109e-02,  4.5463e-02],
         [ 5.0062e-02,  7.2620e-02],
         [ 5.0040e-02,  8.7176e-02],
         [ 5.0049e-02,  4.4158e-03]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.0704e-05, device='cuda:0') tensor(0.0021, device='cuda:0') tensor(-0.0018, device='cuda:0')
mixer_td_error tensor(0.3154, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.4555, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.7272, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0800, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1936, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0386, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1285714.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2495, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.8669e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0013, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2110, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')[INFO 10:12:53] my_main Updated target network

q_masked_td_error tensor(0.2413, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.2110, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17869
target_mac_out tensor([[[[-1.0000e+07,  6.8614e-02,  1.4453e-01,  ...,  1.0239e-01,
            9.3480e-02, -1.0000e+07],
          [-1.0000e+07,  7.2765e-02,  1.1170e-01,  ...,  7.5849e-02,
            7.6792e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.3461e-02,  1.3690e-01,  ...,  9.3761e-02,
            8.1060e-02, -1.0000e+07],
          [-1.0000e+07,  8.8307e-02,  1.2279e-01,  ...,  7.8996e-02,
            8.4566e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.6511e-02,  1.1656e-01,  ...,  9.6892e-02,
            6.7376e-02, -1.0000e+07],
          [-1.0000e+07,  9.2407e-02,  1.0888e-01,  ...,  5.8884e-02,
            7.1874e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.9143e-02,  1.3413e-01,  ...,  8.9326e-02,
            7.4741e-02, -1.0000e+07],
          [-1.0000e+07,  7.0448e-02,  1.0907e-01,  ...,  7.5776e-02,
            7.4083e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.7727e-02,  1.6590e-01,  ...,  1.2839e-01,
            1.0868e-01, -1.0000e+07],
          [-1.0000e+07,  8.1001e-02,  1.1063e-01,  ...,  6.4384e-02,
            6.8976e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0481e-01,  1.7362e-01,  ...,  1.4407e-01,
            1.1763e-01, -1.0000e+07],
          [-1.0000e+07,  8.8513e-02,  9.7756e-02,  ...,  7.1491e-02,
            6.9278e-02, -1.0000e+07]],

         ...,

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  2.2564e-02,  3.0346e-02,  ...,  1.4885e-02,
           -9.4822e-03, -1.3781e-02]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  2.6085e-02,  5.9013e-02,  ...,  1.6639e-02,
            7.7315e-05, -4.4975e-04]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.3271e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.4453e-01,  1.1170e-01],
         [ 1.3690e-01,  1.2279e-01],
         [ 1.1656e-01,  1.0888e-01],
         [ 9.7047e-02,  7.2899e-02],
         [ 1.1388e-01,  5.9124e-02],
         [ 1.2005e-01,  5.7434e-02],
         [ 1.0375e-01,  5.3651e-02],
         [ 9.3713e-02,  4.2857e-02],
         [ 9.0201e-02,  3.9435e-02],
         [ 1.2379e-01,  8.1458e-02],
         [ 1.0264e-01,  1.1552e-01],
         [ 1.2876e-01,  1.2427e-01],
         [ 1.6331e-01,  1.2340e-01],
         [ 1.8035e-01,  1.2229e-01],
         [ 1.5835e-01,  1.1712e-01],
         [ 1.3950e-01,  1.1037e-01],
         [ 1.7803e-01,  8.9872e-02],
         [ 1.8582e-01,  8.4289e-02],
         [ 2.0492e-01,  8.5973e-02],
         [ 1.7486e-01,  9.5601e-02],
         [ 1.6420e-01,  9.4027e-02],
         [ 1.7047e-01,  9.1675e-02],
         [ 1.7795e-01,  9.1135e-02],
         [ 1.8196e-01,  1.0386e-01],
         [ 1.8248e-01,  9.2189e-02],
         [ 1.9759e-01,  1.0300e-01],
         [ 1.5750e-01,  1.0612e-01],
         [ 1.4895e-01,  8.7659e-02],
         [ 1.7320e-01,  9.8835e-02],
         [ 1.8862e-01,  9.2358e-02],
         [ 2.0960e-01,  9.6515e-02],
         [ 2.1486e-01,  1.2248e-01],
         [ 1.9370e-01,  1.2310e-01],
         [ 1.3535e-01,  8.8297e-02],
         [ 1.7774e-01,  7.1334e-02],
         [ 1.8211e-01,  1.0277e-01],
         [ 1.3348e-01,  1.0004e-01],
         [ 1.7164e-01,  1.0609e-01],
         [ 1.8727e-01,  3.7776e-02],
         [ 1.7011e-01,  4.1068e-02],
         [ 1.4806e-01,  8.5409e-02],
         [ 1.7240e-01,  7.1872e-02],
         [ 1.8135e-01,  9.9584e-02],
         [ 1.9431e-01,  8.2799e-02],
         [ 1.6023e-01,  5.0921e-02],
         [ 1.4202e-01,  6.8292e-02],
         [ 1.3288e-01,  7.8489e-02],
         [ 1.0225e-01,  8.3437e-02],
         [ 9.6080e-02,  8.5593e-02],
         [ 9.4284e-02,  8.6379e-02],
         [ 9.3797e-02,  8.6629e-02],
         [ 1.1210e-01,  8.6703e-02],
         [ 1.0103e-01,  8.6686e-02],
         [ 9.4172e-02,  8.6675e-02],
         [ 9.0404e-02,  8.6639e-02],
         [ 1.0667e-01,  8.6631e-02],
         [ 1.2397e-01,  8.6631e-02],
         [ 1.3282e-01,  8.6616e-02],
         [ 1.3361e-01,  8.6633e-02],
         [-4.5023e-03,  8.6628e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.3413e-01,  1.0907e-01],
         [ 1.6590e-01,  1.1063e-01],
         [ 1.7362e-01,  9.7756e-02],
         [ 1.3838e-01,  6.9861e-02],
         [ 1.2258e-01,  7.8919e-02],
         [ 1.5502e-01,  8.8762e-02],
         [ 1.2854e-01,  8.6275e-02],
         [ 1.4117e-01,  7.1522e-02],
         [ 1.4205e-01,  5.8895e-02],
         [ 1.3981e-01,  5.4891e-02],
         [ 1.5428e-01,  7.0418e-02],
         [ 1.7564e-01,  1.0373e-01],
         [ 1.8960e-01,  1.4991e-01],
         [ 1.8518e-01,  1.5907e-01],
         [ 1.9018e-01,  1.4526e-01],
         [ 2.0596e-01,  1.3763e-01],
         [ 1.6868e-01,  8.9291e-02],
         [ 1.4209e-01,  7.3588e-02],
         [ 1.3843e-01,  6.8429e-02],
         [ 1.4513e-01,  5.9049e-02],
         [ 1.2356e-01,  5.7876e-02],
         [ 1.1601e-01,  5.5385e-02],
         [ 1.4943e-01,  6.4271e-02],
         [ 1.6946e-01,  7.4862e-02],
         [ 1.7845e-01,  8.4483e-02],
         [ 4.5928e-03,  6.6150e-02],
         [ 3.3213e-02,  5.5695e-02],
         [ 4.8493e-02,  6.3343e-02],
         [ 5.5797e-02,  5.6508e-02],
         [ 5.9002e-02,  5.3077e-02],
         [ 6.0162e-02,  5.0458e-02],
         [ 6.0443e-02,  6.7411e-02],
         [ 6.0380e-02,  5.8181e-02],
         [ 6.0224e-02,  5.7140e-02],
         [ 6.0066e-02,  5.9872e-02],
         [ 5.9975e-02,  7.0077e-02],
         [ 5.9884e-02,  7.5159e-02],
         [ 5.9834e-02,  6.3330e-02],
         [ 5.9785e-02,  5.5368e-02],
         [ 5.9793e-02,  4.8442e-02],
         [ 5.9770e-02,  4.9518e-02],
         [ 5.9763e-02,  5.7414e-02],
         [ 5.9754e-02,  4.6364e-02],
         [ 5.9767e-02,  4.5918e-02],
         [ 5.9772e-02,  5.0019e-02],
         [ 5.9768e-02,  5.2233e-02],
         [ 5.9767e-02,  5.6925e-02],
         [ 5.9761e-02,  5.3420e-02],
         [ 5.9760e-02,  5.3395e-02],
         [ 5.9761e-02,  4.8532e-02],
         [ 5.9761e-02,  4.3589e-02],
         [ 5.9761e-02,  6.6010e-02],
         [ 5.9761e-02,  5.4861e-02],
         [ 5.9761e-02,  4.8764e-02],
         [ 5.9761e-02,  4.9778e-02],
         [ 5.9761e-02,  4.1711e-02],
         [ 5.9762e-02,  4.3540e-02],
         [ 5.9760e-02,  4.4529e-02],
         [ 5.9760e-02,  6.3887e-02],
         [ 5.9762e-02,  7.2274e-02],
         [ 5.9762e-02,  5.7594e-02],
         [ 5.9762e-02,  7.5577e-02],
         [ 5.9762e-02,  6.0688e-02],
         [ 5.9762e-02,  6.9395e-02],
         [ 5.9762e-02,  4.7706e-02],
         [ 5.9762e-02,  4.9446e-02],
         [ 5.9762e-02,  8.0953e-02],
         [ 5.9762e-02,  8.9114e-02],
         [ 5.9762e-02,  9.6809e-02],
         [ 5.9762e-02,  6.5155e-02],
         [ 5.9762e-02,  5.8387e-02],
         [ 5.9762e-02,  8.0167e-02],
         [ 5.9762e-02,  5.9913e-02],
         [ 5.9762e-02,  8.1919e-02],
         [ 5.9762e-02,  8.6147e-02],
         [ 5.9762e-02,  9.5837e-02],
         [ 5.9762e-02,  5.5818e-02],
         [ 5.9762e-02,  7.0536e-02],
         [ 5.9762e-02,  8.1718e-02],
         [ 5.9762e-02,  7.7507e-02],
         [ 5.9762e-02,  4.3032e-02],
         [ 5.9762e-02,  4.1850e-02],
         [ 5.9762e-02,  3.0346e-02],
         [ 5.9762e-02,  5.9013e-02],
         [ 5.9762e-02,  4.3271e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.5633e-05, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0024, device='cuda:0')
mixer_td_error tensor(0.2993, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2250, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.0195, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0660, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2096, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0150, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1470588.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2149, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.3237e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0023, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1119, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1739, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1119, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17927
target_mac_out tensor([[[[-1.0000e+07,  6.8614e-02,  1.4453e-01,  ...,  1.0239e-01,
            9.3480e-02, -1.0000e+07],
          [-1.0000e+07,  7.2765e-02,  1.1170e-01,  ...,  7.5849e-02,
            7.6792e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.1912e-02,  1.7464e-01,  ...,  1.3861e-01,
            1.2049e-01, -1.0000e+07],
          [-1.0000e+07,  1.0099e-01,  1.3369e-01,  ...,  9.4403e-02,
            8.1741e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0771e-01,  1.3712e-01,  ...,  1.2326e-01,
            9.0359e-02, -1.0000e+07],
          [-1.0000e+07,  1.0239e-01,  1.2984e-01,  ...,  9.6424e-02,
            7.5052e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.0269e-02,  1.0780e-01,  ...,  8.8090e-02,
            6.1240e-02, -1.0000e+07],
          [-1.0000e+07,  7.1056e-02,  9.5596e-02,  ...,  5.5608e-02,
            6.2230e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.4964e-02,  1.2449e-01,  ...,  1.1007e-01,
            7.0689e-02, -1.0000e+07],
          [-1.0000e+07,  8.3112e-02,  1.0594e-01,  ...,  6.5719e-02,
            7.4592e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.2047e-02,  8.7308e-02,  ...,  8.3643e-02,
            5.9314e-02, -1.0000e+07],
          [-1.0000e+07,  6.9594e-02,  7.5500e-02,  ...,  5.7205e-02,
            6.2510e-02, -1.0000e+07]],

         ...,

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  6.5318e-02,  4.0549e-02,  ...,  4.8381e-02,
            1.1900e-02, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  6.0676e-02,  2.4215e-02,  ...,  4.9807e-02,
            1.2989e-02, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  5.8696e-02,  5.8568e-02,  ...,  6.1645e-02,
            3.3000e-02, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.4453e-01,  1.1170e-01],
         [ 1.7464e-01,  1.3369e-01],
         [ 1.3712e-01,  1.2984e-01],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0780e-01,  9.5596e-02],
         [ 1.2449e-01,  1.0594e-01],
         [ 8.7308e-02,  7.5500e-02],
         ...,
         [ 5.9762e-02,  6.5318e-02],
         [ 5.9762e-02,  6.0676e-02],
         [ 5.9762e-02,  6.1645e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.3384e-07, device='cuda:0') tensor(0.0002, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.9430, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2235, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9312, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0618, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2243, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0277, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-4233333., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2175, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.8235e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1178, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1112, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1178, device='cuda:0', grad_fn=<MinBackward1>)
t_env 17976
target_mac_out tensor([[[[-1.0000e+07,  6.8544e-02,  1.3215e-01,  ...,  8.7593e-02,
            7.5051e-02, -1.0000e+07],
          [-1.0000e+07,  6.8885e-02,  8.0276e-02,  ...,  6.9549e-02,
            6.3756e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.1164e-02,  1.2977e-01,  ...,  8.4060e-02,
            7.3744e-02, -1.0000e+07],
          [-1.0000e+07,  8.5578e-02,  1.1157e-01,  ...,  7.9073e-02,
            7.3073e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.5809e-02,  1.4923e-01,  ...,  1.0754e-01,
            9.8129e-02, -1.0000e+07],
          [-1.0000e+07,  8.0663e-02,  1.0577e-01,  ...,  6.4463e-02,
            6.5088e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.9143e-02,  1.3413e-01,  ...,  8.9326e-02,
            7.4741e-02, -1.0000e+07],
          [-1.0000e+07,  7.0448e-02,  1.0907e-01,  ...,  7.5776e-02,
            7.4083e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.5132e-02,  1.5134e-01,  ...,  1.0964e-01,
            9.9393e-02, -1.0000e+07],
          [-1.0000e+07,  8.1021e-02,  8.9095e-02,  ...,  7.3884e-02,
            6.7763e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.7162e-02,  1.5399e-01,  ...,  1.1912e-01,
            1.0913e-01, -1.0000e+07],
          [-1.0000e+07,  8.7212e-02,  8.6023e-02,  ...,  8.6053e-02,
            6.8017e-02, -1.0000e+07]],

         ...,

         [[ 5.0510e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  2.2489e-02,  1.9935e-02,  ...,  7.2336e-03,
           -1.3167e-02, -1.5506e-02]],

         [[ 5.5835e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  4.1225e-02,  4.4206e-02,  ...,  1.9022e-02,
            4.4471e-03,  1.3539e-03]],

         [[ 5.8492e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.3353e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.3215e-01,  8.0276e-02],
         [ 1.2977e-01,  1.1157e-01],
         [ 1.4923e-01,  1.0577e-01],
         [ 1.5323e-01,  1.0181e-01],
         [ 1.5186e-01,  1.1583e-01],
         [ 1.4968e-01,  1.1964e-01],
         [ 1.4773e-01,  1.2051e-01],
         [ 1.4625e-01,  1.0215e-01],
         [ 1.3093e-01,  1.1187e-01],
         [ 1.2266e-01,  1.1539e-01],
         [ 1.3892e-01,  1.2016e-01],
         [ 1.5035e-01,  9.8919e-02],
         [ 1.2154e-01,  1.1065e-01],
         [ 1.3043e-01,  1.0478e-01],
         [ 1.2334e-01,  1.1580e-01],
         [ 1.5790e-01,  1.3677e-01],
         [ 1.6858e-01,  1.3815e-01],
         [ 1.3799e-01,  1.1660e-01],
         [ 1.5041e-01,  1.3095e-01],
         [ 1.4455e-01,  1.3612e-01],
         [ 1.2006e-01,  1.2820e-01],
         [ 1.4526e-01,  9.6536e-02],
         [ 1.4238e-01,  8.3931e-02],
         [ 1.5153e-01,  1.1956e-01],
         [ 1.6604e-01,  9.8138e-02],
         [ 1.6785e-01,  1.0059e-01],
         [ 1.3781e-01,  1.3172e-01],
         [ 1.3959e-01,  1.0545e-01],
         [ 1.5459e-01,  9.2835e-02],
         [ 1.5566e-01,  9.3347e-02],
         [ 1.5047e-01,  1.2831e-01],
         [ 1.3489e-01,  1.0139e-01],
         [ 1.4003e-01,  7.3777e-02],
         [ 1.2590e-01,  7.6020e-02],
         [ 1.3529e-01,  8.3907e-02],
         [ 1.4217e-01,  1.0843e-01],
         [ 1.6446e-01,  2.8103e-02],
         [ 1.4998e-01,  6.3441e-02],
         [ 1.6509e-01,  7.8460e-02],
         [ 1.4777e-01,  8.4307e-02],
         [ 1.1064e-01,  8.6295e-02],
         [ 1.1174e-01,  8.6842e-02],
         [ 1.2849e-01,  8.6881e-02],
         [ 1.2579e-01,  8.6789e-02],
         [ 1.3042e-01,  8.6712e-02],
         [ 1.0534e-01,  8.6656e-02],
         [ 1.3722e-01,  8.6600e-02],
         [ 1.2130e-01,  8.6604e-02],
         [ 1.0606e-01,  8.6627e-02],
         [ 1.2827e-01,  8.6613e-02],
         [ 1.4274e-01,  8.6608e-02],
         [ 1.4661e-01,  8.6624e-02],
         [ 1.5034e-01,  8.6625e-02],
         [ 1.5858e-01,  8.6628e-02],
         [ 1.2992e-01,  8.6625e-02],
         [ 1.4557e-01,  8.6626e-02],
         [ 1.5067e-01,  8.6624e-02],
         [ 1.4395e-01,  8.6624e-02],
         [ 1.4546e-01,  8.6621e-02],
         [ 1.0673e-01,  8.6621e-02],
         [ 1.0595e-01,  8.6621e-02],
         [ 8.6170e-02,  8.6621e-02],
         [ 1.1851e-01,  8.6621e-02],
         [ 1.9959e-02,  8.6621e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.3413e-01,  1.0907e-01],
         [ 1.5134e-01,  8.9095e-02],
         [ 1.5399e-01,  8.6023e-02],
         [ 1.5310e-01,  1.0428e-01],
         [ 1.1518e-01,  1.0571e-01],
         [ 1.1788e-01,  9.0749e-02],
         [ 1.3060e-01,  9.4213e-02],
         [ 1.4009e-01,  9.7160e-02],
         [ 1.4761e-01,  1.0341e-01],
         [ 1.2943e-01,  1.0690e-01],
         [ 1.1949e-01,  1.0274e-01],
         [ 1.3890e-01,  1.0077e-01],
         [ 1.4525e-01,  8.9292e-02],
         [ 1.4560e-01,  8.4734e-02],
         [ 1.4982e-01,  9.7597e-02],
         [ 1.5200e-01,  9.7837e-02],
         [ 1.5284e-01,  1.0291e-01],
         [ 1.3041e-01,  9.5995e-02],
         [ 1.1904e-01,  6.5048e-02],
         [ 1.0616e-01,  4.9653e-02],
         [ 1.1308e-01,  7.9562e-02],
         [ 1.0035e-01,  1.0692e-01],
         [ 1.3327e-01,  1.2051e-01],
         [ 1.0952e-01,  1.2098e-01],
         [ 1.1820e-01,  1.1575e-01],
         [ 1.4162e-01,  9.3632e-02],
         [ 1.3884e-01,  9.0638e-02],
         [ 1.4213e-01,  9.0599e-02],
         [ 1.4941e-01,  9.9414e-02],
         [ 1.5323e-01,  9.1676e-02],
         [ 1.4980e-01,  9.2980e-02],
         [ 1.4226e-01,  1.0454e-01],
         [ 1.6240e-01,  1.0204e-01],
         [ 1.4904e-01,  9.6529e-02],
         [ 1.6736e-01,  1.0607e-01],
         [ 1.6410e-01,  1.0862e-01],
         [ 1.7538e-01,  1.0793e-01],
         [ 1.8307e-01,  9.6207e-02],
         [ 1.9495e-01,  8.2249e-02],
         [ 1.9401e-01,  8.0841e-02],
         [ 1.5906e-01,  8.1901e-02],
         [ 1.5189e-01,  9.2957e-02],
         [ 1.6268e-01,  9.8193e-02],
         [ 1.7111e-01,  9.8667e-02],
         [ 1.7398e-01,  8.1096e-02],
         [ 1.6566e-01,  9.8693e-02],
         [ 1.7951e-01,  8.6060e-02],
         [ 1.7062e-01,  1.0514e-01],
         [ 1.9110e-01,  1.0672e-01],
         [ 1.9110e-01,  1.0773e-01],
         [ 1.4909e-01,  7.0214e-02],
         [ 1.6960e-01,  7.6586e-02],
         [ 1.4333e-01,  7.1041e-02],
         [ 1.5932e-01,  9.3737e-02],
         [ 1.6953e-01,  1.0844e-01],
         [ 1.7331e-01,  1.1837e-01],
         [ 1.7144e-01,  1.1968e-01],
         [ 1.6789e-01,  1.3607e-01],
         [ 1.6234e-01,  1.3786e-01],
         [ 1.6956e-01,  1.3324e-01],
         [ 1.6122e-01,  1.2322e-01],
         [ 1.5895e-01,  1.3280e-01],
         [ 1.6209e-01,  1.2784e-01],
         [ 1.7216e-01,  1.3262e-01],
         [ 1.7749e-01,  1.1028e-01],
         [ 1.6791e-01,  1.0582e-01],
         [ 1.6427e-01,  1.2665e-01],
         [ 1.7430e-01,  1.3373e-01],
         [ 1.4912e-01,  1.0124e-01],
         [ 1.7575e-01,  8.7761e-02],
         [ 1.9673e-01,  1.2147e-01],
         [ 1.9470e-01,  1.1174e-01],
         [ 1.9104e-01,  1.3270e-01],
         [ 1.8680e-01,  1.3667e-01],
         [ 1.1656e-01,  1.2593e-01],
         [ 9.1150e-02,  1.1678e-01],
         [ 8.2073e-02,  5.8886e-02],
         [ 7.3717e-02,  5.6968e-02],
         [ 1.1273e-01,  8.4575e-02],
         [ 1.3367e-01,  7.9528e-02],
         [ 1.3961e-01,  1.0360e-01],
         [ 9.1159e-02,  8.7657e-02],
         [ 7.4414e-02,  9.9071e-02],
         [ 7.0483e-02,  9.6169e-02],
         [ 5.9610e-02,  9.5926e-02],
         [ 3.2367e-02,  6.6230e-02],
         [ 4.1685e-02,  2.8355e-02],
         [ 5.0510e-02,  1.9935e-02],
         [ 5.5835e-02,  4.4206e-02],
         [ 5.8492e-02,  4.3353e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.1373e-05, device='cuda:0') tensor(0.0011, device='cuda:0') tensor(-0.0021, device='cuda:0')
mixer_td_error tensor(0.2994, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2241, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.0374, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0933, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2056, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0028, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1444444.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1967, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.5054e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0013, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0917, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.0794, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0917, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18025
target_mac_out tensor([[[[-1.0000e+07,  7.2507e-02,  1.0840e-01,  ...,  8.9047e-02,
            6.2431e-02, -1.0000e+07],
          [-1.0000e+07,  7.2838e-02,  1.0694e-01,  ...,  7.3659e-02,
            7.6162e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.7823e-02,  1.4657e-01,  ...,  1.0957e-01,
            9.1630e-02, -1.0000e+07],
          [-1.0000e+07,  8.3720e-02,  1.0376e-01,  ...,  5.8398e-02,
            6.6925e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0459e-01,  1.3750e-01,  ...,  1.2039e-01,
            8.6554e-02, -1.0000e+07],
          [-1.0000e+07,  8.8423e-02,  1.0728e-01,  ...,  6.5372e-02,
            7.7361e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  7.2839e-02,  1.2983e-01,  ...,  8.2081e-02,
            4.4628e-02,  6.8140e-02],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  6.3894e-02,  1.3513e-01,  ...,  7.9755e-02,
            4.2285e-02,  6.9378e-02],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.4631e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.7856e-02,  1.2627e-01,  ...,  8.1598e-02,
            6.5922e-02, -1.0000e+07],
          [-1.0000e+07,  8.9393e-02,  1.1920e-01,  ...,  8.7495e-02,
            7.6975e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0098e-01,  1.5496e-01,  ...,  1.0847e-01,
            8.5892e-02, -1.0000e+07],
          [-1.0000e+07,  1.1001e-01,  1.2966e-01,  ...,  9.9187e-02,
            8.1221e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0920e-01,  1.3295e-01,  ...,  1.0987e-01,
            7.3177e-02, -1.0000e+07],
          [-1.0000e+07,  1.1486e-01,  1.2665e-01,  ...,  8.9376e-02,
            8.1838e-02,  3.1247e-02]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0840e-01,  1.0694e-01],
         [ 1.4657e-01,  1.0376e-01],
         [ 1.3750e-01,  1.0728e-01],
         [ 1.5322e-01,  1.0261e-01],
         [ 1.6043e-01,  1.1170e-01],
         [ 1.0845e-01,  7.5052e-02],
         [ 1.4043e-01,  8.6444e-02],
         [ 1.5422e-01,  1.0741e-01],
         [ 1.5381e-01,  1.1728e-01],
         [ 1.1766e-01,  1.1613e-01],
         [ 1.3970e-01,  1.1874e-01],
         [ 1.5352e-01,  1.1183e-01],
         [ 1.4913e-01,  1.0603e-01],
         [ 1.5933e-01,  1.1738e-01],
         [ 1.7712e-01,  1.2465e-01],
         [ 1.4833e-01,  1.3069e-01],
         [ 1.5583e-01,  1.0334e-01],
         [ 1.5595e-01,  1.1639e-01],
         [ 1.6222e-01,  1.2143e-01],
         [ 1.2574e-01,  1.2049e-01],
         [ 1.4073e-01,  1.1106e-01],
         [ 1.4604e-01,  1.2011e-01],
         [ 1.4847e-01,  1.2938e-01],
         [ 1.4856e-01,  1.0598e-01],
         [ 1.4849e-01,  1.1858e-01],
         [ 1.1886e-01,  9.1053e-02],
         [ 1.3534e-01,  1.1844e-01],
         [ 1.3581e-01,  1.0857e-01],
         [ 1.1522e-01,  1.2358e-01],
         [ 1.2898e-01,  1.3618e-01],
         [ 1.1940e-01,  1.1569e-01],
         [ 1.4206e-01,  1.3237e-01],
         [ 1.5238e-01,  1.1630e-01],
         [ 1.3041e-01,  1.3283e-01],
         [ 1.4101e-01,  1.3493e-01],
         [ 1.1916e-01,  1.0880e-01],
         [ 1.1566e-01,  9.4349e-02],
         [ 1.1266e-01,  1.0205e-01],
         [ 1.0442e-01,  1.1574e-01],
         [ 1.1063e-01,  1.2406e-01],
         [ 9.6217e-02,  2.1720e-02],
         [ 1.0910e-01,  5.8905e-02],
         [ 1.2488e-01,  7.5927e-02],
         [ 1.3254e-01,  8.3106e-02],
         [ 9.5542e-02,  8.5858e-02],
         [ 9.8100e-02,  8.6777e-02],
         [ 9.9669e-02,  8.6946e-02],
         [ 8.6310e-02,  8.6924e-02],
         [ 1.1735e-01,  8.6819e-02],
         [ 1.3217e-01,  8.6742e-02],
         [ 1.3971e-01,  8.6697e-02],
         [ 1.2312e-01,  8.6681e-02],
         [ 1.4533e-01,  8.6664e-02],
         [ 1.5358e-01,  8.6609e-02],
         [ 1.6361e-01,  8.6631e-02],
         [ 1.6905e-01,  8.6634e-02],
         [ 1.5907e-01,  8.6626e-02],
         [ 1.5307e-01,  8.6620e-02],
         [ 1.2059e-01,  8.6631e-02],
         [ 1.4110e-01,  8.6619e-02],
         [ 1.1725e-01,  8.6625e-02],
         [ 1.3259e-01,  8.6623e-02],
         [ 1.1890e-01,  8.6621e-02],
         [ 1.2814e-01,  8.6621e-02],
         [ 1.2983e-01,  8.6621e-02],
         [ 1.3513e-01,  8.6621e-02],
         [ 3.4631e-03,  8.6621e-02]],

        [[ 1.2627e-01,  1.1920e-01],
         [ 1.5496e-01,  1.2966e-01],
         [ 1.3295e-01,  1.2665e-01],
         [ 1.6351e-01,  1.2865e-01],
         [ 1.8397e-01,  1.2336e-01],
         [ 1.2313e-01,  9.6162e-02],
         [ 1.0989e-01,  9.0349e-02],
         [ 1.0317e-01,  5.5921e-02],
         [ 9.5152e-02,  7.5035e-02],
         [ 1.0942e-01,  7.8469e-02],
         [ 1.2568e-01,  7.9215e-02],
         [ 1.7555e-01,  7.0830e-02],
         [ 1.8694e-01,  7.2240e-02],
         [ 1.8950e-01,  1.0595e-01],
         [ 1.9043e-01,  8.8310e-02],
         [ 1.7885e-01,  8.2399e-02],
         [ 1.5221e-01,  1.1203e-01],
         [ 1.4487e-01,  1.2349e-01],
         [ 1.6223e-01,  1.0618e-01],
         [ 1.6140e-01,  1.2120e-01],
         [ 1.9146e-01,  1.2536e-01],
         [ 2.0667e-01,  1.2268e-01],
         [ 2.1120e-01,  5.2118e-02],
         [ 2.0256e-01,  8.2896e-02],
         [ 1.8410e-01,  7.9316e-02],
         [ 1.8079e-01,  8.9055e-02],
         [ 1.5776e-01,  9.2809e-02],
         [ 1.4629e-01,  9.0660e-02],
         [ 1.3052e-01,  1.1650e-01],
         [ 1.5644e-01,  1.2433e-01],
         [ 1.2729e-01,  1.0851e-01],
         [ 1.2107e-01,  9.5299e-02],
         [ 1.0399e-01,  9.2501e-02],
         [ 1.1297e-01,  9.5592e-02],
         [ 1.4496e-01,  7.8675e-02],
         [ 1.1532e-01,  7.5709e-02],
         [ 9.0405e-02,  1.9421e-02],
         [ 9.8572e-02,  5.8042e-02],
         [ 7.0731e-02,  7.5707e-02],
         [ 8.5623e-02,  8.3145e-02],
         [ 6.2681e-02,  8.5966e-02],
         [ 7.7596e-02,  8.6865e-02],
         [ 7.5503e-02,  8.7020e-02],
         [ 4.5779e-03,  8.6959e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.1540e-05, device='cuda:0') tensor(0.0015, device='cuda:0') tensor(-0.0024, device='cuda:0')
mixer_td_error tensor(0.3614, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2259, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.0306, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0915, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2211, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0019, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1716417.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2112, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.7755e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0020, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1103, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1410, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1103, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18070
target_mac_out tensor([[[[-1.0000e+07,  6.9143e-02,  1.3413e-01,  ...,  8.9326e-02,
            7.4741e-02, -1.0000e+07],
          [-1.0000e+07,  7.0448e-02,  1.0907e-01,  ...,  7.5776e-02,
            7.4083e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.8341e-02,  1.5234e-01,  ...,  1.0994e-01,
            9.9193e-02, -1.0000e+07],
          [-1.0000e+07,  7.1135e-02,  9.9140e-02,  ...,  6.0624e-02,
            6.4064e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.9636e-02,  1.3812e-01,  ...,  9.7925e-02,
            8.3363e-02, -1.0000e+07],
          [-1.0000e+07,  8.5412e-02,  1.1466e-01,  ...,  7.3048e-02,
            7.3576e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  9.1804e-02,  1.0648e-01,  ...,  8.0662e-02,
            3.6780e-02, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  9.0693e-02,  1.1754e-01,  ...,  8.7796e-02,
            5.0931e-02, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.2125e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.5871e-02,  1.2252e-01,  ...,  7.9492e-02,
            6.6346e-02, -1.0000e+07],
          [-1.0000e+07,  7.5067e-02,  1.1346e-01,  ...,  7.5107e-02,
            7.9461e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.1854e-02,  1.3872e-01,  ...,  9.0565e-02,
            7.6566e-02, -1.0000e+07],
          [-1.0000e+07,  8.5990e-02,  9.1850e-02,  ...,  7.2473e-02,
            7.1086e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.0053e-02,  1.4134e-01,  ...,  9.3768e-02,
            8.3103e-02, -1.0000e+07],
          [-1.0000e+07,  8.9260e-02,  8.6009e-02,  ...,  8.4367e-02,
            6.8920e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.3413e-01,  1.0907e-01],
         [ 1.5234e-01,  9.9140e-02],
         [ 1.3812e-01,  1.1466e-01],
         [ 1.5331e-01,  1.2870e-01],
         [ 1.7530e-01,  1.1560e-01],
         [ 1.7745e-01,  1.2359e-01],
         [ 1.7408e-01,  1.3306e-01],
         [ 1.7539e-01,  1.2527e-01],
         [ 1.7586e-01,  1.2662e-01],
         [ 1.8658e-01,  1.1676e-01],
         [ 1.8593e-01,  1.2071e-01],
         [ 1.7940e-01,  9.0859e-02],
         [ 1.4250e-01,  1.0043e-01],
         [ 1.3603e-01,  9.2831e-02],
         [ 1.3103e-01,  9.2412e-02],
         [ 1.3000e-01,  1.1007e-01],
         [ 1.4223e-01,  1.1494e-01],
         [ 1.2208e-01,  1.0598e-01],
         [ 1.3370e-01,  1.1335e-01],
         [ 1.4858e-01,  1.1706e-01],
         [ 1.2542e-01,  1.1589e-01],
         [ 1.2514e-01,  1.1264e-01],
         [ 1.3848e-01,  1.0836e-01],
         [ 1.5978e-01,  1.1027e-01],
         [ 1.6157e-01,  1.1085e-01],
         [ 1.5967e-01,  1.1068e-01],
         [ 1.6270e-01,  1.1342e-01],
         [ 1.3337e-01,  9.8269e-02],
         [ 1.4839e-01,  1.1366e-01],
         [ 1.5329e-01,  1.1963e-01],
         [ 1.5921e-01,  1.2475e-01],
         [ 1.6128e-01,  1.2884e-01],
         [ 1.5801e-01,  1.3569e-01],
         [ 1.3702e-01,  1.2513e-01],
         [ 1.2922e-01,  1.2033e-01],
         [ 1.2433e-01,  1.0041e-01],
         [ 1.3609e-01,  1.0057e-01],
         [ 1.2795e-01,  9.4413e-02],
         [ 1.3545e-01,  1.0714e-01],
         [ 1.2364e-01,  1.0330e-01],
         [ 1.3793e-01,  1.0554e-01],
         [ 1.2584e-01,  9.1687e-02],
         [ 1.2826e-01,  8.9213e-02],
         [ 9.8499e-02,  9.8707e-02],
         [ 1.1884e-01,  1.1144e-01],
         [ 1.2028e-01,  9.6000e-02],
         [ 1.1890e-01,  7.9208e-02],
         [ 1.1448e-01,  1.0721e-01],
         [ 1.0874e-01,  1.0993e-01],
         [ 1.0864e-01,  8.7051e-02],
         [ 8.0671e-02,  5.4219e-02],
         [ 9.0653e-02,  7.1683e-02],
         [ 8.0912e-02,  8.0787e-02],
         [ 6.8095e-02,  8.4749e-02],
         [ 8.1741e-02,  8.6209e-02],
         [ 8.6516e-02,  8.6614e-02],
         [ 9.8437e-02,  8.6678e-02],
         [ 9.6647e-02,  8.6634e-02],
         [ 1.0212e-01,  8.6615e-02],
         [ 9.6431e-02,  8.6589e-02],
         [ 9.1853e-02,  8.6581e-02],
         [ 9.0656e-02,  8.6581e-02],
         [ 9.0209e-02,  8.6598e-02],
         [ 8.7832e-02,  8.6628e-02],
         [ 8.9026e-02,  8.6629e-02],
         [ 8.8441e-02,  8.6617e-02],
         [ 8.9683e-02,  8.6630e-02],
         [ 8.7719e-02,  8.6636e-02],
         [ 8.8893e-02,  8.6620e-02],
         [ 8.8305e-02,  8.6627e-02],
         [ 8.5774e-02,  8.6626e-02],
         [ 8.2558e-02,  8.6624e-02],
         [ 8.6849e-02,  8.6623e-02],
         [ 8.3489e-02,  8.6621e-02],
         [ 8.7389e-02,  8.6621e-02],
         [ 8.5804e-02,  8.6621e-02],
         [ 8.6844e-02,  8.6621e-02],
         [ 1.0460e-01,  8.6621e-02],
         [ 1.1208e-01,  8.6621e-02],
         [ 1.1856e-01,  8.6621e-02],
         [ 1.2143e-01,  8.6621e-02],
         [ 1.1209e-01,  8.6621e-02],
         [ 1.2708e-01,  8.6621e-02],
         [ 1.3441e-01,  8.6621e-02],
         [ 1.4586e-01,  8.6621e-02],
         [ 1.5181e-01,  8.6621e-02],
         [ 1.6061e-01,  8.6621e-02],
         [ 1.4746e-01,  8.6621e-02],
         [ 1.5680e-01,  8.6621e-02],
         [ 1.1905e-01,  8.6621e-02],
         [ 1.2184e-01,  8.6621e-02],
         [ 1.0770e-01,  8.6621e-02],
         [ 9.7341e-02,  8.6621e-02],
         [ 1.1762e-01,  8.6621e-02],
         [ 1.2570e-01,  8.6621e-02],
         [ 9.6819e-02,  8.6621e-02],
         [ 1.1008e-01,  8.6621e-02],
         [ 1.0648e-01,  8.6621e-02],
         [ 1.1754e-01,  8.6621e-02],
         [ 2.2125e-02,  8.6621e-02]],

        [[ 1.2252e-01,  1.1346e-01],
         [ 1.3872e-01,  9.1850e-02],
         [ 1.4134e-01,  8.9260e-02],
         [ 1.1341e-01,  9.8803e-02],
         [ 1.1092e-01,  9.4612e-02],
         [ 1.2922e-01,  9.3557e-02],
         [ 1.4316e-01,  9.5638e-02],
         [ 1.4678e-01,  1.0358e-01],
         [ 1.5866e-01,  1.1467e-01],
         [ 1.5856e-01,  9.0960e-02],
         [ 1.6081e-01,  9.0185e-02],
         [ 1.7340e-01,  9.1566e-02],
         [ 1.6371e-01,  9.6720e-02],
         [ 1.6908e-01,  8.5694e-02],
         [ 1.8011e-01,  9.2327e-02],
         [ 1.8428e-01,  1.0971e-01],
         [ 1.6597e-01,  9.6231e-02],
         [ 1.5772e-01,  9.8621e-02],
         [ 1.5001e-01,  7.6912e-02],
         [ 1.4361e-01,  8.3316e-02],
         [ 1.4850e-01,  6.3240e-02],
         [ 1.5325e-01,  7.6973e-02],
         [ 1.5206e-01,  6.3757e-02],
         [ 1.6180e-01,  8.8185e-02],
         [ 1.3237e-01,  8.5193e-02],
         [ 1.1663e-01,  6.4541e-02],
         [ 1.2139e-01,  8.0139e-02],
         [ 1.1557e-01,  6.5599e-02],
         [ 1.2158e-01,  7.3426e-02],
         [ 1.0148e-01,  6.4405e-02],
         [ 1.1290e-01,  5.9068e-02],
         [ 1.0633e-01,  5.6322e-02],
         [ 1.1979e-01,  7.4225e-02],
         [ 1.1460e-01,  8.2505e-02],
         [ 1.0196e-01,  8.2173e-02],
         [ 9.9527e-02,  8.0065e-02],
         [ 1.1437e-01,  6.3380e-02],
         [ 8.2016e-02,  6.9281e-02],
         [ 8.7698e-02,  7.8267e-02],
         [ 1.0707e-01,  8.0215e-02],
         [ 1.2558e-01,  5.7073e-02],
         [ 9.9762e-02,  7.0052e-02],
         [ 1.3254e-01,  6.3454e-02],
         [ 1.4540e-01,  5.5632e-02],
         [ 1.8835e-01,  9.2746e-02],
         [ 1.3422e-01,  5.8349e-02],
         [ 1.3871e-01,  4.6464e-02],
         [ 1.0074e-01,  6.2204e-02],
         [ 9.6094e-02,  5.2040e-02],
         [ 8.7945e-02,  5.5123e-02],
         [ 2.9043e-02,  6.3568e-02],
         [ 4.4616e-02,  6.5215e-02],
         [ 5.3039e-02,  6.7090e-02],
         [ 5.7070e-02,  3.0413e-02],
         [ 5.8841e-02,  1.7749e-02],
         [ 5.9541e-02,  4.2907e-03],
         [ 5.9760e-02,  2.8708e-02],
         [ 5.9829e-02,  4.9000e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.9830e-05, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.4829, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2315, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3794, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0868, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1879, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0247, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2099999.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1883, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.0825e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0003, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0772, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0829, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0772, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18121
target_mac_out tensor([[[[-1.0000e+07,  7.3491e-02,  1.6030e-01,  ...,  1.2384e-01,
            1.0686e-01, -1.0000e+07],
          [-1.0000e+07,  8.7470e-02,  1.2344e-01,  ...,  9.0087e-02,
            7.7106e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.5377e-02,  1.8107e-01,  ...,  1.4299e-01,
            1.2006e-01, -1.0000e+07],
          [-1.0000e+07,  1.0761e-01,  1.3029e-01,  ...,  1.0196e-01,
            8.0803e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.8912e-02,  1.9410e-01,  ...,  1.4978e-01,
            1.2173e-01, -1.0000e+07],
          [-1.0000e+07,  1.1094e-01,  1.2932e-01,  ...,  9.6032e-02,
            8.1956e-02,  2.7636e-02]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.0608e-02,  1.0466e-01,  ...,  8.6790e-02,
            6.1806e-02, -1.0000e+07],
          [-1.0000e+07,  7.0382e-02,  7.6961e-02,  ...,  6.6786e-02,
            6.4623e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.7359e-02,  1.2081e-01,  ...,  8.6235e-02,
            6.4281e-02, -1.0000e+07],
          [-1.0000e+07,  7.7181e-02,  8.9939e-02,  ...,  5.8300e-02,
            5.7627e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0603e-01,  1.2231e-01,  ...,  1.0701e-01,
            7.4583e-02, -1.0000e+07],
          [-1.0000e+07,  7.8146e-02,  8.7354e-02,  ...,  5.1188e-02,
            5.5151e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  5.2197e-02,  1.3907e-01,  ...,  7.9366e-02,
            4.3874e-02,  6.3785e-02],
          [ 8.6622e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  5.5066e-02,  1.0832e-01,  ...,  6.5817e-02,
            2.7435e-02,  5.0098e-02],
          [ 8.6624e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.6739e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6620e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.6030e-01,  1.2344e-01],
         [ 1.8107e-01,  1.3029e-01],
         [ 1.9410e-01,  1.2932e-01],
         [ 1.5681e-01,  1.2353e-01],
         [ 1.6794e-01,  1.1907e-01],
         [ 1.5969e-01,  9.2131e-02],
         [ 1.5597e-01,  1.1805e-01],
         [ 1.5949e-01,  1.2397e-01],
         [ 1.6158e-01,  1.2081e-01],
         [ 1.0642e-01,  1.0719e-01],
         [ 1.0074e-01,  9.6851e-02],
         [ 1.1429e-01,  6.4102e-02],
         [ 1.2282e-01,  5.4653e-02],
         [ 1.7409e-01,  7.2911e-02],
         [ 1.4972e-01,  4.6980e-02],
         [ 1.3661e-01,  4.3502e-02],
         [ 1.3005e-01,  3.7763e-02],
         [ 1.0314e-01,  1.8694e-02],
         [ 1.6482e-01,  6.4370e-02],
         [ 1.8161e-01,  5.1987e-02],
         [ 1.5984e-01,  4.8065e-02],
         [ 1.5433e-01,  6.8805e-02],
         [ 1.7834e-01,  6.6965e-02],
         [ 1.8356e-01,  7.9307e-02],
         [ 1.8063e-01,  1.0799e-01],
         [ 1.4584e-01,  8.2015e-02],
         [ 1.1359e-01,  3.2666e-02],
         [ 1.1798e-01,  6.0470e-02],
         [ 1.1039e-01,  7.5159e-02],
         [ 1.0701e-01,  8.2092e-02],
         [ 1.3126e-01,  8.5079e-02],
         [ 1.3849e-01,  8.6244e-02],
         [ 1.3495e-01,  8.6643e-02],
         [ 1.3362e-01,  8.6731e-02],
         [ 1.3480e-01,  8.6729e-02],
         [ 1.1870e-01,  8.6724e-02],
         [ 1.2984e-01,  8.6685e-02],
         [ 1.3194e-01,  8.6647e-02],
         [ 1.3169e-01,  8.6658e-02],
         [ 1.2258e-01,  8.6643e-02],
         [ 1.1759e-01,  8.6631e-02],
         [ 1.2047e-01,  8.6638e-02],
         [ 8.5239e-02,  8.6638e-02],
         [ 6.3993e-02,  8.6640e-02],
         [ 6.4451e-02,  8.6628e-02],
         [ 6.6542e-02,  8.6626e-02],
         [ 7.0874e-02,  8.6623e-02],
         [ 1.5153e-02,  8.6623e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0466e-01,  7.6961e-02],
         [ 1.2081e-01,  8.9939e-02],
         [ 1.2231e-01,  8.7354e-02],
         [ 1.3990e-01,  9.8779e-02],
         [ 1.3953e-01,  9.4267e-02],
         [ 1.6131e-01,  1.0355e-01],
         [ 1.5254e-01,  6.6097e-02],
         [ 1.4975e-01,  9.4731e-02],
         [ 1.4914e-01,  9.8510e-02],
         [ 1.2482e-01,  8.0473e-02],
         [ 1.4999e-01,  6.8663e-02],
         [ 1.4629e-01,  5.3028e-02],
         [ 1.5520e-01,  6.7480e-02],
         [ 1.4539e-01,  5.1796e-02],
         [ 1.3639e-01,  4.5111e-02],
         [ 1.1051e-01,  7.4430e-02],
         [ 1.2334e-01,  8.6685e-02],
         [ 1.1740e-01,  9.1244e-02],
         [ 1.5144e-01,  1.0633e-01],
         [ 1.4235e-01,  9.7869e-02],
         [ 1.3952e-01,  9.9027e-02],
         [ 1.4525e-01,  8.6583e-02],
         [ 1.0427e-01,  6.0639e-02],
         [ 1.2775e-01,  8.0092e-02],
         [ 1.2372e-01,  6.4347e-02],
         [ 1.3768e-01,  5.4828e-02],
         [ 1.5368e-01,  6.9366e-02],
         [ 1.5876e-01,  5.8694e-02],
         [ 1.3268e-01,  7.2545e-02],
         [ 1.2031e-01,  6.5333e-02],
         [ 1.2923e-01,  5.7992e-02],
         [ 1.1720e-01,  4.6174e-02],
         [ 1.3872e-01,  4.7620e-02],
         [ 1.0599e-01,  7.9426e-02],
         [ 9.5487e-02,  1.1152e-01],
         [ 1.3490e-01,  1.1755e-01],
         [ 1.1206e-01,  1.0036e-01],
         [ 1.4349e-01,  1.0955e-01],
         [ 1.3476e-01,  1.0639e-01],
         [ 1.4872e-01,  9.7610e-02],
         [ 1.5697e-01,  9.6288e-02],
         [ 1.2063e-01,  7.3455e-02],
         [ 1.2625e-01,  7.4572e-02],
         [ 1.2697e-01,  6.4852e-02],
         [ 1.4947e-01,  7.8990e-02],
         [ 1.4972e-01,  9.0288e-02],
         [ 1.2795e-01,  9.3664e-02],
         [ 1.4190e-01,  9.2992e-02],
         [ 1.5194e-01,  1.0620e-01],
         [ 1.3323e-01,  7.5553e-02],
         [ 1.4904e-01,  8.6374e-02],
         [ 1.3163e-01,  1.2021e-01],
         [ 1.4596e-01,  1.2630e-01],
         [ 1.6666e-01,  1.3224e-01],
         [ 1.6696e-01,  1.0773e-01],
         [ 1.5699e-01,  1.2064e-01],
         [ 1.7625e-01,  1.3670e-01],
         [ 1.8244e-01,  1.3757e-01],
         [ 1.8811e-01,  1.3873e-01],
         [ 1.5738e-01,  1.1883e-01],
         [ 1.3609e-01,  9.7599e-02],
         [ 1.4451e-01,  9.3752e-02],
         [ 1.1339e-01,  8.6386e-02],
         [ 1.1416e-01,  6.4354e-02],
         [ 1.0734e-01,  6.8320e-02],
         [ 1.5758e-01,  9.4387e-02],
         [ 1.5895e-01,  1.0068e-01],
         [ 1.7448e-01,  1.0014e-01],
         [ 1.7553e-01,  9.6236e-02],
         [ 1.6950e-01,  1.0962e-01],
         [ 1.2877e-01,  1.1952e-01],
         [ 1.5375e-01,  9.8626e-02],
         [ 1.3527e-01,  4.0731e-02],
         [ 1.3191e-01,  6.8025e-02],
         [ 1.2417e-01,  7.9609e-02],
         [ 1.6040e-01,  8.4147e-02],
         [ 1.5209e-01,  8.5781e-02],
         [ 1.0677e-01,  8.6307e-02],
         [ 1.2919e-01,  8.6469e-02],
         [ 1.4290e-01,  8.6509e-02],
         [ 1.5958e-01,  8.6527e-02],
         [ 1.6558e-01,  8.6528e-02],
         [ 1.2964e-01,  8.6553e-02],
         [ 1.4985e-01,  8.6603e-02],
         [ 1.6377e-01,  8.6581e-02],
         [ 1.6700e-01,  8.6611e-02],
         [ 1.4951e-01,  8.6604e-02],
         [ 1.5297e-01,  8.6616e-02],
         [ 1.4590e-01,  8.6620e-02],
         [ 1.2872e-01,  8.6616e-02],
         [ 1.4530e-01,  8.6624e-02],
         [ 1.1051e-01,  8.6624e-02],
         [ 1.3160e-01,  8.6621e-02],
         [ 1.3907e-01,  8.6622e-02],
         [ 1.0832e-01,  8.6624e-02],
         [ 1.6739e-02,  8.6620e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.0048e-05, device='cuda:0') tensor(0.0016, device='cuda:0') tensor(-0.0017, device='cuda:0')
mixer_td_error tensor(0.5490, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2549, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.0375, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0857, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1880, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0042, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2499999.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1941, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.3140e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0017, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0995, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0648, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0995, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18166
target_mac_out tensor([[[[-1.0000e+07,  7.3491e-02,  1.6030e-01,  ...,  1.2384e-01,
            1.0686e-01, -1.0000e+07],
          [-1.0000e+07,  8.7470e-02,  1.2344e-01,  ...,  9.0087e-02,
            7.7106e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.6140e-02,  1.7658e-01,  ...,  1.4275e-01,
            1.2011e-01, -1.0000e+07],
          [-1.0000e+07,  9.6395e-02,  1.3210e-01,  ...,  9.6823e-02,
            7.3249e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.4414e-02,  1.9030e-01,  ...,  1.5641e-01,
            1.3701e-01, -1.0000e+07],
          [-1.0000e+07,  1.0163e-01,  1.3753e-01,  ...,  9.6222e-02,
            7.0185e-02, -1.0000e+07]],

         ...,

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  4.3512e-02,  3.8668e-02,  ...,  2.0586e-02,
           -1.4253e-02, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  4.7626e-02,  6.0708e-02,  ...,  3.3638e-02,
           -1.2501e-03, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 6.8770e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.7158e-02,  1.4464e-01,  ...,  1.0220e-01,
            9.3161e-02, -1.0000e+07],
          [-1.0000e+07,  7.1278e-02,  9.9201e-02,  ...,  5.7853e-02,
            6.3885e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.5560e-02,  1.5947e-01,  ...,  1.1688e-01,
            1.0898e-01, -1.0000e+07],
          [-1.0000e+07,  7.1961e-02,  9.8523e-02,  ...,  5.3476e-02,
            6.1446e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.4177e-02,  1.4056e-01,  ...,  1.0074e-01,
            8.8327e-02, -1.0000e+07],
          [-1.0000e+07,  8.8503e-02,  1.1739e-01,  ...,  6.8473e-02,
            7.7024e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.6030e-01,  1.2344e-01],
         [ 1.7658e-01,  1.3210e-01],
         [ 1.9030e-01,  1.3753e-01],
         [ 1.7151e-01,  1.2699e-01],
         [ 1.3898e-01,  1.3163e-01],
         [ 1.5649e-01,  6.8053e-02],
         [ 1.6133e-01,  6.7402e-02],
         [ 1.6044e-01,  6.1818e-02],
         [ 1.5626e-01,  9.9836e-02],
         [ 1.3891e-01,  1.0867e-01],
         [ 1.5401e-01,  1.1544e-01],
         [ 1.4617e-01,  6.4902e-02],
         [ 1.2783e-01,  6.7082e-02],
         [ 1.5986e-01,  6.2705e-02],
         [ 1.4496e-01,  9.1459e-02],
         [ 1.2729e-01,  7.1231e-02],
         [ 1.7327e-01,  9.6746e-02],
         [ 1.7994e-01,  9.1019e-02],
         [ 1.8166e-01,  1.0753e-01],
         [ 1.8640e-01,  1.0190e-01],
         [ 1.6475e-01,  1.0329e-01],
         [ 1.7886e-01,  1.0889e-01],
         [ 1.8693e-01,  9.4249e-02],
         [ 1.8895e-01,  9.9784e-02],
         [ 1.9259e-01,  9.8763e-02],
         [ 1.8409e-01,  9.6981e-02],
         [ 1.5299e-01,  8.5667e-02],
         [ 1.6323e-01,  8.2836e-02],
         [ 1.5531e-01,  8.6312e-02],
         [ 1.4021e-01,  9.6363e-02],
         [ 1.6306e-01,  9.2319e-02],
         [ 1.6235e-01,  7.6221e-02],
         [ 1.8446e-01,  9.5304e-02],
         [ 1.9136e-01,  1.0986e-01],
         [ 1.7267e-01,  9.4175e-02],
         [ 1.5731e-01,  8.6366e-02],
         [ 1.6595e-01,  9.1854e-02],
         [ 3.5446e-02,  7.6597e-02],
         [ 4.6520e-02,  6.5795e-02],
         [ 5.4047e-02,  6.0887e-02],
         [ 5.7979e-02,  5.3065e-02],
         [ 5.9670e-02,  5.4334e-02],
         [ 6.0239e-02,  7.1397e-02],
         [ 6.0301e-02,  5.7198e-02],
         [ 6.0223e-02,  5.0358e-02],
         [ 6.0100e-02,  5.3574e-02],
         [ 5.9993e-02,  3.7320e-02],
         [ 5.9913e-02,  5.5704e-02],
         [ 5.9847e-02,  6.1755e-02],
         [ 5.9807e-02,  4.5485e-02],
         [ 5.9789e-02,  6.0848e-02],
         [ 5.9796e-02,  5.7900e-02],
         [ 5.9769e-02,  4.2928e-02],
         [ 5.9758e-02,  3.8366e-02],
         [ 5.9753e-02,  6.9613e-02],
         [ 5.9771e-02,  8.4009e-02],
         [ 5.9768e-02,  8.9065e-02],
         [ 5.9766e-02,  9.2050e-02],
         [ 5.9768e-02,  6.5186e-02],
         [ 5.9767e-02,  6.9533e-02],
         [ 5.9761e-02,  4.1016e-02],
         [ 5.9761e-02,  4.7039e-02],
         [ 5.9763e-02,  7.5938e-02],
         [ 5.9762e-02,  8.6777e-02],
         [ 5.9762e-02,  6.8490e-02],
         [ 5.9762e-02,  7.7695e-02],
         [ 5.9762e-02,  6.6871e-02],
         [ 5.9762e-02,  7.2814e-02],
         [ 5.9762e-02,  6.4154e-02],
         [ 5.9762e-02,  8.6472e-02],
         [ 5.9762e-02,  6.8468e-02],
         [ 5.9762e-02,  7.9773e-02],
         [ 5.9762e-02,  9.3548e-02],
         [ 5.9762e-02,  7.3216e-02],
         [ 5.9762e-02,  7.8699e-02],
         [ 5.9762e-02,  5.3339e-02],
         [ 5.9762e-02,  4.5731e-02],
         [ 5.9762e-02,  7.5435e-02],
         [ 5.9762e-02,  7.7473e-02],
         [ 5.9762e-02,  7.6225e-02],
         [ 5.9762e-02,  4.3512e-02],
         [ 5.9762e-02,  6.0708e-02],
         [ 5.9762e-02,  6.8770e-02]],

        [[ 1.4464e-01,  9.9201e-02],
         [ 1.5947e-01,  9.8523e-02],
         [ 1.4056e-01,  1.1739e-01],
         [ 1.4284e-01,  1.0899e-01],
         [ 1.1749e-01,  1.1222e-01],
         [ 1.3990e-01,  1.0575e-01],
         [ 1.4866e-01,  9.6790e-02],
         [ 1.3988e-01,  1.0806e-01],
         [ 1.6216e-01,  1.0605e-01],
         [ 1.5923e-01,  1.0594e-01],
         [ 1.6482e-01,  5.3622e-02],
         [ 1.0157e-01,  8.8933e-02],
         [ 1.3344e-01,  4.6469e-02],
         [ 1.6388e-01,  4.4356e-02],
         [ 1.6961e-01,  8.0042e-02],
         [ 1.3640e-01,  7.5043e-02],
         [ 1.5723e-01,  1.1795e-01],
         [ 1.5916e-01,  1.2651e-01],
         [ 1.2743e-01,  1.2832e-01],
         [ 1.0188e-01,  9.2389e-02],
         [ 1.0635e-01,  9.2303e-02],
         [ 9.6581e-02,  8.5606e-02],
         [ 9.5989e-02,  4.9044e-02],
         [ 1.0737e-01,  6.9163e-02],
         [ 9.6216e-02,  6.5184e-02],
         [ 1.0773e-01,  6.2213e-02],
         [ 9.7382e-02,  3.1191e-02],
         [ 9.0663e-02,  2.8474e-02],
         [ 8.7781e-02,  6.2435e-02],
         [ 8.5993e-02,  7.7481e-02],
         [ 1.0623e-01,  8.3706e-02],
         [ 1.0709e-01,  8.6041e-02],
         [ 1.2094e-01,  8.6790e-02],
         [ 1.2329e-01,  8.6909e-02],
         [ 1.0869e-01,  8.6853e-02],
         [ 1.0973e-01,  8.6766e-02],
         [ 1.0141e-01,  8.6680e-02],
         [ 9.5416e-02,  8.6633e-02],
         [ 9.2309e-02,  8.6631e-02],
         [ 1.0794e-01,  8.6624e-02],
         [ 9.8678e-02,  8.6597e-02],
         [ 1.1432e-01,  8.6630e-02],
         [ 1.2323e-01,  8.6637e-02],
         [ 1.3562e-01,  8.6624e-02],
         [ 1.3932e-01,  8.6627e-02],
         [ 1.1156e-01,  8.6643e-02],
         [ 1.2408e-01,  8.6625e-02],
         [ 1.4102e-01,  8.6619e-02],
         [ 1.5474e-01,  8.6621e-02],
         [ 1.5786e-01,  8.6624e-02],
         [ 1.5649e-01,  8.6622e-02],
         [ 1.5718e-01,  8.6623e-02],
         [ 1.2293e-01,  8.6621e-02],
         [ 1.4877e-01,  8.6621e-02],
         [ 1.4057e-01,  8.6621e-02],
         [ 1.5118e-01,  8.6621e-02],
         [ 1.5157e-01,  8.6621e-02],
         [ 1.5260e-01,  8.6621e-02],
         [ 1.3351e-01,  8.6621e-02],
         [ 1.3811e-01,  8.6621e-02],
         [ 1.3410e-01,  8.6621e-02],
         [ 9.3812e-02,  8.6621e-02],
         [ 1.1767e-01,  8.6621e-02],
         [ 6.5930e-03,  8.6621e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.2450e-05, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0013, device='cuda:0')
mixer_td_error tensor(0.2489, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2282, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.5209, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0877, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0021, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1144578.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1926, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.6879e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0971, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1158, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0971, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18212
target_mac_out tensor([[[[-1.0000e+07,  6.7856e-02,  1.2627e-01,  ...,  8.1598e-02,
            6.5922e-02, -1.0000e+07],
          [-1.0000e+07,  8.9393e-02,  1.1920e-01,  ...,  8.7495e-02,
            7.6975e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.0750e-02,  1.0145e-01,  ...,  7.2403e-02,
            5.7438e-02, -1.0000e+07],
          [-1.0000e+07,  9.2742e-02,  9.2133e-02,  ...,  7.7177e-02,
            5.9189e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0808e-01,  1.3572e-01,  ...,  9.9386e-02,
            7.3288e-02, -1.0000e+07],
          [-1.0000e+07,  1.0229e-01,  9.4698e-02,  ...,  8.0447e-02,
            5.7151e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  5.4993e-02,  8.4272e-02,  ..., -1.0000e+07,
            7.0476e-02, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  5.5259e-02,  8.5531e-02,  ..., -1.0000e+07,
            7.7387e-02, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  7.4597e-02,  7.7611e-02,  ...,  6.5149e-02,
            5.0060e-02, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.7981e-02,  1.4147e-01,  ...,  1.0255e-01,
            9.2708e-02, -1.0000e+07],
          [-1.0000e+07,  7.1672e-02,  8.2355e-02,  ...,  6.9628e-02,
            6.5286e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.5802e-02,  1.1629e-01,  ...,  9.9791e-02,
            7.4140e-02, -1.0000e+07],
          [-1.0000e+07,  8.5623e-02,  9.6668e-02,  ...,  6.0761e-02,
            5.8922e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.1180e-01,  1.4262e-01,  ...,  1.1542e-01,
            8.8286e-02, -1.0000e+07],
          [-1.0000e+07,  7.9185e-02,  1.0075e-01,  ...,  5.6944e-02,
            5.8752e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.2627e-01,  1.1920e-01],
         [ 1.0145e-01,  9.2133e-02],
         [ 1.3572e-01,  1.0229e-01],
         ...,
         [ 7.0476e-02,  8.6621e-02],
         [ 7.7387e-02,  8.6621e-02],
         [ 7.7611e-02,  8.6621e-02]],

        [[ 1.4147e-01,  8.2355e-02],
         [ 1.1629e-01,  9.6668e-02],
         [ 1.4262e-01,  1.0075e-01],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.0667e-05, device='cuda:0') tensor(0.0001, device='cuda:0') tensor(-0.0003, device='cuda:0')
mixer_td_error tensor(0.7305, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2305, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3245, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0777, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2133, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0067, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3216666.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2022, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.0322e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(7.3980e-05, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0897, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1267, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0897, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18258
target_mac_out tensor([[[[-1.0000e+07,  6.9599e-02,  1.4677e-01,  ...,  1.0242e-01,
            9.3299e-02, -1.0000e+07],
          [-1.0000e+07,  8.7257e-02,  1.1851e-01,  ...,  8.8504e-02,
            7.6273e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.0944e-02,  1.5243e-01,  ...,  1.0602e-01,
            8.9578e-02, -1.0000e+07],
          [-1.0000e+07,  7.9733e-02,  1.0918e-01,  ...,  8.1989e-02,
            6.3616e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0608e-01,  1.8091e-01,  ...,  1.4006e-01,
            1.1465e-01, -1.0000e+07],
          [-1.0000e+07,  9.9654e-02,  1.2931e-01,  ...,  1.0710e-01,
            8.1248e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.3491e-02,  1.6030e-01,  ...,  1.2384e-01,
            1.0686e-01, -1.0000e+07],
          [-1.0000e+07,  8.7470e-02,  1.2344e-01,  ...,  9.0087e-02,
            7.7106e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.6844e-02,  1.7316e-01,  ...,  1.4236e-01,
            1.1981e-01, -1.0000e+07],
          [-1.0000e+07,  9.2775e-02,  9.5394e-02,  ...,  8.3725e-02,
            6.9997e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.8505e-02,  1.7757e-01,  ...,  1.4181e-01,
            1.2134e-01, -1.0000e+07],
          [-1.0000e+07,  9.5624e-02,  8.5364e-02,  ...,  8.2277e-02,
            6.2526e-02, -1.0000e+07]],

         ...,

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  4.6541e-02,  7.1194e-02,  ...,  5.1109e-02,
            2.0507e-02, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  5.3779e-02,  7.7310e-02,  ...,  5.9343e-02,
            2.5953e-02, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 6.5908e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.4677e-01,  1.1851e-01],
         [ 1.5243e-01,  1.0918e-01],
         [ 1.8091e-01,  1.2931e-01],
         [ 1.9055e-01,  1.3512e-01],
         [ 1.8505e-01,  1.3466e-01],
         [ 1.8681e-01,  1.3877e-01],
         [ 1.8156e-01,  1.4373e-01],
         [ 1.4368e-01,  1.2556e-01],
         [ 1.4396e-01,  8.2719e-02],
         [ 1.3607e-01,  1.1215e-01],
         [ 1.5426e-01,  6.9725e-02],
         [ 1.5406e-01,  2.8924e-02],
         [ 1.2641e-01,  7.6594e-02],
         [ 1.4600e-01,  5.4277e-02],
         [ 1.5774e-01,  3.1712e-02],
         [ 1.2853e-01,  4.0842e-02],
         [ 1.4494e-01,  2.4768e-02],
         [ 1.4437e-01,  5.1933e-02],
         [ 1.4945e-01,  6.4698e-02],
         [ 1.4420e-01,  7.1575e-02],
         [ 1.1670e-01,  6.0191e-02],
         [ 1.3275e-01,  6.6990e-02],
         [ 1.4251e-01,  2.8421e-02],
         [ 1.5630e-01,  7.9874e-02],
         [ 1.5647e-01,  4.4074e-02],
         [ 1.4243e-01,  1.5724e-02],
         [ 1.3577e-01,  5.6357e-02],
         [ 1.3076e-01,  3.3852e-02],
         [ 1.1392e-01,  3.4637e-02],
         [ 2.2699e-02,  3.9385e-02],
         [ 4.1041e-02,  6.8543e-02],
         [ 5.2108e-02,  6.1454e-02],
         [ 5.7472e-02,  6.5448e-02],
         [ 5.9658e-02,  7.8524e-02],
         [ 6.0308e-02,  6.3046e-02],
         [ 6.0322e-02,  6.0359e-02],
         [ 6.0203e-02,  7.3597e-02],
         [ 6.0042e-02,  8.1463e-02],
         [ 5.9926e-02,  6.5524e-02],
         [ 5.9841e-02,  6.1413e-02],
         [ 5.9790e-02,  7.1357e-02],
         [ 5.9785e-02,  5.6126e-02],
         [ 5.9766e-02,  6.5773e-02],
         [ 5.9770e-02,  5.6486e-02],
         [ 5.9764e-02,  4.8195e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.6030e-01,  1.2344e-01],
         [ 1.7316e-01,  9.5394e-02],
         [ 1.7757e-01,  9.5624e-02],
         [ 1.8728e-01,  9.0312e-02],
         [ 1.7621e-01,  9.5461e-02],
         [ 1.8398e-01,  1.1316e-01],
         [ 1.8300e-01,  1.1747e-01],
         [ 1.4776e-01,  1.1525e-01],
         [ 1.4182e-01,  1.0884e-01],
         [ 1.4253e-01,  8.4104e-02],
         [ 1.5453e-01,  8.1511e-02],
         [ 1.6727e-01,  9.5104e-02],
         [ 1.5553e-01,  7.8462e-02],
         [ 1.6766e-01,  7.8316e-02],
         [ 1.6423e-01,  3.6290e-02],
         [ 1.6205e-01,  8.0864e-02],
         [ 1.6649e-01,  7.7193e-02],
         [ 1.5113e-01,  9.6157e-02],
         [ 1.3766e-01,  1.0392e-01],
         [ 1.4937e-01,  8.5870e-02],
         [ 1.4820e-01,  1.0136e-01],
         [ 1.3094e-01,  7.7594e-02],
         [ 1.5047e-01,  7.5647e-02],
         [ 1.5655e-01,  7.3583e-02],
         [ 1.7050e-01,  9.7408e-02],
         [ 1.6061e-01,  1.0719e-01],
         [ 1.6231e-01,  1.0906e-01],
         [ 1.6814e-01,  4.3624e-02],
         [ 1.8506e-01,  1.0404e-01],
         [ 1.9177e-01,  1.1129e-01],
         [ 1.9632e-01,  1.3738e-01],
         [ 2.0830e-01,  1.4060e-01],
         [ 1.8604e-01,  9.3364e-02],
         [ 1.4818e-01,  9.1612e-02],
         [ 1.5873e-01,  1.0049e-01],
         [ 1.4559e-01,  9.7499e-02],
         [ 1.6437e-01,  8.3070e-02],
         [ 1.8982e-01,  1.1102e-01],
         [ 1.7359e-01,  1.1952e-01],
         [ 1.6209e-01,  1.1973e-01],
         [ 1.6491e-01,  1.1973e-01],
         [ 1.8161e-01,  4.3481e-02],
         [ 6.8176e-03,  8.0851e-02],
         [ 3.6137e-02,  7.7702e-02],
         [ 5.0206e-02,  6.8380e-02],
         [ 5.6532e-02,  8.4426e-03],
         [ 5.9159e-02,  7.4006e-02],
         [ 6.0094e-02,  8.6456e-02],
         [ 6.0276e-02,  7.8959e-02],
         [ 6.0244e-02,  3.1738e-02],
         [ 6.0134e-02,  8.2805e-02],
         [ 6.0002e-02,  9.1073e-02],
         [ 5.9924e-02,  8.6754e-02],
         [ 5.9872e-02,  8.7445e-02],
         [ 5.9816e-02,  7.2307e-02],
         [ 5.9792e-02,  6.6901e-02],
         [ 5.9775e-02,  8.5310e-02],
         [ 5.9772e-02,  4.8540e-02],
         [ 5.9758e-02,  5.5974e-02],
         [ 5.9749e-02,  4.7802e-02],
         [ 5.9767e-02,  5.6303e-02],
         [ 5.9763e-02,  5.8802e-02],
         [ 5.9767e-02,  4.9123e-02],
         [ 5.9770e-02,  6.3383e-02],
         [ 5.9760e-02,  6.5647e-02],
         [ 5.9761e-02,  7.9155e-02],
         [ 5.9763e-02,  5.2000e-02],
         [ 5.9762e-02,  4.7095e-02],
         [ 5.9762e-02,  4.2445e-02],
         [ 5.9762e-02,  5.4678e-02],
         [ 5.9762e-02,  7.5092e-02],
         [ 5.9762e-02,  7.8756e-02],
         [ 5.9762e-02,  8.0395e-02],
         [ 5.9762e-02,  6.3781e-02],
         [ 5.9762e-02,  7.1194e-02],
         [ 5.9762e-02,  7.7310e-02],
         [ 5.9762e-02,  6.5908e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.6911e-05, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0021, device='cuda:0')
mixer_td_error tensor(0.4545, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2283, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8962, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0855, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2125, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0020, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2077921.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2083, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.1091e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0018, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0972, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1553, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0972, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18303
target_mac_out tensor([[[[-1.0000e+07,  6.9599e-02,  1.4677e-01,  ...,  1.0242e-01,
            9.3299e-02, -1.0000e+07],
          [-1.0000e+07,  8.7257e-02,  1.1851e-01,  ...,  8.8504e-02,
            7.6273e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.4873e-02,  1.7752e-01,  ...,  1.4110e-01,
            1.2285e-01, -1.0000e+07],
          [-1.0000e+07,  8.2637e-02,  1.1716e-01,  ...,  8.4098e-02,
            6.4471e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.1703e-01,  1.8751e-01,  ...,  1.6223e-01,
            1.3465e-01, -1.0000e+07],
          [-1.0000e+07,  8.2634e-02,  1.2061e-01,  ...,  8.5744e-02,
            6.0006e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.4205e-02,  1.1228e-01,  ...,  9.1248e-02,
            6.3033e-02, -1.0000e+07],
          [-1.0000e+07,  8.6895e-02,  1.1351e-01,  ...,  8.6502e-02,
            7.5577e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.8613e-02,  1.2749e-01,  ...,  9.0168e-02,
            6.4244e-02, -1.0000e+07],
          [-1.0000e+07,  9.1997e-02,  8.3691e-02,  ...,  7.6360e-02,
            6.9313e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.7641e-02,  1.5377e-01,  ...,  1.1056e-01,
            9.4059e-02, -1.0000e+07],
          [-1.0000e+07,  9.8549e-02,  1.0470e-01,  ...,  7.9789e-02,
            7.5827e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  7.4920e-02,  1.5035e-01,  ...,  1.1255e-01,
            6.9382e-02,  6.6708e-02],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  7.0430e-02,  1.1452e-01,  ...,  9.2245e-02,
            4.0917e-02,  5.2683e-02],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.4499e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.4677e-01,  1.1851e-01],
         [ 1.7752e-01,  1.1716e-01],
         [ 1.8751e-01,  1.2061e-01],
         [ 1.8239e-01,  1.0970e-01],
         [ 1.7473e-01,  1.1633e-01],
         [ 1.7139e-01,  1.3148e-01],
         [ 1.7071e-01,  1.1658e-01],
         [ 1.4387e-01,  7.1173e-02],
         [ 1.4773e-01,  7.0868e-02],
         [ 1.4450e-01,  7.1952e-02],
         [ 1.5430e-01,  8.0129e-02],
         [ 1.3866e-01,  1.4037e-01],
         [ 1.5223e-01,  1.6663e-01],
         [ 1.5572e-01,  9.0259e-02],
         [ 1.5275e-01,  8.2337e-02],
         [ 1.4933e-01,  6.5256e-02],
         [ 1.3803e-01,  1.2289e-01],
         [ 1.3324e-01,  1.4880e-01],
         [ 1.3692e-01,  1.2624e-01],
         [ 1.4983e-01,  1.3512e-01],
         [ 1.4123e-01,  1.3206e-01],
         [ 1.5927e-01,  1.0113e-01],
         [ 1.6649e-01,  1.0441e-01],
         [ 1.6536e-01,  9.3294e-02],
         [ 1.6736e-01,  1.1322e-01],
         [ 2.7084e-02,  1.0675e-01],
         [ 4.5192e-02,  8.6329e-02],
         [ 5.4611e-02,  8.9198e-02],
         [ 5.8793e-02,  6.5495e-02],
         [ 6.0365e-02,  6.0770e-02],
         [ 6.0747e-02,  5.7074e-02],
         [ 6.0660e-02,  5.6455e-02],
         [ 6.0434e-02,  7.6471e-02],
         [ 6.0236e-02,  9.6656e-02],
         [ 6.0060e-02,  6.4590e-02],
         [ 5.9969e-02,  9.0548e-02],
         [ 5.9882e-02,  9.1732e-02],
         [ 5.9841e-02,  8.4435e-02],
         [ 5.9809e-02,  8.7224e-02],
         [ 5.9790e-02,  8.7477e-02],
         [ 5.9760e-02,  8.0772e-02],
         [ 5.9759e-02,  7.6872e-02],
         [ 5.9763e-02,  7.2704e-02],
         [ 5.9766e-02,  4.3345e-02],
         [ 5.9763e-02,  4.1561e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.1228e-01,  1.1351e-01],
         [ 1.2749e-01,  9.1997e-02],
         [ 1.5377e-01,  1.0470e-01],
         [ 1.5978e-01,  9.8539e-02],
         [ 1.6191e-01,  1.2273e-01],
         [ 1.2609e-01,  1.2226e-01],
         [ 1.0767e-01,  9.5148e-02],
         [ 1.3222e-01,  1.1061e-01],
         [ 1.2442e-01,  8.5497e-02],
         [ 1.4827e-01,  6.0578e-02],
         [ 1.4518e-01,  6.1947e-02],
         [ 1.5415e-01,  6.5701e-02],
         [ 1.2970e-01,  8.1909e-02],
         [ 1.2992e-01,  1.0984e-01],
         [ 1.4607e-01,  1.3378e-01],
         [ 1.4007e-01,  9.8156e-02],
         [ 1.2566e-01,  5.5977e-02],
         [ 1.3293e-01,  5.3714e-02],
         [ 1.0337e-01,  6.3191e-02],
         [ 1.0337e-01,  7.0427e-02],
         [ 1.0825e-01,  7.2322e-02],
         [ 1.1107e-01,  6.2235e-02],
         [ 1.1170e-01,  7.0046e-02],
         [ 9.4099e-02,  3.3142e-02],
         [ 9.1085e-02,  2.7924e-02],
         [ 8.6175e-02,  5.3219e-02],
         [ 8.6593e-02,  3.5721e-02],
         [ 1.0089e-01,  2.6027e-02],
         [ 8.7213e-02,  5.9792e-02],
         [ 9.7343e-02,  6.7259e-02],
         [ 9.3240e-02,  3.6433e-02],
         [ 8.7359e-02,  6.2856e-02],
         [ 8.9400e-02,  5.0546e-02],
         [ 1.0577e-01,  2.8227e-02],
         [ 1.3913e-01,  5.9387e-02],
         [ 1.0923e-01,  5.7459e-02],
         [ 1.1034e-01,  4.6714e-02],
         [ 1.2582e-01,  3.4053e-02],
         [ 1.1697e-01,  4.0507e-02],
         [ 1.2708e-01,  4.3613e-02],
         [ 1.1560e-01,  6.1405e-02],
         [ 1.3747e-01,  7.4199e-02],
         [ 1.4783e-01,  6.1970e-02],
         [ 1.0886e-01,  7.7144e-02],
         [ 1.0835e-01,  8.5138e-02],
         [ 1.1341e-01,  6.9232e-02],
         [ 9.4704e-02,  6.7288e-02],
         [ 1.0798e-01,  7.2092e-02],
         [ 1.1378e-01,  3.8908e-02],
         [ 1.3422e-01,  2.0059e-02],
         [ 1.2437e-01,  4.2920e-02],
         [ 1.0099e-01,  5.1399e-02],
         [ 8.1792e-02,  2.3927e-02],
         [ 1.0148e-01,  4.4303e-02],
         [ 1.2280e-01,  6.6919e-02],
         [ 1.3139e-01,  7.8473e-02],
         [ 1.1822e-01,  8.3736e-02],
         [ 1.3887e-01,  8.5803e-02],
         [ 1.4846e-01,  8.6486e-02],
         [ 1.4096e-01,  8.6667e-02],
         [ 1.3712e-01,  8.6671e-02],
         [ 1.1893e-01,  8.6631e-02],
         [ 1.2245e-01,  8.6612e-02],
         [ 9.8720e-02,  8.6587e-02],
         [ 8.5142e-02,  8.6587e-02],
         [ 7.6995e-02,  8.6597e-02],
         [ 9.4662e-02,  8.6617e-02],
         [ 9.0531e-02,  8.6605e-02],
         [ 7.8119e-02,  8.6598e-02],
         [ 8.4197e-02,  8.6622e-02],
         [ 9.8780e-02,  8.6626e-02],
         [ 9.0933e-02,  8.6616e-02],
         [ 8.9355e-02,  8.6620e-02],
         [ 9.0633e-02,  8.6619e-02],
         [ 8.1954e-02,  8.6624e-02],
         [ 8.5292e-02,  8.6623e-02],
         [ 1.0042e-01,  8.6623e-02],
         [ 9.1570e-02,  8.6621e-02],
         [ 9.1138e-02,  8.6621e-02],
         [ 1.0411e-01,  8.6621e-02],
         [ 9.4734e-02,  8.6621e-02],
         [ 9.0533e-02,  8.6621e-02],
         [ 1.0615e-01,  8.6621e-02],
         [ 9.6710e-02,  8.6621e-02],
         [ 8.9935e-02,  8.6621e-02],
         [ 8.9523e-02,  8.6621e-02],
         [ 8.9071e-02,  8.6621e-02],
         [ 9.0322e-02,  8.6621e-02],
         [ 1.0885e-01,  8.6621e-02],
         [ 9.7373e-02,  8.6621e-02],
         [ 9.4791e-02,  8.6621e-02],
         [ 1.0578e-01,  8.6621e-02],
         [ 9.5077e-02,  8.6621e-02],
         [ 9.7547e-02,  8.6621e-02],
         [ 9.2862e-02,  8.6621e-02],
         [ 1.0801e-01,  8.6621e-02],
         [ 1.1332e-01,  8.6621e-02],
         [ 1.4103e-01,  8.6621e-02],
         [ 1.4033e-01,  8.6621e-02],
         [ 1.5056e-01,  8.6621e-02],
         [ 1.4226e-01,  8.6621e-02],
         [ 1.2222e-01,  8.6621e-02],
         [ 1.4023e-01,  8.6621e-02],
         [ 1.3659e-01,  8.6621e-02],
         [ 1.1934e-01,  8.6621e-02],
         [ 1.3890e-01,  8.6621e-02],
         [ 1.3603e-01,  8.6621e-02],
         [ 1.4638e-01,  8.6621e-02],
         [ 1.3903e-01,  8.6621e-02],
         [ 1.3204e-01,  8.6621e-02],
         [ 1.1912e-01,  8.6621e-02],
         [ 9.8288e-02,  8.6621e-02],
         [ 9.7154e-02,  8.6621e-02],
         [ 1.0515e-01,  8.6621e-02],
         [ 9.2772e-02,  8.6621e-02],
         [ 9.9407e-02,  8.6621e-02],
         [ 8.7223e-02,  8.6621e-02],
         [ 8.9505e-02,  8.6621e-02],
         [ 9.3531e-02,  8.6621e-02],
         [ 1.0015e-01,  8.6621e-02],
         [ 1.1275e-01,  8.6621e-02],
         [ 1.0830e-01,  8.6621e-02],
         [ 1.0008e-01,  8.6621e-02],
         [ 1.1434e-01,  8.6621e-02],
         [ 1.1779e-01,  8.6621e-02],
         [ 1.0035e-01,  8.6621e-02],
         [ 1.2976e-01,  8.6621e-02],
         [ 1.1149e-01,  8.6621e-02],
         [ 1.1639e-01,  8.6621e-02],
         [ 1.4988e-01,  8.6621e-02],
         [ 1.6304e-01,  8.6621e-02],
         [ 1.4018e-01,  8.6621e-02],
         [ 1.4554e-01,  8.6621e-02],
         [ 1.5151e-01,  8.6621e-02],
         [ 1.4432e-01,  8.6621e-02],
         [ 1.3523e-01,  8.6621e-02],
         [ 1.5098e-01,  8.6621e-02],
         [ 1.2166e-01,  8.6621e-02],
         [ 1.5705e-01,  8.6621e-02],
         [ 1.5613e-01,  8.6621e-02],
         [ 1.5280e-01,  8.6621e-02],
         [ 1.1946e-01,  8.6621e-02],
         [ 1.3382e-01,  8.6621e-02],
         [ 1.4678e-01,  8.6621e-02],
         [ 1.5035e-01,  8.6621e-02],
         [ 1.1452e-01,  8.6621e-02],
         [ 3.4499e-02,  8.6621e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.2499e-06, device='cuda:0') tensor(0.0003, device='cuda:0') tensor(-0.0009, device='cuda:0')
mixer_td_error tensor(0.7723, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2296, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4392, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0767, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2079, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0105, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3469387.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1875, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.4927e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1003, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1238, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1003, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18352
target_mac_out tensor([[[[-1.0000e+07,  7.3359e-02,  1.3533e-01,  ...,  8.9806e-02,
            7.4978e-02, -1.0000e+07],
          [-1.0000e+07,  5.9472e-02,  9.0317e-02,  ...,  5.6118e-02,
            5.9829e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.3171e-02,  1.6704e-01,  ...,  1.3097e-01,
            1.1025e-01, -1.0000e+07],
          [-1.0000e+07,  7.7363e-02,  1.0463e-01,  ...,  5.6842e-02,
            6.0311e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0399e-01,  1.2908e-01,  ...,  1.1654e-01,
            8.4586e-02, -1.0000e+07],
          [-1.0000e+07,  8.2276e-02,  1.0327e-01,  ...,  5.3814e-02,
            6.0991e-02, -1.0000e+07]],

         ...,

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  4.0014e-02,  3.8304e-02,  ...,  1.9362e-02,
            1.5861e-03, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  5.2250e-02,  5.6109e-02,  ...,  3.2925e-02,
            1.3365e-02, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.5232e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.7158e-02,  1.4464e-01,  ...,  1.0220e-01,
            9.3161e-02, -1.0000e+07],
          [-1.0000e+07,  7.1278e-02,  9.9201e-02,  ...,  5.7853e-02,
            6.3885e-02, -1.0000e+07]],

         [[-1.0000e+07,  7.9444e-02,  1.0675e-01,  ...,  8.2035e-02,
            7.0133e-02, -1.0000e+07],
          [-1.0000e+07,  6.0752e-02,  5.5946e-02,  ...,  3.7517e-02,
            4.4867e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0467e-01,  9.5608e-02,  ...,  9.0587e-02,
            7.5298e-02, -1.0000e+07],
          [-1.0000e+07,  5.2472e-02,  1.5806e-02,  ...,  3.0067e-02,
            2.1431e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.3533e-01,  9.0317e-02],
         [ 1.6704e-01,  1.0463e-01],
         [ 1.2908e-01,  1.0327e-01],
         [ 1.4759e-01,  5.6146e-02],
         [ 1.6266e-01,  1.0390e-01],
         [ 1.5233e-01,  1.1080e-01],
         [ 1.5524e-01,  2.5881e-02],
         [ 1.5500e-01,  1.2716e-02],
         [ 1.5091e-01,  2.6905e-02],
         [ 1.4818e-01,  5.6656e-02],
         [ 1.2560e-01,  2.0132e-02],
         [ 1.1738e-01,  5.6380e-02],
         [ 1.2806e-01,  1.7817e-02],
         [ 1.4440e-01,  6.0969e-02],
         [ 1.4691e-01,  6.7027e-02],
         [ 1.2613e-01,  3.5077e-02],
         [ 1.3806e-01,  4.7557e-02],
         [ 1.4211e-01,  3.0870e-02],
         [ 1.3815e-01,  3.5798e-02],
         [ 1.3651e-01,  4.8489e-02],
         [ 1.4639e-01,  7.6965e-02],
         [ 1.4086e-01,  8.4529e-02],
         [ 1.2268e-01,  6.6702e-02],
         [ 1.2591e-01,  6.7052e-02],
         [ 1.3610e-01,  1.0552e-02],
         [ 1.2606e-01,  4.2135e-02],
         [ 1.9239e-02,  5.8807e-02],
         [ 4.1268e-02,  5.1482e-02],
         [ 5.2381e-02,  4.8855e-02],
         [ 5.7428e-02,  4.8915e-02],
         [ 5.9479e-02,  4.6948e-02],
         [ 6.0145e-02,  4.5880e-02],
         [ 6.0216e-02,  4.7799e-02],
         [ 6.0122e-02,  4.4116e-02],
         [ 6.0006e-02,  4.2330e-02],
         [ 5.9918e-02,  4.0556e-02],
         [ 5.9833e-02,  4.7530e-02],
         [ 5.9804e-02,  5.6014e-02],
         [ 5.9782e-02,  8.1054e-02],
         [ 5.9738e-02,  8.7959e-02],
         [ 5.9745e-02,  8.9082e-02],
         [ 5.9749e-02,  8.4004e-02],
         [ 5.9750e-02,  8.4136e-02],
         [ 5.9769e-02,  7.4079e-02],
         [ 5.9768e-02,  7.9226e-02],
         [ 5.9766e-02,  6.9601e-02],
         [ 5.9765e-02,  7.1688e-02],
         [ 5.9759e-02,  7.6590e-02],
         [ 5.9761e-02,  8.4316e-02],
         [ 5.9761e-02,  8.1836e-02],
         [ 5.9763e-02,  4.9904e-02],
         [ 5.9762e-02,  5.4840e-02],
         [ 5.9762e-02,  4.9435e-02],
         [ 5.9762e-02,  4.5927e-02],
         [ 5.9762e-02,  4.8486e-02],
         [ 5.9762e-02,  4.6278e-02],
         [ 5.9762e-02,  5.4298e-02],
         [ 5.9762e-02,  4.9499e-02],
         [ 5.9762e-02,  5.1933e-02],
         [ 5.9762e-02,  5.0411e-02],
         [ 5.9762e-02,  3.8509e-02],
         [ 5.9762e-02,  3.6925e-02],
         [ 5.9762e-02,  3.8116e-02],
         [ 5.9762e-02,  3.8304e-02],
         [ 5.9762e-02,  5.6109e-02],
         [ 5.9762e-02,  4.5232e-02]],

        [[ 1.4464e-01,  9.9201e-02],
         [ 1.0675e-01,  5.5946e-02],
         [ 9.5608e-02,  3.9972e-03],
         [ 1.0615e-01,  4.7650e-02],
         [ 1.0756e-01,  4.8563e-02],
         [ 1.0057e-01,  5.6999e-02],
         [ 9.8023e-02,  3.8882e-02],
         [ 9.5195e-02,  6.7197e-02],
         [ 7.9736e-02,  6.8755e-02],
         [ 8.0124e-02,  9.2470e-02],
         [ 8.0150e-02,  6.8510e-02],
         [ 9.0264e-02,  5.2459e-02],
         [ 7.7653e-02,  7.2067e-02],
         [ 8.1135e-02,  7.6913e-02],
         [ 1.0513e-01,  4.1024e-02],
         [ 7.9019e-02,  4.6044e-02],
         [ 7.6953e-02,  4.7611e-02],
         [ 8.8002e-02,  3.9636e-02],
         [ 7.8303e-02,  4.1139e-02],
         [ 1.0373e-01,  6.1825e-02],
         [ 8.9173e-02,  4.8434e-02],
         [ 9.1893e-02,  7.3388e-02],
         [ 7.4270e-02,  7.3186e-02],
         [ 1.0610e-01,  4.3424e-02],
         [ 8.7343e-02,  6.3576e-02],
         [ 8.9256e-02,  2.5375e-02],
         [ 8.9218e-02,  5.5355e-03],
         [ 1.0695e-01,  3.0338e-02],
         [ 1.2317e-01,  2.5971e-02],
         [ 1.3095e-01,  4.9449e-02],
         [ 1.3455e-01,  6.8853e-02],
         [ 1.3605e-01,  7.8972e-02],
         [ 1.3659e-01,  8.3720e-02],
         [ 1.3898e-01,  8.5717e-02],
         [ 1.3771e-01,  8.6457e-02],
         [ 1.1031e-01,  8.6662e-02],
         [ 1.2896e-01,  8.6702e-02],
         [ 1.5285e-01,  8.6673e-02],
         [ 1.2643e-01,  8.6640e-02],
         [ 1.4072e-01,  8.6626e-02],
         [ 1.5432e-01,  8.6608e-02],
         [ 1.5772e-01,  8.6618e-02],
         [ 1.5753e-01,  8.6611e-02],
         [ 1.2173e-01,  8.6616e-02],
         [ 1.4250e-01,  8.6625e-02],
         [ 1.4790e-01,  8.6625e-02],
         [ 1.1316e-01,  8.6629e-02],
         [ 1.0469e-01,  8.6643e-02],
         [ 8.8541e-02,  8.6623e-02],
         [ 1.0216e-01,  8.6621e-02],
         [ 1.2341e-01,  8.6621e-02],
         [ 9.8954e-02,  8.6624e-02],
         [ 2.3427e-02,  8.6622e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-3.8498e-05, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0012, device='cuda:0')
mixer_td_error tensor(0.2067, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2565, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4459, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0761, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1775, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0033, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-984848.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1670, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.0479e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0005, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0951, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0709, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0951, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18397
target_mac_out tensor([[[[-1.0000e+07,  7.4205e-02,  1.1228e-01,  ...,  9.1248e-02,
            6.3033e-02, -1.0000e+07],
          [-1.0000e+07,  8.6895e-02,  1.1351e-01,  ...,  8.6502e-02,
            7.5577e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.3172e-02,  1.4119e-01,  ...,  1.0166e-01,
            7.2920e-02, -1.0000e+07],
          [-1.0000e+07,  7.8161e-02,  1.0342e-01,  ...,  7.8902e-02,
            6.4295e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0001e-01,  1.4933e-01,  ...,  1.0586e-01,
            7.9429e-02, -1.0000e+07],
          [-1.0000e+07,  8.6378e-02,  1.1266e-01,  ...,  7.9743e-02,
            6.2823e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.7158e-02,  1.4464e-01,  ...,  1.0220e-01,
            9.3161e-02, -1.0000e+07],
          [-1.0000e+07,  7.1278e-02,  9.9201e-02,  ...,  5.7853e-02,
            6.3885e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.1432e-02,  1.4799e-01,  ...,  1.0391e-01,
            9.0431e-02, -1.0000e+07],
          [-1.0000e+07,  8.2055e-02,  1.1485e-01,  ...,  7.1661e-02,
            7.5215e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.0784e-02,  1.5548e-01,  ...,  1.1720e-01,
            1.0758e-01, -1.0000e+07],
          [-1.0000e+07,  8.7190e-02,  9.0840e-02,  ...,  7.0423e-02,
            6.9708e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  4.7473e-02,  6.5627e-02,  ...,  6.8751e-02,
            3.3417e-02,  3.8002e-02],
          [ 8.6629e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  4.5382e-02,  6.9783e-02,  ...,  7.5249e-02,
            3.1101e-02,  3.4591e-02],
          [ 8.6623e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.5196e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6622e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1228e-01,  1.1351e-01],
         [ 1.4119e-01,  1.0342e-01],
         [ 1.4933e-01,  1.1266e-01],
         [ 1.3750e-01,  1.2146e-01],
         [ 1.2469e-01,  5.0190e-02],
         [ 1.3935e-01,  5.0866e-02],
         [ 1.5760e-01,  5.3040e-02],
         [ 1.5905e-01,  5.3854e-02],
         [ 1.7785e-01,  5.2879e-02],
         [ 1.8545e-01,  1.3512e-01],
         [ 1.9523e-01,  1.4096e-01],
         [ 1.9800e-01,  1.5345e-01],
         [ 1.6158e-01,  1.4036e-01],
         [ 1.5299e-01,  1.4782e-01],
         [ 1.9560e-01,  1.1907e-01],
         [ 1.6743e-01,  4.6006e-02],
         [ 1.8805e-01,  1.3110e-01],
         [ 1.5784e-01,  1.1147e-01],
         [ 1.9273e-01,  9.0994e-02],
         [ 1.8826e-01,  1.2024e-01],
         [ 1.6971e-01,  1.0820e-01],
         [ 1.9850e-01,  1.3549e-01],
         [ 2.0122e-01,  1.3842e-01],
         [ 2.0972e-01,  1.3753e-01],
         [ 2.0237e-01,  1.3113e-01],
         [ 1.6778e-01,  1.2155e-01],
         [ 1.4616e-01,  1.1517e-01],
         [ 1.8854e-01,  1.1814e-01],
         [ 1.7554e-01,  9.0268e-02],
         [ 1.8688e-01,  1.0293e-01],
         [ 1.9469e-01,  1.1161e-01],
         [ 1.9340e-01,  1.1851e-01],
         [ 1.6272e-01,  1.2625e-02],
         [ 1.1363e-01,  5.3132e-02],
         [ 1.1969e-01,  7.2577e-02],
         [ 1.1138e-01,  8.1329e-02],
         [ 1.4121e-01,  8.5002e-02],
         [ 1.5073e-01,  8.6424e-02],
         [ 1.4761e-01,  8.6866e-02],
         [ 1.1768e-01,  8.6912e-02],
         [ 1.4209e-01,  8.6847e-02],
         [ 1.1304e-01,  8.6773e-02],
         [ 1.0239e-01,  8.6713e-02],
         [ 1.1770e-01,  8.6652e-02],
         [ 1.1488e-01,  8.6646e-02],
         [ 9.9995e-02,  8.6631e-02],
         [ 9.4963e-02,  8.6625e-02],
         [ 4.7817e-02,  8.6628e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.4464e-01,  9.9201e-02],
         [ 1.4799e-01,  1.1485e-01],
         [ 1.5548e-01,  5.6118e-02],
         [ 1.6576e-01,  1.0575e-01],
         [ 1.2881e-01,  3.6236e-02],
         [ 1.1031e-01,  2.8025e-02],
         [ 1.1206e-01,  5.4473e-02],
         [ 1.1835e-01,  8.0693e-02],
         [ 1.4190e-01,  9.7094e-02],
         [ 1.4715e-01,  1.0727e-01],
         [ 1.2977e-01,  1.1281e-01],
         [ 1.2842e-01,  1.1546e-01],
         [ 1.4680e-01,  1.1778e-01],
         [ 1.0910e-01,  6.5359e-02],
         [ 1.2137e-01,  5.6010e-02],
         [ 1.0634e-01,  2.0426e-02],
         [ 1.3812e-01,  1.0061e-01],
         [ 1.0362e-01,  8.5460e-02],
         [ 1.1924e-01,  7.2215e-02],
         [ 1.2979e-01,  7.9410e-02],
         [ 1.2768e-01,  7.6983e-02],
         [ 1.2151e-01,  2.6921e-02],
         [ 1.6871e-01,  7.3272e-02],
         [ 1.9145e-01,  1.1397e-01],
         [ 1.9214e-01,  1.1382e-01],
         [ 1.7248e-01,  1.2039e-01],
         [ 4.9503e-02,  1.1832e-01],
         [ 1.5634e-01,  1.4316e-01],
         [ 1.0844e-01,  1.1914e-01],
         [ 1.4836e-01,  1.4176e-01],
         [ 1.0458e-01,  1.4726e-01],
         [ 8.8202e-02,  1.1628e-01],
         [ 1.3294e-01,  1.0090e-01],
         [ 1.0195e-01,  1.1519e-01],
         [ 1.0199e-01,  8.4697e-02],
         [ 1.4361e-01,  7.3566e-02],
         [ 1.4116e-01,  3.7440e-02],
         [ 1.1572e-01,  6.2692e-02],
         [ 1.1847e-01,  7.5880e-02],
         [ 1.1796e-01,  8.2075e-02],
         [ 1.1936e-01,  8.4821e-02],
         [ 1.2265e-01,  8.5950e-02],
         [ 9.0748e-02,  8.6405e-02],
         [ 1.4370e-01,  8.6531e-02],
         [ 1.0337e-01,  8.6607e-02],
         [ 1.0413e-01,  8.6607e-02],
         [ 1.2976e-01,  8.6642e-02],
         [ 1.1392e-01,  8.6615e-02],
         [ 1.3202e-01,  8.6644e-02],
         [ 1.4186e-01,  8.6620e-02],
         [ 1.3065e-01,  8.6623e-02],
         [ 1.0806e-01,  8.6615e-02],
         [ 3.0577e-02,  8.6637e-02],
         [ 7.0601e-02,  8.6641e-02],
         [ 7.0818e-02,  8.6620e-02],
         [ 6.6341e-02,  8.6625e-02],
         [ 6.8751e-02,  8.6629e-02],
         [ 7.5249e-02,  8.6623e-02],
         [ 1.5196e-02,  8.6622e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-0.0001, device='cuda:0') tensor(0.0018, device='cuda:0') tensor(-0.0035, device='cuda:0')
mixer_td_error tensor(0.1732, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2355, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.0086, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.1032, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2154, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0085, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-932203.1875, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2097, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0034, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0947, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0759, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0947, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18443
target_mac_out tensor([[[[-1.0000e+07,  7.1569e-02,  1.5447e-01,  ...,  1.1826e-01,
            1.0167e-01, -1.0000e+07],
          [-1.0000e+07,  7.1219e-02,  1.0302e-01,  ...,  6.0147e-02,
            6.5716e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.6820e-02,  1.7640e-01,  ...,  1.4350e-01,
            1.1944e-01, -1.0000e+07],
          [-1.0000e+07,  7.4045e-02,  1.1150e-01,  ...,  6.0701e-02,
            6.3843e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0147e-01,  1.7935e-01,  ...,  1.5483e-01,
            1.2552e-01, -1.0000e+07],
          [-1.0000e+07,  1.0228e-01,  1.3883e-01,  ...,  8.8888e-02,
            7.6796e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.4156e-02,  1.2323e-01,  ...,  7.8911e-02,
            6.5745e-02, -1.0000e+07],
          [-1.0000e+07,  7.3069e-02,  1.0105e-01,  ...,  5.7965e-02,
            6.4639e-02, -1.0000e+07]],

         [[-1.0000e+07,  7.5040e-02,  1.4056e-01,  ...,  9.0131e-02,
            7.4549e-02, -1.0000e+07],
          [-1.0000e+07,  8.2022e-02,  1.0456e-01,  ...,  5.3631e-02,
            6.2580e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.2063e-02,  1.2392e-01,  ...,  9.0341e-02,
            8.9641e-02, -1.0000e+07],
          [-1.0000e+07,  5.3617e-02,  3.2230e-02,  ..., -1.0000e+07,
            3.2033e-02, -1.0000e+07]],

         ...,

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  5.8401e-02,  3.6655e-02,  ...,  4.6247e-02,
            2.7301e-03, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  5.7986e-02,  5.6563e-02,  ...,  5.1124e-02,
            6.7101e-03, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 6.7259e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.5447e-01,  1.0302e-01],
         [ 1.7640e-01,  1.1150e-01],
         [ 1.7935e-01,  1.3883e-01],
         [ 1.7494e-01,  6.2468e-02],
         [ 1.0817e-01,  3.7196e-02],
         [ 1.7582e-01,  1.2238e-01],
         [ 1.9051e-01,  1.0730e-01],
         [ 2.0690e-01,  1.1476e-01],
         [ 2.0972e-01,  1.2822e-01],
         [ 2.1678e-01,  1.4153e-01],
         [ 2.2382e-01,  1.4633e-01],
         [ 1.6587e-01,  1.2496e-01],
         [ 1.8528e-01,  1.1710e-01],
         [ 1.4591e-01,  4.9229e-02],
         [ 1.8073e-01,  5.2434e-02],
         [ 1.4455e-01,  1.2578e-01],
         [ 1.8558e-01,  9.6054e-02],
         [ 1.9432e-01,  9.5972e-02],
         [ 1.8558e-01,  1.0254e-01],
         [ 1.6295e-01,  1.0039e-01],
         [ 1.3430e-01,  8.1159e-02],
         [ 3.6222e-02,  6.4876e-02],
         [ 4.5633e-02,  5.5141e-02],
         [ 5.2966e-02,  5.3857e-02],
         [ 5.7056e-02,  4.9454e-02],
         [ 5.8950e-02,  4.7880e-02],
         [ 5.9678e-02,  6.5780e-02],
         [ 5.9908e-02,  5.4152e-02],
         [ 5.9931e-02,  6.7517e-02],
         [ 5.9896e-02,  5.9320e-02],
         [ 5.9838e-02,  5.6176e-02],
         [ 5.9806e-02,  7.4320e-02],
         [ 5.9779e-02,  6.2780e-02],
         [ 5.9789e-02,  6.5345e-02],
         [ 5.9779e-02,  8.5811e-02],
         [ 5.9776e-02,  6.5484e-02],
         [ 5.9755e-02,  7.1983e-02],
         [ 5.9762e-02,  4.0830e-02],
         [ 5.9754e-02,  5.8936e-02],
         [ 5.9772e-02,  6.7027e-02],
         [ 5.9766e-02,  4.3814e-02],
         [ 5.9768e-02,  4.6124e-02],
         [ 5.9766e-02,  5.4207e-02],
         [ 5.9761e-02,  6.3538e-02],
         [ 5.9761e-02,  3.1623e-02],
         [ 5.9763e-02,  6.2732e-02],
         [ 5.9762e-02,  3.2680e-02],
         [ 5.9762e-02,  2.8869e-02],
         [ 5.9762e-02,  4.6837e-02],
         [ 5.9762e-02,  4.3276e-02],
         [ 5.9762e-02,  5.5610e-02],
         [ 5.9762e-02,  4.8938e-02],
         [ 5.9762e-02,  4.8845e-02],
         [ 5.9762e-02,  4.9366e-02],
         [ 5.9762e-02,  4.3135e-02],
         [ 5.9762e-02,  5.1321e-02],
         [ 5.9762e-02,  5.8042e-02],
         [ 5.9762e-02,  6.8801e-02],
         [ 5.9762e-02,  4.2760e-02],
         [ 5.9762e-02,  5.0581e-02],
         [ 5.9762e-02,  5.2905e-02],
         [ 5.9762e-02,  4.7557e-02],
         [ 5.9762e-02,  6.4120e-02],
         [ 5.9762e-02,  7.3508e-02],
         [ 5.9762e-02,  6.8224e-02],
         [ 5.9762e-02,  8.1184e-02],
         [ 5.9762e-02,  5.5676e-02],
         [ 5.9762e-02,  4.5204e-02],
         [ 5.9762e-02,  2.8747e-02],
         [ 5.9762e-02,  3.6160e-02],
         [ 5.9762e-02,  1.6897e-02],
         [ 5.9762e-02,  1.2033e-02],
         [ 5.9762e-02,  4.6107e-02],
         [ 5.9762e-02,  5.8746e-02],
         [ 5.9762e-02,  2.7308e-02],
         [ 5.9762e-02,  3.8807e-02],
         [ 5.9762e-02,  4.3159e-02],
         [ 5.9762e-02,  4.4547e-02],
         [ 5.9762e-02,  3.1959e-02],
         [ 5.9762e-02,  2.4420e-02],
         [ 5.9762e-02,  5.5255e-02],
         [ 5.9762e-02,  3.2566e-02],
         [ 5.9762e-02,  2.8046e-02],
         [ 5.9762e-02,  2.7111e-02],
         [ 5.9762e-02,  4.4058e-02],
         [ 5.9762e-02,  4.6362e-02],
         [ 5.9762e-02,  4.5306e-02],
         [ 5.9762e-02,  6.1662e-02],
         [ 5.9762e-02,  7.0402e-02],
         [ 5.9762e-02,  3.7505e-02],
         [ 5.9762e-02,  3.3678e-02],
         [ 5.9762e-02,  6.7468e-02],
         [ 5.9762e-02,  7.1703e-02],
         [ 5.9762e-02,  5.0212e-02],
         [ 5.9762e-02,  7.7922e-02],
         [ 5.9762e-02,  5.6532e-02],
         [ 5.9762e-02,  4.7946e-02],
         [ 5.9762e-02,  2.4419e-02],
         [ 5.9762e-02,  4.2343e-02],
         [ 5.9762e-02,  6.6203e-02],
         [ 5.9762e-02,  7.8521e-02],
         [ 5.9762e-02,  8.3396e-02],
         [ 5.9762e-02,  5.0365e-02],
         [ 5.9762e-02,  4.4273e-02],
         [ 5.9762e-02,  4.8659e-02],
         [ 5.9762e-02,  6.4965e-02],
         [ 5.9762e-02,  6.8528e-02],
         [ 5.9762e-02,  9.4543e-02],
         [ 5.9762e-02,  6.7693e-02],
         [ 5.9762e-02,  4.7707e-02],
         [ 5.9762e-02,  6.8319e-02],
         [ 5.9762e-02,  7.4174e-03],
         [ 5.9762e-02,  7.5689e-02],
         [ 5.9762e-02,  8.0399e-02],
         [ 5.9762e-02,  9.2570e-02],
         [ 5.9762e-02,  7.3845e-02],
         [ 5.9762e-02,  6.6894e-02],
         [ 5.9762e-02,  8.0492e-02],
         [ 5.9762e-02,  9.5599e-02],
         [ 5.9762e-02,  9.5280e-02],
         [ 5.9762e-02,  8.9481e-02],
         [ 5.9762e-02,  8.6336e-02],
         [ 5.9762e-02,  6.3323e-02],
         [ 5.9762e-02,  6.8221e-02],
         [ 5.9762e-02,  8.2561e-02],
         [ 5.9762e-02,  7.7362e-02],
         [ 5.9762e-02,  9.0219e-02],
         [ 5.9762e-02,  7.2898e-02],
         [ 5.9762e-02,  6.6880e-02],
         [ 5.9762e-02,  6.5567e-02],
         [ 5.9762e-02,  4.9543e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.2323e-01,  1.0105e-01],
         [ 1.4056e-01,  1.0456e-01],
         [ 1.2392e-01,  3.2033e-02],
         [ 1.2765e-01,  5.7047e-02],
         [ 1.0675e-01,  6.3306e-02],
         [ 1.0168e-01,  7.4774e-02],
         [ 9.8720e-02,  5.9634e-02],
         [ 9.5293e-02,  5.3888e-02],
         [ 1.0096e-01,  5.0815e-02],
         [ 1.1405e-01,  4.7235e-02],
         [ 1.1676e-01,  4.6233e-02],
         [ 1.1569e-01,  4.3498e-02],
         [ 1.1388e-01,  3.8387e-02],
         [ 1.1233e-01,  3.4922e-02],
         [ 1.1122e-01,  4.3674e-02],
         [ 1.3762e-01,  5.2428e-02],
         [ 1.3706e-01,  4.5375e-02],
         [ 1.0177e-01,  8.8661e-02],
         [ 1.0407e-01,  5.5541e-02],
         [ 1.3388e-01,  4.9987e-02],
         [ 1.2111e-01,  6.6312e-02],
         [ 1.2970e-01,  5.4069e-02],
         [ 1.4501e-01,  5.3751e-02],
         [ 1.3932e-01,  4.3352e-02],
         [ 1.0414e-01,  4.2798e-02],
         [ 7.8135e-02,  4.2353e-02],
         [ 1.0638e-01,  6.9314e-02],
         [ 1.2868e-01,  9.8277e-02],
         [ 1.3030e-01,  9.7685e-02],
         [ 1.5248e-01,  1.1059e-01],
         [ 1.3482e-01,  1.0533e-01],
         [ 1.2062e-01,  7.7899e-02],
         [ 1.1276e-01,  8.2083e-02],
         [ 1.2003e-01,  5.7582e-02],
         [ 1.3560e-01,  7.6587e-02],
         [ 1.2496e-01,  8.0083e-02],
         [ 1.3283e-01,  6.6614e-02],
         [ 1.0283e-01,  5.7444e-02],
         [ 1.1303e-01,  4.3454e-02],
         [ 1.2950e-01,  8.0027e-02],
         [ 1.1729e-01,  6.2613e-02],
         [ 1.2013e-01,  8.0123e-02],
         [ 1.2727e-01,  7.8400e-02],
         [ 1.3762e-01,  9.6622e-02],
         [ 1.4621e-01,  1.0688e-01],
         [ 1.5068e-01,  6.2694e-02],
         [ 1.4965e-01,  5.4035e-02],
         [ 1.4491e-01,  6.9955e-02],
         [ 1.4165e-01,  7.4368e-02],
         [ 1.5122e-01,  7.5978e-02],
         [ 1.2604e-01,  1.0423e-01],
         [ 1.3295e-01,  8.6251e-02],
         [ 1.3265e-01,  8.9377e-02],
         [ 1.2825e-01,  1.0581e-01],
         [ 1.5128e-01,  5.0896e-02],
         [ 1.3241e-01,  5.7498e-02],
         [ 1.4291e-01,  5.9686e-02],
         [ 1.5004e-01,  8.7658e-02],
         [ 8.1542e-02,  8.2521e-02],
         [ 8.2658e-02,  8.0093e-02],
         [ 8.3468e-02,  9.9770e-02],
         [ 8.1899e-02,  9.4471e-02],
         [ 1.3902e-01,  9.9325e-02],
         [ 1.3233e-01,  1.1406e-01],
         [ 1.5443e-01,  1.2570e-01],
         [ 1.4643e-01,  1.0896e-01],
         [ 1.6821e-01,  1.2699e-01],
         [ 1.3645e-01,  1.1112e-01],
         [ 1.4546e-01,  1.2305e-01],
         [ 1.7091e-01,  1.1210e-01],
         [ 1.2953e-01,  1.0794e-01],
         [ 1.6770e-01,  1.2005e-01],
         [ 1.6075e-01,  9.9050e-02],
         [ 1.8262e-01,  9.7187e-02],
         [ 1.9429e-01,  1.1456e-01],
         [ 1.8452e-01,  8.1020e-02],
         [ 1.7395e-01,  6.8106e-02],
         [ 1.0819e-01,  5.6676e-02],
         [ 1.4287e-01,  7.4419e-02],
         [ 1.2373e-01,  8.6621e-02],
         [ 1.0529e-01,  1.0738e-01],
         [ 1.5369e-01,  9.3494e-02],
         [ 1.2845e-01,  8.1715e-02],
         [ 1.4198e-01,  9.6073e-02],
         [ 1.0719e-01,  8.5978e-02],
         [ 3.1040e-02,  7.4122e-02],
         [ 4.1801e-02,  6.4424e-02],
         [ 5.0570e-02,  6.5075e-02],
         [ 5.5605e-02,  7.2858e-02],
         [ 5.8068e-02,  4.7906e-02],
         [ 5.9160e-02,  7.3283e-02],
         [ 5.9602e-02,  6.3003e-02],
         [ 5.9751e-02,  5.1751e-02],
         [ 5.9790e-02,  5.8352e-02],
         [ 5.9795e-02,  3.7715e-02],
         [ 5.9794e-02,  5.1283e-02],
         [ 5.9772e-02,  1.7521e-02],
         [ 5.9772e-02,  4.2283e-02],
         [ 5.9779e-02,  4.5395e-02],
         [ 5.9760e-02,  4.5614e-02],
         [ 5.9763e-02,  4.8085e-02],
         [ 5.9761e-02,  5.1028e-02],
         [ 5.9744e-02,  4.7296e-02],
         [ 5.9771e-02,  2.7524e-02],
         [ 5.9774e-02,  3.2055e-02],
         [ 5.9769e-02,  5.6188e-02],
         [ 5.9767e-02,  2.9971e-02],
         [ 5.9761e-02,  4.9561e-02],
         [ 5.9761e-02,  4.8263e-02],
         [ 5.9761e-02,  4.3418e-02],
         [ 5.9761e-02,  4.4059e-02],
         [ 5.9761e-02,  4.7586e-02],
         [ 5.9761e-02,  4.6920e-02],
         [ 5.9761e-02,  5.3698e-02],
         [ 5.9761e-02,  2.5083e-02],
         [ 5.9761e-02,  2.0828e-02],
         [ 5.9762e-02,  2.8192e-02],
         [ 5.9760e-02,  5.5388e-02],
         [ 5.9760e-02,  4.7668e-02],
         [ 5.9762e-02,  4.5734e-02],
         [ 5.9762e-02,  2.6516e-02],
         [ 5.9762e-02,  2.2192e-02],
         [ 5.9762e-02,  5.4086e-02],
         [ 5.9762e-02,  2.7843e-02],
         [ 5.9762e-02,  5.5602e-02],
         [ 5.9762e-02,  4.7744e-02],
         [ 5.9762e-02,  2.6715e-02],
         [ 5.9762e-02,  5.5629e-02],
         [ 5.9762e-02,  2.8195e-02],
         [ 5.9762e-02,  4.8478e-02],
         [ 5.9762e-02,  6.9028e-02],
         [ 5.9762e-02,  4.9494e-02],
         [ 5.9762e-02,  6.1519e-02],
         [ 5.9762e-02,  7.1207e-02],
         [ 5.9762e-02,  4.7347e-02],
         [ 5.9762e-02,  5.3933e-02],
         [ 5.9762e-02,  5.8277e-02],
         [ 5.9762e-02,  5.4146e-02],
         [ 5.9762e-02,  4.8177e-02],
         [ 5.9762e-02,  6.5007e-02],
         [ 5.9762e-02,  5.0244e-02],
         [ 5.9762e-02,  1.1733e-02],
         [ 5.9762e-02,  5.6251e-02],
         [ 5.9762e-02,  4.7981e-02],
         [ 5.9762e-02,  4.5229e-02],
         [ 5.9762e-02,  4.3968e-02],
         [ 5.9762e-02,  5.8470e-02],
         [ 5.9762e-02,  4.9851e-02],
         [ 5.9762e-02,  6.2119e-02],
         [ 5.9762e-02,  5.0841e-02],
         [ 5.9762e-02,  6.1176e-02],
         [ 5.9762e-02,  5.2641e-02],
         [ 5.9762e-02,  4.9207e-02],
         [ 5.9762e-02,  5.8398e-02],
         [ 5.9762e-02,  6.0310e-02],
         [ 5.9762e-02,  5.5816e-02],
         [ 5.9762e-02,  7.2639e-02],
         [ 5.9762e-02,  8.3324e-02],
         [ 5.9762e-02,  8.6626e-02],
         [ 5.9762e-02,  6.7223e-02],
         [ 5.9762e-02,  8.3513e-02],
         [ 5.9762e-02,  8.6448e-02],
         [ 5.9762e-02,  8.7007e-02],
         [ 5.9762e-02,  6.7812e-02],
         [ 5.9762e-02,  5.7585e-02],
         [ 5.9762e-02,  5.1164e-02],
         [ 5.9762e-02,  5.1728e-02],
         [ 5.9762e-02,  5.3890e-02],
         [ 5.9762e-02,  6.4391e-02],
         [ 5.9762e-02,  5.6558e-02],
         [ 5.9762e-02,  6.1041e-02],
         [ 5.9762e-02,  5.9224e-02],
         [ 5.9762e-02,  3.2100e-02],
         [ 5.9762e-02,  4.7989e-02],
         [ 5.9762e-02,  4.4666e-02],
         [ 5.9762e-02,  6.5772e-02],
         [ 5.9762e-02,  3.3484e-02],
         [ 5.9762e-02,  2.9865e-02],
         [ 5.9762e-02,  2.8104e-02],
         [ 5.9762e-02,  4.7905e-02],
         [ 5.9762e-02,  6.8499e-02],
         [ 5.9762e-02,  4.8347e-02],
         [ 5.9762e-02,  6.6155e-02],
         [ 5.9762e-02,  8.4298e-02],
         [ 5.9762e-02,  6.7403e-02],
         [ 5.9762e-02,  7.6055e-02],
         [ 5.9762e-02,  5.6321e-02],
         [ 5.9762e-02,  6.9367e-02],
         [ 5.9762e-02,  5.0888e-02],
         [ 5.9762e-02,  7.0154e-02],
         [ 5.9762e-02,  7.7292e-02],
         [ 5.9762e-02,  7.5366e-02],
         [ 5.9762e-02,  5.8401e-02],
         [ 5.9762e-02,  5.1124e-02],
         [ 5.9762e-02,  6.7259e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.1257e-05, device='cuda:0') tensor(0.0008, device='cuda:0') tensor(-0.0014, device='cuda:0')
mixer_td_error tensor(0.3852, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2387, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8841, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0701, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2254, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0061, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1641025.3750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2238, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.0725e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0704, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.0848, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0704, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18488
target_mac_out tensor([[[[-1.0000e+07,  6.4334e-02,  1.1946e-01,  ...,  7.7279e-02,
            6.6568e-02, -1.0000e+07],
          [-1.0000e+07,  7.4678e-02,  8.3892e-02,  ...,  6.8986e-02,
            6.6705e-02, -1.0000e+07]],

         [[-1.0000e+07,  7.7814e-02,  1.3613e-01,  ...,  8.7754e-02,
            7.5296e-02, -1.0000e+07],
          [-1.0000e+07,  8.6727e-02,  1.0065e-01,  ...,  6.2193e-02,
            6.1072e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.2641e-02,  1.0378e-01,  ...,  7.4560e-02,
            6.3226e-02, -1.0000e+07],
          [-1.0000e+07,  6.4966e-02,  3.2749e-02,  ...,  5.5857e-02,
            4.0486e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  1.0061e-01,  1.2716e-01,  ...,  9.0539e-02,
            5.7446e-02,  7.7035e-02],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  1.0028e-01,  9.3087e-02,  ...,  8.2191e-02,
            3.0132e-02, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.3526e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.0527e-02,  1.4370e-01,  ...,  1.0294e-01,
            9.3133e-02, -1.0000e+07],
          [-1.0000e+07,  6.1312e-02,  9.2874e-02,  ...,  5.6738e-02,
            6.1406e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.9400e-02,  1.5672e-01,  ...,  1.1726e-01,
            1.0706e-01, -1.0000e+07],
          [-1.0000e+07,  8.1015e-02,  1.1331e-01,  ...,  7.2238e-02,
            7.1404e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.8846e-02,  1.4953e-01,  ...,  1.1094e-01,
            9.5334e-02, -1.0000e+07],
          [-1.0000e+07,  8.4873e-02,  1.0610e-01,  ...,  6.0448e-02,
            6.5911e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1946e-01,  8.3892e-02],
         [ 1.3613e-01,  1.0065e-01],
         [ 1.0378e-01,  6.4966e-02],
         [ 8.8872e-02,  5.4071e-02],
         [ 9.8828e-02,  6.8929e-02],
         [ 1.0856e-01,  5.5839e-02],
         [ 1.1740e-01,  5.2751e-02],
         [ 1.4644e-01,  4.9431e-02],
         [ 1.1026e-01,  8.5795e-02],
         [ 1.1336e-01,  1.0896e-01],
         [ 1.3907e-01,  1.1622e-01],
         [ 1.3029e-01,  1.0788e-01],
         [ 1.3865e-01,  1.0738e-01],
         [ 1.2965e-01,  1.1947e-01],
         [ 1.5002e-01,  1.0796e-01],
         [ 6.6244e-02,  6.5310e-02],
         [ 1.4987e-01,  1.2311e-01],
         [ 1.5269e-01,  6.7419e-02],
         [ 1.5029e-01,  6.6669e-02],
         [ 1.5054e-01,  1.1498e-01],
         [ 1.6365e-01,  6.0812e-02],
         [ 1.5229e-01,  1.0476e-01],
         [ 1.5992e-01,  1.3184e-01],
         [ 1.5297e-01,  1.3441e-01],
         [ 1.5095e-01,  1.3688e-01],
         [ 1.3503e-01,  7.1054e-02],
         [ 1.5239e-01,  1.2854e-01],
         [ 1.5910e-01,  1.3638e-01],
         [ 1.5276e-01,  1.1489e-01],
         [ 1.2997e-01,  1.2555e-01],
         [ 1.4127e-01,  1.1413e-01],
         [ 1.4893e-01,  1.3319e-01],
         [ 1.4752e-01,  1.4958e-01],
         [ 1.1578e-01,  1.0538e-01],
         [ 1.1797e-01,  1.1940e-01],
         [ 1.4998e-01,  1.2288e-01],
         [ 1.5328e-01,  8.3195e-02],
         [ 1.4789e-01,  6.5764e-02],
         [ 1.4035e-01,  7.3117e-02],
         [ 1.2602e-01,  6.6274e-02],
         [ 9.5515e-02,  8.8594e-02],
         [ 1.1179e-01,  9.4192e-02],
         [ 1.2582e-01,  9.6838e-02],
         [ 1.1704e-01,  9.5409e-02],
         [ 9.5495e-02,  8.1566e-02],
         [ 9.6543e-02,  1.0079e-01],
         [ 1.0848e-01,  1.0374e-01],
         [ 1.1087e-01,  1.0059e-01],
         [ 9.2087e-02,  1.0271e-01],
         [ 9.5750e-02,  4.5805e-02],
         [ 1.0125e-01,  8.4457e-02],
         [ 1.2693e-01,  9.2944e-02],
         [ 1.2540e-01,  9.8855e-02],
         [ 1.1669e-01,  2.0388e-02],
         [ 1.2068e-01,  5.7636e-02],
         [ 1.1260e-01,  7.5094e-02],
         [ 1.0079e-01,  8.2629e-02],
         [ 8.9817e-02,  8.5623e-02],
         [ 8.8803e-02,  8.6647e-02],
         [ 1.0074e-01,  8.6892e-02],
         [ 9.4064e-02,  8.6891e-02],
         [ 9.0693e-02,  8.6814e-02],
         [ 8.1747e-02,  8.6745e-02],
         [ 7.4096e-02,  8.6677e-02],
         [ 8.3487e-02,  8.6665e-02],
         [ 7.6221e-02,  8.6633e-02],
         [ 8.4796e-02,  8.6642e-02],
         [ 8.4988e-02,  8.6642e-02],
         [ 1.1320e-01,  8.6641e-02],
         [ 1.2058e-01,  8.6626e-02],
         [ 9.3145e-02,  8.6623e-02],
         [ 1.2478e-01,  8.6621e-02],
         [ 1.3314e-01,  8.6624e-02],
         [ 1.0256e-01,  8.6619e-02],
         [ 1.0129e-01,  8.6623e-02],
         [ 9.7587e-02,  8.6621e-02],
         [ 9.9931e-02,  8.6621e-02],
         [ 9.2304e-02,  8.6621e-02],
         [ 8.9064e-02,  8.6621e-02],
         [ 8.5877e-02,  8.6621e-02],
         [ 7.4171e-02,  8.6621e-02],
         [ 7.6983e-02,  8.6621e-02],
         [ 7.8284e-02,  8.6621e-02],
         [ 7.8449e-02,  8.6621e-02],
         [ 7.2186e-02,  8.6621e-02],
         [ 8.0220e-02,  8.6621e-02],
         [ 8.2143e-02,  8.6621e-02],
         [ 8.1318e-02,  8.6621e-02],
         [ 6.5506e-02,  8.6621e-02],
         [ 8.4143e-02,  8.6621e-02],
         [ 8.7645e-02,  8.6621e-02],
         [ 7.0909e-02,  8.6621e-02],
         [ 7.7985e-02,  8.6621e-02],
         [ 9.7531e-02,  8.6621e-02],
         [ 1.0478e-01,  8.6621e-02],
         [ 9.0118e-02,  8.6621e-02],
         [ 9.6428e-02,  8.6621e-02],
         [ 8.9960e-02,  8.6621e-02],
         [ 9.4176e-02,  8.6621e-02],
         [ 9.6627e-02,  8.6621e-02],
         [ 8.4167e-02,  8.6621e-02],
         [ 1.0298e-01,  8.6621e-02],
         [ 8.1558e-02,  8.6621e-02],
         [ 8.3391e-02,  8.6621e-02],
         [ 1.0699e-01,  8.6621e-02],
         [ 1.1962e-01,  8.6621e-02],
         [ 1.1397e-01,  8.6621e-02],
         [ 1.2907e-01,  8.6621e-02],
         [ 1.3424e-01,  8.6621e-02],
         [ 1.1482e-01,  8.6621e-02],
         [ 1.1497e-01,  8.6621e-02],
         [ 1.2065e-01,  8.6621e-02],
         [ 1.0612e-01,  8.6621e-02],
         [ 1.0605e-01,  8.6621e-02],
         [ 1.0636e-01,  8.6621e-02],
         [ 9.0999e-02,  8.6621e-02],
         [ 9.5886e-02,  8.6621e-02],
         [ 1.0745e-01,  8.6621e-02],
         [ 9.9905e-02,  8.6621e-02],
         [ 1.2716e-01,  8.6621e-02],
         [ 1.0028e-01,  8.6621e-02],
         [ 3.3526e-02,  8.6621e-02]],

        [[ 1.4370e-01,  9.2874e-02],
         [ 1.5672e-01,  1.1331e-01],
         [ 1.4953e-01,  1.0610e-01],
         [ 1.6896e-01,  1.1702e-01],
         [ 1.5929e-01,  1.0732e-01],
         [ 1.5227e-01,  1.1883e-01],
         [ 1.6385e-01,  1.3728e-01],
         [ 1.3194e-01,  1.3034e-01],
         [ 1.4101e-01,  7.2421e-02],
         [ 1.6345e-01,  6.9599e-02],
         [ 1.7817e-01,  6.5694e-02],
         [ 1.4858e-01,  1.0310e-01],
         [ 1.1658e-01,  1.1867e-01],
         [ 1.4704e-01,  1.0448e-01],
         [ 1.6710e-01,  1.3077e-01],
         [ 1.4788e-01,  1.3665e-01],
         [ 1.1464e-01,  1.3733e-01],
         [ 1.4582e-01,  1.3979e-01],
         [ 1.4825e-01,  1.3552e-01],
         [ 1.5442e-01,  1.0413e-01],
         [ 1.6031e-01,  1.2525e-01],
         [ 1.6272e-01,  1.2858e-01],
         [ 1.5959e-01,  8.2158e-02],
         [ 1.5102e-01,  1.0948e-01],
         [ 1.7619e-01,  8.3708e-02],
         [ 1.1015e-01,  8.3136e-02],
         [ 1.0847e-01,  8.0761e-02],
         [ 1.1109e-01,  7.2823e-02],
         [ 1.1894e-01,  7.7975e-02],
         [ 1.1459e-01,  2.5315e-02],
         [ 1.1076e-01,  6.1515e-02],
         [ 1.1656e-01,  7.7157e-02],
         [ 1.0712e-01,  8.3555e-02],
         [ 1.0366e-01,  8.5943e-02],
         [ 1.3661e-01,  8.6725e-02],
         [ 1.3695e-01,  8.6860e-02],
         [ 1.0386e-01,  8.6784e-02],
         [ 8.1034e-02,  8.6726e-02],
         [ 8.8907e-02,  8.6650e-02],
         [ 9.8916e-02,  8.6621e-02],
         [ 1.3289e-01,  8.6596e-02],
         [ 1.2097e-01,  8.6596e-02],
         [ 1.1478e-01,  8.6597e-02],
         [ 1.1135e-01,  8.6624e-02],
         [ 9.2375e-02,  8.6604e-02],
         [ 9.3243e-02,  8.6620e-02],
         [ 1.1513e-01,  8.6624e-02],
         [ 1.2047e-01,  8.6633e-02],
         [ 1.4092e-01,  8.6623e-02],
         [ 1.3925e-01,  8.6621e-02],
         [ 1.2189e-01,  8.6620e-02],
         [ 1.2998e-01,  8.6620e-02],
         [ 9.8934e-02,  8.6624e-02],
         [ 9.6583e-02,  8.6622e-02],
         [ 1.2068e-01,  8.6623e-02],
         [ 8.5398e-02,  8.6621e-02],
         [ 8.9080e-02,  8.6621e-02],
         [ 9.7910e-02,  8.6621e-02],
         [ 1.1786e-01,  8.6621e-02],
         [ 1.3468e-01,  8.6621e-02],
         [ 1.4326e-01,  8.6621e-02],
         [ 1.4686e-01,  8.6621e-02],
         [ 1.1845e-01,  8.6621e-02],
         [ 1.3636e-01,  8.6621e-02],
         [ 1.1454e-01,  8.6621e-02],
         [ 1.3886e-01,  8.6621e-02],
         [ 1.5032e-01,  8.6621e-02],
         [ 1.4851e-01,  8.6621e-02],
         [ 1.4699e-01,  8.6621e-02],
         [ 1.5323e-01,  8.6621e-02],
         [ 1.6377e-01,  8.6621e-02],
         [ 1.3037e-01,  8.6621e-02],
         [ 1.3521e-01,  8.6621e-02],
         [ 1.3525e-01,  8.6621e-02],
         [ 1.3189e-01,  8.6621e-02],
         [ 9.0467e-02,  8.6621e-02],
         [ 1.2083e-01,  8.6621e-02],
         [ 1.2718e-01,  8.6621e-02],
         [ 1.9408e-02,  8.6621e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.6116e-05, device='cuda:0') tensor(0.0005, device='cuda:0') tensor(-0.0006, device='cuda:0')
mixer_td_error tensor(0.4235, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2333, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4073, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0931, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1802, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0145, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1762294.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1782, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.8883e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0910, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0996, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0910, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18533
target_mac_out tensor([[[[-1.0000e+07,  6.7856e-02,  1.2627e-01,  ...,  8.1598e-02,
            6.5922e-02, -1.0000e+07],
          [-1.0000e+07,  8.9393e-02,  1.1920e-01,  ...,  8.7495e-02,
            7.6975e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.5818e-02,  1.5566e-01,  ...,  1.0641e-01,
            9.5119e-02, -1.0000e+07],
          [-1.0000e+07,  9.9056e-02,  1.2839e-01,  ...,  9.3374e-02,
            7.5125e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0199e-01,  1.2958e-01,  ...,  1.0796e-01,
            7.9215e-02, -1.0000e+07],
          [-1.0000e+07,  9.0983e-02,  1.1393e-01,  ...,  8.0830e-02,
            6.6316e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.7158e-02,  1.4464e-01,  ...,  1.0220e-01,
            9.3161e-02, -1.0000e+07],
          [-1.0000e+07,  7.1278e-02,  9.9201e-02,  ...,  5.7853e-02,
            6.3885e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.2511e-02,  1.3776e-01,  ...,  9.3895e-02,
            8.1662e-02, -1.0000e+07],
          [-1.0000e+07,  7.4347e-02,  1.0046e-01,  ...,  5.4176e-02,
            6.2560e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0926e-01,  1.4663e-01,  ...,  1.0960e-01,
            9.0866e-02, -1.0000e+07],
          [-1.0000e+07,  9.0483e-02,  9.2367e-02,  ...,  6.4344e-02,
            6.4836e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  7.8251e-02,  1.2326e-01,  ...,  9.4892e-02,
            6.5703e-02,  7.1224e-02],
          [ 8.6623e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  6.9657e-02,  9.0610e-02,  ...,  8.5412e-02,
            4.2650e-02,  5.8343e-02],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.9805e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6620e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.2627e-01,  1.1920e-01],
         [ 1.5566e-01,  1.2839e-01],
         [ 1.2958e-01,  1.1393e-01],
         [ 1.0037e-01,  8.6664e-02],
         [ 1.3628e-01,  1.1222e-01],
         [ 1.5331e-01,  1.3291e-01],
         [ 1.7632e-01,  1.4368e-01],
         [ 1.8806e-01,  1.4626e-01],
         [ 1.9393e-01,  1.4494e-01],
         [ 1.8682e-01,  1.2867e-01],
         [ 1.7115e-01,  1.3937e-01],
         [ 1.7757e-01,  1.4282e-01],
         [ 1.7066e-01,  1.3630e-01],
         [ 1.5447e-01,  1.3617e-01],
         [ 1.5086e-01,  1.0305e-01],
         [ 1.4459e-01,  1.1275e-01],
         [ 1.9029e-01,  1.2032e-01],
         [ 2.0652e-01,  1.1896e-01],
         [ 1.8732e-01,  2.6836e-02],
         [ 1.4588e-01,  5.6165e-02],
         [ 2.0588e-01,  7.2579e-02],
         [ 2.2661e-01,  1.7938e-02],
         [ 1.6676e-01,  2.9921e-02],
         [ 1.9390e-01,  7.4243e-02],
         [ 2.0581e-01,  7.7396e-02],
         [ 2.1566e-01,  2.8840e-02],
         [ 1.7263e-01,  5.0661e-02],
         [ 1.1900e-01,  7.2809e-02],
         [ 1.5662e-01,  4.0523e-02],
         [ 1.4788e-01,  2.4072e-02],
         [ 1.3404e-01,  6.1367e-02],
         [ 1.4118e-01,  7.4365e-02],
         [ 1.5311e-01,  8.1784e-02],
         [ 1.5779e-01,  8.5207e-02],
         [ 1.3648e-01,  8.6508e-02],
         [ 1.1093e-01,  8.6875e-02],
         [ 1.3915e-01,  8.6912e-02],
         [ 1.5053e-01,  8.6837e-02],
         [ 1.2351e-01,  8.6768e-02],
         [ 1.3325e-01,  8.6721e-02],
         [ 1.4819e-01,  8.6677e-02],
         [ 1.3976e-01,  8.6664e-02],
         [ 9.4571e-02,  8.6613e-02],
         [ 9.0110e-02,  8.6609e-02],
         [ 1.0160e-01,  8.6628e-02],
         [ 1.9390e-02,  8.6633e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.4464e-01,  9.9201e-02],
         [ 1.3776e-01,  1.0046e-01],
         [ 1.4663e-01,  9.0483e-02],
         [ 1.4856e-01,  1.1790e-01],
         [ 6.5070e-02,  9.8319e-02],
         [ 1.0171e-01,  7.8564e-02],
         [ 1.2329e-01,  8.6098e-02],
         [ 1.3459e-01,  9.9483e-02],
         [ 1.3412e-01,  1.1750e-01],
         [ 1.3283e-01,  8.2426e-02],
         [ 1.4330e-01,  8.9925e-02],
         [ 1.5237e-01,  1.2287e-01],
         [ 1.4241e-01,  1.1803e-01],
         [ 1.6687e-01,  1.2510e-01],
         [ 1.7071e-01,  9.6880e-02],
         [ 1.2666e-01,  1.0994e-01],
         [ 1.3807e-01,  1.3019e-01],
         [ 1.3024e-01,  1.1962e-01],
         [ 1.3525e-01,  1.2493e-01],
         [ 1.5245e-01,  9.0373e-02],
         [ 1.5458e-01,  8.9825e-02],
         [ 1.5232e-01,  8.3795e-02],
         [ 7.6178e-02,  9.3404e-02],
         [ 1.1504e-01,  9.6372e-02],
         [ 1.1674e-01,  9.6176e-02],
         [ 1.1849e-01,  9.0891e-02],
         [ 1.2695e-01,  9.0333e-02],
         [ 1.4391e-01,  9.3162e-02],
         [ 1.5453e-01,  1.0479e-01],
         [ 1.5411e-01,  1.0246e-01],
         [ 1.5000e-01,  1.0760e-01],
         [ 1.6420e-01,  1.0905e-01],
         [ 1.6949e-01,  6.4360e-02],
         [ 1.6921e-01,  5.5874e-02],
         [ 1.5898e-01,  1.0641e-01],
         [ 1.5483e-01,  1.1366e-01],
         [ 1.5694e-01,  7.9258e-02],
         [ 1.2348e-01,  8.1057e-02],
         [ 1.3527e-01,  1.1223e-01],
         [ 1.2682e-01,  9.7892e-02],
         [ 1.3548e-01,  9.6734e-02],
         [ 1.5433e-01,  9.5739e-02],
         [ 1.3728e-01,  1.1407e-01],
         [ 1.3069e-01,  1.1276e-01],
         [ 1.2799e-01,  1.1659e-01],
         [ 1.3890e-01,  1.0221e-01],
         [ 1.3941e-01,  1.0777e-01],
         [ 7.9198e-02,  1.1847e-01],
         [ 1.2616e-01,  1.1704e-01],
         [ 1.6129e-01,  1.0422e-01],
         [ 1.3636e-01,  9.5903e-02],
         [ 1.3609e-01,  1.0588e-01],
         [ 1.3650e-01,  1.1251e-01],
         [ 1.6658e-01,  9.8927e-02],
         [ 1.5880e-01,  1.3055e-01],
         [ 1.5761e-01,  1.3549e-01],
         [ 1.7709e-01,  1.4884e-01],
         [ 1.3716e-01,  1.3340e-01],
         [ 1.7295e-01,  1.4476e-01],
         [ 1.4670e-01,  1.5292e-01],
         [ 1.5488e-01,  1.2577e-01],
         [ 1.3185e-01,  1.2724e-01],
         [ 1.3803e-01,  9.5277e-02],
         [ 1.2529e-01,  7.3967e-02],
         [ 1.3628e-01,  8.9321e-02],
         [ 1.3809e-01,  9.3683e-02],
         [ 1.3546e-01,  5.7705e-02],
         [ 1.1321e-01,  7.6556e-02],
         [ 1.1079e-01,  1.0985e-01],
         [ 1.0493e-01,  1.4654e-01],
         [ 1.1827e-01,  1.4137e-01],
         [ 4.9432e-02,  1.5296e-01],
         [ 9.9582e-02,  1.6025e-01],
         [ 1.0809e-01,  1.5409e-01],
         [ 1.4267e-01,  1.1817e-01],
         [ 1.1135e-01,  3.3504e-02],
         [ 1.1237e-01,  6.2400e-02],
         [ 1.0859e-01,  7.6937e-02],
         [ 7.9093e-02,  8.3390e-02],
         [ 1.2117e-01,  8.5899e-02],
         [ 1.0924e-01,  8.6708e-02],
         [ 1.2822e-01,  8.6883e-02],
         [ 1.4638e-01,  8.6825e-02],
         [ 1.4767e-01,  8.6756e-02],
         [ 1.1300e-01,  8.6677e-02],
         [ 1.3755e-01,  8.6651e-02],
         [ 1.4171e-01,  8.6625e-02],
         [ 1.1406e-01,  8.6642e-02],
         [ 1.2036e-01,  8.6624e-02],
         [ 1.4033e-01,  8.6628e-02],
         [ 1.3430e-01,  8.6625e-02],
         [ 1.3707e-01,  8.6625e-02],
         [ 1.2224e-01,  8.6623e-02],
         [ 1.2840e-01,  8.6615e-02],
         [ 1.2611e-01,  8.6619e-02],
         [ 1.2326e-01,  8.6623e-02],
         [ 8.5412e-02,  8.6621e-02],
         [ 1.9805e-02,  8.6620e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-5.0914e-05, device='cuda:0') tensor(0.0024, device='cuda:0') tensor(-0.0038, device='cuda:0')
mixer_td_error tensor(0.5627, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2280, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.3310, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0985, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2159, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0144, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2653060.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2266, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.7299e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0051, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1083, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0934, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.1083, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18578
target_mac_out tensor([[[[-1.0000e+07,  6.9143e-02,  1.3413e-01,  ...,  8.9326e-02,
            7.4741e-02, -1.0000e+07],
          [-1.0000e+07,  7.0448e-02,  1.0907e-01,  ...,  7.5776e-02,
            7.4083e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.7223e-02,  1.4680e-01,  ...,  9.8907e-02,
            8.1079e-02, -1.0000e+07],
          [-1.0000e+07,  9.5746e-02,  1.2658e-01,  ...,  9.4916e-02,
            7.7828e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0487e-01,  1.7552e-01,  ...,  1.3686e-01,
            1.1281e-01, -1.0000e+07],
          [-1.0000e+07,  9.5375e-02,  1.2786e-01,  ...,  9.9119e-02,
            6.8013e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.5871e-02,  1.2252e-01,  ...,  7.9492e-02,
            6.6346e-02, -1.0000e+07],
          [-1.0000e+07,  7.5067e-02,  1.1346e-01,  ...,  7.5107e-02,
            7.9461e-02, -1.0000e+07]],

         [[-1.0000e+07,  7.8740e-02,  1.2637e-01,  ...,  7.9703e-02,
            6.7526e-02, -1.0000e+07],
          [-1.0000e+07,  9.2377e-02,  9.4373e-02,  ...,  7.0672e-02,
            7.3465e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0529e-01,  1.2516e-01,  ...,  6.5022e-02,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  7.2540e-02,  2.9956e-02,  ...,  5.8353e-02,
            4.2265e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  8.2867e-02,  1.2886e-01,  ...,  1.0795e-01,
            6.8602e-02, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  8.7384e-02,  1.1073e-01,  ...,  9.8349e-02,
            5.8204e-02, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 3.0230e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.3413e-01,  1.0907e-01],
         [ 1.4680e-01,  1.2658e-01],
         [ 1.7552e-01,  1.2786e-01],
         [ 1.8120e-01,  1.2976e-01],
         [ 1.7234e-01,  1.1199e-01],
         [ 1.7653e-01,  1.2345e-01],
         [ 1.7541e-01,  1.0085e-01],
         [ 1.7571e-01,  1.2217e-01],
         [ 1.3483e-01,  1.1742e-01],
         [ 1.2797e-01,  1.2045e-01],
         [ 1.2645e-01,  1.0371e-01],
         [ 1.4786e-01,  1.0437e-01],
         [ 1.4923e-01,  1.0129e-01],
         [ 1.4465e-01,  9.2081e-02],
         [ 1.1479e-01,  8.2410e-02],
         [ 1.1725e-01,  1.2249e-01],
         [ 1.1259e-01,  1.1135e-01],
         [ 1.1931e-01,  1.0359e-01],
         [ 1.2872e-01,  1.2511e-01],
         [ 1.1344e-01,  1.2340e-01],
         [ 1.3186e-01,  7.1603e-02],
         [ 1.1135e-01,  9.8311e-02],
         [ 1.0105e-01,  5.6327e-02],
         [ 9.8467e-02,  7.1731e-02],
         [ 1.0848e-01,  8.0390e-02],
         [ 9.5232e-02,  8.4359e-02],
         [ 1.0404e-01,  8.5902e-02],
         [ 1.0175e-01,  8.6433e-02],
         [ 9.5844e-02,  8.6576e-02],
         [ 8.9935e-02,  8.6564e-02],
         [ 9.1804e-02,  8.6554e-02],
         [ 9.0788e-02,  8.6561e-02],
         [ 8.1410e-02,  8.6568e-02],
         [ 1.0146e-01,  8.6599e-02],
         [ 9.1858e-02,  8.6584e-02],
         [ 8.3019e-02,  8.6612e-02],
         [ 9.3148e-02,  8.6616e-02],
         [ 8.2549e-02,  8.6622e-02],
         [ 8.4098e-02,  8.6631e-02],
         [ 8.2805e-02,  8.6621e-02],
         [ 9.2420e-02,  8.6621e-02],
         [ 1.0252e-01,  8.6622e-02],
         [ 9.4723e-02,  8.6623e-02],
         [ 1.1156e-01,  8.6624e-02],
         [ 1.1953e-01,  8.6622e-02],
         [ 1.2684e-01,  8.6621e-02],
         [ 1.2964e-01,  8.6621e-02],
         [ 9.7884e-02,  8.6621e-02],
         [ 1.0175e-01,  8.6621e-02],
         [ 1.1166e-01,  8.6621e-02],
         [ 1.0247e-01,  8.6621e-02],
         [ 1.0472e-01,  8.6621e-02],
         [ 9.5594e-02,  8.6621e-02],
         [ 9.8562e-02,  8.6621e-02],
         [ 1.0392e-01,  8.6621e-02],
         [ 1.0193e-01,  8.6621e-02],
         [ 1.0691e-01,  8.6621e-02],
         [ 1.0857e-01,  8.6621e-02],
         [ 9.1696e-02,  8.6621e-02],
         [ 7.4346e-02,  8.6621e-02],
         [ 9.3801e-02,  8.6621e-02],
         [ 1.2121e-01,  8.6621e-02],
         [ 1.3371e-01,  8.6621e-02],
         [ 1.3490e-01,  8.6621e-02],
         [ 1.4621e-01,  8.6621e-02],
         [ 8.9070e-02,  8.6621e-02],
         [ 8.6100e-02,  8.6621e-02],
         [ 1.2714e-01,  8.6621e-02],
         [ 8.0704e-02,  8.6621e-02],
         [ 9.4556e-02,  8.6621e-02],
         [ 1.0056e-01,  8.6621e-02],
         [ 1.0467e-01,  8.6621e-02],
         [ 8.7361e-02,  8.6621e-02],
         [ 9.1201e-02,  8.6621e-02],
         [-3.2063e-03,  8.6621e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.2252e-01,  1.1346e-01],
         [ 1.2637e-01,  9.2377e-02],
         [ 1.2516e-01,  7.2540e-02],
         [ 1.2293e-01,  6.9156e-02],
         [ 1.2849e-01,  7.5457e-02],
         [ 1.2381e-01,  6.1948e-02],
         [ 1.0353e-01,  5.6696e-02],
         [ 1.0081e-01,  5.7995e-02],
         [ 1.0057e-01,  8.0825e-02],
         [ 1.0824e-01,  7.2135e-02],
         [ 1.1592e-01,  9.5458e-02],
         [ 1.0020e-01,  7.2686e-02],
         [ 1.0495e-01,  5.5617e-02],
         [ 1.2276e-01,  9.2248e-02],
         [ 1.3165e-01,  1.1819e-01],
         [ 1.4734e-01,  1.1435e-01],
         [ 9.4572e-02,  5.9496e-02],
         [ 1.3489e-01,  7.7962e-02],
         [ 9.6394e-02,  6.6363e-02],
         [ 1.3099e-01,  9.4477e-02],
         [ 1.1472e-01,  6.6272e-02],
         [ 1.4671e-01,  5.7841e-02],
         [ 1.4610e-01,  2.9053e-02],
         [ 1.5572e-01,  6.4397e-02],
         [ 1.4598e-01,  5.6463e-02],
         [ 1.5225e-01,  5.5762e-02],
         [ 1.4232e-01,  4.5703e-02],
         [ 1.0335e-01,  1.0408e-01],
         [ 1.3151e-01,  1.2594e-01],
         [ 1.5315e-01,  1.1939e-01],
         [ 1.6964e-01,  1.3004e-01],
         [ 1.8547e-01,  1.3764e-01],
         [ 1.4425e-01,  1.2346e-01],
         [ 1.3044e-01,  1.2815e-01],
         [ 1.1235e-01,  9.5936e-02],
         [ 1.1457e-01,  5.1309e-02],
         [ 1.2400e-01,  1.0260e-01],
         [ 1.4619e-01,  1.1118e-01],
         [ 1.5411e-01,  9.1649e-02],
         [ 1.1210e-01,  9.8408e-02],
         [ 1.3939e-01,  1.3012e-01],
         [ 1.1834e-01,  1.3810e-01],
         [ 1.3236e-01,  1.4411e-01],
         [ 1.4318e-01,  1.4989e-01],
         [ 1.4116e-01,  1.1212e-01],
         [ 1.4798e-01,  1.0876e-01],
         [ 1.5042e-01,  1.0841e-01],
         [ 1.4185e-01,  1.1304e-01],
         [ 1.4448e-01,  1.0554e-01],
         [ 1.1404e-01,  2.7598e-02],
         [ 1.1572e-01,  6.4104e-02],
         [ 1.1474e-01,  7.9349e-02],
         [ 1.1313e-01,  8.5070e-02],
         [ 1.5110e-01,  8.6873e-02],
         [ 1.1409e-01,  8.7259e-02],
         [ 1.1641e-01,  8.7141e-02],
         [ 1.3514e-01,  8.6964e-02],
         [ 1.0076e-01,  8.6842e-02],
         [ 1.0877e-01,  8.6751e-02],
         [ 1.3059e-01,  8.6676e-02],
         [ 1.2488e-01,  8.6629e-02],
         [ 1.2933e-01,  8.6649e-02],
         [ 9.5759e-02,  8.6625e-02],
         [ 9.6396e-02,  8.6634e-02],
         [ 9.7895e-02,  8.6642e-02],
         [ 9.5639e-02,  8.6620e-02],
         [ 1.0147e-01,  8.6628e-02],
         [ 1.0838e-01,  8.6616e-02],
         [ 1.2033e-01,  8.6616e-02],
         [ 1.3434e-01,  8.6620e-02],
         [ 1.3465e-01,  8.6624e-02],
         [ 1.3255e-01,  8.6622e-02],
         [ 1.4934e-01,  8.6621e-02],
         [ 1.3650e-01,  8.6621e-02],
         [ 1.1043e-01,  8.6621e-02],
         [ 1.1719e-01,  8.6621e-02],
         [ 9.9119e-02,  8.6621e-02],
         [ 1.2115e-01,  8.6621e-02],
         [ 1.4178e-01,  8.6621e-02],
         [ 1.4073e-01,  8.6621e-02],
         [ 1.2005e-01,  8.6621e-02],
         [ 1.2886e-01,  8.6621e-02],
         [ 1.1073e-01,  8.6621e-02],
         [ 3.0230e-02,  8.6621e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.9227e-05, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.1431, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2335, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.3433, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0987, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1869, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0079, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-535714.1250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1855, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(8.3586e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0002, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0695, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1112, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0695, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18651
target_mac_out tensor([[[[-1.0000e+07,  7.6468e-02,  1.5802e-01,  ...,  1.2491e-01,
            1.0785e-01, -1.0000e+07],
          [-1.0000e+07,  6.1972e-02,  9.8854e-02,  ...,  5.9467e-02,
            6.2264e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.5425e-02,  1.4707e-01,  ...,  1.0705e-01,
            9.0401e-02, -1.0000e+07],
          [-1.0000e+07,  7.3051e-02,  1.0534e-01,  ...,  5.7496e-02,
            6.0220e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0597e-01,  1.6571e-01,  ...,  1.2703e-01,
            1.0692e-01, -1.0000e+07],
          [-1.0000e+07,  8.4739e-02,  1.1860e-01,  ...,  7.4531e-02,
            7.0215e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.5429e-02,  1.0966e-01,  ...,  9.0145e-02,
            6.3491e-02, -1.0000e+07],
          [-1.0000e+07,  6.0793e-02,  8.6950e-02,  ...,  5.4351e-02,
            6.0815e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.1332e-02,  1.2443e-01,  ...,  8.9360e-02,
            6.3589e-02, -1.0000e+07],
          [-1.0000e+07,  8.2802e-02,  1.0910e-01,  ...,  6.8748e-02,
            7.3103e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0833e-01,  1.2826e-01,  ...,  1.0985e-01,
            7.2953e-02, -1.0000e+07],
          [-1.0000e+07,  9.0298e-02,  1.1011e-01,  ...,  7.0845e-02,
            7.9242e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  1.1932e-01,  1.1331e-01,  ...,  8.2197e-02,
           -1.0000e+07, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  1.3196e-01,  1.3269e-01,  ...,  1.0634e-01,
           -1.0000e+07, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  9.9008e-02,  1.2519e-01,  ...,  1.0664e-01,
            7.7713e-02, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.5802e-01,  9.8854e-02],
         [ 1.4707e-01,  1.0534e-01],
         [ 1.6571e-01,  1.1860e-01],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0966e-01,  8.6950e-02],
         [ 1.2443e-01,  1.0910e-01],
         [ 1.2826e-01,  1.1011e-01],
         ...,
         [ 1.1932e-01,  8.6621e-02],
         [ 1.3269e-01,  8.6621e-02],
         [ 1.2519e-01,  8.6621e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-5.4051e-06, device='cuda:0') tensor(0.0006, device='cuda:0') tensor(-0.0008, device='cuda:0')
mixer_td_error tensor(0.9293, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2326, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8474, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0776, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2169, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0146, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-4199999.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2107, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.8638e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0004, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0950, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0645, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0950, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18704
target_mac_out tensor([[[[-1.0000e+07,  6.7158e-02,  1.4464e-01,  ...,  1.0220e-01,
            9.3161e-02, -1.0000e+07],
          [-1.0000e+07,  7.1278e-02,  9.9201e-02,  ...,  5.7853e-02,
            6.3885e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.4079e-02,  1.5954e-01,  ...,  1.1671e-01,
            1.0872e-01, -1.0000e+07],
          [-1.0000e+07,  8.4389e-02,  1.1654e-01,  ...,  7.0887e-02,
            7.7839e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.3261e-02,  1.5454e-01,  ...,  1.1239e-01,
            9.7607e-02, -1.0000e+07],
          [-1.0000e+07,  9.7453e-02,  1.1254e-01,  ...,  7.6355e-02,
            8.2916e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.3472e-02,  1.5646e-01,  ...,  1.2176e-01,
            1.0521e-01, -1.0000e+07],
          [-1.0000e+07,  7.2103e-02,  1.1518e-01,  ...,  7.6626e-02,
            7.8057e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.5820e-02,  1.7512e-01,  ...,  1.4160e-01,
            1.1907e-01, -1.0000e+07],
          [-1.0000e+07,  1.0074e-01,  1.3487e-01,  ...,  9.4781e-02,
            8.2390e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0317e-01,  2.0196e-01,  ...,  1.6750e-01,
            1.3914e-01, -1.0000e+07],
          [-1.0000e+07,  1.1174e-01,  1.3959e-01,  ...,  1.0448e-01,
            8.3369e-02, -1.0000e+07]],

         ...,

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  2.8299e-02, -1.0000e+07,  ..., -1.0000e+07,
            1.7303e-02,  8.6503e-03]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  2.2302e-02, -1.0000e+07,  ..., -1.0000e+07,
            1.7777e-02,  8.6609e-03]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.9731e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.4464e-01,  9.9201e-02],
         [ 1.5954e-01,  1.1654e-01],
         [ 1.5454e-01,  1.1254e-01],
         [ 1.5914e-01,  9.3846e-02],
         [ 1.3790e-01,  1.0729e-01],
         [ 1.3043e-01,  1.0015e-01],
         [ 1.4920e-01,  6.0107e-02],
         [ 1.1342e-01,  1.1700e-01],
         [ 1.2317e-01,  6.3365e-02],
         [ 1.4481e-01,  9.5271e-02],
         [ 1.3235e-01,  5.7436e-02],
         [ 1.3595e-01,  6.1099e-02],
         [ 1.5317e-01,  6.6562e-02],
         [ 1.5363e-01,  1.0100e-01],
         [ 1.2984e-01,  1.0823e-01],
         [ 1.4237e-01,  1.1639e-01],
         [ 1.5101e-01,  1.3289e-01],
         [ 1.5037e-01,  1.3691e-01],
         [ 1.7207e-01,  1.3744e-01],
         [ 1.6171e-01,  1.4043e-01],
         [ 1.8525e-01,  1.4753e-01],
         [ 1.6348e-01,  1.2896e-01],
         [ 1.7126e-01,  1.1862e-01],
         [ 1.7257e-01,  1.5308e-01],
         [ 1.5865e-01,  1.3597e-01],
         [ 1.7543e-01,  1.5932e-01],
         [ 1.3829e-01,  1.5170e-01],
         [ 1.5219e-01,  1.4175e-01],
         [ 1.6370e-01,  1.3763e-01],
         [ 1.3522e-01,  1.0795e-01],
         [ 1.3233e-01,  1.2384e-01],
         [ 1.4468e-01,  1.3365e-01],
         [ 1.6253e-01,  1.1872e-01],
         [ 1.5517e-01,  9.2702e-02],
         [ 1.1706e-01,  1.0734e-01],
         [ 1.4489e-01,  8.6004e-02],
         [ 1.6140e-01,  1.1159e-01],
         [ 1.7342e-01,  1.2483e-01],
         [ 1.2553e-01,  3.6544e-02],
         [ 1.0581e-01,  6.4568e-02],
         [ 1.2369e-01,  7.7379e-02],
         [ 1.2716e-01,  8.2872e-02],
         [ 1.0975e-01,  8.5153e-02],
         [ 1.1132e-01,  8.6055e-02],
         [ 1.2659e-01,  8.6398e-02],
         [ 1.0599e-01,  8.6512e-02],
         [ 9.6239e-02,  8.6554e-02],
         [ 1.2602e-01,  8.6592e-02],
         [ 1.3838e-01,  8.6590e-02],
         [ 1.5083e-01,  8.6609e-02],
         [ 1.5698e-01,  8.6595e-02],
         [ 1.6536e-01,  8.6618e-02],
         [ 1.3480e-01,  8.6598e-02],
         [ 1.2453e-01,  8.6607e-02],
         [ 1.4375e-01,  8.6622e-02],
         [ 1.4620e-01,  8.6625e-02],
         [ 1.3737e-01,  8.6626e-02],
         [ 1.5075e-01,  8.6623e-02],
         [ 1.3938e-01,  8.6622e-02],
         [ 1.1751e-01,  8.6622e-02],
         [ 1.2069e-01,  8.6623e-02],
         [ 1.3138e-01,  8.6621e-02],
         [ 1.4399e-01,  8.6621e-02],
         [ 1.4307e-01,  8.6621e-02],
         [ 1.4623e-01,  8.6621e-02],
         [ 2.9407e-02,  8.6621e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.5646e-01,  1.1518e-01],
         [ 1.7512e-01,  1.3487e-01],
         [ 2.0196e-01,  1.3959e-01],
         [ 1.9512e-01,  6.7443e-02],
         [ 1.8369e-01,  1.3016e-01],
         [ 1.9082e-01,  7.1647e-02],
         [ 1.6630e-01,  1.0792e-01],
         [ 1.6728e-01,  8.8981e-02],
         [ 1.6389e-01,  9.5113e-02],
         [ 1.8007e-01,  1.1359e-01],
         [ 1.8153e-01,  1.4360e-01],
         [ 2.0820e-01,  1.3362e-01],
         [ 2.0795e-01,  1.0563e-01],
         [ 1.8239e-01,  9.0395e-02],
         [ 1.3359e-01,  7.3762e-02],
         [ 1.4887e-01,  6.0984e-02],
         [ 1.5237e-01,  4.4775e-02],
         [ 1.2709e-01,  1.5517e-02],
         [ 1.1478e-01,  3.4122e-02],
         [ 9.5483e-02,  4.1487e-02],
         [ 1.8683e-02,  4.3385e-02],
         [ 3.9384e-02,  6.1348e-02],
         [ 5.0771e-02,  5.1407e-02],
         [ 5.6337e-02,  4.7782e-02],
         [ 5.8766e-02,  4.8797e-02],
         [ 5.9708e-02,  4.4566e-02],
         [ 5.9953e-02,  4.2567e-02],
         [ 5.9969e-02,  4.0746e-02],
         [ 5.9943e-02,  4.1381e-02],
         [ 5.9874e-02,  4.2949e-02],
         [ 5.9820e-02,  4.4284e-02],
         [ 5.9788e-02,  4.5233e-02],
         [ 5.9779e-02,  4.5851e-02],
         [ 5.9771e-02,  4.6203e-02],
         [ 5.9773e-02,  4.6401e-02],
         [ 5.9756e-02,  6.8063e-02],
         [ 5.9748e-02,  5.5374e-02],
         [ 5.9773e-02,  5.0098e-02],
         [ 5.9776e-02,  5.0640e-02],
         [ 5.9761e-02,  5.2739e-02],
         [ 5.9762e-02,  4.0714e-02],
         [ 5.9770e-02,  4.7956e-02],
         [ 5.9762e-02,  6.4745e-02],
         [ 5.9770e-02,  4.8626e-02],
         [ 5.9758e-02,  6.9563e-02],
         [ 5.9760e-02,  5.5765e-02],
         [ 5.9760e-02,  5.3378e-02],
         [ 5.9760e-02,  3.5276e-02],
         [ 5.9760e-02,  3.8638e-02],
         [ 5.9762e-02,  7.0672e-02],
         [ 5.9762e-02,  7.9167e-02],
         [ 5.9762e-02,  6.8508e-02],
         [ 5.9762e-02,  6.3017e-02],
         [ 5.9762e-02,  8.6275e-02],
         [ 5.9762e-02,  8.8259e-02],
         [ 5.9762e-02,  8.9201e-02],
         [ 5.9762e-02,  9.2997e-02],
         [ 5.9762e-02,  6.4207e-02],
         [ 5.9762e-02,  7.3012e-02],
         [ 5.9762e-02,  7.7345e-02],
         [ 5.9762e-02,  7.9140e-02],
         [ 5.9762e-02,  8.5863e-02],
         [ 5.9762e-02,  8.2936e-02],
         [ 5.9762e-02,  6.3933e-02],
         [ 5.9762e-02,  7.3080e-02],
         [ 5.9762e-02,  7.2274e-02],
         [ 5.9762e-02,  6.9412e-02],
         [ 5.9762e-02,  4.3095e-02],
         [ 5.9762e-02,  5.4653e-02],
         [ 5.9762e-02,  2.2929e-02],
         [ 5.9762e-02,  1.7303e-02],
         [ 5.9762e-02,  1.7777e-02],
         [ 5.9762e-02,  4.9731e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(5.1645e-06, device='cuda:0') tensor(0.0025, device='cuda:0') tensor(-0.0027, device='cuda:0')
mixer_td_error tensor(0.1066, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2635, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9516, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0945, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2174, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0106, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-479451.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2082, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.5922e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0025, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0916, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.0892, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0916, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18764
target_mac_out tensor([[[[-1.0000e+07,  7.0527e-02,  1.4370e-01,  ...,  1.0294e-01,
            9.3133e-02, -1.0000e+07],
          [-1.0000e+07,  6.1312e-02,  9.2874e-02,  ...,  5.6738e-02,
            6.1406e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.9400e-02,  1.5672e-01,  ...,  1.1726e-01,
            1.0706e-01, -1.0000e+07],
          [-1.0000e+07,  8.1015e-02,  1.1331e-01,  ...,  7.2238e-02,
            7.1404e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0868e-01,  1.6914e-01,  ...,  1.4375e-01,
            1.2277e-01, -1.0000e+07],
          [-1.0000e+07,  8.7652e-02,  9.5207e-02,  ...,  7.4539e-02,
            6.8360e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.0269e-02,  1.0780e-01,  ...,  8.8090e-02,
            6.1240e-02, -1.0000e+07],
          [-1.0000e+07,  7.1056e-02,  9.5596e-02,  ...,  5.5608e-02,
            6.2230e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0076e-01,  1.3946e-01,  ...,  1.0834e-01,
            8.1150e-02, -1.0000e+07],
          [-1.0000e+07,  8.3110e-02,  8.5139e-02,  ...,  6.3965e-02,
            6.3893e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0340e-01,  1.4243e-01,  ...,  1.0588e-01,
            8.2935e-02, -1.0000e+07],
          [-1.0000e+07,  7.8956e-02,  9.4526e-02,  ...,  5.7526e-02,
            5.6843e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  7.6589e-02,  1.2362e-01,  ...,  9.5903e-02,
            6.9378e-02, -1.0000e+07],
          [ 8.6624e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  8.0347e-02,  1.2582e-01,  ...,  9.4134e-02,
            6.6313e-02, -1.0000e+07],
          [ 8.6626e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.7829e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6625e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.4370e-01,  9.2874e-02],
         [ 1.5672e-01,  1.1331e-01],
         [ 1.6914e-01,  9.5207e-02],
         [ 1.5473e-01,  1.1968e-01],
         [ 1.4763e-01,  1.3256e-01],
         [ 1.6302e-01,  1.2409e-01],
         [ 1.8162e-01,  1.3526e-01],
         [ 1.2216e-01,  7.9463e-02],
         [ 1.3792e-01,  9.7335e-02],
         [ 1.6552e-01,  1.2150e-01],
         [ 1.6712e-01,  7.7840e-02],
         [ 1.3685e-01,  8.4317e-02],
         [ 1.5314e-01,  6.8743e-02],
         [ 1.3278e-01,  8.2947e-02],
         [ 1.4831e-01,  6.9011e-02],
         [ 1.2807e-01,  8.2808e-02],
         [ 1.4037e-01,  6.8709e-02],
         [ 1.3499e-01,  8.2286e-02],
         [ 1.2923e-01,  8.6345e-02],
         [ 1.0818e-01,  6.7062e-02],
         [ 1.2313e-01,  7.6831e-02],
         [ 1.2157e-01,  6.3340e-02],
         [ 1.5349e-01,  1.0789e-01],
         [ 1.2197e-01,  9.3309e-02],
         [ 1.2036e-01,  1.2054e-01],
         [ 1.4107e-01,  1.0092e-01],
         [ 1.6395e-01,  7.8430e-02],
         [ 1.0926e-01,  7.8131e-02],
         [ 1.1427e-01,  8.1271e-02],
         [ 1.1495e-01,  6.7892e-02],
         [ 1.3131e-01,  9.9361e-02],
         [ 1.4835e-01,  9.1560e-02],
         [ 1.0957e-01,  1.1662e-01],
         [ 1.7212e-01,  1.1951e-01],
         [ 1.9606e-01,  1.1715e-01],
         [ 1.9022e-01,  8.2840e-02],
         [ 1.6554e-01,  8.0703e-02],
         [ 1.7435e-01,  8.8916e-02],
         [ 1.7501e-01,  8.6065e-02],
         [ 1.7724e-01,  8.1685e-02],
         [ 1.7690e-01,  6.9759e-02],
         [ 1.6374e-01,  7.1225e-02],
         [ 1.5043e-01,  4.7323e-02],
         [ 1.4647e-01,  6.8910e-02],
         [ 1.4738e-01,  7.9847e-02],
         [ 1.4448e-01,  8.4570e-02],
         [ 1.1780e-03,  8.6326e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0780e-01,  9.5596e-02],
         [ 1.3946e-01,  8.3110e-02],
         [ 1.4243e-01,  9.4526e-02],
         [ 1.0905e-01,  9.6926e-02],
         [ 1.4342e-01,  9.3652e-02],
         [ 1.4739e-01,  1.0063e-01],
         [ 1.6116e-01,  1.2905e-01],
         [ 1.8994e-01,  1.3093e-01],
         [ 1.9804e-01,  1.2176e-01],
         [ 2.0285e-01,  1.0745e-01],
         [ 2.0639e-01,  1.0674e-01],
         [ 1.7230e-01,  9.0169e-02],
         [ 1.7185e-01,  8.1679e-02],
         [ 1.7030e-01,  7.3381e-02],
         [ 1.8672e-01,  1.1263e-01],
         [ 1.9469e-01,  9.0992e-02],
         [ 1.5454e-01,  1.0298e-01],
         [ 1.5363e-01,  5.9342e-02],
         [ 1.3514e-01,  1.0590e-01],
         [ 1.7970e-01,  1.1638e-01],
         [ 1.9858e-01,  9.3799e-02],
         [ 2.1159e-01,  1.1100e-01],
         [ 2.1333e-01,  1.0518e-01],
         [ 2.0861e-01,  1.3168e-01],
         [ 1.4845e-01,  1.1450e-01],
         [ 1.9064e-01,  1.2524e-01],
         [ 1.4318e-01,  1.2965e-01],
         [ 1.7963e-01,  1.3924e-01],
         [ 1.8617e-01,  1.4064e-01],
         [ 1.6933e-01,  1.0448e-01],
         [ 1.7671e-01,  1.0956e-01],
         [ 1.8155e-01,  8.7063e-02],
         [ 1.3708e-01,  1.1260e-01],
         [ 1.4056e-01,  9.9685e-02],
         [ 1.2911e-01,  7.8684e-02],
         [ 1.7260e-01,  5.8359e-02],
         [ 1.7763e-01,  5.4978e-02],
         [ 1.1407e-01,  4.0738e-02],
         [ 1.1330e-01,  6.3268e-02],
         [ 1.0711e-01,  7.6466e-02],
         [ 1.0413e-01,  8.2894e-02],
         [ 1.2469e-01,  8.5612e-02],
         [ 9.9926e-02,  8.6625e-02],
         [ 1.3410e-01,  8.6874e-02],
         [ 1.1319e-01,  8.6847e-02],
         [ 1.0581e-01,  8.6763e-02],
         [ 1.0045e-01,  8.6724e-02],
         [ 9.6489e-02,  8.6699e-02],
         [ 8.2895e-02,  8.6674e-02],
         [ 1.0118e-01,  8.6645e-02],
         [ 1.0402e-01,  8.6629e-02],
         [ 1.2362e-01,  8.6624e-02],
         [ 1.2582e-01,  8.6626e-02],
         [ 2.7829e-02,  8.6625e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.1921e-05, device='cuda:0') tensor(0.0026, device='cuda:0') tensor(-0.0030, device='cuda:0')
mixer_td_error tensor(0.1393, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2312, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.0824, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.1072, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2153, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0044, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-648147.9375, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2133, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(5.6340e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0032, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0945, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1468, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0945, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18810
target_mac_out tensor([[[[-1.0000e+07,  7.0608e-02,  1.0466e-01,  ...,  8.6790e-02,
            6.1806e-02, -1.0000e+07],
          [-1.0000e+07,  7.0382e-02,  7.6961e-02,  ...,  6.6786e-02,
            6.4623e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.6721e-02,  1.2441e-01,  ...,  8.7926e-02,
            6.3747e-02, -1.0000e+07],
          [-1.0000e+07,  9.6572e-02,  1.0005e-01,  ...,  7.7384e-02,
            7.2727e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.1202e-01,  1.5227e-01,  ...,  1.1168e-01,
            8.4357e-02, -1.0000e+07],
          [-1.0000e+07,  1.1375e-01,  1.2278e-01,  ...,  9.4031e-02,
            7.5821e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.8614e-02,  1.4453e-01,  ...,  1.0239e-01,
            9.3480e-02, -1.0000e+07],
          [-1.0000e+07,  7.2765e-02,  1.1170e-01,  ...,  7.5849e-02,
            7.6792e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.3461e-02,  1.3690e-01,  ...,  9.3761e-02,
            8.1060e-02, -1.0000e+07],
          [-1.0000e+07,  8.8307e-02,  1.2279e-01,  ...,  7.8996e-02,
            8.4566e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.6511e-02,  1.1656e-01,  ...,  9.6892e-02,
            6.7376e-02, -1.0000e+07],
          [-1.0000e+07,  9.2407e-02,  1.0888e-01,  ...,  5.8884e-02,
            7.1874e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  7.6248e-02,  1.3282e-01,  ...,  8.6972e-02,
            5.8555e-02,  7.5748e-02],
          [ 8.6616e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  7.7144e-02,  1.3361e-01,  ...,  9.4378e-02,
            6.8231e-02,  7.7819e-02],
          [ 8.6633e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-4.5023e-03, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6628e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0466e-01,  7.6961e-02],
         [ 1.2441e-01,  9.6572e-02],
         [ 1.5227e-01,  1.1375e-01],
         [ 1.1493e-01,  1.1999e-01],
         [ 1.4485e-01,  1.0720e-01],
         [ 1.5886e-01,  9.2445e-02],
         [ 1.8284e-01,  1.0907e-01],
         [ 1.8510e-01,  1.0040e-01],
         [ 1.5291e-01,  1.1620e-01],
         [ 1.4882e-01,  1.2092e-01],
         [ 1.7887e-01,  1.2991e-01],
         [ 1.5356e-01,  1.2294e-01],
         [ 1.3018e-01,  1.2596e-01],
         [ 1.3572e-01,  1.1350e-01],
         [ 1.3971e-01,  1.3055e-01],
         [ 1.4107e-01,  1.2645e-01],
         [ 1.6677e-01,  1.1718e-01],
         [ 1.1996e-01,  1.0731e-01],
         [ 1.1509e-01,  1.2416e-01],
         [ 1.6055e-01,  1.4185e-01],
         [ 1.4899e-01,  1.3684e-01],
         [ 1.5671e-01,  8.8852e-02],
         [ 1.8746e-01,  1.3949e-01],
         [ 1.6164e-01,  1.1456e-01],
         [ 1.9066e-01,  9.8765e-02],
         [ 1.9004e-01,  9.4222e-02],
         [ 1.6576e-01,  1.0480e-01],
         [ 1.8645e-01,  9.9111e-02],
         [ 1.6664e-01,  8.6536e-02],
         [ 1.8365e-01,  1.0104e-01],
         [ 1.6602e-01,  1.2739e-01],
         [ 1.6948e-01,  8.5676e-02],
         [ 1.4473e-01,  8.9651e-02],
         [ 1.3294e-01,  1.1060e-01],
         [ 1.5364e-01,  1.1194e-01],
         [ 1.5865e-01,  6.2940e-02],
         [ 1.4201e-01,  7.1481e-02],
         [ 1.2755e-01,  6.2295e-02],
         [ 8.7772e-02,  6.1732e-02],
         [ 1.9759e-02,  6.4682e-02],
         [ 3.7575e-02,  5.7138e-02],
         [ 4.8679e-02,  6.3381e-02],
         [ 5.4620e-02,  4.8549e-02],
         [ 5.7540e-02,  4.7663e-02],
         [ 5.8888e-02,  3.7782e-02],
         [ 5.9461e-02,  2.7203e-02],
         [ 5.9678e-02,  6.7991e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.4453e-01,  1.1170e-01],
         [ 1.3690e-01,  1.2279e-01],
         [ 1.1656e-01,  1.0888e-01],
         [ 9.7047e-02,  7.1519e-02],
         [ 1.1388e-01,  5.9124e-02],
         [ 1.2005e-01,  5.7434e-02],
         [ 1.0375e-01,  5.3651e-02],
         [ 9.3713e-02,  4.2857e-02],
         [ 9.0201e-02,  3.9435e-02],
         [ 1.2379e-01,  8.1458e-02],
         [ 9.1051e-02,  1.1552e-01],
         [ 1.2876e-01,  1.2427e-01],
         [ 1.6331e-01,  1.2340e-01],
         [ 1.5109e-01,  1.0784e-01],
         [ 1.4979e-01,  1.0200e-01],
         [ 1.3950e-01,  9.9325e-02],
         [ 1.6268e-01,  8.9872e-02],
         [ 1.6749e-01,  8.4289e-02],
         [ 1.8331e-01,  8.5973e-02],
         [ 1.7486e-01,  9.5601e-02],
         [ 1.6420e-01,  9.4027e-02],
         [ 1.6327e-01,  9.1675e-02],
         [ 1.6656e-01,  9.1135e-02],
         [ 1.6168e-01,  1.0386e-01],
         [ 1.6219e-01,  9.2189e-02],
         [ 1.7485e-01,  9.8811e-02],
         [ 1.5750e-01,  1.0612e-01],
         [ 1.4895e-01,  8.3102e-02],
         [ 1.4620e-01,  8.4372e-02],
         [ 1.8862e-01,  9.2358e-02],
         [ 2.0960e-01,  9.6515e-02],
         [ 2.1486e-01,  1.2248e-01],
         [ 1.9370e-01,  1.2310e-01],
         [ 1.3535e-01,  8.8297e-02],
         [ 1.7774e-01,  4.3860e-02],
         [ 1.8211e-01,  1.0277e-01],
         [ 1.1394e-01,  1.0004e-01],
         [ 1.7164e-01,  1.0609e-01],
         [ 1.8727e-01,  3.3466e-02],
         [ 1.7011e-01,  4.1068e-02],
         [ 1.3324e-01,  8.5409e-02],
         [ 1.7240e-01,  3.7209e-02],
         [ 1.8135e-01,  9.9584e-02],
         [ 1.9431e-01,  8.2799e-02],
         [ 1.6023e-01,  5.0921e-02],
         [ 1.2803e-01,  6.8292e-02],
         [ 1.0714e-01,  7.8489e-02],
         [ 8.9762e-02,  8.3437e-02],
         [ 9.6080e-02,  8.5593e-02],
         [ 8.7721e-02,  8.6379e-02],
         [ 7.5586e-02,  8.6629e-02],
         [ 1.1210e-01,  8.6703e-02],
         [ 7.1680e-02,  8.6686e-02],
         [ 7.9766e-02,  8.6675e-02],
         [ 7.9202e-02,  8.6639e-02],
         [ 1.0667e-01,  8.6631e-02],
         [ 1.2397e-01,  8.6631e-02],
         [ 1.3282e-01,  8.6616e-02],
         [ 1.3361e-01,  8.6633e-02],
         [-4.5023e-03,  8.6628e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-2.1340e-05, device='cuda:0') tensor(0.0026, device='cuda:0') tensor(-0.0033, device='cuda:0')
mixer_td_error tensor(0.2273, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2351, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9895, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.1074, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2128, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0102, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1083333.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2149, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0001, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0031, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0912, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1299, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0912, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18857
target_mac_out tensor([[[[-1.0000e+07,  7.3491e-02,  1.6030e-01,  ...,  1.2384e-01,
            1.0686e-01, -1.0000e+07],
          [-1.0000e+07,  8.7470e-02,  1.2344e-01,  ...,  9.0087e-02,
            7.7106e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.8122e-02,  1.3818e-01,  ...,  1.1849e-01,
            8.5107e-02, -1.0000e+07],
          [-1.0000e+07,  1.0717e-01,  1.2591e-01,  ...,  9.9996e-02,
            8.0364e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.1693e-01,  1.2952e-01,  ...,  1.1802e-01,
            7.3469e-02, -1.0000e+07],
          [-1.0000e+07,  9.0103e-02,  1.0608e-01,  ...,  8.4209e-02,
            6.7671e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  8.5868e-02,  1.0645e-01,  ...,  7.5939e-02,
            2.2600e-02,  6.2513e-02],
          [ 8.6622e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  7.5830e-02,  1.2349e-01,  ...,  7.5275e-02,
            3.0368e-02,  6.6435e-02],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 1.4852e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.0608e-02,  1.0466e-01,  ...,  8.6790e-02,
            6.1806e-02, -1.0000e+07],
          [-1.0000e+07,  7.0382e-02,  7.6961e-02,  ...,  6.6786e-02,
            6.4623e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.1968e-02,  1.3374e-01,  ...,  9.6902e-02,
            7.3120e-02, -1.0000e+07],
          [-1.0000e+07,  7.3143e-02,  8.5016e-02,  ...,  5.7140e-02,
            5.4633e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.1244e-01,  1.4664e-01,  ...,  1.1293e-01,
            9.0533e-02, -1.0000e+07],
          [-1.0000e+07,  8.2504e-02,  8.6445e-02,  ...,  7.9462e-02,
            6.3099e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  8.4150e-02,  9.1782e-02,  ...,  1.0895e-01,
            5.0658e-02, -1.0000e+07],
          [ 8.7269e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.6078e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.7037e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.6030e-01,  1.2344e-01],
         [ 1.3818e-01,  1.2591e-01],
         [ 1.1693e-01,  9.0103e-02],
         [ 1.5768e-01,  1.2171e-01],
         [ 1.5636e-01,  1.2868e-01],
         [ 1.8704e-01,  1.3015e-01],
         [ 1.9401e-01,  1.1349e-01],
         [ 1.8960e-01,  9.9056e-02],
         [ 1.9644e-01,  1.2940e-01],
         [ 1.7116e-01,  1.1932e-01],
         [ 1.7559e-01,  1.3444e-01],
         [ 1.7315e-01,  9.2960e-02],
         [ 1.6960e-01,  8.9489e-02],
         [ 1.7128e-01,  8.8173e-02],
         [ 1.7198e-01,  8.3769e-02],
         [ 1.2659e-01,  1.2910e-01],
         [ 1.3376e-01,  1.3975e-01],
         [ 1.4189e-01,  1.4460e-01],
         [ 1.2460e-01,  1.4007e-01],
         [ 1.6282e-01,  1.3206e-01],
         [ 1.2010e-01,  7.7656e-02],
         [ 1.1920e-01,  1.0603e-01],
         [ 1.6042e-01,  7.1869e-02],
         [ 1.1604e-01,  6.1131e-02],
         [ 1.4788e-01,  1.1250e-01],
         [ 1.3299e-01,  2.3607e-02],
         [ 1.3395e-01,  5.8991e-02],
         [ 1.3928e-01,  7.5244e-02],
         [ 1.1019e-01,  8.2284e-02],
         [ 1.2652e-01,  8.5164e-02],
         [ 1.0664e-01,  8.6254e-02],
         [ 1.0810e-01,  8.6606e-02],
         [ 9.7538e-02,  8.6688e-02],
         [ 1.0227e-01,  8.6672e-02],
         [ 1.0838e-01,  8.6656e-02],
         [ 1.3018e-01,  8.6604e-02],
         [ 1.4155e-01,  8.6636e-02],
         [ 1.0816e-01,  8.6626e-02],
         [ 1.3717e-01,  8.6609e-02],
         [ 1.4828e-01,  8.6637e-02],
         [ 1.6129e-01,  8.6624e-02],
         [ 1.5802e-01,  8.6620e-02],
         [ 1.0293e-01,  8.6627e-02],
         [ 9.5249e-02,  8.6619e-02],
         [ 1.3337e-01,  8.6625e-02],
         [ 9.1341e-02,  8.6624e-02],
         [ 1.0645e-01,  8.6622e-02],
         [ 1.2349e-01,  8.6621e-02],
         [ 1.4852e-02,  8.6621e-02]],

        [[ 1.0466e-01,  7.6961e-02],
         [ 1.3374e-01,  8.5016e-02],
         [ 1.4664e-01,  8.2504e-02],
         [ 1.4948e-01,  9.3235e-02],
         [ 1.6460e-01,  1.1267e-01],
         [ 1.5165e-01,  1.0296e-01],
         [ 1.4959e-01,  1.0974e-01],
         [ 1.2823e-01,  1.2884e-01],
         [ 1.5444e-01,  1.3237e-01],
         [ 1.7231e-01,  1.1997e-01],
         [ 1.4216e-01,  1.4143e-01],
         [ 1.6165e-01,  1.4073e-01],
         [ 1.6574e-01,  1.2195e-01],
         [ 2.0940e-01,  9.9483e-02],
         [ 2.0195e-01,  1.0056e-01],
         [ 1.8777e-01,  8.5227e-02],
         [ 1.8932e-01,  7.9880e-02],
         [ 1.7518e-01,  1.1253e-01],
         [ 1.8845e-01,  1.1759e-01],
         [ 2.2078e-01,  1.0099e-01],
         [ 1.8153e-01,  9.9829e-02],
         [ 1.5298e-01,  8.7783e-02],
         [ 1.2731e-01,  8.3362e-02],
         [ 1.1121e-01,  3.5253e-02],
         [ 1.1000e-01,  2.3784e-02],
         [ 9.2004e-02,  1.8022e-02],
         [ 9.0824e-02,  6.4209e-02],
         [ 9.1703e-02,  5.0968e-02],
         [ 1.0029e-01,  1.3307e-02],
         [ 8.2450e-02,  6.7315e-02],
         [ 8.9142e-02,  5.4803e-02],
         [ 1.0345e-01,  7.3853e-02],
         [ 1.0354e-01,  1.9729e-02],
         [ 1.2384e-01,  2.1299e-02],
         [ 9.6587e-02,  6.8239e-03],
         [ 8.7518e-02,  5.9991e-02],
         [ 8.9833e-02,  6.4904e-02],
         [ 9.3802e-02,  9.0640e-03],
         [ 1.1610e-01,  3.2702e-02],
         [ 1.2998e-01,  4.8619e-02],
         [ 1.2960e-01,  4.4316e-02],
         [ 1.3648e-01,  6.9783e-02],
         [ 1.4309e-01,  8.1171e-02],
         [ 1.1868e-01,  8.5677e-02],
         [ 1.1965e-01,  8.7145e-02],
         [ 1.2513e-01,  8.7389e-02],
         [ 1.0895e-01,  8.7269e-02],
         [ 2.6078e-02,  8.7037e-02],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.8469e-05, device='cuda:0') tensor(0.0022, device='cuda:0') tensor(-0.0022, device='cuda:0')
mixer_td_error tensor(0.0112, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.1941, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4193, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.1086, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2061, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0117, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-102040.7031, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2208, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(6.7307e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0009, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0895, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0843, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0895, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18902
target_mac_out tensor([[[[-1.0000e+07,  7.3491e-02,  1.6030e-01,  ...,  1.2384e-01,
            1.0686e-01, -1.0000e+07],
          [-1.0000e+07,  8.7470e-02,  1.2344e-01,  ...,  9.0087e-02,
            7.7106e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.8122e-02,  1.3818e-01,  ...,  1.1849e-01,
            8.5107e-02, -1.0000e+07],
          [-1.0000e+07,  1.0717e-01,  1.2591e-01,  ...,  9.9996e-02,
            8.0364e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.1693e-01,  1.2952e-01,  ...,  1.1802e-01,
            7.3469e-02, -1.0000e+07],
          [-1.0000e+07,  9.0103e-02,  1.0608e-01,  ...,  8.4209e-02,
            6.7671e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.6468e-02,  1.5802e-01,  ...,  1.2491e-01,
            1.0785e-01, -1.0000e+07],
          [-1.0000e+07,  6.1972e-02,  9.8854e-02,  ...,  5.9467e-02,
            6.2264e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.2893e-02,  1.7023e-01,  ...,  1.3268e-01,
            1.1415e-01, -1.0000e+07],
          [-1.0000e+07,  7.8475e-02,  9.0401e-02,  ...,  7.0161e-02,
            6.1602e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0422e-01,  1.8611e-01,  ...,  1.4944e-01,
            1.2492e-01, -1.0000e+07],
          [-1.0000e+07,  9.4198e-02,  1.0967e-01,  ...,  8.6585e-02,
            6.7883e-02, -1.0000e+07]],

         ...,

         [[ 5.9766e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  2.6944e-02, -1.0000e+07,  ...,  3.2994e-02,
            2.6216e-02,  2.4116e-02]],

         [[ 5.9760e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  1.2861e-02, -1.0000e+07,  ...,  3.6708e-02,
            2.7959e-02,  2.0430e-02]],

         [[ 5.9761e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 2.5532e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.6030e-01,  1.2344e-01],
         [ 1.3818e-01,  1.2591e-01],
         [ 1.1693e-01,  9.0103e-02],
         [ 1.5768e-01,  1.2171e-01],
         [ 1.5636e-01,  1.2868e-01],
         [ 1.8704e-01,  1.3015e-01],
         [ 1.9401e-01,  1.1349e-01],
         [ 1.8960e-01,  7.5444e-02],
         [ 1.9644e-01,  1.2940e-01],
         [ 1.7116e-01,  1.1932e-01],
         [ 1.7559e-01,  1.3444e-01],
         [ 1.7315e-01,  9.2960e-02],
         [ 1.6960e-01,  8.9489e-02],
         [ 1.7128e-01,  8.8173e-02],
         [ 1.7198e-01,  8.3769e-02],
         [ 1.2659e-01,  1.2910e-01],
         [ 1.3376e-01,  1.3975e-01],
         [ 1.4189e-01,  1.4460e-01],
         [ 1.2460e-01,  1.4007e-01],
         [ 1.6282e-01,  1.3206e-01],
         [ 1.2010e-01,  7.7656e-02],
         [ 1.1920e-01,  1.0603e-01],
         [ 1.6042e-01,  7.1869e-02],
         [ 1.1604e-01,  6.1131e-02],
         [ 1.4788e-01,  1.1250e-01],
         [ 1.3299e-01,  2.3607e-02],
         [ 1.3395e-01,  5.8991e-02],
         [ 1.3928e-01,  7.5244e-02],
         [ 1.1019e-01,  8.2284e-02],
         [ 1.2652e-01,  8.5164e-02],
         [ 1.0673e-01,  8.6254e-02],
         [ 1.0810e-01,  8.6606e-02],
         [ 9.7538e-02,  8.6688e-02],
         [ 1.0227e-01,  8.6672e-02],
         [ 1.0838e-01,  8.6656e-02],
         [ 1.3018e-01,  8.6604e-02],
         [ 1.4155e-01,  8.6636e-02],
         [ 1.0816e-01,  8.6626e-02],
         [ 1.3717e-01,  8.6609e-02],
         [ 1.4828e-01,  8.6637e-02],
         [ 1.6129e-01,  8.6624e-02],
         [ 1.5802e-01,  8.6620e-02],
         [ 1.0293e-01,  8.6627e-02],
         [ 9.5249e-02,  8.6619e-02],
         [ 1.3337e-01,  8.6625e-02],
         [ 9.1341e-02,  8.6624e-02],
         [ 1.0645e-01,  8.6622e-02],
         [ 1.2349e-01,  8.6621e-02],
         [ 1.4852e-02,  8.6621e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.5802e-01,  9.8854e-02],
         [ 1.7023e-01,  9.0401e-02],
         [ 1.8611e-01,  1.0967e-01],
         [ 1.9148e-01,  1.1456e-01],
         [ 1.8968e-01,  9.3328e-02],
         [ 1.6418e-01,  8.5205e-02],
         [ 1.3414e-01,  8.5171e-02],
         [ 1.6195e-01,  1.0153e-01],
         [ 1.6435e-01,  1.1421e-01],
         [ 1.4366e-01,  9.7958e-02],
         [ 1.3688e-01,  1.1151e-01],
         [ 1.3391e-01,  8.3711e-02],
         [ 1.3122e-01,  8.4689e-02],
         [ 1.2784e-01,  9.6152e-02],
         [ 1.1596e-01,  9.0653e-02],
         [ 1.2031e-01,  8.4958e-02],
         [ 1.1982e-01,  7.5612e-02],
         [ 1.2738e-01,  9.3693e-02],
         [ 1.1143e-01,  8.6090e-02],
         [ 1.1760e-01,  1.1849e-01],
         [ 1.2736e-01,  1.3328e-01],
         [ 1.2906e-01,  1.1778e-01],
         [ 1.5301e-01,  1.4989e-01],
         [ 1.2963e-01,  1.5143e-01],
         [ 1.2741e-01,  1.2427e-01],
         [ 1.4080e-01,  1.4109e-01],
         [ 1.3740e-01,  1.2464e-01],
         [ 1.3531e-01,  1.2870e-01],
         [ 1.3443e-01,  1.3541e-01],
         [ 1.3793e-01,  1.2270e-01],
         [ 1.4751e-01,  1.1540e-01],
         [ 1.5155e-01,  1.1164e-01],
         [ 1.4164e-01,  7.7999e-02],
         [ 1.4171e-01,  5.5196e-02],
         [ 1.4649e-01,  4.4279e-02],
         [ 1.4009e-01,  3.9001e-02],
         [-3.4265e-03,  1.9818e-02],
         [ 2.9367e-02,  4.3184e-02],
         [ 4.6456e-02,  6.1333e-02],
         [ 5.4792e-02,  4.9575e-02],
         [ 5.8480e-02,  1.2874e-02],
         [ 5.9939e-02,  6.6928e-02],
         [ 6.0390e-02,  6.7311e-02],
         [ 6.0395e-02,  5.3436e-02],
         [ 6.0253e-02,  7.7445e-02],
         [ 6.0127e-02,  5.2361e-02],
         [ 6.0004e-02,  7.6912e-02],
         [ 5.9900e-02,  6.5292e-02],
         [ 5.9832e-02,  4.9128e-02],
         [ 5.9823e-02,  1.4153e-02],
         [ 5.9792e-02,  2.8007e-02],
         [ 5.9789e-02,  2.7507e-02],
         [ 5.9768e-02, -1.0114e-02],
         [ 5.9759e-02, -1.7088e-02],
         [ 5.9757e-02,  6.5658e-02],
         [ 5.9756e-02,  1.1110e-02],
         [ 5.9775e-02,  2.5045e-02],
         [ 5.9766e-02,  2.6216e-02],
         [ 5.9760e-02,  2.7959e-02],
         [ 5.9761e-02,  2.5532e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.8580e-05, device='cuda:0') tensor(0.0018, device='cuda:0') tensor(-0.0029, device='cuda:0')
mixer_td_error tensor(0.2230, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2775, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9614, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.1022, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1955, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0073, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-916666.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1964, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.7599e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0028, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0620, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1819, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0620, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18948
target_mac_out tensor([[[[-1.0000e+07,  7.0527e-02,  1.4370e-01,  ...,  1.0294e-01,
            9.3133e-02, -1.0000e+07],
          [-1.0000e+07,  6.1312e-02,  9.2874e-02,  ...,  5.6738e-02,
            6.1406e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.2908e-02,  1.6967e-01,  ...,  1.3655e-01,
            1.1797e-01, -1.0000e+07],
          [-1.0000e+07,  7.9645e-02,  1.0643e-01,  ...,  5.6716e-02,
            6.1929e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0078e-01,  1.7964e-01,  ...,  1.4100e-01,
            1.1825e-01, -1.0000e+07],
          [-1.0000e+07,  9.9684e-02,  1.2887e-01,  ...,  8.6955e-02,
            7.3739e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.4400e-02,  1.5224e-01,  ...,  1.1891e-01,
            1.0222e-01, -1.0000e+07],
          [-1.0000e+07,  7.3168e-02,  8.7196e-02,  ...,  7.1644e-02,
            6.6248e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.6646e-02,  1.6392e-01,  ...,  1.2500e-01,
            1.0796e-01, -1.0000e+07],
          [-1.0000e+07,  8.5477e-02,  9.2330e-02,  ...,  8.8603e-02,
            6.7204e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.7250e-02,  1.2443e-01,  ...,  1.1118e-01,
            8.3328e-02, -1.0000e+07],
          [-1.0000e+07,  9.6060e-02,  9.4709e-02,  ...,  7.8253e-02,
            5.9546e-02, -1.0000e+07]],

         ...,

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  7.8589e-02,  6.9678e-02,  ...,  4.6664e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  8.3025e-02,  7.8250e-02,  ...,  5.5450e-02,
           -1.0000e+07, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 6.3208e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.4370e-01,  9.2874e-02],
         [ 1.6967e-01,  1.0643e-01],
         [ 1.7964e-01,  1.2887e-01],
         [ 1.6954e-01,  1.3236e-01],
         [ 1.6102e-01,  1.2534e-01],
         [ 1.2662e-01,  1.3017e-01],
         [ 1.5776e-01,  6.0459e-02],
         [ 1.6443e-01,  6.9106e-02],
         [ 1.8864e-01,  6.3756e-02],
         [ 1.8904e-01,  1.2868e-01],
         [ 1.7780e-01,  1.2778e-01],
         [ 1.8934e-01,  1.4668e-01],
         [ 1.6913e-01,  1.4118e-01],
         [ 1.5799e-01,  1.0694e-01],
         [ 1.7364e-01,  1.2598e-01],
         [ 1.6034e-01,  1.1740e-01],
         [ 1.6951e-01,  1.0318e-01],
         [ 1.5049e-01,  9.8867e-02],
         [ 6.5110e-02,  1.4168e-01],
         [ 6.4023e-02,  1.0589e-01],
         [ 1.5922e-01,  1.0049e-01],
         [ 1.6329e-01,  1.3366e-01],
         [ 1.2240e-01,  9.3909e-02],
         [ 1.4445e-01,  9.2680e-02],
         [ 1.5909e-01,  1.1539e-01],
         [ 1.6258e-01,  1.0395e-01],
         [ 1.6327e-01,  1.2385e-01],
         [ 1.2850e-01,  2.4430e-02],
         [ 1.1121e-01,  5.9825e-02],
         [ 1.1639e-01,  7.6474e-02],
         [ 1.1575e-01,  8.3561e-02],
         [ 1.1362e-01,  8.6259e-02],
         [ 1.2597e-01,  8.7067e-02],
         [ 1.2099e-01,  8.7215e-02],
         [ 1.1821e-01,  8.7095e-02],
         [ 1.1680e-01,  8.6942e-02],
         [ 1.2258e-01,  8.6835e-02],
         [ 1.1661e-01,  8.6729e-02],
         [ 1.1525e-01,  8.6701e-02],
         [ 1.0854e-01,  8.6671e-02],
         [ 1.1138e-01,  8.6653e-02],
         [ 1.4041e-01,  8.6642e-02],
         [ 1.5076e-01,  8.6637e-02],
         [ 1.2755e-01,  8.6636e-02],
         [ 1.3209e-01,  8.6624e-02],
         [ 1.1775e-01,  8.6631e-02],
         [ 1.2179e-01,  8.6626e-02],
         [ 1.1478e-01,  8.6625e-02],
         [ 1.3995e-01,  8.6623e-02],
         [ 1.3326e-01,  8.6621e-02],
         [ 1.2078e-01,  8.6621e-02],
         [ 9.9031e-02,  8.6621e-02],
         [ 9.6792e-02,  8.6621e-02],
         [ 9.6475e-02,  8.6621e-02],
         [ 9.3538e-02,  8.6621e-02],
         [ 9.5501e-02,  8.6621e-02],
         [ 1.3114e-01,  8.6621e-02],
         [ 1.0258e-01,  8.6621e-02],
         [ 1.0363e-01,  8.6621e-02],
         [ 9.4847e-02,  8.6621e-02],
         [ 9.1383e-02,  8.6621e-02],
         [ 1.0836e-01,  8.6621e-02],
         [ 9.8721e-02,  8.6621e-02],
         [ 1.0345e-01,  8.6621e-02],
         [ 1.1601e-01,  8.6621e-02],
         [ 1.2995e-01,  8.6621e-02],
         [ 1.2459e-01,  8.6621e-02],
         [ 1.4774e-01,  8.6621e-02],
         [ 1.1094e-01,  8.6621e-02],
         [ 1.0910e-01,  8.6621e-02],
         [ 1.0106e-01,  8.6621e-02],
         [ 1.3670e-01,  8.6621e-02],
         [ 1.2203e-01,  8.6621e-02],
         [ 1.1526e-01,  8.6621e-02],
         [ 9.4783e-02,  8.6621e-02],
         [ 9.0771e-02,  8.6621e-02],
         [ 8.5535e-02,  8.6621e-02],
         [ 1.0197e-01,  8.6621e-02],
         [ 1.3557e-01,  8.6621e-02],
         [ 1.0638e-01,  8.6621e-02],
         [ 9.2686e-02,  8.6621e-02],
         [ 1.1294e-01,  8.6621e-02],
         [ 1.0339e-01,  8.6621e-02],
         [ 1.2253e-01,  8.6621e-02],
         [ 1.2756e-01,  8.6621e-02],
         [ 1.3720e-01,  8.6621e-02],
         [ 1.4750e-01,  8.6621e-02],
         [ 1.4114e-01,  8.6621e-02],
         [ 1.2927e-01,  8.6621e-02],
         [ 1.2299e-01,  8.6621e-02],
         [ 1.1740e-01,  8.6621e-02],
         [ 1.1609e-01,  8.6621e-02],
         [ 1.1493e-01,  8.6621e-02],
         [ 1.2021e-01,  8.6621e-02],
         [ 1.3722e-01,  8.6621e-02],
         [ 1.2768e-01,  8.6621e-02],
         [ 1.3841e-01,  8.6621e-02],
         [ 1.2108e-01,  8.6621e-02],
         [ 1.2803e-01,  8.6621e-02],
         [ 1.2832e-01,  8.6621e-02],
         [ 1.4355e-01,  8.6621e-02],
         [ 1.4007e-01,  8.6621e-02],
         [ 1.2862e-01,  8.6621e-02],
         [ 1.3105e-01,  8.6621e-02],
         [ 1.3022e-01,  8.6621e-02],
         [ 1.3376e-01,  8.6621e-02],
         [ 1.1263e-01,  8.6621e-02],
         [ 3.9344e-02,  8.6621e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.5224e-01,  8.7196e-02],
         [ 1.6392e-01,  9.2330e-02],
         [ 1.2443e-01,  9.6060e-02],
         [ 1.5660e-01,  1.1058e-01],
         [ 7.0546e-02,  1.1398e-01],
         [ 1.4227e-01,  1.1249e-01],
         [ 1.6655e-01,  1.0842e-01],
         [ 7.7717e-02,  7.3005e-02],
         [ 7.2134e-02,  8.6117e-02],
         [ 1.5253e-01,  8.7858e-02],
         [ 1.5929e-01,  9.3145e-02],
         [ 1.4390e-01,  9.1065e-02],
         [ 7.0622e-02,  1.0590e-01],
         [ 1.3205e-01,  1.0914e-01],
         [ 1.4983e-01,  1.1225e-01],
         [ 1.6780e-01,  1.0227e-01],
         [ 1.6963e-01,  5.4189e-02],
         [ 1.4578e-01,  1.0121e-01],
         [ 1.7032e-01,  9.6903e-02],
         [ 1.7754e-01,  5.1425e-02],
         [ 1.5610e-01,  5.4367e-02],
         [ 1.3707e-01,  5.2164e-02],
         [ 1.5572e-01,  9.9597e-02],
         [ 1.6809e-01,  1.0471e-01],
         [ 1.7647e-01,  9.6962e-02],
         [ 1.0797e-01,  5.4922e-02],
         [ 9.1587e-02,  5.5102e-02],
         [ 1.0331e-01,  2.9750e-02],
         [ 1.1081e-01,  2.8310e-02],
         [ 1.1487e-01,  7.2942e-02],
         [ 1.0327e-01,  6.6737e-02],
         [ 1.1684e-01,  5.6983e-02],
         [ 1.6199e-01,  8.4422e-02],
         [ 1.8031e-01,  9.1733e-02],
         [ 1.7562e-01,  9.3579e-02],
         [ 1.9018e-01,  8.7382e-02],
         [ 1.9954e-01,  1.1479e-01],
         [ 1.3767e-01,  1.0008e-01],
         [ 1.1093e-01,  5.4654e-02],
         [ 1.0505e-01,  5.3258e-02],
         [ 1.1162e-01,  4.6305e-02],
         [ 1.0016e-01,  2.2778e-02],
         [ 7.0285e-02,  3.1860e-02],
         [ 9.9286e-02,  2.7494e-02],
         [ 8.3806e-02,  6.9570e-02],
         [ 9.4241e-02,  5.9930e-02],
         [ 1.1989e-01,  7.2721e-02],
         [ 1.0259e-01,  7.6010e-02],
         [ 1.1117e-01,  8.5286e-02],
         [ 9.1685e-02,  7.8339e-02],
         [ 1.0391e-01,  7.3295e-02],
         [ 1.0405e-01,  6.3688e-02],
         [ 1.3181e-01,  7.7721e-02],
         [ 1.4430e-01,  8.9322e-02],
         [ 1.4190e-01,  8.6992e-02],
         [ 1.4446e-01,  8.8868e-02],
         [ 1.3710e-01,  8.7043e-02],
         [ 1.6200e-01,  8.1366e-02],
         [ 1.4444e-01,  8.0014e-02],
         [ 1.6432e-01,  1.0851e-01],
         [ 1.7184e-01,  9.7523e-02],
         [ 1.7273e-01,  1.0377e-01],
         [ 1.8342e-01,  1.0653e-01],
         [ 1.5015e-01,  4.5282e-02],
         [ 1.5335e-01,  5.4233e-02],
         [ 1.1767e-01,  7.8640e-02],
         [ 1.4869e-01,  8.5756e-02],
         [ 1.5450e-01,  8.9114e-02],
         [ 1.5635e-01,  8.5275e-02],
         [ 1.5494e-01,  8.7718e-02],
         [ 1.2120e-01,  7.3899e-02],
         [ 5.3052e-02,  5.6128e-02],
         [ 5.4399e-02,  4.6747e-02],
         [ 5.7532e-02,  9.6575e-03],
         [ 5.9384e-02,  7.1383e-03],
         [ 6.0071e-02,  8.7487e-03],
         [ 6.0206e-02,  3.7994e-02],
         [ 6.0126e-02,  3.1557e-02],
         [ 5.9997e-02,  1.7476e-02],
         [ 5.9901e-02,  3.0009e-02],
         [ 5.9830e-02,  3.6728e-02],
         [ 5.9785e-02,  3.5973e-02],
         [ 5.9789e-02,  3.3502e-02],
         [ 5.9769e-02, -1.4659e-03],
         [ 5.9777e-02,  1.0517e-03],
         [ 5.9750e-02,  3.6951e-02],
         [ 5.9771e-02,  2.7280e-02],
         [ 5.9753e-02,  3.3454e-02],
         [ 5.9772e-02,  2.6094e-02],
         [ 5.9773e-02,  1.8484e-02],
         [ 5.9764e-02,  5.2552e-02],
         [ 5.9764e-02,  5.5983e-02],
         [ 5.9765e-02,  2.5784e-03],
         [ 5.9764e-02,  3.5704e-02],
         [ 5.9760e-02,  5.7582e-02],
         [ 5.9761e-02,  3.4963e-02],
         [ 5.9761e-02,  3.0148e-02],
         [ 5.9761e-02,  5.3520e-02],
         [ 5.9761e-02,  3.5925e-02],
         [ 5.9760e-02,  3.1034e-02],
         [ 5.9761e-02,  4.9212e-02],
         [ 5.9762e-02,  5.0414e-02],
         [ 5.9760e-02,  2.4878e-02],
         [ 5.9760e-02,  5.0059e-02],
         [ 5.9762e-02,  5.3134e-02],
         [ 5.9762e-02,  5.3377e-02],
         [ 5.9762e-02,  5.2749e-02],
         [ 5.9762e-02,  1.9647e-02],
         [ 5.9762e-02,  2.8906e-02],
         [ 5.9762e-02,  4.9327e-02],
         [ 5.9762e-02,  3.6940e-02],
         [ 5.9762e-02,  4.6213e-02],
         [ 5.9762e-02,  7.4402e-02],
         [ 5.9762e-02,  7.9107e-02],
         [ 5.9762e-02,  1.1907e-02],
         [ 5.9762e-02,  5.0150e-02],
         [ 5.9762e-02,  5.2665e-02],
         [ 5.9762e-02,  5.8939e-02],
         [ 5.9762e-02,  5.8850e-02],
         [ 5.9762e-02,  5.7147e-02],
         [ 5.9762e-02,  3.5333e-02],
         [ 5.9762e-02,  3.8495e-02],
         [ 5.9762e-02,  4.9620e-02],
         [ 5.9762e-02,  7.3716e-02],
         [ 5.9762e-02,  8.3141e-02],
         [ 5.9762e-02,  6.1366e-02],
         [ 5.9762e-02,  1.4664e-02],
         [ 5.9762e-02,  3.6919e-02],
         [ 5.9762e-02,  5.2134e-02],
         [ 5.9762e-02, -7.4406e-03],
         [ 5.9762e-02,  5.2560e-02],
         [ 5.9762e-02,  4.9509e-02],
         [ 5.9762e-02,  6.7199e-02],
         [ 5.9762e-02,  1.0732e-03],
         [ 5.9762e-02, -5.4641e-03],
         [ 5.9762e-02,  5.3110e-02],
         [ 5.9762e-02,  8.0105e-02],
         [ 5.9762e-02,  7.2129e-02],
         [ 5.9762e-02,  7.4129e-02],
         [ 5.9762e-02,  8.2439e-02],
         [ 5.9762e-02,  7.0035e-02],
         [ 5.9762e-02,  6.7043e-02],
         [ 5.9762e-02,  7.3818e-02],
         [ 5.9762e-02,  7.0264e-02],
         [ 5.9762e-02,  2.4954e-02],
         [ 5.9762e-02,  2.8888e-02],
         [ 5.9762e-02,  2.0922e-02],
         [ 5.9762e-02,  7.8589e-02],
         [ 5.9762e-02,  7.8250e-02],
         [ 5.9762e-02,  6.3208e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(2.0038e-05, device='cuda:0') tensor(0.0003, device='cuda:0') tensor(-0.0001, device='cuda:0')
mixer_td_error tensor(0.3327, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2719, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0689, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0862, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1966, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0129, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1399999.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1995, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.8102e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(5.6506e-05, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0886, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.0995, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0886, device='cuda:0', grad_fn=<MinBackward1>)
t_env 18994
target_mac_out tensor([[[[-1.0000e+07,  7.3472e-02,  1.5646e-01,  ...,  1.2176e-01,
            1.0521e-01, -1.0000e+07],
          [-1.0000e+07,  7.2103e-02,  1.1518e-01,  ...,  7.6626e-02,
            7.8057e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.9222e-02,  1.4752e-01,  ...,  1.0583e-01,
            8.7646e-02, -1.0000e+07],
          [-1.0000e+07,  1.0276e-01,  1.3569e-01,  ...,  9.3820e-02,
            8.3285e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0704e-01,  1.7705e-01,  ...,  1.4026e-01,
            1.1549e-01, -1.0000e+07],
          [-1.0000e+07,  1.1660e-01,  1.3838e-01,  ...,  1.0248e-01,
            8.5673e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.8532e-02,  1.2278e-01,  ...,  7.9915e-02,
            6.6448e-02, -1.0000e+07],
          [-1.0000e+07,  6.3509e-02,  9.5194e-02,  ...,  5.7350e-02,
            6.2821e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.6996e-02,  1.3882e-01,  ...,  9.1470e-02,
            7.6535e-02, -1.0000e+07],
          [-1.0000e+07,  8.0279e-02,  8.4748e-02,  ...,  6.6042e-02,
            6.1243e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.5707e-02,  1.5107e-01,  ...,  1.1067e-01,
            1.0036e-01, -1.0000e+07],
          [-1.0000e+07,  8.8978e-02,  1.0987e-01,  ...,  7.7734e-02,
            6.9719e-02, -1.0000e+07]],

         ...,

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  3.7957e-02,  1.7652e-02,  ...,  1.6289e-03,
            2.1008e-02, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  2.7651e-02,  7.5276e-03,  ..., -2.9621e-03,
            1.9898e-02, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  1.9959e-02,  3.7156e-03,  ..., -8.5727e-03,
            1.8089e-02, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.5646e-01,  1.1518e-01],
         [ 1.4752e-01,  1.3569e-01],
         [ 1.7705e-01,  1.3838e-01],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.2278e-01,  9.5194e-02],
         [ 1.3882e-01,  8.4748e-02],
         [ 1.5107e-01,  1.0987e-01],
         ...,
         [ 5.9762e-02,  2.1008e-02],
         [ 5.9762e-02,  1.9898e-02],
         [ 5.9762e-02,  1.8089e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-5.0867e-07, device='cuda:0') tensor(0.0007, device='cuda:0') tensor(-0.0010, device='cuda:0')
mixer_td_error tensor(0.9441, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2614, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9961, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0629, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1957, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0008, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-4233333., device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2014, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.8985e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0604, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1053, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0604, device='cuda:0', grad_fn=<MinBackward1>)
t_env 19039
target_mac_out tensor([[[[-1.0000e+07,  6.7856e-02,  1.2627e-01,  ...,  8.1598e-02,
            6.5922e-02, -1.0000e+07],
          [-1.0000e+07,  8.9393e-02,  1.1920e-01,  ...,  8.7495e-02,
            7.6975e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0002e-01,  1.4767e-01,  ...,  1.0549e-01,
            8.4622e-02, -1.0000e+07],
          [-1.0000e+07,  9.6193e-02,  9.5208e-02,  ...,  8.1469e-02,
            7.0822e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0823e-01,  1.6776e-01,  ...,  1.3544e-01,
            1.1092e-01, -1.0000e+07],
          [-1.0000e+07,  1.1623e-01,  1.3056e-01,  ...,  9.8692e-02,
            7.6740e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.5871e-02,  1.2252e-01,  ...,  7.9492e-02,
            6.6346e-02, -1.0000e+07],
          [-1.0000e+07,  7.5067e-02,  1.1346e-01,  ...,  7.5107e-02,
            7.9461e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.3809e-02,  1.4867e-01,  ...,  1.0538e-01,
            9.4175e-02, -1.0000e+07],
          [-1.0000e+07,  8.9042e-02,  9.3349e-02,  ...,  7.1857e-02,
            7.2478e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.7214e-02,  1.2237e-01,  ...,  1.0441e-01,
            7.6959e-02, -1.0000e+07],
          [-1.0000e+07,  1.0484e-01,  1.0365e-01,  ...,  7.7602e-02,
            7.6586e-02, -1.0000e+07]],

         ...,

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  4.3758e-02,  6.5338e-02,  ...,  3.3589e-02,
            2.1995e-02,  1.3268e-02]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  3.9897e-02,  6.5887e-02,  ...,  3.4166e-02,
            1.5274e-02,  1.3155e-02]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.1573e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.2627e-01,  1.1920e-01],
         [ 1.4767e-01,  9.6193e-02],
         [ 1.6776e-01,  1.3056e-01],
         [ 1.7117e-01,  1.2416e-01],
         [ 1.6260e-01,  1.0027e-01],
         [ 1.7278e-01,  9.5395e-02],
         [ 1.8849e-01,  9.8185e-02],
         [ 1.7536e-01,  8.8858e-02],
         [ 1.8891e-01,  9.3109e-02],
         [ 1.7501e-01,  1.1714e-01],
         [ 1.9381e-01,  1.3843e-01],
         [ 1.7179e-01,  1.0034e-01],
         [ 1.5978e-01,  1.0154e-01],
         [ 1.9538e-01,  9.9494e-02],
         [ 1.6680e-01,  8.3452e-02],
         [ 1.5642e-01,  7.2679e-02],
         [ 1.3529e-01,  6.0757e-02],
         [ 1.3692e-01,  6.2500e-02],
         [ 1.5989e-01,  6.0288e-02],
         [ 1.5714e-01,  5.8084e-02],
         [ 1.5898e-01,  6.8092e-02],
         [ 1.6198e-01,  7.3843e-02],
         [ 1.4199e-01,  7.7615e-02],
         [ 1.6462e-01,  8.6412e-02],
         [ 1.3963e-01,  1.1614e-01],
         [ 1.7510e-01,  1.1265e-01],
         [ 1.5402e-01,  1.2588e-01],
         [ 2.6800e-02,  1.0169e-01],
         [ 4.3198e-02,  8.2489e-02],
         [ 5.2447e-02,  7.0436e-02],
         [ 5.6896e-02,  6.6748e-02],
         [ 5.8790e-02,  6.7197e-02],
         [ 5.9490e-02,  5.2945e-02],
         [ 5.9687e-02,  5.7599e-02],
         [ 5.9747e-02,  4.4162e-02],
         [ 5.9755e-02,  6.4728e-02],
         [ 5.9748e-02,  6.9310e-02],
         [ 5.9752e-02,  5.0836e-02],
         [ 5.9744e-02,  6.5556e-02],
         [ 5.9754e-02,  6.2312e-02],
         [ 5.9761e-02,  7.6651e-02],
         [ 5.9768e-02,  6.3806e-02],
         [ 5.9755e-02,  8.8171e-02],
         [ 5.9758e-02,  9.1536e-02],
         [ 5.9756e-02,  9.1860e-02],
         [ 5.9776e-02,  5.8394e-02],
         [ 5.9774e-02,  8.0418e-02],
         [ 5.9766e-02,  8.7886e-02],
         [ 5.9760e-02,  5.8494e-02],
         [ 5.9762e-02,  4.8568e-02],
         [ 5.9760e-02,  7.3187e-02],
         [ 5.9761e-02,  5.1447e-02],
         [ 5.9761e-02,  7.2401e-02],
         [ 5.9761e-02,  7.3286e-02],
         [ 5.9761e-02,  3.7184e-02],
         [ 5.9761e-02,  5.8508e-02],
         [ 5.9761e-02,  6.4874e-02],
         [ 5.9761e-02,  4.0705e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.2252e-01,  1.1346e-01],
         [ 1.4867e-01,  8.9042e-02],
         [ 1.2237e-01,  1.0484e-01],
         [ 1.4955e-01,  1.0247e-01],
         [ 1.4861e-01,  9.8709e-02],
         [ 1.5695e-01,  8.4222e-02],
         [ 1.2401e-01,  7.8239e-02],
         [ 1.2474e-01,  7.6612e-02],
         [ 1.2872e-01,  7.3554e-02],
         [ 1.4077e-01,  5.8826e-02],
         [ 1.4363e-01,  1.0117e-01],
         [ 1.3431e-01,  1.1087e-01],
         [ 1.3603e-01,  1.1274e-01],
         [ 1.2973e-01,  6.3798e-02],
         [ 1.3614e-01,  9.0333e-02],
         [ 1.3003e-01,  1.0372e-01],
         [ 1.4985e-01,  6.1362e-02],
         [ 1.6548e-01,  1.1445e-01],
         [ 1.6955e-01,  1.2049e-01],
         [ 1.6588e-01,  9.3047e-02],
         [ 1.5847e-01,  1.0563e-01],
         [ 1.8404e-01,  1.1367e-01],
         [ 1.7168e-01,  7.3623e-02],
         [ 1.6030e-01,  6.9209e-02],
         [ 1.5708e-01,  6.4669e-02],
         [ 1.4059e-01,  1.1270e-01],
         [ 1.4882e-01,  1.2809e-01],
         [ 1.8762e-01,  1.2997e-01],
         [ 1.8235e-01,  1.3584e-01],
         [ 1.9962e-01,  1.4344e-01],
         [ 1.7204e-01,  1.3918e-01],
         [ 1.9434e-01,  1.3055e-01],
         [ 2.0123e-01,  1.3739e-01],
         [ 1.7040e-01,  1.2280e-01],
         [ 1.8820e-01,  1.3024e-01],
         [ 1.5934e-01,  1.2650e-01],
         [ 1.8525e-01,  1.0665e-01],
         [-3.5726e-03,  8.4223e-02],
         [ 2.8719e-02,  7.6863e-02],
         [ 4.5585e-02,  6.8650e-02],
         [ 5.3835e-02,  5.3757e-02],
         [ 5.7648e-02,  5.0938e-02],
         [ 5.9269e-02,  5.2104e-02],
         [ 5.9867e-02,  4.8616e-02],
         [ 6.0024e-02,  4.7969e-02],
         [ 6.0009e-02,  6.4647e-02],
         [ 5.9939e-02,  5.8132e-02],
         [ 5.9886e-02,  5.6256e-02],
         [ 5.9862e-02,  5.2995e-02],
         [ 5.9833e-02,  6.9209e-02],
         [ 5.9794e-02,  5.6206e-02],
         [ 5.9790e-02,  5.3372e-02],
         [ 5.9755e-02,  5.9879e-02],
         [ 5.9769e-02,  4.4132e-02],
         [ 5.9759e-02,  5.0712e-02],
         [ 5.9768e-02,  4.9446e-02],
         [ 5.9770e-02,  5.2009e-02],
         [ 5.9765e-02,  5.6825e-02],
         [ 5.9768e-02,  5.6686e-02],
         [ 5.9761e-02,  5.5837e-02],
         [ 5.9760e-02,  5.5231e-02],
         [ 5.9761e-02,  5.4913e-02],
         [ 5.9761e-02,  6.6218e-02],
         [ 5.9761e-02,  5.7890e-02],
         [ 5.9761e-02,  5.4906e-02],
         [ 5.9761e-02,  6.5749e-02],
         [ 5.9762e-02,  5.3822e-02],
         [ 5.9760e-02,  5.3155e-02],
         [ 5.9760e-02,  6.3506e-02],
         [ 5.9762e-02,  5.2000e-02],
         [ 5.9762e-02,  5.6954e-02],
         [ 5.9762e-02,  7.3863e-02],
         [ 5.9762e-02,  6.6229e-02],
         [ 5.9762e-02,  7.2400e-02],
         [ 5.9762e-02,  8.0270e-02],
         [ 5.9762e-02,  6.4447e-02],
         [ 5.9762e-02,  5.7646e-02],
         [ 5.9762e-02,  7.1086e-02],
         [ 5.9762e-02,  5.7221e-02],
         [ 5.9762e-02,  7.6857e-02],
         [ 5.9762e-02,  8.6358e-02],
         [ 5.9762e-02,  5.6203e-02],
         [ 5.9762e-02,  5.5026e-02],
         [ 5.9762e-02,  7.6065e-02],
         [ 5.9762e-02,  8.6319e-02],
         [ 5.9762e-02,  8.4755e-02],
         [ 5.9762e-02,  5.5924e-02],
         [ 5.9762e-02,  4.6062e-02],
         [ 5.9762e-02,  6.9693e-02],
         [ 5.9762e-02,  6.9879e-02],
         [ 5.9762e-02,  7.0787e-02],
         [ 5.9762e-02,  6.5338e-02],
         [ 5.9762e-02,  6.5887e-02],
         [ 5.9762e-02,  4.1573e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.6046e-05, device='cuda:0') tensor(0.0019, device='cuda:0') tensor(-0.0024, device='cuda:0')
mixer_td_error tensor(0.4135, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2946, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.0996, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0790, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1979, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0079, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1914893.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2012, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(2.6920e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0021, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0583, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.1401, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0583, device='cuda:0', grad_fn=<MinBackward1>)
t_env 19084
target_mac_out tensor([[[[-1.0000e+07,  7.5429e-02,  1.0966e-01,  ...,  9.0145e-02,
            6.3491e-02, -1.0000e+07],
          [-1.0000e+07,  6.0793e-02,  8.6950e-02,  ...,  5.4351e-02,
            6.0815e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.3920e-02,  1.2532e-01,  ...,  9.0439e-02,
            6.4354e-02, -1.0000e+07],
          [-1.0000e+07,  7.0690e-02,  8.9083e-02,  ...,  4.9668e-02,
            5.7834e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.1060e-01,  1.3049e-01,  ...,  1.1007e-01,
            7.3690e-02, -1.0000e+07],
          [-1.0000e+07,  9.6535e-02,  1.1342e-01,  ...,  8.2428e-02,
            7.5198e-02, -1.0000e+07]],

         ...,

         [[ 5.9804e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  3.0463e-02,  4.1670e-02,  ...,  3.0748e-02,
            8.9002e-03, -7.9067e-03]],

         [[ 5.9763e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  2.9562e-02,  3.3691e-02,  ...,  1.8556e-02,
           -3.0510e-03, -1.3430e-02]],

         [[ 5.9769e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 5.1098e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.0608e-02,  1.0466e-01,  ...,  8.6790e-02,
            6.1806e-02, -1.0000e+07],
          [-1.0000e+07,  7.0382e-02,  7.6961e-02,  ...,  6.6786e-02,
            6.4623e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.1968e-02,  1.3374e-01,  ...,  9.6902e-02,
            7.3120e-02, -1.0000e+07],
          [-1.0000e+07,  7.3143e-02,  8.5016e-02,  ...,  5.7140e-02,
            5.4633e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.1377e-01,  1.5348e-01,  ...,  1.1732e-01,
            9.2824e-02, -1.0000e+07],
          [-1.0000e+07,  9.3944e-02,  1.0648e-01,  ...,  7.6499e-02,
            6.9067e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.0966e-01,  8.6950e-02],
         [ 1.2532e-01,  8.9083e-02],
         [ 1.3049e-01,  1.1342e-01],
         [ 1.4836e-01,  8.2064e-02],
         [ 1.5782e-01,  8.1807e-02],
         [ 1.2658e-01,  9.9620e-02],
         [ 1.4531e-01,  8.2206e-02],
         [ 1.4659e-01,  9.5916e-02],
         [ 1.3198e-01,  1.0999e-01],
         [ 1.2104e-01,  1.1948e-01],
         [ 1.1492e-01,  1.1740e-01],
         [ 1.2413e-01,  1.1590e-01],
         [ 1.4347e-01,  1.1616e-01],
         [ 1.1529e-01,  1.0107e-01],
         [ 1.0754e-01,  8.8903e-02],
         [ 1.3144e-01,  1.0966e-01],
         [ 1.3742e-01,  1.0001e-01],
         [ 1.4397e-01,  9.5627e-02],
         [ 1.3788e-01,  8.9516e-02],
         [ 1.1399e-01,  9.9983e-02],
         [ 1.1786e-01,  9.0545e-02],
         [ 1.2285e-01,  9.3088e-02],
         [ 1.1554e-01,  8.8543e-02],
         [ 1.1769e-01,  9.7818e-02],
         [ 1.1772e-01,  8.4539e-02],
         [ 1.2931e-01,  1.0793e-01],
         [ 1.5165e-01,  1.1749e-01],
         [ 1.4351e-01,  1.1447e-01],
         [ 1.2810e-01,  1.1990e-01],
         [ 1.0809e-01,  1.2451e-01],
         [ 1.6064e-01,  1.2406e-01],
         [ 1.7460e-01,  1.1352e-01],
         [ 1.8638e-01,  1.2807e-01],
         [ 1.8332e-01,  1.1791e-01],
         [ 1.4729e-01,  1.2695e-01],
         [ 1.4174e-01,  9.3688e-02],
         [ 1.7021e-01,  9.4699e-02],
         [ 1.6037e-01,  1.0180e-01],
         [ 1.9198e-01,  1.1212e-01],
         [ 1.8869e-01,  1.2775e-01],
         [ 1.8340e-01,  1.4426e-01],
         [ 1.7779e-01,  1.0581e-01],
         [ 1.9567e-01,  1.2110e-01],
         [ 1.6655e-01,  1.1665e-01],
         [ 1.9459e-01,  1.0222e-01],
         [ 2.1510e-01,  1.1756e-01],
         [ 2.0770e-01,  1.0711e-01],
         [ 2.0843e-01,  1.1560e-01],
         [ 1.8132e-01,  1.0662e-01],
         [ 1.7421e-01,  1.2083e-01],
         [ 1.3228e-01,  1.0418e-01],
         [ 1.4415e-01,  1.0203e-01],
         [ 1.5090e-01,  9.2160e-02],
         [ 1.5920e-01,  1.0035e-01],
         [ 1.9562e-01,  9.9405e-02],
         [ 2.1311e-02,  7.4587e-02],
         [ 3.9727e-02,  7.4705e-02],
         [ 5.1008e-02,  8.0715e-02],
         [ 5.6681e-02,  6.5933e-02],
         [ 5.9173e-02,  8.7536e-02],
         [ 6.0045e-02,  9.3555e-02],
         [ 6.0230e-02,  7.4352e-02],
         [ 6.0189e-02,  8.7814e-02],
         [ 6.0062e-02,  9.0116e-02],
         [ 5.9951e-02,  8.9134e-02],
         [ 5.9893e-02,  6.5967e-02],
         [ 5.9843e-02,  4.0521e-02],
         [ 5.9820e-02,  6.6200e-02],
         [ 5.9804e-02,  3.0748e-02],
         [ 5.9763e-02,  3.3691e-02],
         [ 5.9769e-02,  5.1098e-02]],

        [[ 1.0466e-01,  7.6961e-02],
         [ 1.3374e-01,  8.5016e-02],
         [ 1.5348e-01,  1.0648e-01],
         [ 1.3974e-01,  1.2554e-01],
         [ 1.3372e-01,  1.1297e-01],
         [ 1.4421e-01,  1.2419e-01],
         [ 1.3150e-01,  9.9839e-02],
         [ 1.1179e-01,  1.0494e-01],
         [ 1.3297e-01,  9.7084e-02],
         [ 1.3344e-01,  9.1843e-02],
         [ 1.3339e-01,  1.0776e-01],
         [ 1.3485e-01,  1.1446e-01],
         [ 1.6628e-01,  1.3505e-01],
         [ 1.5761e-01,  1.0158e-01],
         [ 1.6090e-01,  9.6456e-02],
         [ 1.3287e-01,  1.0422e-01],
         [ 1.5944e-01,  1.1924e-01],
         [ 1.5969e-01,  1.1624e-01],
         [ 1.6144e-01,  1.0287e-01],
         [ 1.7617e-01,  1.1805e-01],
         [ 1.7008e-01,  1.0135e-01],
         [ 1.7298e-01,  1.4056e-01],
         [ 2.0378e-01,  1.2359e-01],
         [ 1.9555e-01,  1.3536e-01],
         [ 1.6868e-01,  1.3955e-01],
         [ 1.6163e-01,  1.4704e-01],
         [ 1.5208e-01,  1.2886e-01],
         [ 1.5994e-01,  9.9532e-02],
         [ 1.5119e-01,  1.1217e-01],
         [ 1.5650e-01,  1.0130e-01],
         [ 1.6330e-01,  8.7958e-02],
         [ 1.7159e-01,  8.0508e-02],
         [ 1.6627e-01,  7.9548e-02],
         [ 1.7925e-01,  9.3138e-02],
         [-9.3449e-04,  6.4526e-02],
         [ 3.0419e-02,  5.5734e-02],
         [ 4.6654e-02,  6.8483e-02],
         [ 5.4517e-02,  5.5737e-02],
         [ 5.8086e-02,  6.6708e-02],
         [ 5.9562e-02,  8.2192e-02],
         [ 6.0026e-02,  8.9124e-02],
         [ 6.0124e-02,  9.2849e-02],
         [ 6.0075e-02,  5.7299e-02],
         [ 5.9987e-02,  6.0689e-02],
         [ 5.9919e-02,  8.8403e-02],
         [ 5.9878e-02,  7.0857e-02],
         [ 5.9810e-02,  6.1240e-02],
         [ 5.9785e-02,  7.2051e-02],
         [ 5.9772e-02,  7.3123e-02],
         [ 5.9761e-02,  6.5987e-02],
         [ 5.9762e-02,  6.3731e-02],
         [ 5.9757e-02,  8.0008e-02],
         [ 5.9769e-02,  5.6020e-02],
         [ 5.9771e-02,  6.6171e-02],
         [ 5.9766e-02,  7.4787e-02],
         [ 5.9768e-02,  5.9275e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(1.0393e-05, device='cuda:0') tensor(0.0012, device='cuda:0') tensor(-0.0023, device='cuda:0')
mixer_td_error tensor(0.2419, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2340, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8437, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.1009, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1991, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0052, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1056337.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2151, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.8370e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0019, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0950, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1582, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0950, device='cuda:0', grad_fn=<MinBackward1>)
t_env 19131
target_mac_out tensor([[[[-1.0000e+07,  6.8614e-02,  1.4453e-01,  ...,  1.0239e-01,
            9.3480e-02, -1.0000e+07],
          [-1.0000e+07,  7.2765e-02,  1.1170e-01,  ...,  7.5849e-02,
            7.6792e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.2321e-02,  1.4719e-01,  ...,  1.0378e-01,
            8.9944e-02, -1.0000e+07],
          [-1.0000e+07,  8.2178e-02,  1.0724e-01,  ...,  6.1760e-02,
            6.8338e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.0886e-02,  1.4552e-01,  ...,  1.0257e-01,
            8.9491e-02, -1.0000e+07],
          [-1.0000e+07,  8.2699e-02,  8.4433e-02,  ...,  6.6235e-02,
            6.5041e-02, -1.0000e+07]],

         ...,

         [[ 6.0019e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  4.5217e-02,  4.8703e-02,  ...,  5.0380e-02,
            2.1267e-02, -1.0000e+07]],

         [[ 6.0002e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  3.4038e-02,  5.5296e-02,  ...,  4.3861e-02,
            2.6678e-02, -1.0000e+07]],

         [[ 5.9917e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 6.9015e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.1569e-02,  1.5447e-01,  ...,  1.1826e-01,
            1.0167e-01, -1.0000e+07],
          [-1.0000e+07,  7.1219e-02,  1.0302e-01,  ...,  6.0147e-02,
            6.5716e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.6949e-02,  1.4438e-01,  ...,  1.0201e-01,
            8.6084e-02, -1.0000e+07],
          [-1.0000e+07,  7.5589e-02,  1.0760e-01,  ...,  5.8299e-02,
            6.4039e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0259e-01,  1.2460e-01,  ...,  1.0491e-01,
            7.2946e-02, -1.0000e+07],
          [-1.0000e+07,  1.0442e-01,  1.2728e-01,  ...,  8.3647e-02,
            7.5032e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  5.8093e-02,  1.2329e-01,  ...,  7.9362e-02,
            6.2451e-02,  6.8821e-02],
          [ 8.6624e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  4.6383e-02,  9.2960e-02,  ...,  7.6827e-02,
            4.5202e-02,  5.3232e-02],
          [ 8.6622e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.7695e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6623e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[0.1445, 0.1117],
         [0.1472, 0.1072],
         [0.1455, 0.0844],
         [0.1519, 0.0908],
         [0.1485, 0.0910],
         [0.1554, 0.1119],
         [0.1714, 0.1187],
         [0.1543, 0.1215],
         [0.1536, 0.1191],
         [0.1615, 0.0980],
         [0.1640, 0.0916],
         [0.1482, 0.0857],
         [0.1506, 0.1006],
         [0.1682, 0.1258],
         [0.1535, 0.1226],
         [0.1408, 0.1265],
         [0.1523, 0.1217],
         [0.1429, 0.1291],
         [0.1208, 0.1190],
         [0.1469, 0.1169],
         [0.1616, 0.0820],
         [0.1608, 0.1295],
         [0.1583, 0.1132],
         [0.1529, 0.0962],
         [0.1490, 0.0941],
         [0.1454, 0.1282],
         [0.1452, 0.1465],
         [0.1428, 0.1150],
         [0.1339, 0.1134],
         [0.1560, 0.1194],
         [0.1631, 0.1049],
         [0.1519, 0.1252],
         [0.1712, 0.1318],
         [0.1575, 0.1217],
         [0.1715, 0.1210],
         [0.1484, 0.1084],
         [0.1601, 0.1058],
         [0.1664, 0.1190],
         [0.1858, 0.1278],
         [0.1858, 0.1166],
         [0.1618, 0.1101],
         [0.1741, 0.1055],
         [0.1415, 0.1026],
         [0.1327, 0.0992],
         [0.1468, 0.1063],
         [0.1538, 0.0763],
         [0.1569, 0.0983],
         [0.0283, 0.0655],
         [0.0456, 0.0582],
         [0.0544, 0.0756],
         [0.0582, 0.0789],
         [0.0596, 0.0602],
         [0.0600, 0.0504],
         [0.0600, 0.0553],
         [0.0599, 0.0690]],

        [[0.1545, 0.1030],
         [0.1444, 0.1076],
         [0.1246, 0.1273],
         [0.1545, 0.1163],
         [0.1266, 0.1077],
         [0.1393, 0.0983],
         [0.0970, 0.0626],
         [0.0965, 0.0802],
         [0.0961, 0.0575],
         [0.1100, 0.0484],
         [0.1175, 0.0425],
         [0.1021, 0.0665],
         [0.1074, 0.0725],
         [0.1150, 0.0781],
         [0.1078, 0.0711],
         [0.0989, 0.0542],
         [0.1023, 0.0737],
         [0.0956, 0.0623],
         [0.1000, 0.0717],
         [0.0936, 0.0654],
         [0.0881, 0.0743],
         [0.1045, 0.0791],
         [0.1160, 0.0434],
         [0.1098, 0.0516],
         [0.1007, 0.0321],
         [0.1109, 0.0394],
         [0.1171, 0.0242],
         [0.1010, 0.0055],
         [0.1073, 0.0106],
         [0.1120, 0.0164],
         [0.1038, 0.0198],
         [0.1192, 0.0561],
         [0.1166, 0.0738],
         [0.1116, 0.0819],
         [0.1241, 0.0853],
         [0.1301, 0.0865],
         [0.1372, 0.0869],
         [0.1082, 0.0869],
         [0.1333, 0.0868],
         [0.1498, 0.0867],
         [0.1277, 0.0867],
         [0.1308, 0.0867],
         [0.1501, 0.0866],
         [0.1569, 0.0866],
         [0.1303, 0.0866],
         [0.1049, 0.0866],
         [0.1030, 0.0866],
         [0.1162, 0.0866],
         [0.0982, 0.0866],
         [0.1198, 0.0866],
         [0.1207, 0.0866],
         [0.0990, 0.0866],
         [0.1233, 0.0866],
         [0.0930, 0.0866],
         [0.0277, 0.0866]]], device='cuda:0', grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-5.6477e-05, device='cuda:0') tensor(0.0010, device='cuda:0') tensor(-0.0016, device='cuda:0')
mixer_td_error tensor(-0.0160, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2531, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.4086, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.1052, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1734, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0165, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(0.1077, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1858, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0055, device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.4670e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0006, device='cuda:0', grad_fn=<MaxBackward1>) tensor(2.4431e-09, device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(0.0922, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0889, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0922, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0889, device='cuda:0', grad_fn=<MinBackward1>)
t_env 19180
target_mac_out tensor([[[[-1.0000e+07,  7.3359e-02,  1.3533e-01,  ...,  8.9806e-02,
            7.4978e-02, -1.0000e+07],
          [-1.0000e+07,  5.9472e-02,  9.0317e-02,  ...,  5.6118e-02,
            5.9829e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.8773e-02,  1.3543e-01,  ...,  8.9781e-02,
            7.2685e-02, -1.0000e+07],
          [-1.0000e+07,  9.3484e-02,  1.2302e-01,  ...,  8.8256e-02,
            7.4036e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0169e-01,  1.4812e-01,  ...,  1.0052e-01,
            7.8107e-02, -1.0000e+07],
          [-1.0000e+07,  1.0433e-01,  1.2569e-01,  ...,  1.0350e-01,
            8.1503e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.2507e-02,  1.0840e-01,  ...,  8.9047e-02,
            6.2431e-02, -1.0000e+07],
          [-1.0000e+07,  7.2838e-02,  1.0694e-01,  ...,  7.3659e-02,
            7.6162e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0469e-01,  1.4562e-01,  ...,  1.1274e-01,
            8.5181e-02, -1.0000e+07],
          [-1.0000e+07,  7.3973e-02,  1.0063e-01,  ...,  5.9597e-02,
            6.6197e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.1453e-01,  1.7477e-01,  ...,  1.4560e-01,
            1.1732e-01, -1.0000e+07],
          [-1.0000e+07,  9.9970e-02,  1.2994e-01,  ...,  8.9815e-02,
            7.7551e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  7.7003e-02,  1.0927e-01,  ...,  7.2383e-02,
            3.7305e-02,  7.5617e-02],
          [ 8.6583e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  7.7897e-02,  1.1367e-01,  ...,  6.8494e-02,
            3.7516e-02,  7.8047e-02],
          [ 8.6706e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 2.0386e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6664e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.3533e-01,  9.0317e-02],
         [ 1.3543e-01,  1.2302e-01],
         [ 1.4812e-01,  1.2569e-01],
         [ 1.3673e-01,  1.3058e-01],
         [ 1.8152e-01,  1.3219e-01],
         [ 1.9648e-01,  1.3130e-01],
         [ 1.5477e-01,  1.0411e-01],
         [ 1.4098e-01,  8.3021e-02],
         [ 1.2268e-01,  1.2518e-01],
         [ 1.5171e-01,  1.3127e-01],
         [ 1.6292e-01,  1.1772e-01],
         [ 1.7694e-01,  1.3010e-01],
         [ 1.9362e-01,  1.3617e-01],
         [ 2.0187e-01,  1.2463e-01],
         [ 1.9136e-01,  1.1307e-01],
         [ 1.7793e-01,  9.2488e-02],
         [ 1.6857e-01,  1.3128e-01],
         [ 1.4008e-01,  1.3615e-01],
         [ 1.3785e-01,  1.2638e-01],
         [ 1.4132e-01,  7.2751e-02],
         [ 1.5384e-01,  1.0934e-01],
         [ 1.4645e-01,  6.7017e-02],
         [ 1.8862e-01,  7.7634e-02],
         [ 1.9251e-01,  1.0984e-01],
         [ 1.6609e-01,  1.1378e-01],
         [ 1.9180e-01,  1.1258e-01],
         [ 1.5503e-01,  3.0038e-02],
         [ 1.1174e-01,  5.7872e-02],
         [ 1.2626e-01,  7.3385e-02],
         [ 1.3748e-01,  8.1127e-02],
         [ 1.1410e-01,  8.4672e-02],
         [ 1.4220e-01,  8.6203e-02],
         [ 1.5437e-01,  8.6731e-02],
         [ 1.5722e-01,  8.6845e-02],
         [ 1.5573e-01,  8.6821e-02],
         [ 1.6090e-01,  8.6772e-02],
         [ 1.6266e-01,  8.6735e-02],
         [ 1.6219e-01,  8.6711e-02],
         [ 1.4754e-01,  8.6656e-02],
         [ 1.1197e-01,  8.6658e-02],
         [ 1.2034e-01,  8.6641e-02],
         [ 1.4360e-01,  8.6631e-02],
         [ 1.3589e-01,  8.6625e-02],
         [ 1.0059e-01,  8.6643e-02],
         [ 1.2294e-01,  8.6625e-02],
         [ 2.4320e-02,  8.6626e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0840e-01,  1.0694e-01],
         [ 1.4562e-01,  1.0063e-01],
         [ 1.7477e-01,  1.2994e-01],
         [ 1.8361e-01,  1.3083e-01],
         [ 1.3792e-01,  1.0768e-01],
         [ 1.8083e-01,  1.2966e-01],
         [ 1.7876e-01,  1.0422e-01],
         [ 1.4123e-01,  1.0314e-01],
         [ 1.3098e-01,  1.0279e-01],
         [ 1.2838e-01,  1.0085e-01],
         [ 1.2789e-01,  1.1862e-01],
         [ 1.3743e-01,  1.0925e-01],
         [ 1.2282e-01,  1.2470e-01],
         [ 1.2106e-01,  1.3163e-01],
         [ 1.2084e-01,  1.1146e-01],
         [ 1.2433e-01,  1.0386e-01],
         [ 1.2868e-01,  1.1544e-01],
         [ 1.3178e-01,  1.3708e-01],
         [ 1.2720e-01,  1.3708e-01],
         [ 1.3055e-01,  1.4647e-01],
         [ 1.2100e-01,  1.1171e-01],
         [ 1.1536e-01,  1.0416e-01],
         [ 1.1113e-01,  9.7238e-02],
         [ 1.1689e-01,  1.0665e-01],
         [ 1.1462e-01,  1.1847e-01],
         [ 1.1502e-01,  1.1622e-01],
         [ 1.1520e-01,  1.0289e-01],
         [ 1.1500e-01,  1.0146e-01],
         [ 9.1919e-02,  7.8886e-02],
         [ 8.2211e-02,  7.0291e-02],
         [ 8.1506e-02,  6.4219e-02],
         [ 9.5945e-02,  7.8191e-02],
         [ 1.0919e-01,  1.0294e-01],
         [ 1.0192e-01,  7.3685e-02],
         [ 9.7260e-02,  6.8938e-02],
         [ 9.4394e-02,  6.8581e-02],
         [ 1.0385e-01,  8.9962e-02],
         [ 1.0689e-01,  1.1377e-01],
         [ 1.0821e-01,  1.1978e-01],
         [ 1.1019e-01,  1.1933e-01],
         [ 1.1166e-01,  1.0208e-01],
         [ 1.1647e-01,  1.1532e-01],
         [ 1.1157e-01,  8.9622e-02],
         [ 1.1151e-01,  1.0267e-01],
         [ 1.1759e-01,  1.0703e-01],
         [ 1.0954e-01,  1.0365e-01],
         [ 1.1790e-01,  1.1204e-01],
         [ 1.1150e-01,  1.2257e-01],
         [ 1.2352e-01,  1.0318e-01],
         [ 1.0146e-01,  7.0247e-02],
         [ 1.0877e-01,  1.1233e-01],
         [ 1.1437e-01,  1.1911e-01],
         [ 1.1469e-01,  1.1307e-01],
         [ 1.2690e-01,  1.2639e-01],
         [ 1.3286e-01,  1.2611e-01],
         [ 1.0590e-01,  7.9825e-02],
         [ 7.2005e-02,  7.8151e-02],
         [ 9.6935e-02,  7.1763e-02],
         [ 1.0884e-01,  7.9465e-02],
         [ 1.2536e-01,  1.1858e-01],
         [ 1.2821e-01,  1.2333e-01],
         [ 1.2398e-01,  1.2061e-01],
         [ 1.2324e-01,  1.1669e-01],
         [ 1.1712e-01,  9.1852e-02],
         [ 1.1843e-01,  7.2008e-02],
         [ 1.0270e-01,  6.2830e-02],
         [ 9.4970e-02,  5.6627e-02],
         [ 7.3448e-02,  6.4123e-02],
         [ 1.1175e-01,  7.8718e-02],
         [ 1.2769e-01,  1.1893e-01],
         [ 1.2451e-01,  1.2070e-01],
         [ 1.2780e-01,  1.0465e-01],
         [ 1.2663e-01,  1.1100e-01],
         [ 1.1798e-01,  8.4244e-02],
         [ 1.2316e-01,  9.5164e-02],
         [ 1.2656e-01,  1.0565e-01],
         [ 1.2680e-01,  1.2062e-01],
         [ 1.1900e-01,  1.0222e-01],
         [ 1.2859e-01,  1.1105e-01],
         [ 1.2354e-01,  1.2365e-01],
         [ 1.1749e-01,  1.1403e-01],
         [ 1.4493e-01,  1.2883e-01],
         [ 1.4806e-01,  1.1149e-01],
         [ 1.6193e-01,  1.1688e-01],
         [ 1.6772e-01,  1.3455e-01],
         [ 1.3063e-01,  1.2343e-01],
         [ 1.5717e-01,  1.1884e-01],
         [ 1.7784e-01,  1.1441e-01],
         [ 1.7645e-01,  1.1395e-01],
         [ 1.3310e-01,  4.1948e-02],
         [ 9.3408e-02,  8.1078e-02],
         [ 7.3128e-02,  6.8609e-02],
         [ 8.1752e-02,  6.7949e-02],
         [ 8.4932e-02,  6.5298e-02],
         [ 9.3075e-02,  5.9637e-02],
         [ 1.0813e-01,  8.1233e-02],
         [ 9.9234e-02,  9.0347e-02],
         [ 6.6897e-02,  1.0205e-01],
         [ 7.6157e-02,  1.0343e-01],
         [ 8.2975e-02,  8.7402e-02],
         [ 8.1871e-02,  2.9072e-02],
         [ 1.0006e-01,  4.5264e-02],
         [ 1.1198e-01,  5.2360e-02],
         [ 1.1813e-01,  6.1143e-02],
         [ 8.0953e-02,  8.0369e-02],
         [ 1.2743e-01,  1.2235e-01],
         [ 1.2661e-01,  1.4447e-01],
         [ 1.2084e-01,  1.1579e-01],
         [ 1.4751e-01,  9.8489e-02],
         [ 1.3483e-01,  1.2211e-01],
         [ 1.3428e-01,  1.4459e-01],
         [ 1.5506e-01,  1.1476e-01],
         [ 1.1581e-01,  1.1959e-01],
         [ 1.6267e-01,  1.3559e-01],
         [ 1.2178e-01,  1.3110e-01],
         [ 1.5144e-01,  1.0724e-01],
         [ 1.3596e-01,  1.0862e-01],
         [ 1.3360e-01,  1.0833e-01],
         [ 1.5500e-01,  7.7986e-02],
         [ 1.7031e-01,  1.0384e-01],
         [ 1.6284e-01,  1.1645e-01],
         [ 1.4302e-01,  5.0978e-02],
         [ 1.1845e-01,  6.9557e-02],
         [ 1.2355e-01,  7.9593e-02],
         [ 1.1828e-01,  8.4192e-02],
         [ 7.5823e-02,  8.6020e-02],
         [ 1.0927e-01,  8.6583e-02],
         [ 1.1367e-01,  8.6706e-02],
         [ 2.0386e-02,  8.6664e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(3.6014e-06, device='cuda:0') tensor(0.0012, device='cuda:0') tensor(-0.0018, device='cuda:0')
mixer_td_error tensor(0.7215, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2651, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8336, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0901, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2121, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0150, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-3217053.7500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2019, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(1.9498e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0015, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0934, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0864, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0934, device='cuda:0', grad_fn=<MinBackward1>)
t_env 19226
target_mac_out tensor([[[[-1.0000e+07,  6.7981e-02,  1.4147e-01,  ...,  1.0255e-01,
            9.2708e-02, -1.0000e+07],
          [-1.0000e+07,  7.1672e-02,  8.2355e-02,  ...,  6.9628e-02,
            6.5286e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.7925e-02,  1.5479e-01,  ...,  1.1701e-01,
            1.0737e-01, -1.0000e+07],
          [-1.0000e+07,  7.6450e-02,  9.5556e-02,  ...,  6.1710e-02,
            5.7455e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0720e-01,  1.7334e-01,  ...,  1.4677e-01,
            1.2633e-01, -1.0000e+07],
          [-1.0000e+07,  9.6929e-02,  1.1440e-01,  ...,  8.0521e-02,
            7.2852e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.5429e-02,  1.0966e-01,  ...,  9.0145e-02,
            6.3491e-02, -1.0000e+07],
          [-1.0000e+07,  6.0793e-02,  8.6950e-02,  ...,  5.4351e-02,
            6.0815e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.1332e-02,  1.2443e-01,  ...,  8.9360e-02,
            6.3589e-02, -1.0000e+07],
          [-1.0000e+07,  8.2802e-02,  1.0910e-01,  ...,  6.8748e-02,
            7.3103e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0833e-01,  1.2826e-01,  ...,  1.0985e-01,
            7.2953e-02, -1.0000e+07],
          [-1.0000e+07,  9.0298e-02,  1.1011e-01,  ...,  7.0845e-02,
            7.9242e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  1.1932e-01,  1.1331e-01,  ...,  8.2197e-02,
           -1.0000e+07, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  1.3196e-01,  1.3269e-01,  ...,  1.0634e-01,
           -1.0000e+07, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  9.9008e-02,  1.2519e-01,  ...,  1.0664e-01,
            7.7713e-02, -1.0000e+07],
          [ 8.6621e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.4147e-01,  8.2355e-02],
         [ 1.5479e-01,  9.5556e-02],
         [ 1.7334e-01,  1.1440e-01],
         ...,
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.0966e-01,  8.6950e-02],
         [ 1.2443e-01,  1.0910e-01],
         [ 1.2826e-01,  1.1011e-01],
         ...,
         [ 1.1932e-01,  8.6621e-02],
         [ 1.3269e-01,  8.6621e-02],
         [ 1.2519e-01,  8.6621e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.7816e-08, device='cuda:0') tensor(0.0004, device='cuda:0') tensor(-0.0010, device='cuda:0')
mixer_td_error tensor(0.9402, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2335, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.0009, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0770, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2034, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0041, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-4216666.5000, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2015, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(3.8731e-06, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0010, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0937, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         ...,
         [1., 0.],
         [1., 0.],
         [1., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1039, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0937, device='cuda:0', grad_fn=<MinBackward1>)
t_env 19271
target_mac_out tensor([[[[-1.0000e+07,  6.9143e-02,  1.3413e-01,  ...,  8.9326e-02,
            7.4741e-02, -1.0000e+07],
          [-1.0000e+07,  7.0448e-02,  1.0907e-01,  ...,  7.5776e-02,
            7.4083e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.5132e-02,  1.5134e-01,  ...,  1.0964e-01,
            9.9393e-02, -1.0000e+07],
          [-1.0000e+07,  8.1021e-02,  8.9095e-02,  ...,  7.3884e-02,
            6.7763e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.7162e-02,  1.5399e-01,  ...,  1.1912e-01,
            1.0913e-01, -1.0000e+07],
          [-1.0000e+07,  8.7212e-02,  8.6023e-02,  ...,  8.6053e-02,
            6.8017e-02, -1.0000e+07]],

         ...,

         [[ 5.0510e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  2.2489e-02,  1.9935e-02,  ...,  7.2336e-03,
           -1.3167e-02, -1.5506e-02]],

         [[ 5.5835e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  4.1225e-02,  4.4206e-02,  ...,  1.9022e-02,
            4.4471e-03,  1.3539e-03]],

         [[ 5.8492e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.3353e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.0608e-02,  1.0466e-01,  ...,  8.6790e-02,
            6.1806e-02, -1.0000e+07],
          [-1.0000e+07,  7.0382e-02,  7.6961e-02,  ...,  6.6786e-02,
            6.4623e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.9322e-02,  1.4167e-01,  ...,  1.0946e-01,
            9.1246e-02, -1.0000e+07],
          [-1.0000e+07,  7.4978e-02,  8.7598e-02,  ...,  5.7695e-02,
            5.6190e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.7860e-02,  1.3302e-01,  ...,  9.7251e-02,
            7.8819e-02, -1.0000e+07],
          [-1.0000e+07,  8.9522e-02,  1.1184e-01,  ...,  7.2102e-02,
            7.0785e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.3413e-01,  1.0907e-01],
         [ 1.5134e-01,  8.9095e-02],
         [ 1.5399e-01,  8.7212e-02],
         [ 1.5310e-01,  1.0428e-01],
         [ 7.2262e-02,  1.0571e-01],
         [ 1.1788e-01,  9.6741e-02],
         [ 1.3060e-01,  9.2266e-02],
         [ 1.4009e-01,  8.7482e-02],
         [ 1.4761e-01,  1.0341e-01],
         [ 1.2943e-01,  9.5102e-02],
         [ 1.1745e-01,  9.4695e-02],
         [ 1.3890e-01,  9.4305e-02],
         [ 1.4525e-01,  9.0630e-02],
         [ 1.4560e-01,  8.8800e-02],
         [ 1.4982e-01,  9.7597e-02],
         [ 1.5200e-01,  9.3419e-02],
         [ 1.5284e-01,  1.0291e-01],
         [ 1.3041e-01,  9.8366e-02],
         [ 1.1904e-01,  6.5048e-02],
         [ 1.0616e-01,  3.1781e-02],
         [ 1.1308e-01,  8.7164e-02],
         [ 5.4593e-02,  1.0692e-01],
         [ 1.3327e-01,  1.2051e-01],
         [ 1.1051e-01,  1.2098e-01],
         [ 1.1820e-01,  1.1575e-01],
         [ 1.4162e-01,  9.3632e-02],
         [ 1.3884e-01,  9.0638e-02],
         [ 1.4213e-01,  9.4294e-02],
         [ 1.4941e-01,  9.4551e-02],
         [ 1.5323e-01,  8.8943e-02],
         [ 1.4980e-01,  9.6959e-02],
         [ 1.4226e-01,  1.0225e-01],
         [ 1.6240e-01,  1.0204e-01],
         [ 1.4904e-01,  9.3152e-02],
         [ 1.5047e-01,  1.0607e-01],
         [ 1.6410e-01,  1.0862e-01],
         [ 1.5887e-01,  1.0793e-01],
         [ 1.8307e-01,  9.7675e-02],
         [ 1.9495e-01,  8.2249e-02],
         [ 1.7620e-01,  8.0841e-02],
         [ 1.5906e-01,  8.1901e-02],
         [ 1.5189e-01,  9.8825e-02],
         [ 1.5248e-01,  9.8193e-02],
         [ 1.7111e-01,  9.8667e-02],
         [ 1.7398e-01,  8.1096e-02],
         [ 1.5215e-01,  9.8693e-02],
         [ 1.6567e-01,  8.6060e-02],
         [ 1.5651e-01,  1.0514e-01],
         [ 1.7186e-01,  1.0672e-01],
         [ 1.9110e-01,  1.0773e-01],
         [ 1.4721e-01,  6.6723e-02],
         [ 1.6960e-01,  7.6586e-02],
         [ 1.4333e-01,  7.1041e-02],
         [ 1.5932e-01,  9.3737e-02],
         [ 1.6953e-01,  1.0844e-01],
         [ 1.5635e-01,  1.1837e-01],
         [ 1.5782e-01,  1.1968e-01],
         [ 1.6789e-01,  1.3607e-01],
         [ 1.4186e-01,  1.3786e-01],
         [ 1.6956e-01,  1.3324e-01],
         [ 1.6122e-01,  1.2322e-01],
         [ 1.5895e-01,  1.3280e-01],
         [ 1.6209e-01,  1.2784e-01],
         [ 1.7216e-01,  1.3262e-01],
         [ 1.7749e-01,  1.1028e-01],
         [ 1.6791e-01,  1.0582e-01],
         [ 1.6427e-01,  1.2665e-01],
         [ 1.7430e-01,  1.3373e-01],
         [ 1.3918e-01,  1.0124e-01],
         [ 1.7575e-01,  8.7761e-02],
         [ 1.9673e-01,  1.2147e-01],
         [ 1.9470e-01,  1.1174e-01],
         [ 1.9104e-01,  1.3270e-01],
         [ 1.8680e-01,  1.3667e-01],
         [ 9.1043e-02,  1.2593e-01],
         [ 7.3885e-02,  1.1678e-01],
         [ 6.3880e-02,  5.8886e-02],
         [ 7.3717e-02,  5.6968e-02],
         [ 9.5450e-02,  6.3463e-02],
         [ 1.3367e-01,  6.1992e-02],
         [ 1.3961e-01,  1.0360e-01],
         [ 7.0296e-02,  8.7657e-02],
         [ 5.6681e-02,  9.9071e-02],
         [ 5.1099e-02,  9.6169e-02],
         [ 5.9610e-02,  9.5926e-02],
         [ 3.2367e-02,  6.6230e-02],
         [ 4.1685e-02,  3.2775e-02],
         [ 5.0510e-02,  2.2489e-02],
         [ 5.5835e-02,  4.1225e-02],
         [ 5.8492e-02,  4.3353e-02]],

        [[ 1.0466e-01,  7.6961e-02],
         [ 1.4167e-01,  8.7598e-02],
         [ 1.3302e-01,  1.1184e-01],
         [ 1.5089e-01,  1.1529e-01],
         [ 1.5602e-01,  1.3253e-01],
         [ 1.6699e-01,  1.3690e-01],
         [ 1.5809e-01,  1.3486e-01],
         [ 1.7830e-01,  1.5096e-01],
         [ 1.4110e-01,  1.4732e-01],
         [ 1.4895e-01,  1.1081e-01],
         [ 1.7497e-01,  1.4494e-01],
         [ 1.5077e-01,  9.3892e-02],
         [ 1.2139e-01,  5.9134e-02],
         [ 1.1577e-01,  5.5723e-02],
         [ 1.1813e-01,  5.6066e-02],
         [ 1.1944e-01,  2.4953e-02],
         [ 1.3072e-01,  3.6972e-02],
         [ 1.3138e-01,  4.3757e-02],
         [ 1.1262e-01,  5.6514e-02],
         [ 1.1006e-01,  8.4771e-02],
         [ 8.9399e-02,  8.8814e-02],
         [ 7.9238e-02,  7.1211e-02],
         [ 8.0150e-02,  7.8568e-02],
         [ 7.9259e-02,  8.5132e-02],
         [ 3.1682e-02,  9.2774e-02],
         [ 1.0808e-01,  1.1992e-01],
         [ 1.1866e-01,  9.8313e-02],
         [ 1.1501e-01,  1.4865e-01],
         [ 1.2712e-01,  1.5706e-01],
         [ 1.2442e-01,  1.5224e-01],
         [ 1.3039e-01,  1.1490e-01],
         [ 1.3030e-01,  1.3228e-01],
         [ 1.3308e-01,  1.3426e-01],
         [ 8.0004e-02,  1.1442e-01],
         [ 1.5100e-01,  1.2584e-01],
         [ 1.2233e-01,  8.3663e-02],
         [ 7.2415e-02,  6.4832e-02],
         [ 1.0456e-01,  5.7056e-02],
         [ 4.9651e-05,  5.1253e-02],
         [ 2.9387e-02,  2.4585e-02],
         [ 4.6121e-02,  3.8498e-02],
         [ 5.4593e-02,  2.3086e-02],
         [ 5.8478e-02,  6.0732e-02],
         [ 6.0013e-02,  3.8756e-02],
         [ 6.0459e-02,  4.0146e-02],
         [ 6.0445e-02,  2.8575e-02],
         [ 6.0300e-02,  3.4187e-02],
         [ 6.0144e-02,  5.4007e-02],
         [ 6.0037e-02,  3.0176e-02],
         [ 5.9933e-02,  3.5957e-02],
         [ 5.9866e-02,  5.6988e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-4.7700e-06, device='cuda:0') tensor(0.0013, device='cuda:0') tensor(-0.0022, device='cuda:0')
mixer_td_error tensor(0.4809, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.3157, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.8936, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.1002, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2000, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0041, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2166666.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1967, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(4.3039e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0017, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0882, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.1134, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0882, device='cuda:0', grad_fn=<MinBackward1>)
t_env 19316
target_mac_out tensor([[[[-1.0000e+07,  7.3491e-02,  1.6030e-01,  ...,  1.2384e-01,
            1.0686e-01, -1.0000e+07],
          [-1.0000e+07,  8.7470e-02,  1.2344e-01,  ...,  9.0087e-02,
            7.7106e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.9066e-02,  1.8185e-01,  ...,  1.3673e-01,
            1.1375e-01, -1.0000e+07],
          [-1.0000e+07,  1.0565e-01,  1.2899e-01,  ...,  1.0290e-01,
            7.9622e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0453e-01,  1.9211e-01,  ...,  1.5863e-01,
            1.2912e-01, -1.0000e+07],
          [-1.0000e+07,  1.0279e-01,  1.2918e-01,  ...,  9.2528e-02,
            7.1118e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.4400e-02,  1.5224e-01,  ...,  1.1891e-01,
            1.0222e-01, -1.0000e+07],
          [-1.0000e+07,  7.3168e-02,  8.7196e-02,  ...,  7.1644e-02,
            6.6248e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.7697e-02,  1.7464e-01,  ...,  1.4345e-01,
            1.1924e-01, -1.0000e+07],
          [-1.0000e+07,  9.7288e-02,  1.1504e-01,  ...,  8.6771e-02,
            7.6602e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0349e-01,  1.7249e-01,  ...,  1.5245e-01,
            1.2331e-01, -1.0000e+07],
          [-1.0000e+07,  1.0085e-01,  9.9586e-02,  ...,  8.3899e-02,
            6.9406e-02, -1.0000e+07]],

         ...,

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  5.2027e-02,  6.6275e-02,  ...,  3.4932e-02,
            2.1775e-02,  2.4388e-02]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  4.5509e-02,  3.3966e-02,  ...,  2.6744e-02,
           -5.3403e-03, -1.0000e+07]],

         [[ 5.9762e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.1618e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.6030e-01,  1.2344e-01],
         [ 1.8185e-01,  1.2899e-01],
         [ 1.9211e-01,  1.2918e-01],
         [ 1.9223e-01,  1.3644e-01],
         [ 1.9320e-01,  1.4077e-01],
         [ 1.7411e-01,  1.2895e-01],
         [ 1.4979e-01,  1.2528e-01],
         [ 1.4964e-01,  1.3597e-01],
         [ 1.5546e-01,  1.3943e-01],
         [ 1.9515e-01,  1.3430e-01],
         [ 2.1035e-01,  1.3990e-01],
         [ 2.1728e-01,  1.2039e-01],
         [ 2.1200e-01,  1.3356e-01],
         [ 2.0180e-01,  1.3417e-01],
         [ 2.2602e-01,  1.2787e-01],
         [ 2.2170e-01,  1.0172e-01],
         [ 2.2109e-01,  9.0215e-02],
         [ 2.1305e-01,  6.9435e-02],
         [ 1.5392e-01,  4.4635e-02],
         [ 1.4248e-01,  6.2112e-02],
         [ 1.7238e-01,  6.5063e-02],
         [ 1.3795e-01,  3.5560e-02],
         [ 2.0204e-01,  3.0922e-02],
         [ 1.3327e-01,  2.9010e-02],
         [ 1.9880e-01,  2.6724e-02],
         [ 1.4509e-01,  9.4952e-02],
         [ 2.0331e-01,  1.0216e-01],
         [ 1.4238e-01,  1.1126e-01],
         [ 1.9111e-01,  7.9898e-02],
         [ 1.8019e-01,  9.6530e-02],
         [ 1.7601e-01,  8.7863e-02],
         [ 1.4368e-01,  1.0177e-01],
         [ 6.9696e-02,  1.0731e-01],
         [ 1.2346e-01,  6.2303e-02],
         [ 1.5308e-01,  5.3453e-02],
         [ 1.6204e-01,  5.4132e-02],
         [ 5.8122e-02,  5.0050e-02],
         [ 1.2854e-01,  6.8675e-02],
         [ 9.8623e-02,  7.9359e-02],
         [ 9.9123e-02,  8.4392e-02],
         [ 3.5701e-02,  8.6408e-02],
         [ 7.3954e-02,  8.7037e-02],
         [ 6.7675e-02,  8.7100e-02],
         [ 6.7828e-02,  8.6997e-02],
         [ 3.3836e-02,  8.6877e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.5224e-01,  8.7196e-02],
         [ 1.7464e-01,  1.1504e-01],
         [ 1.7249e-01,  1.0085e-01],
         [ 1.7274e-01,  1.1126e-01],
         [ 1.6436e-01,  8.4501e-02],
         [ 1.4900e-01,  6.5974e-02],
         [ 1.4824e-01,  5.5278e-02],
         [ 1.4576e-01,  5.5305e-02],
         [ 1.2278e-01,  4.7431e-02],
         [ 1.4811e-01,  4.5815e-02],
         [ 1.2527e-01,  6.8245e-02],
         [ 1.5908e-01,  7.5596e-02],
         [ 1.4611e-01,  7.8523e-02],
         [ 1.5448e-01,  6.1198e-02],
         [ 1.4293e-01,  9.7148e-02],
         [ 1.5906e-01,  9.0374e-02],
         [ 1.6021e-01,  8.7061e-02],
         [ 1.5714e-01,  8.0979e-02],
         [ 1.0283e-01,  8.1428e-02],
         [ 1.3368e-01,  5.9650e-02],
         [ 1.3529e-01,  6.4390e-02],
         [ 1.0295e-01,  7.1517e-02],
         [ 2.0001e-02,  8.3876e-02],
         [ 4.1816e-02,  8.7971e-02],
         [ 5.2686e-02,  8.9182e-02],
         [ 5.7596e-02,  6.6311e-02],
         [ 5.9574e-02,  6.1926e-02],
         [ 6.0182e-02,  8.2555e-02],
         [ 6.0245e-02,  7.6028e-02],
         [ 6.0146e-02,  8.1494e-02],
         [ 6.0021e-02,  5.3771e-02],
         [ 5.9922e-02,  8.1953e-02],
         [ 5.9849e-02,  7.1691e-02],
         [ 5.9800e-02,  8.3718e-02],
         [ 5.9776e-02,  5.1136e-02],
         [ 5.9761e-02,  6.7767e-02],
         [ 5.9763e-02,  6.7080e-02],
         [ 5.9766e-02,  8.6792e-02],
         [ 5.9763e-02,  8.7163e-02],
         [ 5.9769e-02,  5.7865e-02],
         [ 5.9768e-02,  6.4759e-02],
         [ 5.9765e-02,  5.5458e-02],
         [ 5.9764e-02,  6.4179e-02],
         [ 5.9760e-02,  6.8843e-02],
         [ 5.9760e-02,  8.3807e-02],
         [ 5.9761e-02,  7.1489e-02],
         [ 5.9761e-02,  8.2587e-02],
         [ 5.9761e-02,  6.3851e-02],
         [ 5.9761e-02,  6.0460e-02],
         [ 5.9768e-02,  6.4187e-02],
         [ 5.9761e-02,  5.2355e-02],
         [ 5.9761e-02,  8.0598e-02],
         [ 5.9761e-02,  8.9727e-02],
         [ 5.9761e-02,  8.5943e-02],
         [ 5.9762e-02,  7.9396e-02],
         [ 5.9760e-02,  7.5726e-02],
         [ 5.9760e-02,  8.0178e-02],
         [ 5.9762e-02,  5.1391e-02],
         [ 5.9762e-02,  4.7266e-02],
         [ 5.9762e-02,  6.6275e-02],
         [ 5.9762e-02,  4.5509e-02],
         [ 5.9762e-02,  4.1618e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-1.9246e-05, device='cuda:0') tensor(0.0025, device='cuda:0') tensor(-0.0029, device='cuda:0')
mixer_td_error tensor(0.2976, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.3269, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.9406, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.0870, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2020, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0100, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-1370967.6250, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2260, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(7.5021e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0025, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0933, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.0787, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0933, device='cuda:0', grad_fn=<MinBackward1>)
t_env 19367
target_mac_out tensor([[[[-1.0000e+07,  7.4205e-02,  1.1228e-01,  ...,  9.1248e-02,
            6.3033e-02, -1.0000e+07],
          [-1.0000e+07,  8.6895e-02,  1.1351e-01,  ...,  8.6502e-02,
            7.5577e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.3172e-02,  1.4119e-01,  ...,  1.0166e-01,
            7.2920e-02, -1.0000e+07],
          [-1.0000e+07,  7.8161e-02,  1.0342e-01,  ...,  7.8902e-02,
            6.4295e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.0001e-01,  1.4933e-01,  ...,  1.0586e-01,
            7.9429e-02, -1.0000e+07],
          [-1.0000e+07,  8.6378e-02,  1.1266e-01,  ...,  7.9743e-02,
            6.2823e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07,  6.8745e-02,  9.9995e-02,  ...,  7.7791e-02,
            2.7423e-02,  4.9499e-02],
          [ 8.6631e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07,  6.4218e-02,  9.4963e-02,  ...,  8.1770e-02,
            3.1447e-02,  4.9083e-02],
          [ 8.6625e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[ 4.7817e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 8.6628e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  7.3491e-02,  1.6030e-01,  ...,  1.2384e-01,
            1.0686e-01, -1.0000e+07],
          [-1.0000e+07,  8.7470e-02,  1.2344e-01,  ...,  9.0087e-02,
            7.7106e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.7870e-02,  1.7790e-01,  ...,  1.4629e-01,
            1.2218e-01, -1.0000e+07],
          [-1.0000e+07,  9.4324e-02,  1.0031e-01,  ...,  8.5630e-02,
            7.0973e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.4074e-02,  1.7764e-01,  ...,  1.3889e-01,
            1.2309e-01, -1.0000e+07],
          [-1.0000e+07,  1.1429e-01,  1.3593e-01,  ...,  1.0115e-01,
            7.6595e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.1228e-01,  1.1351e-01],
         [ 1.4119e-01,  1.0342e-01],
         [ 1.4933e-01,  1.1266e-01],
         [ 1.3750e-01,  9.8825e-02],
         [ 1.1171e-01,  9.3087e-02],
         [ 1.3935e-01,  1.0260e-01],
         [ 1.5760e-01,  9.0010e-02],
         [ 1.5905e-01,  8.6037e-02],
         [ 1.7785e-01,  8.1147e-02],
         [ 1.6434e-01,  1.3512e-01],
         [ 1.9523e-01,  1.4096e-01],
         [ 1.9800e-01,  1.5345e-01],
         [ 1.3995e-01,  1.4036e-01],
         [ 1.2961e-01,  1.4782e-01],
         [ 1.9560e-01,  1.1907e-01],
         [ 1.3754e-01,  9.5805e-02],
         [ 1.8805e-01,  1.0742e-01],
         [ 1.3997e-01,  8.8419e-02],
         [ 1.9273e-01,  8.1510e-02],
         [ 1.8826e-01,  1.2024e-01],
         [ 1.6971e-01,  1.0820e-01],
         [ 1.9850e-01,  1.3549e-01],
         [ 2.0122e-01,  1.3842e-01],
         [ 2.0972e-01,  1.3753e-01],
         [ 2.0237e-01,  1.3113e-01],
         [ 1.6778e-01,  1.2155e-01],
         [ 1.2742e-01,  1.1517e-01],
         [ 1.8854e-01,  1.1814e-01],
         [ 1.7554e-01,  9.0268e-02],
         [ 1.8688e-01,  1.0293e-01],
         [ 1.9469e-01,  1.1161e-01],
         [ 1.9340e-01,  1.1851e-01],
         [ 1.6272e-01,  1.2625e-02],
         [ 1.0679e-01,  5.3132e-02],
         [ 1.1969e-01,  7.2577e-02],
         [ 9.2466e-02,  8.1329e-02],
         [ 1.4121e-01,  8.5002e-02],
         [ 1.5073e-01,  8.6424e-02],
         [ 1.4761e-01,  8.6866e-02],
         [ 1.1768e-01,  8.6912e-02],
         [ 1.4209e-01,  8.6847e-02],
         [ 1.1304e-01,  8.6773e-02],
         [ 1.0239e-01,  8.6713e-02],
         [ 1.1770e-01,  8.6652e-02],
         [ 1.1488e-01,  8.6646e-02],
         [ 9.9995e-02,  8.6631e-02],
         [ 8.1770e-02,  8.6625e-02],
         [ 4.7817e-02,  8.6628e-02]],

        [[ 1.6030e-01,  1.2344e-01],
         [ 1.7790e-01,  9.4324e-02],
         [ 1.7764e-01,  1.3593e-01],
         [ 1.9803e-01,  1.2092e-01],
         [ 2.1291e-01,  1.4312e-01],
         [ 2.1237e-01,  1.1243e-01],
         [ 2.2266e-01,  1.4614e-01],
         [ 2.2667e-01,  1.4716e-01],
         [ 1.9903e-01,  1.1717e-01],
         [ 1.3007e-01,  1.0650e-01],
         [ 2.1226e-01,  1.0134e-01],
         [ 2.2724e-01,  8.8780e-02],
         [ 2.2915e-01,  1.1309e-01],
         [ 1.6104e-01,  9.9593e-02],
         [ 2.1461e-01,  9.2349e-02],
         [ 2.1879e-01,  6.6147e-02],
         [ 2.1276e-01,  5.7886e-02],
         [ 2.0696e-01,  6.1735e-02],
         [ 1.9749e-01,  4.9871e-02],
         [ 1.2292e-01,  7.8585e-02],
         [ 1.4068e-01,  1.0647e-01],
         [ 1.0225e-01,  8.4145e-02],
         [ 1.2292e-01,  1.1925e-01],
         [ 9.3407e-02,  1.0894e-01],
         [ 9.7581e-02,  9.6297e-02],
         [ 9.3564e-02,  1.2254e-01],
         [ 1.1330e-01,  1.2535e-01],
         [ 1.1168e-01,  1.2597e-01],
         [ 9.4189e-02,  1.1997e-01],
         [ 9.5950e-02,  1.1282e-01],
         [ 9.5482e-02,  1.0259e-01],
         [ 1.5100e-01,  5.5875e-02],
         [ 1.6115e-01,  4.8791e-02],
         [ 1.6613e-01,  5.5297e-02],
         [ 1.6787e-01,  4.8077e-02],
         [ 1.6544e-01,  4.8827e-02],
         [ 1.5102e-01,  5.2870e-02],
         [ 1.2285e-01,  6.2557e-02],
         [ 8.1727e-02,  5.2973e-02],
         [ 6.7594e-02,  4.0481e-02],
         [ 6.4707e-02,  2.0279e-02],
         [ 5.9881e-02,  5.5556e-02],
         [ 5.5707e-02,  7.3054e-02],
         [ 5.8946e-02,  8.1162e-02],
         [ 1.9727e-02,  8.4669e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(-8.8847e-05, device='cuda:0') tensor(0.0042, device='cuda:0') tensor(-0.0040, device='cuda:0')
mixer_td_error tensor(0.0397, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.2847, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.0115, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.1137, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2208, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0093, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-312499.8750, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.2292, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(0.0002, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0032, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0962, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]]], device='cuda:0')
q_masked_td_error tensor(0.0690, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0962, device='cuda:0', grad_fn=<MinBackward1>)
t_env 19426
target_mac_out tensor([[[[-1.0000e+07,  7.3359e-02,  1.3533e-01,  ...,  8.9806e-02,
            7.4978e-02, -1.0000e+07],
          [-1.0000e+07,  5.9472e-02,  9.0317e-02,  ...,  5.6118e-02,
            5.9829e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.7054e-02,  1.7270e-01,  ...,  1.3398e-01,
            1.1277e-01, -1.0000e+07],
          [-1.0000e+07,  9.2112e-02,  1.2689e-01,  ...,  9.0408e-02,
            7.2368e-02, -1.0000e+07]],

         [[-1.0000e+07,  1.1905e-01,  1.8587e-01,  ...,  1.5809e-01,
            1.2848e-01, -1.0000e+07],
          [-1.0000e+07,  8.2505e-02,  1.1953e-01,  ...,  8.8023e-02,
            6.2381e-02, -1.0000e+07]],

         ...,

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]],

         [[-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]],


        [[[-1.0000e+07,  6.9143e-02,  1.3413e-01,  ...,  8.9326e-02,
            7.4741e-02, -1.0000e+07],
          [-1.0000e+07,  7.0448e-02,  1.0907e-01,  ...,  7.5776e-02,
            7.4083e-02, -1.0000e+07]],

         [[-1.0000e+07,  8.5132e-02,  1.5134e-01,  ...,  1.0964e-01,
            9.9393e-02, -1.0000e+07],
          [-1.0000e+07,  8.1021e-02,  8.9095e-02,  ...,  7.3884e-02,
            6.7763e-02, -1.0000e+07]],

         [[-1.0000e+07,  9.7162e-02,  1.5399e-01,  ...,  1.1912e-01,
            1.0913e-01, -1.0000e+07],
          [-1.0000e+07,  8.7212e-02,  8.6023e-02,  ...,  8.6053e-02,
            6.8017e-02, -1.0000e+07]],

         ...,

         [[ 5.0510e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  2.2489e-02,  1.9935e-02,  ...,  7.2336e-03,
           -1.3167e-02, -1.5506e-02]],

         [[ 5.5835e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [-1.0000e+07,  4.1225e-02,  4.4206e-02,  ...,  1.9022e-02,
            4.4471e-03,  1.3539e-03]],

         [[ 5.8492e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07],
          [ 4.3353e-02, -1.0000e+07, -1.0000e+07,  ..., -1.0000e+07,
           -1.0000e+07, -1.0000e+07]]]], device='cuda:0',
       grad_fn=<IndexPutBackward>)
target_max_qvals tensor([[[ 1.3533e-01,  9.0317e-02],
         [ 1.7270e-01,  1.2689e-01],
         [ 1.8587e-01,  1.1953e-01],
         [ 1.8864e-01,  1.2500e-01],
         [ 1.7573e-01,  1.4171e-01],
         [ 1.7537e-01,  1.4807e-01],
         [ 1.7795e-01,  1.5632e-01],
         [ 1.7694e-01,  1.3720e-01],
         [ 1.7600e-01,  1.5477e-01],
         [ 1.7174e-01,  1.6264e-01],
         [ 1.7751e-01,  1.6183e-01],
         [ 1.5991e-01,  1.5494e-01],
         [ 1.4099e-01,  1.1178e-01],
         [ 1.0975e-01,  1.3026e-01],
         [ 1.5555e-01,  1.1348e-01],
         [ 1.5782e-01,  1.2901e-01],
         [ 1.2965e-01,  1.2688e-01],
         [ 1.6393e-01,  1.2544e-01],
         [ 1.6562e-01,  1.1895e-01],
         [ 1.6854e-01,  1.1868e-01],
         [ 1.3954e-01,  7.3523e-02],
         [ 1.5163e-01,  5.8717e-02],
         [ 1.2559e-01,  2.8000e-02],
         [ 1.0243e-01,  5.9821e-02],
         [ 1.1904e-01,  7.4937e-02],
         [ 1.2398e-01,  8.1792e-02],
         [ 8.1984e-02,  8.4719e-02],
         [ 7.1313e-02,  8.5907e-02],
         [ 6.3497e-02,  8.6374e-02],
         [ 7.2378e-02,  8.6544e-02],
         [ 1.0278e-01,  8.6597e-02],
         [ 8.2049e-02,  8.6614e-02],
         [ 9.4583e-02,  8.6614e-02],
         [ 8.2217e-02,  8.6640e-02],
         [ 9.8204e-02,  8.6634e-02],
         [ 7.4860e-02,  8.6631e-02],
         [ 8.4021e-02,  8.6619e-02],
         [ 8.6709e-02,  8.6622e-02],
         [ 8.5113e-02,  8.6632e-02],
         [ 8.4184e-02,  8.6625e-02],
         [ 3.1995e-02,  8.6622e-02],
         [ 7.4574e-02,  8.6625e-02],
         [ 1.0395e-01,  8.6628e-02],
         [ 1.1802e-01,  8.6622e-02],
         [ 1.2425e-01,  8.6621e-02],
         [ 9.5490e-03,  8.6621e-02],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07],
         [-1.0000e+07, -1.0000e+07]],

        [[ 1.3413e-01,  1.0907e-01],
         [ 1.5134e-01,  8.9095e-02],
         [ 1.5399e-01,  8.7212e-02],
         [ 1.5310e-01,  1.0428e-01],
         [ 1.1078e-01,  1.0571e-01],
         [ 1.1646e-01,  9.6741e-02],
         [ 1.1983e-01,  9.2266e-02],
         [ 1.2090e-01,  9.2086e-02],
         [ 1.3164e-01,  1.0341e-01],
         [ 1.1588e-01,  1.0690e-01],
         [ 1.1745e-01,  9.6575e-02],
         [ 1.1907e-01,  9.6740e-02],
         [ 1.4525e-01,  9.0630e-02],
         [ 1.4560e-01,  8.8800e-02],
         [ 1.3305e-01,  9.7597e-02],
         [ 1.5200e-01,  9.3419e-02],
         [ 1.5284e-01,  9.2738e-02],
         [ 1.3041e-01,  9.8366e-02],
         [ 1.1904e-01,  6.5048e-02],
         [ 1.0616e-01,  4.9653e-02],
         [ 1.1308e-01,  8.7164e-02],
         [ 5.4593e-02,  1.0692e-01],
         [ 1.3327e-01,  1.2051e-01],
         [ 1.1051e-01,  1.2098e-01],
         [ 1.1595e-01,  1.1575e-01],
         [ 1.4162e-01,  8.4995e-02],
         [ 1.1789e-01,  9.0638e-02],
         [ 1.4213e-01,  9.4294e-02],
         [ 1.2864e-01,  9.4551e-02],
         [ 1.5323e-01,  8.8943e-02],
         [ 1.2834e-01,  9.6959e-02],
         [ 1.4226e-01,  1.0225e-01],
         [ 1.4614e-01,  1.0204e-01],
         [ 1.4904e-01,  9.1356e-02],
         [ 1.5047e-01,  1.0607e-01],
         [ 1.6410e-01,  1.0862e-01],
         [ 1.5887e-01,  1.0793e-01],
         [ 1.8307e-01,  9.7675e-02],
         [ 1.9495e-01,  8.2249e-02],
         [ 1.7620e-01,  8.0841e-02],
         [ 1.5906e-01,  8.1901e-02],
         [ 1.5189e-01,  9.8825e-02],
         [ 1.5248e-01,  9.7016e-02],
         [ 1.7111e-01,  9.7232e-02],
         [ 1.7398e-01,  8.0941e-02],
         [ 1.5215e-01,  9.8693e-02],
         [ 1.6567e-01,  8.6060e-02],
         [ 1.4140e-01,  1.0514e-01],
         [ 1.7186e-01,  1.0672e-01],
         [ 1.9110e-01,  1.0773e-01],
         [ 1.4721e-01,  6.9376e-02],
         [ 1.4760e-01,  7.6586e-02],
         [ 1.4333e-01,  7.1041e-02],
         [ 1.4007e-01,  9.3737e-02],
         [ 1.6953e-01,  1.0844e-01],
         [ 1.4722e-01,  1.1837e-01],
         [ 1.4256e-01,  1.1968e-01],
         [ 1.3612e-01,  1.3607e-01],
         [ 1.4186e-01,  1.3786e-01],
         [ 1.4078e-01,  1.3324e-01],
         [ 1.3197e-01,  1.2322e-01],
         [ 1.3538e-01,  1.3280e-01],
         [ 1.6209e-01,  1.2784e-01],
         [ 1.7216e-01,  1.3262e-01],
         [ 1.7749e-01,  1.1028e-01],
         [ 1.4063e-01,  1.0582e-01],
         [ 1.3893e-01,  1.2665e-01],
         [ 1.7430e-01,  1.3373e-01],
         [ 1.3918e-01,  1.0124e-01],
         [ 1.7575e-01,  8.7761e-02],
         [ 1.9673e-01,  1.2147e-01],
         [ 1.9470e-01,  1.1174e-01],
         [ 1.9104e-01,  1.3270e-01],
         [ 1.8680e-01,  1.3667e-01],
         [ 1.1656e-01,  1.2593e-01],
         [ 7.3885e-02,  1.1678e-01],
         [ 6.3880e-02,  5.8886e-02],
         [ 7.3717e-02,  5.6968e-02],
         [ 9.4667e-02,  6.3463e-02],
         [ 1.3367e-01,  6.1992e-02],
         [ 1.3961e-01,  1.0360e-01],
         [ 9.1159e-02,  8.7657e-02],
         [ 7.4414e-02,  9.9071e-02],
         [ 7.0483e-02,  9.6169e-02],
         [ 5.9610e-02,  9.5926e-02],
         [ 3.2367e-02,  4.9914e-02],
         [ 4.1685e-02,  3.2775e-02],
         [ 5.0510e-02,  2.2489e-02],
         [ 5.5835e-02,  4.1225e-02],
         [ 5.8492e-02,  4.3353e-02]]], device='cuda:0',
       grad_fn=<SqueezeBackward1>)
cal_indi_reward......
grad_qtot_qi tensor(4.9363e-05, device='cuda:0') tensor(0.0030, device='cuda:0') tensor(-0.0045, device='cuda:0')
mixer_td_error tensor(0.5692, device='cuda:0', grad_fn=<MeanBackward0>) tensor(2.3051, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-1.6966, device='cuda:0', grad_fn=<MinBackward1>)
qi tensor(0.1022, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1996, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0.0032, device='cuda:0', grad_fn=<MinBackward1>)
target_qi tensor(-2444444.2500, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.1967, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-9999999., device='cuda:0', grad_fn=<MinBackward1>)
grad_td tensor(9.6990e-05, device='cuda:0', grad_fn=<MeanBackward0>) tensor(0.0076, device='cuda:0', grad_fn=<MaxBackward1>) tensor(0., device='cuda:0', grad_fn=<MinBackward1>)
q_td_error tensor(9999999., device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0573, device='cuda:0', grad_fn=<MinBackward1>)
q_mask tensor([[[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [1., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.],
         [0., 0.]],

        [[1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [1., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.],
         [0., 1.]]], device='cuda:0')
q_masked_td_error tensor(0.0740, device='cuda:0', grad_fn=<MaxBackward1>) tensor(-0.0573, device='cuda:0', grad_fn=<MinBackward1>)
[WARNING 10:13:46] pymarl Aborted after 0:09:33!
Traceback (most recent call last):
  File "src/main.py", line 98, in <module>
    ex.run_commandline(params)
  File "/opt/conda/lib/python3.8/site-packages/sacred-0.7.2-py3.8.egg/sacred/experiment.py", line 251, in run_commandline
    return self.run(cmd_name, config_updates, named_configs, {}, args)
  File "/opt/conda/lib/python3.8/site-packages/sacred-0.7.2-py3.8.egg/sacred/experiment.py", line 200, in run
    run()
  File "/opt/conda/lib/python3.8/site-packages/sacred-0.7.2-py3.8.egg/sacred/run.py", line 229, in __call__
    self.result = self.main_function(*args)
  File "/opt/conda/lib/python3.8/site-packages/wrapt-1.12.1-py3.8.egg/wrapt/wrappers.py", line 566, in __call__
  File "/opt/conda/lib/python3.8/site-packages/sacred-0.7.2-py3.8.egg/sacred/config/captured_function.py", line 48, in captured_function
    result = wrapped(*args, **kwargs)
  File "src/main.py", line 35, in my_main
    run(_run, config, _log)
  File "/root/pymarl/src/run.py", line 48, in run
    run_sequential(args=args, logger=logger)
  File "/root/pymarl/src/run.py", line 167, in run_sequential
    episode_batch = runner.run(test_mode=False)
  File "/root/pymarl/src/runners/episode_runner.py", line 69, in run
    reward, terminated, env_info = self.env.step(actions[0])
  File "/opt/conda/lib/python3.8/site-packages/smac/env/starcraft2/starcraft2.py", line 422, in step
    self._obs = self._controller.observe()
  File "/opt/conda/lib/python3.8/site-packages/pysc2/lib/remote_controller.py", line 99, in _valid_status
    return func(self, *args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pysc2/lib/stopwatch.py", line 212, in _stopwatch
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pysc2/lib/remote_controller.py", line 248, in observe
    obs = self._client.send(observation=sc_pb.RequestObservation(
  File "/opt/conda/lib/python3.8/site-packages/pysc2/lib/protocol.py", line 151, in send
    res = self.send_req(req)
  File "/opt/conda/lib/python3.8/site-packages/pysc2/lib/protocol.py", line 131, in send_req
    return self.read()
  File "/opt/conda/lib/python3.8/site-packages/pysc2/lib/stopwatch.py", line 212, in _stopwatch
    return func(*args, **kwargs)
  File "/opt/conda/lib/python3.8/site-packages/pysc2/lib/protocol.py", line 102, in read
    response = self._read()
  File "/opt/conda/lib/python3.8/site-packages/pysc2/lib/protocol.py", line 183, in _read
    response_str = self._sock.recv()
  File "/opt/conda/lib/python3.8/site-packages/websocket/_core.py", line 353, in recv
    opcode, data = self.recv_data()
  File "/opt/conda/lib/python3.8/site-packages/websocket/_core.py", line 376, in recv_data
    opcode, frame = self.recv_data_frame(control_frame)
  File "/opt/conda/lib/python3.8/site-packages/websocket/_core.py", line 395, in recv_data_frame
    frame = self.recv_frame()
  File "/opt/conda/lib/python3.8/site-packages/websocket/_core.py", line 431, in recv_frame
    return self.frame_buffer.recv_frame()
  File "/opt/conda/lib/python3.8/site-packages/websocket/_abnf.py", line 372, in recv_frame
    self.recv_header()
  File "/opt/conda/lib/python3.8/site-packages/websocket/_abnf.py", line 320, in recv_header
    header = self.recv_strict(2)
  File "/opt/conda/lib/python3.8/site-packages/websocket/_abnf.py", line 407, in recv_strict
    bytes_ = self.recv(min(16384, shortage))
  File "/opt/conda/lib/python3.8/site-packages/websocket/_core.py", line 514, in _recv
    return recv(self.sock, bufsize)
  File "/opt/conda/lib/python3.8/site-packages/websocket/_socket.py", line 113, in recv
    bytes_ = _recv()
  File "/opt/conda/lib/python3.8/site-packages/websocket/_socket.py", line 95, in _recv
    return sock.recv(bufsize)
KeyboardInterrupt
[INFO 10:13:46] absl Shutdown gracefully.
[INFO 10:13:46] absl Shutdown with return code: -2
